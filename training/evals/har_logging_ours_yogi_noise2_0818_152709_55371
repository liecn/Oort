2021-08-18:15:27:14,351 INFO     [param_server.py:13] End up with cuda device tensor([0.8243], device='cuda:0')
2021-08-18:15:27:14,751 INFO     [param_server.py:608] ====Start to initialize dataset
2021-08-18:15:27:14,752 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:27:46,343 INFO     [learner.py:14] End up with cuda device tensor([0.2989], device='cuda:2')
2021-08-18:15:27:46,349 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:27:46,757 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:27:46,757 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:27:47,450 INFO     [learner.py:14] End up with cuda device tensor([0.1880], device='cuda:3')
2021-08-18:15:27:47,452 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:27:47,860 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:27:47,861 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:27:49,132 INFO     [learner.py:14] End up with cuda device tensor([0.1659], device='cuda:1')
2021-08-18:15:27:49,134 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:27:49,542 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:27:49,542 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:29:05,868 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:29:05,873 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:05,873 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.000476837158203125 s

2021-08-18:15:29:05,874 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:29:06,295 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:29:06,367 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:06,368 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0005776882171630859 s

2021-08-18:15:29:06,368 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:29:07,21 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:29:07,24 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:07,25 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.00047969818115234375 s

2021-08-18:15:29:07,25 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:29:08,285 INFO     [param_server.py:91] ====Info of all feasible clients {'total_feasible_clients': 120, 'total_length': 30423}
2021-08-18:15:29:08,541 INFO     [param_server.py:189] ====PS: get in run()
2021-08-18:15:29:08,571 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:29:08,572 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:08,572 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0004036426544189453 s

2021-08-18:15:29:08,572 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:29:08,573 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:29:08,573 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:29:08,574 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:08,574 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0005257129669189453 s

2021-08-18:15:29:08,575 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:29:08,575 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:29:08,575 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:29:08,577 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:29:08,576 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:29:08,578 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:08,578 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.00043773651123046875 s

2021-08-18:15:29:08,578 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:29:08,579 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:29:08,579 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:29:08,579 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:29:08,580 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:29:08,581 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:29:08,582 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:29:08,582 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:29:08,585 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:29:08,596 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=2, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=48393, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=2.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='7079', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=2, threads=4, time_stamp='0818_152709_55371', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:29:08,599 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=1, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=48393, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=2.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='7079', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=1, threads=4, time_stamp='0818_152709_55371', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:29:08,599 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=3, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=48393, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=2.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='7079', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=3, threads=4, time_stamp='0818_152709_55371', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:29:08,608 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:29:08,609 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:29:08,612 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:29:08,624 INFO     [learner.py:165] Start to run client 2 on rank 2...
2021-08-18:15:29:08,625 INFO     [learner.py:165] Start to run client 1 on rank 1...
====Worker: init_myprocesses
Begin!
2021-08-18:15:29:08,627 INFO     [learner.py:165] Start to run client 3 on rank 3...
====Worker: init_myprocesses
Begin!
====Worker: init_myprocesses
Begin!
2021-08-18:15:29:09,108 INFO     [learner.py:439] Completed to run client 2
2021-08-18:15:29:09,113 INFO     [learner.py:606] ====Pushing takes 0.003169536590576172 s
2021-08-18:15:29:09,117 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:29:09,120 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:09,122 INFO     [learner.py:606] ====Pushing takes 0.003174304962158203 s
2021-08-18:15:29:09,123 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.3333333333333333, now collected 1 clients
2021-08-18:15:29:09,124 INFO     [param_server.py:410] Lock worker 2 with localStep 1 , while globalStep is 0

2021-08-18:15:29:09,127 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:09,128 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.3333333333333333, now collected 2 clients
2021-08-18:15:29:09,129 INFO     [param_server.py:410] Lock worker 3 with localStep 1 , while globalStep is 0

2021-08-18:15:29:09,139 INFO     [learner.py:439] Completed to run client 1
2021-08-18:15:29:09,143 INFO     [learner.py:606] ====Pushing takes 0.002954721450805664 s
2021-08-18:15:29:09,146 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:09,148 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.3333333333333333, now collected 3 clients
2021-08-18:15:29:09,148 INFO     [param_server.py:381] ====After aggregation in epoch: 0, virtual_clock: 0.0, top_1: : 0.0 % (0.0), top_5: : 0.0 % (0.0), test loss: 0.0, test len: 3.0
2021-08-18:15:29:09,150 INFO     [param_server.py:410] Lock worker 1 with localStep 1 , while globalStep is 1

2021-08-18:15:29:09,150 INFO     [param_server.py:441] ====Epoch 2 completes 3 clients with loss 49.30390782795176, sampled rewards are: 
 {1: 0, 2: 0, 3: 0} 
==========
2021-08-18:15:29:09,150 INFO     [param_server.py:450] ====Start to sample for epoch 2, global virtualClock: 0.0, round_duration: 0.0
2021-08-18:15:29:09,151 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 55, 6, 51, 84, 98, 37, 112, 118, 93, 11, 85, 27, 31, 57, 79, 119, 107, 70]
2021-08-18:15:29:09,486 INFO     [param_server.py:567] ====Error: argument of type 'NoneType' is not iterable, <class 'TypeError'>, param_server.py, 551
2021-08-18:15:29:10,47 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2641, Top-1 Accuracy: 252.0/1033 (0.2439), Top-5 Accuracy: 1.0
2021-08-18:15:29:10,47 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.4646, eval_time 0.5278, test_loss 4.2641, test_accuracy 0.2439, test_5_accuracy 1.0 

2021-08-18:15:29:10,96 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2447, Top-1 Accuracy: 257.0/1033 (0.2488), Top-5 Accuracy: 1.0
2021-08-18:15:29:10,97 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.5169, eval_time 0.5773, test_loss 3.2447, test_accuracy 0.2488, test_5_accuracy 1.0 

2021-08-18:15:29:10,101 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:29:10,116 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:29:10,131 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2835, Top-1 Accuracy: 226.0/1033 (0.2188), Top-5 Accuracy: 1.0
2021-08-18:15:29:10,132 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.5458, eval_time 0.5885, test_loss 3.2835, test_accuracy 0.2188, test_5_accuracy 1.0 

2021-08-18:15:29:10,151 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:29:10,171 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:29:10,200 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:29:10,226 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:29:11,703 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:29:11,722 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:29:12,778 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:29:12,789 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:13,140 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:13,158 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:29:14,500 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:14,518 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:29:14,591 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:29:14,609 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:29:15,399 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:29:15,413 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:29:15,844 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:29:15,857 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:29:16,565 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:29:16,582 INFO     [learner.py:606] ====Pushing takes 0.01608562469482422 s
2021-08-18:15:29:16,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:16,616 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 4 clients
2021-08-18:15:29:16,616 INFO     [param_server.py:410] Lock worker 2 with localStep 2 , while globalStep is 1

2021-08-18:15:29:17,24 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:29:17,35 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:29:17,315 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:29:17,329 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:29:18,729 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:29:18,749 INFO     [learner.py:165] Start to run client 112 on rank 1...
2021-08-18:15:29:19,612 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:29:19,621 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:29:20,573 INFO     [learner.py:439] Completed to run client 112
2021-08-18:15:29:20,593 INFO     [learner.py:165] Start to run client 118 on rank 1...
2021-08-18:15:29:20,692 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:29:20,701 INFO     [learner.py:165] Start to run client 57 on rank 3...
2021-08-18:15:29:21,921 INFO     [learner.py:439] Completed to run client 118
2021-08-18:15:29:21,941 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:29:21,976 INFO     [learner.py:439] Completed to run client 57
2021-08-18:15:29:22,5 INFO     [learner.py:606] ====Pushing takes 0.027704715728759766 s
2021-08-18:15:29:22,59 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:22,74 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 10 clients
2021-08-18:15:29:22,75 INFO     [param_server.py:410] Lock worker 3 with localStep 2 , while globalStep is 1

2021-08-18:15:29:23,185 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:29:23,221 INFO     [learner.py:165] Start to run client 31 on rank 1...
2021-08-18:15:29:26,440 INFO     [learner.py:439] Completed to run client 31
2021-08-18:15:29:26,460 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:29:27,54 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:29:27,69 INFO     [learner.py:165] Start to run client 70 on rank 1...
2021-08-18:15:29:27,672 INFO     [learner.py:439] Completed to run client 70
2021-08-18:15:29:27,713 INFO     [learner.py:606] ====Pushing takes 0.0401616096496582 s
2021-08-18:15:29:27,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:27,794 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:27,795 INFO     [param_server.py:381] ====After aggregation in epoch: 1, virtual_clock: 57.1231349992849, top_1: : 23.7173 % (735.0), top_5: : 100.0 % (3099.0), test loss: 3.597442750577573, test len: 3099.0
2021-08-18:15:29:27,798 INFO     [param_server.py:410] Lock worker 1 with localStep 2 , while globalStep is 2

2021-08-18:15:29:27,799 INFO     [param_server.py:441] ====Epoch 3 completes 20 clients with loss 8.808181687438411, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 31: 0, 37: 0, 51: 0, 55: 0, 57: 0, 70: 0, 79: 0, 82: 0, 84: 0, 85: 0, 93: 0, 98: 0, 107: 0, 112: 0, 118: 0, 119: 0} 
==========
2021-08-18:15:29:27,799 INFO     [param_server.py:450] ====Start to sample for epoch 3, global virtualClock: 57.1231349992849, round_duration: 57.1231349992849
2021-08-18:15:29:27,802 INFO     [oort.py:208] Training selector: Pacer 1: lastExploitationUtil 0.0, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:29:27,804 INFO     [oort.py:321] scores are 3,{6: 0.2270832751900913, 7: 0.3699745730531728, 11: 0.0734994500657207, 27: 0.08447374924807213, 31: 0.030312877048556553, 37: 0.09463453256176449, 51: 0.1724860581437587, 55: 0.4026961751665308, 57: 0.022908720597794783, 58: 0.003865622095131895, 59: 0.004000212315354204, 60: 0.0017249841547340267, 67: 0.0021113545677880563, 70: 0.001805589927263737, 76: 0.0018656866271402485, 82: 0.9764684733687132, 84: 0.1452810549254435, 85: 0.05886792228481348, 98: 0.15839915631426266, 104: 0.003584383041646915, 107: 0.00864872894391872, 112: 0.13058703836099783, 118: 0.1515799935624538, 119: 0.028246770280676507},[82, 55, 7, 6, 51, 98, 118, 84, 112, 37, 27, 11, 85, 31, 119, 57, 107, 59, 58, 104, 67, 76, 70, 60]
2021-08-18:15:29:27,805 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:29:27,807 INFO     [oort.py:365] exploration poss is [211.         194.         127.31276875 102.62196006  93.54348818
  63.22281215  48.9297034   43.80212094  40.07746457  38.76346588
  35.52193436  20.51602366  19.67074705  17.89651406  17.81815999
  16.97776986  10.82015629  10.17914992   9.55281742   9.51833915
   9.20736151   4.08207853   3.2544298    2.43794015   2.21488525
   1.67907336   1.37027356   0.86146108   0.70455354]
2021-08-18:15:29:27,807 INFO     [oort.py:398] At round 1, UCB exploited 24, augment_factor 1.6666666666666667, exploreLen 23, un-explored 91, exploration 0.855, round_threshold 10, sampled score is [({'reward': 1105.7350151446278, 'duration': 6.342067858842259, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 83.08739610115947}, [0.9764684733687132, -0.0001500750375187595]), ({'reward': 551.6886983665897, 'duration': 8.010998429338052, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.493968292123032}, [0.4026961751665308, -0.0001500750375187595]), ({'reward': 551.9993685695346, 'duration': 11.90395711384456, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.28996491366406}, [0.4030179063123368, -0.0001500750375187595])]
2021-08-18:15:29:27,808 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [82, 16, 55, 53, 6, 83, 97, 81, 99, 38, 87, 110, 71, 5, 73, 65, 106, 49, 50, 105]
2021-08-18:15:29:28,205 INFO     [param_server.py:553] For epoch: 3, median_reward: 334.65915030885384, dev: 669.3183006177077
2021-08-18:15:29:28,826 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.5646, Top-1 Accuracy: 353.0/1033 (0.3417), Top-5 Accuracy: 1.0
2021-08-18:15:29:28,827 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 20.2472, eval_time 0.5992, test_loss 5.5646, test_accuracy 0.3417, test_5_accuracy 1.0 

2021-08-18:15:29:28,834 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.5084, Top-1 Accuracy: 341.0/1033 (0.3301), Top-5 Accuracy: 1.0
2021-08-18:15:29:28,837 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 20.2544, eval_time 0.6089, test_loss 5.5084, test_accuracy 0.3301, test_5_accuracy 1.0 

2021-08-18:15:29:28,819 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 5.4795, Top-1 Accuracy: 355.0/1033 (0.3437), Top-5 Accuracy: 1.0
2021-08-18:15:29:28,839 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 20.2536, eval_time 0.6074, test_loss 5.4795, test_accuracy 0.3437, test_5_accuracy 1.0 

2021-08-18:15:29:28,901 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:28,913 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:28,914 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:28,916 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:28,922 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:29:28,923 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:29:29,963 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:29:29,974 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:29:30,697 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:30,763 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:29:31,434 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:31,444 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:29:31,970 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:29:31,980 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:29:32,723 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:29:32,737 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:29:32,743 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:29:32,746 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:29:33,335 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:29:33,349 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:29:34,544 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:29:34,558 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:29:35,174 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:29:35,194 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:29:35,719 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:29:35,741 INFO     [learner.py:606] ====Pushing takes 0.019533634185791016 s
2021-08-18:15:29:35,773 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:35,784 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:29:35,784 INFO     [param_server.py:410] Lock worker 3 with localStep 3 , while globalStep is 2

2021-08-18:15:29:35,866 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:29:35,887 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:29:36,147 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:29:36,168 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:29:37,165 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:29:37,184 INFO     [learner.py:165] Start to run client 73 on rank 1...
2021-08-18:15:29:37,737 INFO     [learner.py:439] Completed to run client 73
2021-08-18:15:29:37,757 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:29:38,245 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:29:38,266 INFO     [learner.py:165] Start to run client 49 on rank 1...
2021-08-18:15:29:38,636 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:29:38,656 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:29:38,794 INFO     [learner.py:439] Completed to run client 49
2021-08-18:15:29:38,816 INFO     [learner.py:606] ====Pushing takes 0.021078824996948242 s
2021-08-18:15:29:38,861 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:38,868 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:29:38,869 INFO     [param_server.py:410] Lock worker 1 with localStep 3 , while globalStep is 2

2021-08-18:15:29:39,399 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:29:39,417 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:29:40,18 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:29:40,32 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:29:40,593 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:29:40,625 INFO     [learner.py:606] ====Pushing takes 0.03152894973754883 s
2021-08-18:15:29:40,677 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:40,687 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:40,687 INFO     [param_server.py:381] ====After aggregation in epoch: 2, virtual_clock: 94.09040263304013, top_1: : 33.8496 % (1049.0), top_5: : 100.0 % (3099.0), test loss: 5.517517513699001, test len: 3099.0
2021-08-18:15:29:40,689 INFO     [param_server.py:410] Lock worker 2 with localStep 3 , while globalStep is 3

2021-08-18:15:29:40,689 INFO     [param_server.py:441] ====Epoch 4 completes 20 clients with loss 52.19295701503463, sampled rewards are: 
 {5: 0, 6: 0, 16: 0, 38: 0, 49: 0, 50: 0, 53: 0, 55: 0, 65: 0, 71: 0, 73: 0, 81: 0, 82: 0, 83: 0, 87: 0, 97: 0, 99: 0, 105: 0, 106: 0, 110: 0} 
==========
2021-08-18:15:29:40,690 INFO     [param_server.py:450] ====Start to sample for epoch 4, global virtualClock: 94.09040263304013, round_duration: 36.96726763375522
2021-08-18:15:29:40,691 INFO     [oort.py:208] Training selector: Pacer 2: lastExploitationUtil 1086.9253065328808, lastExplorationUtil 1102.706608479255, last_util_record 0
2021-08-18:15:29:40,692 INFO     [oort.py:321] scores are 4,{5: 0.029751673867732333, 6: 0.25105052028789265, 7: 0.3215449827754401, 11: 0.057036723697724875, 14: 0.008861493367827235, 16: 0.6793356839990892, 17: 0.01059088984140904, 27: 0.04151638102777977, 31: 0.026327195272605353, 37: 0.12049767466627666, 38: 0.0918398509838374, 49: 0.011262794207907361, 50: 0.006367329838974034, 51: 0.16946241474913984, 53: 0.21069973701414615, 55: 0.1799370082337389, 57: 0.017117196479597595, 58: 0.0028817349462494004, 59: 0.0029820689498051196, 60: 0.0012859371656333413, 65: 0.03435210223511804, 67: 0.0015739676802811067, 70: 0.004526390006419397, 71: 0.023915846735321256, 73: 0.023804797537788053, 76: 0.0013908277166955673, 81: 0.07317466819512007, 82: 0.6793356839990892, 83: 0.2977406414998008, 84: 0.13970368210045486, 85: 0.0397627524833327, 86: 0.001609124698637472, 87: 0.054912988990006587, 97: 0.20466594451433257, 98: 0.14127085324085364, 99: 0.08096162335181202, 104: 0.0026720775124049476, 105: 0.02044388820332726, 106: 0.007226695565446894, 107: 0.00771305182752017, 110: 0.04789211846375765, 112: 0.10124790473687868, 118: 0.10373169916059452, 119: 0.014737807420856178},[16, 82, 7, 83, 6, 53, 97, 55, 51, 98, 84, 37, 118, 112, 38, 99, 81, 11, 87, 110, 27, 85, 65, 5, 31, 71, 73, 105, 57, 119, 49, 17, 14, 107, 106, 50, 70, 59, 58, 104, 86, 67, 76, 60]
2021-08-18:15:29:40,693 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:29:40,694 INFO     [oort.py:365] exploration poss is [102.23853772  18.16687676   3.2544298    2.43794015   2.21488525
   1.67907336   1.37027356   0.86146108]
2021-08-18:15:29:40,695 INFO     [oort.py:398] At round 2, UCB exploited 44, augment_factor 2.0, exploreLen 8, un-explored 71, exploration 0.8122499999999999, round_threshold 10, sampled score is [({'reward': 2025.8339673333485, 'duration': 6.342067858842259, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 83.05965649139578}, [0.5273327037037514, -0.00010003334444814946]), ({'reward': 3841.6529662555176, 'duration': 7.864087706209871, 'time_stamp': 3, 'count': 1, 'status': True, 'gradient': 21.302627228948477}, [1.0, -0.00010003334444814946]), ({'reward': 1127.7280925678626, 'duration': 11.90395711384456, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 20.292275860250673}, [0.29355099095311016, -0.00010003334444814946])]
2021-08-18:15:29:40,696 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [82, 16, 53, 6, 83, 97, 38, 85, 110, 5, 106, 50, 105, 119, 17, 14, 111, 96, 25, 35]
2021-08-18:15:29:41,76 INFO     [param_server.py:553] For epoch: 4, median_reward: 486.673350061308, dev: 973.346700122616
2021-08-18:15:29:41,725 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5042, Top-1 Accuracy: 408.0/1033 (0.395), Top-5 Accuracy: 1.0
2021-08-18:15:29:41,727 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 33.1463, eval_time 0.6273, test_loss 2.5042, test_accuracy 0.395, test_5_accuracy 1.0 

2021-08-18:15:29:41,727 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.54, Top-1 Accuracy: 423.0/1033 (0.4095), Top-5 Accuracy: 1.0
2021-08-18:15:29:41,728 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 33.1449, eval_time 0.6267, test_loss 2.54, test_accuracy 0.4095, test_5_accuracy 1.0 

2021-08-18:15:29:41,756 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.433, Top-1 Accuracy: 425.0/1033 (0.4114), Top-5 Accuracy: 1.0
2021-08-18:15:29:41,757 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 33.1711, eval_time 0.6471, test_loss 2.433, test_accuracy 0.4114, test_5_accuracy 1.0 

2021-08-18:15:29:41,800 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:41,817 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:29:41,824 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:41,840 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:41,843 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:41,866 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:29:43,664 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:29:43,683 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:29:43,916 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:43,937 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:29:44,887 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:44,908 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:29:46,112 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:29:46,127 INFO     [learner.py:165] Start to run client 111 on rank 3...
2021-08-18:15:29:46,332 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:29:46,344 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:29:46,772 INFO     [learner.py:439] Completed to run client 111
2021-08-18:15:29:46,786 INFO     [learner.py:165] Start to run client 96 on rank 3...
2021-08-18:15:29:47,190 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:29:47,223 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:29:47,350 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:29:47,368 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:29:49,58 INFO     [learner.py:439] Completed to run client 96
2021-08-18:15:29:49,76 INFO     [learner.py:606] ====Pushing takes 0.013686895370483398 s
2021-08-18:15:29:49,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:49,110 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 4 clients
2021-08-18:15:29:49,111 INFO     [param_server.py:410] Lock worker 3 with localStep 4 , while globalStep is 3

2021-08-18:15:29:49,937 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:29:49,957 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:29:50,0 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:29:50,15 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:29:51,404 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:29:51,425 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:29:51,648 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:29:51,660 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:29:53,317 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:29:53,337 INFO     [learner.py:165] Start to run client 25 on rank 1...
2021-08-18:15:29:54,22 INFO     [learner.py:439] Completed to run client 25
2021-08-18:15:29:54,42 INFO     [learner.py:606] ====Pushing takes 0.0186769962310791 s
2021-08-18:15:29:54,95 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:54,103 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:15:29:54,103 INFO     [param_server.py:410] Lock worker 1 with localStep 4 , while globalStep is 3

2021-08-18:15:29:54,256 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:29:54,267 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:29:55,550 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:29:55,561 INFO     [learner.py:165] Start to run client 17 on rank 2...
2021-08-18:15:29:57,879 INFO     [learner.py:439] Completed to run client 17
2021-08-18:15:29:57,898 INFO     [learner.py:165] Start to run client 14 on rank 2...
2021-08-18:15:29:59,62 INFO     [learner.py:439] Completed to run client 14
2021-08-18:15:29:59,76 INFO     [learner.py:165] Start to run client 35 on rank 2...
2021-08-18:15:29:59,638 INFO     [learner.py:439] Completed to run client 35
2021-08-18:15:29:59,678 INFO     [learner.py:606] ====Pushing takes 0.03804969787597656 s
2021-08-18:15:29:59,745 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:59,755 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:59,756 INFO     [param_server.py:381] ====After aggregation in epoch: 3, virtual_clock: 178.02657935498743, top_1: : 40.5292 % (1256.0), top_5: : 100.0 % (3099.0), test loss: 2.4923938821863243, test len: 3099.0
2021-08-18:15:29:59,760 INFO     [param_server.py:410] Lock worker 2 with localStep 4 , while globalStep is 4

2021-08-18:15:29:59,761 INFO     [param_server.py:441] ====Epoch 5 completes 20 clients with loss 7.429759113806372, sampled rewards are: 
 {5: 0, 6: 0, 14: 0, 16: 0, 17: 0, 25: 0, 35: 0, 38: 0, 50: 0, 53: 0, 82: 0, 83: 0, 85: 0, 96: 0, 97: 0, 105: 0, 106: 0, 110: 0, 111: 0, 119: 0} 
==========
2021-08-18:15:29:59,762 INFO     [param_server.py:450] ====Start to sample for epoch 5, global virtualClock: 178.02657935498743, round_duration: 83.9361767219473
2021-08-18:15:29:59,763 INFO     [oort.py:208] Training selector: Pacer 3: lastExploitationUtil 583.8946034687353, lastExplorationUtil 158.08345234882879, last_util_record 0
2021-08-18:15:29:59,763 INFO     [oort.py:321] scores are 5,{5: 0.04497347499354656, 6: 0.09337982405272234, 7: 0.5087281089959189, 11: 0.09147707832201608, 14: 0.0063793563075552565, 16: 0.7796314196280518, 17: 0.024971153410658187, 25: 0.0018632762550952434, 27: 0.07177299306366035, 31: 0.041656427764640715, 35: 0.0022419377051248503, 37: 0.18372685695513322, 38: 0.031034481921865087, 49: 0.01758421178981765, 50: 0.011905009751152629, 51: 0.2645765940250184, 53: 0.5117993286408116, 55: 0.24797445397969187, 57: 0.027586765480807827, 58: 0.004645713780902914, 59: 0.004807464626038282, 60: 0.0020730900388786196, 65: 0.06340662687332871, 67: 0.0025374309155304572, 70: 0.0066266225158558185, 71: 0.036933418006625356, 73: 0.03946965325653609, 76: 0.001896826791557675, 81: 0.11828321870603954, 82: 0.1657266091042564, 83: 0.40634716389687864, 84: 0.21859996869059123, 85: 0.01810338037207351, 86: 0.0028328251440163585, 87: 0.09765558039338015, 88: 0.0020255423859778096, 96: 0.0025683124550254562, 97: 0.2840098293184391, 98: 0.22285770027880542, 99: 0.13971825237143567, 104: 0.0036442099577153496, 105: 0.013989484720284023, 106: 0.03801340206627692, 107: 0.012167579750468371, 110: 0.11831596470760188, 111: 0.0031859628397406595, 112: 0.16240235825095292, 118: 0.16918217425517568, 119: 0.005538351677841808},[16, 53, 7, 83, 97, 51, 55, 98, 84, 37, 118, 82, 112, 99, 110, 81, 87, 6, 11, 27, 65, 5, 31, 73, 106, 71, 38, 57, 17, 85, 49, 105, 107, 50, 70, 14, 119, 59, 58, 104, 111, 86, 96, 67, 35, 60, 88, 76, 25]
2021-08-18:15:29:59,764 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:29:59,765 INFO     [oort.py:398] At round 3, UCB exploited 49, augment_factor 1.8, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 107.32255222808412, 'duration': 8.010998429338052, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 20.486925875342866}, [0.056609855314551275, 0.1499249624812406]), ({'reward': 1398.6456437632905, 'duration': 13.324368782156236, 'time_stamp': 4, 'count': 2, 'status': True, 'gradient': 20.996180876083084}, [0.7378126134853566, -0.0001500750375187595]), ({'reward': 507.39394777710345, 'duration': 13.411352670399307, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 17.55660768489444}, [0.2676567574412953, 0.3])]
2021-08-18:15:29:59,766 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 84, 83, 98, 37, 97, 118, 81, 99, 11, 85, 71, 73, 57, 49, 17, 111, 25]
2021-08-18:15:30:00,159 INFO     [param_server.py:553] For epoch: 5, median_reward: 407.15471698515296, dev: 814.3094339703059
2021-08-18:15:30:00,803 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.792, Top-1 Accuracy: 372.0/1033 (0.3601), Top-5 Accuracy: 1.0
2021-08-18:15:30:00,803 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 52.2177, eval_time 0.6102, test_loss 2.792, test_accuracy 0.3601, test_5_accuracy 1.0 

2021-08-18:15:30:00,814 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5848, Top-1 Accuracy: 372.0/1033 (0.3601), Top-5 Accuracy: 1.0
2021-08-18:15:30:00,815 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 52.2321, eval_time 0.6218, test_loss 2.5848, test_accuracy 0.3601, test_5_accuracy 1.0 

2021-08-18:15:30:00,852 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6582, Top-1 Accuracy: 382.0/1033 (0.3698), Top-5 Accuracy: 1.0
2021-08-18:15:30:00,853 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 52.2723, eval_time 0.6596, test_loss 2.6582, test_accuracy 0.3698, test_5_accuracy 1.0 

2021-08-18:15:30:00,874 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:30:00,893 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:00,925 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:30:00,931 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:30:00,945 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:00,953 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:02,26 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:02,40 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:02,817 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:02,835 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:03,677 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:03,683 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:03,696 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:03,698 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:05,282 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:05,297 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:05,510 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:05,523 INFO     [learner.py:165] Start to run client 57 on rank 3...
2021-08-18:15:30:06,246 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:06,266 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:06,561 INFO     [learner.py:439] Completed to run client 57
2021-08-18:15:30:06,582 INFO     [learner.py:165] Start to run client 111 on rank 3...
2021-08-18:15:30:07,238 INFO     [learner.py:439] Completed to run client 111
2021-08-18:15:30:07,258 INFO     [learner.py:606] ====Pushing takes 0.018302440643310547 s
2021-08-18:15:30:07,293 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:07,302 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:30:07,302 INFO     [param_server.py:410] Lock worker 3 with localStep 5 , while globalStep is 4

2021-08-18:15:30:08,191 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:08,212 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:09,346 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:09,360 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:10,657 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:10,672 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:10,878 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:10,889 INFO     [learner.py:165] Start to run client 17 on rank 2...
2021-08-18:15:30:11,516 INFO     [learner.py:439] Completed to run client 17
2021-08-18:15:30:11,541 INFO     [learner.py:606] ====Pushing takes 0.023059844970703125 s
2021-08-18:15:30:11,574 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:11,583 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:30:11,583 INFO     [param_server.py:410] Lock worker 2 with localStep 5 , while globalStep is 4

2021-08-18:15:30:12,651 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:12,671 INFO     [learner.py:165] Start to run client 118 on rank 1...
2021-08-18:15:30:14,109 INFO     [learner.py:439] Completed to run client 118
2021-08-18:15:30:14,136 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:14,917 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:14,930 INFO     [learner.py:165] Start to run client 73 on rank 1...
2021-08-18:15:30:15,572 INFO     [learner.py:439] Completed to run client 73
2021-08-18:15:30:15,586 INFO     [learner.py:165] Start to run client 49 on rank 1...
2021-08-18:15:30:16,567 INFO     [learner.py:439] Completed to run client 49
2021-08-18:15:30:16,581 INFO     [learner.py:165] Start to run client 25 on rank 1...
2021-08-18:15:30:17,236 INFO     [learner.py:439] Completed to run client 25
2021-08-18:15:30:17,273 INFO     [learner.py:606] ====Pushing takes 0.03513622283935547 s
2021-08-18:15:30:17,327 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:17,338 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:17,339 INFO     [param_server.py:381] ====After aggregation in epoch: 4, virtual_clock: 229.89873777325184, top_1: : 36.3343 % (1126.0), top_5: : 100.0 % (3099.0), test loss: 2.678331507576837, test len: 3099.0
2021-08-18:15:30:17,340 INFO     [param_server.py:410] Lock worker 1 with localStep 5 , while globalStep is 5

2021-08-18:15:30:17,341 INFO     [param_server.py:441] ====Epoch 6 completes 20 clients with loss 6.6588889096648725, sampled rewards are: 
 {7: 0, 11: 0, 16: 0, 17: 0, 25: 0, 37: 0, 49: 0, 55: 0, 57: 0, 71: 0, 73: 0, 81: 0, 83: 0, 84: 0, 85: 0, 97: 0, 98: 0, 99: 0, 111: 0, 118: 0} 
==========
2021-08-18:15:30:17,341 INFO     [param_server.py:450] ====Start to sample for epoch 6, global virtualClock: 229.89873777325184, round_duration: 51.872158418264405
2021-08-18:15:30:17,342 INFO     [oort.py:208] Training selector: Pacer 4: lastExploitationUtil 654.2407070527554, lastExplorationUtil 368.48299097096793, last_util_record 0
2021-08-18:15:30:17,342 INFO     [oort.py:321] scores are 26,{5: 0.04675436895990838, 6: 0.1048959092458621, 7: 0.3984349436264084, 11: 0.028094668462669545, 14: 0.006783717265524609, 16: 0.5308145773855424, 17: 0.016986710612549926, 25: 0.006230630868950184, 27: 0.07412626720927398, 35: 0.0024040889409856513, 37: 0.21734509441475458, 38: 0.03486181551734679, 49: 0.007478664900930203, 50: 0.01274697288593479, 51: 0.2801383971216818, 53: 0.5239895336390092, 55: 0.16651092749169172, 57: 0.057975764734158684, 58: 0.004267701219840595, 59: 0.004416290717956489, 60: 0.0019044067940927167, 65: 0.06451053646232592, 67: 0.0026651750572667674, 70: 0.007134662534739523, 71: 0.03263832488895632, 73: 0.04153499085587909, 76: 0.0019757552836174403, 81: 0.24893536820929285, 82: 0.18616487581310387, 83: 0.1445434460175888, 84: 0.4175592200020497, 85: 0.07164900595665434, 86: 0.001873846773843985, 87: 0.10019695531979098, 88: 0.002109826837694711, 96: 0.0028850500943893506, 97: 0.1941824197601444, 98: 0.2983379497998077, 99: 0.08073480163864726, 104: 0.003957209345030543, 105: 0.01481869931134544, 106: 0.0388651687072948, 107: 0.012849557051599058, 110: 0.12015558940490982, 111: 0.0032010407397254606, 112: 0.17079212427613177, 118: 0.0712342886514239, 119: 0.0062213699893304275},[16, 53, 84, 7, 98, 51, 81, 37, 97, 82, 112, 55, 83, 110, 6, 87, 99, 27, 85, 118, 65, 57, 5, 73, 106, 38, 71, 11, 17, 105, 107, 50, 49, 70, 14, 25, 119, 59, 58, 104, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:30:17,343 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:30:17,344 INFO     [oort.py:398] At round 4, UCB exploited 48, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 294.4706432753186, 'duration': 13.324368782156236, 'time_stamp': 5, 'count': 3, 'status': True, 'gradient': 20.996671530262457}, [0.1548907846985455, -0.00010003334444814946]), ({'reward': 1222.1123338463353, 'duration': 26.145070720211294, 'time_stamp': 3, 'count': 1, 'status': True, 'gradient': 16.14901831923595}, [0.6428444307066844, 0.19996665555185061]), ({'reward': 1171.8571732506316, 'duration': 11.058674649423494, 'time_stamp': 4, 'count': 2, 'status': True, 'gradient': 19.679868571515033}, [0.6164094514548318, 0.09993331110370123])]
2021-08-18:15:30:17,344 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 11, 87, 85, 110, 71, 5]
2021-08-18:15:30:17,748 INFO     [param_server.py:553] For epoch: 6, median_reward: 412.2532988006377, dev: 824.5065976012754
2021-08-18:15:30:18,303 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8307, Top-1 Accuracy: 476.0/1033 (0.4608), Top-5 Accuracy: 1.0
2021-08-18:15:30:18,304 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 69.7214, eval_time 0.5228, test_loss 2.8307, test_accuracy 0.4608, test_5_accuracy 1.0 

2021-08-18:15:30:18,307 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8226, Top-1 Accuracy: 467.0/1033 (0.4521), Top-5 Accuracy: 1.0
2021-08-18:15:30:18,311 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 69.7248, eval_time 0.5292, test_loss 2.8226, test_accuracy 0.4521, test_5_accuracy 1.0 

2021-08-18:15:30:18,384 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8821, Top-1 Accuracy: 489.0/1033 (0.4734), Top-5 Accuracy: 1.0
2021-08-18:15:30:18,385 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 69.8046, eval_time 0.6036, test_loss 2.8821, test_accuracy 0.4734, test_5_accuracy 1.0 

2021-08-18:15:30:18,396 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:18,398 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:18,405 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:18,409 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:18,480 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:18,503 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:18,982 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:18,991 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:20,111 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:20,124 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:20,655 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:20,673 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:21,180 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:21,192 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:21,237 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:21,251 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:21,630 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:21,651 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:21,813 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:21,827 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:22,281 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:22,299 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:22,439 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:22,457 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:22,997 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:23,15 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:23,557 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:23,575 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:24,125 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:24,143 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:24,479 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:24,500 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:24,689 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:24,708 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:30:25,244 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:25,248 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:30:25,270 INFO     [learner.py:606] ====Pushing takes 0.023575305938720703 s
2021-08-18:15:30:25,290 INFO     [learner.py:606] ====Pushing takes 0.04045557975769043 s
2021-08-18:15:30:25,322 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:25,333 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:30:25,334 INFO     [param_server.py:410] Lock worker 3 with localStep 6 , while globalStep is 5

2021-08-18:15:30:25,356 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:25,365 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:30:25,366 INFO     [param_server.py:410] Lock worker 2 with localStep 6 , while globalStep is 5

2021-08-18:15:30:26,413 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:26,431 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:26,967 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:26,986 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:27,568 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:27,582 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:28,101 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:28,125 INFO     [learner.py:606] ====Pushing takes 0.022579431533813477 s
2021-08-18:15:30:28,157 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:28,168 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:28,169 INFO     [param_server.py:381] ====After aggregation in epoch: 5, virtual_clock: 253.3059711013821, top_1: : 46.2085 % (1432.0), top_5: : 100.0 % (3099.0), test loss: 2.845128500903094, test len: 3099.0
2021-08-18:15:30:28,170 INFO     [param_server.py:410] Lock worker 1 with localStep 6 , while globalStep is 6

2021-08-18:15:30:28,188 INFO     [param_server.py:441] ====Epoch 7 completes 20 clients with loss 9.641663389762366, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:28,188 INFO     [param_server.py:450] ====Start to sample for epoch 7, global virtualClock: 253.3059711013821, round_duration: 23.40723332813029
2021-08-18:15:30:28,189 INFO     [oort.py:208] Training selector: Pacer 5: lastExploitationUtil 621.6854762267317, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:28,190 INFO     [oort.py:321] scores are 26,{5: 0.014954568212376345, 6: 0.0922831287448403, 7: 0.5072050397491593, 11: 0.02763393139315125, 14: 0.007283782630158681, 16: 1.163780234482782, 17: 0.018193262686318785, 25: 0.006676542989192715, 27: 0.04441096210775342, 35: 0.0025827219151228187, 37: 0.06930356527092094, 38: 0.037562923487205586, 49: 0.008058114968595348, 50: 0.013692786335868509, 51: 0.09036914554563916, 53: 0.5412384635336371, 55: 0.3545768579654073, 58: 0.0045740547812414345, 59: 0.004733310659122375, 60: 0.002041113131690561, 65: 0.027322258551267603, 67: 0.0028593048965772487, 70: 0.007666807512280809, 71: 0.016189345101724394, 73: 0.044507883723855377, 76: 0.0021184848660348917, 81: 0.13544032166744652, 82: 0.2264519028858945, 83: 0.31255671578661903, 84: 0.35591714390552376, 85: 0.017890766003688673, 86: 0.0020083593845248286, 87: 0.08328146114409388, 88: 0.0022622418184437163, 96: 0.003108584975971159, 97: 0.2849659017635197, 98: 0.197909053732725, 99: 0.220281979483643, 104: 0.0042412744924271726, 105: 0.015907009155544903, 106: 0.023577338575578772, 107: 0.013790470005941616, 110: 0.0942812559412484, 111: 0.003449058707879388, 119: 0.006703404324382745},[16, 53, 7, 84, 55, 83, 97, 82, 99, 98, 81, 110, 6, 51, 87, 37, 73, 27, 38, 11, 65, 106, 17, 85, 71, 105, 5, 107, 50, 49, 70, 14, 119, 25, 59, 58, 104, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:30:28,191 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:30:28,191 INFO     [oort.py:398] At round 5, UCB exploited 45, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 621.6881792070631, 'duration': 30.380154975061778, 'time_stamp': 6, 'count': 2, 'status': True, 'gradient': 19.469976100849514}, [0.3495852163964267, -7.501875468867222e-05]), ({'reward': 1778.3408805777217, 'duration': 7.864087706209871, 'time_stamp': 6, 'count': 4, 'status': True, 'gradient': 21.308938878081925}, [1.0, -7.501875468867222e-05]), ({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 6, 'count': 2, 'status': True, 'gradient': 26.362927566611027}, [5.623250460858226e-09, -7.501875468867222e-05])]
2021-08-18:15:30:28,192 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 27]
2021-08-18:15:30:28,562 INFO     [param_server.py:553] For epoch: 7, median_reward: 380.29221412412693, dev: 760.5844282482539
2021-08-18:15:30:29,241 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5834, Top-1 Accuracy: 442.0/1033 (0.4279), Top-5 Accuracy: 1.0
2021-08-18:15:30:29,242 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 80.656, eval_time 0.651, test_loss 2.5834, test_accuracy 0.4279, test_5_accuracy 1.0 

2021-08-18:15:30:29,261 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6116, Top-1 Accuracy: 439.0/1033 (0.425), Top-5 Accuracy: 1.0
2021-08-18:15:30:29,265 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 80.6817, eval_time 0.6777, test_loss 2.6116, test_accuracy 0.425, test_5_accuracy 1.0 

2021-08-18:15:30:29,307 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6754, Top-1 Accuracy: 444.0/1033 (0.4298), Top-5 Accuracy: 1.0
2021-08-18:15:30:29,308 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 80.7276, eval_time 0.7215, test_loss 2.6754, test_accuracy 0.4298, test_5_accuracy 1.0 

2021-08-18:15:30:29,311 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:29,327 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:29,335 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:29,347 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:29,383 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:29,406 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:29,926 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:29,936 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:31,59 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:31,68 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:31,569 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:31,579 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:32,261 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:32,275 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:32,316 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:32,326 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:32,393 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:32,420 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:32,890 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:32,908 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:32,913 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:32,922 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:33,470 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:33,484 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:33,879 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:33,906 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:34,192 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:34,212 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:35,306 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:35,326 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:35,339 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:35,364 INFO     [learner.py:606] ====Pushing takes 0.023663043975830078 s
2021-08-18:15:30:35,413 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:35,424 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:30:35,425 INFO     [param_server.py:410] Lock worker 2 with localStep 7 , while globalStep is 6

2021-08-18:15:30:35,637 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:35,652 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:36,304 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:36,318 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:30:36,927 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:30:36,976 INFO     [learner.py:606] ====Pushing takes 0.04747200012207031 s
2021-08-18:15:30:37,17 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:37,25 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:30:37,26 INFO     [param_server.py:410] Lock worker 3 with localStep 7 , while globalStep is 6

2021-08-18:15:30:37,572 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:37,590 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:38,116 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:45,700 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:46,305 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:47,796 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:48,330 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:48,354 INFO     [learner.py:606] ====Pushing takes 0.02227640151977539 s
2021-08-18:15:30:48,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:48,408 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:48,408 INFO     [param_server.py:381] ====After aggregation in epoch: 6, virtual_clock: 276.70524574821576, top_1: : 42.7557 % (1325.0), top_5: : 100.0 % (3099.0), test loss: 2.6234434975518117, test len: 3099.0
2021-08-18:15:30:48,443 INFO     [param_server.py:410] Lock worker 1 with localStep 7 , while globalStep is 7

2021-08-18:15:30:48,444 INFO     [param_server.py:441] ====Epoch 8 completes 20 clients with loss 7.099252831667092, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:48,444 INFO     [param_server.py:450] ====Start to sample for epoch 8, global virtualClock: 276.70524574821576, round_duration: 23.399274646833632
2021-08-18:15:30:48,445 INFO     [oort.py:208] Training selector: Pacer 6: lastExploitationUtil 615.3434366387579, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:48,446 INFO     [oort.py:321] scores are 26,{5: 0.015778896124555512, 6: 0.6536041118695662, 7: 0.8777941180002883, 11: 0.10603849403347304, 14: 0.00738280906219384, 16: 0.15998926706542557, 17: 0.011899292415172727, 25: 0.006608271428595408, 27: 0.013840583282574039, 35: 0.002634643249756026, 37: 0.06769941603173373, 38: 0.19679129894354033, 49: 0.00850229557131047, 50: 0.02063815425549811, 51: 0.09715726374671192, 53: 0.28792536319841355, 55: 0.15998926706542557, 58: 0.004538284184480596, 59: 0.004696294629575546, 60: 0.002025150962834083, 65: 0.026221381925225565, 67: 0.002870428200543494, 70: 0.007844838876707868, 71: 0.01708173656751128, 73: 0.03704078015984311, 76: 0.00211265151801824, 81: 0.04114890269542722, 82: 0.7635168846431674, 83: 0.0719517024609189, 84: 0.3891883212742377, 85: 0.07885177104257582, 86: 0.0019926533606290705, 87: 0.043944130881929354, 88: 0.0022560126288769743, 96: 0.0032799368568217817, 97: 0.29083912827538894, 98: 0.07102139472331191, 99: 0.06244273731760768, 104: 0.004208106345809683, 105: 0.016075038132341568, 106: 0.022627353387003293, 107: 0.011940638338120528, 110: 0.04660184522574127, 111: 0.0036391782310726344, 119: 0.00707291036908282},[7, 82, 6, 84, 97, 53, 38, 16, 55, 11, 51, 85, 83, 98, 37, 99, 110, 87, 81, 73, 65, 106, 50, 71, 105, 5, 27, 107, 17, 49, 70, 14, 119, 25, 59, 58, 104, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:30:48,447 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:30:48,447 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:30:48,448 INFO     [oort.py:398] At round 6, UCB exploited 45, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1849.578693043965, 'duration': 11.90395711384456, 'time_stamp': 7, 'count': 5, 'status': True, 'gradient': 20.30074399744499}, [1.0, -4.286326618088302e-05]), ({'reward': 1298.4658320132967, 'duration': 13.298442137908651, 'time_stamp': 7, 'count': 4, 'status': True, 'gradient': 14.543618770495835}, [0.7020316898076491, -4.286326618088302e-05]), ({'reward': 615.3458033442831, 'duration': 43.65853298740619, 'time_stamp': 7, 'count': 3, 'status': True, 'gradient': 18.791048762113913}, [0.3326915146929021, -4.286326618088302e-05])]
2021-08-18:15:30:48,449 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 5]
2021-08-18:15:30:48,817 INFO     [param_server.py:553] For epoch: 8, median_reward: 373.741328807336, dev: 747.482657614672
2021-08-18:15:30:49,429 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6181, Top-1 Accuracy: 469.0/1033 (0.454), Top-5 Accuracy: 1.0
2021-08-18:15:30:49,433 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 100.8471, eval_time 0.5853, test_loss 2.6181, test_accuracy 0.454, test_5_accuracy 1.0 

2021-08-18:15:30:49,432 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7537, Top-1 Accuracy: 480.0/1033 (0.4647), Top-5 Accuracy: 1.0
2021-08-18:15:30:49,435 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 100.8521, eval_time 0.589, test_loss 2.7537, test_accuracy 0.4647, test_5_accuracy 1.0 

2021-08-18:15:30:49,465 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8753, Top-1 Accuracy: 467.0/1033 (0.4521), Top-5 Accuracy: 1.0
2021-08-18:15:30:49,466 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 100.886, eval_time 0.6257, test_loss 2.8753, test_accuracy 0.4521, test_5_accuracy 1.0 

2021-08-18:15:30:49,505 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:30:49,516 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:49,530 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:30:49,538 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:30:49,539 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:49,551 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:50,27 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:50,37 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:51,30 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:51,41 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:51,152 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:51,161 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:51,665 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:51,675 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:51,750 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:51,771 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:52,252 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:52,266 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:52,310 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:52,323 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:52,845 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:52,863 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:52,863 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:52,883 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:52,955 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:52,970 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:53,359 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:53,377 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:30:53,591 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:53,606 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:54,7 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:30:54,36 INFO     [learner.py:606] ====Pushing takes 0.0270078182220459 s
2021-08-18:15:30:54,54 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:54,78 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:54,81 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:54,86 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:30:54,112 INFO     [param_server.py:410] Lock worker 2 with localStep 8 , while globalStep is 7

2021-08-18:15:30:54,930 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:54,942 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:55,498 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:55,526 INFO     [learner.py:606] ====Pushing takes 0.025975704193115234 s
2021-08-18:15:30:55,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:55,574 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:30:55,575 INFO     [param_server.py:410] Lock worker 3 with localStep 8 , while globalStep is 7

2021-08-18:15:30:56,275 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:56,302 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:56,908 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:56,935 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:57,561 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:57,588 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:58,166 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:58,190 INFO     [learner.py:606] ====Pushing takes 0.022686481475830078 s
2021-08-18:15:30:58,234 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:58,244 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:58,245 INFO     [param_server.py:381] ====After aggregation in epoch: 7, virtual_clock: 296.4606475135985, top_1: : 45.6922 % (1416.0), top_5: : 100.0 % (3099.0), test loss: 2.7490452395545106, test len: 3099.0
2021-08-18:15:30:58,246 INFO     [param_server.py:410] Lock worker 1 with localStep 8 , while globalStep is 8

2021-08-18:15:30:58,247 INFO     [param_server.py:441] ====Epoch 9 completes 20 clients with loss 7.5593121140366, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:58,247 INFO     [param_server.py:450] ====Start to sample for epoch 9, global virtualClock: 296.4606475135985, round_duration: 19.755401765382704
2021-08-18:15:30:58,248 INFO     [oort.py:208] Training selector: Pacer 7: lastExploitationUtil 574.0579494821043, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:58,248 INFO     [oort.py:321] scores are 26,{5: 0.08360195850533024, 6: 0.30803070748418354, 7: 0.15596114394905267, 11: 0.10079802127486641, 14: 0.0073277226550111044, 16: 0.7147323760709258, 17: 0.01069503712199315, 25: 0.006358569010080665, 27: 0.038308074244591914, 35: 0.0026361633185245734, 37: 0.4053241489673766, 38: 0.029205770446647978, 49: 0.008860489894441619, 50: 0.018549491700071745, 51: 0.08605479701258058, 53: 0.10182484642572197, 55: 0.161752178615031, 58: 0.004380995032788041, 59: 0.004533529106669276, 60: 0.0019549627013579034, 65: 0.023567674723470256, 67: 0.0028140449760366355, 70: 0.00787929082969301, 71: 0.01780137527798846, 73: 0.03329210721235638, 76: 0.002053247398631601, 81: 0.040112877909508, 82: 0.4094749202402809, 83: 0.2125836065835295, 84: 0.11496056007700518, 85: 0.05697411812389977, 86: 0.0019235914103478463, 87: 0.019316581432903664, 88: 0.0021925774421457113, 96: 0.00341811774719436, 97: 0.36179759378683873, 98: 0.0692332565119841, 99: 0.08501041722288072, 104: 0.0040622605921153895, 105: 0.018405705512309398, 106: 0.021779445794727164, 107: 0.011493190608359469, 110: 0.06661159401809559, 111: 0.0037924936471622865, 119: 0.007370885938427266},[16, 82, 37, 97, 6, 83, 55, 7, 84, 53, 11, 51, 99, 5, 98, 110, 85, 81, 27, 73, 38, 65, 106, 87, 50, 105, 71, 107, 17, 49, 70, 119, 14, 25, 59, 58, 104, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:30:58,249 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:30:58,250 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:30:58,250 INFO     [oort.py:398] At round 7, UCB exploited 45, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 967.8922198796399, 'duration': 27.689063957948644, 'time_stamp': 8, 'count': 5, 'status': True, 'gradient': 8.082536435293656}, [0.48366007804534916, -3.750468808601078e-05]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 8, 'count': 5, 'status': True, 'gradient': 9.698796474327247}, [4.997096373031609e-09, -3.750468808601078e-05]), ({'reward': 1520.1633062073804, 'duration': 29.570969934622333, 'time_stamp': 8, 'count': 4, 'status': True, 'gradient': 8.082289634269143}, [0.7596352622872182, -3.750468808601078e-05])]
2021-08-18:15:30:58,251 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 11, 87, 85, 110, 71, 5]
2021-08-18:15:30:58,636 INFO     [param_server.py:553] For epoch: 9, median_reward: 372.352865070864, dev: 744.705730141728
2021-08-18:15:30:59,281 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1104, Top-1 Accuracy: 475.0/1033 (0.4598), Top-5 Accuracy: 1.0
2021-08-18:15:30:59,282 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 110.7015, eval_time 0.6117, test_loss 2.1104, test_accuracy 0.4598, test_5_accuracy 1.0 

2021-08-18:15:30:59,282 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1435, Top-1 Accuracy: 468.0/1033 (0.453), Top-5 Accuracy: 1.0
2021-08-18:15:30:59,283 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 110.6971, eval_time 0.6063, test_loss 2.1435, test_accuracy 0.453, test_5_accuracy 1.0 

2021-08-18:15:30:59,290 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0863, Top-1 Accuracy: 474.0/1033 (0.4589), Top-5 Accuracy: 1.0
2021-08-18:15:30:59,291 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 110.7084, eval_time 0.6201, test_loss 2.0863, test_accuracy 0.4589, test_5_accuracy 1.0 

2021-08-18:15:30:59,343 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:30:59,347 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:30:59,357 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:59,365 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:30:59,367 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:59,379 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:59,946 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:59,956 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:01,78 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:01,93 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:01,559 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:01,569 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:01,662 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:01,672 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:02,200 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:02,210 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:02,436 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:02,439 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:02,449 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:02,451 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:03,95 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:03,109 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:03,487 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:03,497 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:03,711 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:03,729 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:03,752 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:03,766 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:04,810 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:04,824 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:05,373 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:05,388 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:05,462 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:05,476 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:05,951 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:05,976 INFO     [learner.py:606] ====Pushing takes 0.024305105209350586 s
2021-08-18:15:31:06,22 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:06,30 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:06,31 INFO     [param_server.py:410] Lock worker 2 with localStep 9 , while globalStep is 8

2021-08-18:15:31:06,37 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:06,58 INFO     [learner.py:606] ====Pushing takes 0.01930856704711914 s
2021-08-18:15:31:06,97 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:06,103 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:06,104 INFO     [param_server.py:410] Lock worker 3 with localStep 9 , while globalStep is 8

2021-08-18:15:31:06,183 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:06,204 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:06,789 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:06,810 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:07,489 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:07,510 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:08,57 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:08,81 INFO     [learner.py:606] ====Pushing takes 0.02203822135925293 s
2021-08-18:15:31:08,132 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:08,144 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:08,144 INFO     [param_server.py:381] ====After aggregation in epoch: 8, virtual_clock: 317.48887891863166, top_1: : 45.7244 % (1417.0), top_5: : 100.0 % (3099.0), test loss: 2.113361226187812, test len: 3099.0
2021-08-18:15:31:08,146 INFO     [param_server.py:410] Lock worker 1 with localStep 9 , while globalStep is 9

2021-08-18:15:31:08,146 INFO     [param_server.py:441] ====Epoch 10 completes 20 clients with loss 4.643537711473846, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:08,146 INFO     [param_server.py:450] ====Start to sample for epoch 10, global virtualClock: 317.48887891863166, round_duration: 21.0282314050332
2021-08-18:15:31:08,147 INFO     [oort.py:208] Training selector: Pacer 8: lastExploitationUtil 448.77727230761224, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:08,148 INFO     [oort.py:321] scores are 26,{5: 0.10012402648832716, 6: 0.10659622380735002, 7: 1.1520029802953378, 11: 0.13540170711811264, 14: 0.00825539890782534, 16: 0.48149170263016977, 17: 0.012698167867683564, 25: 0.007554593436966085, 27: 0.037802972596124786, 35: 0.002928570456720572, 37: 0.06432002358492599, 38: 0.030191218196166353, 49: 0.00915945647813256, 50: 0.018304911960142476, 51: 0.08387080159762003, 53: 0.21003529047569822, 55: 0.19447386963484553, 58: 0.005176470326591762, 59: 0.005356700639872414, 60: 0.002309933322780481, 65: 0.023256928971090326, 67: 0.0032385282273962356, 70: 0.008695346768087097, 71: 0.04868768776726554, 73: 0.03285314235793591, 76: 0.002398343042160192, 81: 0.09510463944928237, 82: 0.27853174717949514, 83: 0.4049528230812166, 84: 0.26783587858054986, 85: 0.016604261076774412, 86: 0.002272865817383861, 87: 0.04461112837307998, 88: 0.0025610907172083364, 96: 0.0035334503053833883, 97: 0.07427572110167643, 98: 0.06747617706918609, 99: 0.10185075190678436, 104: 0.004799861962086313, 105: 0.018163021629634703, 106: 0.020069222591927477, 107: 0.013647480463026228, 110: 0.015829933352592456, 111: 0.003920458227323139, 119: 0.007619590984383079},[7, 16, 83, 82, 84, 53, 55, 11, 6, 99, 5, 81, 51, 97, 98, 37, 71, 87, 27, 73, 38, 65, 106, 50, 105, 85, 110, 107, 17, 49, 70, 14, 119, 25, 59, 58, 104, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:31:08,149 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999996
2021-08-18:15:31:08,149 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:08,150 INFO     [oort.py:398] At round 8, UCB exploited 45, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1574.7603567055405, 'duration': 5.8943907365129, 'time_stamp': 9, 'count': 6, 'status': True, 'gradient': 20.613817968136228}, [1.0, -3.3337037448605424e-05]), ({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 9, 'count': 5, 'status': True, 'gradient': 26.375688050950515}, [6.350212840985147e-09, -3.3337037448605424e-05]), ({'reward': 694.8402955477914, 'duration': 13.298442137908651, 'time_stamp': 9, 'count': 6, 'status': True, 'gradient': 12.933594594368175}, [0.44123203285953977, -3.3337037448605424e-05])]
2021-08-18:15:31:08,151 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 71, 5]
2021-08-18:15:31:08,491 INFO     [param_server.py:553] For epoch: 10, median_reward: 344.8645668996015, dev: 689.729133799203
2021-08-18:15:31:09,130 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1265, Top-1 Accuracy: 522.0/1033 (0.5053), Top-5 Accuracy: 1.0
2021-08-18:15:31:09,133 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 120.5475, eval_time 0.595, test_loss 2.1265, test_accuracy 0.5053, test_5_accuracy 1.0 

2021-08-18:15:31:09,136 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1362, Top-1 Accuracy: 511.0/1033 (0.4947), Top-5 Accuracy: 1.0
2021-08-18:15:31:09,140 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 120.5567, eval_time 0.6032, test_loss 2.1362, test_accuracy 0.4947, test_5_accuracy 1.0 

2021-08-18:15:31:09,188 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:31:09,201 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:09,208 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:31:09,221 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.882, Top-1 Accuracy: 506.0/1033 (0.4898), Top-5 Accuracy: 1.0
2021-08-18:15:31:09,222 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:09,222 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 120.6415, eval_time 0.6855, test_loss 1.882, test_accuracy 0.4898, test_5_accuracy 1.0 

2021-08-18:15:31:09,289 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:31:09,321 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:09,699 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:09,711 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:10,290 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:10,309 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:10,758 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:10,771 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:11,327 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:11,341 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:11,514 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:11,527 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:11,901 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:11,945 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:11,977 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:11,998 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:12,124 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:12,144 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:12,520 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:12,538 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:12,862 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:12,882 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:12,894 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:12,909 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:13,727 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:13,747 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:14,165 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:14,174 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:14,261 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:14,273 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:14,287 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:14,289 INFO     [learner.py:606] ====Pushing takes 0.02653026580810547 s
2021-08-18:15:31:14,340 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:14,348 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:14,349 INFO     [param_server.py:410] Lock worker 2 with localStep 10 , while globalStep is 9

2021-08-18:15:31:14,842 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:14,867 INFO     [learner.py:606] ====Pushing takes 0.023836374282836914 s
2021-08-18:15:31:14,898 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:14,905 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:14,905 INFO     [param_server.py:410] Lock worker 3 with localStep 10 , while globalStep is 9

2021-08-18:15:31:16,3 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:16,22 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:16,641 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:16,656 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:17,284 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:17,299 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:17,845 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:17,868 INFO     [learner.py:606] ====Pushing takes 0.02180171012878418 s
2021-08-18:15:31:17,914 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:17,922 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:17,923 INFO     [param_server.py:381] ====After aggregation in epoch: 9, virtual_clock: 336.41229492042555, top_1: : 49.6612 % (1539.0), top_5: : 100.0 % (3099.0), test loss: 2.048253422534024, test len: 3099.0
2021-08-18:15:31:17,924 INFO     [param_server.py:410] Lock worker 1 with localStep 10 , while globalStep is 10

2021-08-18:15:31:17,924 INFO     [param_server.py:441] ====Epoch 11 completes 20 clients with loss 5.86689976101642, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:31:17,925 INFO     [param_server.py:450] ====Start to sample for epoch 11, global virtualClock: 336.41229492042555, round_duration: 18.923416001793925
2021-08-18:15:31:17,926 INFO     [oort.py:208] Training selector: Pacer 9: lastExploitationUtil 484.78202296192626, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:17,927 INFO     [oort.py:321] scores are 26,{5: 0.0888190605164138, 6: 0.5688900934114917, 7: 0.6122693910586487, 11: 0.025010272207602404, 14: 0.009218437765204528, 16: 0.7335514013288013, 17: 0.014820683390407157, 25: 0.008822128050193419, 27: 0.04554577289039725, 35: 0.003229384911166368, 37: 0.06272364969439895, 38: 0.027758085067097194, 49: 0.009415287204207515, 50: 0.0220541218232354, 51: 0.45523698619513564, 53: 0.44033528394331206, 55: 0.38624019074040683, 58: 0.006018232312711125, 59: 0.0062277704394040736, 60: 0.0026855587854820546, 65: 0.02802041036196093, 67: 0.003683714905816318, 70: 0.009530484006425734, 71: 0.014652273760703171, 76: 0.0027622378808635256, 81: 0.038124543892181464, 82: 1.148230380736751, 83: 0.4566776107094721, 84: 0.3473678630987701, 85: 0.016192155990720478, 86: 0.0026424636174128867, 87: 0.05526373459663418, 88: 0.002949678870387503, 96: 0.003632142311614401, 97: 0.046393772327217905, 98: 0.16251346871559644, 99: 0.10558543675914749, 104: 0.005580382487346381, 105: 0.021883169532321833, 106: 0.02325779975556511, 107: 0.012759876164117244, 110: 0.016272075707076082, 111: 0.004029959667418098, 119: 0.007832412067436888},[82, 16, 7, 6, 83, 51, 53, 55, 84, 98, 99, 5, 37, 87, 97, 27, 81, 65, 38, 11, 106, 50, 105, 110, 85, 17, 71, 107, 70, 49, 14, 25, 119, 59, 58, 104, 111, 67, 96, 35, 88, 76, 60, 86]
2021-08-18:15:31:17,928 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:31:17,928 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:17,929 INFO     [oort.py:398] At round 9, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 484.78396209001806, 'duration': 30.380154975061778, 'time_stamp': 10, 'count': 6, 'status': True, 'gradient': 16.407788777991794}, [0.37825283705057006, -3.0003000300030024e-05]), ({'reward': 750.1653578029809, 'duration': 7.864087706209871, 'time_stamp': 10, 'count': 8, 'status': True, 'gradient': 21.32459894210776}, [0.5853210205920502, -3.0003000300030024e-05]), ({'reward': 1281.6235685525035, 'duration': 6.342067858842259, 'time_stamp': 10, 'count': 8, 'status': True, 'gradient': 50.12726895674252}, [1.0, -3.0003000300030024e-05])]
2021-08-18:15:31:17,930 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 110, 71, 5]
2021-08-18:15:31:18,335 INFO     [param_server.py:553] For epoch: 11, median_reward: 350.97754429901073, dev: 701.9550885980215
2021-08-18:15:31:18,975 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9446, Top-1 Accuracy: 500.0/1033 (0.484), Top-5 Accuracy: 1.0
2021-08-18:15:31:18,976 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 130.3933, eval_time 0.6041, test_loss 1.9446, test_accuracy 0.484, test_5_accuracy 1.0 

2021-08-18:15:31:18,976 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9564, Top-1 Accuracy: 514.0/1033 (0.4976), Top-5 Accuracy: 1.0
2021-08-18:15:31:18,977 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 130.391, eval_time 0.6006, test_loss 1.9564, test_accuracy 0.4976, test_5_accuracy 1.0 

2021-08-18:15:31:19,18 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0113, Top-1 Accuracy: 515.0/1033 (0.4985), Top-5 Accuracy: 1.0
2021-08-18:15:31:19,19 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 130.4389, eval_time 0.6484, test_loss 2.0113, test_accuracy 0.4985, test_5_accuracy 1.0 

2021-08-18:15:31:19,44 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:19,62 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:19,62 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:19,78 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:19,84 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:19,109 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:19,733 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:19,743 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:20,839 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:20,849 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:21,385 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:21,397 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:21,879 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:21,907 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:22,10 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:22,20 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:22,27 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:22,37 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:22,569 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:22,581 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:22,590 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:22,600 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:23,232 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:23,241 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:23,387 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:23,414 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:23,848 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:23,860 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:24,400 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:24,414 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:24,715 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:24,742 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:24,961 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:24,979 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:25,24 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:25,51 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:25,477 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:25,509 INFO     [learner.py:606] ====Pushing takes 0.030808687210083008 s
2021-08-18:15:31:25,559 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:25,568 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:31:25,569 INFO     [param_server.py:410] Lock worker 2 with localStep 11 , while globalStep is 10

2021-08-18:15:31:25,610 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:25,635 INFO     [learner.py:606] ====Pushing takes 0.024196863174438477 s
2021-08-18:15:31:25,663 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:25,670 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:31:25,670 INFO     [param_server.py:410] Lock worker 3 with localStep 11 , while globalStep is 10

2021-08-18:15:31:27,55 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:27,68 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:27,704 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:27,724 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:28,374 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:28,394 INFO     [learner.py:606] ====Pushing takes 0.018027782440185547 s
2021-08-18:15:31:28,429 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:28,443 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:28,444 INFO     [param_server.py:381] ====After aggregation in epoch: 10, virtual_clock: 357.44052632545873, top_1: : 49.3385 % (1529.0), top_5: : 100.0 % (3099.0), test loss: 1.9707903111422505, test len: 3099.0
2021-08-18:15:31:28,446 INFO     [param_server.py:410] Lock worker 1 with localStep 11 , while globalStep is 11

2021-08-18:15:31:28,446 INFO     [param_server.py:441] ====Epoch 12 completes 20 clients with loss 4.885830663822695, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:28,447 INFO     [param_server.py:450] ====Start to sample for epoch 12, global virtualClock: 357.44052632545873, round_duration: 21.0282314050332
2021-08-18:15:31:28,448 INFO     [oort.py:208] Training selector: Pacer 10: lastExploitationUtil 296.010002698384, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:28,449 INFO     [oort.py:321] scores are 26,{5: 0.013210641249319765, 6: 0.08152153174198204, 7: 0.37083521173273193, 11: 0.07141826324652133, 14: 0.009172571877685344, 16: 0.5554302730750856, 17: 0.008875775554283538, 25: 0.008649935544299355, 27: 0.031791742752591966, 35: 0.0032268761925199935, 37: 0.14378597609449997, 38: 0.06067656084709263, 49: 0.00963838326055359, 50: 0.015394161151373294, 51: 0.631601491262468, 53: 0.3982220164997605, 55: 1.020385014751917, 58: 0.005909267570243681, 59: 0.006115011847376521, 60: 0.0026369346702542046, 65: 0.019558734466823414, 67: 0.0036430007780767584, 70: 0.009542597563603032, 71: 0.014301424632462059, 76: 0.002720554545030342, 81: 0.03721165056193017, 82: 0.14468100750495916, 83: 0.0650671447821918, 84: 0.06532110192372123, 85: 0.01657583053280531, 86: 0.0025946197734750516, 87: 0.04450235768395913, 88: 0.002905166970885216, 96: 0.003718206243192695, 97: 0.12114004150079123, 98: 0.13474127434478977, 99: 0.06940443245174636, 104: 0.0054793453540141835, 105: 0.015274833474823179, 106: 0.022860608371559815, 107: 0.008906615802540775, 110: 0.015067405955187352, 111: 0.004125449915302723, 119: 0.008018001760359817},[55, 51, 16, 53, 7, 82, 37, 98, 97, 6, 11, 99, 84, 83, 38, 87, 81, 27, 106, 65, 85, 50, 105, 110, 71, 5, 49, 70, 14, 107, 17, 25, 119, 59, 58, 104, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:31:28,449 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:31:28,450 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:28,450 INFO     [oort.py:398] At round 10, UCB exploited 44, augment_factor 1.2692307692307692, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 618.094439499388, 'duration': 11.058674649423494, 'time_stamp': 11, 'count': 8, 'status': True, 'gradient': 14.557411164601561}, [0.4652601236195359, -2.72752068369852e-05]), ({'reward': 1163.3571294141163, 'duration': 8.010998429338052, 'time_stamp': 11, 'count': 9, 'status': True, 'gradient': 20.51749350565781}, [0.8757040147744101, -2.72752068369852e-05]), ({'reward': 211.0368667436033, 'duration': 13.411352670399307, 'time_stamp': 11, 'count': 8, 'status': True, 'gradient': 12.939398902156436}, [0.15884947573150462, -2.72752068369852e-05])]
2021-08-18:15:31:28,451 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 87, 85, 110, 71, 27]
2021-08-18:15:31:28,807 INFO     [param_server.py:553] For epoch: 12, median_reward: 309.3327981449316, dev: 618.6655962898632
2021-08-18:15:31:29,477 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.7541, Top-1 Accuracy: 544.0/1033 (0.5266), Top-5 Accuracy: 1.0
2021-08-18:15:31:29,481 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 140.8981, eval_time 0.6501, test_loss 1.7541, test_accuracy 0.5266, test_5_accuracy 1.0 

2021-08-18:15:31:29,487 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.7286, Top-1 Accuracy: 556.0/1033 (0.5382), Top-5 Accuracy: 1.0
2021-08-18:15:31:29,488 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 140.9075, eval_time 0.6568, test_loss 1.7286, test_accuracy 0.5382, test_5_accuracy 1.0 

2021-08-18:15:31:29,486 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.8235, Top-1 Accuracy: 541.0/1033 (0.5237), Top-5 Accuracy: 1.0
2021-08-18:15:31:29,490 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 140.9041, eval_time 0.6579, test_loss 1.8235, test_accuracy 0.5237, test_5_accuracy 1.0 

2021-08-18:15:31:29,553 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:29,553 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:29,565 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:29,569 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:29,569 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:29,577 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:30,224 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:30,242 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:31,367 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:31,376 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:31,854 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:31,863 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:32,450 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:32,460 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:32,517 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:32,527 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:32,579 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:32,607 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:32,960 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:32,971 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:33,97 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:33,116 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:33,578 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:33,587 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:34,147 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:34,162 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:34,174 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:34,176 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:35,233 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:35,248 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:35,597 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:35,624 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:35,828 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:35,858 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:35,858 INFO     [learner.py:606] ====Pushing takes 0.0278780460357666 s
2021-08-18:15:31:35,872 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:31:35,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:35,902 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:31:35,903 INFO     [param_server.py:410] Lock worker 2 with localStep 12 , while globalStep is 11

2021-08-18:15:31:36,385 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:31:36,416 INFO     [learner.py:606] ====Pushing takes 0.02873086929321289 s
2021-08-18:15:31:36,457 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:36,464 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:36,465 INFO     [param_server.py:410] Lock worker 3 with localStep 12 , while globalStep is 11

2021-08-18:15:31:38,189 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:38,203 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:38,845 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:38,859 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:39,608 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:39,622 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:40,241 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:40,265 INFO     [learner.py:606] ====Pushing takes 0.021918296813964844 s
2021-08-18:15:31:40,305 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:40,312 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:40,312 INFO     [param_server.py:381] ====After aggregation in epoch: 11, virtual_clock: 381.83706959061067, top_1: : 52.9526 % (1641.0), top_5: : 100.0 % (3099.0), test loss: 1.7687556920228182, test len: 3099.0
2021-08-18:15:31:40,313 INFO     [param_server.py:410] Lock worker 1 with localStep 12 , while globalStep is 12

2021-08-18:15:31:40,314 INFO     [param_server.py:441] ====Epoch 13 completes 20 clients with loss 3.120691619255012, sampled rewards are: 
 {6: 0, 7: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:40,314 INFO     [param_server.py:450] ====Start to sample for epoch 13, global virtualClock: 381.83706959061067, round_duration: 24.39654326515194
2021-08-18:15:31:40,315 INFO     [oort.py:208] Training selector: Pacer 11: lastExploitationUtil 377.6685957474872, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:40,316 INFO     [oort.py:321] scores are 26,{5: 0.01348128102869833, 6: 0.22311699633405008, 7: 0.45202645370152117, 11: 0.07643882421160182, 14: 0.009687728504239046, 16: 1.1413593315160095, 17: 0.010940418320610162, 25: 0.005092879646794158, 27: 0.0381049454351729, 35: 0.003390834492966981, 37: 0.2919781005042271, 38: 0.062210811244301396, 49: 0.009835839970385616, 50: 0.018975081294121857, 51: 0.301832733077037, 53: 0.09229153299461225, 55: 0.14135933976734605, 58: 0.00634180837867287, 59: 0.006562612524884721, 60: 0.002829950444288562, 65: 0.02085687183707278, 67: 0.003876117709974279, 70: 0.008071675813815826, 71: 0.11243277237637286, 76: 0.002908939235671483, 81: 0.095677804685769, 82: 0.7061314284961778, 83: 0.3791716057147517, 84: 0.2146032991935457, 85: 0.015441587267036632, 86: 0.0027845382229351053, 87: 0.03061753247624848, 88: 0.003106335141569685, 96: 0.0037943792632279955, 97: 0.13026986227451395, 98: 0.0627513185827516, 99: 0.029506895477134216, 104: 0.0058804171350623855, 105: 0.016288643043721344, 106: 0.0208039858930131, 107: 0.00949775889696459, 110: 0.014721479996321257, 111: 0.004209965932650398, 119: 0.015137936985853464},[16, 82, 7, 83, 51, 37, 6, 84, 55, 97, 71, 81, 53, 11, 98, 38, 27, 87, 99, 65, 106, 50, 105, 85, 119, 110, 5, 17, 49, 14, 107, 70, 59, 58, 104, 25, 111, 67, 96, 35, 88, 76, 60, 86]
2021-08-18:15:31:40,317 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:31:40,317 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:40,318 INFO     [oort.py:398] At round 11, UCB exploited 44, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 376.5152046856084, 'duration': 5.8943907365129, 'time_stamp': 12, 'count': 9, 'status': True, 'gradient': 20.62698182997877}, [0.3106671221855116, -2.5002083506958932e-05]), ({'reward': 231.30750530061994, 'duration': 20.64883858350112, 'time_stamp': 12, 'count': 7, 'status': True, 'gradient': 8.089083573798586}, [0.1908513631268162, -2.5002083506958932e-05]), ({'reward': 491.64705283556907, 'duration': 12.029357192292537, 'time_stamp': 12, 'count': 8, 'status': True, 'gradient': 26.393808022430406}, [0.4056662843259737, -2.5002083506958932e-05])]
2021-08-18:15:31:40,319 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:40,662 INFO     [param_server.py:553] For epoch: 13, median_reward: 325.45631378793775, dev: 650.9126275758755
2021-08-18:15:31:41,220 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8931, Top-1 Accuracy: 498.0/1033 (0.4821), Top-5 Accuracy: 1.0
2021-08-18:15:31:41,221 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 152.6407, eval_time 0.5433, test_loss 1.8931, test_accuracy 0.4821, test_5_accuracy 1.0 

2021-08-18:15:31:41,285 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:41,302 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:41,351 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.8345, Top-1 Accuracy: 497.0/1033 (0.4811), Top-5 Accuracy: 1.0
2021-08-18:15:31:41,352 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 152.766, eval_time 0.6635, test_loss 1.8345, test_accuracy 0.4811, test_5_accuracy 1.0 

2021-08-18:15:31:41,354 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.8031, Top-1 Accuracy: 488.0/1033 (0.4724), Top-5 Accuracy: 1.0
2021-08-18:15:31:41,355 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 152.7723, eval_time 0.6705, test_loss 1.8031, test_accuracy 0.4724, test_5_accuracy 1.0 

2021-08-18:15:31:41,420 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:41,428 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:41,449 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:41,459 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:42,90 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:42,99 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:43,106 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:43,128 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:43,336 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:43,345 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:43,854 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:43,874 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:43,986 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:43,995 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:44,315 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:44,325 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:44,578 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:44,587 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:44,867 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:44,877 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:44,985 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:45,6 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:45,153 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:45,164 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:45,378 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:45,392 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:45,774 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:45,783 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:46,356 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:46,376 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:46,420 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:46,450 INFO     [learner.py:606] ====Pushing takes 0.02892756462097168 s
2021-08-18:15:31:46,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:46,498 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:46,499 INFO     [param_server.py:410] Lock worker 2 with localStep 13 , while globalStep is 12

2021-08-18:15:31:47,117 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:47,137 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:47,749 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:47,777 INFO     [learner.py:606] ====Pushing takes 0.022675275802612305 s
2021-08-18:15:31:47,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:47,821 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:47,822 INFO     [param_server.py:410] Lock worker 3 with localStep 13 , while globalStep is 12

2021-08-18:15:31:48,623 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:48,650 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:49,245 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:49,272 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:49,974 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:49,994 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:50,660 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:50,684 INFO     [learner.py:606] ====Pushing takes 0.02238774299621582 s
2021-08-18:15:31:50,725 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:50,733 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:50,734 INFO     [param_server.py:381] ====After aggregation in epoch: 12, virtual_clock: 402.1932399657621, top_1: : 47.8541 % (1483.0), top_5: : 100.0 % (3099.0), test loss: 1.8435680468877156, test len: 3099.0
2021-08-18:15:31:50,735 INFO     [param_server.py:410] Lock worker 1 with localStep 13 , while globalStep is 13

2021-08-18:15:31:50,735 INFO     [param_server.py:441] ====Epoch 14 completes 20 clients with loss 3.0477519342327404, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:50,735 INFO     [param_server.py:450] ====Start to sample for epoch 14, global virtualClock: 402.1932399657621, round_duration: 20.356170375151418
2021-08-18:15:31:50,736 INFO     [oort.py:208] Training selector: Pacer 12: lastExploitationUtil 538.6378539028516, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:50,737 INFO     [oort.py:321] scores are 26,{5: 0.05155918338839659, 6: 0.23829200793704458, 7: 0.7710291985744842, 11: 0.1416930466213642, 14: 0.009584423777214284, 16: 0.6577237835176808, 17: 0.01363795256740426, 25: 0.004979335205387798, 27: 0.048849171212505496, 35: 0.003368828440969764, 37: 0.15429154246199792, 38: 0.10091651159345974, 49: 0.010012704207971224, 50: 0.02365368956362184, 51: 0.5189335310473208, 53: 0.20841258376484595, 55: 1.1382558010964847, 58: 0.006191705103461735, 59: 0.006407283070712069, 60: 0.0027629687877942653, 65: 0.030052708217510157, 67: 0.0038114197489198423, 70: 0.007891719878263755, 71: 0.055074696243908094, 76: 0.0028487578480230666, 81: 0.12067076843662947, 82: 0.13825580901310427, 83: 0.48256465674749366, 84: 0.15709402459312533, 85: 0.08424121396748784, 86: 0.00271863142123817, 87: 0.06840806399414565, 88: 0.003042069942411081, 96: 0.0038626083119125674, 97: 0.0432718863484846, 98: 0.061373619398450645, 99: 0.1968947595277583, 104: 0.005741234457366082, 105: 0.023470338240369457, 106: 0.020340166380071165, 107: 0.009321980399795139, 110: 0.014398271314166022, 111: 0.004285667897828915, 119: 0.014800440575510177},[55, 7, 16, 51, 83, 6, 53, 99, 84, 37, 11, 82, 81, 38, 85, 87, 98, 71, 5, 27, 97, 65, 50, 105, 106, 119, 110, 17, 49, 14, 107, 70, 59, 58, 104, 25, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:31:50,759 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:31:50,760 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:50,760 INFO     [oort.py:398] At round 12, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1263.1754211107211, 'duration': 8.010998429338052, 'time_stamp': 13, 'count': 11, 'status': True, 'gradient': 20.52805735653358}, [1.0, -2.3078698361412436e-05]), ({'reward': 1180.7639116865082, 'duration': 13.324368782156236, 'time_stamp': 13, 'count': 11, 'status': True, 'gradient': 21.036249721436597}, [0.93475794429258, -2.3078698361412436e-05]), ({'reward': 656.1839879632865, 'duration': 7.864087706209871, 'time_stamp': 13, 'count': 11, 'status': True, 'gradient': 21.340034305410782}, [0.519467982421196, -2.3078698361412436e-05])]
2021-08-18:15:31:50,761 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:51,104 INFO     [param_server.py:553] For epoch: 14, median_reward: 364.90417749326065, dev: 729.8083549865213
2021-08-18:15:31:51,658 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.8864, Top-1 Accuracy: 517.0/1033 (0.5005), Top-5 Accuracy: 1.0
2021-08-18:15:31:51,661 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 163.0784, eval_time 0.524, test_loss 1.8864, test_accuracy 0.5005, test_5_accuracy 1.0 

2021-08-18:15:31:51,699 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8056, Top-1 Accuracy: 542.0/1033 (0.5247), Top-5 Accuracy: 1.0
2021-08-18:15:31:51,700 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 163.1201, eval_time 0.5631, test_loss 1.8056, test_accuracy 0.5247, test_5_accuracy 1.0 

2021-08-18:15:31:51,745 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:31:51,746 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9314, Top-1 Accuracy: 535.0/1033 (0.5179), Top-5 Accuracy: 1.0
2021-08-18:15:31:51,747 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 163.1613, eval_time 0.5904, test_loss 1.9314, test_accuracy 0.5179, test_5_accuracy 1.0 

2021-08-18:15:31:51,761 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:51,775 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:31:51,798 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:51,814 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:31:51,835 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:52,244 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:52,258 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:53,85 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:53,99 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:53,437 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:53,448 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:53,996 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:54,10 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:54,15 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:54,29 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:54,338 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:54,353 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:54,604 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:54,625 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:54,923 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:54,931 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:54,936 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:54,942 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:55,301 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:55,315 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:55,614 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:55,623 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:55,880 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:55,894 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:56,244 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:56,259 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:56,812 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:56,826 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:56,945 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:56,990 INFO     [learner.py:606] ====Pushing takes 0.03597688674926758 s
2021-08-18:15:31:57,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:57,45 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:57,46 INFO     [param_server.py:410] Lock worker 2 with localStep 14 , while globalStep is 13

2021-08-18:15:31:57,378 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:57,402 INFO     [learner.py:606] ====Pushing takes 0.022838354110717773 s
2021-08-18:15:31:57,440 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:57,447 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:57,447 INFO     [param_server.py:410] Lock worker 3 with localStep 14 , while globalStep is 13

2021-08-18:15:31:57,971 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:57,989 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:58,548 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:58,568 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:59,103 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:59,123 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:59,739 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:59,764 INFO     [learner.py:606] ====Pushing takes 0.023973703384399414 s
2021-08-18:15:31:59,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:59,821 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:59,822 INFO     [param_server.py:381] ====After aggregation in epoch: 13, virtual_clock: 420.4014382929251, top_1: : 51.4359 % (1594.0), top_5: : 100.0 % (3099.0), test loss: 1.8744794925053914, test len: 3099.0
2021-08-18:15:31:59,823 INFO     [param_server.py:410] Lock worker 1 with localStep 14 , while globalStep is 14

2021-08-18:15:31:59,823 INFO     [param_server.py:441] ====Epoch 15 completes 20 clients with loss 3.56005164631791, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:59,824 INFO     [param_server.py:450] ====Start to sample for epoch 15, global virtualClock: 420.4014382929251, round_duration: 18.208198327163032
2021-08-18:15:31:59,824 INFO     [oort.py:208] Training selector: Pacer 13: lastExploitationUtil 403.7509599690019, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:59,825 INFO     [oort.py:321] scores are 26,{5: 0.03385455229948093, 6: 0.3458845625245708, 7: 0.13535534129643578, 11: 0.0708330390420075, 14: 0.008466733226829943, 16: 0.8263617356036418, 17: 0.008954889276910755, 25: 0.004119540777795958, 27: 0.03207511665074677, 35: 0.003042656647273839, 37: 0.05727557685977414, 38: 0.025347063547589522, 49: 0.010172688371211637, 50: 0.01904003602679033, 51: 0.11198959770078774, 53: 0.6721810329440555, 55: 0.13535534129643578, 58: 0.005081016828484192, 59: 0.00525792371619061, 60: 0.002267338426616976, 65: 0.019733070138572225, 67: 0.0032568516729504517, 70: 0.006529036609199029, 71: 0.05186000610644436, 76: 0.002379135482903141, 81: 0.034813108844580866, 82: 0.32061582529233673, 83: 0.060873128692280454, 84: 0.512594312595235, 85: 0.01478573200842901, 86: 0.0022309544416180393, 87: 0.03484800733307931, 88: 0.0025405797640841517, 96: 0.003924325525004086, 97: 0.1706024012028209, 98: 0.06008606263688678, 99: 0.050616353770744624, 104: 0.0047113530774973295, 105: 0.015410984837745025, 106: 0.017028360774778456, 107: 0.007883847665409387, 110: 0.01806635681409359, 111: 0.004354144802601017, 119: 0.012244810996895228},[16, 53, 84, 6, 82, 97, 7, 55, 51, 11, 83, 98, 37, 71, 99, 87, 81, 5, 27, 38, 65, 50, 110, 106, 105, 85, 119, 49, 17, 14, 107, 70, 59, 58, 104, 111, 25, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:31:59,827 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:31:59,827 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:59,827 INFO     [oort.py:398] At round 13, UCB exploited 44, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 820.6606204923928, 'duration': 11.90395711384456, 'time_stamp': 14, 'count': 12, 'status': True, 'gradient': 20.33226750892953}, [0.47850613054380303, -2.14301021501536e-05]), ({'reward': 1533.5833486976398, 'duration': 11.058674649423494, 'time_stamp': 14, 'count': 11, 'status': True, 'gradient': 11.330105857099984}, [0.894198123426987, -2.14301021501536e-05]), ({'reward': 183.74686187734147, 'duration': 19.55790138125729, 'time_stamp': 14, 'count': 11, 'status': True, 'gradient': 19.421922494411934}, [0.107133555173774, -2.14301021501536e-05])]
2021-08-18:15:31:59,828 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 110, 71, 5]
2021-08-18:15:32:00,182 INFO     [param_server.py:553] For epoch: 15, median_reward: 337.01998704574754, dev: 674.0399740914951
2021-08-18:15:32:00,851 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.833, Top-1 Accuracy: 545.0/1033 (0.5276), Top-5 Accuracy: 1.0
2021-08-18:15:32:00,852 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 172.2665, eval_time 0.6314, test_loss 1.833, test_accuracy 0.5276, test_5_accuracy 1.0 

2021-08-18:15:32:00,858 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9806, Top-1 Accuracy: 553.0/1033 (0.5353), Top-5 Accuracy: 1.0
2021-08-18:15:32:00,860 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 172.2767, eval_time 0.6385, test_loss 1.9806, test_accuracy 0.5353, test_5_accuracy 1.0 

2021-08-18:15:32:00,882 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.813, Top-1 Accuracy: 546.0/1033 (0.5286), Top-5 Accuracy: 1.0
2021-08-18:15:32:00,882 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 172.3022, eval_time 0.6663, test_loss 1.813, test_accuracy 0.5286, test_5_accuracy 1.0 

2021-08-18:15:32:00,920 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:32:00,928 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:32:00,931 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:00,939 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:00,948 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:32:00,967 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:01,614 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:01,623 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:02,688 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:02,715 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:03,374 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:03,385 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:04,104 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:04,114 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:04,193 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:04,221 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:04,437 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:04,470 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:04,713 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:04,727 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:05,210 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:05,244 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:05,775 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:05,786 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:05,793 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:05,813 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:05,840 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:05,873 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:06,966 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:06,983 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:06,987 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:06,997 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:07,555 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:07,576 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:07,603 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:07,621 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:32:08,206 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:32:08,238 INFO     [learner.py:606] ====Pushing takes 0.03023838996887207 s
2021-08-18:15:32:08,246 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:08,282 INFO     [learner.py:606] ====Pushing takes 0.0353093147277832 s
2021-08-18:15:32:08,284 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:08,295 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:32:08,295 INFO     [param_server.py:410] Lock worker 2 with localStep 15 , while globalStep is 14

2021-08-18:15:32:08,316 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:08,322 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:32:08,323 INFO     [param_server.py:410] Lock worker 3 with localStep 15 , while globalStep is 14

2021-08-18:15:32:09,281 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:09,293 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:09,824 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:09,836 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:10,471 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:10,491 INFO     [learner.py:606] ====Pushing takes 0.018750429153442383 s
2021-08-18:15:32:10,525 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:10,532 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:10,533 INFO     [param_server.py:381] ====After aggregation in epoch: 14, virtual_clock: 443.05149817120895, top_1: : 53.0494 % (1644.0), top_5: : 100.0 % (3099.0), test loss: 1.8755365698425859, test len: 3099.0
2021-08-18:15:32:10,534 INFO     [param_server.py:410] Lock worker 1 with localStep 15 , while globalStep is 15

2021-08-18:15:32:10,535 INFO     [param_server.py:441] ====Epoch 16 completes 20 clients with loss 2.7560163921589695, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:10,536 INFO     [param_server.py:450] ====Start to sample for epoch 16, global virtualClock: 443.05149817120895, round_duration: 22.65005987828387
2021-08-18:15:32:10,536 INFO     [oort.py:208] Training selector: Pacer 14: lastExploitationUtil 388.1457771982706, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:10,537 INFO     [oort.py:321] scores are 26,{5: 0.051897867956169054, 6: 0.15023987758208382, 7: 0.1326413080821309, 11: 0.05004448290895833, 14: 0.007527070669824064, 16: 0.1874597553740819, 17: 0.007282084030807303, 25: 0.0033942973277722496, 27: 0.02513154770074981, 35: 0.0027690112390533726, 37: 0.05612713442316974, 38: 0.21210194466293925, 49: 0.013047792007243868, 50: 0.015145310411650004, 51: 0.07318759373949996, 53: 0.0865996522158229, 55: 0.41676570937988056, 58: 0.004143901259820682, 59: 0.0042881803873228595, 60: 0.0018491626537873334, 65: 0.015461287292254433, 67: 0.002789670136764574, 70: 0.005379602414662422, 71: 0.01311132472327271, 76: 0.0019831345876345314, 81: 0.11233319504092183, 82: 0.21397415931783134, 83: 0.06798094808641036, 84: 0.14504124691386516, 85: 0.014997809724857659, 86: 0.0018194891363864142, 87: 0.03864346225190579, 88: 0.002117706889332615, 96: 0.003980613733391888, 97: 0.04151463616187209, 98: 0.14554364784136037, 99: 0.0482818092315715, 104: 0.003842416313965565, 105: 0.01207483996964058, 106: 0.013342089001162162, 107: 0.006671766724267343, 110: 0.013813564542892995, 111: 0.004416598081190071, 119: 0.009708317607880728},[55, 82, 38, 16, 6, 98, 84, 7, 81, 53, 51, 83, 37, 5, 11, 99, 97, 87, 27, 65, 50, 85, 110, 106, 71, 49, 105, 119, 14, 17, 107, 70, 111, 59, 58, 96, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:32:10,550 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:10,551 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:10,551 INFO     [oort.py:398] At round 14, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 479.99927677204187, 'duration': 13.411352670399307, 'time_stamp': 15, 'count': 12, 'status': True, 'gradient': 14.571594316727229}, [0.19522358282497734, -2.0001333422228165e-05]), ({'reward': 134.79016865003405, 'duration': 7.864087706209871, 'time_stamp': 15, 'count': 13, 'status': True, 'gradient': 21.34963678621035}, [0.05481845135919977, -2.0001333422228165e-05]), ({'reward': 199.98019156625026, 'duration': 6.342067858842259, 'time_stamp': 15, 'count': 13, 'status': True, 'gradient': 61.520180551204845}, [0.0813328553029492, -2.0001333422228165e-05])]
2021-08-18:15:32:10,552 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:32:10,885 INFO     [param_server.py:553] For epoch: 16, median_reward: 333.85620497892256, dev: 667.7124099578451
2021-08-18:15:32:11,455 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6405, Top-1 Accuracy: 496.0/1033 (0.4802), Top-5 Accuracy: 1.0
2021-08-18:15:32:11,456 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 182.8761, eval_time 0.5591, test_loss 2.6405, test_accuracy 0.4802, test_5_accuracy 1.0 

2021-08-18:15:32:11,499 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8482, Top-1 Accuracy: 493.0/1033 (0.4773), Top-5 Accuracy: 1.0
2021-08-18:15:32:11,499 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 182.9136, eval_time 0.5885, test_loss 2.8482, test_accuracy 0.4773, test_5_accuracy 1.0 

2021-08-18:15:32:11,502 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8996, Top-1 Accuracy: 456.0/1033 (0.4414), Top-5 Accuracy: 1.0
2021-08-18:15:32:11,503 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 182.9204, eval_time 0.5916, test_loss 2.8996, test_accuracy 0.4414, test_5_accuracy 1.0 

2021-08-18:15:32:11,525 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:32:11,533 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:11,574 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:32:11,587 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:32:11,593 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:11,600 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:12,161 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:12,171 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:13,249 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:13,259 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:13,428 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:13,439 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:13,884 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:13,905 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:13,916 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:13,926 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:14,451 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:14,461 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:14,486 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:14,495 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:14,925 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:14,935 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:14,984 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:14,993 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:15,58 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:15,85 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:15,436 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:15,448 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:15,519 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:15,533 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:16,106 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:16,133 INFO     [learner.py:606] ====Pushing takes 0.025389432907104492 s
2021-08-18:15:32:16,177 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:16,184 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:16,185 INFO     [param_server.py:410] Lock worker 2 with localStep 16 , while globalStep is 15

2021-08-18:15:32:16,337 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:16,365 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:16,696 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:16,723 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:17,229 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:17,254 INFO     [learner.py:606] ====Pushing takes 0.022883892059326172 s
2021-08-18:15:32:17,280 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:17,287 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:17,288 INFO     [param_server.py:410] Lock worker 3 with localStep 16 , while globalStep is 15

2021-08-18:15:32:18,687 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:18,714 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:19,375 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:19,395 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:20,6 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:20,27 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:20,596 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:20,618 INFO     [learner.py:606] ====Pushing takes 0.020467758178710938 s
2021-08-18:15:32:20,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:20,677 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:20,678 INFO     [param_server.py:381] ====After aggregation in epoch: 15, virtual_clock: 462.80689993659166, top_1: : 46.6279 % (1445.0), top_5: : 100.0 % (3099.0), test loss: 2.7960815032323203, test len: 3099.0
2021-08-18:15:32:20,679 INFO     [param_server.py:410] Lock worker 1 with localStep 16 , while globalStep is 16

2021-08-18:15:32:20,680 INFO     [param_server.py:441] ====Epoch 17 completes 20 clients with loss 7.481868576845583, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:20,680 INFO     [param_server.py:450] ====Start to sample for epoch 17, global virtualClock: 462.80689993659166, round_duration: 19.755401765382704
2021-08-18:15:32:20,681 INFO     [oort.py:208] Training selector: Pacer 15: lastExploitationUtil 410.2900222808617, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:20,682 INFO     [oort.py:321] scores are 26,{5: 0.038538959889667226, 6: 0.1979197154612126, 7: 1.1300973241726702, 11: 0.021950759902102386, 14: 0.009346077051609222, 16: 0.1300973312891411, 17: 0.01029852055092734, 25: 0.004710668947327419, 27: 0.036513306190685615, 35: 0.003319654935299494, 37: 0.0911923334965293, 38: 0.024362432187554163, 49: 0.018956971148205954, 50: 0.017680431174947886, 51: 0.30621451067256084, 53: 0.22450516977554352, 55: 0.190650625851835, 58: 0.0058360631497664335, 59: 0.0060392586523861915, 60: 0.0026042681388985496, 65: 0.02185186450550765, 67: 0.0036595068626218206, 70: 0.0074659122630102845, 71: 0.05340138567768872, 76: 0.002706610590488303, 81: 0.09499894715305479, 82: 0.8988469305272071, 83: 0.05850845274544528, 84: 0.0780673289251758, 85: 0.0978372876974293, 86: 0.002562477442023945, 87: 0.03038813171338949, 88: 0.0028902768021683064, 96: 0.004032310670963122, 97: 0.14722890187188642, 98: 0.13258050189892243, 99: 0.20465457092359188, 104: 0.005411466840058389, 105: 0.017543381500609342, 106: 0.01885674300999993, 107: 0.008908001660464866, 110: 0.025832222358363594, 111: 0.004473957231004759, 119: 0.014105091243640256},[7, 82, 51, 53, 99, 6, 55, 97, 98, 16, 85, 81, 37, 84, 83, 71, 5, 27, 87, 110, 38, 11, 65, 49, 106, 50, 105, 119, 17, 14, 107, 70, 59, 58, 104, 25, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:32:20,683 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:20,684 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:20,684 INFO     [oort.py:398] At round 15, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 597.0328577867886, 'duration': 12.029357192292537, 'time_stamp': 16, 'count': 12, 'status': True, 'gradient': 26.42121377798953}, [0.4248695926781148, -1.875117194824678e-05]), ({'reward': 1405.2008487374449, 'duration': 5.8943907365129, 'time_stamp': 16, 'count': 13, 'status': True, 'gradient': 20.6481181302638}, [1.0, -1.875117194824678e-05]), ({'reward': 236.87682822102383, 'duration': 13.411352670399307, 'time_stamp': 16, 'count': 13, 'status': True, 'gradient': 11.33810859738814}, [0.1685655985791476, -1.875117194824678e-05])]
2021-08-18:15:32:20,685 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 87, 85, 110, 71, 5]
2021-08-18:15:32:21,29 INFO     [param_server.py:553] For epoch: 17, median_reward: 340.6345149882415, dev: 681.269029976483
2021-08-18:15:32:21,681 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.987, Top-1 Accuracy: 546.0/1033 (0.5286), Top-5 Accuracy: 1.0
2021-08-18:15:32:21,682 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 193.1014, eval_time 0.6303, test_loss 1.987, test_accuracy 0.5286, test_5_accuracy 1.0 

2021-08-18:15:32:21,692 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9747, Top-1 Accuracy: 561.0/1033 (0.5431), Top-5 Accuracy: 1.0
2021-08-18:15:32:21,693 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 193.1102, eval_time 0.6366, test_loss 1.9747, test_accuracy 0.5431, test_5_accuracy 1.0 

2021-08-18:15:32:21,725 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0918, Top-1 Accuracy: 552.0/1033 (0.5344), Top-5 Accuracy: 1.0
2021-08-18:15:32:21,728 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 193.1422, eval_time 0.6595, test_loss 2.0918, test_accuracy 0.5344, test_5_accuracy 1.0 

2021-08-18:15:32:21,749 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:21,761 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:21,765 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:21,781 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:21,803 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:21,823 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:22,493 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:22,507 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:23,568 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:23,582 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:23,971 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:23,980 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:24,641 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:24,659 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:24,659 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:24,669 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:25,42 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:25,52 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:25,165 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:25,174 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:25,631 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:25,645 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:25,668 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:25,683 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:26,303 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:26,318 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:26,842 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:26,860 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:27,7 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:27,27 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:27,494 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:27,512 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:32:28,46 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:32:28,70 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:28,72 INFO     [learner.py:606] ====Pushing takes 0.024959564208984375 s
2021-08-18:15:32:28,91 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:28,117 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:28,127 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:28,154 INFO     [param_server.py:410] Lock worker 2 with localStep 17 , while globalStep is 16

2021-08-18:15:32:28,683 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:28,706 INFO     [learner.py:606] ====Pushing takes 0.02157425880432129 s
2021-08-18:15:32:28,742 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:28,748 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:28,748 INFO     [param_server.py:410] Lock worker 3 with localStep 17 , while globalStep is 16

2021-08-18:15:32:29,402 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:29,422 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:29,961 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:29,982 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:30,600 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:30,620 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:31,114 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:31,140 INFO     [learner.py:606] ====Pushing takes 0.024618864059448242 s
2021-08-18:15:32:31,204 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:31,213 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:31,214 INFO     [param_server.py:381] ====After aggregation in epoch: 16, virtual_clock: 485.4569598148755, top_1: : 53.5334 % (1659.0), top_5: : 100.0 % (3099.0), test loss: 2.017830742730035, test len: 3099.0
2021-08-18:15:32:31,215 INFO     [param_server.py:410] Lock worker 1 with localStep 17 , while globalStep is 17

2021-08-18:15:32:31,215 INFO     [param_server.py:441] ====Epoch 18 completes 20 clients with loss 3.7552308720675702, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:31,216 INFO     [param_server.py:450] ====Start to sample for epoch 18, global virtualClock: 485.4569598148755, round_duration: 22.65005987828387
2021-08-18:15:32:31,216 INFO     [oort.py:208] Training selector: Pacer 16: lastExploitationUtil 486.6031383343857, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:31,217 INFO     [oort.py:321] scores are 26,{5: 0.04131740888208114, 6: 0.07195800019335581, 7: 0.1277080514012879, 11: 0.022210785549989173, 14: 0.007496938239846754, 16: 0.6423827285909127, 17: 0.007093623299843741, 25: 0.0033178165707130024, 27: 0.02699781503866991, 35: 0.002772951725574406, 37: 0.05403962816382083, 38: 0.023915008180711607, 49: 0.014016720317789885, 50: 0.013072850981293552, 51: 0.07046556701199928, 53: 0.7362647891238968, 55: 0.1277080514012879, 58: 0.004039744370848349, 59: 0.004180397044889876, 60: 0.0018026839813609914, 65: 0.01660944162876084, 67: 0.0027536953334038566, 70: 0.005258388500376025, 71: 0.015725244116439524, 76: 0.0019442338436519355, 81: 0.06344127632409959, 82: 0.34216471573105245, 83: 0.2665577357430242, 84: 0.164076215736393, 85: 0.05501876401866765, 86: 0.0017737563073244671, 87: 0.030689371535949975, 88: 0.0020761664038578646, 93: 0.10848640758972054, 96: 0.004080076915046593, 97: 0.07631221572728066, 98: 0.056691327451402186, 99: 0.026657369300735475, 104: 0.003745837244073221, 105: 0.012971516915855078, 106: 0.012998316402408833, 107: 0.006565960795176713, 110: 0.029479139430381877, 111: 0.0045269551576607924, 119: 0.010429256734809303},[53, 16, 82, 83, 84, 7, 55, 93, 97, 6, 51, 81, 98, 85, 37, 5, 87, 110, 27, 99, 38, 11, 65, 71, 49, 50, 106, 105, 119, 14, 17, 107, 70, 111, 59, 96, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:32:31,218 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:31,219 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:31,220 INFO     [oort.py:398] At round 16, UCB exploited 45, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 13.73645665746006, 'time_stamp': 17, 'count': 14, 'status': True, 'gradient': 11.341798639313707}, [3.789009837427423e-09, -1.7648096946879243e-05]), ({'reward': 2639.2219290191842, 'duration': 11.058674649423494, 'time_stamp': 17, 'count': 14, 'status': True, 'gradient': 14.583141257793185}, [1.0, -1.7648096946879243e-05]), ({'reward': 566.0065889013442, 'duration': 6.342067858842259, 'time_stamp': 17, 'count': 15, 'status': True, 'gradient': 61.57038329078953}, [0.2144566681187744, -1.7648096946879243e-05])]
2021-08-18:15:32:31,221 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5]
2021-08-18:15:32:31,566 INFO     [param_server.py:553] For epoch: 18, median_reward: 353.93460981021303, dev: 707.8692196204261
2021-08-18:15:32:32,260 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.332, Top-1 Accuracy: 513.0/1033 (0.4966), Top-5 Accuracy: 1.0
2021-08-18:15:32:32,261 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 203.6748, eval_time 0.6573, test_loss 2.332, test_accuracy 0.4966, test_5_accuracy 1.0 

2021-08-18:15:32:32,272 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9728, Top-1 Accuracy: 517.0/1033 (0.5005), Top-5 Accuracy: 1.0
2021-08-18:15:32:32,273 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 203.6904, eval_time 0.6698, test_loss 1.9728, test_accuracy 0.5005, test_5_accuracy 1.0 

2021-08-18:15:32:32,302 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.7991, Top-1 Accuracy: 542.0/1033 (0.5247), Top-5 Accuracy: 1.0
2021-08-18:15:32:32,303 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 203.7227, eval_time 0.7027, test_loss 1.7991, test_accuracy 0.5247, test_5_accuracy 1.0 

2021-08-18:15:32:32,326 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:32,341 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:32,343 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:32,358 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:32,371 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:32,388 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:33,10 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:33,25 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:33,521 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:33,548 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:34,126 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:34,147 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:34,616 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:34,634 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:34,751 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:34,772 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:35,173 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:35,177 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:35,187 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:35,205 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:35,733 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:35,747 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:36,325 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:36,346 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:36,586 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:36,613 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:36,955 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:36,973 INFO     [learner.py:606] ====Pushing takes 0.016495943069458008 s
2021-08-18:15:32:37,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:37,13 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:32:37,14 INFO     [param_server.py:410] Lock worker 3 with localStep 18 , while globalStep is 17

2021-08-18:15:32:37,18 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:37,32 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:37,668 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:37,687 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:37,802 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:37,816 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:38,410 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:38,428 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:32:38,910 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:32:38,945 INFO     [learner.py:606] ====Pushing takes 0.03332042694091797 s
2021-08-18:15:32:39,4 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:39,13 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:39,13 INFO     [param_server.py:410] Lock worker 2 with localStep 18 , while globalStep is 17

2021-08-18:15:32:40,14 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:40,32 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:40,640 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:40,653 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:41,249 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:41,260 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:41,807 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:41,830 INFO     [learner.py:606] ====Pushing takes 0.020934581756591797 s
2021-08-18:15:32:41,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:41,881 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:41,882 INFO     [param_server.py:381] ====After aggregation in epoch: 17, virtual_clock: 506.5346386123525, top_1: : 50.726 % (1572.0), top_5: : 100.0 % (3099.0), test loss: 2.034626876866376, test len: 3099.0
2021-08-18:15:32:41,883 INFO     [param_server.py:410] Lock worker 1 with localStep 18 , while globalStep is 18

2021-08-18:15:32:41,883 INFO     [param_server.py:441] ====Epoch 19 completes 20 clients with loss 3.067300971800848, sampled rewards are: 
 {5: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:41,884 INFO     [param_server.py:450] ====Start to sample for epoch 19, global virtualClock: 506.5346386123525, round_duration: 21.077678797477027
2021-08-18:15:32:41,885 INFO     [oort.py:208] Training selector: Pacer 17: lastExploitationUtil 462.7268981848033, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:41,885 INFO     [oort.py:321] scores are 26,{5: 0.0402186018731869, 6: 0.0727404540605151, 7: 1.0116522370821381, 11: 0.03421410076869223, 14: 0.009172569332351789, 16: 0.1254594587547545, 17: 0.009876797835321964, 25: 0.004532205675002039, 27: 0.03729407327581347, 35: 0.00327976931829302, 37: 0.13046751332953951, 38: 0.02349392970565164, 49: 0.020234028916343863, 50: 0.018058493315915806, 51: 0.6209956034449903, 53: 0.0819107233820381, 55: 0.1254594587547545, 58: 0.005601000019917053, 59: 0.005796011277508717, 60: 0.002499374239708817, 65: 0.022943846836720565, 67: 0.003555670985418612, 70: 0.007183066843761086, 71: 0.06934096296889201, 76: 0.002611558700571371, 81: 0.1816015651012146, 82: 0.7797126568707086, 83: 0.4278266611354703, 84: 0.178661322974841, 85: 0.07469066858753674, 86: 0.002459266775478178, 87: 0.020061334265334185, 88: 0.002788774844925317, 96: 0.004124442637645781, 97: 0.041503500998359366, 98: 0.11458072424844354, 99: 0.026188005279220425, 104: 0.005193505467835888, 105: 0.01791851309690973, 106: 0.019799052998511552, 107: 0.008628166262237337, 110: 0.01306563057982006, 111: 0.004576180126676133, 119: 0.015055296643129377},[7, 82, 51, 83, 81, 84, 37, 16, 55, 98, 53, 85, 6, 71, 97, 5, 27, 11, 99, 38, 65, 49, 87, 106, 50, 105, 119, 110, 17, 14, 107, 70, 59, 58, 104, 111, 25, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:32:41,886 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:41,887 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:41,887 INFO     [oort.py:398] At round 17, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 8.010998429338052, 'time_stamp': 18, 'count': 16, 'status': True, 'gradient': 20.55615956998433}, [6.605282529324982e-09, -1.6667592644035793e-05]), ({'reward': 1513.9497731361998, 'duration': 12.029357192292537, 'time_stamp': 18, 'count': 14, 'status': True, 'gradient': 26.434779716209583}, [1.0, -1.6667592644035793e-05]), ({'reward': 1341.6525026378258, 'duration': 5.8943907365129, 'time_stamp': 18, 'count': 15, 'status': True, 'gradient': 20.660668988019875}, [0.8861927849326663, -1.6667592644035793e-05])]
2021-08-18:15:32:41,888 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:32:42,232 INFO     [param_server.py:553] For epoch: 19, median_reward: 349.78086997692327, dev: 699.5617399538465
2021-08-18:15:32:42,892 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.94, Top-1 Accuracy: 577.0/1033 (0.5586), Top-5 Accuracy: 1.0
2021-08-18:15:32:42,895 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 214.3126, eval_time 0.6381, test_loss 1.94, test_accuracy 0.5586, test_5_accuracy 1.0 

2021-08-18:15:32:42,900 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0366, Top-1 Accuracy: 546.0/1033 (0.5286), Top-5 Accuracy: 1.0
2021-08-18:15:32:42,902 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 214.3216, eval_time 0.6471, test_loss 2.0366, test_accuracy 0.5286, test_5_accuracy 1.0 

2021-08-18:15:32:42,902 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9075, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:32:42,904 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 214.3179, eval_time 0.6457, test_loss 1.9075, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:32:42,964 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:42,965 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:42,966 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:42,979 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:42,980 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:42,982 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:43,530 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:43,544 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:44,521 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:44,530 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:44,628 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:44,637 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:45,192 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:45,202 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:45,299 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:45,319 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:45,745 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:45,754 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:45,808 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:45,829 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:46,263 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:46,276 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:46,428 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:46,450 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:46,537 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:46,558 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:47,151 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:47,172 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:47,602 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:47,621 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:47,906 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:47,933 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:48,203 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:48,229 INFO     [learner.py:606] ====Pushing takes 0.02441549301147461 s
2021-08-18:15:32:48,272 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:48,281 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:48,282 INFO     [param_server.py:410] Lock worker 2 with localStep 19 , while globalStep is 18

2021-08-18:15:32:48,459 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:48,479 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:49,30 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:49,55 INFO     [learner.py:606] ====Pushing takes 0.023694992065429688 s
2021-08-18:15:32:49,113 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:49,119 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:49,120 INFO     [param_server.py:410] Lock worker 3 with localStep 19 , while globalStep is 18

2021-08-18:15:32:49,898 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:49,926 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:50,597 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:50,618 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:51,237 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:51,257 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:51,818 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:51,841 INFO     [learner.py:606] ====Pushing takes 0.02138996124267578 s
2021-08-18:15:32:51,890 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:51,898 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:51,899 INFO     [param_server.py:381] ====After aggregation in epoch: 18, virtual_clock: 526.2187479576222, top_1: : 54.2756 % (1682.0), top_5: : 100.0 % (3099.0), test loss: 1.9613864752981396, test len: 3099.0
2021-08-18:15:32:51,900 INFO     [param_server.py:410] Lock worker 1 with localStep 19 , while globalStep is 19

2021-08-18:15:32:51,900 INFO     [param_server.py:441] ====Epoch 20 completes 20 clients with loss 3.3160500737244765, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:51,901 INFO     [param_server.py:450] ====Start to sample for epoch 20, global virtualClock: 526.2187479576222, round_duration: 19.68410934526964
2021-08-18:15:32:51,902 INFO     [oort.py:208] Training selector: Pacer 18: lastExploitationUtil 380.8507841129005, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:51,903 INFO     [oort.py:321] scores are 26,{5: 0.035460005360836246, 6: 0.30542185453931564, 7: 0.5619632408077544, 11: 0.020810439301272354, 14: 0.00942952434582245, 16: 0.12333890162002481, 17: 0.010255836603235173, 25: 0.004699576732543621, 27: 0.03359618518429993, 35: 0.0033619930501523343, 37: 0.4753405560837434, 38: 0.023096827560029086, 49: 0.02106445412758606, 50: 0.016267906192601763, 51: 0.1183209478869448, 53: 0.08052624133020501, 55: 0.12333890162002481, 58: 0.005814165524451293, 59: 0.006016598612602957, 60: 0.002594496605167281, 65: 0.020668853237508545, 67: 0.0036712160669964, 70: 0.007448332275262411, 71: 0.03687961342391126, 76: 0.0027046103405897644, 81: 0.17282058344528306, 82: 0.573611013476437, 83: 0.055468995602008, 84: 0.2650656573985702, 85: 0.07991968842550529, 86: 0.0025528627121171607, 87: 0.03436158780897783, 88: 0.0028881408185507875, 96: 0.00416583900076472, 97: 0.038603129744391215, 98: 0.05983321064020249, 99: 0.20293987676493178, 104: 0.005391162352216504, 105: 0.016141805690651045, 106: 0.01783588094795617, 107: 0.00892069072974369, 110: 0.012844790984138878, 111: 0.004622110506431032, 119: 0.015673181392967115},[82, 7, 37, 6, 84, 99, 81, 16, 55, 51, 53, 85, 98, 83, 97, 71, 5, 87, 27, 38, 49, 11, 65, 106, 50, 105, 119, 110, 17, 14, 107, 70, 59, 58, 104, 25, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:32:51,903 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:51,904 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:51,904 INFO     [oort.py:398] At round 18, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 647.0804193081153, 'duration': 6.342067858842259, 'time_stamp': 19, 'count': 17, 'status': True, 'gradient': 51.882550213560215}, [0.45027211881503826, -1.5790304752881743e-05]), ({'reward': 486.60500988491776, 'duration': 42.162959759266826, 'time_stamp': 17, 'count': 5, 'status': True, 'gradient': 18.212600920129404}, [0.33860328131931794, 0.031564819201010584]), ({'reward': 666.4638169422544, 'duration': 13.298442137908651, 'time_stamp': 19, 'count': 16, 'status': True, 'gradient': 11.350064222946566}, [0.46376030051403894, -1.5790304752881743e-05])]
2021-08-18:15:32:51,905 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:32:52,251 INFO     [param_server.py:553] For epoch: 20, median_reward: 335.8969511827892, dev: 671.7939023655784
2021-08-18:15:32:52,907 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2058, Top-1 Accuracy: 518.0/1033 (0.5015), Top-5 Accuracy: 1.0
2021-08-18:15:32:52,907 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 224.3216, eval_time 0.6208, test_loss 2.2058, test_accuracy 0.5015, test_5_accuracy 1.0 

2021-08-18:15:32:52,910 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4612, Top-1 Accuracy: 513.0/1033 (0.4966), Top-5 Accuracy: 1.0
2021-08-18:15:32:52,910 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 224.3274, eval_time 0.6251, test_loss 2.4612, test_accuracy 0.4966, test_5_accuracy 1.0 

2021-08-18:15:32:52,946 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0128, Top-1 Accuracy: 549.0/1033 (0.5315), Top-5 Accuracy: 1.0
2021-08-18:15:32:52,947 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 224.3664, eval_time 0.6615, test_loss 2.0128, test_accuracy 0.5315, test_5_accuracy 1.0 

2021-08-18:15:32:52,973 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:32:52,989 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:32:53,2 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:53,4 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:53,15 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:32:53,37 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:53,518 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:53,536 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:54,784 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:54,805 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:54,898 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:54,912 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:55,350 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:55,365 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:55,490 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:55,504 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:56,28 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:56,39 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:56,121 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:56,135 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:56,394 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:56,408 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:56,773 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:56,791 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:57,237 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:57,255 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:57,267 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:57,280 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:57,754 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:57,775 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:57,806 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:57,825 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:58,467 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:58,480 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:58,964 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:58,970 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:58,993 INFO     [learner.py:606] ====Pushing takes 0.0269472599029541 s
2021-08-18:15:32:59,10 INFO     [learner.py:606] ====Pushing takes 0.03880810737609863 s
2021-08-18:15:32:59,51 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:59,59 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:59,60 INFO     [param_server.py:410] Lock worker 2 with localStep 20 , while globalStep is 19

2021-08-18:15:32:59,81 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:59,87 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:59,88 INFO     [param_server.py:410] Lock worker 3 with localStep 20 , while globalStep is 19

2021-08-18:15:32:59,685 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:59,710 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:00,247 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:00,267 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:00,846 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:00,866 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:01,373 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:01,396 INFO     [learner.py:606] ====Pushing takes 0.021309852600097656 s
2021-08-18:15:33:01,451 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:01,460 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:01,461 INFO     [param_server.py:381] ====After aggregation in epoch: 19, virtual_clock: 546.6352882390521, top_1: : 50.9842 % (1580.0), top_5: : 100.0 % (3099.0), test loss: 2.226594474580553, test len: 3099.0
2021-08-18:15:33:01,462 INFO     [param_server.py:410] Lock worker 1 with localStep 20 , while globalStep is 20

2021-08-18:15:33:01,463 INFO     [param_server.py:441] ====Epoch 21 completes 20 clients with loss 3.1805601511868185, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:01,464 INFO     [param_server.py:450] ====Start to sample for epoch 21, global virtualClock: 546.6352882390521, round_duration: 20.416540281429864
2021-08-18:15:33:01,465 INFO     [oort.py:208] Training selector: Pacer 19: lastExploitationUtil 426.3795054096338, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:01,465 INFO     [oort.py:321] scores are 26,{5: 0.04024455190894217, 6: 0.6038357141206628, 7: 0.18088721751004122, 11: 0.03468961570991874, 14: 0.009786219559261929, 16: 0.8140400967398687, 17: 0.010807795079587706, 25: 0.004942096857543424, 27: 0.03812925025908983, 35: 0.0034737003905420897, 37: 0.2114487308237759, 38: 0.07484122964603908, 49: 0.019795936672770468, 50: 0.017166168492170644, 51: 0.06694913661892941, 53: 0.7321039496914218, 55: 0.12133505970577302, 58: 0.006124250557283714, 59: 0.006337479944667297, 60: 0.002732868063911195, 65: 0.02345765965207411, 67: 0.003835627510543585, 70: 0.007832701033820593, 71: 0.011993724964888139, 76: 0.002838793646751449, 81: 0.031207121933591722, 82: 0.7248645199056698, 83: 0.2424203839341118, 84: 0.2885296048998531, 85: 0.027184436144524173, 86: 0.0026890137237411756, 87: 0.01417262122470031, 88: 0.003031429586576851, 96: 0.004204621521842133, 97: 0.32732512160331195, 98: 0.17871416096015544, 99: 0.02781275807905729, 104: 0.005678687491974154, 105: 0.017033105119551875, 106: 0.020242440161740774, 107: 0.009339567537448567, 110: 0.018954865379432664, 111: 0.004665140758455364, 119: 0.014729330484272898},[16, 53, 82, 6, 97, 84, 83, 37, 7, 98, 55, 38, 51, 5, 27, 11, 81, 99, 85, 65, 106, 49, 110, 50, 105, 119, 87, 71, 17, 14, 107, 70, 59, 58, 104, 25, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:33:01,466 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:33:01,467 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:01,467 INFO     [oort.py:398] At round 19, UCB exploited 44, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1334.850159846224, 'duration': 11.058674649423494, 'time_stamp': 20, 'count': 17, 'status': True, 'gradient': 12.974958524075408}, [1.0, -1.5000750037501888e-05]), ({'reward': 805.6253671604302, 'duration': 6.342067858842259, 'time_stamp': 20, 'count': 18, 'status': True, 'gradient': 55.13793562932953}, [0.6035294676914305, -1.5000750037501888e-05]), ({'reward': 1234.0494902504868, 'duration': 15.972045438625893, 'time_stamp': 20, 'count': 18, 'status': True, 'gradient': 14.597216746778361}, [0.9244848395539748, -1.5000750037501888e-05])]
2021-08-18:15:33:01,468 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 5]
2021-08-18:15:33:01,803 INFO     [param_server.py:541] Handle Wight 0.056715965270996094 | Send 0.33922481536865234
2021-08-18:15:33:01,804 INFO     [param_server.py:553] For epoch: 21, median_reward: 343.9989993883273, dev: 687.9979987766546
2021-08-18:15:33:02,419 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9661, Top-1 Accuracy: 529.0/1033 (0.5121), Top-5 Accuracy: 1.0
2021-08-18:15:33:02,420 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 233.8339, eval_time 0.58, test_loss 1.9661, test_accuracy 0.5121, test_5_accuracy 1.0 

2021-08-18:15:33:02,465 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3684, Top-1 Accuracy: 539.0/1033 (0.5218), Top-5 Accuracy: 1.0
2021-08-18:15:33:02,467 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 233.8845, eval_time 0.6294, test_loss 2.3684, test_accuracy 0.5218, test_5_accuracy 1.0 

2021-08-18:15:33:02,507 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:33:02,509 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0816, Top-1 Accuracy: 538.0/1033 (0.5208), Top-5 Accuracy: 1.0
2021-08-18:15:33:02,510 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 233.9298, eval_time 0.6722, test_loss 2.0816, test_accuracy 0.5208, test_5_accuracy 1.0 

2021-08-18:15:33:02,517 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:02,540 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:33:02,554 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:02,582 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:33:02,606 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:03,95 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:03,114 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:04,189 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:04,209 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:04,965 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:04,986 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:05,628 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:05,655 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:05,697 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:05,700 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:05,711 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:05,720 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:06,224 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:06,232 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:06,239 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:06,242 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:06,788 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:06,802 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:06,913 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:06,934 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:07,456 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:07,474 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:08,151 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:08,168 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:08,746 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:08,766 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:09,243 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:09,262 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:09,304 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:09,329 INFO     [learner.py:606] ====Pushing takes 0.0240933895111084 s
2021-08-18:15:33:09,369 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:09,379 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:09,379 INFO     [param_server.py:410] Lock worker 3 with localStep 21 , while globalStep is 20

2021-08-18:15:33:09,816 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:09,844 INFO     [learner.py:606] ====Pushing takes 0.026590585708618164 s
2021-08-18:15:33:09,880 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:09,888 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:09,889 INFO     [param_server.py:410] Lock worker 2 with localStep 21 , while globalStep is 20

2021-08-18:15:33:10,375 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:10,394 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:11,76 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:11,96 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:11,844 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:11,864 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:12,439 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:12,463 INFO     [learner.py:606] ====Pushing takes 0.022070646286010742 s
2021-08-18:15:33:12,505 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:12,512 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:12,513 INFO     [param_server.py:381] ====After aggregation in epoch: 20, virtual_clock: 569.285348117336, top_1: : 51.8232 % (1606.0), top_5: : 100.0 % (3099.0), test loss: 2.138710609188786, test len: 3099.0
2021-08-18:15:33:12,514 INFO     [param_server.py:410] Lock worker 1 with localStep 21 , while globalStep is 21

2021-08-18:15:33:12,514 INFO     [param_server.py:441] ====Epoch 22 completes 20 clients with loss 3.3955422219762474, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:12,515 INFO     [param_server.py:450] ====Start to sample for epoch 22, global virtualClock: 569.285348117336, round_duration: 22.65005987828387
2021-08-18:15:33:12,516 INFO     [oort.py:208] Training selector: Pacer 20: lastExploitationUtil 310.8622335647302, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:12,517 INFO     [oort.py:321] scores are 26,{5: 0.01090571784082819, 6: 0.18359867937044505, 7: 0.5975858984357878, 11: 0.020152227354655477, 14: 0.010408823383458873, 16: 0.5617029507164026, 17: 0.00926073257874617, 25: 0.005382430515744727, 27: 0.03317060306938004, 35: 0.0036646169782404746, 37: 0.0505400836369573, 38: 0.10217126092930263, 49: 0.017221507197155348, 50: 0.01606183130984986, 51: 0.1765737661287416, 53: 0.07797928240769662, 55: 0.11943782402365036, 58: 0.006689194933557164, 59: 0.006922094114351683, 60: 0.002984967227615025, 65: 0.02578531694768912, 67: 0.004129317458427854, 70: 0.008530583329380002, 71: 0.012097741732361129, 76: 0.0030813866056809886, 81: 0.030719156910025282, 82: 0.6294747052151096, 83: 0.05371457057313086, 84: 0.3160834983390894, 85: 0.013046959512414164, 86: 0.002937067451579425, 87: 0.013951013366576588, 88: 0.0032904845108527956, 96: 0.004241086500434097, 97: 0.33978219622640954, 98: 0.4969335532521716, 99: 0.08823963674275356, 104: 0.0062025299659548535, 105: 0.015937328195162557, 106: 0.022251057569545995, 107: 0.010092113324832973, 110: 0.029744402665697035, 111: 0.004705599635667038, 119: 0.012813804930640101},[82, 7, 16, 98, 97, 84, 6, 51, 55, 38, 99, 53, 83, 37, 27, 81, 110, 65, 106, 11, 49, 50, 105, 87, 85, 119, 71, 5, 14, 107, 17, 70, 59, 58, 104, 25, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:33:12,518 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:33:12,518 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:12,519 INFO     [oort.py:398] At round 20, UCB exploited 44, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 520.7751099691608, 'duration': 7.864087706209871, 'time_stamp': 21, 'count': 19, 'status': True, 'gradient': 21.39350381533799}, [0.4422651351853552, -1.4286394590218595e-05]), ({'reward': 310.8634291887053, 'duration': 30.380154975061778, 'time_stamp': 21, 'count': 17, 'status': True, 'gradient': 18.621125018798367}, [0.2639954809449733, -1.4286394590218595e-05]), ({'reward': 1137.6859868326542, 'duration': 15.972045438625893, 'time_stamp': 21, 'count': 19, 'status': True, 'gradient': 16.224611360056837}, [0.9661830434536858, -1.4286394590218595e-05])]
2021-08-18:15:33:12,519 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 87, 110, 71, 27, 65]
2021-08-18:15:33:12,855 INFO     [param_server.py:553] For epoch: 22, median_reward: 316.364454890514, dev: 632.728909781028
2021-08-18:15:33:13,465 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7902, Top-1 Accuracy: 496.0/1033 (0.4802), Top-5 Accuracy: 1.0
2021-08-18:15:33:13,466 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 244.8835, eval_time 0.5763, test_loss 2.7902, test_accuracy 0.4802, test_5_accuracy 1.0 

2021-08-18:15:33:13,497 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7728, Top-1 Accuracy: 508.0/1033 (0.4918), Top-5 Accuracy: 1.0
2021-08-18:15:33:13,498 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 244.9119, eval_time 0.6075, test_loss 2.7728, test_accuracy 0.4918, test_5_accuracy 1.0 

2021-08-18:15:33:13,539 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:13,543 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5525, Top-1 Accuracy: 514.0/1033 (0.4976), Top-5 Accuracy: 1.0
2021-08-18:15:33:13,544 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 244.9635, eval_time 0.6538, test_loss 2.5525, test_accuracy 0.4976, test_5_accuracy 1.0 

2021-08-18:15:33:13,549 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:13,567 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:13,579 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:13,611 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:13,631 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:14,181 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:14,196 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:15,837 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:15,846 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:15,903 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:15,917 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:16,484 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:16,498 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:16,788 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:16,815 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:17,62 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:17,87 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:17,785 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:17,803 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:18,234 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:18,255 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:18,460 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:18,474 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:18,521 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:18,542 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:19,139 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:19,152 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:19,676 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:19,687 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:33:19,711 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:19,725 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:20,242 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:33:20,270 INFO     [learner.py:606] ====Pushing takes 0.027027130126953125 s
2021-08-18:15:33:20,327 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:20,335 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:33:20,336 INFO     [param_server.py:410] Lock worker 2 with localStep 22 , while globalStep is 21

2021-08-18:15:33:21,241 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:21,256 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:21,876 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:21,890 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:33:22,512 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:33:22,543 INFO     [learner.py:606] ====Pushing takes 0.02670598030090332 s
2021-08-18:15:33:22,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:22,588 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:33:22,589 INFO     [param_server.py:410] Lock worker 3 with localStep 22 , while globalStep is 21

2021-08-18:15:33:22,685 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:22,705 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:23,309 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:23,329 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:24,453 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:24,472 INFO     [learner.py:606] ====Pushing takes 0.017953872680664062 s
2021-08-18:15:33:24,506 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:24,513 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:24,513 INFO     [param_server.py:381] ====After aggregation in epoch: 21, virtual_clock: 595.743230175185, top_1: : 48.9835 % (1518.0), top_5: : 100.0 % (3099.0), test loss: 2.7051682295622648, test len: 3099.0
2021-08-18:15:33:24,515 INFO     [param_server.py:410] Lock worker 1 with localStep 22 , while globalStep is 22

2021-08-18:15:33:24,515 INFO     [param_server.py:441] ====Epoch 23 completes 20 clients with loss 5.453327178646775, sampled rewards are: 
 {6: 0, 7: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:24,516 INFO     [param_server.py:450] ====Start to sample for epoch 23, global virtualClock: 595.743230175185, round_duration: 26.45788205784899
2021-08-18:15:33:24,517 INFO     [oort.py:208] Training selector: Pacer 21: lastExploitationUtil 447.5843221421019, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:24,518 INFO     [oort.py:321] scores are 26,{5: 0.010994167232525644, 6: 0.06628405644848612, 7: 0.23803043899284337, 11: 0.02031566934690976, 14: 0.00789176131797323, 16: 0.6994040496219962, 17: 0.009431906260495324, 25: 0.004379606387189211, 27: 0.010176813500623196, 35: 0.003271004432776456, 37: 0.2814696950382552, 38: 0.022029291363806717, 49: 0.017539826376241907, 50: 0.01635871525262246, 51: 0.35926223971753396, 53: 0.44400960268483197, 55: 0.48810481985887366, 58: 0.0053958832142315585, 59: 0.005583752874592786, 60: 0.0024078435026192507, 65: 0.016984052920182794, 67: 0.0034771532688254113, 70: 0.0069412131055877, 71: 0.018149568723031605, 76: 0.0025324917278004982, 81: 0.03025629049997473, 82: 0.37379887510027865, 83: 0.05290521664061854, 84: 0.5045953016534654, 85: 0.013152775163361417, 86: 0.002369204832339313, 87: 0.013740803968822995, 88: 0.0027043425154205042, 96: 0.004275483324599555, 97: 0.2884978808448079, 98: 0.05222117261223332, 99: 0.0245554151970616, 104: 0.005003311708135023, 105: 0.016231910845208145, 106: 0.01793544259801422, 107: 0.008405895090040248, 110: 0.055349416190358665, 111: 0.0047437638329854755, 119: 0.010357447343157954},[16, 84, 55, 53, 82, 51, 97, 37, 7, 6, 110, 83, 98, 81, 99, 38, 11, 71, 106, 49, 65, 50, 105, 87, 85, 5, 119, 27, 17, 107, 14, 70, 59, 58, 104, 111, 25, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:33:24,519 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:33:24,519 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:24,520 INFO     [oort.py:398] At round 21, UCB exploited 44, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 922.5024634411284, 'duration': 11.058674649423494, 'time_stamp': 22, 'count': 19, 'status': True, 'gradient': 17.854854817007823}, [0.5624340155958472, -1.3636983499249978e-05]), ({'reward': 1640.189011647246, 'duration': 13.298442137908651, 'time_stamp': 22, 'count': 19, 'status': True, 'gradient': 16.23066224894762}, [1.0, -1.3636983499249978e-05]), ({'reward': 197.47486876445384, 'duration': 5.8943907365129, 'time_stamp': 22, 'count': 19, 'status': True, 'gradient': 20.689936964271045}, [0.12039227191562185, -1.3636983499249978e-05])]
2021-08-18:15:33:24,521 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:33:24,861 INFO     [param_server.py:553] For epoch: 23, median_reward: 339.1031215367285, dev: 678.206243073457
2021-08-18:15:33:25,599 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6381, Top-1 Accuracy: 507.0/1033 (0.4908), Top-5 Accuracy: 1.0
2021-08-18:15:33:25,600 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 257.0138, eval_time 0.6903, test_loss 2.6381, test_accuracy 0.4908, test_5_accuracy 1.0 

2021-08-18:15:33:25,601 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5569, Top-1 Accuracy: 513.0/1033 (0.4966), Top-5 Accuracy: 1.0
2021-08-18:15:33:25,602 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 257.0188, eval_time 0.6923, test_loss 2.5569, test_accuracy 0.4966, test_5_accuracy 1.0 

2021-08-18:15:33:25,644 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5696, Top-1 Accuracy: 519.0/1033 (0.5024), Top-5 Accuracy: 1.0
2021-08-18:15:33:25,645 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 257.0648, eval_time 0.7392, test_loss 2.5696, test_accuracy 0.5024, test_5_accuracy 1.0 

2021-08-18:15:33:25,666 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:25,670 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:25,675 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:25,679 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:25,723 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:25,739 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:26,219 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:26,229 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:27,370 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:27,380 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:27,385 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:27,405 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:27,957 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:27,970 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:28,264 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:28,285 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:28,564 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:28,578 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:28,845 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:28,866 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:29,92 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:29,106 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:29,459 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:29,479 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:29,508 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:29,529 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:29,616 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:29,630 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:30,90 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:30,111 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:30,147 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:30,173 INFO     [learner.py:606] ====Pushing takes 0.025285959243774414 s
2021-08-18:15:33:30,224 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:30,235 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:33:30,235 INFO     [param_server.py:410] Lock worker 2 with localStep 23 , while globalStep is 22

2021-08-18:15:33:30,716 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:30,736 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:31,702 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:31,716 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:32,282 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:32,307 INFO     [learner.py:606] ====Pushing takes 0.023592233657836914 s
2021-08-18:15:33:32,337 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:32,344 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:32,345 INFO     [param_server.py:410] Lock worker 3 with localStep 23 , while globalStep is 22

2021-08-18:15:33:32,580 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:32,600 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:33,226 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:33,246 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:33,912 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:33,932 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:34,433 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:34,461 INFO     [learner.py:606] ====Pushing takes 0.026061058044433594 s
2021-08-18:15:33:34,498 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:34,509 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:34,509 INFO     [param_server.py:381] ====After aggregation in epoch: 22, virtual_clock: 615.4273395204547, top_1: : 49.6612 % (1539.0), top_5: : 100.0 % (3099.0), test loss: 2.588225214569657, test len: 3099.0
2021-08-18:15:33:34,510 INFO     [param_server.py:410] Lock worker 1 with localStep 23 , while globalStep is 23

2021-08-18:15:33:34,511 INFO     [param_server.py:441] ====Epoch 24 completes 20 clients with loss 5.129964370285141, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:34,511 INFO     [param_server.py:450] ====Start to sample for epoch 24, global virtualClock: 615.4273395204547, round_duration: 19.68410934526964
2021-08-18:15:33:34,512 INFO     [oort.py:208] Training selector: Pacer 22: lastExploitationUtil 452.8264369683022, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:34,513 INFO     [oort.py:321] scores are 26,{5: 0.011077843804329041, 6: 0.1844318364907963, 7: 0.11592806670569862, 11: 0.049554611158570606, 14: 0.008797632262582844, 16: 0.8070561041574537, 17: 0.010488182716043737, 25: 0.004799640393162103, 27: 0.03766165172130841, 35: 0.003452332993341606, 37: 0.04905493075641269, 38: 0.05562040194455685, 49: 0.019553168955616252, 50: 0.0182364817284969, 51: 0.06396571604834266, 53: 0.19346893422777608, 55: 0.18038639179241303, 58: 0.0059349112217398905, 59: 0.006141548339563631, 60: 0.002648377820001354, 65: 0.023169986349332754, 67: 0.003756985122426757, 70: 0.007606922598472678, 71: 0.06733222008376955, 76: 0.002763832413772243, 81: 0.2870143477995023, 82: 0.9022004797497187, 83: 0.2758081795923728, 84: 0.21234686099152117, 85: 0.06958216984737542, 86: 0.002605879294971626, 87: 0.015782508224355212, 88: 0.002951381605717275, 96: 0.004308023996345741, 97: 0.1477110084485606, 98: 0.1924200241374537, 99: 0.11869153299657648, 104: 0.0055031233300519, 105: 0.018049717848461155, 106: 0.01994402762980901, 107: 0.010551100170293258, 110: 0.013363006532201528, 111: 0.004779868586042314, 119: 0.011382369062792783},[82, 16, 81, 83, 84, 53, 98, 6, 55, 97, 99, 7, 85, 71, 51, 38, 11, 37, 27, 65, 106, 49, 50, 105, 87, 110, 119, 5, 107, 17, 14, 70, 59, 58, 104, 25, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:33:34,514 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:33:34,514 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:34,515 INFO     [oort.py:398] At round 22, UCB exploited 44, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 979.7737160909114, 'duration': 7.864087706209871, 'time_stamp': 23, 'count': 21, 'status': True, 'gradient': 21.412925600098674}, [0.6911280445057827, -1.304404539327798e-05]), ({'reward': 1114.653220240581, 'duration': 6.342067858842259, 'time_stamp': 23, 'count': 21, 'status': True, 'gradient': 51.95969199813933}, [0.7862724200980478, -1.304404539327798e-05]), ({'reward': 504.7087331384433, 'duration': 15.972045438625893, 'time_stamp': 23, 'count': 21, 'status': True, 'gradient': 12.991227214187258}, [0.3560158904856544, -1.304404539327798e-05])]
2021-08-18:15:33:34,516 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:33:34,859 INFO     [param_server.py:553] For epoch: 24, median_reward: 348.9616423646876, dev: 697.9232847293752
2021-08-18:15:33:35,496 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6338, Top-1 Accuracy: 484.0/1033 (0.4685), Top-5 Accuracy: 1.0
2021-08-18:15:33:35,497 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 266.9144, eval_time 0.5937, test_loss 3.6338, test_accuracy 0.4685, test_5_accuracy 1.0 

2021-08-18:15:33:35,503 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5341, Top-1 Accuracy: 496.0/1033 (0.4802), Top-5 Accuracy: 1.0
2021-08-18:15:33:35,504 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 266.918, eval_time 0.6001, test_loss 3.5341, test_accuracy 0.4802, test_5_accuracy 1.0 

2021-08-18:15:33:35,572 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:35,579 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:35,584 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3874, Top-1 Accuracy: 508.0/1033 (0.4918), Top-5 Accuracy: 1.0
2021-08-18:15:33:35,585 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 267.0044, eval_time 0.6811, test_loss 4.3874, test_accuracy 0.4918, test_5_accuracy 1.0 

2021-08-18:15:33:35,587 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:35,596 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:35,654 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:35,673 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:36,205 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:36,215 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:36,816 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:36,826 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:37,510 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:37,528 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:37,919 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:37,931 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:38,22 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:38,41 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:38,55 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:38,89 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:38,444 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:38,453 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:38,553 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:38,571 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:38,931 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:38,945 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:39,14 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:39,26 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:39,274 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:39,288 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:39,906 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:39,924 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:40,281 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:40,299 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:40,353 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:40,374 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:40,972 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:40,996 INFO     [learner.py:606] ====Pushing takes 0.02219986915588379 s
2021-08-18:15:33:41,32 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:41,39 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:41,40 INFO     [param_server.py:410] Lock worker 3 with localStep 24 , while globalStep is 23

2021-08-18:15:33:41,309 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:41,334 INFO     [learner.py:606] ====Pushing takes 0.023359060287475586 s
2021-08-18:15:33:41,375 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:41,384 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:41,385 INFO     [param_server.py:410] Lock worker 2 with localStep 24 , while globalStep is 23

2021-08-18:15:33:42,279 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:42,300 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:42,917 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:42,938 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:43,567 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:43,594 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:44,296 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:44,318 INFO     [learner.py:606] ====Pushing takes 0.021646499633789062 s
2021-08-18:15:33:44,359 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:44,366 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:44,367 INFO     [param_server.py:381] ====After aggregation in epoch: 23, virtual_clock: 634.3997481192484, top_1: : 48.0155 % (1488.0), top_5: : 100.0 % (3099.0), test loss: 3.8517581533502647, test len: 3099.0
2021-08-18:15:33:44,442 INFO     [param_server.py:410] Lock worker 1 with localStep 24 , while globalStep is 24

2021-08-18:15:33:44,443 INFO     [param_server.py:441] ====Epoch 25 completes 20 clients with loss 15.355604808952272, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:44,443 INFO     [param_server.py:450] ====Start to sample for epoch 25, global virtualClock: 634.3997481192484, round_duration: 18.972408598793734
2021-08-18:15:33:44,444 INFO     [oort.py:208] Training selector: Pacer 23: lastExploitationUtil 619.1069686877793, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:44,445 INFO     [oort.py:321] scores are 26,{5: 0.011157213392428119, 6: 0.06440331155870405, 7: 0.23514055736342165, 11: 0.11887895751011482, 14: 0.005003541429070862, 16: 1.1143003028562835, 17: 0.006006820550002175, 25: 0.0030442645858180907, 27: 0.02536335769828922, 35: 0.002753050785585149, 37: 0.04836614413684644, 38: 0.030790155177595122, 49: 0.01112061609521348, 50: 0.012281415925698373, 51: 0.0630675651663477, 53: 0.18609205542963925, 55: 0.11430030574573373, 58: 0.0036727297529319004, 59: 0.003800603997775088, 60: 0.0016389084272893937, 65: 0.015603900115461764, 67: 0.002611245569887559, 70: 0.004824837524615687, 71: 0.011298353780360221, 76: 0.0018021318650999613, 81: 0.05708361118311732, 82: 0.33070879190502295, 83: 0.07388306296151666, 84: 0.20348987569134788, 85: 0.04567088198684785, 86: 0.001612608859949506, 87: 0.03435459725233305, 88: 0.0019244216151563275, 96: 0.004338889842675914, 97: 0.08568627374063433, 98: 0.11102271603294601, 99: 0.0565099703212932, 104: 0.0034055243681320063, 105: 0.012186216660681684, 106: 0.013465154625904316, 107: 0.006000803994601134, 110: 0.011903491254123124, 111: 0.004814115064828419, 119: 0.009797865816673596},[16, 82, 7, 84, 53, 11, 55, 98, 97, 83, 6, 51, 81, 99, 37, 85, 87, 38, 27, 65, 106, 50, 105, 110, 71, 5, 49, 119, 17, 107, 14, 70, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:44,446 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999996
2021-08-18:15:33:44,446 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:44,446 INFO     [oort.py:398] At round 23, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1164.2919141425477, 'duration': 13.298442137908651, 'time_stamp': 24, 'count': 21, 'status': True, 'gradient': 11.372176815918012}, [0.33641346903419994, -1.2500520855035638e-05]), ({'reward': 3460.87595201113, 'duration': 7.864087706209871, 'time_stamp': 24, 'count': 22, 'status': True, 'gradient': 21.42367303915168}, [1.0, -1.2500520855035638e-05]), ({'reward': 551.9196969014705, 'duration': 15.972045438625893, 'time_stamp': 24, 'count': 22, 'status': True, 'gradient': 12.996400689303274}, [0.1594715637530072, -1.2500520855035638e-05])]
2021-08-18:15:33:44,447 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:33:44,801 INFO     [param_server.py:553] For epoch: 25, median_reward: 386.25963796598467, dev: 772.5192759319693
2021-08-18:15:33:45,508 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5117, Top-1 Accuracy: 539.0/1033 (0.5218), Top-5 Accuracy: 1.0
2021-08-18:15:33:45,510 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 276.9238, eval_time 0.659, test_loss 2.5117, test_accuracy 0.5218, test_5_accuracy 1.0 

2021-08-18:15:33:45,511 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6405, Top-1 Accuracy: 548.0/1033 (0.5305), Top-5 Accuracy: 1.0
2021-08-18:15:33:45,511 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 276.9285, eval_time 0.6652, test_loss 2.6405, test_accuracy 0.5305, test_5_accuracy 1.0 

2021-08-18:15:33:45,587 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.545, Top-1 Accuracy: 540.0/1033 (0.5227), Top-5 Accuracy: 1.0
2021-08-18:15:33:45,588 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 277.0075, eval_time 0.7424, test_loss 2.545, test_accuracy 0.5227, test_5_accuracy 1.0 

2021-08-18:15:33:45,607 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:45,623 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:45,623 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:45,636 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:45,653 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:45,682 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:46,210 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:46,230 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:47,159 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:47,168 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:47,822 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:47,848 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:48,174 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:48,194 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:48,464 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:48,477 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:48,517 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:48,535 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:48,970 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:48,983 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:49,90 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:49,110 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:49,178 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:49,192 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:49,641 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:49,662 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:50,184 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:50,198 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:50,284 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:50,297 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:51,341 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:51,355 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:51,545 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:51,566 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:51,937 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:51,963 INFO     [learner.py:606] ====Pushing takes 0.02423262596130371 s
2021-08-18:15:33:52,0 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:52,10 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:52,10 INFO     [param_server.py:410] Lock worker 3 with localStep 25 , while globalStep is 24

2021-08-18:15:33:52,104 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:52,133 INFO     [learner.py:606] ====Pushing takes 0.027198314666748047 s
2021-08-18:15:33:52,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:52,175 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:52,175 INFO     [param_server.py:410] Lock worker 2 with localStep 25 , while globalStep is 24

2021-08-18:15:33:52,430 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:52,444 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:53,11 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:53,25 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:53,636 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:53,649 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:54,226 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:54,250 INFO     [learner.py:606] ====Pushing takes 0.02315044403076172 s
2021-08-18:15:33:54,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:54,299 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:54,300 INFO     [param_server.py:381] ====After aggregation in epoch: 24, virtual_clock: 655.4279795242817, top_1: : 52.5008 % (1627.0), top_5: : 100.0 % (3099.0), test loss: 2.5657123415558427, test len: 3099.0
2021-08-18:15:33:54,301 INFO     [param_server.py:410] Lock worker 1 with localStep 25 , while globalStep is 25

2021-08-18:15:33:54,302 INFO     [param_server.py:441] ====Epoch 26 completes 20 clients with loss 6.053906202797854, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:54,302 INFO     [param_server.py:450] ====Start to sample for epoch 26, global virtualClock: 655.4279795242817, round_duration: 21.0282314050332
2021-08-18:15:33:54,303 INFO     [oort.py:208] Training selector: Pacer 24: lastExploitationUtil 580.1398704560614, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:54,303 INFO     [oort.py:321] scores are 26,{5: 0.011232679477077158, 6: 0.06352891573574346, 7: 0.11274846458278222, 11: 0.18774923392758716, 14: 0.0062077714804813265, 16: 0.883090943567616, 17: 0.007430054222795984, 25: 0.003607932844163818, 27: 0.03077212902955757, 35: 0.0029913643399586973, 37: 0.047709482959300935, 38: 0.02773770999039009, 50: 0.015681452728933138, 51: 0.18888512891545983, 53: 0.08337129671970227, 55: 0.830068980098225, 58: 0.004396899620337697, 59: 0.004549987447764461, 60: 0.001962059919046432, 65: 0.018931453533445424, 67: 0.0029847331293947447, 70: 0.0057181921222977375, 71: 0.03862019382873778, 76: 0.0021121436375056185, 81: 0.12590948112623912, 82: 0.15156871541483533, 83: 0.05070617626661368, 84: 0.12073372207090943, 85: 0.02724251533761625, 86: 0.0019305747389676403, 87: 0.04044199726236952, 88: 0.0022554702844152104, 96: 0.004368237559804296, 97: 0.2887381613913256, 98: 0.05005056498137805, 99: 0.03678707848902785, 104: 0.004077008059015781, 105: 0.014784944325014773, 106: 0.016336617591416924, 107: 0.007445050755692616, 110: 0.011741879020538429, 111: 0.0048466771494933645, 119: 0.011887274339284654},[16, 55, 97, 51, 11, 82, 81, 84, 7, 53, 6, 83, 98, 37, 87, 71, 99, 27, 38, 85, 65, 106, 50, 105, 119, 110, 5, 107, 17, 14, 70, 111, 59, 58, 96, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:54,304 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:33:54,305 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:54,306 INFO     [oort.py:398] At round 24, UCB exploited 43, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 548.1867609930993, 'duration': 12.029357192292537, 'time_stamp': 25, 'count': 21, 'status': True, 'gradient': 26.511925344661837}, [0.22957691603151403, -1.2000480019200778e-05]), ({'reward': 1839.4103194587676, 'duration': 7.864087706209871, 'time_stamp': 25, 'count': 23, 'status': True, 'gradient': 21.431917379765864}, [0.7703424831728426, -1.2000480019200778e-05]), ({'reward': 899.7090041089093, 'duration': 17.619275735353515, 'time_stamp': 25, 'count': 22, 'status': True, 'gradient': 11.377024971659772}, [0.37679474203462227, -1.2000480019200778e-05])]
2021-08-18:15:33:54,307 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:33:54,655 INFO     [param_server.py:553] For epoch: 26, median_reward: 379.2024106370306, dev: 758.4048212740612
2021-08-18:15:33:55,419 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.271, Top-1 Accuracy: 493.0/1033 (0.4773), Top-5 Accuracy: 1.0
2021-08-18:15:33:55,422 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 286.8388, eval_time 0.7331, test_loss 3.271, test_accuracy 0.4773, test_5_accuracy 1.0 

2021-08-18:15:33:55,449 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0672, Top-1 Accuracy: 500.0/1033 (0.484), Top-5 Accuracy: 1.0
2021-08-18:15:33:55,451 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 286.8647, eval_time 0.762, test_loss 3.0672, test_accuracy 0.484, test_5_accuracy 1.0 

2021-08-18:15:33:55,489 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7765, Top-1 Accuracy: 519.0/1033 (0.5024), Top-5 Accuracy: 1.0
2021-08-18:15:33:55,490 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 286.9099, eval_time 0.8016, test_loss 2.7765, test_accuracy 0.5024, test_5_accuracy 1.0 

2021-08-18:15:33:55,510 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:33:55,520 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:55,535 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:33:55,547 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:55,556 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:33:55,575 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:55,994 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:56,4 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:57,113 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:57,127 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:57,142 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:57,151 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:57,796 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:57,806 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:57,974 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:58,1 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:58,371 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:58,381 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:58,449 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:58,469 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:58,951 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:58,965 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:59,24 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:59,45 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:59,363 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:59,390 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:59,530 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:59,548 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:59,574 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:59,595 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:00,883 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:00,889 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:00,916 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:00,917 INFO     [learner.py:606] ====Pushing takes 0.027043581008911133 s
2021-08-18:15:34:00,961 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:00,970 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:00,971 INFO     [param_server.py:410] Lock worker 2 with localStep 26 , while globalStep is 25

2021-08-18:15:34:00,985 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:01,6 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:01,672 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:01,694 INFO     [learner.py:606] ====Pushing takes 0.020719051361083984 s
2021-08-18:15:34:01,720 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:01,726 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:01,727 INFO     [param_server.py:410] Lock worker 3 with localStep 26 , while globalStep is 25

2021-08-18:15:34:02,951 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:02,972 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:03,476 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:03,489 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:04,11 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:04,25 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:04,498 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:04,522 INFO     [learner.py:606] ====Pushing takes 0.02167201042175293 s
2021-08-18:15:34:04,562 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:04,569 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:04,570 INFO     [param_server.py:381] ====After aggregation in epoch: 25, virtual_clock: 675.1833812896643, top_1: : 48.7899 % (1512.0), top_5: : 100.0 % (3099.0), test loss: 3.0382661201335766, test len: 3099.0
2021-08-18:15:34:04,571 INFO     [param_server.py:410] Lock worker 1 with localStep 26 , while globalStep is 26

2021-08-18:15:34:04,571 INFO     [param_server.py:441] ====Epoch 27 completes 20 clients with loss 7.9687594283734615, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:04,572 INFO     [param_server.py:450] ====Start to sample for epoch 27, global virtualClock: 675.1833812896643, round_duration: 19.755401765382704
2021-08-18:15:34:04,573 INFO     [oort.py:208] Training selector: Pacer 25: lastExploitationUtil 629.9415076210122, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:04,573 INFO     [oort.py:321] scores are 26,{5: 0.011304591235334734, 6: 0.5339444966750925, 7: 0.11126676586213301, 11: 0.01877356005939058, 14: 0.00876972759114512, 16: 1.1112667588910023, 17: 0.01045716978678419, 25: 0.004801376450017298, 27: 0.04761496792568597, 35: 0.0034839576121989788, 37: 0.16558463209355526, 38: 0.020836161750467354, 50: 0.023056065066005858, 51: 0.06139374659652429, 53: 0.6148669058185451, 55: 0.7965705954735908, 58: 0.005932118637492472, 59: 0.006138658525292273, 60: 0.00264713166518875, 65: 0.02929340871786207, 67: 0.0037706544625889593, 70: 0.007609674065049806, 71: 0.06713995389556178, 76: 0.002767480582042907, 81: 0.24353933817504594, 82: 0.40673886753681326, 83: 0.10095700424391289, 84: 0.11523186923423383, 85: 0.0618904151716859, 86: 0.0026046531372081946, 87: 0.0889445325735317, 88: 0.0029552773327790704, 96: 0.004396203017599448, 97: 0.29780768884625286, 98: 0.46661216900350433, 99: 0.08764862120713571, 104: 0.005500533917177987, 105: 0.022877346222694973, 106: 0.02527831343363823, 107: 0.01051763378129553, 110: 0.011587571578861689, 111: 0.004877705583238444, 119: 0.018393663494820158},[16, 55, 53, 6, 98, 82, 97, 81, 37, 84, 7, 83, 87, 99, 71, 85, 51, 27, 65, 106, 50, 105, 38, 11, 119, 110, 5, 107, 17, 14, 70, 59, 58, 104, 111, 25, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:34:04,574 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:34:04,575 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:04,576 INFO     [oort.py:398] At round 25, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 983.0698078426875, 'duration': 8.010998429338052, 'time_stamp': 26, 'count': 24, 'status': True, 'gradient': 20.627540938943948}, [0.6853038365825883, -1.1538905342513184e-05]), ({'reward': 1191.3531695355687, 'duration': 11.058674649423494, 'time_stamp': 26, 'count': 23, 'status': True, 'gradient': 13.007286663516465}, [0.8305008879458367, -1.1538905342513184e-05]), ({'reward': 1434.4975345976227, 'duration': 7.864087706209871, 'time_stamp': 26, 'count': 24, 'status': True, 'gradient': 21.44035592320001}, [1.0, -1.1538905342513184e-05])]
2021-08-18:15:34:04,576 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 11, 87, 85, 110, 71, 5]
2021-08-18:15:34:04,926 INFO     [param_server.py:553] For epoch: 27, median_reward: 389.6680797899245, dev: 779.336159579849
2021-08-18:15:34:05,564 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5853, Top-1 Accuracy: 558.0/1033 (0.5402), Top-5 Accuracy: 1.0
2021-08-18:15:34:05,566 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 296.9827, eval_time 0.6166, test_loss 2.5853, test_accuracy 0.5402, test_5_accuracy 1.0 

2021-08-18:15:34:05,571 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4485, Top-1 Accuracy: 550.0/1033 (0.5324), Top-5 Accuracy: 1.0
2021-08-18:15:34:05,572 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 296.9862, eval_time 0.6182, test_loss 2.4485, test_accuracy 0.5324, test_5_accuracy 1.0 

2021-08-18:15:34:05,573 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6052, Top-1 Accuracy: 556.0/1033 (0.5382), Top-5 Accuracy: 1.0
2021-08-18:15:34:05,574 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 296.9936, eval_time 0.6351, test_loss 2.6052, test_accuracy 0.5382, test_5_accuracy 1.0 

2021-08-18:15:34:05,641 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:34:05,643 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:34:05,650 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:05,650 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:34:05,653 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:05,659 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:06,258 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:06,267 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:07,203 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:07,213 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:07,716 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:07,727 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:07,797 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:07,816 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:08,464 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:08,473 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:08,489 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:08,502 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:08,619 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:08,633 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:09,38 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:09,52 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:09,684 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:09,688 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:09,702 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:09,702 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:09,845 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:09,866 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:10,937 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:10,949 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:11,282 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:11,292 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:11,484 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:11,496 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:11,916 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:11,941 INFO     [learner.py:606] ====Pushing takes 0.02313995361328125 s
2021-08-18:15:34:11,978 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:11,988 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:34:11,988 INFO     [param_server.py:410] Lock worker 3 with localStep 27 , while globalStep is 26

2021-08-18:15:34:12,65 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:12,94 INFO     [learner.py:606] ====Pushing takes 0.026888608932495117 s
2021-08-18:15:34:12,126 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:12,132 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:12,133 INFO     [param_server.py:410] Lock worker 2 with localStep 27 , while globalStep is 26

2021-08-18:15:34:12,593 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:12,620 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:13,334 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:13,361 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:14,49 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:14,76 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:14,586 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:14,609 INFO     [learner.py:606] ====Pushing takes 0.021651029586791992 s
2021-08-18:15:34:14,650 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:14,656 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:14,657 INFO     [param_server.py:381] ====After aggregation in epoch: 26, virtual_clock: 696.2116126946976, top_1: : 53.6947 % (1664.0), top_5: : 100.0 % (3099.0), test loss: 2.546350490163874, test len: 3099.0
2021-08-18:15:34:14,658 INFO     [param_server.py:410] Lock worker 1 with localStep 27 , while globalStep is 27

2021-08-18:15:34:14,658 INFO     [param_server.py:441] ====Epoch 28 completes 20 clients with loss 6.344454164968922, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:14,658 INFO     [param_server.py:450] ====Start to sample for epoch 28, global virtualClock: 696.2116126946976, round_duration: 21.0282314050332
2021-08-18:15:34:14,659 INFO     [oort.py:208] Training selector: Pacer 26: lastExploitationUtil 531.2922447780672, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:14,660 INFO     [oort.py:321] scores are 26,{5: 0.1013390115711781, 6: 0.47917475198486487, 7: 0.5812531974344223, 11: 0.08096528482903342, 14: 0.009621232003874774, 16: 0.36725468927285704, 17: 0.012771892165551071, 25: 0.005200934049422508, 27: 0.04574706826549766, 35: 0.0036549552875959593, 37: 0.28438029892423916, 38: 0.020962717717363598, 50: 0.022151592838506158, 51: 0.17417613267784285, 53: 0.2955069245099961, 55: 0.7817602980680665, 58: 0.006445111833039032, 59: 0.0066695127184899245, 60: 0.002876048282495594, 65: 0.02814425015336927, 67: 0.004036240332379307, 70: 0.008242930618319322, 71: 0.09392636585902314, 76: 0.0029874135278852654, 81: 0.12318653363240713, 82: 0.5262597136929982, 83: 0.4500409830382709, 84: 0.3990651021357598, 85: 0.020653740215130462, 86: 0.002829896329025344, 87: 0.01283110312631061, 88: 0.00319013457217457, 96: 0.00442290492622185, 97: 0.0904386937121988, 98: 0.14110322892048013, 99: 0.022929740167879027, 104: 0.0059762048610379585, 105: 0.021979885002053678, 106: 0.024286664060976258, 107: 0.01153885268270022, 110: 0.011440028025444436, 111: 0.004907332071376589, 119: 0.02034176175982622},[55, 7, 82, 6, 83, 84, 16, 53, 37, 51, 98, 81, 5, 71, 97, 11, 27, 65, 106, 99, 50, 105, 38, 85, 119, 87, 17, 107, 110, 14, 70, 59, 58, 104, 25, 111, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:34:14,661 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:34:14,661 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:14,662 INFO     [oort.py:398] At round 26, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 326.4255015244036, 'duration': 7.864087706209871, 'time_stamp': 27, 'count': 25, 'status': True, 'gradient': 21.45146731121512}, [0.2574046814672388, -1.1111522648987009e-05]), ({'reward': 528.0601652189582, 'duration': 6.342067858842259, 'time_stamp': 27, 'count': 25, 'status': True, 'gradient': 56.93039887453795}, [0.41640970588737997, -1.1111522648987009e-05]), ({'reward': 1129.69304166048, 'duration': 13.324368782156236, 'time_stamp': 27, 'count': 25, 'status': True, 'gradient': 21.145447444430214}, [0.8908452441907447, -1.1111522648987009e-05])]
2021-08-18:15:34:14,662 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 85, 71, 5, 27]
2021-08-18:15:34:14,996 INFO     [param_server.py:553] For epoch: 28, median_reward: 369.8136396900066, dev: 739.6272793800132
2021-08-18:15:34:15,780 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4558, Top-1 Accuracy: 539.0/1033 (0.5218), Top-5 Accuracy: 1.0
2021-08-18:15:34:15,781 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4152, Top-1 Accuracy: 509.0/1033 (0.4927), Top-5 Accuracy: 1.0
2021-08-18:15:34:15,781 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 307.2007, eval_time 0.7508, test_loss 2.4558, test_accuracy 0.5218, test_5_accuracy 1.0 

2021-08-18:15:34:15,781 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 307.1955, eval_time 0.7434, test_loss 2.4152, test_accuracy 0.4927, test_5_accuracy 1.0 

2021-08-18:15:34:15,783 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8752, Top-1 Accuracy: 506.0/1033 (0.4898), Top-5 Accuracy: 1.0
2021-08-18:15:34:15,786 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 307.2033, eval_time 0.7545, test_loss 2.8752, test_accuracy 0.4898, test_5_accuracy 1.0 

2021-08-18:15:34:15,832 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:15,852 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:15,866 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:15,869 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:15,883 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:15,896 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:16,537 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:16,546 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:17,710 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:17,723 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:18,236 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:18,248 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:18,800 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:18,819 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:18,824 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:18,843 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:19,137 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:19,150 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:19,483 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:19,497 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:19,706 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:19,719 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:19,998 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:20,12 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:20,314 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:20,328 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:20,672 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:20,693 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:21,302 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:21,322 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:22,67 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:22,77 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:34:22,394 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:22,412 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:22,650 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:34:22,675 INFO     [learner.py:606] ====Pushing takes 0.02208256721496582 s
2021-08-18:15:34:22,711 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:22,718 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:34:22,718 INFO     [param_server.py:410] Lock worker 3 with localStep 28 , while globalStep is 27

2021-08-18:15:34:23,7 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:23,34 INFO     [learner.py:606] ====Pushing takes 0.025905370712280273 s
2021-08-18:15:34:23,63 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:23,71 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:23,71 INFO     [param_server.py:410] Lock worker 2 with localStep 28 , while globalStep is 27

2021-08-18:15:34:23,740 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:23,767 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:24,338 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:24,365 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:25,72 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:25,105 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:25,764 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:25,785 INFO     [learner.py:606] ====Pushing takes 0.020073890686035156 s
2021-08-18:15:34:25,825 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:25,832 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:25,833 INFO     [param_server.py:381] ====After aggregation in epoch: 27, virtual_clock: 720.1095216506903, top_1: : 50.1452 % (1554.0), top_5: : 100.0 % (3099.0), test loss: 2.5820742006655095, test len: 3099.0
2021-08-18:15:34:25,834 INFO     [param_server.py:410] Lock worker 1 with localStep 28 , while globalStep is 28

2021-08-18:15:34:25,834 INFO     [param_server.py:441] ====Epoch 29 completes 20 clients with loss 6.860119433758577, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:34:25,835 INFO     [param_server.py:450] ====Start to sample for epoch 29, global virtualClock: 720.1095216506903, round_duration: 23.89790895599279
2021-08-18:15:34:25,835 INFO     [oort.py:208] Training selector: Pacer 27: lastExploitationUtil 523.514624795173, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:25,836 INFO     [oort.py:321] scores are 26,{5: 0.04097912303010992, 6: 0.06113144510883891, 7: 0.10849353391168118, 11: 0.018305644629504368, 14: 0.00642802939089728, 16: 1.1084935295306382, 17: 0.008159654786708019, 25: 0.0037234930536463903, 27: 0.04527856334535396, 35: 0.003066239960290514, 37: 0.04590901017151539, 38: 0.06439713486066571, 50: 0.014378251903538973, 51: 0.21186940337881405, 53: 0.5129350472789691, 55: 0.10849353391168118, 58: 0.004541134361125133, 59: 0.0046992440414512626, 60: 0.0020264228175133625, 65: 0.017980684655454795, 67: 0.0030718477678480026, 70: 0.005901342837140787, 71: 0.05961585773237132, 76: 0.0021779690683262024, 81: 0.027904308532078884, 82: 0.3329936079839593, 83: 0.04879261349297022, 84: 0.18780162811578677, 85: 0.011851444514127672, 86: 0.001993904805853357, 87: 0.012905203611424587, 88: 0.0023257625223758785, 96: 0.004448447588112122, 97: 0.11432928167172425, 98: 0.06417213836202483, 99: 0.09034642110725659, 104: 0.0042107491610096585, 105: 0.014042419990989699, 106: 0.015516165662033211, 107: 0.00818800676313829, 110: 0.011506094958120293, 111: 0.0049356723350955775, 119: 0.011290275779931481},[16, 53, 82, 51, 84, 97, 7, 55, 99, 38, 98, 6, 71, 83, 37, 27, 5, 81, 11, 65, 106, 50, 105, 87, 85, 110, 119, 107, 17, 14, 70, 111, 59, 58, 96, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:34:25,837 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:34:25,838 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:25,838 INFO     [oort.py:398] At round 27, UCB exploited 43, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 628.8267487291079, 'duration': 12.029357192292537, 'time_stamp': 28, 'count': 24, 'status': True, 'gradient': 26.540473914442344}, [0.2754873252952981, -1.0714668381013617e-05]), ({'reward': 2282.571476467923, 'duration': 7.864087706209871, 'time_stamp': 28, 'count': 26, 'status': True, 'gradient': 21.45446673709514}, [1.0, -1.0714668381013617e-05]), ({'reward': 1545.6443711101379, 'duration': 11.058674649423494, 'time_stamp': 28, 'count': 25, 'status': True, 'gradient': 14.643597220504267}, [0.6771490670780924, -1.0714668381013617e-05])]
2021-08-18:15:34:25,839 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:34:26,168 INFO     [param_server.py:553] For epoch: 29, median_reward: 363.53291703843263, dev: 727.0658340768653
2021-08-18:15:34:26,826 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3082, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:34:26,827 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 318.2438, eval_time 0.6139, test_loss 2.3082, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:34:26,869 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9555, Top-1 Accuracy: 546.0/1033 (0.5286), Top-5 Accuracy: 1.0
2021-08-18:15:34:26,870 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 318.2839, eval_time 0.6571, test_loss 1.9555, test_accuracy 0.5286, test_5_accuracy 1.0 

2021-08-18:15:34:26,913 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:26,923 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:26,935 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:26,943 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9403, Top-1 Accuracy: 574.0/1033 (0.5557), Top-5 Accuracy: 1.0
2021-08-18:15:34:26,945 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 318.3644, eval_time 0.7321, test_loss 1.9403, test_accuracy 0.5557, test_5_accuracy 1.0 

2021-08-18:15:34:26,947 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:27,13 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:27,39 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:27,605 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:27,626 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:28,717 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:28,738 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:28,981 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:29,1 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:29,601 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:29,610 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:29,622 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:29,638 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:30,137 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:30,157 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:30,182 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:30,196 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:30,515 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:30,529 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:30,755 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:30,783 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:30,789 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:30,810 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:31,404 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:31,425 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:31,454 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:31,473 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:31,754 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:31,768 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:32,53 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:32,79 INFO     [learner.py:606] ====Pushing takes 0.02456188201904297 s
2021-08-18:15:34:32,119 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:32,129 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:32,129 INFO     [param_server.py:410] Lock worker 2 with localStep 29 , while globalStep is 28

2021-08-18:15:34:33,193 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:33,211 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:33,427 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:33,437 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:33,786 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:33,812 INFO     [learner.py:606] ====Pushing takes 0.024425268173217773 s
2021-08-18:15:34:33,847 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:33,853 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:33,854 INFO     [param_server.py:410] Lock worker 3 with localStep 29 , while globalStep is 28

2021-08-18:15:34:34,90 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:34,102 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:34,707 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:34,716 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:35,349 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:35,371 INFO     [learner.py:606] ====Pushing takes 0.020190954208374023 s
2021-08-18:15:34:35,404 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:35,411 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:35,412 INFO     [param_server.py:381] ====After aggregation in epoch: 28, virtual_clock: 740.4656920258418, top_1: : 55.3404 % (1715.0), top_5: : 100.0 % (3099.0), test loss: 2.0679714392732693, test len: 3099.0
2021-08-18:15:34:35,413 INFO     [param_server.py:410] Lock worker 1 with localStep 29 , while globalStep is 29

2021-08-18:15:34:35,413 INFO     [param_server.py:441] ====Epoch 30 completes 20 clients with loss 2.9610017619919913, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:35,413 INFO     [param_server.py:450] ====Start to sample for epoch 30, global virtualClock: 740.4656920258418, round_duration: 20.356170375151418
2021-08-18:15:34:35,414 INFO     [oort.py:208] Training selector: Pacer 28: lastExploitationUtil 419.1528654094535, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:35,415 INFO     [oort.py:321] scores are 26,{5: 0.03395134524427441, 6: 0.07726547337939686, 7: 0.10719310487850374, 11: 0.0590156034675655, 14: 0.008209893261199695, 16: 0.10719310487850374, 17: 0.010617740058880892, 25: 0.0045543808616699336, 27: 0.032166822042912525, 35: 0.003410943944387899, 37: 0.04535873397016982, 38: 0.20733643430673043, 50: 0.015575781614418424, 51: 0.36853053808578023, 53: 0.2925791283280584, 55: 0.10719310487850374, 58: 0.005609684308980938, 59: 0.0058049979293873875, 60: 0.002503249492038629, 65: 0.023397342258072534, 67: 0.003619725772828381, 70: 0.007218212170237977, 71: 0.010595821365751658, 76: 0.002634374498515258, 81: 0.02756984092228201, 82: 0.23463025788237987, 83: 0.0482077737435109, 84: 0.24745063673806236, 85: 0.08988538747074369, 86: 0.002463079841624851, 87: 0.018665481932339318, 88: 0.0028131388859705714, 96: 0.004472923300969954, 97: 0.14656263858448568, 98: 0.2847940653880356, 99: 0.1882172203252202, 104: 0.005201557941068735, 105: 0.015455046108779343, 106: 0.017077046256418153, 107: 0.010654633030919675, 110: 0.02074844934123102, 111: 0.0049628288011824145, 119: 0.012426044290915534},[51, 53, 98, 84, 82, 38, 99, 97, 7, 16, 55, 85, 6, 11, 83, 37, 5, 27, 81, 65, 110, 87, 106, 50, 105, 119, 107, 17, 71, 14, 70, 59, 58, 104, 111, 25, 96, 67, 35, 88, 76, 60, 86]
2021-08-18:15:34:35,416 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:34:35,416 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:35,417 INFO     [oort.py:398] At round 28, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 419.1544775358587, 'duration': 41.695355953560366, 'time_stamp': 29, 'count': 18, 'status': True, 'gradient': 17.213092011550128}, [0.2646370604249293, -1.0345184316700584e-05]), ({'reward': 888.091862427659, 'duration': 12.029357192292537, 'time_stamp': 29, 'count': 25, 'status': True, 'gradient': 26.551819465888332}, [0.5607120769202919, -1.0345184316700584e-05]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 29, 'count': 26, 'status': True, 'gradient': 9.766617083740718}, [6.313743071767782e-09, -1.0345184316700584e-05])]
2021-08-18:15:34:35,417 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 27]
2021-08-18:15:34:35,703 INFO     [param_server.py:553] For epoch: 30, median_reward: 349.58141242613624, dev: 699.1628248522725
2021-08-18:15:34:36,339 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3897, Top-1 Accuracy: 553.0/1033 (0.5353), Top-5 Accuracy: 1.0
2021-08-18:15:34:36,342 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 327.7589, eval_time 0.604, test_loss 2.3897, test_accuracy 0.5353, test_5_accuracy 1.0 

2021-08-18:15:34:36,342 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.33, Top-1 Accuracy: 543.0/1033 (0.5257), Top-5 Accuracy: 1.0
2021-08-18:15:34:36,343 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 327.7568, eval_time 0.6048, test_loss 2.33, test_accuracy 0.5257, test_5_accuracy 1.0 

2021-08-18:15:34:36,398 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:36,407 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:36,420 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:36,425 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0399, Top-1 Accuracy: 566.0/1033 (0.5479), Top-5 Accuracy: 1.0
2021-08-18:15:34:36,426 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 327.8456, eval_time 0.6887, test_loss 2.0399, test_accuracy 0.5479, test_5_accuracy 1.0 

2021-08-18:15:34:36,429 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:36,495 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:36,518 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:37,37 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:37,47 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:38,164 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:38,175 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:38,711 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:38,722 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:39,319 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:39,328 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:39,681 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:39,695 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:39,797 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:39,810 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:39,907 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:39,933 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:40,297 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:40,311 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:40,872 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:40,886 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:41,117 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:41,131 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:41,337 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:41,357 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:42,666 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:42,686 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:42,815 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:42,836 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:43,40 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:43,64 INFO     [learner.py:606] ====Pushing takes 0.023339033126831055 s
2021-08-18:15:34:43,100 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:43,107 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:34:43,107 INFO     [param_server.py:410] Lock worker 2 with localStep 30 , while globalStep is 29

2021-08-18:15:34:43,292 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:43,319 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:34:43,968 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:34:43,996 INFO     [learner.py:606] ====Pushing takes 0.027027130126953125 s
2021-08-18:15:34:44,26 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:44,33 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:44,33 INFO     [param_server.py:410] Lock worker 3 with localStep 30 , while globalStep is 29

2021-08-18:15:34:45,289 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:45,303 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:45,884 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:45,902 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:46,483 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:46,497 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:47,1 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:47,24 INFO     [learner.py:606] ====Pushing takes 0.02104949951171875 s
2021-08-18:15:34:47,67 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:47,74 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:47,75 INFO     [param_server.py:381] ====After aggregation in epoch: 29, virtual_clock: 764.8622352909938, top_1: : 53.6302 % (1662.0), top_5: : 100.0 % (3099.0), test loss: 2.253240466117859, test len: 3099.0
2021-08-18:15:34:47,76 INFO     [param_server.py:410] Lock worker 1 with localStep 30 , while globalStep is 30

2021-08-18:15:34:47,77 INFO     [param_server.py:441] ====Epoch 31 completes 20 clients with loss 5.183403200503296, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:47,77 INFO     [param_server.py:450] ====Start to sample for epoch 31, global virtualClock: 764.8622352909938, round_duration: 24.39654326515194
2021-08-18:15:34:47,78 INFO     [oort.py:208] Training selector: Pacer 29: lastExploitationUtil 700.6210254643988, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:47,78 INFO     [oort.py:321] scores are 26,{5: 0.0253142735581738, 6: 0.17636095711683555, 7: 0.3364422964330368, 11: 0.10104328511922321, 14: 0.007865880108968003, 16: 1.1059448886605119, 17: 0.009400974111459135, 25: 0.0036002724931876607, 27: 0.0704059457227707, 35: 0.0030332138579276862, 37: 0.1462305753964095, 38: 0.1337705917589666, 50: 0.01630506647746933, 51: 0.24914691770093422, 53: 0.06916993653689978, 55: 0.2016588535982975, 58: 0.004379726445953699, 59: 0.004532216351166294, 60: 0.001954396610794912, 65: 0.020716066472272653, 67: 0.0029979302499908086, 70: 0.005706051275863537, 71: 0.01065146711757808, 76: 0.0021118617676320985, 81: 0.02724880337862395, 82: 0.10594489270403802, 84: 0.24013024940777616, 85: 0.011573040089736902, 86: 0.0019230344038414344, 87: 0.012374962674653923, 88: 0.0022551692873085238, 96: 0.004496413676235492, 97: 0.052622586537841944, 98: 0.20862933869852773, 99: 0.022114597312772523, 104: 0.004061084299910935, 105: 0.016178677927965415, 106: 0.01787662291001589, 107: 0.0077881268930277085, 110: 0.05584784541679258, 111: 0.004988892000160808, 119: 0.009264913721769737},[16, 7, 51, 84, 98, 55, 6, 37, 38, 82, 11, 27, 53, 110, 97, 81, 5, 99, 65, 106, 50, 105, 87, 85, 71, 17, 119, 14, 107, 70, 111, 59, 96, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:34:47,92 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:34:47,93 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:47,94 INFO     [oort.py:398] At round 29, UCB exploited 42, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2473.0989489634267, 'duration': 7.864087706209871, 'time_stamp': 30, 'count': 28, 'status': True, 'gradient': 21.470403013598094}, [1.0, -1.0000333344444823e-05]), ({'reward': 0.01, 'duration': 6.342067858842259, 'time_stamp': 30, 'count': 28, 'status': True, 'gradient': 68.37594845115161}, [4.043526199797926e-09, -1.0000333344444823e-05]), ({'reward': 900.2949329463202, 'duration': 13.411352670399307, 'time_stamp': 30, 'count': 27, 'status': True, 'gradient': 14.655176365743085}, [0.3640325754087175, -1.0000333344444823e-05])]
2021-08-18:15:34:47,95 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 98, 37, 97, 99, 38, 11, 87, 85, 110, 71, 5, 27]
2021-08-18:15:34:47,422 INFO     [param_server.py:553] For epoch: 31, median_reward: 405.0535608268193, dev: 810.1071216536386
2021-08-18:15:34:47,953 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.8712, Top-1 Accuracy: 547.0/1033 (0.5295), Top-5 Accuracy: 1.0
2021-08-18:15:34:47,954 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 339.3686, eval_time 0.5059, test_loss 1.8712, test_accuracy 0.5295, test_5_accuracy 1.0 

2021-08-18:15:34:47,959 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3247, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:34:47,960 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 339.3776, eval_time 0.5131, test_loss 2.3247, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:34:47,993 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9556, Top-1 Accuracy: 564.0/1033 (0.546), Top-5 Accuracy: 1.0
2021-08-18:15:34:47,995 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 339.4143, eval_time 0.5495, test_loss 1.9556, test_accuracy 0.546, test_5_accuracy 1.0 

2021-08-18:15:34:48,44 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:48,47 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:48,55 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:48,56 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:48,64 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:48,79 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:48,631 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:48,642 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:49,154 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:49,163 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:49,614 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:49,624 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:49,788 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:49,797 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:50,365 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:50,374 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:50,374 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:50,394 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:50,969 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:50,980 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:51,62 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:51,76 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:51,637 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:51,664 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:51,703 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:51,717 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:52,576 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:52,595 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:53,74 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:53,101 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:53,197 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:53,224 INFO     [learner.py:606] ====Pushing takes 0.025710344314575195 s
2021-08-18:15:34:53,263 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:53,272 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:53,273 INFO     [param_server.py:410] Lock worker 2 with localStep 31 , while globalStep is 30

2021-08-18:15:34:53,374 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:53,395 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:54,88 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:54,116 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:34:54,696 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:34:54,721 INFO     [learner.py:606] ====Pushing takes 0.02309441566467285 s
2021-08-18:15:34:54,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:54,759 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:54,760 INFO     [param_server.py:410] Lock worker 3 with localStep 31 , while globalStep is 30

2021-08-18:15:34:55,588 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:55,616 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:56,260 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:56,280 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:56,928 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:56,949 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:57,519 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:57,546 INFO     [learner.py:606] ====Pushing takes 0.02190566062927246 s
2021-08-18:15:34:57,592 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:57,600 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:57,601 INFO     [param_server.py:381] ====After aggregation in epoch: 30, virtual_clock: 786.9799174726362, top_1: : 54.7919 % (1698.0), top_5: : 100.0 % (3099.0), test loss: 2.050507958288546, test len: 3099.0
2021-08-18:15:34:57,602 INFO     [param_server.py:410] Lock worker 1 with localStep 31 , while globalStep is 31

2021-08-18:15:34:57,602 INFO     [param_server.py:441] ====Epoch 32 completes 20 clients with loss 4.132387838851596, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 82: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:57,602 INFO     [param_server.py:450] ====Start to sample for epoch 32, global virtualClock: 786.9799174726362, round_duration: 22.11768218164245
2021-08-18:15:34:57,603 INFO     [oort.py:208] Training selector: Pacer 30: lastExploitationUtil 717.5112367001603, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:57,603 INFO     [oort.py:321] scores are 26,{5: 0.10087291869414526, 6: 0.2865809052094932, 7: 0.10474543145364926, 11: 0.06850353721874324, 14: 0.00859541744632042, 16: 0.504212635354317, 17: 0.010416729042461086, 25: 0.0038252941604108126, 27: 0.08212131283095066, 35: 0.0031321599641590844, 37: 0.2010496275132585, 38: 0.11984600430544316, 50: 0.01806679366429524, 51: 0.10277145923172559, 53: 0.06838682508668922, 55: 0.5481834334282779, 58: 0.004668202485905626, 59: 0.004830736325261418, 60: 0.0020831253343202047, 65: 0.022954392673440027, 67: 0.0031485737040746267, 70: 0.006062686828807134, 71: 0.010353873803911263, 76: 0.0022359534963855995, 81: 0.02738562890839704, 84: 0.3175353808799374, 85: 0.06348171923221269, 86: 0.0020496974172412802, 87: 0.012234858816653708, 88: 0.0023876816798254316, 96: 0.004518991688816653, 97: 0.03278366701362753, 98: 0.09488184171165467, 99: 0.14804478818637265, 104: 0.004328572585128289, 105: 0.017926749105226923, 106: 0.01980815337220251, 107: 0.008445605721309873, 110: 0.04869828322502483, 111: 0.005013942913823107, 112: 0.2030365706095823, 119: 0.01441332344179424},[55, 16, 84, 6, 112, 37, 99, 38, 7, 51, 5, 98, 27, 11, 53, 85, 110, 97, 81, 65, 106, 50, 105, 119, 87, 17, 71, 14, 107, 70, 111, 59, 58, 96, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:34:57,631 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:34:57,631 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:57,632 INFO     [oort.py:398] At round 30, UCB exploited 42, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 877.7268964294008, 'duration': 7.864087706209871, 'time_stamp': 31, 'count': 29, 'status': True, 'gradient': 21.480762334238605}, [0.39946720845187567, -9.677731539727095e-06]), ({'reward': 813.8181584861233, 'duration': 13.73645665746006, 'time_stamp': 31, 'count': 28, 'status': True, 'gradient': 11.403835731503131}, [0.37038101339869084, -9.677731539727095e-06]), ({'reward': 1855.6277640683093, 'duration': 30.380154975061778, 'time_stamp': 31, 'count': 27, 'status': True, 'gradient': 8.145578361949351}, [0.8445302200868271, -9.677731539727095e-06])]
2021-08-18:15:34:57,632 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 81, 99, 38, 11, 87, 85, 110, 5, 27, 65, 106]
2021-08-18:15:34:57,946 INFO     [param_server.py:553] For epoch: 32, median_reward: 416.9577772621805, dev: 833.915554524361
2021-08-18:15:34:58,664 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3747, Top-1 Accuracy: 540.0/1033 (0.5227), Top-5 Accuracy: 1.0
2021-08-18:15:34:58,665 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 350.0793, eval_time 0.6653, test_loss 2.3747, test_accuracy 0.5227, test_5_accuracy 1.0 

2021-08-18:15:34:58,699 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3677, Top-1 Accuracy: 545.0/1033 (0.5276), Top-5 Accuracy: 1.0
2021-08-18:15:34:58,700 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 350.1171, eval_time 0.704, test_loss 2.3677, test_accuracy 0.5276, test_5_accuracy 1.0 

2021-08-18:15:34:58,709 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3271, Top-1 Accuracy: 569.0/1033 (0.5508), Top-5 Accuracy: 1.0
2021-08-18:15:34:58,710 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 350.1296, eval_time 0.7183, test_loss 2.3271, test_accuracy 0.5508, test_5_accuracy 1.0 

2021-08-18:15:34:58,739 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:34:58,755 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:58,767 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:34:58,776 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:34:58,790 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:58,799 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:59,818 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:59,827 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:00,886 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:00,899 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:01,335 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:01,344 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:01,362 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:01,372 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:01,451 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:01,460 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:03,206 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:03,220 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:03,629 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:03,643 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:03,735 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:03,749 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:04,326 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:04,341 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:04,995 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:05,7 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:06,345 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:06,372 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:06,455 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:06,464 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:07,37 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:07,49 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:35:07,154 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:07,181 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:07,717 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:35:07,744 INFO     [learner.py:606] ====Pushing takes 0.024092674255371094 s
2021-08-18:15:35:07,787 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:07,795 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:07,796 INFO     [param_server.py:410] Lock worker 2 with localStep 32 , while globalStep is 31

2021-08-18:15:35:07,901 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:07,921 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:07,922 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:07,948 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:35:08,563 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:35:08,585 INFO     [learner.py:606] ====Pushing takes 0.020779132843017578 s
2021-08-18:15:35:08,618 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:08,624 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:35:08,625 INFO     [param_server.py:410] Lock worker 1 with localStep 32 , while globalStep is 31

2021-08-18:15:35:08,677 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:08,697 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:09,287 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:09,314 INFO     [learner.py:606] ====Pushing takes 0.02646780014038086 s
2021-08-18:15:35:09,354 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:09,361 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:09,362 INFO     [param_server.py:381] ====After aggregation in epoch: 31, virtual_clock: 819.9590505389675, top_1: : 53.3721 % (1654.0), top_5: : 100.0 % (3099.0), test loss: 2.356482245303966, test len: 3099.0
2021-08-18:15:35:09,363 INFO     [param_server.py:410] Lock worker 3 with localStep 32 , while globalStep is 32

2021-08-18:15:35:09,363 INFO     [param_server.py:441] ====Epoch 33 completes 20 clients with loss 4.8689637736688525, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 81: 0, 84: 0, 85: 0, 87: 0, 98: 0, 99: 0, 106: 0, 110: 0} 
==========
2021-08-18:15:35:09,363 INFO     [param_server.py:450] ====Start to sample for epoch 33, global virtualClock: 819.9590505389675, round_duration: 32.97913306633127
2021-08-18:15:35:09,364 INFO     [oort.py:208] Training selector: Pacer 31: lastExploitationUtil 401.01726451673875, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:09,365 INFO     [oort.py:321] scores are 26,{5: 0.02161056407989512, 6: 0.1298407736708154, 7: 0.2226519310812523, 11: 0.017478555709872824, 14: 0.006811105340587166, 16: 1.1035915537774006, 17: 0.008140350995723708, 25: 0.004373832504839028, 27: 0.00896164870494741, 35: 0.0033616819136158983, 37: 0.2508664504073596, 38: 0.1754004017874602, 50: 0.014118639468799446, 51: 0.4189935631358306, 53: 0.3390674494592583, 55: 0.10744549519269936, 58: 0.005373323685249348, 59: 0.005560407885495979, 60: 0.002397776602887489, 65: 0.0055133343512830234, 67: 0.0035110656086341403, 70: 0.0069320621124855705, 71: 0.010403663356498767, 76: 0.0025374351664342303, 81: 0.05258969946446898, 84: 0.04676989011688158, 85: 0.011315970421974466, 86: 0.002359299476170932, 87: 0.012100080057927573, 88: 0.0027096214077946897, 96: 0.0045407225135507216, 97: 0.03294131661837446, 98: 0.15094029938058484, 99: 0.09022589665256942, 104: 0.004982393472694158, 105: 0.01400919898501509, 106: 0.004757650266600598, 107: 0.008168635898161108, 110: 0.03436777963761836, 111: 0.005038053851315581, 119: 0.017476413902281454},[16, 51, 53, 37, 7, 38, 98, 6, 55, 99, 81, 84, 110, 97, 5, 11, 119, 50, 105, 87, 85, 71, 27, 107, 17, 70, 14, 59, 65, 58, 111, 104, 106, 96, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:35:09,366 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:35:09,367 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:09,367 INFO     [oort.py:398] At round 31, UCB exploited 41, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 714.1460360434345, 'duration': 11.058674649423494, 'time_stamp': 32, 'count': 29, 'status': True, 'gradient': 19.861771591662638}, [0.4157448277621366, -9.375292977905568e-06]), ({'reward': 406.1326984203971, 'duration': 13.411352670399307, 'time_stamp': 32, 'count': 29, 'status': True, 'gradient': 17.724017372849133}, [0.23643032220258656, -9.375292977905568e-06]), ({'reward': 1430.9805073523776, 'duration': 20.64883858350112, 'time_stamp': 32, 'count': 26, 'status': True, 'gradient': 11.407009744933099}, [0.8330605835756625, -9.375292977905568e-06])]
2021-08-18:15:35:09,368 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 110, 71, 5, 50, 105]
2021-08-18:15:35:09,689 INFO     [param_server.py:553] For epoch: 33, median_reward: 340.82028932219896, dev: 681.6405786443979
2021-08-18:15:35:10,458 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1636, Top-1 Accuracy: 537.0/1033 (0.5198), Top-5 Accuracy: 1.0
2021-08-18:15:35:10,459 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 361.8731, eval_time 0.7144, test_loss 2.1636, test_accuracy 0.5198, test_5_accuracy 1.0 

2021-08-18:15:35:10,501 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3425, Top-1 Accuracy: 555.0/1033 (0.5373), Top-5 Accuracy: 1.0
2021-08-18:15:35:10,502 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 361.919, eval_time 0.7573, test_loss 2.3425, test_accuracy 0.5373, test_5_accuracy 1.0 

2021-08-18:15:35:10,545 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4203, Top-1 Accuracy: 530.0/1033 (0.5131), Top-5 Accuracy: 1.0
2021-08-18:15:35:10,545 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 361.9649, eval_time 0.8007, test_loss 2.4203, test_accuracy 0.5131, test_5_accuracy 1.0 

2021-08-18:15:35:10,580 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:35:10,585 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:35:10,588 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:10,605 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:10,615 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:35:10,633 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:11,266 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:11,287 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:12,249 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:12,263 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:12,691 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:12,706 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:12,879 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:12,900 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:13,372 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:13,383 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:14,500 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:14,513 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:14,531 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:14,542 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:14,872 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:14,882 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:15,63 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:15,72 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:15,650 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:15,659 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:16,270 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:16,289 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:17,796 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:17,799 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:17,808 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:17,817 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:18,329 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:18,338 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:18,346 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:18,355 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:35:18,472 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:18,492 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:19,0 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:19,14 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:35:19,408 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:35:19,446 INFO     [learner.py:606] ====Pushing takes 0.03650331497192383 s
2021-08-18:15:35:19,493 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:19,505 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:35:19,506 INFO     [param_server.py:410] Lock worker 2 with localStep 33 , while globalStep is 32

2021-08-18:15:35:19,584 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:35:19,615 INFO     [learner.py:606] ====Pushing takes 0.03004288673400879 s
2021-08-18:15:35:19,650 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:19,658 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:35:19,659 INFO     [param_server.py:410] Lock worker 3 with localStep 33 , while globalStep is 32

2021-08-18:15:35:19,837 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:19,856 INFO     [learner.py:606] ====Pushing takes 0.01770305633544922 s
2021-08-18:15:35:19,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:19,889 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:19,890 INFO     [param_server.py:381] ====After aggregation in epoch: 32, virtual_clock: 850.8272383532591, top_1: : 52.3395 % (1622.0), top_5: : 100.0 % (3099.0), test loss: 2.30880457273236, test len: 3099.0
2021-08-18:15:35:19,891 INFO     [param_server.py:410] Lock worker 1 with localStep 33 , while globalStep is 33

2021-08-18:15:35:19,894 INFO     [param_server.py:441] ====Epoch 34 completes 20 clients with loss 4.914537846619416, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:35:19,895 INFO     [param_server.py:450] ====Start to sample for epoch 34, global virtualClock: 850.8272383532591, round_duration: 30.86818781429151
2021-08-18:15:35:19,896 INFO     [oort.py:208] Training selector: Pacer 32: lastExploitationUtil 509.90432068433404, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:19,896 INFO     [oort.py:321] scores are 26,{5: 0.07198845576143979, 6: 0.05774329981222454, 7: 0.8156899335530129, 11: 0.1860167465615423, 14: 0.009109655322957013, 16: 0.2389439443539296, 17: 0.010887482731626662, 25: 0.004811156891006976, 27: 0.009002980637961136, 35: 0.00354593767502145, 37: 0.19290092253999516, 38: 0.01919079857250035, 50: 0.04015830979825511, 51: 0.05654568430860832, 53: 0.10876129470314627, 55: 0.12898296222377298, 58: 0.005935278118185947, 59: 0.003898596679412466, 60: 0.0026485415428227524, 65: 0.005538762347134243, 67: 0.003800577799655966, 70: 0.008032620733766165, 71: 0.05361996464036676, 76: 0.00277790323007657, 81: 0.15242437716537305, 84: 0.17545215759246224, 85: 0.011368160699329137, 86: 0.0026060403905325295, 87: 0.08419194697300805, 88: 0.002966407244830226, 96: 0.00456166470794672, 97: 0.07289544152116093, 98: 0.33373345891709977, 99: 0.023244154248107246, 104: 0.005503463533353445, 105: 0.02084265369319409, 106: 0.004779592979219238, 107: 0.010925312966098702, 110: 0.021941552808461204, 111: 0.005061289781692466, 119: 0.015064691558954964},[7, 98, 16, 37, 11, 84, 81, 55, 53, 87, 97, 5, 6, 51, 71, 50, 99, 110, 105, 38, 119, 85, 107, 17, 14, 27, 70, 58, 65, 104, 111, 25, 106, 96, 59, 67, 35, 88, 76, 60, 86]
2021-08-18:15:35:19,897 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:19,898 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:19,898 INFO     [oort.py:398] At round 32, UCB exploited 41, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 190.94139491650344, 'duration': 15.972045438625893, 'time_stamp': 33, 'count': 30, 'status': True, 'gradient': 20.587306043105514}, [0.13042413901803931, -9.091184581350956e-06]), ({'reward': 0.01, 'duration': 20.64883858350112, 'time_stamp': 33, 'count': 27, 'status': True, 'gradient': 11.413687444078262}, [6.830942194924403e-09, -9.091184581350956e-06]), ({'reward': 950.5641025488953, 'duration': 13.411352670399307, 'time_stamp': 33, 'count': 30, 'status': True, 'gradient': 17.73360045354694}, [0.6493180195969434, -9.091184581350956e-06])]
2021-08-18:15:35:19,899 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 50]
2021-08-18:15:35:20,249 INFO     [param_server.py:553] For epoch: 34, median_reward: 353.17599136291955, dev: 706.3519827258391
2021-08-18:15:35:20,838 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3147, Top-1 Accuracy: 502.0/1033 (0.486), Top-5 Accuracy: 1.0
2021-08-18:15:35:20,839 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 372.256, eval_time 0.5441, test_loss 3.3147, test_accuracy 0.486, test_5_accuracy 1.0 

2021-08-18:15:35:20,896 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:20,909 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:20,917 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2347, Top-1 Accuracy: 513.0/1033 (0.4966), Top-5 Accuracy: 1.0
2021-08-18:15:35:20,918 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 372.3318, eval_time 0.6206, test_loss 3.2347, test_accuracy 0.4966, test_5_accuracy 1.0 

2021-08-18:15:35:20,955 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.99, Top-1 Accuracy: 523.0/1033 (0.5063), Top-5 Accuracy: 1.0
2021-08-18:15:35:20,956 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 372.3754, eval_time 0.661, test_loss 2.99, test_accuracy 0.5063, test_5_accuracy 1.0 

2021-08-18:15:35:20,981 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:20,999 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:21,23 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:21,45 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:22,27 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:22,37 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:23,271 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:23,289 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:23,898 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:23,912 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:23,923 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:23,937 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:24,261 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:24,271 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:25,945 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:25,955 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:26,77 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:26,90 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:26,223 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:26,238 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:27,388 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:27,400 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:28,31 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:28,40 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:28,747 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:28,759 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:28,766 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:28,777 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:29,501 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:29,522 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:30,672 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:30,683 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:31,15 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:31,42 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:31,74 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:31,92 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:31,216 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:31,243 INFO     [learner.py:606] ====Pushing takes 0.02565455436706543 s
2021-08-18:15:35:31,282 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:31,289 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:35:31,290 INFO     [param_server.py:410] Lock worker 3 with localStep 34 , while globalStep is 33

2021-08-18:15:35:31,679 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:31,693 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:35:31,828 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:31,851 INFO     [learner.py:606] ====Pushing takes 0.021805763244628906 s
2021-08-18:15:35:31,888 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:31,894 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:35:31,895 INFO     [param_server.py:410] Lock worker 1 with localStep 34 , while globalStep is 33

2021-08-18:15:35:32,230 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:35:32,262 INFO     [learner.py:606] ====Pushing takes 0.03015279769897461 s
2021-08-18:15:35:32,298 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:32,309 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:32,310 INFO     [param_server.py:381] ====After aggregation in epoch: 33, virtual_clock: 889.2232599120447, top_1: : 49.6289 % (1538.0), top_5: : 100.0 % (3099.0), test loss: 3.1797866379773176, test len: 3099.0
2021-08-18:15:35:32,311 INFO     [param_server.py:410] Lock worker 2 with localStep 34 , while globalStep is 34

2021-08-18:15:35:32,311 INFO     [param_server.py:441] ====Epoch 35 completes 20 clients with loss 7.74847928237786, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:32,312 INFO     [param_server.py:450] ====Start to sample for epoch 35, global virtualClock: 889.2232599120447, round_duration: 38.39602155878561
2021-08-18:15:35:32,313 INFO     [oort.py:208] Training selector: Pacer 33: lastExploitationUtil 570.1384707365992, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:32,314 INFO     [oort.py:321] scores are 26,{5: 0.04903404240526816, 6: 0.25832269945723974, 7: 0.46210887761710684, 11: 0.07331665969920367, 14: 0.008947899705744031, 16: 1.1014092982374843, 17: 0.011626951487307132, 25: 0.004749185235622843, 27: 0.00904286023530059, 35: 0.003527954038269647, 37: 0.04291132054051273, 38: 0.0512967546846907, 50: 0.02024059025965221, 51: 0.1414284857146779, 53: 0.17668099490655884, 55: 0.11199829450883392, 58: 0.004023305789259716, 59: 0.0038293712378577633, 60: 0.0026124168828966336, 65: 0.005563296845323797, 67: 0.003762845529131847, 70: 0.008578189641223229, 71: 0.010024104449537847, 76: 0.002744535928116286, 81: 0.03647772959639469, 84: 0.28251170963997063, 85: 0.08307195782440507, 86: 0.002570495423108162, 87: 0.1251470202023133, 88: 0.0029307756917927585, 93: 0.15043614203241756, 96: 0.00458187106060957, 97: 0.26631436785515256, 98: 0.15899981353110954, 99: 0.09301862106809446, 104: 0.005428399296926062, 105: 0.020009490630117695, 106: 0.004800764661256856, 107: 0.011667351119784359, 110: 0.0813925107077473, 111: 0.0050837092734766125, 119: 0.016087872857736794},[16, 7, 84, 97, 6, 53, 98, 93, 51, 87, 55, 99, 85, 110, 11, 38, 5, 37, 81, 50, 105, 119, 107, 17, 71, 27, 14, 70, 65, 104, 111, 106, 25, 96, 58, 59, 67, 35, 88, 76, 60, 86]
2021-08-18:15:35:32,315 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:32,316 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:32,316 INFO     [oort.py:398] At round 33, UCB exploited 42, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1455.3656539362137, 'duration': 26.145070720211294, 'time_stamp': 34, 'count': 29, 'status': True, 'gradient': 22.837594716047402}, [0.9700030345625376, -8.823788934968683e-06]), ({'reward': 541.1899215311311, 'duration': 5.8943907365129, 'time_stamp': 34, 'count': 31, 'status': True, 'gradient': 20.793261043662}, [0.36069957937962244, -8.823788934968683e-06]), ({'reward': 258.85163252009283, 'duration': 20.64883858350112, 'time_stamp': 34, 'count': 28, 'status': True, 'gradient': 14.680627879806261}, [0.17251946375538754, -8.823788934968683e-06])]
2021-08-18:15:35:32,317 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 93, 11, 87, 85, 110, 71, 5]
2021-08-18:15:35:32,659 INFO     [param_server.py:553] For epoch: 35, median_reward: 369.2731010668189, dev: 738.5462021336378
2021-08-18:15:35:33,246 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8618, Top-1 Accuracy: 514.0/1033 (0.4976), Top-5 Accuracy: 1.0
2021-08-18:15:35:33,247 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 384.664, eval_time 0.5434, test_loss 2.8618, test_accuracy 0.4976, test_5_accuracy 1.0 

2021-08-18:15:35:33,265 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5124, Top-1 Accuracy: 506.0/1033 (0.4898), Top-5 Accuracy: 1.0
2021-08-18:15:35:33,265 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 384.6795, eval_time 0.5604, test_loss 2.5124, test_accuracy 0.4898, test_5_accuracy 1.0 

2021-08-18:15:35:33,304 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5431, Top-1 Accuracy: 514.0/1033 (0.4976), Top-5 Accuracy: 1.0
2021-08-18:15:35:33,305 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 384.725, eval_time 0.6019, test_loss 2.5431, test_accuracy 0.4976, test_5_accuracy 1.0 

2021-08-18:15:35:33,318 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:33,331 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:33,331 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:33,349 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:33,368 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:33,396 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:33,975 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:33,989 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:34,592 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:34,613 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:35,125 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:35,152 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:35,272 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:35,286 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:36,299 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:36,320 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:36,462 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:36,482 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:36,613 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:36,625 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:37,272 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:37,286 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:37,510 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:37,520 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:37,682 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:37,691 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:37,901 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:37,913 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:38,562 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:38,577 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:39,156 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:39,186 INFO     [learner.py:606] ====Pushing takes 0.029346942901611328 s
2021-08-18:15:35:39,231 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:39,240 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:39,241 INFO     [param_server.py:410] Lock worker 2 with localStep 35 , while globalStep is 34

2021-08-18:15:35:39,897 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:39,906 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:39,969 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:39,979 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:35:40,559 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:40,573 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:41,16 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:35:41,25 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:41,279 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:41,300 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:41,468 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:41,495 INFO     [learner.py:606] ====Pushing takes 0.02562236785888672 s
2021-08-18:15:35:41,538 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:41,546 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:35:41,547 INFO     [param_server.py:410] Lock worker 3 with localStep 35 , while globalStep is 34

2021-08-18:15:35:41,925 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:41,946 INFO     [learner.py:606] ====Pushing takes 0.019061565399169922 s
2021-08-18:15:35:41,979 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:41,985 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:41,986 INFO     [param_server.py:381] ====After aggregation in epoch: 34, virtual_clock: 913.0679387277135, top_1: : 49.4998 % (1534.0), top_5: : 100.0 % (3099.0), test loss: 2.639067221570898, test len: 3099.0
2021-08-18:15:35:41,986 INFO     [param_server.py:410] Lock worker 1 with localStep 35 , while globalStep is 35

2021-08-18:15:35:41,987 INFO     [param_server.py:441] ====Epoch 36 completes 20 clients with loss 4.800639672420086, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:41,987 INFO     [param_server.py:450] ====Start to sample for epoch 36, global virtualClock: 913.0679387277135, round_duration: 23.844678815668754
2021-08-18:15:35:41,988 INFO     [oort.py:208] Training selector: Pacer 34: lastExploitationUtil 468.420873674762, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:41,989 INFO     [oort.py:321] scores are 26,{3: 0.790320345983295, 5: 0.02933302131407944, 6: 0.10580115956479098, 7: 0.10037587777541565, 11: 0.01693598762694089, 14: 0.007000914283449017, 16: 0.43326403600235414, 17: 0.008367202782586475, 25: 0.00415783173394652, 27: 0.02997010872975295, 35: 0.0032955770725141705, 38: 0.08402645318892503, 50: 0.014512091617638096, 51: 0.6071552179585364, 53: 0.2265000290843969, 55: 0.1936697137342751, 58: 0.003354139051744958, 59: 0.003210515920358737, 60: 0.00227211333211323, 65: 0.0055869958313774165, 67: 0.0033781632977396676, 70: 0.007151442713032013, 71: 0.03434429173733296, 76: 0.002420835730683837, 81: 0.02581646446232932, 84: 0.08524793504132845, 85: 0.05235086850330714, 86: 0.002235652724194703, 87: 0.04704898147807309, 88: 0.002585109723151323, 96: 0.004601389329801635, 97: 0.17774190906934048, 98: 0.044558206728151716, 99: 0.19371001798502321, 104: 0.004721274960106669, 105: 0.016681459835135127, 106: 0.004821215350464546, 107: 0.008396275916472684, 110: 0.03960766134202576, 111: 0.005105365315601597, 119: 0.01157745387413922},[3, 51, 16, 53, 99, 55, 97, 6, 7, 84, 38, 85, 87, 98, 110, 71, 27, 5, 81, 11, 105, 50, 119, 107, 17, 70, 14, 65, 111, 106, 104, 96, 25, 67, 58, 35, 59, 88, 76, 60, 86]
2021-08-18:15:35:41,990 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:41,990 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:41,991 INFO     [oort.py:398] At round 34, UCB exploited 41, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1903.6504502928747, 'duration': 12.029357192292537, 'time_stamp': 35, 'count': 31, 'status': True, 'gradient': 26.62240284046807}, [1.0, -8.571673476385045e-06]), ({'reward': 633.7093667531765, 'duration': 7.864087706209871, 'time_stamp': 35, 'count': 33, 'status': True, 'gradient': 21.520165698533333}, [0.3328881634800313, -8.571673476385045e-06]), ({'reward': 1575.5294901942648, 'duration': 19.55790138125729, 'time_stamp': 35, 'count': 32, 'status': True, 'gradient': 19.585396488618215}, [0.8276350146244903, -8.571673476385045e-06])]
2021-08-18:15:35:41,992 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 3, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27]
2021-08-18:15:35:42,344 INFO     [param_server.py:553] For epoch: 36, median_reward: 351.4393642722976, dev: 702.8787285445952
2021-08-18:15:35:43,46 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9628, Top-1 Accuracy: 543.0/1033 (0.5257), Top-5 Accuracy: 1.0
2021-08-18:15:35:43,47 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 394.4611, eval_time 0.6696, test_loss 2.9628, test_accuracy 0.5257, test_5_accuracy 1.0 

2021-08-18:15:35:43,49 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9714, Top-1 Accuracy: 547.0/1033 (0.5295), Top-5 Accuracy: 1.0
2021-08-18:15:35:43,52 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 394.469, eval_time 0.6745, test_loss 2.9714, test_accuracy 0.5295, test_5_accuracy 1.0 

2021-08-18:15:35:43,85 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7604, Top-1 Accuracy: 553.0/1033 (0.5353), Top-5 Accuracy: 1.0
2021-08-18:15:35:43,86 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 394.5056, eval_time 0.7092, test_loss 2.7604, test_accuracy 0.5353, test_5_accuracy 1.0 

2021-08-18:15:35:43,114 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:43,129 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:43,135 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:43,150 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:43,152 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:43,168 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:43,750 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:43,765 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:44,368 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:44,381 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:44,920 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:44,934 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:45,3 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:45,25 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:45,969 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:45,978 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:46,309 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:46,337 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:46,556 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:46,567 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:46,580 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:46,600 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:47,81 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:47,91 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:47,151 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:47,165 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:35:47,623 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:47,652 INFO     [learner.py:606] ====Pushing takes 0.02584671974182129 s
2021-08-18:15:35:47,683 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:35:47,697 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:47,701 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:47,710 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:47,710 INFO     [param_server.py:410] Lock worker 2 with localStep 36 , while globalStep is 35

2021-08-18:15:35:47,766 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:47,787 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:48,321 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:48,335 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:49,906 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:49,916 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:50,82 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:50,96 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:50,560 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:50,569 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:50,746 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:50,760 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:51,102 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:51,137 INFO     [learner.py:606] ====Pushing takes 0.03358006477355957 s
2021-08-18:15:35:51,196 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:51,205 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:35:51,206 INFO     [param_server.py:410] Lock worker 3 with localStep 36 , while globalStep is 35

2021-08-18:15:35:51,331 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:51,350 INFO     [learner.py:606] ====Pushing takes 0.017717599868774414 s
2021-08-18:15:35:51,371 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:51,378 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:51,379 INFO     [param_server.py:381] ====After aggregation in epoch: 35, virtual_clock: 936.4672133745471, top_1: : 53.0171 % (1643.0), top_5: : 100.0 % (3099.0), test loss: 2.898226552539402, test len: 3099.0
2021-08-18:15:35:51,380 INFO     [param_server.py:410] Lock worker 1 with localStep 36 , while globalStep is 36

2021-08-18:15:35:51,381 INFO     [param_server.py:441] ====Epoch 37 completes 20 clients with loss 10.315710805014342, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:51,381 INFO     [param_server.py:450] ====Start to sample for epoch 37, global virtualClock: 936.4672133745471, round_duration: 23.399274646833632
2021-08-18:15:35:51,382 INFO     [oort.py:208] Training selector: Pacer 35: lastExploitationUtil 309.6009353025388, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:51,382 INFO     [oort.py:321] scores are 26,{5: 0.009249156129893632, 6: 0.057075607519695266, 7: 1.0993778991399525, 11: 0.14317379174390052, 14: 0.011969693167529301, 16: 0.8487040089769594, 17: 0.010261756500830516, 25: 0.006410548033906155, 27: 0.01747623959617361, 35: 0.0042447540943109366, 38: 0.12686808576059183, 50: 0.017798009008204253, 51: 0.5406664439817265, 53: 0.06613434974318774, 55: 0.09937790939406135, 58: 0.005851290857912385, 59: 0.005524096999005542, 60: 0.0035638333169175267, 65: 0.02261289386323879, 67: 0.0048694999129175335, 70: 0.012475681753825563, 71: 0.010012845463679466, 76: 0.003659523277445343, 81: 0.026052964379458754, 84: 0.13376848814986034, 85: 0.011065146495808795, 86: 0.003506644475402188, 87: 0.07040476523977772, 88: 0.003907852600948772, 96: 0.004709410787857886, 97: 0.033735365003594184, 98: 0.3819421687427922, 99: 0.021144077706829273, 104: 0.007405368721421731, 105: 0.01766004793054087, 106: 0.004934397558666227, 107: 0.01029741255320649, 110: 0.010549131379916385, 111: 0.008167979643651893, 119: 0.01979435326929882},[7, 16, 51, 98, 11, 84, 38, 55, 87, 53, 6, 97, 81, 65, 99, 119, 50, 105, 27, 70, 14, 85, 110, 107, 17, 71, 5, 111, 104, 25, 58, 59, 106, 67, 96, 35, 88, 76, 60, 86]
2021-08-18:15:35:51,384 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:51,384 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:51,385 INFO     [oort.py:398] At round 35, UCB exploited 40, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 8.010998429338052, 'time_stamp': 36, 'count': 34, 'status': True, 'gradient': 20.712092916966206}, [1.0254108743418788e-08, -8.33356482124504e-06]), ({'reward': 840.5983933594237, 'duration': 12.029357192292537, 'time_stamp': 36, 'count': 32, 'status': True, 'gradient': 26.63429368967677}, [0.8619484896504657, -8.33356482124504e-06]), ({'reward': 726.287401484429, 'duration': 13.411352670399307, 'time_stamp': 36, 'count': 33, 'status': True, 'gradient': 14.695143823741605}, [0.7447327555250353, -8.33356482124504e-06])]
2021-08-18:15:35:51,385 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 38, 11, 87, 85, 71, 5, 27, 65, 50, 105]
2021-08-18:15:35:51,789 INFO     [param_server.py:553] For epoch: 37, median_reward: 316.9670028057509, dev: 633.9340056115018
2021-08-18:15:35:52,354 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0636, Top-1 Accuracy: 545.0/1033 (0.5276), Top-5 Accuracy: 1.0
2021-08-18:15:35:52,355 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 403.7691, eval_time 0.5396, test_loss 2.0636, test_accuracy 0.5276, test_5_accuracy 1.0 

2021-08-18:15:35:52,367 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.979, Top-1 Accuracy: 543.0/1033 (0.5257), Top-5 Accuracy: 1.0
2021-08-18:15:35:52,368 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 403.7876, eval_time 0.5665, test_loss 1.979, test_accuracy 0.5257, test_5_accuracy 1.0 

2021-08-18:15:35:52,402 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1752, Top-1 Accuracy: 562.0/1033 (0.544), Top-5 Accuracy: 1.0
2021-08-18:15:35:52,403 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 403.8203, eval_time 0.5898, test_loss 2.1752, test_accuracy 0.544, test_5_accuracy 1.0 

2021-08-18:15:35:52,426 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:52,434 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:52,438 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:52,446 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:52,472 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:52,486 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:53,521 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:53,536 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:54,766 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:54,780 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:54,975 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:54,989 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:55,385 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:55,395 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:55,633 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:55,653 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:57,191 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:57,205 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:57,446 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:57,456 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:57,676 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:57,697 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:58,550 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:58,572 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:59,228 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:59,249 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:59,709 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:59,728 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:59,938 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:59,959 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:00,403 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:00,421 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:00,622 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:00,643 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:36:01,13 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:01,23 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:01,32 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:01,50 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:01,254 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:36:01,281 INFO     [learner.py:606] ====Pushing takes 0.02562856674194336 s
2021-08-18:15:36:01,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:01,334 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 7 clients
2021-08-18:15:36:01,335 INFO     [param_server.py:410] Lock worker 3 with localStep 37 , while globalStep is 36

2021-08-18:15:36:01,644 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:01,680 INFO     [learner.py:606] ====Pushing takes 0.03465080261230469 s
2021-08-18:15:36:01,720 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:01,727 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 15 clients
2021-08-18:15:36:01,728 INFO     [param_server.py:410] Lock worker 2 with localStep 37 , while globalStep is 36

2021-08-18:15:36:02,188 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:02,202 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:02,809 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:02,829 INFO     [learner.py:606] ====Pushing takes 0.015653133392333984 s
2021-08-18:15:36:02,870 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:02,876 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:02,878 INFO     [param_server.py:381] ====After aggregation in epoch: 36, virtual_clock: 971.9097110534364, top_1: : 53.243 % (1650.0), top_5: : 100.0 % (3099.0), test loss: 2.0725978061004917, test len: 3099.0
2021-08-18:15:36:02,879 INFO     [param_server.py:410] Lock worker 1 with localStep 37 , while globalStep is 37

2021-08-18:15:36:02,880 INFO     [param_server.py:441] ====Epoch 38 completes 20 clients with loss 5.30695306560399, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 105: 0} 
==========
2021-08-18:15:36:02,880 INFO     [param_server.py:450] ====Start to sample for epoch 38, global virtualClock: 971.9097110534364, round_duration: 35.44249767888929
2021-08-18:15:36:02,881 INFO     [oort.py:208] Training selector: Pacer 36: lastExploitationUtil 512.1092235360824, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:02,882 INFO     [oort.py:321] scores are 26,{5: 0.029249881051175586, 6: 0.056521633668952395, 7: 0.1744948303963504, 11: 0.16786281722014068, 14: 0.009055172329995517, 16: 0.09841335088057016, 17: 0.010822366915055563, 25: 0.004863975883183939, 27: 0.09685660098979831, 35: 0.003625645610091113, 38: 0.018784781788654968, 50: 0.04196249058904195, 51: 0.055349355932976456, 53: 0.12107144815644952, 55: 0.09841335088057016, 58: 0.004110456356767801, 59: 0.003913404601736909, 60: 0.002674659446915655, 65: 0.005338802537966898, 67: 0.003858828720267727, 70: 0.007984579265303876, 71: 0.009915661135742286, 76: 0.002811955799520375, 79: 0.031155950425220347, 81: 0.10413610780058678, 84: 0.26291483232070223, 85: 0.09770593967725855, 86: 0.0026317391805577815, 87: 0.08819697364730068, 88: 0.003002770566492948, 96: 0.004728031476714523, 97: 0.14118573031334772, 98: 0.17056784663429467, 99: 0.021227679431911332, 104: 0.005557734508687938, 105: 0.041053268353972314, 106: 0.004953907719948236, 107: 0.010859970894600779, 110: 0.010590841668428684, 111: 0.0086142048538329, 119: 0.01497459270723384},[84, 7, 98, 11, 97, 53, 81, 16, 55, 85, 27, 87, 6, 51, 50, 105, 79, 5, 99, 38, 119, 107, 17, 110, 71, 14, 111, 70, 104, 65, 106, 25, 96, 58, 59, 67, 35, 88, 76, 60, 86]
2021-08-18:15:36:02,883 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:02,883 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:02,884 INFO     [oort.py:398] At round 36, UCB exploited 41, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 709.7836564772826, 'duration': 13.298442137908651, 'time_stamp': 37, 'count': 34, 'status': True, 'gradient': 20.621775609164448}, [0.47289850256496274, -8.1083272520879e-06]), ({'reward': 418.08562615030564, 'duration': 13.411352670399307, 'time_stamp': 37, 'count': 34, 'status': True, 'gradient': 17.764478213154987}, [0.27854984149472056, -8.1083272520879e-06]), ({'reward': 323.9990763774735, 'duration': 29.570969934622333, 'time_stamp': 37, 'count': 26, 'status': True, 'gradient': 17.967028765071017}, [0.21586311387927692, -8.1083272520879e-06])]
2021-08-18:15:36:02,884 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 79, 50]
2021-08-18:15:36:03,226 INFO     [param_server.py:553] For epoch: 38, median_reward: 355.651574284256, dev: 711.303148568512
2021-08-18:15:36:03,833 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4845, Top-1 Accuracy: 567.0/1033 (0.5489), Top-5 Accuracy: 1.0
2021-08-18:15:36:03,834 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 415.2535, eval_time 0.5839, test_loss 2.4845, test_accuracy 0.5489, test_5_accuracy 1.0 

2021-08-18:15:36:03,853 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4069, Top-1 Accuracy: 551.0/1033 (0.5334), Top-5 Accuracy: 1.0
2021-08-18:15:36:03,856 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 415.2705, eval_time 0.5911, test_loss 2.4069, test_accuracy 0.5334, test_5_accuracy 1.0 

2021-08-18:15:36:03,901 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:36:03,917 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:03,933 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:36:03,931 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5524, Top-1 Accuracy: 561.0/1033 (0.5431), Top-5 Accuracy: 1.0
2021-08-18:15:36:03,934 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 415.3516, eval_time 0.6695, test_loss 2.5524, test_accuracy 0.5431, test_5_accuracy 1.0 

2021-08-18:15:36:03,942 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:04,6 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:36:04,30 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:04,785 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:04,802 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:05,991 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:06,0 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:06,4 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:06,14 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:06,497 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:06,506 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:06,687 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:06,698 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:06,728 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:06,737 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:07,262 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:07,276 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:08,239 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:08,260 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:08,316 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:08,335 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:10,24 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:10,38 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:10,493 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:10,505 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:10,673 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:10,688 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:11,350 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:11,374 INFO     [learner.py:606] ====Pushing takes 0.023400306701660156 s
2021-08-18:15:36:11,408 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:11,415 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:36:11,416 INFO     [param_server.py:410] Lock worker 3 with localStep 38 , while globalStep is 37

2021-08-18:15:36:11,450 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:11,471 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:12,75 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:12,85 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:12,629 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:12,638 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:12,743 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:12,770 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:13,225 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:13,256 INFO     [learner.py:606] ====Pushing takes 0.029413223266601562 s
2021-08-18:15:36:13,305 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:13,313 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:36:13,314 INFO     [param_server.py:410] Lock worker 2 with localStep 38 , while globalStep is 37

2021-08-18:15:36:13,407 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:13,427 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:36:13,881 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:36:13,909 INFO     [learner.py:606] ====Pushing takes 0.02727198600769043 s
2021-08-18:15:36:13,935 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:13,941 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:13,942 INFO     [param_server.py:381] ====After aggregation in epoch: 37, virtual_clock: 1001.885714326429, top_1: : 54.1788 % (1679.0), top_5: : 100.0 % (3099.0), test loss: 2.4812469107133377, test len: 3099.0
2021-08-18:15:36:13,942 INFO     [param_server.py:410] Lock worker 1 with localStep 38 , while globalStep is 38

2021-08-18:15:36:13,943 INFO     [param_server.py:441] ====Epoch 39 completes 20 clients with loss 6.599605398516996, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:13,944 INFO     [param_server.py:450] ====Start to sample for epoch 39, global virtualClock: 1001.885714326429, round_duration: 29.976003272992685
2021-08-18:15:36:13,944 INFO     [oort.py:208] Training selector: Pacer 37: lastExploitationUtil 417.8518667394031, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:13,945 INFO     [oort.py:321] scores are 26,{5: 0.021357612580684956, 6: 0.05598577776636796, 7: 0.2027916346449011, 11: 0.06174712318546502, 14: 0.005829244036871412, 16: 0.7157826969880079, 17: 0.006966871032972747, 25: 0.003909508411347923, 27: 0.009430810196773018, 35: 0.0032458590780387753, 38: 0.018606691815899273, 50: 0.013061473104971192, 51: 0.05556054761529574, 53: 0.06487154790542879, 55: 0.09748033865959761, 58: 0.003034233047697895, 59: 0.0029177889095459587, 60: 0.0021257388914842227, 65: 0.005359173338503927, 67: 0.0032360233707620987, 70: 0.0059239216153825595, 71: 0.009821655262190667, 76: 0.0022890795015973, 79: 0.004350768768256815, 81: 0.025555496249429432, 84: 0.2601745156322742, 85: 0.01085386314027208, 86: 0.0020916271545544964, 87: 0.03216158606432913, 88: 0.002444412729720404, 96: 0.0047460718841852425, 97: 0.3501217306470061, 98: 0.05542291895285399, 99: 0.1376095281021201, 104: 0.004417120245826372, 105: 0.011989689714254853, 106: 0.004972809919014273, 107: 0.00699107849866619, 110: 0.02738041449986594, 111: 0.005545372351474516, 119: 0.009639855771056785},[16, 97, 84, 7, 99, 55, 53, 11, 6, 51, 98, 87, 110, 81, 5, 38, 50, 105, 85, 71, 119, 27, 107, 17, 70, 14, 111, 65, 106, 96, 104, 79, 25, 35, 67, 58, 59, 88, 76, 60, 86]
2021-08-18:15:36:13,946 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:36:13,946 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:13,947 INFO     [oort.py:398] At round 37, UCB exploited 41, augment_factor 1.2692307692307692, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1237.1846389537343, 'duration': 19.55790138125729, 'time_stamp': 38, 'count': 34, 'status': True, 'gradient': 19.60799753777443}, [0.549289291067595, -7.89494460380537e-06]), ({'reward': 2252.32888474701, 'duration': 15.972045438625893, 'time_stamp': 38, 'count': 35, 'status': True, 'gradient': 20.629521408025933}, [1.0, -7.89494460380537e-06]), ({'reward': 1392.6240843297146, 'duration': 7.864087706209871, 'time_stamp': 38, 'count': 36, 'status': True, 'gradient': 21.54472660210121}, [0.6183023627682789, -7.89494460380537e-06])]
2021-08-18:15:36:13,947 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 5, 27, 65, 79, 119]
2021-08-18:15:36:14,284 INFO     [param_server.py:553] For epoch: 39, median_reward: 336.059928219507, dev: 672.119856439014
2021-08-18:15:36:14,851 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4306, Top-1 Accuracy: 501.0/1033 (0.485), Top-5 Accuracy: 1.0
2021-08-18:15:36:14,853 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 426.267, eval_time 0.5354, test_loss 2.4306, test_accuracy 0.485, test_5_accuracy 1.0 

2021-08-18:15:36:14,868 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1426, Top-1 Accuracy: 531.0/1033 (0.514), Top-5 Accuracy: 1.0
2021-08-18:15:36:14,869 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 426.2884, eval_time 0.5512, test_loss 2.1426, test_accuracy 0.514, test_5_accuracy 1.0 

2021-08-18:15:36:14,898 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3581, Top-1 Accuracy: 526.0/1033 (0.5092), Top-5 Accuracy: 1.0
2021-08-18:15:36:14,899 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 426.316, eval_time 0.5813, test_loss 2.3581, test_accuracy 0.5092, test_5_accuracy 1.0 

2021-08-18:15:36:14,922 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:14,930 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:14,944 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:14,958 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:14,985 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:15,1 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:16,92 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:16,102 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:17,69 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:17,79 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:17,419 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:17,428 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:17,618 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:17,626 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:17,632 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:17,636 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:18,3 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:18,12 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:18,640 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:18,650 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:19,185 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:19,205 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:19,422 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:19,440 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:21,33 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:21,45 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:21,470 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:21,491 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:21,602 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:21,614 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:22,112 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:22,133 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:22,173 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:22,179 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:22,187 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:22,191 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:36:22,648 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:36:22,684 INFO     [learner.py:606] ====Pushing takes 0.029874086380004883 s
2021-08-18:15:36:22,699 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:22,741 INFO     [learner.py:606] ====Pushing takes 0.03804302215576172 s
2021-08-18:15:36:22,742 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:22,753 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:22,753 INFO     [param_server.py:410] Lock worker 2 with localStep 39 , while globalStep is 38

2021-08-18:15:36:22,774 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:22,780 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:36:22,781 INFO     [param_server.py:410] Lock worker 3 with localStep 39 , while globalStep is 38

2021-08-18:15:36:23,156 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:23,177 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:23,710 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:23,730 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:36:23,851 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:36:23,871 INFO     [learner.py:606] ====Pushing takes 0.020035743713378906 s
2021-08-18:15:36:23,897 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:23,904 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:23,905 INFO     [param_server.py:381] ====After aggregation in epoch: 38, virtual_clock: 1033.841712305667, top_1: : 50.2743 % (1558.0), top_5: : 100.0 % (3099.0), test loss: 2.3104331051861795, test len: 3099.0
2021-08-18:15:36:23,906 INFO     [param_server.py:410] Lock worker 1 with localStep 39 , while globalStep is 39

2021-08-18:15:36:23,906 INFO     [param_server.py:441] ====Epoch 40 completes 20 clients with loss 3.783010047408487, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 53: 0, 55: 0, 65: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:36:23,906 INFO     [param_server.py:450] ====Start to sample for epoch 40, global virtualClock: 1033.841712305667, round_duration: 31.95599797923794
2021-08-18:15:36:23,907 INFO     [oort.py:208] Training selector: Pacer 38: lastExploitationUtil 314.50512691829385, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:23,908 INFO     [oort.py:321] scores are 26,{5: 0.016498331912499067, 6: 0.055467048103446666, 7: 0.09657714600546745, 11: 0.06085287083623836, 14: 0.005783382841913807, 16: 0.14189047001341773, 17: 0.006912059632271956, 25: 0.004530074981816362, 27: 0.09669468700194978, 35: 0.0035030329131260788, 38: 0.018434293693397167, 50: 0.01591688266875123, 51: 0.05576534075004972, 53: 0.26790974040548643, 55: 0.09657714600546745, 58: 0.003725631289165339, 59: 0.003558074258413813, 60: 0.0024818872421785106, 65: 0.005239190695064382, 67: 0.003645106158718358, 70: 0.005099613462892765, 71: 0.009857857347299576, 76: 0.0026299317429091962, 79: 0.004310457230101098, 81: 0.025318714793778806, 84: 0.04444431581634923, 85: 0.034589209478748995, 86: 0.0024420603918378627, 87: 0.011498418708140832, 88: 0.0028083946521635264, 96: 0.004435142413868765, 97: 0.18211017137860372, 98: 0.28666395295763686, 99: 0.020548175065206477, 104: 0.002217786201069624, 105: 0.014513233547368788, 107: 0.008462533845100146, 110: 0.0435658956726905, 111: 0.006712541021673397, 119: 0.018804951622699014},[98, 53, 97, 16, 27, 7, 55, 11, 51, 6, 84, 110, 85, 81, 99, 119, 38, 5, 50, 105, 87, 71, 107, 17, 111, 14, 65, 70, 25, 96, 79, 58, 67, 59, 35, 88, 76, 60, 86, 104]
2021-08-18:15:36:23,909 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:36:23,909 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:23,910 INFO     [oort.py:398] At round 38, UCB exploited 40, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 77.37895068051182, 'duration': 7.864087706209871, 'time_stamp': 39, 'count': 37, 'status': True, 'gradient': 21.552542071892294}, [0.04531332986473438, -7.692504936024006e-06]), ({'reward': 916.8340408216004, 'duration': 13.411352670399307, 'time_stamp': 39, 'count': 36, 'status': True, 'gradient': 17.77861349568953}, [0.5369640522166873, -7.692504936024006e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 39, 'count': 36, 'status': True, 'gradient': 20.84217903190229}, [5.8567840987098e-09, -7.692504936024006e-06])]
2021-08-18:15:36:23,911 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 50]
2021-08-18:15:36:24,221 INFO     [param_server.py:553] For epoch: 40, median_reward: 315.68588449436623, dev: 631.3717689887325
2021-08-18:15:36:24,842 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2353, Top-1 Accuracy: 561.0/1033 (0.5431), Top-5 Accuracy: 1.0
2021-08-18:15:36:24,843 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 436.2631, eval_time 0.5768, test_loss 2.2353, test_accuracy 0.5431, test_5_accuracy 1.0 

2021-08-18:15:36:24,911 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:24,928 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:24,962 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4071, Top-1 Accuracy: 538.0/1033 (0.5208), Top-5 Accuracy: 1.0
2021-08-18:15:36:24,964 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 436.3807, eval_time 0.6947, test_loss 2.4071, test_accuracy 0.5208, test_5_accuracy 1.0 

2021-08-18:15:36:25,35 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5871, Top-1 Accuracy: 550.0/1033 (0.5324), Top-5 Accuracy: 1.0
2021-08-18:15:36:25,36 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 436.4504, eval_time 0.7674, test_loss 2.5871, test_accuracy 0.5324, test_5_accuracy 1.0 

2021-08-18:15:36:25,36 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:25,46 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:25,104 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:25,122 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:25,513 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:25,523 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:26,62 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:26,76 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:26,691 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:26,702 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:26,765 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:26,779 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:27,261 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:27,282 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:27,291 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:27,305 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:27,910 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:27,920 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:27,992 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:28,1 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:28,298 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:28,317 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:28,483 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:28,493 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:28,520 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:28,532 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:28,935 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:28,944 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:29,54 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:29,63 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:29,501 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:29,531 INFO     [learner.py:606] ====Pushing takes 0.028933286666870117 s
2021-08-18:15:36:29,585 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:29,593 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:29,594 INFO     [param_server.py:410] Lock worker 2 with localStep 40 , while globalStep is 39

2021-08-18:15:36:29,970 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:29,984 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:30,587 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:30,614 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:30,790 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:30,799 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:31,104 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:31,123 INFO     [learner.py:606] ====Pushing takes 0.017223119735717773 s
2021-08-18:15:36:31,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:31,170 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:31,171 INFO     [param_server.py:410] Lock worker 1 with localStep 40 , while globalStep is 39

2021-08-18:15:36:31,327 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:31,336 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:31,906 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:31,938 INFO     [learner.py:606] ====Pushing takes 0.03065657615661621 s
2021-08-18:15:36:31,975 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:31,987 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:31,988 INFO     [param_server.py:381] ====After aggregation in epoch: 39, virtual_clock: 1054.8699437107002, top_1: : 53.2107 % (1649.0), top_5: : 100.0 % (3099.0), test loss: 2.409815691135548, test len: 3099.0
2021-08-18:15:36:31,989 INFO     [param_server.py:410] Lock worker 3 with localStep 40 , while globalStep is 40

2021-08-18:15:36:31,990 INFO     [param_server.py:441] ====Epoch 41 completes 20 clients with loss 4.443268959978476, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:31,990 INFO     [param_server.py:450] ====Start to sample for epoch 41, global virtualClock: 1054.8699437107002, round_duration: 21.0282314050332
2021-08-18:15:36:31,991 INFO     [oort.py:208] Training selector: Pacer 39: lastExploitationUtil 423.99686382285154, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:31,992 INFO     [oort.py:321] scores are 26,{5: 0.008907052976159402, 6: 0.054964523539754985, 7: 0.09570216906296869, 11: 0.03307819200195991, 14: 0.0055434693992579085, 16: 1.0957021635874766, 17: 0.006625325022520188, 25: 0.004372163616439629, 27: 0.051215566228141135, 35: 0.0034451063595690957, 38: 0.11305020417200981, 50: 0.009236102900656646, 51: 0.07108714735058692, 53: 0.21181078265155448, 55: 0.3781552360659355, 58: 0.0035435872153486052, 59: 0.003389986743659951, 60: 0.002390715315494688, 65: 0.005257863555964357, 67: 0.00354405512562218, 70: 0.005954829001602504, 71: 0.009642495351423589, 76: 0.0025438525946120403, 79: 0.004325820016637727, 81: 0.09447745753279642, 84: 0.20782399284506306, 85: 0.01065587440010778, 86: 0.0023523515012733275, 87: 0.0477438588243833, 88: 0.0027164743122564876, 96: 0.005178924807638586, 97: 0.18877849485682144, 98: 0.13343338185056852, 99: 0.020362011152354198, 104: 0.0021257852498759297, 105: 0.013890237928399008, 107: 0.008099270793232789, 110: 0.04065934457225154, 111: 0.006424398228752131, 119: 0.011167919558104325},[16, 55, 53, 84, 97, 98, 38, 7, 81, 51, 6, 27, 87, 110, 11, 99, 105, 119, 85, 71, 50, 5, 107, 17, 111, 70, 14, 65, 96, 25, 79, 67, 58, 35, 59, 88, 76, 60, 86, 104]
2021-08-18:15:36:31,993 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:31,993 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:31,994 INFO     [oort.py:398] At round 39, UCB exploited 40, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 515.8596413413268, 'duration': 8.010998429338052, 'time_stamp': 40, 'count': 38, 'status': True, 'gradient': 20.747239556362317}, [0.28245307247845897, -7.500187504687623e-06]), ({'reward': 363.7984020045652, 'duration': 13.411352670399307, 'time_stamp': 40, 'count': 37, 'status': True, 'gradient': 13.082439045996427}, [0.1991920600034667, -7.500187504687623e-06]), ({'reward': 906.9003906260067, 'duration': 20.64883858350112, 'time_stamp': 40, 'count': 34, 'status': True, 'gradient': 8.176501207962097}, [0.49656712841033696, -7.500187504687623e-06])]
2021-08-18:15:36:31,995 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:36:32,329 INFO     [param_server.py:541] Handle Wight 0.04128122329711914 | Send 0.33891820907592773
2021-08-18:15:36:32,330 INFO     [param_server.py:553] For epoch: 41, median_reward: 335.53430468853395, dev: 671.0686093770679
2021-08-18:15:36:32,909 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8694, Top-1 Accuracy: 586.0/1033 (0.5673), Top-5 Accuracy: 1.0
2021-08-18:15:36:32,910 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 444.3297, eval_time 0.5468, test_loss 1.8694, test_accuracy 0.5673, test_5_accuracy 1.0 

2021-08-18:15:36:32,980 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:32,993 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:33,7 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0596, Top-1 Accuracy: 582.0/1033 (0.5634), Top-5 Accuracy: 1.0
2021-08-18:15:36:33,8 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 444.422, eval_time 0.6414, test_loss 2.0596, test_accuracy 0.5634, test_5_accuracy 1.0 

2021-08-18:15:36:33,11 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.987, Top-1 Accuracy: 586.0/1033 (0.5673), Top-5 Accuracy: 1.0
2021-08-18:15:36:33,13 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 444.4298, eval_time 0.6472, test_loss 1.987, test_accuracy 0.5673, test_5_accuracy 1.0 

2021-08-18:15:36:33,77 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:33,84 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:33,85 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:33,93 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:33,698 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:33,708 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:34,876 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:34,889 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:35,317 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:35,331 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:35,439 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:35,448 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:35,829 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:35,849 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:37,145 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:37,158 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:37,339 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:37,360 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:37,495 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:37,516 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:38,170 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:38,191 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:38,978 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:38,999 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:39,249 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:39,264 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:40,312 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:40,332 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:41,295 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:41,309 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:41,520 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:41,538 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:41,663 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:41,672 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:41,813 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:41,832 INFO     [learner.py:606] ====Pushing takes 0.017605304718017578 s
2021-08-18:15:36:41,867 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:41,876 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:36:41,876 INFO     [param_server.py:410] Lock worker 1 with localStep 41 , while globalStep is 40

2021-08-18:15:36:42,193 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:42,208 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:42,315 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:42,329 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:42,754 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:42,786 INFO     [learner.py:606] ====Pushing takes 0.029806137084960938 s
2021-08-18:15:36:42,820 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:42,828 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:42,829 INFO     [param_server.py:410] Lock worker 2 with localStep 41 , while globalStep is 40

2021-08-18:15:36:42,964 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:42,993 INFO     [learner.py:606] ====Pushing takes 0.02808976173400879 s
2021-08-18:15:36:43,23 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:43,30 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:43,30 INFO     [param_server.py:381] ====After aggregation in epoch: 40, virtual_clock: 1085.419402180119, top_1: : 56.5989 % (1754.0), top_5: : 100.0 % (3099.0), test loss: 1.9719905875347277, test len: 3099.0
2021-08-18:15:36:43,31 INFO     [param_server.py:410] Lock worker 3 with localStep 41 , while globalStep is 41

2021-08-18:15:36:43,32 INFO     [param_server.py:441] ====Epoch 42 completes 20 clients with loss 3.805760344331449, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:43,32 INFO     [param_server.py:450] ====Start to sample for epoch 42, global virtualClock: 1085.419402180119, round_duration: 30.54945846941879
2021-08-18:15:36:43,33 INFO     [oort.py:208] Training selector: Pacer 40: lastExploitationUtil 390.21472984080543, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:36:43,33 INFO     [oort.py:321] scores are 26,{5: 0.04479653009133287, 6: 0.29810772386553464, 7: 0.9274665346813457, 11: 0.1882943248506973, 14: 0.007563241542987105, 16: 0.5407629460463379, 17: 0.009039273032304394, 25: 0.005029790943186719, 27: 0.008364091191811612, 35: 0.00371692050552048, 38: 0.018105372752147242, 50: 0.01066429296825443, 51: 0.0533474773373753, 53: 0.06312371739467108, 55: 0.09485393131139279, 58: 0.004276860260864324, 59: 0.004069003562175838, 60: 0.002768185266595507, 65: 0.005145708429702315, 67: 0.003977277565262863, 70: 0.006669039461853028, 71: 0.009557030950182161, 76: 0.002904998186878783, 79: 0.004340741589130907, 81: 0.26082948827844593, 84: 0.26155755680029746, 85: 0.01925206802905454, 86: 0.0027237641911919707, 87: 0.011293253771134208, 88: 0.0031021266595879097, 96: 0.005800074847290609, 97: 0.1936041111617758, 98: 0.042919392189441935, 99: 0.020181536386457595, 104: 0.002501926961506703, 105: 0.015556205703655263, 107: 0.009070681377713339, 110: 0.05185862295740015, 111: 0.007680006117354362, 119: 0.013350618605880299},[7, 16, 6, 84, 81, 97, 11, 55, 53, 51, 110, 5, 98, 99, 85, 38, 105, 119, 87, 50, 71, 107, 17, 27, 111, 14, 70, 96, 65, 25, 79, 58, 59, 67, 35, 88, 76, 60, 86, 104]
2021-08-18:15:36:43,34 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000004
2021-08-18:15:36:43,35 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:43,35 INFO     [oort.py:398] At round 40, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 678.4853195875291, 'duration': 13.298442137908651, 'time_stamp': 41, 'count': 38, 'status': True, 'gradient': 19.628679834442188}, [0.47350857350234277, -7.3172516402839146e-06]), ({'reward': 1193.034038217049, 'duration': 5.8943907365129, 'time_stamp': 41, 'count': 38, 'status': True, 'gradient': 20.851198629021383}, [0.8326126103489623, -7.3172516402839146e-06]), ({'reward': 638.9388022824901, 'duration': 7.864087706209871, 'time_stamp': 41, 'count': 39, 'status': True, 'gradient': 21.565892330754696}, [0.4459090217139546, -7.3172516402839146e-06])]
2021-08-18:15:36:43,36 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 5, 27, 65, 50]
2021-08-18:15:36:43,379 INFO     [param_server.py:553] For epoch: 42, median_reward: 331.8753067248607, dev: 663.7506134497214
2021-08-18:15:36:43,965 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9905, Top-1 Accuracy: 560.0/1033 (0.5421), Top-5 Accuracy: 1.0
2021-08-18:15:36:43,965 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 455.385, eval_time 0.5534, test_loss 1.9905, test_accuracy 0.5421, test_5_accuracy 1.0 

2021-08-18:15:36:44,35 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:44,49 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:44,64 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1356, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:36:44,65 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 455.479, eval_time 0.6509, test_loss 2.1356, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:36:44,131 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2738, Top-1 Accuracy: 557.0/1033 (0.5392), Top-5 Accuracy: 1.0
2021-08-18:15:36:44,131 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 455.5484, eval_time 0.7191, test_loss 2.2738, test_accuracy 0.5392, test_5_accuracy 1.0 

2021-08-18:15:36:44,135 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:44,142 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:44,200 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:44,210 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:44,730 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:44,744 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:45,399 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:45,418 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:45,936 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:45,950 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:46,17 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:46,31 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:46,623 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:46,635 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:47,83 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:47,110 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:47,191 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:47,202 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:47,251 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:47,262 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:47,667 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:47,678 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:47,732 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:47,744 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:48,197 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:48,208 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:48,231 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:48,244 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:48,261 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:48,281 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:48,758 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:48,788 INFO     [learner.py:606] ====Pushing takes 0.029296875 s
2021-08-18:15:36:48,837 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:48,846 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:48,847 INFO     [param_server.py:410] Lock worker 2 with localStep 42 , while globalStep is 41

2021-08-18:15:36:49,871 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:49,885 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:50,496 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:50,510 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:50,516 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:50,537 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:51,65 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:51,91 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:51,93 INFO     [learner.py:606] ====Pushing takes 0.026903390884399414 s
2021-08-18:15:36:51,112 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:51,121 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:51,128 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:36:51,129 INFO     [param_server.py:410] Lock worker 3 with localStep 42 , while globalStep is 41

2021-08-18:15:36:51,583 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:51,603 INFO     [learner.py:606] ====Pushing takes 0.017588376998901367 s
2021-08-18:15:36:51,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:51,630 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:51,631 INFO     [param_server.py:381] ====After aggregation in epoch: 41, virtual_clock: 1108.027889453043, top_1: : 54.4369 % (1687.0), top_5: : 100.0 % (3099.0), test loss: 2.1333093643188477, test len: 3099.0
2021-08-18:15:36:51,632 INFO     [param_server.py:410] Lock worker 1 with localStep 42 , while globalStep is 42

2021-08-18:15:36:51,632 INFO     [param_server.py:441] ====Epoch 43 completes 20 clients with loss 4.83391116181401, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 65: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:51,632 INFO     [param_server.py:450] ====Start to sample for epoch 43, global virtualClock: 1108.027889453043, round_duration: 22.608487272923874
2021-08-18:15:36:51,633 INFO     [oort.py:208] Training selector: Pacer 41: lastExploitationUtil 400.1797724894372, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:36:51,634 INFO     [oort.py:321] scores are 26,{5: 0.008751521521518243, 6: 0.10012929691740702, 7: 0.09403105544025668, 11: 0.016171576596319032, 14: 0.0069035077884950745, 16: 0.17777736081351847, 17: 0.008250786574271026, 25: 0.004623786766361391, 27: 0.04608213882943848, 35: 0.0035582995022133148, 38: 0.017948305204501195, 50: 0.004014915669241084, 51: 0.5189613246190261, 53: 0.7280595103385427, 55: 0.15135127430417988, 58: 0.0038166829545965065, 59: 0.0036434849689419087, 60: 0.0025344769970270815, 65: 0.011084014428790189, 67: 0.0037135406504913153, 70: 0.006087306032077347, 71: 0.009588963918127337, 76: 0.0026828364526397404, 79: 0.004355245337554219, 81: 0.20783760986881503, 84: 0.23792317581832534, 85: 0.029682065423701248, 86: 0.0024938062387682126, 87: 0.011195282649574938, 88: 0.0028648893898243484, 96: 0.005217298311232821, 97: 0.16937378326234256, 98: 0.10938687904291719, 99: 0.05546944204664602, 104: 0.0022676017158587704, 105: 0.014199253934206754, 107: 0.008279455202123516, 110: 0.02992706940405391, 111: 0.006567321761855078, 119: 0.011984308953083852},[53, 51, 84, 81, 16, 97, 55, 98, 6, 7, 99, 27, 110, 85, 38, 11, 105, 119, 87, 65, 71, 5, 107, 17, 14, 111, 70, 96, 25, 79, 50, 58, 67, 59, 35, 88, 76, 60, 86, 104]
2021-08-18:15:36:51,655 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:36:51,656 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:51,656 INFO     [oort.py:398] At round 41, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1375.3573434095165, 'duration': 12.029357192292537, 'time_stamp': 42, 'count': 36, 'status': True, 'gradient': 26.694480377777825}, [0.828702775980022, -7.1430272149336945e-06]), ({'reward': 1659.6488777580794, 'duration': 11.058674649423494, 'time_stamp': 42, 'count': 39, 'status': True, 'gradient': 14.729054865803251}, [1.0, -7.1430272149336945e-06]), ({'reward': 0.01, 'duration': 26.145070720211294, 'time_stamp': 42, 'count': 37, 'status': True, 'gradient': 9.818952586448525}, [6.025407137517775e-09, -7.1430272149336945e-06])]
2021-08-18:15:36:51,657 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 65, 105]
2021-08-18:15:36:51,925 INFO     [param_server.py:553] For epoch: 43, median_reward: 331.91726468012746, dev: 663.8345293602549
2021-08-18:15:36:52,457 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9511, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:36:52,458 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 463.8775, eval_time 0.5076, test_loss 1.9511, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:36:52,496 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2363, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:36:52,497 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 463.914, eval_time 0.5465, test_loss 2.2363, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:36:52,527 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:52,541 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0133, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:36:52,542 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 463.9561, eval_time 0.5851, test_loss 2.0133, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:36:52,542 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:52,567 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:52,576 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:52,608 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:52,623 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:53,684 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:53,704 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:54,860 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:54,879 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:55,255 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:55,269 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:55,350 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:55,359 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:55,490 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:55,508 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:56,984 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:57,5 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:57,496 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:57,510 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:57,561 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:57,575 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:58,472 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:58,481 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:59,31 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:59,45 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:59,855 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:59,873 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:59,919 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:59,940 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:01,60 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:01,81 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:01,629 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:01,636 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:01,641 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:01,655 INFO     [learner.py:606] ====Pushing takes 0.017960548400878906 s
2021-08-18:15:37:01,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:01,699 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:37:01,700 INFO     [param_server.py:410] Lock worker 1 with localStep 43 , while globalStep is 42

2021-08-18:15:37:01,860 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:01,874 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:02,341 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:02,369 INFO     [learner.py:606] ====Pushing takes 0.026157140731811523 s
2021-08-18:15:37:02,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:02,408 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:37:02,409 INFO     [param_server.py:410] Lock worker 2 with localStep 43 , while globalStep is 42

2021-08-18:15:37:02,488 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:02,501 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:03,69 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:03,82 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:37:03,648 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:37:03,684 INFO     [learner.py:606] ====Pushing takes 0.03420877456665039 s
2021-08-18:15:37:03,719 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:03,727 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:03,728 INFO     [param_server.py:381] ====After aggregation in epoch: 42, virtual_clock: 1141.9456171770662, top_1: : 56.2439 % (1743.0), top_5: : 100.0 % (3099.0), test loss: 2.066889180077447, test len: 3099.0
2021-08-18:15:37:03,729 INFO     [param_server.py:410] Lock worker 3 with localStep 43 , while globalStep is 43

2021-08-18:15:37:03,730 INFO     [param_server.py:441] ====Epoch 44 completes 20 clients with loss 3.8796213256700094, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:37:03,730 INFO     [param_server.py:450] ====Start to sample for epoch 44, global virtualClock: 1141.9456171770662, round_duration: 33.917727724023365
2021-08-18:15:37:03,731 INFO     [oort.py:208] Training selector: Pacer 42: lastExploitationUtil 546.3855668483503, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:37:03,732 INFO     [oort.py:321] scores are 26,{5: 0.008779870180335598, 6: 0.05354598900639812, 7: 0.09323226988091197, 11: 0.016034200473117013, 14: 0.00928942855526336, 16: 1.0932322633332496, 17: 0.011102340252899898, 25: 0.004856348546853154, 27: 0.01764119942357078, 35: 0.0036578455936353586, 38: 0.043041881368760866, 50: 0.0040279211191171895, 51: 0.24260288090699533, 53: 0.5126120193744548, 55: 0.6636203766983003, 58: 0.004073213890489438, 59: 0.0038812616065372584, 60: 0.0026677162532504585, 65: 0.007704172808668462, 67: 0.003868131398984092, 70: 0.0081911393760205, 71: 0.0733890609290914, 76: 0.002810849527219999, 79: 0.004369353210845036, 81: 0.1523924672242678, 84: 0.2462633568279906, 85: 0.02398702842646048, 86: 0.002624907404337459, 87: 0.026807461695879147, 88: 0.003001589224345727, 96: 0.007123847705094776, 97: 0.029743260690007208, 98: 0.3647413727060124, 99: 0.107532599495282, 104: 0.002399836165345143, 105: 0.03742472277858568, 107: 0.008803266070511823, 110: 0.06797767710894724, 111: 0.008837053303227772, 119: 0.015361983629756649},[16, 55, 53, 98, 84, 51, 81, 99, 7, 71, 110, 6, 38, 105, 97, 87, 85, 27, 11, 119, 17, 14, 111, 107, 5, 70, 65, 96, 25, 79, 58, 50, 59, 67, 35, 88, 76, 60, 86, 104]
2021-08-18:15:37:03,733 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:37:03,733 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:03,734 INFO     [oort.py:398] At round 42, UCB exploited 40, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1527.2726019716501, 'duration': 7.864087706209871, 'time_stamp': 43, 'count': 41, 'status': True, 'gradient': 21.58250208903275}, [1.0, -6.976906439684649e-06]), ({'reward': 0.01, 'duration': 15.972045438625893, 'time_stamp': 43, 'count': 40, 'status': True, 'gradient': 20.667837093162255}, [6.547662413532073e-09, -6.976906439684649e-06]), ({'reward': 745.409190377974, 'duration': 17.619275735353515, 'time_stamp': 43, 'count': 39, 'status': True, 'gradient': 16.370610464868268}, [0.48806223273919214, -6.976906439684649e-06])]
2021-08-18:15:37:03,735 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:37:04,50 INFO     [param_server.py:553] For epoch: 44, median_reward: 360.1451135160181, dev: 720.2902270320362
2021-08-18:15:37:04,614 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2179, Top-1 Accuracy: 578.0/1033 (0.5595), Top-5 Accuracy: 1.0
2021-08-18:15:37:04,615 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 476.0323, eval_time 0.5299, test_loss 2.2179, test_accuracy 0.5595, test_5_accuracy 1.0 

2021-08-18:15:37:04,633 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1101, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:37:04,634 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 476.054, eval_time 0.5514, test_loss 2.1101, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:37:04,685 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:37:04,701 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:04,702 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:37:04,723 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:04,814 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2821, Top-1 Accuracy: 590.0/1033 (0.5712), Top-5 Accuracy: 1.0
2021-08-18:15:37:04,815 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 476.2291, eval_time 0.7045, test_loss 2.2821, test_accuracy 0.5712, test_5_accuracy 1.0 

2021-08-18:15:37:04,887 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:37:04,914 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:05,278 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:05,287 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:05,838 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:05,848 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:06,419 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:06,431 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:06,832 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:06,846 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:07,368 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:07,389 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:07,415 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:07,434 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:08,186 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:08,199 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:08,435 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:08,454 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:08,688 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:08,700 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:08,756 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:08,765 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:09,232 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:09,242 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:09,321 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:09,340 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:09,888 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:09,907 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:10,499 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:10,511 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:10,526 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:10,531 INFO     [learner.py:606] ====Pushing takes 0.03047633171081543 s
2021-08-18:15:37:10,574 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:10,582 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:37:10,583 INFO     [param_server.py:410] Lock worker 2 with localStep 44 , while globalStep is 43

2021-08-18:15:37:11,46 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:11,61 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:11,291 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:11,306 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:11,555 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:11,574 INFO     [learner.py:606] ====Pushing takes 0.017353534698486328 s
2021-08-18:15:37:11,598 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:11,604 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:11,605 INFO     [param_server.py:410] Lock worker 1 with localStep 44 , while globalStep is 43

2021-08-18:15:37:11,906 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:11,917 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:12,537 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:12,568 INFO     [learner.py:606] ====Pushing takes 0.02651190757751465 s
2021-08-18:15:37:12,607 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:12,614 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:12,615 INFO     [param_server.py:381] ====After aggregation in epoch: 43, virtual_clock: 1165.1302381056594, top_1: : 57.3088 % (1776.0), top_5: : 100.0 % (3099.0), test loss: 2.2033601491539567, test len: 3099.0
2021-08-18:15:37:12,616 INFO     [param_server.py:410] Lock worker 3 with localStep 44 , while globalStep is 44

2021-08-18:15:37:12,617 INFO     [param_server.py:441] ====Epoch 45 completes 20 clients with loss 6.015145639249895, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:12,617 INFO     [param_server.py:450] ====Start to sample for epoch 45, global virtualClock: 1165.1302381056594, round_duration: 23.184620928593155
2021-08-18:15:37:12,618 INFO     [oort.py:208] Training selector: Pacer 43: lastExploitationUtil 313.580989326863, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:37:12,619 INFO     [oort.py:321] scores are 26,{5: 0.05775404258873375, 6: 0.05310037645559526, 7: 0.26076359347176103, 11: 0.015900763009256625, 14: 0.0062064628510477594, 16: 0.6294775469702835, 17: 0.007417707335751383, 25: 0.0049115318354357035, 27: 0.0657205704577036, 35: 0.0036854907239064656, 38: 0.017647738040553293, 50: 0.00404058011844161, 51: 0.05199905674754463, 53: 0.727011593533583, 55: 0.09245638600296531, 58: 0.004130813293857105, 59: 0.00393491977582454, 60: 0.0026990398419512967, 65: 0.005015644562727023, 67: 0.003906444339193028, 70: 0.00547267272067248, 71: 0.00931546568872891, 76: 0.002841575923061317, 79: 0.0043830852669311795, 81: 0.07883016930788025, 84: 0.042547962832961035, 85: 0.022851079377256518, 86: 0.002655728343337651, 87: 0.03306187404887761, 88: 0.0030344006636515864, 97: 0.029495735702399176, 98: 0.041834553786207554, 99: 0.05557576399404919, 104: 0.002430292112011675, 105: 0.01276555987987944, 107: 0.007443481301568229, 110: 0.07518436472557635, 111: 0.00896358022582858, 119: 0.015581933023182528},[53, 16, 7, 55, 81, 110, 27, 5, 99, 6, 51, 84, 98, 87, 97, 85, 38, 11, 119, 105, 71, 111, 107, 17, 14, 70, 65, 25, 79, 58, 50, 59, 67, 35, 88, 76, 60, 86, 104]
2021-08-18:15:37:12,619 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:12,620 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:12,620 INFO     [oort.py:398] At round 43, UCB exploited 39, augment_factor 1.3076923076923077, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1501.4035129201375, 'duration': 11.058674649423494, 'time_stamp': 44, 'count': 41, 'status': True, 'gradient': 14.741497034834389}, [1.0, -6.818336780381378e-06]), ({'reward': 924.5930834893238, 'duration': 27.689063957948644, 'time_stamp': 44, 'count': 38, 'status': True, 'gradient': 20.167042399540463}, [0.615816625937652, -6.818336780381378e-06]), ({'reward': 806.290092747384, 'duration': 7.864087706209871, 'time_stamp': 44, 'count': 42, 'status': True, 'gradient': 21.600173896236797}, [0.5370211676277972, -6.818336780381378e-06])]
2021-08-18:15:37:12,621 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 79]
2021-08-18:15:37:12,910 INFO     [param_server.py:553] For epoch: 45, median_reward: 317.4155169160864, dev: 634.8310338321728
2021-08-18:15:37:13,497 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0514, Top-1 Accuracy: 590.0/1033 (0.5712), Top-5 Accuracy: 1.0
2021-08-18:15:37:13,498 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 484.9182, eval_time 0.5548, test_loss 2.0514, test_accuracy 0.5712, test_5_accuracy 1.0 

2021-08-18:15:37:13,508 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1182, Top-1 Accuracy: 577.0/1033 (0.5586), Top-5 Accuracy: 1.0
2021-08-18:15:37:13,511 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 484.9283, eval_time 0.5662, test_loss 2.1182, test_accuracy 0.5586, test_5_accuracy 1.0 

2021-08-18:15:37:13,515 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9935, Top-1 Accuracy: 575.0/1033 (0.5566), Top-5 Accuracy: 1.0
2021-08-18:15:37:13,516 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 484.9304, eval_time 0.5691, test_loss 1.9935, test_accuracy 0.5566, test_5_accuracy 1.0 

2021-08-18:15:37:13,581 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:13,585 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:13,586 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:13,591 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:13,600 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:13,606 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:14,150 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:14,160 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:15,180 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:15,190 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:15,822 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:15,843 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:15,885 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:15,912 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:16,618 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:16,638 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:17,121 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:17,135 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:17,886 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:17,906 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:17,907 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:17,928 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:18,388 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:18,473 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:18,624 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:18,638 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:19,202 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:19,216 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:19,586 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:19,596 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:20,165 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:20,193 INFO     [learner.py:606] ====Pushing takes 0.02699112892150879 s
2021-08-18:15:37:20,228 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:20,238 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:37:20,238 INFO     [param_server.py:410] Lock worker 2 with localStep 45 , while globalStep is 44

2021-08-18:15:37:20,640 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:20,654 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:21,310 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:21,319 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:21,604 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:21,621 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:21,915 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:21,924 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:22,114 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:22,128 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:22,213 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:22,234 INFO     [learner.py:606] ====Pushing takes 0.019740819931030273 s
2021-08-18:15:37:22,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:22,277 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:22,277 INFO     [param_server.py:410] Lock worker 1 with localStep 45 , while globalStep is 44

2021-08-18:15:37:22,491 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:22,518 INFO     [learner.py:606] ====Pushing takes 0.02648758888244629 s
2021-08-18:15:37:22,550 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:22,557 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:22,558 INFO     [param_server.py:381] ====After aggregation in epoch: 44, virtual_clock: 1192.478546073621, top_1: : 56.2117 % (1742.0), top_5: : 100.0 % (3099.0), test loss: 2.0543843794752052, test len: 3099.0
2021-08-18:15:37:22,559 INFO     [param_server.py:410] Lock worker 3 with localStep 45 , while globalStep is 45

2021-08-18:15:37:22,559 INFO     [param_server.py:441] ====Epoch 46 completes 20 clients with loss 4.431058429426903, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:22,559 INFO     [param_server.py:450] ====Start to sample for epoch 46, global virtualClock: 1192.478546073621, round_duration: 27.34830796796159
2021-08-18:15:37:22,560 INFO     [oort.py:208] Training selector: Pacer 44: lastExploitationUtil 509.5427297247325, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:37:22,561 INFO     [oort.py:321] scores are 26,{5: 0.07137801360344519, 6: 0.05266728151477469, 7: 0.24995835355109108, 11: 0.046790651906526384, 14: 0.007816945924335517, 16: 0.15488689236764844, 17: 0.009342490000778263, 25: 0.004479595946303019, 27: 0.03560569557613135, 35: 0.0035159420244244774, 38: 0.08908824110460745, 50: 0.016203631530279664, 51: 0.1648436425181613, 53: 0.25195209568490845, 55: 0.9237898569258054, 58: 0.00364189166247012, 59: 0.00348276981635453, 60: 0.002450462288651557, 65: 0.0050309496735893066, 67: 0.0017657190422211736, 70: 0.006892748373070655, 71: 0.009239487299676434, 76: 0.002605155149938267, 79: 0.026692005879741413, 81: 0.024040721928257413, 84: 0.16340366923483077, 85: 0.010210512175378697, 86: 0.002411139714613156, 87: 0.023122479823952238, 88: 0.002781936759715938, 97: 0.2841949326664483, 98: 0.49397213338995344, 99: 0.019510980983804247, 104: 0.0021811827070212877, 105: 0.011432652163323988, 107: 0.006666274993481863, 110: 0.009734352313826519, 111: 0.007436277419095088, 119: 0.013707592402433506},[55, 98, 97, 53, 7, 51, 84, 16, 38, 5, 6, 11, 27, 79, 81, 87, 99, 50, 119, 105, 85, 110, 17, 71, 14, 111, 70, 107, 65, 25, 58, 35, 59, 88, 76, 60, 86, 104, 67]
2021-08-18:15:37:22,562 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:37:22,562 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:22,563 INFO     [oort.py:398] At round 44, UCB exploited 39, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 356.57915733955235, 'duration': 12.029357192292537, 'time_stamp': 45, 'count': 39, 'status': True, 'gradient': 26.724802678504194}, [0.20139624503556797, -6.666814818107074e-06]), ({'reward': 111.87742057366654, 'duration': 7.864087706209871, 'time_stamp': 45, 'count': 43, 'status': True, 'gradient': 21.600813998845688}, [0.06318460069728647, -6.666814818107074e-06]), ({'reward': 1770.4956675089315, 'duration': 13.411352670399307, 'time_stamp': 45, 'count': 42, 'status': True, 'gradient': 17.818164238948402}, [1.0, -6.666814818107074e-06])]
2021-08-18:15:37:22,584 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 5, 27, 65, 79, 50]
2021-08-18:15:37:22,919 INFO     [param_server.py:553] For epoch: 46, median_reward: 358.0813519724113, dev: 716.1627039448226
2021-08-18:15:37:23,491 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9898, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:37:23,492 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 494.9114, eval_time 0.5389, test_loss 1.9898, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:37:23,556 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:23,573 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3578, Top-1 Accuracy: 568.0/1033 (0.5499), Top-5 Accuracy: 1.0
2021-08-18:15:37:23,574 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 494.9885, eval_time 0.6195, test_loss 2.3578, test_accuracy 0.5499, test_5_accuracy 1.0 

2021-08-18:15:37:23,574 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:23,580 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.358, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:37:23,580 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 494.9976, eval_time 0.6259, test_loss 2.358, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:37:23,648 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:23,654 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:23,669 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:23,670 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:24,345 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:24,360 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:25,446 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:25,460 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:25,774 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:25,784 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:26,13 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:26,22 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:26,261 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:26,274 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:27,492 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:27,507 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:27,841 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:27,862 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:27,944 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:27,971 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:28,179 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:28,193 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:28,484 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:28,507 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:28,763 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:28,772 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:29,136 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:29,151 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:37:29,753 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:37:29,813 INFO     [learner.py:606] ====Pushing takes 0.03847503662109375 s
2021-08-18:15:37:29,870 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:29,878 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:37:29,878 INFO     [param_server.py:410] Lock worker 2 with localStep 46 , while globalStep is 45

2021-08-18:15:37:30,775 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:30,796 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:31,73 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:31,86 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:31,626 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:31,636 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:31,795 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:31,814 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:32,260 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:32,289 INFO     [learner.py:606] ====Pushing takes 0.026908159255981445 s
2021-08-18:15:37:32,301 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:32,319 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:32,322 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:32,330 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:37:32,331 INFO     [param_server.py:410] Lock worker 3 with localStep 46 , while globalStep is 45

2021-08-18:15:37:32,400 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:32,420 INFO     [learner.py:606] ====Pushing takes 0.019320249557495117 s
2021-08-18:15:37:32,448 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:32,457 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:32,458 INFO     [param_server.py:381] ====After aggregation in epoch: 45, virtual_clock: 1221.4020470608896, top_1: : 55.6954 % (1726.0), top_5: : 100.0 % (3099.0), test loss: 2.235201555269736, test len: 3099.0
2021-08-18:15:37:32,459 INFO     [param_server.py:410] Lock worker 1 with localStep 46 , while globalStep is 46

2021-08-18:15:37:32,459 INFO     [param_server.py:441] ====Epoch 47 completes 20 clients with loss 6.705661761366127, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 65: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:37:32,459 INFO     [param_server.py:450] ====Start to sample for epoch 47, global virtualClock: 1221.4020470608896, round_duration: 28.923500987268568
2021-08-18:15:37:32,460 INFO     [oort.py:208] Training selector: Pacer 45: lastExploitationUtil 424.2784672494134, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:37:32,461 INFO     [oort.py:321] scores are 26,{5: 0.00846653179057744, 6: 0.05224611183394284, 7: 0.2583046505157458, 11: 0.015644955796525348, 14: 0.005284099504012575, 16: 0.28666261076206984, 17: 0.00631533686649512, 25: 0.0037300190420881904, 27: 0.03225942593708634, 35: 0.003217765598806333, 38: 0.01736382596183496, 50: 0.013058116714939267, 51: 0.05116250986212151, 53: 0.32242793235586004, 55: 0.1395025407409353, 58: 0.0027966278937860624, 59: 0.0027008205805532756, 60: 0.00201936960891094, 65: 0.004934954217559621, 67: 0.0013530794449747787, 70: 0.005281947988312528, 71: 0.009266881403035474, 76: 0.002194529250747259, 79: 0.04869242126937689, 81: 0.023848473099567613, 84: 0.12131750149163115, 85: 0.020769937744844324, 86: 0.0019869647801057625, 87: 0.060627952824546465, 88: 0.0023434464519590486, 97: 0.1332948694766052, 98: 0.04256368143175775, 99: 0.019354955584404056, 104: 0.0017497836164369583, 105: 0.010868427033012254, 107: 0.006337280476447806, 110: 0.00976321363965221, 111: 0.005026775188454496, 119: 0.008738346992577205},[53, 16, 7, 55, 97, 84, 87, 6, 51, 79, 98, 27, 81, 85, 99, 38, 11, 50, 105, 110, 71, 119, 5, 107, 17, 14, 70, 111, 65, 25, 35, 58, 59, 88, 76, 60, 86, 104, 67]
2021-08-18:15:37:32,462 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:37:32,462 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:32,463 INFO     [oort.py:398] At round 45, UCB exploited 39, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 501.4932514472305, 'duration': 7.864087706209871, 'time_stamp': 46, 'count': 44, 'status': True, 'gradient': 21.61070899851239}, [0.195693642214377, -6.52188091045458e-06]), ({'reward': 1008.4747690824661, 'duration': 11.058674649423494, 'time_stamp': 46, 'count': 43, 'status': True, 'gradient': 19.669195435664875}, [0.3935328670672518, -6.52188091045458e-06]), ({'reward': 7.951018372054932, 'duration': 13.411352670399307, 'time_stamp': 46, 'count': 43, 'status': True, 'gradient': 17.824939521238672}, [0.0030988247954087654, -6.52188091045458e-06])]
2021-08-18:15:37:32,464 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 5, 27, 65, 79]
2021-08-18:15:37:32,799 INFO     [param_server.py:553] For epoch: 47, median_reward: 338.32025091067334, dev: 676.6405018213467
2021-08-18:15:37:33,392 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8911, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:37:33,393 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 504.8132, eval_time 0.5598, test_loss 1.8911, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:37:33,396 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3356, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:37:33,396 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 504.8105, eval_time 0.5602, test_loss 2.3356, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:37:33,402 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2526, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:37:33,406 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 504.8229, eval_time 0.5713, test_loss 2.2526, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:37:33,464 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:33,466 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:33,475 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:33,478 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:33,482 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:33,487 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:34,5 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:34,16 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:34,922 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:34,934 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:35,481 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:35,492 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:35,507 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:35,517 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:36,239 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:36,252 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:36,755 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:36,769 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:37,210 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:37,219 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:37,385 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:37,405 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:37,814 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:37,826 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:37,842 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:37,851 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:38,323 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:38,334 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:38,335 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:38,344 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:38,858 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:38,883 INFO     [learner.py:606] ====Pushing takes 0.023823022842407227 s
2021-08-18:15:37:38,932 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:38,942 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:37:38,943 INFO     [param_server.py:410] Lock worker 2 with localStep 47 , while globalStep is 46

2021-08-18:15:37:40,132 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:40,152 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:40,488 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:40,498 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:40,775 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:40,795 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:41,94 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:41,104 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:41,336 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:41,364 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:41,525 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:41,545 INFO     [learner.py:606] ====Pushing takes 0.019282102584838867 s
2021-08-18:15:37:41,573 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:41,579 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:41,579 INFO     [param_server.py:410] Lock worker 1 with localStep 47 , while globalStep is 46

2021-08-18:15:37:41,686 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:41,716 INFO     [learner.py:606] ====Pushing takes 0.028543949127197266 s
2021-08-18:15:37:41,748 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:41,756 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:41,758 INFO     [param_server.py:381] ====After aggregation in epoch: 46, virtual_clock: 1248.7503550288511, top_1: : 57.4702 % (1781.0), top_5: : 100.0 % (3099.0), test loss: 2.159759044647217, test len: 3099.0
2021-08-18:15:37:41,759 INFO     [param_server.py:410] Lock worker 3 with localStep 47 , while globalStep is 47

2021-08-18:15:37:41,759 INFO     [param_server.py:441] ====Epoch 48 completes 20 clients with loss 6.1102597483460785, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:41,760 INFO     [param_server.py:450] ====Start to sample for epoch 48, global virtualClock: 1248.7503550288511, round_duration: 27.34830796796159
2021-08-18:15:37:41,761 INFO     [oort.py:208] Training selector: Pacer 46: lastExploitationUtil 536.6833670503106, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:37:41,761 INFO     [oort.py:321] scores are 26,{5: 0.008400124106521838, 6: 0.08918546655170784, 7: 0.14814703690712447, 11: 0.1066460075282552, 14: 0.007657102852999944, 16: 1.0902554459544955, 25: 0.005100581510748893, 27: 0.07350135254634495, 35: 0.003699396433731793, 38: 0.10628853421246483, 50: 0.019003776944675737, 51: 0.05076121404531533, 53: 0.42095659058637747, 55: 0.3875750419046585, 58: 0.004115006456307599, 59: 0.0039212894883734, 60: 0.002696156480313392, 65: 0.022703326197318498, 67: 0.0019965931680701113, 70: 0.008083882453932259, 71: 0.009293595728471247, 76: 0.002841195950677392, 79: 0.012751005700929166, 81: 0.10185905595156139, 84: 0.18602169727353454, 85: 0.07337658957334073, 86: 0.0026528912510106473, 87: 0.010745761572178072, 88: 0.0030339949069570025, 97: 0.2617341074730048, 98: 0.35316582080457104, 99: 0.07644463353966618, 104: 0.002425040299459817, 105: 0.018856469369668137, 107: 0.009183250311547096, 110: 0.009580767322209827, 111: 0.008721338615182208, 119: 0.012662596841061902},[16, 53, 55, 98, 97, 84, 7, 11, 38, 81, 6, 99, 27, 85, 51, 65, 50, 105, 79, 119, 87, 110, 71, 107, 111, 5, 70, 14, 25, 58, 59, 35, 88, 76, 60, 86, 104, 67]
2021-08-18:15:37:41,763 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:41,764 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:41,764 INFO     [oort.py:398] At round 46, UCB exploited 38, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1044.0416415300754, 'duration': 13.411352670399307, 'time_stamp': 47, 'count': 44, 'status': True, 'gradient': 17.83404319401672}, [0.6902580888193995, -6.383114534351799e-06]), ({'reward': 820.2548063681957, 'duration': 11.058674649423494, 'time_stamp': 47, 'count': 44, 'status': True, 'gradient': 18.037998426087533}, [0.5423021595950342, -6.383114534351799e-06]), ({'reward': 1512.5335930421047, 'duration': 7.864087706209871, 'time_stamp': 47, 'count': 45, 'status': True, 'gradient': 21.620536258715603}, [1.0, -6.383114534351799e-06])]
2021-08-18:15:37:41,765 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 5, 27, 65, 79]
2021-08-18:15:37:42,108 INFO     [param_server.py:553] For epoch: 48, median_reward: 365.8882025336637, dev: 731.7764050673273
2021-08-18:15:37:42,691 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0032, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:37:42,696 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 514.1153, eval_time 0.554, test_loss 2.0032, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:37:42,731 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2985, Top-1 Accuracy: 560.0/1033 (0.5421), Top-5 Accuracy: 1.0
2021-08-18:15:37:42,732 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 514.1492, eval_time 0.5895, test_loss 2.2985, test_accuracy 0.5421, test_5_accuracy 1.0 

2021-08-18:15:37:42,761 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:42,777 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:42,780 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1072, Top-1 Accuracy: 571.0/1033 (0.5528), Top-5 Accuracy: 1.0
2021-08-18:15:37:42,782 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 514.1964, eval_time 0.6354, test_loss 2.1072, test_accuracy 0.5528, test_5_accuracy 1.0 

2021-08-18:15:37:42,803 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:42,813 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:42,856 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:42,870 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:43,444 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:43,453 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:44,445 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:44,455 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:45,84 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:45,94 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:45,107 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:45,128 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:45,640 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:45,654 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:46,448 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:46,466 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:46,714 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:46,734 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:46,891 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:46,900 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:47,585 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:47,594 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:47,749 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:47,761 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:48,131 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:48,140 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:48,451 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:48,461 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:49,74 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:49,101 INFO     [learner.py:606] ====Pushing takes 0.026081323623657227 s
2021-08-18:15:37:49,153 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:49,161 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:37:49,161 INFO     [param_server.py:410] Lock worker 2 with localStep 48 , while globalStep is 47

2021-08-18:15:37:49,360 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:49,379 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:50,374 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:50,388 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:50,411 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:50,438 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:50,943 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:50,964 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:50,975 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:50,984 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:51,86 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:51,106 INFO     [learner.py:606] ====Pushing takes 0.018898487091064453 s
2021-08-18:15:37:51,132 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:51,138 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:51,139 INFO     [param_server.py:410] Lock worker 1 with localStep 48 , while globalStep is 47

2021-08-18:15:37:51,601 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:51,631 INFO     [learner.py:606] ====Pushing takes 0.028428077697753906 s
2021-08-18:15:37:51,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:51,669 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:51,669 INFO     [param_server.py:381] ====After aggregation in epoch: 47, virtual_clock: 1276.7662105243398, top_1: : 54.5337 % (1690.0), top_5: : 100.0 % (3099.0), test loss: 2.1363325670913413, test len: 3099.0
2021-08-18:15:37:51,670 INFO     [param_server.py:410] Lock worker 3 with localStep 48 , while globalStep is 48

2021-08-18:15:37:51,671 INFO     [param_server.py:441] ====Epoch 49 completes 20 clients with loss 4.141875264746802, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:51,672 INFO     [param_server.py:450] ====Start to sample for epoch 49, global virtualClock: 1276.7662105243398, round_duration: 28.015855495488744
2021-08-18:15:37:51,672 INFO     [oort.py:208] Training selector: Pacer 47: lastExploitationUtil 373.9702241229504, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:37:51,673 INFO     [oort.py:321] scores are 26,{5: 0.09952124301335716, 6: 0.5484829633285617, 7: 0.0895608319993064, 11: 0.06307694615390776, 14: 0.00954901284032183, 16: 0.8219863731702752, 25: 0.007188547910084888, 27: 0.09485826413898747, 35: 0.004300082160038305, 38: 0.022166211197841942, 50: 0.019794007409055597, 51: 0.050370547528646434, 53: 0.05960124762985766, 55: 0.9250557889307476, 58: 0.005764073415943926, 59: 0.005447798872508793, 60: 0.003542235759582128, 65: 0.00485856434012273, 67: 0.002801528756897446, 70: 0.011393088454154402, 71: 0.00931966146122346, 76: 0.003649409274106309, 79: 0.003997303210879984, 81: 0.16290052100796681, 84: 0.04121544347486543, 85: 0.009972072590390655, 86: 0.003485393494119521, 87: 0.07755661272112736, 88: 0.003897052277721415, 97: 0.34759522220889044, 98: 0.3498979536975547, 99: 0.01905535347672326, 104: 0.0032694181011900317, 105: 0.019640574371002216, 107: 0.01145223942061802, 110: 0.009507032186689988, 111: 0.00908399639021047, 119: 0.015791259716427326},[55, 16, 6, 98, 97, 81, 5, 27, 7, 87, 11, 53, 51, 84, 38, 50, 105, 99, 119, 107, 70, 85, 14, 110, 71, 111, 25, 58, 59, 65, 35, 79, 88, 76, 60, 86, 104, 67]
2021-08-18:15:37:51,674 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:37:51,675 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:51,675 INFO     [oort.py:398] At round 47, UCB exploited 38, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 835.3671525300963, 'duration': 8.010998429338052, 'time_stamp': 48, 'count': 46, 'status': True, 'gradient': 20.807122255832258}, [0.8354949669330909, -6.2501302110460685e-06]), ({'reward': 865.3044110592851, 'duration': 11.90395711384456, 'time_stamp': 48, 'count': 45, 'status': True, 'gradient': 20.60452354520277}, [0.8654371640516927, -6.2501302110460685e-06]), ({'reward': 732.3147367754505, 'duration': 7.864087706209871, 'time_stamp': 48, 'count': 46, 'status': True, 'gradient': 21.63331568293612}, [0.7324255511726185, -6.2501302110460685e-06])]
2021-08-18:15:37:51,676 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 110, 71, 5, 27, 50, 105, 119]
2021-08-18:15:37:52,8 INFO     [param_server.py:553] For epoch: 49, median_reward: 333.4436859416357, dev: 666.8873718832714
2021-08-18:15:37:52,645 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2752, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:37:52,646 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 524.0602, eval_time 0.6019, test_loss 2.2752, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:37:52,649 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1541, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:37:52,650 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 524.0695, eval_time 0.6075, test_loss 2.1541, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:37:52,655 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6023, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:37:52,658 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 524.0755, eval_time 0.6159, test_loss 2.6023, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:37:52,719 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:52,724 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:52,728 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:52,730 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:52,739 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:52,743 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:53,381 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:53,391 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:54,419 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:54,431 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:54,988 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:54,998 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:55,323 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:55,332 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:55,748 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:55,775 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:56,769 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:56,797 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:57,447 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:57,468 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:57,562 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:57,580 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:58,71 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:58,80 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:58,520 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:58,530 INFO     [learner.py:606] ====Pushing takes 0.009131193161010742 s
2021-08-18:15:37:58,543 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:58,550 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:37:58,550 INFO     [param_server.py:410] Lock worker 1 with localStep 49 , while globalStep is 48

2021-08-18:15:37:58,685 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:58,699 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:58,754 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:58,773 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:00,341 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:00,352 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:00,931 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:00,942 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:38:01,318 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:01,328 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:01,518 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:38:01,528 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:38:01,914 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:01,924 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:02,54 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:38:02,90 INFO     [learner.py:606] ====Pushing takes 0.03460264205932617 s
2021-08-18:15:38:02,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:02,148 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:02,149 INFO     [param_server.py:410] Lock worker 2 with localStep 49 , while globalStep is 48

2021-08-18:15:38:02,525 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:02,536 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:38:03,56 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:38:03,92 INFO     [learner.py:606] ====Pushing takes 0.03374600410461426 s
2021-08-18:15:38:03,128 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:03,136 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:03,136 INFO     [param_server.py:381] ====After aggregation in epoch: 48, virtual_clock: 1308.3967833160643, top_1: : 57.7606 % (1790.0), top_5: : 100.0 % (3099.0), test loss: 2.343889854572437, test len: 3099.0
2021-08-18:15:38:03,138 INFO     [param_server.py:410] Lock worker 3 with localStep 49 , while globalStep is 49

2021-08-18:15:38:03,139 INFO     [param_server.py:441] ====Epoch 50 completes 20 clients with loss 5.5117270934175, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 71: 0, 81: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:38:03,139 INFO     [param_server.py:450] ====Start to sample for epoch 50, global virtualClock: 1308.3967833160643, round_duration: 31.630572791724475
2021-08-18:15:38:03,140 INFO     [oort.py:208] Training selector: Pacer 48: lastExploitationUtil 520.7593115382265, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:38:03,141 INFO     [oort.py:321] scores are 26,{5: 0.008272506198181767, 6: 0.05104879951649156, 7: 0.5874110404598392, 11: 0.043548480323518345, 14: 0.007467865957292525, 16: 0.4181515836043579, 25: 0.004154813491965837, 27: 0.07502796944431178, 35: 0.0034760265510650045, 38: 0.01696590309308133, 50: 0.046492921133983234, 51: 0.049990030205753204, 53: 0.05915099826188501, 58: 0.003461304578385723, 59: 0.003316921581775689, 60: 0.0023646841982763256, 65: 0.004871829791962719, 67: 0.0016774305132100445, 70: 0.006584940132077653, 71: 0.024535319453051152, 76: 0.0025263391752725563, 79: 0.004008217141317391, 81: 0.22272507507512443, 84: 0.07800298193152008, 85: 0.00999929957339061, 86: 0.002326738105453438, 87: 0.0444972021822942, 88: 0.0026977724606412445, 97: 0.11422766441270195, 98: 0.1802423850842954, 99: 0.02126324219012287, 104: 0.00209245409407869, 105: 0.01159957503830497, 107: 0.00895629635587697, 110: 0.009435212629154276, 111: 0.007104196897941821, 119: 0.025639263895166454},[7, 16, 81, 98, 97, 84, 27, 53, 6, 51, 50, 87, 11, 119, 71, 99, 38, 105, 85, 110, 107, 5, 14, 111, 70, 65, 25, 79, 35, 58, 59, 88, 76, 60, 86, 104, 67]
2021-08-18:15:38:03,142 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:38:03,142 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:03,143 INFO     [oort.py:398] At round 48, UCB exploited 37, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 626.56660598797, 'duration': 7.864087706209871, 'time_stamp': 49, 'count': 47, 'status': True, 'gradient': 21.6416224888222}, [0.3292673317576858, -6.12257393008021e-06]), ({'reward': 588.8758569060692, 'duration': 13.411352670399307, 'time_stamp': 49, 'count': 46, 'status': True, 'gradient': 17.84800633607338}, [0.3094601314736748, -6.12257393008021e-06]), ({'reward': 512.208745907104, 'duration': 15.972045438625893, 'time_stamp': 49, 'count': 46, 'status': True, 'gradient': 20.71791949771284}, [0.2691701170870351, -6.12257393008021e-06])]
2021-08-18:15:38:03,143 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 65, 79, 50]
2021-08-18:15:38:03,487 INFO     [param_server.py:553] For epoch: 50, median_reward: 358.9252520271655, dev: 717.850504054331
2021-08-18:15:38:04,75 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1516, Top-1 Accuracy: 569.0/1033 (0.5508), Top-5 Accuracy: 1.0
2021-08-18:15:38:04,76 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 535.4959, eval_time 0.5555, test_loss 2.1516, test_accuracy 0.5508, test_5_accuracy 1.0 

2021-08-18:15:38:04,150 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:38:04,161 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3318, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:38:04,163 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5123, Top-1 Accuracy: 560.0/1033 (0.5421), Top-5 Accuracy: 1.0
2021-08-18:15:38:04,178 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 535.5917, eval_time 0.6567, test_loss 2.3318, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:38:04,178 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 535.5949, eval_time 0.6569, test_loss 2.5123, test_accuracy 0.5421, test_5_accuracy 1.0 

2021-08-18:15:38:04,178 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:04,246 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:38:04,249 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:38:04,256 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:04,258 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:05,244 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:05,254 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:06,317 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:06,331 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:06,771 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:06,781 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:07,16 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:07,36 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:07,428 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:07,455 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:38:09,221 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:09,234 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:09,281 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:38:09,301 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:09,370 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:09,388 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:10,389 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:10,410 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:10,413 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:10,433 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:11,37 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:11,57 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:11,75 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:11,96 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:11,383 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:11,401 INFO     [learner.py:606] ====Pushing takes 0.017195940017700195 s
2021-08-18:15:38:11,427 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:11,433 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:38:11,433 INFO     [param_server.py:410] Lock worker 1 with localStep 50 , while globalStep is 49

2021-08-18:15:38:11,759 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:11,776 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:13,879 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:13,889 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:13,891 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:13,898 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:14,481 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:14,485 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:14,491 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:38:14,495 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:15,76 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:38:15,108 INFO     [learner.py:606] ====Pushing takes 0.030656814575195312 s
2021-08-18:15:38:15,129 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:15,151 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:15,159 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:38:15,159 INFO     [param_server.py:410] Lock worker 2 with localStep 50 , while globalStep is 49

2021-08-18:15:38:15,160 INFO     [learner.py:606] ====Pushing takes 0.029511451721191406 s
2021-08-18:15:38:15,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:15,197 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:15,198 INFO     [param_server.py:381] ====After aggregation in epoch: 49, virtual_clock: 1346.79280487485, top_1: : 54.8241 % (1699.0), top_5: : 100.0 % (3099.0), test loss: 2.3319265091860735, test len: 3099.0
2021-08-18:15:38:15,199 INFO     [param_server.py:410] Lock worker 3 with localStep 50 , while globalStep is 50

2021-08-18:15:38:15,199 INFO     [param_server.py:441] ====Epoch 51 completes 20 clients with loss 3.8242698087117675, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:15,199 INFO     [param_server.py:450] ====Start to sample for epoch 51, global virtualClock: 1346.79280487485, round_duration: 38.39602155878561
2021-08-18:15:38:15,200 INFO     [oort.py:208] Training selector: Pacer 49: lastExploitationUtil 554.9381416060966, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:38:15,201 INFO     [oort.py:321] scores are 26,{5: 0.008294508029890459, 6: 0.33238335702164934, 7: 0.08822494895237454, 11: 0.020417435192285515, 14: 0.008434177760122164, 16: 0.08822494895237454, 25: 0.004475953993840805, 27: 0.00777955650576134, 35: 0.003576244353996142, 38: 0.06090671405128462, 50: 0.0037670079135923014, 51: 0.5107013884750475, 53: 0.45629437465962513, 58: 0.00348807219993392, 59: 0.003559299263097622, 60: 0.002500197542422988, 65: 0.007289588247300316, 67: 0.0018050777231978432, 70: 0.007093913876126866, 71: 0.056533967738371625, 76: 0.002656384238205856, 79: 0.032142976655413436, 81: 0.02312909847319787, 84: 0.040600676829885204, 85: 0.10613044047071961, 86: 0.0024600768666517823, 87: 0.09104493410358926, 88: 0.002836642170954771, 97: 0.34716904581672253, 98: 0.2026174558872538, 99: 0.018771125169609656, 104: 0.002227098376216612, 105: 0.017347562342407457, 107: 0.010115205062570161, 110: 0.030981301505367025, 111: 0.008023451387961582, 119: 0.013947650268330312},[51, 53, 97, 6, 98, 85, 87, 7, 16, 38, 71, 84, 79, 110, 81, 11, 99, 105, 119, 107, 14, 5, 111, 27, 65, 70, 25, 50, 35, 59, 58, 88, 76, 60, 86, 104, 67]
2021-08-18:15:38:15,217 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:38:15,218 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:15,218 INFO     [oort.py:398] At round 49, UCB exploited 37, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1032.066173181063, 'duration': 11.058674649423494, 'time_stamp': 50, 'count': 47, 'status': True, 'gradient': 20.0068218298978}, [0.5974335867535963, -6.000120002400053e-06]), ({'reward': 847.3549444400068, 'duration': 11.90395711384456, 'time_stamp': 50, 'count': 47, 'status': True, 'gradient': 20.6178158995684}, [0.49050850486483927, -6.000120002400053e-06]), ({'reward': 1416.23897922083, 'duration': 12.029357192292537, 'time_stamp': 50, 'count': 44, 'status': True, 'gradient': 26.77328523278007}, [0.8198223880474357, -6.000120002400053e-06])]
2021-08-18:15:38:15,219 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 65, 79, 105, 119]
2021-08-18:15:38:15,566 INFO     [param_server.py:553] For epoch: 51, median_reward: 374.5983723334983, dev: 749.1967446669966
2021-08-18:15:38:16,123 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5272, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:38:16,124 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 547.5384, eval_time 0.5113, test_loss 2.5272, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:38:16,165 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1758, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:38:16,165 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 547.5825, eval_time 0.5546, test_loss 2.1758, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:38:16,236 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:16,243 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0497, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:38:16,244 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 547.6636, eval_time 0.6332, test_loss 2.0497, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:38:16,247 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:16,252 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:16,255 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:16,314 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:16,340 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:17,499 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:17,520 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:18,646 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:18,666 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:19,76 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:19,94 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:19,215 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:19,236 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:19,800 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:19,827 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:21,117 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:21,138 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:21,299 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:21,313 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:21,497 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:21,508 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:21,752 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:21,773 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:22,400 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:22,417 INFO     [learner.py:606] ====Pushing takes 0.01605701446533203 s
2021-08-18:15:38:22,436 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:22,442 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:22,442 INFO     [param_server.py:410] Lock worker 1 with localStep 51 , while globalStep is 50

2021-08-18:15:38:22,616 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:22,630 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:23,345 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:23,359 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:23,564 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:23,575 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:25,609 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:25,621 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:25,989 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:25,998 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:26,244 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:26,262 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:38:26,607 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:26,617 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:26,870 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:38:26,904 INFO     [learner.py:606] ====Pushing takes 0.032108306884765625 s
2021-08-18:15:38:26,939 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:26,947 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:26,948 INFO     [param_server.py:410] Lock worker 2 with localStep 51 , while globalStep is 50

2021-08-18:15:38:27,148 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:27,157 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:38:27,747 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:38:27,780 INFO     [learner.py:606] ====Pushing takes 0.0317072868347168 s
2021-08-18:15:38:27,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:27,822 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:27,823 INFO     [param_server.py:381] ====After aggregation in epoch: 50, virtual_clock: 1381.4338397558386, top_1: : 58.3091 % (1807.0), top_5: : 100.0 % (3099.0), test loss: 2.250919156604343, test len: 3099.0
2021-08-18:15:38:27,824 INFO     [param_server.py:410] Lock worker 3 with localStep 51 , while globalStep is 51

2021-08-18:15:38:27,825 INFO     [param_server.py:441] ====Epoch 52 completes 20 clients with loss 5.428926169076843, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 38: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:38:27,825 INFO     [param_server.py:450] ====Start to sample for epoch 52, global virtualClock: 1381.4338397558386, round_duration: 34.64103488098859
2021-08-18:15:38:27,826 INFO     [oort.py:208] Training selector: Pacer 50: lastExploitationUtil 369.8153918697744, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:38:27,827 INFO     [oort.py:321] scores are 26,{5: 0.008316008926575623, 6: 0.05030096672240298, 7: 0.08758215865941865, 11: 0.12736944477400694, 14: 0.0068983923627192875, 25: 0.00501513593725472, 27: 0.0077228761283308625, 35: 0.0037402934779523175, 38: 0.0167173632873561, 50: 0.0037767726941937765, 51: 0.049257707715911626, 53: 0.5060641816596794, 58: 0.0028529266644587645, 59: 0.003965891539131243, 60: 0.002726537128994949, 65: 0.007473118813580227, 67: 0.002019342038652177, 70: 0.006082795403113694, 71: 0.04248935708454235, 76: 0.0028730936042810663, 79: 0.004756761312010083, 81: 0.15619917361871027, 84: 0.5004998246242867, 85: 0.05361324991089208, 86: 0.0026827843813522377, 87: 0.010427480757940458, 88: 0.003068057083680277, 93: 0.01838172047654576, 97: 0.09440676731554246, 98: 0.2780588079413469, 99: 0.08498477675849764, 104: 0.002452483289381235, 105: 0.015061926358765241, 107: 0.008273320213962715, 110: 0.00929699270057396, 111: 0.0065624554463459585, 119: 0.0029833472730340163},[53, 84, 98, 81, 11, 97, 7, 99, 85, 6, 51, 71, 93, 38, 105, 87, 110, 5, 107, 27, 65, 14, 111, 70, 25, 79, 59, 50, 35, 88, 119, 76, 58, 60, 86, 104, 67]
2021-08-18:15:38:27,828 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:27,829 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:27,829 INFO     [oort.py:398] At round 50, UCB exploited 37, augment_factor 1.2692307692307692, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 400.63460931386214, 'duration': 43.8287324306519, 'time_stamp': 51, 'count': 40, 'status': True, 'gradient': 8.212348639822208}, [0.2679304070058079, -5.8824682836918415e-06]), ({'reward': 1006.1138432672219, 'duration': 11.058674649423494, 'time_stamp': 51, 'count': 48, 'status': True, 'gradient': 20.017742954234308}, [0.6728638278837574, -5.8824682836918415e-06]), ({'reward': 787.922200598888, 'duration': 13.411352670399307, 'time_stamp': 51, 'count': 48, 'status': True, 'gradient': 17.86138677544993}, [0.5269412539652711, -5.8824682836918415e-06])]
2021-08-18:15:38:27,830 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 38, 93, 11, 87, 85, 110, 71, 5, 27, 65, 50]
2021-08-18:15:38:28,124 INFO     [param_server.py:553] For epoch: 52, median_reward: 327.06698240129333, dev: 654.1339648025867
2021-08-18:15:38:28,740 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1511, Top-1 Accuracy: 582.0/1033 (0.5634), Top-5 Accuracy: 1.0
2021-08-18:15:38:28,741 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 560.1553, eval_time 0.5686, test_loss 2.1511, test_accuracy 0.5634, test_5_accuracy 1.0 

2021-08-18:15:38:28,770 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5299, Top-1 Accuracy: 582.0/1033 (0.5634), Top-5 Accuracy: 1.0
2021-08-18:15:38:28,775 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 560.1919, eval_time 0.6038, test_loss 2.5299, test_accuracy 0.5634, test_5_accuracy 1.0 

2021-08-18:15:38:28,817 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:28,830 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:28,846 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:28,846 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0336, Top-1 Accuracy: 574.0/1033 (0.5557), Top-5 Accuracy: 1.0
2021-08-18:15:38:28,849 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 560.2685, eval_time 0.6801, test_loss 2.0336, test_accuracy 0.5557, test_5_accuracy 1.0 

2021-08-18:15:38:28,869 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:28,916 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:28,939 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:29,486 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:29,500 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:30,89 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:30,103 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:30,567 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:30,580 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:30,679 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:30,700 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:31,283 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:31,303 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:31,740 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:31,767 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:31,837 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:31,841 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:31,851 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:31,861 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:32,339 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:32,358 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:32,393 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:32,413 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:32,428 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:32,442 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:32,906 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:32,920 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:32,973 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:32,975 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:32,985 INFO     [learner.py:606] ====Pushing takes 0.011161327362060547 s
2021-08-18:15:38:32,988 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:33,2 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:33,6 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:38:33,7 INFO     [param_server.py:410] Lock worker 1 with localStep 52 , while globalStep is 51

2021-08-18:15:38:33,424 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:33,433 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:38:34,52 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:38:34,83 INFO     [learner.py:606] ====Pushing takes 0.029959678649902344 s
2021-08-18:15:38:34,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:34,139 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:34,139 INFO     [param_server.py:410] Lock worker 2 with localStep 52 , while globalStep is 51

2021-08-18:15:38:34,644 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:34,653 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:38:35,198 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:38:35,207 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:35,744 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:35,754 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:36,342 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:36,379 INFO     [learner.py:606] ====Pushing takes 0.035162925720214844 s
2021-08-18:15:38:36,415 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:36,423 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:36,424 INFO     [param_server.py:381] ====After aggregation in epoch: 51, virtual_clock: 1402.8385771660355, top_1: : 56.0826 % (1738.0), top_5: : 100.0 % (3099.0), test loss: 2.2381905317306523, test len: 3099.0
2021-08-18:15:38:36,425 INFO     [param_server.py:410] Lock worker 3 with localStep 52 , while globalStep is 52

2021-08-18:15:38:36,426 INFO     [param_server.py:441] ====Epoch 53 completes 20 clients with loss 5.532317651748841, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:36,426 INFO     [param_server.py:450] ====Start to sample for epoch 53, global virtualClock: 1402.8385771660355, round_duration: 21.404737410197022
2021-08-18:15:38:36,427 INFO     [oort.py:208] Training selector: Pacer 51: lastExploitationUtil 363.20954056923983, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:38:36,428 INFO     [oort.py:321] scores are 26,{5: 0.008092966532314946, 6: 0.5376715518285451, 7: 0.5936531957867185, 11: 0.014954659923646368, 14: 0.007348417874372582, 25: 0.00545960236894489, 27: 0.007667590558525021, 35: 0.003876424539232945, 38: 0.016597689096078803, 50: 0.031372972354714264, 51: 0.04890508773429445, 53: 0.06301916045619876, 58: 0.0030390410102911145, 59: 0.004301134459703074, 60: 0.0029133691293354727, 65: 0.004717211286640973, 67: 0.0021959782881160405, 70: 0.006479614396530512, 71: 0.008761190977076885, 76: 0.0030520830131668857, 79: 0.004860502625314305, 81: 0.25883178405744706, 84: 0.04001633847636503, 85: 0.04909444785817335, 86: 0.0028666182881492874, 87: 0.010352833799247521, 93: 0.02514167592564023, 97: 0.2949374834391084, 98: 0.49182416554752, 99: 0.06848226456730348, 104: 0.0026384205853540845, 105: 0.015114352675428223, 107: 0.008955220952572975, 110: 0.00923043853987126, 111: 0.007103343880521148, 119: 0.012152122643406493},[7, 6, 98, 97, 81, 99, 53, 85, 51, 84, 50, 93, 38, 105, 11, 119, 87, 110, 107, 71, 5, 27, 14, 111, 70, 25, 79, 65, 59, 35, 76, 58, 60, 86, 104, 67]
2021-08-18:15:38:36,429 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:36,429 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:36,430 INFO     [oort.py:398] At round 51, UCB exploited 36, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1143.2377300110045, 'duration': 11.90395711384456, 'time_stamp': 52, 'count': 49, 'status': True, 'gradient': 20.636749602606287}, [0.8492183824971484, -5.7693417181099685e-06]), ({'reward': 682.1327992058316, 'duration': 5.8943907365129, 'time_stamp': 52, 'count': 49, 'status': True, 'gradient': 20.943061488291484}, [0.5066980168733584, -5.7693417181099685e-06]), ({'reward': 1346.2217107700026, 'duration': 13.411352670399307, 'time_stamp': 52, 'count': 49, 'status': True, 'gradient': 13.143877978722626}, [1.0, -5.7693417181099685e-06])]
2021-08-18:15:38:36,430 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 87, 85, 110, 71, 5, 79, 50, 105, 119]
2021-08-18:15:38:36,740 INFO     [param_server.py:553] For epoch: 53, median_reward: 330.3068469636166, dev: 660.6136939272332
2021-08-18:15:38:37,403 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0928, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:38:37,405 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 568.8193, eval_time 0.6199, test_loss 2.0928, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:38:37,406 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2371, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:38:37,407 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 568.8245, eval_time 0.6221, test_loss 2.2371, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:38:37,469 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:37,476 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:37,514 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:37,529 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:37,571 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1625, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:38:37,572 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 568.992, eval_time 0.7872, test_loss 2.1625, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:38:37,640 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:37,667 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:38,460 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:38,474 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:39,607 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:39,625 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:40,32 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:40,44 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:41,229 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:41,263 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:41,935 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:41,948 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:42,280 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:42,291 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:42,527 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:42,554 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:43,368 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:43,396 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:43,508 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:43,526 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:43,875 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:43,896 INFO     [learner.py:606] ====Pushing takes 0.019749879837036133 s
2021-08-18:15:38:43,922 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:43,929 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:43,930 INFO     [param_server.py:410] Lock worker 1 with localStep 53 , while globalStep is 52

2021-08-18:15:38:44,225 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:44,246 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:44,292 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:44,304 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:46,919 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:46,928 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:38:46,934 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:46,946 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:47,593 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:47,606 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:38:48,147 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:38:48,162 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:38:48,802 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:38:48,837 INFO     [learner.py:606] ====Pushing takes 0.03363156318664551 s
2021-08-18:15:38:48,879 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:48,887 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:48,888 INFO     [param_server.py:410] Lock worker 2 with localStep 53 , while globalStep is 52

2021-08-18:15:38:49,80 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:38:49,89 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:49,723 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:49,732 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:38:50,297 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:38:50,334 INFO     [learner.py:606] ====Pushing takes 0.03562593460083008 s
2021-08-18:15:38:50,369 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:50,377 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:50,378 INFO     [param_server.py:381] ====After aggregation in epoch: 52, virtual_clock: 1438.0770918676487, top_1: : 58.1801 % (1803.0), top_5: : 100.0 % (3099.0), test loss: 2.1641476353009543, test len: 3099.0
2021-08-18:15:38:50,378 INFO     [param_server.py:410] Lock worker 3 with localStep 53 , while globalStep is 53

2021-08-18:15:38:50,379 INFO     [param_server.py:441] ====Epoch 54 completes 20 clients with loss 4.242438102533346, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:38:50,379 INFO     [param_server.py:450] ====Start to sample for epoch 54, global virtualClock: 1438.0770918676487, round_duration: 35.23851470161326
2021-08-18:15:38:50,380 INFO     [oort.py:208] Training selector: Pacer 52: lastExploitationUtil 251.43377724894742, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:38:50,396 INFO     [oort.py:321] scores are 26,{5: 0.013963272149986487, 6: 0.049589497021449935, 7: 0.08634337427234869, 11: 0.03855321069651964, 14: 0.006136761315585587, 27: 0.007686501268143698, 35: 0.004055603019694006, 50: 0.003686668884850007, 51: 0.152922596917129, 53: 0.07222358396064923, 58: 0.0033462815683343327, 59: 0.004747205099734649, 60: 0.0031614915948284033, 65: 0.0047288454254451676, 67: 0.0024310731048031334, 70: 0.005411211998056792, 71: 0.008699547703036388, 76: 0.003289550409457675, 79: 0.02340576005702883, 81: 0.022635823877114103, 84: 0.4119228693522079, 85: 0.009613827570849255, 86: 0.003110759131862066, 87: 0.12933940790430287, 93: 0.015867224737500497, 97: 0.11254482988609425, 98: 0.1465047959873699, 99: 0.01837079312913662, 104: 0.0028855945339932407, 105: 0.0200505779028373, 107: 0.007359887459414531, 110: 0.07710209987554804, 111: 0.005837914198100912, 119: 0.00429929028653163},[84, 51, 98, 87, 97, 7, 110, 53, 6, 11, 79, 81, 105, 99, 93, 5, 85, 71, 27, 107, 14, 111, 70, 59, 65, 119, 35, 50, 58, 76, 60, 86, 104, 67]
2021-08-18:15:38:50,411 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:50,412 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:50,412 INFO     [oort.py:398] At round 52, UCB exploited 34, augment_factor 1.2692307692307692, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1188.311916479605, 'duration': 26.145070720211294, 'time_stamp': 53, 'count': 48, 'status': True, 'gradient': 19.720418380159277}, [1.0, -5.660484160078497e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 53, 'count': 50, 'status': True, 'gradient': 20.948329968144293}, [8.415369677658452e-09, -5.660484160078497e-06]), ({'reward': 316.61645437674105, 'duration': 15.972045438625893, 'time_stamp': 53, 'count': 50, 'status': True, 'gradient': 20.746801383683245}, [0.2664360440066786, -5.660484160078497e-06])]
2021-08-18:15:38:50,413 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 11, 87, 85, 110, 71, 5, 79, 50, 105, 119, 107]
2021-08-18:15:38:50,753 INFO     [param_server.py:553] For epoch: 54, median_reward: 301.55149533221334, dev: 603.1029906644267
2021-08-18:15:38:51,339 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4856, Top-1 Accuracy: 566.0/1033 (0.5479), Top-5 Accuracy: 1.0
2021-08-18:15:38:51,342 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 582.7612, eval_time 0.5543, test_loss 2.4856, test_accuracy 0.5479, test_5_accuracy 1.0 

2021-08-18:15:38:51,348 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2528, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:38:51,349 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 582.7634, eval_time 0.5576, test_loss 2.2528, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:38:51,392 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3212, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:38:51,393 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 582.8104, eval_time 0.6018, test_loss 2.3212, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:38:51,407 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:51,429 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:51,438 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:51,447 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:51,464 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:51,478 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:52,788 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:52,809 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:54,9 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:54,29 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:54,248 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:54,260 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:54,537 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:54,558 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:55,620 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:55,708 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:56,236 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:56,250 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:56,281 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:56,291 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:56,515 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:56,531 INFO     [learner.py:606] ====Pushing takes 0.014665842056274414 s
2021-08-18:15:38:56,552 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:56,557 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:56,558 INFO     [param_server.py:410] Lock worker 1 with localStep 54 , while globalStep is 53

2021-08-18:15:38:56,678 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:56,691 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:57,774 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:57,784 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:58,414 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:58,430 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:58,583 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:58,594 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:00,315 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:00,329 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:01,9 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:01,23 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:01,32 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:39:01,43 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:01,602 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:01,611 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:02,248 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:02,278 INFO     [learner.py:606] ====Pushing takes 0.02898573875427246 s
2021-08-18:15:39:02,322 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:02,330 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:39:02,331 INFO     [param_server.py:410] Lock worker 3 with localStep 54 , while globalStep is 53

2021-08-18:15:39:03,44 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:03,71 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:39:03,865 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:39:03,879 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:39:04,317 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:39:04,350 INFO     [learner.py:606] ====Pushing takes 0.03178906440734863 s
2021-08-18:15:39:04,411 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:04,424 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:04,425 INFO     [param_server.py:381] ====After aggregation in epoch: 53, virtual_clock: 1473.6455581570624, top_1: : 55.6631 % (1725.0), top_5: : 100.0 % (3099.0), test loss: 2.3532039677655257, test len: 3099.0
2021-08-18:15:39:04,426 INFO     [param_server.py:410] Lock worker 2 with localStep 54 , while globalStep is 54

2021-08-18:15:39:04,427 INFO     [param_server.py:441] ====Epoch 55 completes 20 clients with loss 3.868937843871309, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:39:04,428 INFO     [param_server.py:450] ====Start to sample for epoch 55, global virtualClock: 1473.6455581570624, round_duration: 35.56846628941357
2021-08-18:15:39:04,429 INFO     [oort.py:208] Training selector: Pacer 53: lastExploitationUtil 424.93685133275227, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:39:04,429 INFO     [oort.py:321] scores are 26,{5: 0.0698912692107266, 6: 0.184947239220723, 7: 0.08574610115605959, 11: 0.014746719965958008, 14: 0.009069687518892557, 27: 0.007705006565090664, 35: 0.004049355325728324, 50: 0.013957236865462944, 51: 0.19161902896033178, 53: 0.32419646283350345, 58: 0.003750896150934167, 59: 0.0038814919325603626, 60: 0.0031463589409952033, 65: 0.0047402301485801055, 67: 0.0024152447274054098, 70: 0.007997378323353314, 71: 0.008639369304743676, 76: 0.00181031580852213, 79: 0.010540805770845109, 81: 0.2522691337744814, 84: 0.49965487945322673, 85: 0.009547324717548721, 86: 0.00309586931176008, 87: 0.010208880821837034, 93: 0.015896134906752464, 97: 0.323215343621388, 98: 0.32437339489164035, 99: 0.01824371469430117, 104: 0.0028698231821774793, 105: 0.0036327871647591223, 107: 0.015030848159128238, 110: 0.10342719591533821, 111: 0.008628013184154456, 119: 0.012989983056310564},[84, 98, 53, 97, 81, 51, 6, 110, 7, 5, 99, 93, 107, 11, 50, 119, 79, 87, 85, 14, 71, 111, 70, 27, 65, 35, 59, 58, 105, 60, 86, 104, 67, 76]
2021-08-18:15:39:04,431 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:04,431 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:04,432 INFO     [oort.py:398] At round 53, UCB exploited 34, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1111.4369291357616, 'duration': 15.972045438625893, 'time_stamp': 54, 'count': 51, 'status': True, 'gradient': 20.753944721645503}, [0.9273943446212283, -5.555658438119229e-06]), ({'reward': 756.3874800666854, 'duration': 13.411352670399307, 'time_stamp': 54, 'count': 51, 'status': True, 'gradient': 17.877887636110504}, [0.6311347889696592, -5.555658438119229e-06]), ({'reward': 0.01, 'duration': 19.55790138125729, 'time_stamp': 54, 'count': 50, 'status': True, 'gradient': 19.727151718091488}, [8.344177309057547e-09, -5.555658438119229e-06])]
2021-08-18:15:39:04,433 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 85, 110, 71, 5, 27, 79, 50, 119, 107]
2021-08-18:15:39:04,772 INFO     [param_server.py:553] For epoch: 55, median_reward: 331.29654507173143, dev: 662.5930901434629
2021-08-18:15:39:05,413 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1846, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:39:05,414 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 596.8312, eval_time 0.6071, test_loss 2.1846, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:39:05,422 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4152, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:39:05,423 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 596.8371, eval_time 0.6161, test_loss 2.4152, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:39:05,449 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9357, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:39:05,450 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 596.8701, eval_time 0.6443, test_loss 1.9357, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:39:05,485 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:39:05,494 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:05,508 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:39:05,517 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:05,521 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:39:05,536 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:06,661 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:06,676 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:07,941 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:07,951 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:08,248 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:08,258 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:08,581 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:08,600 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:09,905 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:09,925 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:10,352 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:10,362 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:10,623 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:10,646 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:10,744 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:10,758 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:11,321 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:11,335 INFO     [learner.py:606] ====Pushing takes 0.012523174285888672 s
2021-08-18:15:39:11,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:11,362 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:11,366 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:11,366 INFO     [param_server.py:410] Lock worker 1 with localStep 55 , while globalStep is 54

2021-08-18:15:39:11,371 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:11,951 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:11,961 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:39:13,840 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:13,868 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:14,688 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:39:14,704 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:16,598 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:16,610 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:17,392 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:17,406 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:17,858 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:17,869 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:18,40 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:18,69 INFO     [learner.py:606] ====Pushing takes 0.028127670288085938 s
2021-08-18:15:39:18,121 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:18,128 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:39:18,129 INFO     [param_server.py:410] Lock worker 3 with localStep 55 , while globalStep is 54

2021-08-18:15:39:18,546 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:18,556 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:39:19,37 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:39:19,46 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:39:19,713 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:39:19,750 INFO     [learner.py:606] ====Pushing takes 0.03621339797973633 s
2021-08-18:15:39:19,806 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:19,815 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:19,816 INFO     [param_server.py:381] ====After aggregation in epoch: 54, virtual_clock: 1515.755715408826, top_1: : 57.567 % (1784.0), top_5: : 100.0 % (3099.0), test loss: 2.1784972239423683, test len: 3099.0
2021-08-18:15:39:19,817 INFO     [param_server.py:410] Lock worker 2 with localStep 55 , while globalStep is 55

2021-08-18:15:39:19,817 INFO     [param_server.py:441] ====Epoch 56 completes 20 clients with loss 2.9688263728863094, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 93: 0, 97: 0, 98: 0, 99: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:39:19,817 INFO     [param_server.py:450] ====Start to sample for epoch 56, global virtualClock: 1515.755715408826, round_duration: 42.110157251763596
2021-08-18:15:39:19,818 INFO     [oort.py:208] Training selector: Pacer 54: lastExploitationUtil 382.6783131618933, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:39:19,819 INFO     [oort.py:321] scores are 26,{5: 0.007926146396116702, 6: 0.19924899048959405, 7: 0.15038539221468217, 11: 0.014646399856673436, 14: 0.006427689085091038, 27: 0.08347635957917578, 50: 0.008767224372702572, 51: 0.04789700826627169, 53: 0.05667441769982506, 58: 0.00265826073924247, 59: 0.002750813991862151, 60: 0.0025482483660427915, 65: 0.004751375414754128, 67: 0.0018437088995822977, 70: 0.0056677433760847435, 71: 0.008580596745503221, 76: 0.0013892119881978744, 79: 0.048433277678306984, 81: 0.09167557056526028, 84: 0.4336664126776457, 85: 0.026098674493910713, 86: 0.002507356618593337, 87: 0.010232884016797159, 93: 0.029442447732742367, 97: 0.1108021559232949, 98: 0.03853435223338713, 104: 0.002271741983139269, 105: 0.0036413286004058024, 107: 0.007539142390094692, 110: 0.00915481068561744, 111: 0.006114674409045443, 119: 0.01620977561487954},[84, 6, 7, 97, 81, 27, 53, 79, 51, 98, 93, 85, 119, 11, 87, 110, 50, 71, 5, 107, 14, 111, 70, 65, 105, 59, 58, 60, 86, 104, 67, 76]
2021-08-18:15:39:19,821 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:19,821 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:19,822 INFO     [oort.py:398] At round 54, UCB exploited 32, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 446.16680111775275, 'duration': 17.619275735353515, 'time_stamp': 55, 'count': 51, 'status': True, 'gradient': 21.374053131894943}, [0.2645297363553661, -5.4546446299023665e-06]), ({'reward': 110.01469213954681, 'duration': 5.8943907365129, 'time_stamp': 55, 'count': 52, 'status': True, 'gradient': 20.957964004321628}, [0.06522261709268123, -5.4546446299023665e-06]), ({'reward': 0.01, 'duration': 28.420902733732795, 'time_stamp': 55, 'count': 42, 'status': True, 'gradient': 20.44649541804247}, [5.929075378063406e-09, -5.4546446299023665e-06])]
2021-08-18:15:39:19,823 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 27, 65, 79, 50, 105, 119]
2021-08-18:15:39:20,175 INFO     [param_server.py:553] For epoch: 56, median_reward: 323.8570520732148, dev: 647.7141041464296
2021-08-18:15:39:20,762 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0767, Top-1 Accuracy: 586.0/1033 (0.5673), Top-5 Accuracy: 1.0
2021-08-18:15:39:20,763 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 612.1769, eval_time 0.5498, test_loss 2.0767, test_accuracy 0.5673, test_5_accuracy 1.0 

2021-08-18:15:39:20,832 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:20,840 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:20,843 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3312, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:39:20,844 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 612.2611, eval_time 0.6329, test_loss 2.3312, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:39:20,915 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:20,924 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:20,971 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1125, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:39:20,972 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 612.3917, eval_time 0.762, test_loss 2.1125, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:39:21,29 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:21,60 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:21,492 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:21,501 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:22,611 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:22,626 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:23,65 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:23,79 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:24,217 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:24,238 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:24,856 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:24,865 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:24,963 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:24,990 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:25,486 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:25,496 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:26,54 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:26,79 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:26,199 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:26,219 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:26,273 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:26,300 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:26,951 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:26,978 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:27,379 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:27,400 INFO     [learner.py:606] ====Pushing takes 0.019557476043701172 s
2021-08-18:15:39:27,425 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:27,432 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:27,432 INFO     [param_server.py:410] Lock worker 1 with localStep 56 , while globalStep is 55

2021-08-18:15:39:27,771 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:27,785 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:27,951 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:27,970 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:28,393 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:28,407 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:28,612 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:28,623 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:29,55 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:29,68 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:29,207 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:29,217 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:39:29,574 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:29,612 INFO     [learner.py:606] ====Pushing takes 0.03635764122009277 s
2021-08-18:15:39:29,658 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:29,667 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:29,667 INFO     [param_server.py:410] Lock worker 3 with localStep 56 , while globalStep is 55

2021-08-18:15:39:29,758 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:39:29,789 INFO     [learner.py:606] ====Pushing takes 0.029358625411987305 s
2021-08-18:15:39:29,823 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:29,832 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:29,832 INFO     [param_server.py:381] ====After aggregation in epoch: 55, virtual_clock: 1545.1066659593691, top_1: : 57.5024 % (1782.0), top_5: : 100.0 % (3099.0), test loss: 2.17343728851389, test len: 3099.0
2021-08-18:15:39:29,834 INFO     [param_server.py:410] Lock worker 2 with localStep 56 , while globalStep is 56

2021-08-18:15:39:29,834 INFO     [param_server.py:441] ====Epoch 57 completes 20 clients with loss 5.51927863881039, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:39:29,835 INFO     [param_server.py:450] ====Start to sample for epoch 57, global virtualClock: 1545.1066659593691, round_duration: 29.350950550543047
2021-08-18:15:39:29,835 INFO     [oort.py:208] Training selector: Pacer 55: lastExploitationUtil 538.1732805548493, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:39:29,836 INFO     [oort.py:321] scores are 26,{5: 0.007944355337717474, 6: 0.12857266205457826, 7: 0.4687235615881752, 11: 0.01454838514079974, 14: 0.007231502030905776, 27: 0.08036164013613867, 50: 0.025142397177628433, 51: 0.2904581187000412, 53: 0.1605408814886811, 58: 0.0023413048702045696, 59: 0.003094816302632881, 60: 0.0013345564342580548, 65: 0.02603646117864325, 67: 0.0016129929793661033, 70: 0.006376521513754749, 71: 0.03145907771945227, 76: 0.0012192632762735617, 79: 0.0037755716061044033, 81: 0.027017553871882215, 84: 0.03892921049700551, 85: 0.011783576240190982, 86: 0.0022706036007882576, 87: 0.021878913741301846, 93: 0.045355058642542856, 97: 0.22875047978286706, 98: 0.18132072366105176, 104: 0.0020307692183015205, 105: 0.0035839282857119204, 107: 0.008672822417717812, 110: 0.11513134712928974, 111: 0.006879343387953154, 119: 0.002881521756730538},[7, 51, 97, 98, 53, 6, 110, 27, 93, 84, 71, 81, 65, 50, 87, 11, 85, 107, 5, 14, 111, 70, 79, 105, 59, 119, 58, 86, 104, 67, 60, 76]
2021-08-18:15:39:29,837 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:29,838 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:29,838 INFO     [oort.py:398] At round 55, UCB exploited 32, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 281.2754157969828, 'duration': 11.90395711384456, 'time_stamp': 56, 'count': 53, 'status': True, 'gradient': 20.6652133177402}, [0.13927304110350994, -5.35723852211647e-06]), ({'reward': 2019.535258985416, 'duration': 27.689063957948644, 'time_stamp': 56, 'count': 49, 'status': True, 'gradient': 20.25507620037605}, [1.0, -5.35723852211647e-06]), ({'reward': 355.984464359449, 'duration': 21.635252629006885, 'time_stamp': 56, 'count': 6, 'status': True, 'gradient': 21.386713605451686}, [0.17626641261997483, -5.35723852211647e-06])]
2021-08-18:15:39:29,839 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:39:30,207 INFO     [param_server.py:553] For epoch: 57, median_reward: 358.4736433040575, dev: 716.947286608115
2021-08-18:15:39:30,799 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.232, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:39:30,803 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 622.2232, eval_time 0.5623, test_loss 2.232, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:39:30,882 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:30,898 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2568, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:39:30,899 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 622.3158, eval_time 0.6566, test_loss 2.2568, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:39:30,905 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:30,967 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:30,982 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:31,18 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1484, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:39:31,19 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 622.4334, eval_time 0.7726, test_loss 2.1484, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:39:31,91 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:31,98 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:31,624 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:31,634 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:32,767 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:32,781 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:33,242 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:33,261 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:34,1 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:34,28 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:34,337 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:34,346 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:34,962 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:34,972 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:35,115 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:35,142 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:35,545 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:35,557 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:35,688 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:35,715 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:35,875 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:35,890 INFO     [learner.py:606] ====Pushing takes 0.01412057876586914 s
2021-08-18:15:39:35,916 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:35,921 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:35,922 INFO     [param_server.py:410] Lock worker 1 with localStep 57 , while globalStep is 56

2021-08-18:15:39:36,95 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:36,109 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:36,128 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:36,137 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:37,407 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:37,426 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:37,687 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:37,701 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:37,987 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:38,5 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:38,364 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:38,377 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:38,721 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:38,736 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:38,873 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:38,887 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:39,338 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:39,366 INFO     [learner.py:606] ====Pushing takes 0.026530981063842773 s
2021-08-18:15:39:39,413 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:39,422 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:39,423 INFO     [param_server.py:410] Lock worker 2 with localStep 57 , while globalStep is 56

2021-08-18:15:39:39,429 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:39,464 INFO     [learner.py:606] ====Pushing takes 0.03340911865234375 s
2021-08-18:15:39:39,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:39,515 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:39,516 INFO     [param_server.py:381] ====After aggregation in epoch: 56, virtual_clock: 1574.0301669466378, top_1: : 59.019 % (1829.0), top_5: : 100.0 % (3099.0), test loss: 2.2123971735989607, test len: 3099.0
2021-08-18:15:39:39,517 INFO     [param_server.py:410] Lock worker 3 with localStep 57 , while globalStep is 57

2021-08-18:15:39:39,518 INFO     [param_server.py:441] ====Epoch 58 completes 20 clients with loss 6.753273624876304, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:39:39,518 INFO     [param_server.py:450] ====Start to sample for epoch 58, global virtualClock: 1574.0301669466378, round_duration: 28.923500987268568
2021-08-18:15:39:39,519 INFO     [oort.py:208] Training selector: Pacer 56: lastExploitationUtil 428.44854860658376, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:39:39,520 INFO     [oort.py:321] scores are 26,{5: 0.030306151422766974, 6: 0.19009312989499177, 7: 0.2971414247449885, 11: 0.03700667381179729, 14: 0.0058491430782049054, 27: 0.09558881114699802, 50: 0.003588142052587384, 51: 0.13651082708467635, 53: 0.1924054191418592, 58: 0.0022499494938013963, 59: 0.002503217627195143, 60: 0.0012769225621244414, 65: 0.023679995736669818, 67: 0.0015463520639563235, 70: 0.0051575988661558365, 71: 0.017284994399949273, 76: 0.0011702230939915612, 79: 0.0037507099829136984, 81: 0.022030877761277223, 84: 0.03867286696456572, 85: 0.009356896447914037, 86: 0.0022031781001899528, 87: 0.01000525733909995, 93: 0.13983727727539788, 97: 0.17496924854643872, 98: 0.03802443232000403, 105: 0.003560328607602832, 107: 0.007014943644666378, 110: 0.027746582921185637, 111: 0.00556430235216305, 119: 0.0028879926937986533},[7, 53, 6, 97, 93, 51, 27, 84, 98, 11, 5, 110, 65, 81, 71, 87, 85, 107, 14, 111, 70, 79, 50, 105, 119, 59, 58, 86, 67, 60, 76]
2021-08-18:15:39:39,521 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:39:39,521 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:39,522 INFO     [oort.py:398] At round 56, UCB exploited 31, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 995.2454411670499, 'duration': 15.972045438625893, 'time_stamp': 57, 'count': 54, 'status': True, 'gradient': 20.77618537114158}, [0.4644171593740044, -5.263250232460223e-06]), ({'reward': 1543.4620011066258, 'duration': 21.635252629006885, 'time_stamp': 57, 'count': 7, 'status': True, 'gradient': 21.392398037922693}, [0.7202372039577979, -5.263250232460223e-06]), ({'reward': 456.69045435604534, 'duration': 5.8943907365129, 'time_stamp': 57, 'count': 54, 'status': True, 'gradient': 20.97808911815887}, [0.21310559601663204, -5.263250232460223e-06])]
2021-08-18:15:39:39,523 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 50, 105, 119]
2021-08-18:15:39:39,869 INFO     [param_server.py:553] For epoch: 58, median_reward: 335.6142499600358, dev: 671.2284999200716
2021-08-18:15:39:40,473 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1086, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:39:40,474 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 631.8936, eval_time 0.5705, test_loss 2.1086, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:39:40,530 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0845, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:39:40,532 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 631.9459, eval_time 0.6252, test_loss 2.0845, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:39:40,537 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1526, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:39:40,538 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 631.9553, eval_time 0.6345, test_loss 2.1526, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:39:40,540 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:40,563 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:40,592 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:40,596 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:40,604 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:40,617 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:41,236 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:41,248 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:42,356 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:42,367 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:42,800 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:42,810 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:43,402 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:43,423 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:44,44 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:44,58 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:44,447 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:44,467 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:44,710 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:44,746 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:44,988 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:44,999 INFO     [learner.py:606] ====Pushing takes 0.009871244430541992 s
2021-08-18:15:39:45,18 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:45,24 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:39:45,25 INFO     [param_server.py:410] Lock worker 1 with localStep 58 , while globalStep is 57

2021-08-18:15:39:45,363 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:45,377 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:45,774 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:45,786 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:45,954 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:45,964 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:46,971 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:46,983 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:47,460 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:47,469 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:47,496 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:47,505 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:48,31 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:48,45 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:48,58 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:48,72 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:48,566 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:48,576 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:49,41 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:49,76 INFO     [learner.py:606] ====Pushing takes 0.032877445220947266 s
2021-08-18:15:39:49,123 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:49,131 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:39:49,132 INFO     [param_server.py:410] Lock worker 3 with localStep 58 , while globalStep is 57

2021-08-18:15:39:49,282 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:49,292 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:39:49,885 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:39:49,919 INFO     [learner.py:606] ====Pushing takes 0.03304624557495117 s
2021-08-18:15:39:49,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:49,993 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:49,994 INFO     [param_server.py:381] ====After aggregation in epoch: 57, virtual_clock: 1603.7296850875366, top_1: : 57.8251 % (1792.0), top_5: : 100.0 % (3099.0), test loss: 2.115227511635533, test len: 3099.0
2021-08-18:15:39:49,995 INFO     [param_server.py:410] Lock worker 2 with localStep 58 , while globalStep is 58

2021-08-18:15:39:49,996 INFO     [param_server.py:441] ====Epoch 59 completes 20 clients with loss 4.718528139272588, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:39:49,996 INFO     [param_server.py:450] ====Start to sample for epoch 59, global virtualClock: 1603.7296850875366, round_duration: 29.6995181408989
2021-08-18:15:39:49,997 INFO     [oort.py:208] Training selector: Pacer 57: lastExploitationUtil 476.68545162108376, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:39:49,998 INFO     [oort.py:321] scores are 26,{5: 0.007770570560155085, 6: 0.047951405432769, 7: 0.5765018360665268, 11: 0.04687733550360243, 14: 0.006747652266986225, 27: 0.03331479722918689, 50: 0.0035648870226965687, 51: 0.046956877119471704, 53: 0.055562001972100414, 58: 0.0027905859891379425, 59: 0.002887746439276189, 60: 0.0013705714354603988, 65: 0.004529293801431125, 67: 0.0016550249632562245, 70: 0.00594987730956696, 71: 0.015393542779669223, 76: 0.0012503735853462911, 79: 0.0037589469433023577, 81: 0.10774034722507303, 84: 0.04181615645004548, 85: 0.07651940326598355, 87: 0.013896501990931322, 93: 0.11923473348077579, 97: 0.3456588670999197, 98: 0.27657868629413784, 105: 0.0035372538388290524, 107: 0.008092535907198316, 110: 0.05060497001726756, 111: 0.005949328913591414, 119: 0.014461415413241283},[7, 97, 98, 93, 81, 85, 53, 110, 6, 51, 11, 84, 27, 71, 119, 87, 107, 5, 14, 70, 111, 65, 79, 50, 105, 59, 58, 67, 60, 76]
2021-08-18:15:39:49,999 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:50,0 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:50,1 INFO     [oort.py:398] At round 57, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 58, 'count': 52, 'status': True, 'gradient': 26.84974308476809}, [5.1207164150694785e-09, -5.1725029741892145e-06]), ({'reward': 962.7867006274196, 'duration': 5.8943907365129, 'time_stamp': 58, 'count': 55, 'status': True, 'gradient': 20.982242204536256}, [0.49301065061566257, -5.1725029741892145e-06]), ({'reward': 369.25755686011644, 'duration': 21.753601635627824, 'time_stamp': 58, 'count': 52, 'status': True, 'gradient': 20.985972914647274}, [0.189081207684514, -5.1725029741892145e-06])]
2021-08-18:15:39:50,1 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:39:50,372 INFO     [param_server.py:553] For epoch: 59, median_reward: 344.5654166605151, dev: 689.1308333210302
2021-08-18:15:39:50,955 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.291, Top-1 Accuracy: 578.0/1033 (0.5595), Top-5 Accuracy: 1.0
2021-08-18:15:39:50,958 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 642.3776, eval_time 0.5505, test_loss 2.291, test_accuracy 0.5595, test_5_accuracy 1.0 

2021-08-18:15:39:51,24 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:51,34 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3515, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:39:51,35 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 642.4523, eval_time 0.627, test_loss 2.3515, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:39:51,46 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:51,80 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2705, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:39:51,81 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 642.4951, eval_time 0.6682, test_loss 2.2705, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:39:51,124 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:51,136 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:51,151 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:51,165 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:52,230 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:52,241 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:53,391 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:53,409 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:54,73 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:54,75 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:54,87 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:54,87 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:55,107 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:55,121 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:55,510 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:55,520 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:55,675 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:55,689 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:55,974 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:55,988 INFO     [learner.py:606] ====Pushing takes 0.013213396072387695 s
2021-08-18:15:39:56,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:56,17 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:56,18 INFO     [param_server.py:410] Lock worker 1 with localStep 59 , while globalStep is 58

2021-08-18:15:39:56,237 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:56,247 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:57,393 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:57,402 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:58,67 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:58,76 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:58,294 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:58,314 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:00,405 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:00,419 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:00,536 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:00,546 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:01,112 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:01,125 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:01,183 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:01,195 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:01,735 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:01,749 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:01,750 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:01,759 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:02,429 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:02,462 INFO     [learner.py:606] ====Pushing takes 0.031618356704711914 s
2021-08-18:15:40:02,478 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:02,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:02,516 INFO     [learner.py:606] ====Pushing takes 0.036692142486572266 s
2021-08-18:15:40:02,518 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:02,518 INFO     [param_server.py:410] Lock worker 2 with localStep 59 , while globalStep is 58

2021-08-18:15:40:02,553 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:02,582 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:02,584 INFO     [param_server.py:381] ====After aggregation in epoch: 58, virtual_clock: 1642.1257066463222, top_1: : 56.5344 % (1752.0), top_5: : 100.0 % (3099.0), test loss: 2.304320145536352, test len: 3099.0
2021-08-18:15:40:02,585 INFO     [param_server.py:410] Lock worker 3 with localStep 59 , while globalStep is 59

2021-08-18:15:40:02,585 INFO     [param_server.py:441] ====Epoch 60 completes 20 clients with loss 6.028933331147163, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:02,586 INFO     [param_server.py:450] ====Start to sample for epoch 60, global virtualClock: 1642.1257066463222, round_duration: 38.39602155878561
2021-08-18:15:40:02,587 INFO     [oort.py:208] Training selector: Pacer 58: lastExploitationUtil 572.7478537964366, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:40:02,587 INFO     [oort.py:321] scores are 26,{5: 0.024720341039541356, 6: 0.3181527299190499, 7: 0.22168793164886785, 11: 0.15766900509207732, 14: 0.009132437946839999, 27: 0.09549381061011446, 50: 0.012914556733970775, 51: 0.04665726626424773, 53: 0.05870536269877339, 58: 0.0032679729720725037, 59: 0.003908346802624557, 60: 0.0016110024578140747, 65: 0.05738862473436471, 67: 0.0019337961894483958, 70: 0.008052709767926533, 71: 0.02839084333318156, 76: 0.0014558714105507825, 79: 0.029852415601451722, 81: 0.039925783197787904, 84: 0.03817707002911198, 85: 0.054973510499286594, 87: 0.009876987150812718, 93: 0.014423816517394288, 97: 0.335039578609689, 98: 0.2771601780007535, 105: 0.01763680042707429, 107: 0.010952636425361017, 110: 0.039290974869955635, 111: 0.008687707800811763, 119: 0.015102367320499523},[97, 6, 98, 7, 11, 27, 53, 65, 85, 51, 81, 110, 84, 79, 71, 5, 105, 119, 93, 50, 107, 87, 14, 111, 70, 59, 58, 67, 60, 76]
2021-08-18:15:40:02,588 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:40:02,589 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:02,590 INFO     [oort.py:398] At round 58, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 220.4747672510863, 'duration': 5.8943907365129, 'time_stamp': 59, 'count': 56, 'status': True, 'gradient': 20.98995608534296}, [0.13872946735777633, -5.0848319463041785e-06]), ({'reward': 841.6011976219302, 'duration': 13.411352670399307, 'time_stamp': 59, 'count': 56, 'status': True, 'gradient': 17.91009139239229}, [0.5295789260404536, -5.0848319463041785e-06]), ({'reward': 1549.324879191112, 'duration': 38.73261129255839, 'time_stamp': 59, 'count': 41, 'status': True, 'gradient': 21.40768356048475}, [0.9749204930915836, -5.0848319463041785e-06])]
2021-08-18:15:40:02,590 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:02,934 INFO     [param_server.py:553] For epoch: 60, median_reward: 369.753303080948, dev: 739.506606161896
2021-08-18:15:40:03,611 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1959, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:40:03,612 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 655.0294, eval_time 0.6448, test_loss 2.1959, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:40:03,613 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1993, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:40:03,614 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 655.0284, eval_time 0.6468, test_loss 2.1993, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:40:03,650 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0808, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:40:03,651 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 655.0704, eval_time 0.6835, test_loss 2.0808, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:40:03,671 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:40:03,680 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:03,685 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:40:03,693 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:03,703 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:40:03,718 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:04,795 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:04,806 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:05,941 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:05,955 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:06,437 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:06,448 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:06,841 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:06,861 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:08,73 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:08,85 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:08,223 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:08,244 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:08,550 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:08,564 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:09,27 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:09,53 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:09,607 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:09,634 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:09,719 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:09,735 INFO     [learner.py:606] ====Pushing takes 0.014299392700195312 s
2021-08-18:15:40:09,772 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:09,777 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:09,778 INFO     [param_server.py:410] Lock worker 1 with localStep 60 , while globalStep is 59

2021-08-18:15:40:10,388 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:10,415 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:10,780 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:10,799 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:12,708 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:12,726 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:13,104 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:13,125 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:13,362 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:13,376 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:13,704 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:13,715 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:13,884 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:13,893 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:14,296 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:14,307 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:14,447 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:14,483 INFO     [learner.py:606] ====Pushing takes 0.035324811935424805 s
2021-08-18:15:40:14,544 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:14,553 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:14,553 INFO     [param_server.py:410] Lock worker 3 with localStep 60 , while globalStep is 59

2021-08-18:15:40:16,14 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:16,46 INFO     [learner.py:606] ====Pushing takes 0.030348777770996094 s
2021-08-18:15:40:16,88 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:16,96 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:16,97 INFO     [param_server.py:381] ====After aggregation in epoch: 59, virtual_clock: 1676.7667415273108, top_1: : 57.1797 % (1772.0), top_5: : 100.0 % (3099.0), test loss: 2.1586618136476585, test len: 3099.0
2021-08-18:15:40:16,98 INFO     [param_server.py:410] Lock worker 2 with localStep 60 , while globalStep is 60

2021-08-18:15:40:16,99 INFO     [param_server.py:441] ====Epoch 61 completes 20 clients with loss 4.846210764854157, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:16,99 INFO     [param_server.py:450] ====Start to sample for epoch 61, global virtualClock: 1676.7667415273108, round_duration: 34.64103488098859
2021-08-18:15:40:16,100 INFO     [oort.py:208] Training selector: Pacer 59: lastExploitationUtil 370.9690215042488, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:40:16,101 INFO     [oort.py:321] scores are 26,{5: 0.007672477786780416, 6: 0.04734608484405542, 7: 0.2203385330812655, 11: 0.10786693372328461, 14: 0.006296578162259287, 27: 0.09544784826112213, 50: 0.0035198852236502072, 51: 0.046364111083824176, 53: 0.054860608062155224, 58: 0.0026040379829710292, 59: 0.002694703349882269, 60: 0.0015555316215034565, 65: 0.025087064529034146, 67: 0.0018696533800433707, 70: 0.005552133698240239, 71: 0.02759454590835817, 76: 0.001408668179794149, 79: 0.008971721339963955, 81: 0.021611786813190873, 84: 0.23882844130559194, 85: 0.03768094952307417, 87: 0.05491981650785936, 93: 0.10372405713552815, 97: 0.18797478956373978, 98: 0.03730109775457671, 105: 0.003492600870749703, 107: 0.007551557616546054, 110: 0.008750849812194435, 111: 0.008383081770253977, 119: 0.010412689012749297},[84, 7, 97, 11, 93, 27, 87, 53, 6, 51, 85, 98, 71, 65, 81, 119, 79, 110, 111, 5, 107, 14, 70, 50, 105, 59, 58, 67, 60, 76]
2021-08-18:15:40:16,102 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:40:16,103 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:16,103 INFO     [oort.py:398] At round 59, UCB exploited 30, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 425.3619301377962, 'duration': 27.035726288496562, 'time_stamp': 60, 'count': 53, 'status': True, 'gradient': 14.826450983295645}, [0.2559816121002405, -5.0000833347222494e-06]), ({'reward': 725.378678267828, 'duration': 13.298442137908651, 'time_stamp': 60, 'count': 57, 'status': True, 'gradient': 20.798435181041057}, [0.43653508699098104, -5.0000833347222494e-06]), ({'reward': 905.2182168225002, 'duration': 21.753601635627824, 'time_stamp': 60, 'count': 54, 'status': True, 'gradient': 21.000282694510215}, [0.5447645568828421, -5.0000833347222494e-06])]
2021-08-18:15:40:16,104 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:16,455 INFO     [param_server.py:541] Handle Wight 0.04085898399353027 | Send 0.35518693923950195
2021-08-18:15:40:16,455 INFO     [param_server.py:553] For epoch: 61, median_reward: 326.83491103233166, dev: 653.6698220646633
2021-08-18:15:40:17,143 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1878, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:40:17,144 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 668.5583, eval_time 0.664, test_loss 2.1878, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:40:17,151 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2879, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:40:17,152 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 668.5687, eval_time 0.6736, test_loss 2.2879, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:40:17,212 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:17,222 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:17,224 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2502, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:40:17,225 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 668.6442, eval_time 0.7468, test_loss 2.2502, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:40:17,229 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:17,238 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:17,290 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:17,311 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:18,378 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:18,406 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:19,548 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:19,557 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:19,760 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:19,783 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:20,713 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:20,742 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:21,916 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:21,934 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:21,976 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:21,986 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:22,263 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:22,290 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:23,73 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:23,90 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:23,100 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:23,111 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:23,726 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:23,733 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:23,741 INFO     [learner.py:606] ====Pushing takes 0.01326298713684082 s
2021-08-18:15:40:23,743 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:23,765 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:23,773 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:23,773 INFO     [param_server.py:410] Lock worker 1 with localStep 61 , while globalStep is 60

2021-08-18:15:40:24,698 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:24,709 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:26,32 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:26,42 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:26,700 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:26,711 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:26,897 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:26,908 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:27,393 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:27,402 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:27,532 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:27,545 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:27,909 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:27,947 INFO     [learner.py:606] ====Pushing takes 0.034461259841918945 s
2021-08-18:15:40:28,2 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:28,9 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:28,10 INFO     [param_server.py:410] Lock worker 3 with localStep 61 , while globalStep is 60

2021-08-18:15:40:28,166 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:28,176 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:28,843 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:28,874 INFO     [learner.py:606] ====Pushing takes 0.029641151428222656 s
2021-08-18:15:40:28,920 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:28,929 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:28,930 INFO     [param_server.py:381] ====After aggregation in epoch: 60, virtual_clock: 1715.1627630860964, top_1: : 57.3733 % (1778.0), top_5: : 100.0 % (3099.0), test loss: 2.241967717806498, test len: 3099.0
2021-08-18:15:40:28,931 INFO     [param_server.py:410] Lock worker 2 with localStep 61 , while globalStep is 61

2021-08-18:15:40:28,931 INFO     [param_server.py:441] ====Epoch 62 completes 20 clients with loss 7.2935275232900185, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:28,932 INFO     [param_server.py:450] ====Start to sample for epoch 62, global virtualClock: 1715.1627630860964, round_duration: 38.39602155878561
2021-08-18:15:40:28,933 INFO     [oort.py:208] Training selector: Pacer 60: lastExploitationUtil 532.5822836552402, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:40:28,933 INFO     [oort.py:321] scores are 26,{5: 0.05287021332305803, 6: 0.047053072638580946, 7: 0.08192704716766282, 11: 0.038920674274910236, 14: 0.006987840535841278, 27: 0.020559072880556965, 50: 0.03463725112172641, 51: 0.15825528599526764, 53: 0.4808569763894436, 58: 0.0028899192077600066, 59: 0.0023081896469551973, 60: 0.0013134641365206091, 65: 0.008625844539083148, 67: 0.0015892669780862632, 70: 0.006161668118331197, 71: 0.02001122618481197, 76: 0.00120210976563776, 79: 0.008193869903868709, 81: 0.06457562761202609, 84: 0.30036236243315806, 85: 0.018632916497879293, 87: 0.12881360300020028, 93: 0.03593404322308795, 97: 0.026136631925650546, 98: 0.03707025127686506, 105: 0.009757893291164383, 107: 0.008380596422661937, 110: 0.05180339142100633, 111: 0.006647547685233732, 119: 0.011555833739430733},[53, 84, 51, 87, 7, 81, 5, 110, 6, 11, 98, 93, 50, 97, 27, 71, 85, 119, 105, 65, 107, 79, 14, 111, 70, 58, 59, 67, 60, 76]
2021-08-18:15:40:28,934 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:40:28,935 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:28,935 INFO     [oort.py:398] At round 60, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 61, 'count': 58, 'status': True, 'gradient': 20.701472710317557}, [4.8315826608516484e-09, -4.918113411695278e-06]), ({'reward': 412.8294511875968, 'duration': 12.029357192292537, 'time_stamp': 61, 'count': 55, 'status': True, 'gradient': 26.876553185401185}, [0.1994571350736194, -4.918113411695278e-06]), ({'reward': 1325.9541893720102, 'duration': 11.058674649423494, 'time_stamp': 61, 'count': 58, 'status': True, 'gradient': 20.08392925894866}, [0.6406409002942887, -4.918113411695278e-06])]
2021-08-18:15:40:28,946 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:29,282 INFO     [param_server.py:553] For epoch: 62, median_reward: 360.1697557730596, dev: 720.3395115461192
2021-08-18:15:40:29,819 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2976, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:40:29,820 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 681.2375, eval_time 0.5053, test_loss 2.2976, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:40:29,857 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1489, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:40:29,858 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 681.2721, eval_time 0.5385, test_loss 2.1489, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:40:29,890 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:29,898 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:29,939 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:29,952 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:29,958 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1841, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:40:29,962 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 681.3813, eval_time 0.6467, test_loss 2.1841, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:40:30,17 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:30,45 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:30,980 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:30,989 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:31,990 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:31,999 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:32,648 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:32,657 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:33,420 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:33,447 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:34,188 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:34,202 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:34,828 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:34,841 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:34,875 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:34,902 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:35,562 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:35,589 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:35,913 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:35,931 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:36,170 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:36,186 INFO     [learner.py:606] ====Pushing takes 0.014674186706542969 s
2021-08-18:15:40:36,221 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:36,226 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:36,227 INFO     [param_server.py:410] Lock worker 1 with localStep 62 , while globalStep is 61

2021-08-18:15:40:36,553 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:36,567 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:37,148 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:37,160 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:38,644 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:38,655 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:39,250 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:39,265 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:39,291 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:39,300 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:39,873 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:39,880 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:39,883 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:39,895 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:40,476 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:40,492 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:40,510 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:40,511 INFO     [learner.py:606] ====Pushing takes 0.03339385986328125 s
2021-08-18:15:40:40,562 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:40,577 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:40,585 INFO     [param_server.py:410] Lock worker 3 with localStep 62 , while globalStep is 61

2021-08-18:15:40:42,104 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:42,136 INFO     [learner.py:606] ====Pushing takes 0.02995443344116211 s
2021-08-18:15:40:42,172 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:42,181 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:42,181 INFO     [param_server.py:381] ====After aggregation in epoch: 61, virtual_clock: 1749.803797967085, top_1: : 59.1481 % (1833.0), top_5: : 100.0 % (3099.0), test loss: 2.210207215061894, test len: 3099.0
2021-08-18:15:40:42,182 INFO     [param_server.py:410] Lock worker 2 with localStep 62 , while globalStep is 62

2021-08-18:15:40:42,183 INFO     [param_server.py:441] ====Epoch 63 completes 20 clients with loss 6.785720713351239, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:42,183 INFO     [param_server.py:450] ====Start to sample for epoch 63, global virtualClock: 1749.803797967085, round_duration: 34.64103488098859
2021-08-18:15:40:42,183 INFO     [oort.py:208] Training selector: Pacer 61: lastExploitationUtil 409.95328590220674, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:40:42,184 INFO     [oort.py:321] scores are 26,{5: 0.0586040739872817, 6: 0.04676618649812717, 7: 0.4376796987810076, 11: 0.01400400708976633, 14: 0.007969348565158168, 27: 0.024351249837729527, 50: 0.0034767734093201505, 51: 0.4888727508770188, 53: 0.059628856382578824, 58: 0.004079905192664148, 59: 0.0034105874208993654, 60: 0.0018500755832966177, 65: 0.01418872463574771, 67: 0.002211264356925217, 70: 0.007027132448993669, 71: 0.008204250794348104, 76: 0.0016605337172028898, 79: 0.01390963216554398, 81: 0.029633627803206674, 84: 0.12265834137092099, 85: 0.04071689519712419, 87: 0.12875413067602945, 93: 0.01415763537381576, 97: 0.12252901557575559, 98: 0.34718152298683447, 105: 0.023687267680897895, 107: 0.009557730136162856, 110: 0.09745399967637595, 111: 0.0075812583780949135, 119: 0.013178959445080051},[51, 7, 98, 87, 84, 97, 110, 53, 5, 6, 85, 81, 27, 105, 65, 93, 11, 79, 119, 107, 71, 14, 111, 70, 58, 50, 59, 67, 60, 76]
2021-08-18:15:40:42,185 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:40:42,185 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:42,186 INFO     [oort.py:398] At round 61, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1057.2677096290608, 'duration': 12.029357192292537, 'time_stamp': 62, 'count': 56, 'status': True, 'gradient': 26.88866463147563}, [0.7878076231753112, -4.838787722382623e-06]), ({'reward': 42.42962493404801, 'duration': 17.619275735353515, 'time_stamp': 62, 'count': 58, 'status': True, 'gradient': 18.1350436326523}, [0.03160867133236128, -4.838787722382623e-06]), ({'reward': 248.42970573550195, 'duration': 13.298442137908651, 'time_stamp': 62, 'count': 59, 'status': True, 'gradient': 20.813864731697564}, [0.18510807929795592, -4.838787722382623e-06])]
2021-08-18:15:40:42,186 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:42,545 INFO     [param_server.py:553] For epoch: 63, median_reward: 334.94681976690805, dev: 669.8936395338161
2021-08-18:15:40:43,159 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4304, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:40:43,160 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 694.577, eval_time 0.5807, test_loss 2.4304, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:40:43,173 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6286, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:40:43,174 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 694.588, eval_time 0.5946, test_loss 2.6286, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:40:43,232 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:43,240 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:43,243 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:43,250 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:43,254 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1903, Top-1 Accuracy: 592.0/1033 (0.5731), Top-5 Accuracy: 1.0
2021-08-18:15:40:43,272 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 694.6921, eval_time 0.6934, test_loss 2.1903, test_accuracy 0.5731, test_5_accuracy 1.0 

2021-08-18:15:40:43,342 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:43,362 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:44,512 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:44,533 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:45,687 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:45,714 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:46,168 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:46,177 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:46,748 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:46,768 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:47,963 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:47,973 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:47,995 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:48,14 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:48,394 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:48,412 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:48,705 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:48,719 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:49,368 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:49,382 INFO     [learner.py:606] ====Pushing takes 0.013427734375 s
2021-08-18:15:40:49,407 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:49,412 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:49,413 INFO     [param_server.py:410] Lock worker 1 with localStep 63 , while globalStep is 62

2021-08-18:15:40:49,604 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:49,615 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:50,269 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:50,279 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:50,772 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:50,784 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:52,467 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:52,477 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:52,880 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:52,891 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:53,85 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:53,95 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:53,526 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:53,535 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:53,588 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:53,598 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:54,186 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:54,222 INFO     [learner.py:606] ====Pushing takes 0.034546613693237305 s
2021-08-18:15:40:54,257 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:54,269 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:54,272 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:54,280 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:54,281 INFO     [param_server.py:410] Lock worker 3 with localStep 63 , while globalStep is 62

2021-08-18:15:40:54,754 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:54,790 INFO     [learner.py:606] ====Pushing takes 0.034653663635253906 s
2021-08-18:15:40:54,832 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:54,839 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:54,840 INFO     [param_server.py:381] ====After aggregation in epoch: 62, virtual_clock: 1788.1998195258707, top_1: : 57.6315 % (1786.0), top_5: : 100.0 % (3099.0), test loss: 2.4164274533589682, test len: 3099.0
2021-08-18:15:40:54,841 INFO     [param_server.py:410] Lock worker 2 with localStep 63 , while globalStep is 63

2021-08-18:15:40:54,842 INFO     [param_server.py:441] ====Epoch 64 completes 20 clients with loss 6.15403922591867, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:54,842 INFO     [param_server.py:450] ====Start to sample for epoch 64, global virtualClock: 1788.1998195258707, round_duration: 38.39602155878561
2021-08-18:15:40:54,843 INFO     [oort.py:208] Training selector: Pacer 62: lastExploitationUtil 487.84998580927044, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:40:54,844 INFO     [oort.py:321] scores are 26,{5: 0.10060351522579328, 6: 0.15075038552522727, 7: 0.3268921769484001, 11: 0.08575759990401878, 14: 0.007291181387650469, 27: 0.03242482220500655, 50: 0.003455884164908723, 51: 0.11070277390106385, 53: 0.5858464486047975, 58: 0.003015370060515639, 59: 0.0027417678018964537, 60: 0.0014712981430142049, 65: 0.022804727038363847, 67: 0.0017724440977156537, 70: 0.006429144979887125, 71: 0.020668503641483406, 76: 0.001337220104761359, 79: 0.005913761005039315, 81: 0.021218825921157845, 84: 0.37314957873932575, 85: 0.05480792120165388, 87: 0.009636466421138221, 93: 0.014072573084505012, 97: 0.054982364247386506, 98: 0.15870726898991563, 105: 0.020196202088486284, 107: 0.008744396547246961, 110: 0.008591735631679379, 111: 0.006936116487990226, 119: 0.01205747032256468},[53, 84, 7, 98, 6, 51, 5, 11, 97, 85, 27, 65, 81, 71, 105, 93, 119, 87, 107, 110, 14, 111, 70, 79, 50, 58, 59, 67, 60, 76]
2021-08-18:15:40:54,845 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:40:54,845 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:54,846 INFO     [oort.py:398] At round 62, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 207.0865820126799, 'duration': 12.029357192292537, 'time_stamp': 63, 'count': 57, 'status': True, 'gradient': 26.894398900875277}, [0.11589563315655764, -4.761980348894431e-06]), ({'reward': 606.4955493710765, 'duration': 38.73261129255839, 'time_stamp': 63, 'count': 45, 'status': True, 'gradient': 24.73584198805872}, [0.33943492705016093, -4.761980348894431e-06]), ({'reward': 1304.1820978585938, 'duration': 13.298442137908651, 'time_stamp': 63, 'count': 60, 'status': True, 'gradient': 20.819078251734368}, [0.7299127859711873, -4.761980348894431e-06])]
2021-08-18:15:40:54,858 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:55,161 INFO     [param_server.py:553] For epoch: 64, median_reward: 350.80259074899647, dev: 701.6051814979929
2021-08-18:15:40:55,739 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.372, Top-1 Accuracy: 567.0/1033 (0.5489), Top-5 Accuracy: 1.0
2021-08-18:15:40:55,740 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 707.1539, eval_time 0.5302, test_loss 2.372, test_accuracy 0.5489, test_5_accuracy 1.0 

2021-08-18:15:40:55,776 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5991, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:40:55,776 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 707.1933, eval_time 0.5667, test_loss 2.5991, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:40:55,830 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:40:55,840 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:55,847 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:40:55,860 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:55,893 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9171, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:40:55,894 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 707.3141, eval_time 0.6878, test_loss 2.9171, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:40:55,966 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:40:55,995 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:57,8 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:57,22 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:58,125 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:58,148 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:58,555 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:58,574 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:59,663 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:59,689 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:00,575 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:00,584 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:00,980 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:00,993 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:01,52 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:01,66 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:01,563 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:01,577 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:02,102 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:02,119 INFO     [learner.py:606] ====Pushing takes 0.014850854873657227 s
2021-08-18:15:41:02,142 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:02,149 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:02,150 INFO     [param_server.py:410] Lock worker 1 with localStep 64 , while globalStep is 63

2021-08-18:15:41:02,189 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:02,203 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:02,822 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:02,832 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:03,124 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:03,135 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:04,928 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:04,937 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:05,141 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:05,152 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:05,612 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:05,625 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:05,720 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:05,732 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:06,336 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:06,345 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:06,363 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:06,377 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:06,978 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:07,14 INFO     [learner.py:606] ====Pushing takes 0.03516221046447754 s
2021-08-18:15:41:07,61 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:07,69 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:07,69 INFO     [param_server.py:410] Lock worker 3 with localStep 64 , while globalStep is 63

2021-08-18:15:41:08,134 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:08,164 INFO     [learner.py:606] ====Pushing takes 0.028779983520507812 s
2021-08-18:15:41:08,220 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:08,228 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:08,229 INFO     [param_server.py:381] ====After aggregation in epoch: 63, virtual_clock: 1822.8408544068593, top_1: : 55.6954 % (1726.0), top_5: : 100.0 % (3099.0), test loss: 2.62938564353519, test len: 3099.0
2021-08-18:15:41:08,230 INFO     [param_server.py:410] Lock worker 2 with localStep 64 , while globalStep is 64

2021-08-18:15:41:08,230 INFO     [param_server.py:441] ====Epoch 65 completes 20 clients with loss 6.001875492557445, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:08,230 INFO     [param_server.py:450] ====Start to sample for epoch 65, global virtualClock: 1822.8408544068593, round_duration: 34.64103488098859
2021-08-18:15:41:08,231 INFO     [oort.py:208] Training selector: Pacer 63: lastExploitationUtil 560.6376400729092, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:41:08,232 INFO     [oort.py:321] scores are 26,{5: 0.03212496254576699, 6: 0.11781704186168057, 7: 0.3413096174990466, 11: 0.039791544371609165, 14: 0.008650518534569345, 27: 0.01556918836801548, 50: 0.004268508542442013, 51: 0.2139443150746193, 53: 0.47452360157561935, 58: 0.003577542953636704, 59: 0.0029090441637443063, 60: 0.0015658366153717556, 65: 0.029376237894721706, 67: 0.0018821322676434102, 70: 0.00762776768990364, 71: 0.09287363762275012, 76: 0.0014181115500280581, 79: 0.014754639923461649, 81: 0.021093170495499393, 84: 0.03702682141276877, 85: 0.026504781601100827, 87: 0.12863881675917568, 93: 0.09731321860874302, 97: 0.025668287400235034, 98: 0.47724952295325646, 105: 0.036336437836549725, 107: 0.010374665007471391, 110: 0.008540856369935351, 111: 0.008229256830576036, 119: 0.014305414302547836},[98, 53, 7, 51, 87, 6, 93, 71, 11, 84, 105, 5, 65, 85, 97, 81, 27, 79, 119, 107, 14, 110, 111, 70, 50, 58, 59, 67, 60, 76]
2021-08-18:15:41:08,232 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:41:08,233 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:08,233 INFO     [oort.py:398] At round 63, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 430.75635639632355, 'duration': 5.8943907365129, 'time_stamp': 64, 'count': 61, 'status': True, 'gradient': 21.0307391928993}, [0.2608506340976465, -4.6875732433319305e-06]), ({'reward': 249.2138734235274, 'duration': 21.753601635627824, 'time_stamp': 64, 'count': 58, 'status': True, 'gradient': 21.030203450562222}, [0.15091245355001542, -4.6875732433319305e-06]), ({'reward': 1044.618176251997, 'duration': 11.058674649423494, 'time_stamp': 64, 'count': 61, 'status': True, 'gradient': 20.106180043550772}, [0.6325920054696753, -4.6875732433319305e-06])]
2021-08-18:15:41:08,234 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:08,546 INFO     [param_server.py:553] For epoch: 65, median_reward: 366.5733098291637, dev: 733.1466196583274
2021-08-18:15:41:09,115 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3741, Top-1 Accuracy: 584.0/1033 (0.5653), Top-5 Accuracy: 1.0
2021-08-18:15:41:09,116 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 720.5333, eval_time 0.5255, test_loss 2.3741, test_accuracy 0.5653, test_5_accuracy 1.0 

2021-08-18:15:41:09,156 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3903, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:41:09,161 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 720.5753, eval_time 0.5704, test_loss 2.3903, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:41:09,192 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:09,205 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:09,218 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.189, Top-1 Accuracy: 579.0/1033 (0.5605), Top-5 Accuracy: 1.0
2021-08-18:15:41:09,221 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 720.6409, eval_time 0.6307, test_loss 2.189, test_accuracy 0.5605, test_5_accuracy 1.0 

2021-08-18:15:41:09,242 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:09,256 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:09,290 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:09,316 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:10,338 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:10,348 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:11,446 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:11,456 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:11,825 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:11,839 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:12,648 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:12,668 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:13,704 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:13,714 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:14,87 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:14,101 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:14,175 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:14,185 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:14,760 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:14,816 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:15,437 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:15,446 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:15,538 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:15,555 INFO     [learner.py:606] ====Pushing takes 0.015268325805664062 s
2021-08-18:15:41:15,579 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:15,583 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:15,584 INFO     [param_server.py:410] Lock worker 1 with localStep 65 , while globalStep is 64

2021-08-18:15:41:16,58 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:16,68 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:16,249 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:16,261 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:18,433 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:18,452 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:18,588 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:18,607 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:19,199 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:19,210 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:19,217 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:19,231 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:19,752 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:19,761 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:19,821 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:19,833 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:20,244 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:20,280 INFO     [learner.py:606] ====Pushing takes 0.0346221923828125 s
2021-08-18:15:41:20,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:20,342 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:20,344 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:20,344 INFO     [param_server.py:410] Lock worker 3 with localStep 65 , while globalStep is 64

2021-08-18:15:41:20,375 INFO     [learner.py:606] ====Pushing takes 0.031423091888427734 s
2021-08-18:15:41:20,409 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:20,417 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:20,418 INFO     [param_server.py:381] ====After aggregation in epoch: 64, virtual_clock: 1861.236875965645, top_1: : 56.2439 % (1743.0), top_5: : 100.0 % (3099.0), test loss: 2.3178117992701353, test len: 3099.0
2021-08-18:15:41:20,419 INFO     [param_server.py:410] Lock worker 2 with localStep 65 , while globalStep is 65

2021-08-18:15:41:20,419 INFO     [param_server.py:441] ====Epoch 66 completes 20 clients with loss 5.178167203922241, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:20,419 INFO     [param_server.py:450] ====Start to sample for epoch 66, global virtualClock: 1861.236875965645, round_duration: 38.39602155878561
2021-08-18:15:41:20,420 INFO     [oort.py:208] Training selector: Pacer 64: lastExploitationUtil 729.2890131309483, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:41:20,421 INFO     [oort.py:321] scores are 26,{5: 0.007444644281228136, 6: 0.04594014731201294, 7: 0.4206608720465634, 11: 0.09115546228595854, 14: 0.007041141540991135, 27: 0.045328788167460686, 50: 0.028590941875703196, 51: 0.04498733317014375, 53: 0.29719190246763705, 58: 0.0029119625840771136, 59: 0.0020194862691027193, 60: 0.0010621050845147245, 65: 0.020090970639790127, 67: 0.0012985019892195033, 70: 0.006208667345406051, 71: 0.030668921583830847, 76: 0.000988082557506426, 79: 0.007066404046477137, 81: 0.08977841350555887, 84: 0.307742560406375, 85: 0.00890633463465189, 87: 0.009523475060760825, 93: 0.024628099767478515, 97: 0.09509190292044525, 98: 0.4886722348397644, 105: 0.016773226241796592, 107: 0.008444520922769237, 110: 0.01018028697442639, 111: 0.006698253045722028, 119: 0.011643977930829648},[98, 7, 84, 53, 97, 11, 81, 6, 27, 51, 71, 50, 93, 65, 105, 119, 110, 87, 85, 107, 5, 79, 14, 111, 70, 58, 59, 67, 60, 76]
2021-08-18:15:41:20,421 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:41:20,422 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:20,422 INFO     [oort.py:398] At round 64, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 948.8438121639604, 'duration': 5.8943907365129, 'time_stamp': 65, 'count': 62, 'status': True, 'gradient': 21.036664746322266}, [0.3406716123506068, -4.615455622394195e-06]), ({'reward': 808.7156595039438, 'duration': 38.73261129255839, 'time_stamp': 65, 'count': 47, 'status': True, 'gradient': 24.755157162556383}, [0.2903596582578166, -4.615455622394195e-06]), ({'reward': 2785.1960394541447, 'duration': 13.411352670399307, 'time_stamp': 65, 'count': 62, 'status': True, 'gradient': 17.94772722795523}, [1.0, -4.615455622394195e-06])]
2021-08-18:15:41:20,423 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:20,710 INFO     [param_server.py:553] For epoch: 66, median_reward: 403.1145812012162, dev: 806.2291624024324
2021-08-18:15:41:21,374 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2787, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:41:21,375 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 732.7894, eval_time 0.6389, test_loss 2.2787, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:41:21,383 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6484, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:41:21,383 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 732.8006, eval_time 0.6471, test_loss 2.6484, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:41:21,445 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:21,452 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:21,459 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:21,463 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2218, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:41:21,464 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 732.884, eval_time 0.7305, test_loss 2.2218, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:41:21,467 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:21,521 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:21,543 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:22,502 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:22,512 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:23,616 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:23,630 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:24,29 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:24,43 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:25,130 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:25,164 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:25,935 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:25,953 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:26,406 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:26,426 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:26,678 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:26,714 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:27,396 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:27,418 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:27,605 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:27,625 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:27,990 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:28,9 INFO     [learner.py:606] ====Pushing takes 0.014502763748168945 s
2021-08-18:15:41:28,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:28,42 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:28,43 INFO     [param_server.py:410] Lock worker 1 with localStep 66 , while globalStep is 65

2021-08-18:15:41:28,304 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:28,318 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:28,706 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:28,717 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:30,439 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:30,449 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:30,758 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:30,767 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:31,68 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:31,82 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:31,335 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:31,344 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:31,757 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:31,771 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:31,906 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:31,920 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:32,395 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:32,432 INFO     [learner.py:606] ====Pushing takes 0.03657269477844238 s
2021-08-18:15:41:32,481 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:32,489 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:32,490 INFO     [param_server.py:410] Lock worker 3 with localStep 66 , while globalStep is 65

2021-08-18:15:41:33,542 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:33,570 INFO     [learner.py:606] ====Pushing takes 0.02606964111328125 s
2021-08-18:15:41:33,617 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:33,625 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:33,626 INFO     [param_server.py:381] ====After aggregation in epoch: 65, virtual_clock: 1895.8779108466335, top_1: : 58.5673 % (1815.0), top_5: : 100.0 % (3099.0), test loss: 2.3829675957008645, test len: 3099.0
2021-08-18:15:41:33,628 INFO     [param_server.py:410] Lock worker 2 with localStep 66 , while globalStep is 66

2021-08-18:15:41:33,629 INFO     [param_server.py:441] ====Epoch 67 completes 20 clients with loss 6.752164244664366, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:33,629 INFO     [param_server.py:450] ====Start to sample for epoch 67, global virtualClock: 1895.8779108466335, round_duration: 34.64103488098859
2021-08-18:15:41:33,630 INFO     [oort.py:208] Training selector: Pacer 65: lastExploitationUtil 458.5859151347607, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:41:33,630 INFO     [oort.py:321] scores are 26,{5: 0.024915764809647422, 6: 0.2639436163502542, 7: 0.47947281239418615, 11: 0.05872812944343917, 14: 0.006007954799074442, 27: 0.03036059336969436, 50: 0.046093464049796605, 51: 0.04472836038047105, 53: 0.05292509638887397, 58: 0.0024846737535216008, 59: 0.0023951165709603255, 60: 0.001274597930757373, 65: 0.010044904451390203, 67: 0.001544879218268876, 70: 0.005297634276563399, 71: 0.019307204651867627, 76: 0.001169700649040359, 79: 0.003549550825600457, 81: 0.1120685191645891, 84: 0.27442239150825004, 85: 0.008855064684566805, 87: 0.046100329595264534, 93: 0.054706749359557404, 97: 0.025371535152824348, 98: 0.03598509502182552, 105: 0.008569232286655046, 107: 0.007205408343019113, 110: 0.008442115137882332, 111: 0.005715380282753974, 119: 0.009935390828686221},[7, 84, 6, 81, 11, 93, 53, 87, 50, 51, 98, 27, 97, 5, 71, 65, 119, 85, 105, 110, 107, 14, 111, 70, 79, 58, 59, 67, 60, 76]
2021-08-18:15:41:33,631 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:41:33,632 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:33,632 INFO     [oort.py:398] At round 65, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 864.540211744825, 'duration': 5.8943907365129, 'time_stamp': 66, 'count': 63, 'status': True, 'gradient': 21.043500653672666}, [0.3999440176289467, -4.5455234170214745e-06]), ({'reward': 665.0902097014589, 'duration': 26.145070720211294, 'time_stamp': 66, 'count': 60, 'status': True, 'gradient': 14.857898161163495}, [0.30767560048520215, -4.5455234170214745e-06]), ({'reward': 1117.1153630375284, 'duration': 13.298442137908651, 'time_stamp': 66, 'count': 63, 'status': True, 'gradient': 20.84304946603649}, [0.5167888869238211, -4.5455234170214745e-06])]
2021-08-18:15:41:33,633 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:33,993 INFO     [param_server.py:553] For epoch: 67, median_reward: 344.46201771612715, dev: 688.9240354322543
2021-08-18:15:41:34,685 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.381, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:41:34,686 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 746.1034, eval_time 0.6472, test_loss 2.381, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:41:34,689 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1182, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:41:34,690 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 746.1046, eval_time 0.6495, test_loss 2.1182, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:41:34,744 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:34,754 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:34,759 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:34,768 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:34,802 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0903, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:41:34,802 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 746.222, eval_time 0.7657, test_loss 2.0903, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:41:34,870 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:34,891 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:35,831 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:35,849 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:37,137 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:37,157 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:37,276 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:37,296 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:38,457 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:38,476 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:39,470 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:39,484 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:39,648 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:39,659 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:39,762 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:39,776 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:40,484 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:40,505 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:40,845 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:40,864 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:41,185 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:41,202 INFO     [learner.py:606] ====Pushing takes 0.015384435653686523 s
2021-08-18:15:41:41,228 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:41,236 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:41,237 INFO     [param_server.py:410] Lock worker 1 with localStep 67 , while globalStep is 66

2021-08-18:15:41:41,548 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:41,566 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:42,143 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:42,155 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:43,655 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:43,666 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:44,209 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:44,222 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:44,271 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:44,282 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:44,794 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:44,803 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:44,822 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:44,831 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:45,367 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:45,403 INFO     [learner.py:606] ====Pushing takes 0.03486132621765137 s
2021-08-18:15:41:45,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:45,468 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:45,469 INFO     [param_server.py:410] Lock worker 3 with localStep 67 , while globalStep is 66

2021-08-18:15:41:45,520 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:45,544 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:46,40 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:46,80 INFO     [learner.py:606] ====Pushing takes 0.03774666786193848 s
2021-08-18:15:41:46,133 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:46,144 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:46,145 INFO     [param_server.py:381] ====After aggregation in epoch: 66, virtual_clock: 1934.2739324054191, top_1: : 58.9868 % (1828.0), top_5: : 100.0 % (3099.0), test loss: 2.19648093868185, test len: 3099.0
2021-08-18:15:41:46,148 INFO     [param_server.py:410] Lock worker 2 with localStep 67 , while globalStep is 67

2021-08-18:15:41:46,148 INFO     [param_server.py:441] ====Epoch 68 completes 20 clients with loss 6.099686364814584, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:46,149 INFO     [param_server.py:450] ====Start to sample for epoch 68, global virtualClock: 1934.2739324054191, round_duration: 38.39602155878561
2021-08-18:15:41:46,150 INFO     [oort.py:208] Training selector: Pacer 66: lastExploitationUtil 383.42227664243933, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:41:46,151 INFO     [oort.py:321] scores are 26,{5: 0.007359766026180891, 6: 0.053097790351450624, 7: 0.07907728565067555, 11: 0.15318771737474765, 14: 0.006987026659955511, 27: 0.050126939294776844, 50: 0.008659303026149236, 51: 0.044474421311031936, 53: 0.5543613536054579, 58: 0.0028895826180019906, 59: 0.003176429229818624, 60: 0.001716749713713833, 65: 0.004289844919920423, 67: 0.002057398758630975, 70: 0.00616095046699501, 71: 0.06186659158668788, 76: 0.0015474430125444897, 79: 0.020418900083889018, 81: 0.020730942307430437, 84: 0.09071170658302112, 85: 0.011914873401136375, 87: 0.009414895535049761, 93: 0.01374900297575242, 97: 0.02522749177694055, 98: 0.48825958285620974, 105: 0.0033502508506238213, 107: 0.008379620332079766, 110: 0.10935907309757527, 111: 0.0066467734433584705, 119: 0.011554487828004705},[53, 98, 11, 110, 84, 7, 71, 6, 27, 51, 97, 81, 79, 93, 85, 119, 87, 50, 107, 5, 14, 111, 70, 65, 105, 59, 58, 67, 60, 76]
2021-08-18:15:41:46,152 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:41:46,153 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:46,153 INFO     [oort.py:398] At round 66, UCB exploited 30, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1401.9331293600126, 'duration': 27.689063957948644, 'time_stamp': 67, 'count': 60, 'status': True, 'gradient': 20.33322125126719}, [0.9511379745337448, -4.4776787713249495e-06]), ({'reward': 1473.9529687221418, 'duration': 13.411352670399307, 'time_stamp': 67, 'count': 64, 'status': True, 'gradient': 17.963326182869785}, [1.0, -4.4776787713249495e-06]), ({'reward': 173.99206808030934, 'duration': 13.298442137908651, 'time_stamp': 67, 'count': 64, 'status': True, 'gradient': 20.852120323395216}, [0.11803854056223116, -4.4776787713249495e-06])]
2021-08-18:15:41:46,154 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:41:46,529 INFO     [param_server.py:553] For epoch: 68, median_reward: 328.17650007309203, dev: 656.3530001461841
2021-08-18:15:41:47,127 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.262, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:41:47,128 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 758.542, eval_time 0.5646, test_loss 2.262, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:41:47,170 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2157, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:41:47,171 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 758.588, eval_time 0.6075, test_loss 2.2157, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:41:47,221 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:47,230 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:47,236 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4832, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:41:47,237 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 758.6563, eval_time 0.6735, test_loss 2.4832, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:41:47,256 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:47,272 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:47,307 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:47,330 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:47,951 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:47,970 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:49,262 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:49,276 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:49,355 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:49,365 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:50,764 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:50,798 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:51,90 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:51,112 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:51,391 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:51,410 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:51,998 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:52,19 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:52,81 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:52,95 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:52,642 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:52,662 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:52,731 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:52,751 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:52,767 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:52,778 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:53,26 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:53,47 INFO     [learner.py:606] ====Pushing takes 0.019765377044677734 s
2021-08-18:15:41:53,73 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:53,78 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:53,78 INFO     [param_server.py:410] Lock worker 1 with localStep 68 , while globalStep is 67

2021-08-18:15:41:54,276 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:54,287 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:54,419 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:54,440 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:54,831 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:54,847 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:54,953 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:54,974 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:55,508 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:55,522 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:56,42 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:56,78 INFO     [learner.py:606] ====Pushing takes 0.03448128700256348 s
2021-08-18:15:41:56,129 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:56,138 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:56,139 INFO     [param_server.py:410] Lock worker 3 with localStep 68 , while globalStep is 67

2021-08-18:15:41:56,195 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:56,213 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:41:56,771 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:41:56,814 INFO     [learner.py:606] ====Pushing takes 0.04246830940246582 s
2021-08-18:15:41:56,860 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:56,868 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:56,870 INFO     [param_server.py:381] ====After aggregation in epoch: 67, virtual_clock: 1963.973450546318, top_1: : 57.696 % (1788.0), top_5: : 100.0 % (3099.0), test loss: 2.320334497425291, test len: 3099.0
2021-08-18:15:41:56,872 INFO     [param_server.py:410] Lock worker 2 with localStep 68 , while globalStep is 68

2021-08-18:15:41:56,872 INFO     [param_server.py:441] ====Epoch 69 completes 20 clients with loss 7.581099165153645, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:41:56,873 INFO     [param_server.py:450] ====Start to sample for epoch 69, global virtualClock: 1963.973450546318, round_duration: 29.6995181408989
2021-08-18:15:41:56,873 INFO     [oort.py:208] Training selector: Pacer 67: lastExploitationUtil 380.0142527682509, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:41:56,892 INFO     [oort.py:321] scores are 26,{5: 0.01599522319175353, 6: 0.045162023288916824, 7: 0.6197048302285784, 11: 0.013523644788772991, 14: 0.006419056969315742, 27: 0.0951125219553158, 50: 0.0033575139099334397, 51: 0.04422534770159555, 53: 0.3223616449956928, 58: 0.00265469080700737, 60: 0.001583728245140205, 65: 0.00429753673232978, 67: 0.0019033661628770433, 70: 0.0056601318353958026, 71: 0.02569651567026394, 76: 0.0014339896369043703, 79: 0.003509632772392104, 81: 0.14806361546574617, 84: 0.2525077923035451, 85: 0.03445092170197058, 87: 0.009362168553017065, 93: 0.024571751679629838, 97: 0.08616191115549132, 98: 0.16982987413733527, 105: 0.021774354489655794, 107: 0.0076984478392127685, 110: 0.037044057117791136, 111: 0.006106462658799223, 119: 0.002678556850949767},[7, 53, 84, 98, 81, 27, 97, 6, 51, 110, 85, 71, 93, 105, 5, 11, 87, 107, 14, 111, 70, 65, 79, 50, 119, 58, 67, 60, 76]
2021-08-18:15:41:56,893 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:41:56,894 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:56,894 INFO     [oort.py:398] At round 67, UCB exploited 29, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 792.8909965474854, 'duration': 17.619275735353515, 'time_stamp': 68, 'count': 64, 'status': True, 'gradient': 14.869516594873094}, [0.48614786091151196, -4.4118295857292055e-06]), ({'reward': 102.25372259547228, 'duration': 21.635252629006885, 'time_stamp': 68, 'count': 18, 'status': True, 'gradient': 21.474786502212904}, [0.06268982543715483, -4.4118295857292055e-06]), ({'reward': 152.05799360430606, 'duration': 29.570969934622333, 'time_stamp': 68, 'count': 53, 'status': True, 'gradient': 11.565269251555506}, [0.09322686644994357, -4.4118295857292055e-06])]
2021-08-18:15:41:56,895 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 50, 105, 119]
2021-08-18:15:41:57,249 INFO     [param_server.py:553] For epoch: 69, median_reward: 324.02188487161806, dev: 648.0437697432361
2021-08-18:15:41:57,737 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1868, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:41:57,741 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 769.1606, eval_time 0.4689, test_loss 2.1868, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:41:57,822 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:41:57,829 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1804, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:41:57,830 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 769.2443, eval_time 0.556, test_loss 2.1804, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:41:57,836 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:57,843 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3746, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:41:57,846 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 769.2632, eval_time 0.5738, test_loss 2.3746, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:41:57,947 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:41:57,957 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:41:57,957 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:57,967 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:59,204 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:59,218 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:00,511 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:00,515 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:00,520 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:00,534 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:00,772 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:00,799 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:01,965 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:01,993 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:02,574 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:02,586 INFO     [learner.py:606] ====Pushing takes 0.009973764419555664 s
2021-08-18:15:42:02,613 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:02,620 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:42:02,621 INFO     [param_server.py:410] Lock worker 1 with localStep 69 , while globalStep is 68

2021-08-18:15:42:02,884 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:02,902 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:02,963 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:02,975 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:03,978 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:03,989 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:04,649 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:04,658 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:05,547 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:05,562 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:07,49 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:07,61 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:07,830 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:07,837 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:07,844 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:07,856 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:08,414 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:08,424 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:08,910 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:08,921 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:42:09,37 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:09,73 INFO     [learner.py:606] ====Pushing takes 0.03469133377075195 s
2021-08-18:15:42:09,146 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:09,155 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:42:09,156 INFO     [param_server.py:410] Lock worker 3 with localStep 69 , while globalStep is 68

2021-08-18:15:42:09,509 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:42:09,520 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:10,116 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:10,129 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:10,900 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:10,945 INFO     [learner.py:606] ====Pushing takes 0.04389357566833496 s
2021-08-18:15:42:10,993 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:11,2 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:11,2 INFO     [param_server.py:381] ====After aggregation in epoch: 68, virtual_clock: 2002.3694721051036, top_1: : 59.6321 % (1848.0), top_5: : 100.0 % (3099.0), test loss: 2.24726363685396, test len: 3099.0
2021-08-18:15:42:11,5 INFO     [param_server.py:410] Lock worker 2 with localStep 69 , while globalStep is 69

2021-08-18:15:42:11,6 INFO     [param_server.py:441] ====Epoch 70 completes 20 clients with loss 6.264580905609488, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:11,6 INFO     [param_server.py:450] ====Start to sample for epoch 70, global virtualClock: 2002.3694721051036, round_duration: 38.39602155878561
2021-08-18:15:42:11,7 INFO     [oort.py:208] Training selector: Pacer 68: lastExploitationUtil 306.9888789656403, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:42:11,8 INFO     [oort.py:321] scores are 26,{5: 0.01001353702219313, 6: 0.044912482947451, 7: 0.18924935095387577, 11: 0.1854301498738664, 14: 0.005249729211826676, 27: 0.006895564141602374, 50: 0.003338962146603415, 51: 0.04398098291093284, 53: 0.2232956366867461, 58: 0.002171098954960656, 60: 0.0009688249920712833, 65: 0.004242249602172383, 67: 0.0018148904588177334, 70: 0.004629053703855031, 71: 0.007879053253840288, 76: 0.0013688454353849215, 79: 0.0035158103517481574, 81: 0.020500934975054248, 84: 0.03598721483231187, 85: 0.055694352650218285, 87: 0.06041851405374577, 93: 0.047581657604865574, 97: 0.23834747045874966, 98: 0.06347562009418943, 105: 0.012011793675428255, 107: 0.006296059795142674, 110: 0.02448216786505158, 111: 0.004994078655800481, 112: 0.24272923563944435, 119: 0.0026637566284941523},[112, 97, 53, 7, 11, 98, 87, 85, 93, 6, 51, 84, 110, 81, 105, 5, 71, 27, 107, 14, 111, 70, 65, 79, 50, 119, 58, 67, 76, 60]
2021-08-18:15:42:11,9 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:42:11,9 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:11,10 INFO     [oort.py:398] At round 68, UCB exploited 30, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 745.9258261004709, 'duration': 26.145070720211294, 'time_stamp': 69, 'count': 63, 'status': True, 'gradient': 23.14012334898402}, [0.429265299577446, -4.34788909984203e-06]), ({'reward': 447.1770211843916, 'duration': 11.058674649423494, 'time_stamp': 69, 'count': 66, 'status': True, 'gradient': 20.144289779479973}, [0.2573390727377853, -4.34788909984203e-06]), ({'reward': 1162.3572300043274, 'duration': 15.972045438625893, 'time_stamp': 69, 'count': 66, 'status': True, 'gradient': 20.86491547747066}, [0.6689164005445094, -4.34788909984203e-06])]
2021-08-18:15:42:11,11 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 50, 105, 119]
2021-08-18:15:42:11,362 INFO     [param_server.py:553] For epoch: 70, median_reward: 306.8816627258196, dev: 613.7633254516392
2021-08-18:15:42:12,7 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1775, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:42:12,11 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 783.4308, eval_time 0.6037, test_loss 2.1775, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:42:12,41 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1655, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:42:12,42 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 783.4565, eval_time 0.6294, test_loss 2.1655, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:42:12,73 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2523, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:42:12,75 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 783.4917, eval_time 0.6629, test_loss 2.2523, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:42:12,89 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:12,132 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:12,135 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:12,143 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:12,172 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:12,185 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:13,581 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:13,600 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:14,846 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:14,850 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:14,859 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:14,860 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:15,371 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:15,398 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:16,684 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:16,705 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:17,171 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:17,181 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:17,326 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:17,337 INFO     [learner.py:606] ====Pushing takes 0.00952911376953125 s
2021-08-18:15:42:17,357 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:17,361 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:42:17,362 INFO     [param_server.py:410] Lock worker 1 with localStep 70 , while globalStep is 69

2021-08-18:15:42:17,654 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:17,669 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:18,470 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:18,488 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:19,165 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:19,183 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:20,414 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:20,432 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:22,118 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:22,137 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:22,828 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:22,840 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:23,550 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:23,559 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:23,575 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:23,593 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:24,244 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:24,281 INFO     [learner.py:606] ====Pushing takes 0.03553652763366699 s
2021-08-18:15:42:24,329 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:24,340 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:42:24,341 INFO     [param_server.py:410] Lock worker 3 with localStep 70 , while globalStep is 69

2021-08-18:15:42:24,797 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:24,815 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:42:25,555 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:42:25,574 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:27,691 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:27,702 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:28,307 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:28,355 INFO     [learner.py:606] ====Pushing takes 0.045881032943725586 s
2021-08-18:15:42:28,404 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:28,413 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:28,414 INFO     [param_server.py:381] ====After aggregation in epoch: 69, virtual_clock: 2046.7361091952062, top_1: : 59.2772 % (1837.0), top_5: : 100.0 % (3099.0), test loss: 2.198461455327493, test len: 3099.0
2021-08-18:15:42:28,419 INFO     [param_server.py:410] Lock worker 2 with localStep 70 , while globalStep is 70

2021-08-18:15:42:28,419 INFO     [param_server.py:441] ====Epoch 71 completes 20 clients with loss 5.896094318944483, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:28,420 INFO     [param_server.py:450] ====Start to sample for epoch 71, global virtualClock: 2046.7361091952062, round_duration: 44.36663709010263
2021-08-18:15:42:28,420 INFO     [oort.py:208] Training selector: Pacer 69: lastExploitationUtil 572.7890457297788, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:42:28,421 INFO     [oort.py:321] scores are 26,{5: 0.018404218085826308, 6: 0.07749993338252982, 7: 0.20516787841004452, 11: 0.013375590150599349, 14: 0.008468716013463308, 27: 0.0842192818668045, 50: 0.012814528107741719, 51: 0.30069673559014076, 53: 0.6133150168712183, 58: 0.0035023559777650117, 60: 0.0009769502041917938, 67: 0.0019129431459392711, 70: 0.007467459681673391, 71: 0.007836092585108827, 76: 0.001380868869379867, 79: 0.0035218871639937106, 81: 0.1500533011866222, 84: 0.035790993945719274, 85: 0.02296804565753917, 87: 0.009259673072006775, 93: 0.06409738998857173, 97: 0.11254610928090379, 98: 0.20099705142704055, 105: 0.04566180655562449, 107: 0.006348862749007007, 110: 0.008255792070831056, 111: 0.008056307702422728, 119: 0.02913862219180182},[53, 51, 7, 98, 81, 97, 27, 6, 93, 105, 84, 119, 85, 5, 11, 50, 87, 14, 110, 111, 71, 70, 107, 79, 58, 67, 76, 60]
2021-08-18:15:42:28,422 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:42:28,423 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:28,423 INFO     [oort.py:398] At round 69, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 849.8204847829863, 'duration': 17.619275735353515, 'time_stamp': 70, 'count': 66, 'status': True, 'gradient': 23.149548405359027}, [0.49459830772490887, -4.285775511078734e-06]), ({'reward': 1449.8726454778464, 'duration': 11.058674649423494, 'time_stamp': 70, 'count': 67, 'status': True, 'gradient': 20.152658916609305}, [0.8438347375505277, -4.285775511078734e-06]), ({'reward': 785.008687655994, 'duration': 12.029357192292537, 'time_stamp': 70, 'count': 64, 'status': True, 'gradient': 26.96785787675193}, [0.45687718592609355, -4.285775511078734e-06])]
2021-08-18:15:42:28,424 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:42:28,765 INFO     [param_server.py:553] For epoch: 71, median_reward: 360.56897355943823, dev: 721.1379471188765
2021-08-18:15:42:29,350 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3729, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:42:29,357 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 800.7771, eval_time 0.5579, test_loss 2.3729, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:42:29,430 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4683, Top-1 Accuracy: 575.0/1033 (0.5566), Top-5 Accuracy: 1.0
2021-08-18:15:42:29,431 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 800.8484, eval_time 0.6314, test_loss 2.4683, test_accuracy 0.5566, test_5_accuracy 1.0 

2021-08-18:15:42:29,455 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:29,464 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5187, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:42:29,465 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 800.8796, eval_time 0.6655, test_loss 2.5187, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:42:29,476 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:29,506 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:29,515 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:29,560 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:29,575 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:30,734 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:30,746 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:31,968 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:31,977 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:32,259 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:32,268 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:32,627 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:32,660 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:33,965 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:33,999 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:34,467 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:34,488 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:34,540 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:34,554 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:34,684 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:34,717 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:35,188 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:35,204 INFO     [learner.py:606] ====Pushing takes 0.014332294464111328 s
2021-08-18:15:42:35,230 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:35,236 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:35,237 INFO     [param_server.py:410] Lock worker 1 with localStep 71 , while globalStep is 70

2021-08-18:15:42:35,738 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:35,750 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:36,539 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:36,560 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:37,702 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:37,715 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:38,847 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:38,858 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:39,445 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:39,455 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:39,818 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:39,828 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:40,48 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:40,57 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:40,477 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:40,488 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:40,659 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:40,715 INFO     [learner.py:606] ====Pushing takes 0.05517315864562988 s
2021-08-18:15:42:40,772 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:40,780 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:40,782 INFO     [param_server.py:410] Lock worker 3 with localStep 71 , while globalStep is 70

2021-08-18:15:42:41,14 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:41,26 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:41,762 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:41,801 INFO     [learner.py:606] ====Pushing takes 0.03740954399108887 s
2021-08-18:15:42:41,847 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:41,856 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:41,857 INFO     [param_server.py:381] ====After aggregation in epoch: 70, virtual_clock: 2085.132130753992, top_1: : 56.0826 % (1738.0), top_5: : 100.0 % (3099.0), test loss: 2.4533161233972622, test len: 3099.0
2021-08-18:15:42:41,860 INFO     [param_server.py:410] Lock worker 2 with localStep 71 , while globalStep is 71

2021-08-18:15:42:41,861 INFO     [param_server.py:441] ====Epoch 72 completes 20 clients with loss 6.36932860878112, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:41,861 INFO     [param_server.py:450] ====Start to sample for epoch 72, global virtualClock: 2085.132130753992, round_duration: 38.39602155878561
2021-08-18:15:42:41,862 INFO     [oort.py:208] Training selector: Pacer 70: lastExploitationUtil 458.7790911460049, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:42:41,863 INFO     [oort.py:321] scores are 26,{5: 0.0071994725780035055, 6: 0.044427217514779085, 7: 1.0773550005853694, 11: 0.013303609202355479, 14: 0.007284223775910086, 27: 0.014094396545954454, 50: 0.0033028856973756483, 51: 0.043505782046919565, 53: 0.19972196371715253, 58: 0.0030124926428491162, 60: 0.001001033153339043, 67: 0.0019674031569618293, 70: 0.006423009966613631, 71: 0.00779392252992232, 76: 0.001453936028873566, 79: 0.007027244769993504, 81: 0.02884818438991151, 84: 0.16097594843871588, 85: 0.008613025626272258, 87: 0.11524148770013737, 93: 0.06949812843990756, 97: 0.34178502552787504, 98: 0.16684002199422576, 105: 0.030453644249007598, 107: 0.008736052204561598, 110: 0.0385437070111452, 111: 0.006929497697022929, 119: 0.01658735513750908},[7, 97, 53, 98, 84, 87, 93, 6, 51, 110, 105, 81, 119, 27, 11, 107, 85, 71, 14, 5, 79, 111, 70, 50, 58, 67, 76, 60]
2021-08-18:15:42:41,864 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:42:41,864 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:41,865 INFO     [oort.py:398] At round 70, UCB exploited 28, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 369.91237853420125, 'duration': 11.058674649423494, 'time_stamp': 71, 'count': 68, 'status': True, 'gradient': 20.161371750164623}, [0.2227606169622526, -4.225411625515856e-06]), ({'reward': 1660.5476271213868, 'duration': 5.8943907365129, 'time_stamp': 71, 'count': 68, 'status': True, 'gradient': 21.087420145271903}, [1.0, -4.225411625515856e-06]), ({'reward': 1650.5733844046933, 'duration': 15.972045438625893, 'time_stamp': 71, 'count': 68, 'status': True, 'gradient': 20.885302020336372}, [0.9939933654656667, -4.225411625515856e-06])]
2021-08-18:15:42:41,865 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:42:42,207 INFO     [param_server.py:553] For epoch: 72, median_reward: 348.3240900088922, dev: 696.6481800177844
2021-08-18:15:42:42,912 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3291, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:42:42,912 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 814.3294, eval_time 0.6688, test_loss 2.3291, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:42:42,912 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3746, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:42:42,915 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 814.3291, eval_time 0.6693, test_loss 2.3746, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:42:42,946 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.359, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:42:42,946 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 814.366, eval_time 0.7036, test_loss 2.359, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:42:42,981 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:42,984 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:42,996 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:42,999 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:43,12 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:43,26 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:44,117 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:44,126 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:45,567 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:45,585 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:45,686 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:45,695 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:46,251 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:46,272 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:47,593 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:47,620 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:47,864 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:47,874 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:48,368 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:48,389 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:48,529 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:48,562 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:48,995 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:49,6 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:49,11 INFO     [learner.py:606] ====Pushing takes 0.01363229751586914 s
2021-08-18:15:42:49,23 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:49,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:49,44 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:49,44 INFO     [param_server.py:410] Lock worker 1 with localStep 72 , while globalStep is 71

2021-08-18:15:42:49,676 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:49,693 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:51,146 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:51,158 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:52,264 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:52,279 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:53,21 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:53,36 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:53,691 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:53,701 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:53,864 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:53,879 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:54,370 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:54,424 INFO     [learner.py:606] ====Pushing takes 0.03214263916015625 s
2021-08-18:15:42:54,469 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:54,477 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:54,478 INFO     [param_server.py:410] Lock worker 3 with localStep 72 , while globalStep is 71

2021-08-18:15:42:55,137 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:55,156 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:57,674 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:57,692 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:58,193 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:58,232 INFO     [learner.py:606] ====Pushing takes 0.037873268127441406 s
2021-08-18:15:42:58,278 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:58,285 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:58,286 INFO     [param_server.py:381] ====After aggregation in epoch: 71, virtual_clock: 2129.498767844095, top_1: : 59.5676 % (1846.0), top_5: : 100.0 % (3099.0), test loss: 2.354234183276141, test len: 3099.0
2021-08-18:15:42:58,290 INFO     [param_server.py:410] Lock worker 2 with localStep 72 , while globalStep is 72

2021-08-18:15:42:58,291 INFO     [param_server.py:441] ====Epoch 73 completes 20 clients with loss 4.551513494262649, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:58,291 INFO     [param_server.py:450] ====Start to sample for epoch 73, global virtualClock: 2129.498767844095, round_duration: 44.36663709010263
2021-08-18:15:42:58,292 INFO     [oort.py:208] Training selector: Pacer 71: lastExploitationUtil 407.4370302593496, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:42:58,292 INFO     [oort.py:321] scores are 26,{5: 0.03347107281626837, 6: 0.04419120297077387, 7: 0.6141951612065158, 11: 0.0713708542875221, 14: 0.005495176089135888, 27: 0.047558091326231955, 50: 0.00487711213441031, 51: 0.04327466252411851, 53: 0.05120499982120839, 58: 0.002272606944672561, 60: 0.0008424998116238638, 67: 0.0016048158291445203, 70: 0.004845481395772595, 71: 0.00775251820224189, 76: 0.001096840891602206, 79: 0.008071969031384647, 81: 0.02017169657783698, 84: 0.49560422936102094, 85: 0.008567269906481486, 87: 0.049814402830208625, 93: 0.01337810467859198, 97: 0.155844221744577, 98: 0.16246579487613083, 105: 0.003259873218314909, 107: 0.006590427019377491, 110: 0.008167741461435675, 119: 0.002620977557002562},[7, 84, 98, 97, 11, 53, 87, 27, 6, 51, 5, 81, 93, 85, 110, 79, 71, 107, 14, 50, 70, 105, 119, 58, 67, 76, 60]
2021-08-18:15:42:58,293 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:42:58,294 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:58,295 INFO     [oort.py:398] At round 71, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1153.071839558819, 'duration': 5.8943907365129, 'time_stamp': 72, 'count': 69, 'status': True, 'gradient': 21.09870037077251}, [0.5372510989397435, -4.166724537840807e-06]), ({'reward': 725.5372386020629, 'duration': 21.753601635627824, 'time_stamp': 72, 'count': 66, 'status': True, 'gradient': 21.10047203147601}, [0.33804805160393364, -4.166724537840807e-06]), ({'reward': 2146.2351942562, 'duration': 13.298442137908651, 'time_stamp': 72, 'count': 69, 'status': True, 'gradient': 20.89429930795151}, [1.0, -4.166724537840807e-06])]
2021-08-18:15:42:58,295 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:42:58,639 INFO     [param_server.py:553] For epoch: 73, median_reward: 337.6277992435798, dev: 675.2555984871595
2021-08-18:15:42:59,330 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2589, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:42:59,332 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 830.7457, eval_time 0.6535, test_loss 2.2589, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:42:59,372 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5211, Top-1 Accuracy: 581.0/1033 (0.5624), Top-5 Accuracy: 1.0
2021-08-18:15:42:59,373 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 830.7903, eval_time 0.6952, test_loss 2.5211, test_accuracy 0.5624, test_5_accuracy 1.0 

2021-08-18:15:42:59,402 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:59,410 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:59,412 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3951, Top-1 Accuracy: 592.0/1033 (0.5731), Top-5 Accuracy: 1.0
2021-08-18:15:42:59,413 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 830.8324, eval_time 0.7374, test_loss 2.3951, test_accuracy 0.5731, test_5_accuracy 1.0 

2021-08-18:15:42:59,447 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:59,464 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:59,486 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:59,505 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:00,546 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:00,560 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:01,768 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:01,780 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:02,58 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:02,68 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:02,534 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:02,561 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:03,947 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:03,967 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:03,985 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:03,996 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:04,706 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:04,727 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:04,728 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:04,746 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:05,311 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:05,328 INFO     [learner.py:606] ====Pushing takes 0.015100240707397461 s
2021-08-18:15:43:05,353 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:05,358 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:05,358 INFO     [param_server.py:410] Lock worker 1 with localStep 73 , while globalStep is 72

2021-08-18:15:43:05,917 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:05,931 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:06,612 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:06,630 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:06,846 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:06,859 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:08,821 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:08,832 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:09,11 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:09,23 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:09,438 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:09,449 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:09,698 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:09,712 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:10,83 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:10,93 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:10,359 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:10,374 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:10,647 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:10,682 INFO     [learner.py:606] ====Pushing takes 0.03386950492858887 s
2021-08-18:15:43:10,728 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:10,738 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:10,739 INFO     [param_server.py:410] Lock worker 3 with localStep 73 , while globalStep is 72

2021-08-18:15:43:11,177 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:11,209 INFO     [learner.py:606] ====Pushing takes 0.03128623962402344 s
2021-08-18:15:43:11,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:11,251 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:11,252 INFO     [param_server.py:381] ====After aggregation in epoch: 72, virtual_clock: 2166.8422871171565, top_1: : 57.0829 % (1769.0), top_5: : 100.0 % (3099.0), test loss: 2.3917072282897105, test len: 3099.0
2021-08-18:15:43:11,254 INFO     [param_server.py:410] Lock worker 2 with localStep 73 , while globalStep is 73

2021-08-18:15:43:11,254 INFO     [param_server.py:441] ====Epoch 74 completes 20 clients with loss 7.413254531998278, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:11,254 INFO     [param_server.py:450] ====Start to sample for epoch 74, global virtualClock: 2166.8422871171565, round_duration: 37.343519273061496
2021-08-18:15:43:11,255 INFO     [oort.py:208] Training selector: Pacer 72: lastExploitationUtil 500.8122035778301, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:43:11,256 INFO     [oort.py:321] scores are 26,{5: 0.08458328496776372, 6: 0.0439594212265329, 7: 0.25268891169758284, 11: 0.0895214487856026, 14: 0.008173259033117487, 27: 0.08304680027569274, 50: 0.01716179295103478, 51: 0.04304768801138772, 53: 0.05093643088950795, 58: 0.0033801656103419576, 60: 0.0015083554405278207, 67: 0.0020679142330835803, 70: 0.007206934581422793, 71: 0.022748591976789894, 76: 0.001631388071968058, 79: 0.02413078237694695, 81: 0.09330001438178234, 84: 0.03522355104335452, 85: 0.008522334792051117, 87: 0.009112866985232627, 93: 0.07480154638185281, 97: 0.34344143399458377, 98: 0.3829767937749419, 105: 0.0032427752655607117, 107: 0.009802282273487417, 110: 0.030716678525406618, 119: 0.020761126008497766},[98, 97, 7, 81, 11, 5, 27, 93, 53, 6, 51, 84, 110, 79, 71, 119, 50, 107, 87, 85, 14, 70, 58, 105, 67, 76, 60]
2021-08-18:15:43:11,256 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:43:11,257 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:11,257 INFO     [oort.py:398] At round 72, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 508.85553838744215, 'duration': 43.65853298740619, 'time_stamp': 73, 'count': 59, 'status': True, 'gradient': 8.277817805740462}, [0.3253960969660431, -4.109645337607368e-06]), ({'reward': 1563.7827369132583, 'duration': 15.972045438625893, 'time_stamp': 73, 'count': 70, 'status': True, 'gradient': 20.899474105349906}, [1.0, -4.109645337607368e-06]), ({'reward': 1203.890971461277, 'duration': 13.411352670399307, 'time_stamp': 73, 'count': 70, 'status': True, 'gradient': 18.005475236893435}, [0.7698567351538936, -4.109645337607368e-06])]
2021-08-18:15:43:11,258 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:11,542 INFO     [param_server.py:553] For epoch: 74, median_reward: 358.6962226966219, dev: 717.3924453932437
2021-08-18:15:43:12,169 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3702, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:43:12,170 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 843.5868, eval_time 0.5908, test_loss 2.3702, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:43:12,207 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.435, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:43:12,209 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 843.623, eval_time 0.6296, test_loss 2.435, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:43:12,239 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:43:12,249 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:12,254 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0245, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:43:12,255 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 843.6744, eval_time 0.6783, test_loss 2.0245, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:43:12,276 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:43:12,290 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:12,323 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:43:12,352 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:13,530 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:13,544 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:14,801 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:14,811 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:15,120 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:15,134 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:15,590 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:15,611 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:16,926 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:16,946 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:17,539 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:17,558 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:17,663 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:17,682 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:17,764 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:17,782 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:18,284 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:18,299 INFO     [learner.py:606] ====Pushing takes 0.013303279876708984 s
2021-08-18:15:43:18,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:18,338 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:18,338 INFO     [param_server.py:410] Lock worker 1 with localStep 74 , while globalStep is 73

2021-08-18:15:43:18,724 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:18,733 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:19,415 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:19,425 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:20,437 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:20,452 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:22,68 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:22,78 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:22,778 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:22,789 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:23,398 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:23,407 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:23,430 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:23,449 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:23,963 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:24,3 INFO     [learner.py:606] ====Pushing takes 0.038504600524902344 s
2021-08-18:15:43:24,51 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:24,59 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:24,60 INFO     [param_server.py:410] Lock worker 3 with localStep 74 , while globalStep is 73

2021-08-18:15:43:24,583 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:24,601 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:26,935 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:26,947 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:27,593 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:27,628 INFO     [learner.py:606] ====Pushing takes 0.0328519344329834 s
2021-08-18:15:43:27,676 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:27,689 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:27,690 INFO     [param_server.py:381] ====After aggregation in epoch: 73, virtual_clock: 2211.2089242072593, top_1: : 59.019 % (1829.0), top_5: : 100.0 % (3099.0), test loss: 2.2765710133093378, test len: 3099.0
2021-08-18:15:43:27,694 INFO     [param_server.py:410] Lock worker 2 with localStep 74 , while globalStep is 74

2021-08-18:15:43:27,694 INFO     [param_server.py:441] ====Epoch 75 completes 20 clients with loss 5.762706819097211, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:27,695 INFO     [param_server.py:450] ====Start to sample for epoch 75, global virtualClock: 2211.2089242072593, round_duration: 44.36663709010263
2021-08-18:15:43:27,696 INFO     [oort.py:208] Training selector: Pacer 73: lastExploitationUtil 767.3686358424876, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:43:27,697 INFO     [oort.py:321] scores are 26,{5: 0.03187000365495843, 6: 0.06201164186713286, 7: 0.07614406756921525, 11: 0.0632093839283499, 14: 0.010518117647013957, 27: 0.08933061872556675, 50: 0.019563039264865432, 51: 0.04282472916898902, 53: 0.2599469016250861, 58: 0.004349914692769335, 60: 0.0019410934992640074, 67: 0.001873236345387124, 70: 0.009274560551010079, 71: 0.07698323665745219, 76: 0.002099423449002127, 79: 0.032019813718189294, 81: 0.0833658426883825, 84: 0.2887657362605711, 85: 0.02071601660463165, 87: 0.08030632901318545, 93: 0.18710692694815295, 97: 0.09779002598998467, 98: 0.3554190254938961, 105: 0.039375375170218975, 107: 0.012614497808526517, 110: 0.07319669552810888, 119: 0.010421377890558876},[98, 84, 53, 93, 97, 27, 81, 87, 71, 7, 110, 11, 6, 51, 105, 79, 5, 85, 50, 107, 14, 119, 70, 58, 76, 60, 67]
2021-08-18:15:43:27,698 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:43:27,698 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:27,699 INFO     [oort.py:398] At round 73, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 973.74983231584, 'duration': 13.298442137908651, 'time_stamp': 74, 'count': 71, 'status': True, 'gradient': 20.908961139212682}, [0.5513415942440981, -4.054108839308643e-06]), ({'reward': 1506.9558529754554, 'duration': 43.8287324306519, 'time_stamp': 74, 'count': 62, 'status': True, 'gradient': 14.906037237192807}, [0.8532483713067025, -4.054108839308643e-06]), ({'reward': 1654.7306986083386, 'duration': 30.380154975061778, 'time_stamp': 74, 'count': 66, 'status': True, 'gradient': 19.874675091545697}, [0.9369200210017988, -4.054108839308643e-06])]
2021-08-18:15:43:27,700 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:28,54 INFO     [param_server.py:553] For epoch: 75, median_reward: 416.4503384843247, dev: 832.9006769686493
2021-08-18:15:43:28,718 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.601, Top-1 Accuracy: 584.0/1033 (0.5653), Top-5 Accuracy: 1.0
2021-08-18:15:43:28,719 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 860.136, eval_time 0.6296, test_loss 2.601, test_accuracy 0.5653, test_5_accuracy 1.0 

2021-08-18:15:43:28,753 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5227, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:43:28,753 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5185, Top-1 Accuracy: 591.0/1033 (0.5721), Top-5 Accuracy: 1.0
2021-08-18:15:43:28,754 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 860.1738, eval_time 0.6668, test_loss 2.5227, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:43:28,754 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 860.1684, eval_time 0.6645, test_loss 2.5185, test_accuracy 0.5721, test_5_accuracy 1.0 

2021-08-18:15:43:28,795 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:28,806 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:28,830 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:28,832 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:28,844 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:28,848 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:30,4 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:30,15 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:31,139 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:31,156 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:31,714 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:31,725 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:31,744 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:31,758 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:33,70 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:33,105 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:33,465 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:33,483 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:33,880 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:33,891 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:33,894 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:33,921 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:34,471 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:34,488 INFO     [learner.py:606] ====Pushing takes 0.01546168327331543 s
2021-08-18:15:43:34,512 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:34,517 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:34,518 INFO     [param_server.py:410] Lock worker 1 with localStep 75 , while globalStep is 74

2021-08-18:15:43:35,97 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:35,107 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:35,686 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:35,695 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:36,481 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:36,502 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:37,876 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:37,885 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:38,599 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:38,613 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:38,800 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:38,819 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:39,246 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:39,257 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:39,466 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:39,477 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:39,930 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:39,967 INFO     [learner.py:606] ====Pushing takes 0.035706281661987305 s
2021-08-18:15:43:40,20 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:40,28 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:40,29 INFO     [param_server.py:410] Lock worker 3 with localStep 75 , while globalStep is 74

2021-08-18:15:43:40,64 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:40,83 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:40,766 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:40,797 INFO     [learner.py:606] ====Pushing takes 0.029727935791015625 s
2021-08-18:15:43:40,832 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:40,840 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:40,841 INFO     [param_server.py:381] ====After aggregation in epoch: 74, virtual_clock: 2248.552443480321, top_1: : 57.3411 % (1777.0), top_5: : 100.0 % (3099.0), test loss: 2.547380571012144, test len: 3099.0
2021-08-18:15:43:40,844 INFO     [param_server.py:410] Lock worker 2 with localStep 75 , while globalStep is 75

2021-08-18:15:43:40,844 INFO     [param_server.py:441] ====Epoch 76 completes 20 clients with loss 7.392987360444207, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:40,844 INFO     [param_server.py:450] ====Start to sample for epoch 76, global virtualClock: 2248.552443480321, round_duration: 37.343519273061496
2021-08-18:15:43:40,845 INFO     [oort.py:208] Training selector: Pacer 74: lastExploitationUtil 410.7476833899765, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:43:40,845 INFO     [oort.py:321] scores are 26,{5: 0.040096587868172, 6: 0.043508038368325584, 7: 0.18659586670607997, 11: 0.15254782363348962, 14: 0.006363509733100858, 27: 0.05569326089009668, 50: 0.02572384695496829, 51: 0.04260566698582269, 53: 0.7158968103164718, 58: 0.002631718470410389, 60: 0.001174370528069919, 67: 0.0014374117999352925, 70: 0.00561115194916469, 71: 0.0076326697785836705, 76: 0.002104646524262191, 79: 0.003381098236965877, 81: 0.059952609653798415, 84: 0.03486186959481524, 85: 0.008434826000313115, 87: 0.009019294507900405, 93: 0.018846805760748896, 97: 0.28363154199835855, 98: 0.03427733460183987, 105: 0.016132107574859073, 107: 0.007631829408708592, 110: 0.008041473981184178, 119: 0.0025804591060353023},[53, 97, 7, 11, 81, 27, 6, 51, 5, 84, 98, 50, 93, 105, 87, 85, 110, 71, 107, 14, 70, 79, 58, 119, 76, 67, 60]
2021-08-18:15:43:40,846 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:43:40,847 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:40,847 INFO     [oort.py:398] At round 74, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 195.25327286090462, 'duration': 5.8943907365129, 'time_stamp': 75, 'count': 72, 'status': True, 'gradient': 21.120595334041862}, [0.11084130606709561, -4.000053334044458e-06]), ({'reward': 0.01, 'duration': 13.411352670399307, 'time_stamp': 75, 'count': 72, 'status': True, 'gradient': 18.02198142034973}, [5.677086783367433e-09, -4.000053334044458e-06]), ({'reward': 625.444767459705, 'duration': 29.570969934622333, 'time_stamp': 75, 'count': 60, 'status': True, 'gradient': 18.227207452288734}, [0.3550647508974987, -4.000053334044458e-06])]
2021-08-18:15:43:40,848 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119, 107]
2021-08-18:15:43:41,129 INFO     [param_server.py:553] For epoch: 76, median_reward: 340.80367035527314, dev: 681.6073407105463
2021-08-18:15:43:41,847 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5215, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:43:41,849 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 873.2659, eval_time 0.6943, test_loss 2.5215, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:43:41,851 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.183, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:43:41,852 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 873.2659, eval_time 0.6971, test_loss 2.183, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:43:41,886 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4388, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:43:41,887 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 873.3066, eval_time 0.7349, test_loss 2.4388, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:43:41,920 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:41,929 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:41,944 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:41,955 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:41,957 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:41,965 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:43,147 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:43,164 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:44,351 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:44,371 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:44,598 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:44,611 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:44,767 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:44,794 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:46,481 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:46,508 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:46,884 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:46,894 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:47,292 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:47,319 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:47,484 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:47,502 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:47,969 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:47,980 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:48,4 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:48,23 INFO     [learner.py:606] ====Pushing takes 0.01724839210510254 s
2021-08-18:15:43:48,48 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:48,54 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:48,55 INFO     [param_server.py:410] Lock worker 1 with localStep 76 , while globalStep is 75

2021-08-18:15:43:48,556 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:48,570 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:50,444 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:50,461 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:51,560 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:51,574 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:51,626 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:51,646 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:52,403 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:52,417 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:53,60 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:53,72 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:53,765 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:53,801 INFO     [learner.py:606] ====Pushing takes 0.03509044647216797 s
2021-08-18:15:43:53,853 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:53,861 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:53,862 INFO     [param_server.py:410] Lock worker 3 with localStep 76 , while globalStep is 75

2021-08-18:15:43:54,125 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:54,137 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:54,668 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:54,679 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:43:55,350 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:43:55,384 INFO     [learner.py:606] ====Pushing takes 0.03281140327453613 s
2021-08-18:15:43:55,417 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:55,425 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:55,425 INFO     [param_server.py:381] ====After aggregation in epoch: 75, virtual_clock: 2292.919080570424, top_1: : 58.3737 % (1809.0), top_5: : 100.0 % (3099.0), test loss: 2.3810979039580733, test len: 3099.0
2021-08-18:15:43:55,427 INFO     [param_server.py:410] Lock worker 2 with localStep 76 , while globalStep is 76

2021-08-18:15:43:55,427 INFO     [param_server.py:441] ====Epoch 77 completes 20 clients with loss 4.934023997967575, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:55,428 INFO     [param_server.py:450] ====Start to sample for epoch 77, global virtualClock: 2292.919080570424, round_duration: 44.36663709010263
2021-08-18:15:43:55,429 INFO     [oort.py:208] Training selector: Pacer 75: lastExploitationUtil 468.1741056699687, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:43:55,429 INFO     [oort.py:321] scores are 25,{5: 0.030567061998833266, 6: 0.043288196905188536, 7: 0.3691317299500728, 11: 0.012962532585113344, 14: 0.0066849835845870795, 27: 0.0671193101593374, 50: 0.0032182066404623667, 51: 0.04239038510874059, 53: 0.05015867335081502, 58: 0.0027646684788482636, 60: 0.0012336977598280104, 67: 0.001370149619721341, 70: 0.005894617945765501, 76: 0.0013343272783852885, 79: 0.03066013588782092, 81: 0.08945894774221315, 84: 0.034685716297474294, 85: 0.11973633144245263, 87: 0.04095363767618424, 93: 0.013104735572102764, 97: 0.02404535146782966, 98: 0.3879805705402492, 105: 0.017571840447753756, 107: 0.013800332047450875, 110: 0.008000841273480008, 119: 0.0025674203222447395},[98, 7, 85, 81, 27, 53, 6, 51, 87, 84, 79, 5, 97, 105, 107, 93, 11, 110, 14, 70, 50, 58, 119, 67, 76, 60]
2021-08-18:15:43:55,430 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:43:55,431 INFO     [oort.py:365] exploration poss is [202.          16.91829855   9.05547074   1.91505738   0.90032832]
2021-08-18:15:43:55,431 INFO     [oort.py:398] At round 75, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1288.565991520946, 'duration': 30.380154975061778, 'time_stamp': 76, 'count': 68, 'status': True, 'gradient': 19.896629991027307}, [0.6858024203831171, -3.9474203607942245e-06]), ({'reward': 0.01, 'duration': 21.753601635627824, 'time_stamp': 76, 'count': 70, 'status': True, 'gradient': 21.134146577920674}, [5.322255451634254e-09, -3.9474203607942245e-06]), ({'reward': 1469.4697713741812, 'duration': 13.411352670399307, 'time_stamp': 76, 'count': 73, 'status': True, 'gradient': 18.031342877753797}, [0.7820840332376334, -3.9474203607942245e-06])]
2021-08-18:15:43:55,432 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:55,720 INFO     [param_server.py:553] For epoch: 77, median_reward: 346.37288945677744, dev: 692.7457789135549
2021-08-18:15:43:56,347 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3032, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:43:56,348 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 887.7621, eval_time 0.6051, test_loss 2.3032, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:43:56,389 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4081, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:43:56,390 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 887.8074, eval_time 0.6477, test_loss 2.4081, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:43:56,392 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5381, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:43:56,396 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 887.8158, eval_time 0.6541, test_loss 2.5381, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:43:56,437 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:56,447 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:56,463 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:56,466 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:56,478 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:43:56,481 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:57,791 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:43:57,811 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:59,81 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:59,96 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:59,123 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:59,134 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:59,851 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:59,884 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:00,292 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:00,310 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:01,311 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:01,344 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:01,679 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:01,697 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:02,119 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:02,139 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:02,704 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:02,708 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:02,718 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:02,720 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:02,725 INFO     [learner.py:606] ====Pushing takes 0.01999521255493164 s
2021-08-18:15:44:02,734 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:02,751 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:02,756 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:02,757 INFO     [param_server.py:410] Lock worker 1 with localStep 77 , while globalStep is 76

2021-08-18:15:44:03,437 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:03,451 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:05,663 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:05,682 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:05,832 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:05,851 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:06,407 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:06,425 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:06,660 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:06,674 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:07,101 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:07,122 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:07,246 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:07,260 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:07,862 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:07,880 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:07,895 INFO     [learner.py:606] ====Pushing takes 0.03187894821166992 s
2021-08-18:15:44:07,948 INFO     [learner.py:606] ====Pushing takes 0.06677770614624023 s
2021-08-18:15:44:07,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:07,970 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:07,971 INFO     [param_server.py:410] Lock worker 2 with localStep 77 , while globalStep is 76

2021-08-18:15:44:08,4 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:08,12 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:08,12 INFO     [param_server.py:381] ====After aggregation in epoch: 76, virtual_clock: 2329.2100975577614, top_1: : 58.6641 % (1818.0), top_5: : 100.0 % (3099.0), test loss: 2.4164429108301797, test len: 3099.0
2021-08-18:15:44:08,15 INFO     [param_server.py:410] Lock worker 3 with localStep 77 , while globalStep is 77

2021-08-18:15:44:08,15 INFO     [param_server.py:441] ====Epoch 78 completes 20 clients with loss 8.643330723316454, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:44:08,16 INFO     [param_server.py:450] ====Start to sample for epoch 78, global virtualClock: 2329.2100975577614, round_duration: 36.29101698733738
2021-08-18:15:44:08,17 INFO     [oort.py:208] Training selector: Pacer 76: lastExploitationUtil 488.7501811510136, lastExplorationUtil 0.009999000099990002, last_util_record 20
2021-08-18:15:44:08,18 INFO     [oort.py:321] scores are 26,{5: 0.01626885400987658, 6: 0.043072102540190865, 7: 0.07499553118508201, 11: 0.012897823716460836, 14: 0.0059615398934565805, 27: 0.07981529924629467, 50: 0.003202141376253622, 51: 0.042178772613719294, 53: 0.04990828161722975, 58: 0.0024654782199968394, 60: 0.0010989728319356301, 67: 0.0013466134488748266, 70: 0.005256707005442365, 76: 0.0011899274247077433, 79: 0.03039058178238327, 81: 0.05672878098338758, 84: 0.12245718002868002, 85: 0.008350311896815963, 87: 0.008928924227649963, 93: 0.11957239086216923, 97: 0.023925317247694155, 98: 0.4864126765345503, 105: 0.019008329196592476, 107: 0.007149742420194442, 110: 0.022043865012620414, 113: 0.07499553118508201, 119: 0.012809577461199595},[98, 84, 93, 27, 7, 113, 81, 53, 6, 51, 79, 97, 110, 105, 5, 11, 119, 87, 85, 107, 14, 70, 50, 58, 67, 76, 60]
2021-08-18:15:44:08,19 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:44:08,19 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:08,20 INFO     [oort.py:398] At round 76, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 2191.6641968097556, 'duration': 13.411352670399307, 'time_stamp': 77, 'count': 74, 'status': True, 'gradient': 18.039493490839973}, [1.0, -3.8961544955129325e-06]), ({'reward': 469.95436168436345, 'duration': 57.39721143529741, 'time_stamp': 77, 'count': 46, 'status': True, 'gradient': 18.629079575204873}, [0.21442450648655476, -3.8961544955129325e-06]), ({'reward': 469.95436168436345, 'duration': 140.6940574361062, 'time_stamp': 77, 'count': 9, 'status': True, 'gradient': 18.629079575204873}, [0.21442450648655476, -3.8961544955129325e-06])]
2021-08-18:15:44:08,21 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:44:08,356 INFO     [param_server.py:553] For epoch: 78, median_reward: 349.4548949552047, dev: 698.9097899104094
2021-08-18:15:44:08,998 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4014, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:44:08,999 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 900.4136, eval_time 0.62, test_loss 2.4014, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:44:09,1 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4694, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:44:09,4 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 900.4209, eval_time 0.6244, test_loss 2.4694, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:44:09,75 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5567, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:44:09,75 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 900.4951, eval_time 0.6961, test_loss 2.5567, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:44:09,79 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:44:09,80 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:44:09,88 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:09,89 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:09,159 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:44:09,178 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:10,432 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:10,448 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:11,564 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:11,584 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:11,928 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:11,938 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:12,591 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:12,619 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:12,801 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:12,813 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:13,951 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:13,966 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:14,384 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:14,393 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:14,848 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:14,875 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:15,666 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:15,678 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:15,681 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:15,693 INFO     [learner.py:606] ====Pushing takes 0.01395416259765625 s
2021-08-18:15:44:15,720 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:15,725 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:15,726 INFO     [param_server.py:410] Lock worker 1 with localStep 78 , while globalStep is 77

2021-08-18:15:44:15,760 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:15,781 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:16,358 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:16,375 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:18,823 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:18,843 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:19,164 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:19,178 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:19,960 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:19,973 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:20,6 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:20,24 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:20,579 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:20,589 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:21,201 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:21,241 INFO     [learner.py:606] ====Pushing takes 0.03819775581359863 s
2021-08-18:15:44:21,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:21,309 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:21,310 INFO     [param_server.py:410] Lock worker 3 with localStep 78 , while globalStep is 77

2021-08-18:15:44:22,632 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:23,334 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:23,930 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:25,6 INFO     [learner.py:606] ====Pushing takes 0.03973507881164551 s
2021-08-18:15:44:25,129 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:25,162 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:25,163 INFO     [param_server.py:381] ====After aggregation in epoch: 77, virtual_clock: 2372.4484947286946, top_1: : 57.7606 % (1790.0), top_5: : 100.0 % (3099.0), test loss: 2.475822461975945, test len: 3099.0
2021-08-18:15:44:25,166 INFO     [param_server.py:410] Lock worker 2 with localStep 78 , while globalStep is 78

2021-08-18:15:44:25,167 INFO     [param_server.py:441] ====Epoch 79 completes 20 clients with loss 4.886524512701675, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:44:25,168 INFO     [param_server.py:450] ====Start to sample for epoch 79, global virtualClock: 2372.4484947286946, round_duration: 43.23839717093311
2021-08-18:15:44:25,183 INFO     [oort.py:208] Training selector: Pacer 77: lastExploitationUtil 359.1001046182718, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:44:25,184 INFO     [oort.py:321] scores are 26,{5: 0.02449283738601496, 6: 0.3414159815033574, 7: 0.07462561388382674, 11: 0.012834204883900205, 14: 0.006183100517802782, 27: 0.06519783026146464, 50: 0.012189539218076148, 51: 0.04197072478088215, 53: 0.1116827712140392, 58: 0.002557107715646786, 60: 0.0014052205576920902, 67: 0.0013966603363934655, 70: 0.005452072516190556, 76: 0.001234151076290498, 79: 0.007374937465306793, 81: 0.01956388972323022, 84: 0.03434233137572699, 85: 0.008309123778101439, 87: 0.008884882089389036, 93: 0.012975000076362885, 97: 0.3428305417417258, 98: 0.2249349287004698, 105: 0.02070810460705515, 107: 0.007415462590292025, 110: 0.00792163379132671, 113: 0.9811937878395143, 119: 0.002542003132676403},[113, 97, 6, 98, 53, 7, 27, 51, 84, 5, 105, 81, 93, 11, 50, 87, 85, 110, 107, 79, 14, 70, 58, 119, 60, 67, 76]
2021-08-18:15:44:25,185 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:44:25,185 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:25,186 INFO     [oort.py:398] At round 77, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 1443.3258116951988, 'duration': 8.009219946401625, 'time_stamp': 78, 'count': 2, 'status': True, 'gradient': 20.95270710247922}, [0.9065681802368366, -3.846203156450727e-06]), ({'reward': 148.3847761619467, 'duration': 11.058674649423494, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 20.22479681559383}, [0.09319641471530418, -3.846203156450727e-06]), ({'reward': 827.6214725657214, 'duration': 11.90395711384456, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 20.844880056077745}, [0.5198351077531268, -3.846203156450727e-06])]
2021-08-18:15:44:25,186 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:44:25,536 INFO     [param_server.py:553] For epoch: 79, median_reward: 325.4367718409721, dev: 650.8735436819442
2021-08-18:15:44:26,220 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.405, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:44:26,222 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 917.6366, eval_time 0.628, test_loss 2.405, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:44:26,256 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4278, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:44:26,257 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 917.6738, eval_time 0.6661, test_loss 2.4278, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:44:26,317 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2639, Top-1 Accuracy: 584.0/1033 (0.5653), Top-5 Accuracy: 1.0
2021-08-18:15:44:26,324 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:26,323 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 917.7425, eval_time 0.7534, test_loss 2.2639, test_accuracy 0.5653, test_5_accuracy 1.0 

2021-08-18:15:44:26,333 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:26,370 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:26,386 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:26,421 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:26,439 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:28,480 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:28,507 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:30,799 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:30,817 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:31,286 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:31,300 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:33,246 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:33,257 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:33,333 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:33,360 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:35,657 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:35,666 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:35,831 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:35,851 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:36,540 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:36,348 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:37,155 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:37,170 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:37,661 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:37,695 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:37,776 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:37,806 INFO     [learner.py:606] ====Pushing takes 0.023023128509521484 s
2021-08-18:15:44:37,839 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:37,846 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:37,847 INFO     [param_server.py:410] Lock worker 1 with localStep 79 , while globalStep is 78

2021-08-18:15:44:38,384 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:39,305 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:41,14 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:42,261 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:42,735 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:42,746 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:42,877 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:44,262 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:44,721 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:44,735 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:44,810 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:44,841 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:45,386 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:45,673 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:45,722 INFO     [learner.py:606] ====Pushing takes 0.04173445701599121 s
2021-08-18:15:44:45,775 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:45,786 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:45,787 INFO     [param_server.py:410] Lock worker 2 with localStep 79 , while globalStep is 78

2021-08-18:15:44:47,0 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:47,552 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:47,599 INFO     [learner.py:606] ====Pushing takes 0.039972543716430664 s
2021-08-18:15:44:47,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:47,686 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:47,687 INFO     [param_server.py:381] ====After aggregation in epoch: 78, virtual_clock: 2409.7920140017563, top_1: : 57.9542 % (1796.0), top_5: : 100.0 % (3099.0), test loss: 2.3655625272680214, test len: 3099.0
2021-08-18:15:44:47,696 INFO     [param_server.py:410] Lock worker 3 with localStep 79 , while globalStep is 79

2021-08-18:15:44:47,697 INFO     [param_server.py:441] ====Epoch 80 completes 20 clients with loss 5.790163927734576, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:44:47,697 INFO     [param_server.py:450] ====Start to sample for epoch 80, global virtualClock: 2409.7920140017563, round_duration: 37.343519273061496
2021-08-18:15:44:47,698 INFO     [oort.py:208] Training selector: Pacer 78: lastExploitationUtil 603.4109744230182, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:44:47,699 INFO     [oort.py:321] scores are 26,{5: 0.006911590700452561, 6: 0.04265072754916753, 7: 0.4535034176787598, 11: 0.032706749251770424, 14: 0.009004724993605608, 27: 0.056313245992081234, 50: 0.04586857698690799, 51: 0.410672735319141, 53: 0.060518781218759476, 58: 0.003724029989829255, 60: 0.0016618004983724617, 67: 0.0013525729824672597, 70: 0.007940096317718838, 76: 0.0017973492442117818, 79: 0.027540008478845628, 81: 0.17810303490663087, 84: 0.15286975615021214, 85: 0.05663433603940386, 87: 0.04304628256712307, 93: 0.06118466143242014, 97: 0.1542899262925749, 98: 0.03360191160167419, 105: 0.03448792794796846, 107: 0.010799468831808472, 110: 0.007883019523006029, 113: 0.31116050692645225, 119: 0.02755521795280937},[7, 51, 113, 81, 97, 84, 93, 53, 85, 27, 50, 87, 6, 105, 98, 11, 119, 79, 107, 14, 70, 110, 5, 58, 76, 60, 67]
2021-08-18:15:44:47,701 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:44:47,702 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:47,702 INFO     [oort.py:398] At round 78, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 461.65350460305984, 'duration': 21.635252629006885, 'time_stamp': 79, 'count': 29, 'status': True, 'gradient': 21.575841484865347}, [0.27764127030100466, -3.797516424258538e-06]), ({'reward': 630.58776148827, 'duration': 5.8943907365129, 'time_stamp': 79, 'count': 76, 'status': True, 'gradient': 21.162218735868965}, [0.37924157485482307, -3.797516424258538e-06]), ({'reward': 1090.647903279122, 'duration': 12.029357192292537, 'time_stamp': 79, 'count': 73, 'status': True, 'gradient': 27.073797716161167}, [0.6559305743558806, -3.797516424258538e-06])]
2021-08-18:15:44:47,703 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 5, 27, 79, 50, 105, 119, 107]
2021-08-18:15:44:48,217 INFO     [param_server.py:553] For epoch: 80, median_reward: 377.46204311944314, dev: 754.9240862388863
2021-08-18:15:44:50,32 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.093, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:44:50,103 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5763, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:44:51,335 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 942.7493, eval_time 3.0678, test_loss 2.093, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:44:51,335 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 942.7524, eval_time 3.0679, test_loss 2.5763, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:44:50,77 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5037, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:44:51,337 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 942.7569, eval_time 3.0764, test_loss 2.5037, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:44:51,429 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:51,446 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:51,477 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:51,488 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:51,498 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:51,508 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:54,584 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:54,594 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:56,490 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:56,602 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:56,616 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:56,631 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:57,41 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:57,56 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:57,714 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:58,698 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:59,361 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:59,769 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:00,501 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:00,505 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:01,194 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:01,432 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:01,570 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:02,41 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:02,44 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:02,47 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:02,668 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:02,735 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:02,753 INFO     [learner.py:606] ====Pushing takes 0.016469955444335938 s
2021-08-18:15:45:02,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:02,805 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:02,805 INFO     [param_server.py:410] Lock worker 1 with localStep 80 , while globalStep is 79

2021-08-18:15:45:03,52 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:03,135 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:03,166 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:06,52 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:45:06,87 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:45:06,149 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:06,159 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:06,741 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:45:06,762 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:45:06,826 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:06,837 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:45:07,379 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:45:07,447 INFO     [learner.py:606] ====Pushing takes 0.05938100814819336 s
2021-08-18:15:45:07,556 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:07,566 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:45:07,567 INFO     [param_server.py:410] Lock worker 2 with localStep 80 , while globalStep is 79

2021-08-18:15:45:07,615 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:45:07,643 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:45:08,330 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:45:08,371 INFO     [learner.py:606] ====Pushing takes 0.03885841369628906 s
2021-08-18:15:45:08,417 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:08,428 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:45:08,428 INFO     [param_server.py:381] ====After aggregation in epoch: 79, virtual_clock: 2454.158651091859, top_1: : 60.3098 % (1869.0), top_5: : 100.0 % (3099.0), test loss: 2.3909980213200606, test len: 3099.0
2021-08-18:15:45:08,433 INFO     [param_server.py:410] Lock worker 3 with localStep 80 , while globalStep is 80

2021-08-18:15:45:08,433 INFO     [param_server.py:441] ====Epoch 81 completes 20 clients with loss 5.2646220087576, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:45:08,434 INFO     [param_server.py:450] ====Start to sample for epoch 81, global virtualClock: 2454.158651091859, round_duration: 44.36663709010263
2021-08-18:15:45:08,435 INFO     [oort.py:208] Training selector: Pacer 79: lastExploitationUtil 583.1777922491453, lastExplorationUtil 0.0, last_util_record 20
2021-08-18:15:45:08,436 INFO     [oort.py:321] scores are 26,{5: 0.019867195847215295, 6: 0.042445240914079314, 7: 0.16587996804027993, 11: 0.07448555991391595, 14: 0.00756111642102215, 27: 0.0589418059119256, 50: 0.00394213779283769, 51: 0.04156491230905101, 53: 0.04918192778897591, 58: 0.003127005469736414, 60: 0.0013953859829844285, 67: 0.0017079313806542562, 70: 0.006667165593067405, 76: 0.0015092039895023886, 79: 0.03497906973783563, 81: 0.10465866780665918, 84: 0.1015622717116912, 85: 0.0691177074778388, 87: 0.06341466555770023, 93: 0.012849545562997023, 97: 0.05799028613308372, 98: 0.14164375001019705, 105: 0.04549786901262584, 107: 0.0018257029759371855, 110: 0.007894535987666998, 113: 0.9381606962908297, 119: 0.011407755302020066},[113, 7, 98, 81, 84, 11, 85, 87, 27, 97, 53, 105, 6, 51, 79, 5, 93, 119, 110, 14, 70, 50, 58, 107, 67, 76, 60]
2021-08-18:15:45:08,437 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:45:08,438 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:45:08,438 INFO     [oort.py:398] At round 79, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 714.5187837659028, 'duration': 21.753601635627824, 'time_stamp': 80, 'count': 74, 'status': True, 'gradient': 21.167637094499966}, [0.3591987856915178, -3.750046875585948e-06]), ({'reward': 1719.1666035486217, 'duration': 8.009219946401625, 'time_stamp': 80, 'count': 4, 'status': True, 'gradient': 20.96783890021533}, [0.864256638110079, -3.750046875585948e-06]), ({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 80, 'count': 77, 'status': True, 'gradient': 20.861236741691144}, [5.027212944410435e-09, -3.750046875585948e-06])]
2021-08-18:15:45:08,439 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:45:09,917 INFO     [param_server.py:541] Handle Wight 0.04678916931152344 | Send 1.4831371307373047
2021-08-18:15:45:09,918 INFO     [param_server.py:553] For epoch: 81, median_reward: 370.0857410726812, dev: 740.1714821453623
2021-08-18:15:45:10,505 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5006, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:45:10,506 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 961.9203, eval_time 0.5776, test_loss 2.5006, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:45:10,507 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4264, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:45:10,508 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 961.9253, eval_time 0.5796, test_loss 2.4264, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:45:10,510 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5261, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:45:10,535 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 961.9549, eval_time 0.6074, test_loss 2.5261, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:45:10,672 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:45:10,691 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:45:10,698 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:45:10,707 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:45:10,742 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:45:10,759 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:45:14,90 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:45:14,102 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:45:15,265 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:45:15,788 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:45:15,996 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:45:17,400 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:45:17,406 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:45:17,412 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:45:18,514 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:45:18,640 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:45:19,530 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:22,68 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:22,74 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:45:22,79 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:22,766 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:23,125 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:23,765 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:23,779 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:24,495 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:24,565 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:24,582 INFO     [learner.py:606] ====Pushing takes 0.015251398086547852 s
2021-08-18:15:45:24,614 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:24,673 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:24,673 INFO     [param_server.py:410] Lock worker 1 with localStep 81 , while globalStep is 80

2021-08-18:15:45:24,730 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:25,629 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:25,651 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:45:28,44 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:29,148 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:45:29,629 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:29,655 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:30,298 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:30,436 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:31,56 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:45:31,66 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:31,672 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:45:31,692 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:45:31,752 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:45:31,780 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:45:32,713 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:45:32,309 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:45:37,513 INFO     [learner.py:606] ====Pushing takes 0.06599307060241699 s
2021-08-18:15:45:37,573 INFO     [learner.py:606] ====Pushing takes 0.12384533882141113 s
2021-08-18:15:45:37,591 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:37,605 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:45:37,605 INFO     [param_server.py:410] Lock worker 2 with localStep 81 , while globalStep is 80

2021-08-18:15:45:37,644 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:37,661 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:45:37,662 INFO     [param_server.py:381] ====After aggregation in epoch: 80, virtual_clock: 2491.502170364921, top_1: : 56.6957 % (1757.0), top_5: : 100.0 % (3099.0), test loss: 2.48433310897262, test len: 3099.0
2021-08-18:15:45:41,480 INFO     [param_server.py:410] Lock worker 3 with localStep 81 , while globalStep is 81

2021-08-18:15:45:41,481 INFO     [param_server.py:441] ====Epoch 82 completes 20 clients with loss 6.834811425337218, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:45:41,482 INFO     [param_server.py:450] ====Start to sample for epoch 82, global virtualClock: 2491.502170364921, round_duration: 37.343519273061496
2021-08-18:15:45:41,484 INFO     [oort.py:208] Training selector: Pacer 80: lastExploitationUtil 411.7104932871036, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:45:41,485 INFO     [oort.py:321] scores are 26,{5: 0.0480466778172449, 6: 0.2928661316358802, 7: 0.998531367882853, 11: 0.012649579471325851, 14: 0.007191013667191568, 27: 0.006485723956202186, 50: 0.022132632918554527, 51: 0.06273209384214751, 53: 0.29717371802671494, 58: 0.0029739442984555347, 60: 0.0013270844034024391, 67: 0.002160443012419, 70: 0.006340820089461844, 76: 0.0014353312276634133, 79: 0.003282796861567939, 81: 0.034327894442136485, 84: 0.24858228376451258, 85: 0.008189593552462937, 87: 0.00875706933929918, 93: 0.11022795316667999, 97: 0.09159685427184407, 98: 0.03328076221612891, 105: 0.02655760593079152, 107: 0.00862426426382716, 110: 0.00780767777143947, 113: 1.073552086479741, 119: 0.002505435352951738},[113, 7, 53, 6, 84, 93, 97, 51, 5, 81, 98, 105, 50, 11, 87, 107, 85, 110, 14, 27, 70, 79, 58, 119, 67, 76, 60]
2021-08-18:15:45:41,487 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:45:41,488 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:45:41,488 INFO     [oort.py:398] At round 80, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 651.9881902207973, 'duration': 11.90395711384456, 'time_stamp': 81, 'count': 78, 'status': True, 'gradient': 20.86789132125011}, [0.43637544927634514, -3.7037494290052997e-06]), ({'reward': 1381.9995774775052, 'duration': 5.8943907365129, 'time_stamp': 81, 'count': 78, 'status': True, 'gradient': 21.17778616168934}, [0.9249792814031119, -3.7037494290052997e-06]), ({'reward': 1494.0862523149235, 'duration': 8.009219946401625, 'time_stamp': 81, 'count': 5, 'status': True, 'gradient': 20.975424753451367}, [1.0, -3.7037494290052997e-06])]
2021-08-18:15:45:41,490 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:45:43,115 INFO     [param_server.py:553] For epoch: 82, median_reward: 337.7941003684952, dev: 675.5882007369904
2021-08-18:15:45:43,843 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7977, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:45:43,845 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 995.2589, eval_time 0.6634, test_loss 2.7977, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:45:43,909 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3618, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:45:43,926 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 995.3457, eval_time 0.7502, test_loss 2.3618, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:45:43,877 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9622, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:15:45:43,969 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 995.3866, eval_time 0.7881, test_loss 2.9622, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:15:45:43,998 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:44,19 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:45:44,71 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:44,90 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:44,92 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:45:44,108 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:45:46,928 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:45:46,940 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:45:48,108 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:45:48,118 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:45:48,188 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:45:48,197 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:45:48,225 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:45:48,242 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:45:49,537 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:45:49,553 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:45:49,618 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:45:49,644 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:50,367 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:50,394 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:50,741 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:50,837 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:51,67 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:51,86 INFO     [learner.py:606] ====Pushing takes 0.017183780670166016 s
2021-08-18:15:45:51,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:51,188 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:51,188 INFO     [param_server.py:410] Lock worker 1 with localStep 82 , while globalStep is 81

2021-08-18:15:45:52,56 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:52,68 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:52,732 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:52,752 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:52,948 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:52,969 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:45:55,800 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:55,814 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:56,156 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:45:56,175 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:56,485 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:00,77 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:00,775 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:00,793 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:01,159 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:01,183 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:01,363 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:01,399 INFO     [learner.py:606] ====Pushing takes 0.03558659553527832 s
2021-08-18:15:46:01,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:01,467 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:01,468 INFO     [param_server.py:410] Lock worker 3 with localStep 82 , while globalStep is 81

2021-08-18:15:46:04,497 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:04,659 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:05,238 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:05,277 INFO     [learner.py:606] ====Pushing takes 0.035166025161743164 s
2021-08-18:15:46:05,323 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:05,336 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:05,337 INFO     [param_server.py:381] ====After aggregation in epoch: 81, virtual_clock: 2535.8688074550237, top_1: : 59.7935 % (1853.0), top_5: : 100.0 % (3099.0), test loss: 2.707255275161178, test len: 3099.0
2021-08-18:15:46:05,348 INFO     [param_server.py:410] Lock worker 2 with localStep 82 , while globalStep is 82

2021-08-18:15:46:05,349 INFO     [param_server.py:441] ====Epoch 83 completes 20 clients with loss 5.381334442337784, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:05,350 INFO     [param_server.py:450] ====Start to sample for epoch 83, global virtualClock: 2535.8688074550237, round_duration: 44.36663709010263
2021-08-18:15:46:05,351 INFO     [oort.py:208] Training selector: Pacer 81: lastExploitationUtil 454.1421996486829, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:46:05,351 INFO     [oort.py:321] scores are 26,{5: 0.006813301135930926, 6: 0.23123256752042123, 7: 0.07320577287830751, 11: 0.12849906130406405, 14: 0.0069242156320756375, 27: 0.013413667450701766, 50: 0.012516101682212934, 51: 0.041172181854749204, 53: 0.09941306598695629, 58: 0.00286360623874746, 60: 0.0011861657883066405, 67: 0.0015640660063848105, 70: 0.0061055655872196395, 76: 0.0013820781580679146, 79: 0.047899609270597825, 81: 0.03222479096877538, 84: 0.12197463549237976, 85: 0.044114883941478764, 87: 0.019375145656633702, 93: 0.05773275082658712, 97: 0.24770811506544196, 98: 0.05032371567100099, 105: 0.005073867437146044, 107: 0.00830429035383343, 110: 0.03698309843279677, 113: 0.726594985897428, 119: 0.011053171543027193},[113, 97, 6, 11, 84, 53, 7, 93, 98, 79, 85, 51, 110, 81, 87, 27, 50, 119, 107, 14, 5, 70, 105, 58, 67, 76, 60]
2021-08-18:15:46:05,353 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:46:05,353 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:05,354 INFO     [oort.py:398] At round 81, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 568.9210467652871, 'duration': 11.90395711384456, 'time_stamp': 82, 'count': 79, 'status': True, 'gradient': 20.87949510290784}, [0.32940771601967794, -3.658581202209786e-06]), ({'reward': 1128.4606390722843, 'duration': 8.009219946401625, 'time_stamp': 82, 'count': 6, 'status': True, 'gradient': 20.98442633232686}, [0.6533892188092648, -3.658581202209786e-06]), ({'reward': 1214.5775200892872, 'duration': 15.972045438625893, 'time_stamp': 82, 'count': 79, 'status': True, 'gradient': 20.98117994782284}, [0.703252136306143, -3.658581202209786e-06])]
2021-08-18:15:46:05,355 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:46:09,578 INFO     [param_server.py:553] For epoch: 83, median_reward: 345.55877245282875, dev: 691.1175449056575
2021-08-18:15:46:10,127 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0019, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:46:10,134 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 1021.5485, eval_time 0.5267, test_loss 3.0019, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:46:10,179 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4531, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:46:10,180 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 1021.5967, eval_time 0.5719, test_loss 2.4531, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:46:10,275 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5665, Top-1 Accuracy: 590.0/1033 (0.5712), Top-5 Accuracy: 1.0
2021-08-18:15:46:11,554 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 1022.9736, eval_time 1.9527, test_loss 2.5665, test_accuracy 0.5712, test_5_accuracy 1.0 

2021-08-18:15:46:11,577 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:46:11,578 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:46:11,586 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:11,602 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:11,697 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:46:11,717 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:12,876 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:12,890 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:14,128 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:14,146 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:14,507 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:14,517 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:14,962 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:14,982 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:15,200 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:15,210 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:16,522 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:16,549 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:16,871 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:16,880 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:17,261 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:17,288 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:17,704 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:17,722 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:17,997 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:17,999 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:18,7 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:18,24 INFO     [learner.py:606] ====Pushing takes 0.023708343505859375 s
2021-08-18:15:46:18,58 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:18,235 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:18,306 INFO     [param_server.py:410] Lock worker 1 with localStep 83 , while globalStep is 82

2021-08-18:15:46:18,617 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:18,629 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:24,649 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:24,602 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:25,684 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:25,691 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:26,283 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:26,374 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:26,431 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:26,460 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:27,50 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:27,75 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:27,87 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:27,107 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:27,750 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:27,788 INFO     [learner.py:606] ====Pushing takes 0.036904335021972656 s
2021-08-18:15:46:27,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:27,852 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:27,855 INFO     [param_server.py:410] Lock worker 3 with localStep 83 , while globalStep is 82

2021-08-18:15:46:28,24 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:28,58 INFO     [learner.py:606] ====Pushing takes 0.03380227088928223 s
2021-08-18:15:46:28,93 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:28,102 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:28,103 INFO     [param_server.py:381] ====After aggregation in epoch: 82, virtual_clock: 2573.2123267280854, top_1: : 57.2443 % (1774.0), top_5: : 100.0 % (3099.0), test loss: 2.673841873804728, test len: 3099.0
2021-08-18:15:46:28,107 INFO     [param_server.py:410] Lock worker 2 with localStep 83 , while globalStep is 83

2021-08-18:15:46:28,108 INFO     [param_server.py:441] ====Epoch 84 completes 20 clients with loss 6.128178970482661, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:28,108 INFO     [param_server.py:450] ====Start to sample for epoch 84, global virtualClock: 2573.2123267280854, round_duration: 37.343519273061496
2021-08-18:15:46:28,109 INFO     [oort.py:208] Training selector: Pacer 82: lastExploitationUtil 279.4866435266257, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:46:28,110 INFO     [oort.py:321] scores are 26,{5: 0.09272532783424998, 6: 0.2785027879396945, 7: 0.07286495634026602, 11: 0.015146621585219502, 14: 0.007681346752914936, 27: 0.09019723927226253, 50: 0.00339334108788359, 51: 0.21573673341017696, 53: 0.04849041941022383, 58: 0.0031767284054144947, 60: 0.0014175742036797632, 67: 0.002609603358708856, 70: 0.006773181092287862, 76: 0.0015332020456687106, 79: 0.0032521283851162847, 81: 0.0191023148264901, 84: 0.23251715572462575, 85: 0.008113084902185878, 87: 0.019950038588613595, 93: 0.012668878215875245, 97: 0.32545957807218934, 98: 0.19217064668814712, 105: 0.045453845147052994, 107: 0.009212326295730886, 110: 0.007734737046815673, 113: 0.07286495634026602, 119: 0.021444179210083975},[97, 6, 84, 51, 98, 5, 27, 7, 113, 53, 105, 119, 87, 81, 11, 93, 107, 85, 110, 14, 70, 50, 79, 58, 67, 76, 60]
2021-08-18:15:46:28,111 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:46:28,112 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:28,112 INFO     [oort.py:398] At round 82, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 884.9063893888089, 'duration': 30.380154975061778, 'time_stamp': 83, 'count': 75, 'status': True, 'gradient': 14.965313626557988}, [0.950027146579582, -3.6145013795346962e-06]), ({'reward': 402.75953470060495, 'duration': 13.298442137908651, 'time_stamp': 83, 'count': 80, 'status': True, 'gradient': 20.992724079939126}, [0.43239299086584176, -3.6145013795346962e-06]), ({'reward': 383.8146149653351, 'duration': 11.90395711384456, 'time_stamp': 83, 'count': 80, 'status': True, 'gradient': 20.88851717133176}, [0.4120536742512541, -3.6145013795346962e-06])]
2021-08-18:15:46:28,134 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:46:28,672 INFO     [param_server.py:553] For epoch: 84, median_reward: 308.07018865975664, dev: 616.1403773195133
2021-08-18:15:46:29,427 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5795, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:46:29,428 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 1040.845, eval_time 0.7176, test_loss 2.5795, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:46:29,434 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4125, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:46:29,435 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 1040.849, eval_time 0.7245, test_loss 2.4125, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:46:29,436 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3617, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:46:29,440 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 1040.8599, eval_time 0.7337, test_loss 2.3617, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:46:29,541 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:29,549 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:29,555 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:29,564 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:29,569 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:29,580 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:31,226 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:31,237 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:32,384 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:32,395 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:32,415 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:32,425 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:32,559 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:32,570 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:33,899 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:33,898 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:33,916 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:33,917 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:34,626 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:34,652 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:34,825 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:34,835 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:35,391 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:35,412 INFO     [learner.py:606] ====Pushing takes 0.016781091690063477 s
2021-08-18:15:46:35,430 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:35,499 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:35,500 INFO     [param_server.py:410] Lock worker 1 with localStep 84 , while globalStep is 83

2021-08-18:15:46:35,993 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:36,3 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:36,610 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:40,329 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:40,942 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:40,969 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:44,743 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:44,851 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:45,292 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:45,355 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:45,592 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:45,759 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:46,458 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:46,476 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:46,504 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:46,517 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:47,140 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:47,188 INFO     [learner.py:606] ====Pushing takes 0.047016143798828125 s
2021-08-18:15:46:47,242 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:47,253 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:47,256 INFO     [param_server.py:410] Lock worker 3 with localStep 84 , while globalStep is 83

2021-08-18:15:46:48,956 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:48,966 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:49,614 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:49,651 INFO     [learner.py:606] ====Pushing takes 0.03625941276550293 s
2021-08-18:15:46:49,717 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:49,726 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:49,727 INFO     [param_server.py:381] ====After aggregation in epoch: 83, virtual_clock: 2617.578963818188, top_1: : 58.1801 % (1803.0), top_5: : 100.0 % (3099.0), test loss: 2.451237808775019, test len: 3099.0
2021-08-18:15:46:49,731 INFO     [param_server.py:410] Lock worker 2 with localStep 84 , while globalStep is 84

2021-08-18:15:46:49,732 INFO     [param_server.py:441] ====Epoch 85 completes 20 clients with loss 4.110193419172026, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:49,732 INFO     [param_server.py:450] ====Start to sample for epoch 85, global virtualClock: 2617.578963818188, round_duration: 44.36663709010263
2021-08-18:15:46:49,733 INFO     [oort.py:208] Training selector: Pacer 83: lastExploitationUtil 530.2852540162066, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:46:49,734 INFO     [oort.py:321] scores are 26,{5: 0.025254466429314126, 6: 0.04165577797609706, 7: 0.2703238503070536, 11: 0.09240699778483887, 14: 0.00845299974644104, 27: 0.054771383757760826, 50: 0.03468263977643589, 51: 0.0407918230985338, 53: 0.2393379691611042, 58: 0.0034958562956802558, 60: 0.0009542290858892194, 67: 0.001909393100662962, 70: 0.007453601548970792, 76: 0.0016872245089524622, 79: 0.0032371553109817697, 81: 0.12129626779723703, 84: 0.15547644604181213, 85: 0.06987702641729658, 87: 0.08815657012752362, 93: 0.012610549629096326, 97: 0.34216182626669567, 98: 0.03281805140693549, 105: 0.026474777428129478, 107: 0.010137778484273519, 110: 0.034078756918122774, 113: 0.5444296520305572, 119: 0.008221754128686691},[113, 97, 7, 53, 84, 81, 11, 87, 85, 27, 6, 51, 50, 110, 98, 105, 5, 93, 107, 14, 119, 70, 58, 79, 67, 76, 60]
2021-08-18:15:46:49,767 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:46:49,767 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:49,768 INFO     [oort.py:398] At round 83, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 740.6972817463222, 'duration': 8.009219946401625, 'time_stamp': 84, 'count': 8, 'status': True, 'gradient': 20.999404133333027}, [0.4719001784829628, -3.5714710889415383e-06]), ({'reward': 1569.5946723526124, 'duration': 15.972045438625893, 'time_stamp': 84, 'count': 81, 'status': True, 'gradient': 20.997149974591224}, [1.0, -3.5714710889415383e-06]), ({'reward': 612.3833132992518, 'duration': 17.619275735353515, 'time_stamp': 84, 'count': 80, 'status': True, 'gradient': 23.287586414523897}, [0.39014991047273745, -3.5714710889415383e-06])]
2021-08-18:15:46:49,769 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:46:50,312 INFO     [param_server.py:553] For epoch: 85, median_reward: 360.9546280323897, dev: 721.9092560647794
2021-08-18:15:46:50,932 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.178, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:46:50,933 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1062.3473, eval_time 0.5853, test_loss 2.178, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:46:50,970 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6216, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:46:50,971 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1062.3877, eval_time 0.6241, test_loss 2.6216, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:46:51,54 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:51,53 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4872, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:46:51,56 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1062.4759, eval_time 0.7098, test_loss 2.4872, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:46:51,71 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:51,114 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:51,122 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:51,137 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:51,164 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:52,430 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:52,459 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:53,733 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:53,774 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:53,994 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:54,3 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:55,73 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:55,100 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:55,145 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:55,163 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:56,355 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:56,364 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:56,657 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:56,685 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:57,478 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:57,490 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:57,500 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:57,505 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:57,804 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:57,822 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:58,110 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:58,112 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:58,124 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:58,129 INFO     [learner.py:606] ====Pushing takes 0.01562190055847168 s
2021-08-18:15:46:58,160 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:58,240 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:58,241 INFO     [param_server.py:410] Lock worker 1 with localStep 85 , while globalStep is 84

2021-08-18:15:47:00,454 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:47:04,6 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:47:04,593 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:47:04,642 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:47:04,661 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:47:04,681 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:47:05,337 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:47:05,346 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:47:05,351 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:47:05,360 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:47:05,895 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:47:05,910 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:47:06,8 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:47:06,50 INFO     [learner.py:606] ====Pushing takes 0.04083085060119629 s
2021-08-18:15:47:06,132 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:06,145 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:47:06,145 INFO     [param_server.py:410] Lock worker 3 with localStep 85 , while globalStep is 84

2021-08-18:15:47:06,821 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:47:13,481 INFO     [learner.py:606] ====Pushing takes 0.046639204025268555 s
2021-08-18:15:47:13,541 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:13,552 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:47:13,553 INFO     [param_server.py:381] ====After aggregation in epoch: 84, virtual_clock: 2654.92248309125, top_1: : 59.1804 % (1834.0), top_5: : 100.0 % (3099.0), test loss: 2.428953303231133, test len: 3099.0
2021-08-18:15:47:13,589 INFO     [param_server.py:410] Lock worker 2 with localStep 85 , while globalStep is 85

2021-08-18:15:47:13,590 INFO     [param_server.py:441] ====Epoch 86 completes 20 clients with loss 5.3119044458896685, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:47:13,590 INFO     [param_server.py:450] ====Start to sample for epoch 86, global virtualClock: 2654.92248309125, round_duration: 37.343519273061496
2021-08-18:15:47:13,591 INFO     [oort.py:208] Training selector: Pacer 84: lastExploitationUtil 548.1672013297687, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:47:13,592 INFO     [oort.py:321] scores are 26,{5: 0.006719620212742579, 6: 0.6148489865075102, 7: 0.6371312633261855, 11: 0.18439813887664605, 14: 0.008907701614573393, 27: 0.06251142802931668, 50: 0.0030827449166586666, 51: 0.06524667124019326, 53: 0.6164193286596148, 58: 0.003683904614152916, 60: 0.0016438950654198716, 67: 0.0019594163607708267, 70: 0.007854544013219436, 76: 0.001777983311648793, 79: 0.034047567715696204, 81: 0.018927783636417735, 84: 0.19810153714965173, 85: 0.049346140166650926, 87: 0.008595996409821914, 93: 0.012553127092936347, 97: 0.023033227287130666, 98: 0.08765001118908941, 105: 0.0030588490522017214, 107: 0.010683107592730187, 110: 0.07318879181273454, 113: 0.0721992146403647, 119: 0.03476612945269553},[7, 53, 6, 84, 11, 98, 110, 113, 51, 27, 85, 119, 79, 97, 81, 93, 107, 14, 87, 70, 5, 58, 50, 105, 67, 76, 60]
2021-08-18:15:47:13,593 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:47:13,594 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:47:13,594 INFO     [oort.py:398] At round 84, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1299.5731565544447, 'duration': 11.058674649423494, 'time_stamp': 85, 'count': 82, 'status': True, 'gradient': 20.28122849782871}, [0.8540738169203447, -3.5294532876857404e-06]), ({'reward': 1519.1088251977421, 'duration': 11.90395711384456, 'time_stamp': 85, 'count': 82, 'status': True, 'gradient': 20.90333899629153}, [0.9983528110422405, -3.5294532876857404e-06]), ({'reward': 859.6135465945059, 'duration': 5.8943907365129, 'time_stamp': 85, 'count': 82, 'status': True, 'gradient': 21.21306928760449}, [0.5649320552578277, -3.5294532876857404e-06])]
2021-08-18:15:47:13,596 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 27, 79, 50, 105, 119, 107]
2021-08-18:15:47:13,987 INFO     [param_server.py:553] For epoch: 86, median_reward: 366.9190613111144, dev: 733.8381226222288
2021-08-18:15:47:14,701 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.226, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:47:14,703 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1086.1168, eval_time 0.6817, test_loss 2.226, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:47:14,758 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3008, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:47:14,762 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1086.1796, eval_time 0.742, test_loss 2.3008, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:47:14,796 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5828, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:47:22,42 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1093.4615, eval_time 8.0216, test_loss 2.5828, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:47:22,43 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:47:22,95 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:47:22,190 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:47:22,211 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:47:22,261 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:47:22,287 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:47:29,174 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:47:29,297 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:47:29,934 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:47:29,952 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:47:30,608 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:47:30,640 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:47:37,617 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:47:37,621 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:47:38,515 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:47:38,590 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:47:38,869 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:47:38,887 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:47:39,107 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:47:39,141 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:47:39,730 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:47:39,744 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:47:39,864 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:47:39,885 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:47:40,415 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:47:40,429 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:47:40,559 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:47:40,578 INFO     [learner.py:606] ====Pushing takes 0.01716303825378418 s
2021-08-18:15:47:40,607 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:40,722 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:47:40,723 INFO     [param_server.py:410] Lock worker 1 with localStep 86 , while globalStep is 85

2021-08-18:15:47:49,763 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:47:49,885 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:47:50,916 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:47:50,931 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:47:51,629 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:47:51,640 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:47:52,286 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:47:52,302 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:47:52,973 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:47:53,14 INFO     [learner.py:606] ====Pushing takes 0.036856651306152344 s
2021-08-18:15:47:53,68 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:53,83 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:47:53,84 INFO     [param_server.py:410] Lock worker 3 with localStep 86 , while globalStep is 85

2021-08-18:15:47:53,323 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:47:53,334 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:48:08,293 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:48:08,380 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:48:09,3 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:48:14,6 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:48:14,509 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:48:14,545 INFO     [learner.py:606] ====Pushing takes 0.03434920310974121 s
2021-08-18:15:48:14,593 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:48:14,660 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:48:14,661 INFO     [param_server.py:381] ====After aggregation in epoch: 85, virtual_clock: 2699.2891201813527, top_1: : 60.0839 % (1862.0), top_5: : 100.0 % (3099.0), test loss: 2.369888641216137, test len: 3099.0
2021-08-18:15:48:14,665 INFO     [param_server.py:410] Lock worker 2 with localStep 86 , while globalStep is 86

2021-08-18:15:48:14,665 INFO     [param_server.py:441] ====Epoch 87 completes 20 clients with loss 4.016092394722962, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:48:14,665 INFO     [param_server.py:450] ====Start to sample for epoch 87, global virtualClock: 2699.2891201813527, round_duration: 44.36663709010263
2021-08-18:15:48:14,667 INFO     [oort.py:208] Training selector: Pacer 85: lastExploitationUtil 533.6620846324502, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:48:14,667 INFO     [oort.py:321] scores are 26,{5: 0.006728587893200143, 6: 0.041279326178722556, 7: 0.1518488070446475, 11: 0.012360981721072285, 14: 0.006404833116863464, 27: 0.05476481889572554, 50: 0.0030688596689102112, 51: 0.07570366465027463, 53: 0.0478309651583598, 58: 0.0026488083338456906, 60: 0.0011819966598818176, 67: 0.0014467460701611478, 70: 0.005647589669081972, 76: 0.0012784090541434398, 79: 0.003207900475412529, 81: 0.018842529432055707, 84: 0.048589865670798545, 85: 0.008002749532858216, 87: 0.061077964970783626, 93: 0.09641812471397737, 97: 0.17328494159420335, 98: 0.22718824221207007, 105: 0.045411862456111105, 107: 0.003949502853059379, 110: 0.024184572143927982, 113: 0.13435518659964588, 119: 0.03392168187832021},[98, 97, 7, 113, 93, 51, 87, 27, 84, 53, 105, 6, 119, 110, 81, 11, 85, 5, 14, 70, 107, 79, 50, 58, 67, 76, 60]
2021-08-18:15:48:14,668 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:48:14,669 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:48:14,669 INFO     [oort.py:398] At round 85, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 960.3697122597482, 'duration': 13.411352670399307, 'time_stamp': 86, 'count': 83, 'status': True, 'gradient': 18.106875382886003}, [0.430222985097021, -3.4884126559611187e-06]), ({'reward': 0.01, 'duration': 27.035726288496562, 'time_stamp': 86, 'count': 79, 'status': True, 'gradient': 19.980310430735596}, [4.479810795112055e-09, -3.4884126559611187e-06]), ({'reward': 348.1415034229691, 'duration': 27.689063957948644, 'time_stamp': 86, 'count': 78, 'status': True, 'gradient': 20.49546635192225}, [0.15595633119509777, -3.4884126559611187e-06])]
2021-08-18:15:48:14,679 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:48:15,47 INFO     [param_server.py:553] For epoch: 87, median_reward: 359.35729649264084, dev: 718.7145929852817
2021-08-18:15:48:15,743 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5472, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:48:15,753 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1147.1676, eval_time 0.6757, test_loss 2.5472, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:48:15,780 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6224, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:48:15,781 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1147.1979, eval_time 0.703, test_loss 2.6224, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:48:15,849 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5528, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:48:15,852 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1147.2715, eval_time 0.7761, test_loss 2.5528, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:48:15,876 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:48:15,882 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:48:15,886 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:48:15,900 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:48:15,952 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:48:15,974 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:48:24,975 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:48:24,995 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:48:26,192 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:48:26,219 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:48:26,312 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:48:26,321 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:48:27,167 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:48:27,207 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:48:27,353 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:48:27,372 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:48:28,569 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:48:28,583 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:48:28,809 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:48:28,836 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:48:29,509 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:48:29,529 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:48:29,648 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:48:29,658 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:48:29,761 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:48:29,771 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:48:30,479 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:48:30,145 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:48:52,558 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:48:52,576 INFO     [learner.py:606] ====Pushing takes 0.02720952033996582 s
2021-08-18:15:48:52,599 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:48:52,725 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:48:52,726 INFO     [param_server.py:410] Lock worker 1 with localStep 87 , while globalStep is 86

2021-08-18:15:48:54,635 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:48:54,683 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:48:54,736 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:48:54,816 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:48:55,506 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:48:55,454 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:49:18,389 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:49:18,390 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:49:18,900 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:49:18,958 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:49:18,980 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:49:18,982 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:49:19,531 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:49:19,567 INFO     [learner.py:606] ====Pushing takes 0.03439164161682129 s
2021-08-18:15:49:19,619 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:49:19,634 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:49:19,635 INFO     [param_server.py:410] Lock worker 3 with localStep 87 , while globalStep is 86

2021-08-18:15:49:19,785 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:49:19,819 INFO     [learner.py:606] ====Pushing takes 0.031697988510131836 s
2021-08-18:15:49:19,854 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:49:19,872 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:49:19,873 INFO     [param_server.py:381] ====After aggregation in epoch: 86, virtual_clock: 2736.6326394544144, top_1: : 59.6967 % (1850.0), top_5: : 100.0 % (3099.0), test loss: 2.5741529067357383, test len: 3099.0
2021-08-18:15:49:19,878 INFO     [param_server.py:410] Lock worker 2 with localStep 87 , while globalStep is 87

2021-08-18:15:49:19,907 INFO     [param_server.py:441] ====Epoch 88 completes 20 clients with loss 6.623253487875115, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:49:19,907 INFO     [param_server.py:450] ====Start to sample for epoch 88, global virtualClock: 2736.6326394544144, round_duration: 37.343519273061496
2021-08-18:15:49:19,908 INFO     [oort.py:208] Training selector: Pacer 86: lastExploitationUtil 418.2479142726235, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:49:19,909 INFO     [oort.py:321] scores are 26,{5: 0.08469525213578417, 6: 0.1422870158261933, 7: 0.2050072055906511, 11: 0.012305903416607637, 14: 0.007103337603176129, 27: 0.08144579126330476, 50: 0.018944024779463716, 51: 0.04024306064542117, 53: 0.7131012418504589, 58: 0.002937684635665661, 60: 0.0013109039951190483, 67: 0.0019573594364650673, 70: 0.006263509966883373, 76: 0.0014178310255466894, 79: 0.005946406819640896, 81: 0.07649536620147288, 84: 0.03292867901314054, 85: 0.028492044165375194, 87: 0.008680099879458378, 93: 0.012440902978765314, 97: 0.17076368551477242, 98: 0.3708354888319001, 105: 0.003031503146856797, 107: 0.008519113365681712, 110: 0.007595551202403563, 112: 0.2604711194412997, 113: 0.07155375850446542, 119: 0.016550391961331398},[53, 98, 112, 7, 97, 6, 5, 27, 81, 113, 51, 84, 85, 50, 119, 93, 11, 87, 107, 110, 14, 70, 79, 105, 58, 67, 76, 60]
2021-08-18:15:49:19,910 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:49:19,910 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:49:19,911 INFO     [oort.py:398] At round 86, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 204.23938495628167, 'duration': 5.8943907365129, 'time_stamp': 87, 'count': 84, 'status': True, 'gradient': 21.23632296803618}, [0.13345345362067373, -3.448315497879289e-06]), ({'reward': 709.6548946123497, 'duration': 15.972045438625893, 'time_stamp': 87, 'count': 84, 'status': True, 'gradient': 21.03056473744575}, [0.4637166132970455, -3.448315497879289e-06]), ({'reward': 1530.3517639699755, 'duration': 11.058674649423494, 'time_stamp': 87, 'count': 84, 'status': True, 'gradient': 20.30437668734097}, [1.0, -3.448315497879289e-06])]
2021-08-18:15:49:19,919 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 119, 107]
2021-08-18:15:49:20,280 INFO     [param_server.py:553] For epoch: 88, median_reward: 338.7979145460275, dev: 677.595829092055
2021-08-18:15:49:20,877 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3745, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:49:20,877 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1212.2916, eval_time 0.5629, test_loss 2.3745, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:49:20,917 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3997, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:49:20,918 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1212.335, eval_time 0.604, test_loss 2.3997, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:49:20,938 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:49:20,950 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:49:21,2 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:49:21,17 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:49:21,31 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4718, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:49:21,56 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1212.4754, eval_time 0.7421, test_loss 2.4718, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:49:21,151 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:49:21,181 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:49:22,640 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:49:22,658 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:49:23,512 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:49:23,522 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:49:23,803 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:49:23,817 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:49:24,641 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:49:24,667 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:49:24,952 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:49:24,966 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:49:25,755 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:49:26,627 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:50:06,282 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:50:06,298 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:50:07,2 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:50:07,29 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:50:07,459 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:50:07,476 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:50:07,649 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:50:07,669 INFO     [learner.py:606] ====Pushing takes 0.019085168838500977 s
2021-08-18:15:50:07,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:07,712 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:50:07,712 INFO     [param_server.py:410] Lock worker 1 with localStep 88 , while globalStep is 87

2021-08-18:15:50:08,99 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:50:08,108 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:50:08,288 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:50:08,315 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:50:10,854 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:50:10,865 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:50:11,198 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:50:11,210 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:50:11,536 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:50:11,546 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:50:12,152 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:50:12,180 INFO     [learner.py:606] ====Pushing takes 0.02674722671508789 s
2021-08-18:15:50:12,229 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:12,239 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:50:12,240 INFO     [param_server.py:410] Lock worker 3 with localStep 88 , while globalStep is 87

2021-08-18:15:50:12,372 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:50:12,383 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:50:14,695 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:50:14,706 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:50:15,287 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:50:15,297 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:50:15,873 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:50:15,912 INFO     [learner.py:606] ====Pushing takes 0.03729128837585449 s
2021-08-18:15:50:15,961 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:15,973 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:50:15,973 INFO     [param_server.py:381] ====After aggregation in epoch: 87, virtual_clock: 2780.999276544517, top_1: : 58.89 % (1825.0), top_5: : 100.0 % (3099.0), test loss: 2.4153021971384683, test len: 3099.0
2021-08-18:15:50:15,978 INFO     [param_server.py:410] Lock worker 2 with localStep 88 , while globalStep is 88

2021-08-18:15:50:15,979 INFO     [param_server.py:441] ====Epoch 89 completes 20 clients with loss 4.352844810851253, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 107: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:50:15,980 INFO     [param_server.py:450] ====Start to sample for epoch 89, global virtualClock: 2780.999276544517, round_duration: 44.36663709010263
2021-08-18:15:50:15,980 INFO     [oort.py:208] Training selector: Pacer 87: lastExploitationUtil 377.16826698188794, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:50:15,981 INFO     [oort.py:321] scores are 26,{5: 0.019919507402077333, 6: 0.19365106125674938, 7: 0.0712383088312987, 11: 0.15030886066485422, 14: 0.007224144126981934, 27: 0.040502236719165606, 50: 0.0030417163886747914, 51: 0.07605923777864938, 53: 0.1846109604687372, 58: 0.0029876458635698234, 60: 0.0013331985506562457, 67: 0.0016318149021667398, 70: 0.006370033534844419, 76: 0.001568775952636221, 79: 0.013437564976497013, 81: 0.17497546242804807, 84: 0.07587447453108252, 85: 0.00793196725648864, 87: 0.008481591524311006, 93: 0.012386056401023271, 97: 0.03763676388948872, 98: 0.27632014375541597, 105: 0.003035434619174831, 107: 0.0017598490094928854, 110: 0.11371373829248813, 113: 0.6771448501138535, 119: 0.02314027711830016},[113, 98, 6, 53, 81, 11, 110, 51, 84, 7, 27, 97, 119, 5, 79, 93, 87, 85, 14, 70, 50, 105, 58, 107, 67, 76, 60]
2021-08-18:15:50:15,982 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:50:15,983 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:50:15,984 INFO     [oort.py:398] At round 87, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1083.3257519056554, 'duration': 21.753601635627824, 'time_stamp': 88, 'count': 82, 'status': True, 'gradient': 21.242519065931983}, [0.8027457981597619, -3.409129649200562e-06]), ({'reward': 727.9946682206673, 'duration': 13.411352670399307, 'time_stamp': 88, 'count': 85, 'status': True, 'gradient': 18.125994600308978}, [0.5394425726238261, -3.409129649200562e-06]), ({'reward': 817.6886573257123, 'duration': 8.009219946401625, 'time_stamp': 88, 'count': 12, 'status': True, 'gradient': 21.039795614312997}, [0.6059065486926363, -3.409129649200562e-06])]
2021-08-18:15:50:16,2 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:50:16,390 INFO     [param_server.py:553] For epoch: 89, median_reward: 325.7925160563089, dev: 651.5850321126178
2021-08-18:15:50:17,6 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4167, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:50:17,7 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1268.4211, eval_time 0.567, test_loss 2.4167, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:50:17,75 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:50:17,85 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:50:17,148 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5207, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:50:17,149 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1268.5659, eval_time 0.7088, test_loss 2.5207, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:50:17,194 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4794, Top-1 Accuracy: 575.0/1033 (0.5566), Top-5 Accuracy: 1.0
2021-08-18:15:50:17,195 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1268.615, eval_time 0.7711, test_loss 2.4794, test_accuracy 0.5566, test_5_accuracy 1.0 

2021-08-18:15:50:17,220 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:50:17,243 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:50:17,266 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:50:17,302 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:50:18,724 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:50:18,748 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:50:19,812 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:50:19,826 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:50:19,907 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:50:19,919 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:50:20,671 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:50:20,685 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:50:21,23 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:50:21,32 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:50:21,973 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:50:21,994 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:50:22,540 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:50:22,568 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:50:22,728 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:50:22,756 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:50:23,373 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:50:23,388 INFO     [learner.py:606] ====Pushing takes 0.014544963836669922 s
2021-08-18:15:50:23,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:23,431 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:50:23,431 INFO     [param_server.py:410] Lock worker 1 with localStep 89 , while globalStep is 88

2021-08-18:15:50:23,434 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:50:23,457 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:50:23,767 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:50:23,786 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:50:24,443 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:50:24,453 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:50:57,1 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:50:57,22 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:50:57,363 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:50:57,376 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:50:57,775 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:50:57,795 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:50:57,930 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:50:57,951 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:50:58,326 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:50:58,367 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:50:58,494 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:50:58,511 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:50:59,69 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:50:59,110 INFO     [learner.py:606] ====Pushing takes 0.03589749336242676 s
2021-08-18:15:50:59,160 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:59,175 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:50:59,176 INFO     [param_server.py:410] Lock worker 3 with localStep 89 , while globalStep is 88

2021-08-18:15:50:59,209 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:50:59,245 INFO     [learner.py:606] ====Pushing takes 0.03494000434875488 s
2021-08-18:15:50:59,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:59,299 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:50:59,300 INFO     [param_server.py:381] ====After aggregation in epoch: 88, virtual_clock: 2818.342795817579, top_1: : 56.3408 % (1746.0), top_5: : 100.0 % (3099.0), test loss: 2.4722673937126443, test len: 3099.0
2021-08-18:15:50:59,306 INFO     [param_server.py:410] Lock worker 2 with localStep 89 , while globalStep is 89

2021-08-18:15:50:59,306 INFO     [param_server.py:441] ====Epoch 90 completes 20 clients with loss 5.881089517543816, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:50:59,307 INFO     [param_server.py:450] ====Start to sample for epoch 90, global virtualClock: 2818.342795817579, round_duration: 37.343519273061496
2021-08-18:15:50:59,307 INFO     [oort.py:208] Training selector: Pacer 88: lastExploitationUtil 416.9175225496421, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:50:59,308 INFO     [oort.py:321] scores are 26,{5: 0.006601264982674412, 6: 0.0407357389142663, 7: 0.07092754237482551, 11: 0.024791540664736905, 14: 0.005973751427271885, 27: 0.056491662756887044, 50: 0.021683716437951157, 51: 0.03989086595699447, 53: 0.04720110256336092, 58: 0.0024705284706355093, 60: 0.0011024415632951662, 67: 0.0012540527840705154, 70: 0.005267474769560586, 76: 0.0011923648551777676, 79: 0.010451873409553678, 81: 0.028220290135469596, 84: 0.032640497506581705, 85: 0.10303328883020858, 87: 0.018957360677564507, 93: 0.04861316476712839, 97: 0.3416507713192991, 98: 0.2351764335310296, 105: 0.024258387084596877, 107: 0.007164387851223219, 110: 0.007529077312340135, 113: 0.07092754237482551, 119: 0.0024160341942449323},[97, 98, 85, 7, 113, 27, 93, 53, 6, 51, 84, 81, 11, 105, 50, 87, 79, 110, 107, 5, 14, 70, 58, 119, 67, 76, 60]
2021-08-18:15:50:59,309 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:50:59,310 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:50:59,310 INFO     [oort.py:398] At round 88, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 139.3538443915516, 'duration': 21.753601635627824, 'time_stamp': 89, 'count': 83, 'status': True, 'gradient': 21.25252428250915}, [0.07322505807152492, -3.370824391285298e-06]), ({'reward': 1902.9631328359271, 'duration': 15.972045438625893, 'time_stamp': 89, 'count': 86, 'status': True, 'gradient': 21.049919395346265}, [1.0, -3.370824391285298e-06]), ({'reward': 1084.1654317668076, 'duration': 30.380154975061778, 'time_stamp': 89, 'count': 81, 'status': True, 'gradient': 15.005868932591218}, [0.5697226155296267, -3.370824391285298e-06])]
2021-08-18:15:50:59,311 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:50:59,706 INFO     [param_server.py:553] For epoch: 90, median_reward: 337.20554221802195, dev: 674.4110844360439
2021-08-18:15:51:00,367 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1526, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:51:00,367 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1311.7816, eval_time 0.6249, test_loss 2.1526, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:51:00,444 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:51:00,449 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8897, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:51:00,452 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2832, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:51:00,453 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1311.8724, eval_time 0.7109, test_loss 3.8897, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:51:00,453 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1311.87, eval_time 0.7109, test_loss 2.2832, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:51:00,453 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:51:00,525 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:51:00,532 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:51:00,546 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:51:00,554 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:51:02,367 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:51:02,377 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:51:03,212 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:51:03,221 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:51:03,558 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:51:03,568 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:51:03,639 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:51:03,653 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:51:04,744 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:51:04,760 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:51:05,81 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:51:05,108 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:51:05,609 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:51:05,628 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:51:05,910 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:51:05,938 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:51:06,618 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:51:06,636 INFO     [learner.py:606] ====Pushing takes 0.01693892478942871 s
2021-08-18:15:51:06,656 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:06,661 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:51:06,661 INFO     [param_server.py:410] Lock worker 1 with localStep 90 , while globalStep is 89

2021-08-18:15:51:06,849 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:51:06,863 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:51:07,516 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:51:07,526 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:51:07,677 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:51:07,689 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:51:10,268 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:51:10,277 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:51:10,280 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:51:10,290 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:51:11,82 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:51:11,96 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:51:11,305 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:51:11,323 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:51:11,758 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:51:11,780 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:51:12,453 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:51:12,493 INFO     [learner.py:606] ====Pushing takes 0.03821682929992676 s
2021-08-18:15:51:12,531 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:12,540 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:51:12,541 INFO     [param_server.py:410] Lock worker 3 with localStep 90 , while globalStep is 89

2021-08-18:15:51:14,21 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:51:14,42 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:51:14,591 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:51:14,631 INFO     [learner.py:606] ====Pushing takes 0.039328813552856445 s
2021-08-18:15:51:14,671 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:14,680 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:51:14,681 INFO     [param_server.py:381] ====After aggregation in epoch: 89, virtual_clock: 2862.7094329076817, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.7751645335444697, test len: 3099.0
2021-08-18:15:51:14,683 INFO     [param_server.py:410] Lock worker 2 with localStep 90 , while globalStep is 90

2021-08-18:15:51:14,683 INFO     [param_server.py:441] ====Epoch 91 completes 20 clients with loss 5.723887870406798, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:51:14,683 INFO     [param_server.py:450] ====Start to sample for epoch 91, global virtualClock: 2862.7094329076817, round_duration: 44.36663709010263
2021-08-18:15:51:14,684 INFO     [oort.py:208] Training selector: Pacer 89: lastExploitationUtil 403.9398289681952, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:51:14,685 INFO     [oort.py:321] scores are 26,{5: 0.009565569663813313, 6: 0.1173443070454074, 7: 0.07062134546048615, 11: 0.012145545874202959, 14: 0.005522260675066218, 27: 0.00780410089376383, 50: 0.0030153734332200705, 51: 0.039718655562310155, 53: 0.4503654405492058, 58: 0.0022838081540752114, 60: 0.0010447417429834643, 67: 0.0012473875250585726, 70: 0.004869363770988392, 76: 0.0011022469934083396, 79: 0.047784260449223064, 81: 0.09486448843274407, 84: 0.038561917960672126, 85: 0.0330678435842556, 87: 0.035272094592952885, 93: 0.038353118972573895, 97: 0.02252985035109981, 98: 0.17046764980314758, 105: 0.04311739439354947, 107: 0.006622909870523389, 110: 0.007496573997496968, 113: 0.07062134546048615, 119: 0.002405604082183433},[53, 98, 6, 81, 7, 113, 79, 105, 51, 84, 93, 87, 85, 97, 11, 5, 27, 110, 107, 14, 70, 50, 119, 58, 67, 76, 60]
2021-08-18:15:51:14,685 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:51:14,686 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:51:14,687 INFO     [oort.py:398] At round 89, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 90, 'count': 87, 'status': True, 'gradient': 21.261364773500738}, [4.8887664596680704e-09, -3.3333703707819004e-06]), ({'reward': 595.7331914022093, 'duration': 17.619275735353515, 'time_stamp': 90, 'count': 86, 'status': True, 'gradient': 23.349134858861945}, [0.29123516062613264, -3.3333703707819004e-06]), ({'reward': 26.956258809598978, 'duration': 13.298442137908651, 'time_stamp': 90, 'count': 87, 'status': True, 'gradient': 21.056148295475904}, [0.013173401516957273, -3.3333703707819004e-06])]
2021-08-18:15:51:14,687 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:51:14,980 INFO     [param_server.py:553] For epoch: 91, median_reward: 334.72494238082743, dev: 669.4498847616549
2021-08-18:15:51:15,681 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4641, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:15:51:15,682 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1327.0988, eval_time 0.6541, test_loss 2.4641, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:15:51:15,710 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1736, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:51:15,711 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1327.1248, eval_time 0.683, test_loss 2.1736, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:51:15,752 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:51:15,764 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:51:15,801 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:51:15,808 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3505, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:51:15,809 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1327.2282, eval_time 0.7846, test_loss 2.3505, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:51:15,810 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:51:15,882 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:51:15,905 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:51:17,36 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:51:17,57 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:51:18,242 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:51:18,272 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:51:18,487 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:51:18,500 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:51:19,3 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:51:19,24 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:51:19,402 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:51:19,417 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:51:20,440 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:51:20,471 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:51:21,97 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:51:21,117 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:51:21,270 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:51:21,297 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:51:21,739 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:51:21,758 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:51:22,2 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:51:22,24 INFO     [learner.py:606] ====Pushing takes 0.020987749099731445 s
2021-08-18:15:51:22,47 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:22,56 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:51:22,56 INFO     [param_server.py:410] Lock worker 1 with localStep 91 , while globalStep is 90

2021-08-18:15:51:22,213 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:51:22,223 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:51:22,855 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:51:22,864 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:51:24,427 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:51:24,447 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:51:24,992 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:51:25,6 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:51:25,178 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:51:25,218 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:51:25,617 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:51:25,631 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:51:25,764 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:51:25,782 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:51:26,139 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:51:26,150 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:51:26,568 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:51:26,601 INFO     [learner.py:606] ====Pushing takes 0.0321345329284668 s
2021-08-18:15:51:26,655 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:26,666 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:51:26,667 INFO     [param_server.py:410] Lock worker 2 with localStep 91 , while globalStep is 90

2021-08-18:15:51:26,817 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:51:26,853 INFO     [learner.py:606] ====Pushing takes 0.03415656089782715 s
2021-08-18:15:51:26,892 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:26,902 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:51:26,903 INFO     [param_server.py:381] ====After aggregation in epoch: 90, virtual_clock: 2900.0529521807434, top_1: : 60.7293 % (1882.0), top_5: : 100.0 % (3099.0), test loss: 2.329413144676774, test len: 3099.0
2021-08-18:15:51:26,905 INFO     [param_server.py:410] Lock worker 3 with localStep 91 , while globalStep is 91

2021-08-18:15:51:26,906 INFO     [param_server.py:441] ====Epoch 92 completes 20 clients with loss 5.436326127574544, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:51:26,906 INFO     [param_server.py:450] ====Start to sample for epoch 92, global virtualClock: 2900.0529521807434, round_duration: 37.343519273061496
2021-08-18:15:51:26,907 INFO     [oort.py:208] Training selector: Pacer 90: lastExploitationUtil 386.7218771514171, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:51:26,908 INFO     [oort.py:321] scores are 26,{5: 0.06891801318662351, 6: 0.040386582945925266, 7: 0.07031960508437762, 11: 0.09193068846842742, 14: 0.0074954876491660286, 27: 0.09437933245407787, 50: 0.012710462973456271, 51: 0.4052717809313918, 53: 0.04679653038395453, 58: 0.003099863773042576, 60: 0.0013832743498301096, 67: 0.0017557359541046805, 70: 0.006609296111198581, 76: 0.0014961044419228777, 79: 0.022594678893560406, 81: 0.21832397337396456, 84: 0.10006671380640215, 85: 0.00782967499045172, 87: 0.012257149731876648, 93: 0.012226323293768536, 97: 0.022433588159063076, 98: 0.031818129912983176, 105: 0.016515376144351952, 107: 0.008989423364273287, 110: 0.048203353512162025, 113: 0.07031960508437762, 119: 0.028895204348559037},[51, 81, 84, 27, 11, 7, 113, 5, 110, 53, 6, 98, 119, 79, 97, 105, 50, 87, 93, 107, 85, 14, 70, 58, 67, 76, 60]
2021-08-18:15:51:26,908 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:51:26,909 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:51:26,909 INFO     [oort.py:398] At round 90, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 856.59518547062, 'duration': 12.029357192292537, 'time_stamp': 91, 'count': 85, 'status': True, 'gradient': 27.209709143483977}, [0.6502697084980825, -3.2967395246101635e-06]), ({'reward': 611.5155396774201, 'duration': 21.753601635627824, 'time_stamp': 91, 'count': 85, 'status': True, 'gradient': 21.267050730774898}, [0.464219481770549, -3.2967395246101635e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 91, 'count': 88, 'status': True, 'gradient': 21.268916173635276}, [7.591418949761193e-09, -3.2967395246101635e-06])]
2021-08-18:15:51:26,910 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:51:27,289 INFO     [param_server.py:553] For epoch: 92, median_reward: 330.8862239431018, dev: 661.7724478862036
2021-08-18:15:51:28,119 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3255, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:51:28,118 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3032, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:51:28,101 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2965, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:52:02,199 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1373.6191, eval_time 34.8991, test_loss 2.3255, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:52:02,200 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1373.617, eval_time 34.898, test_loss 2.3032, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:52:02,200 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1373.6145, eval_time 34.8977, test_loss 2.2965, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:52:02,357 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:52:02,357 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:52:02,362 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:52:02,372 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:02,373 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:02,376 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:04,182 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:04,201 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:05,17 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:05,28 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:05,347 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:05,359 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:05,728 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:05,748 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:06,455 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:06,466 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:07,176 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:07,186 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:07,272 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:07,299 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:08,39 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:08,66 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:08,378 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:08,396 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:08,770 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:08,790 INFO     [learner.py:606] ====Pushing takes 0.018843650817871094 s
2021-08-18:15:52:08,818 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:08,838 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:08,839 INFO     [param_server.py:410] Lock worker 1 with localStep 92 , while globalStep is 91

2021-08-18:15:52:09,28 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:09,39 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:09,292 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:09,381 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:11,595 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:11,605 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:12,128 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:12,146 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:12,290 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:12,300 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:12,906 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:12,920 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:13,328 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:13,349 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:13,540 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:13,582 INFO     [learner.py:606] ====Pushing takes 0.04012107849121094 s
2021-08-18:15:52:13,647 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:13,656 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:13,657 INFO     [param_server.py:410] Lock worker 3 with localStep 92 , while globalStep is 91

2021-08-18:15:52:16,25 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:52:29,985 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:52:30,507 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:52:30,550 INFO     [learner.py:606] ====Pushing takes 0.0328974723815918 s
2021-08-18:15:52:30,585 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:30,617 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:52:30,617 INFO     [param_server.py:381] ====After aggregation in epoch: 91, virtual_clock: 2944.4195892708462, top_1: : 60.0194 % (1860.0), top_5: : 100.0 % (3099.0), test loss: 2.3083878093295627, test len: 3099.0
2021-08-18:15:52:30,624 INFO     [param_server.py:410] Lock worker 2 with localStep 92 , while globalStep is 92

2021-08-18:15:52:30,624 INFO     [param_server.py:441] ====Epoch 93 completes 20 clients with loss 4.673726158802303, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:52:30,625 INFO     [param_server.py:450] ====Start to sample for epoch 93, global virtualClock: 2944.4195892708462, round_duration: 44.36663709010263
2021-08-18:15:52:30,625 INFO     [oort.py:208] Training selector: Pacer 91: lastExploitationUtil 533.868371144141, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:52:30,626 INFO     [oort.py:321] scores are 26,{5: 0.031001525076168487, 6: 0.5809525053810041, 7: 0.4406756653457577, 11: 0.01204250484812227, 14: 0.008840051854571566, 27: 0.07506770377068078, 50: 0.0029897914482032105, 51: 0.03938168832624886, 53: 0.14653256321599678, 58: 0.003655927109539455, 60: 0.0012565725635673714, 67: 0.0019968217824362744, 70: 0.0077948924846423275, 76: 0.0017644803734583726, 79: 0.0031252499113070408, 81: 0.2009336769282734, 84: 0.3031165017748456, 85: 0.007796561164997268, 87: 0.03591217927982929, 93: 0.10908160838728309, 97: 0.22112188319459875, 98: 0.20625973613179555, 105: 0.04533340703665802, 107: 0.010601974468160826, 110: 0.007432974165526254, 113: 0.5566543197418643, 119: 0.006015310180564802},[6, 113, 7, 84, 97, 98, 81, 53, 93, 27, 105, 51, 87, 5, 11, 107, 14, 85, 70, 110, 119, 58, 79, 50, 67, 76, 60]
2021-08-18:15:52:30,627 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:52:30,628 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:52:30,628 INFO     [oort.py:398] At round 91, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 550.9798712005927, 'duration': 5.8943907365129, 'time_stamp': 92, 'count': 89, 'status': True, 'gradient': 21.2775155172041}, [0.37065346772773483, -3.260905009837066e-06]), ({'reward': 158.42342972385575, 'duration': 48.8795967667807, 'time_stamp': 92, 'count': 67, 'status': True, 'gradient': 8.34566171947861}, [0.106569329416663, -3.260905009837066e-06]), ({'reward': 828.5156204880276, 'duration': 21.635252629006885, 'time_stamp': 92, 'count': 42, 'status': True, 'gradient': 21.699396592146236}, [0.5573598402569276, -3.260905009837066e-06])]
2021-08-18:15:52:30,629 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:52:31,12 INFO     [param_server.py:553] For epoch: 93, median_reward: 362.62460344660633, dev: 725.2492068932127
2021-08-18:15:52:31,658 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3893, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:52:31,659 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1403.0759, eval_time 0.6014, test_loss 2.3893, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:52:31,656 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3962, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:52:31,661 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1403.0747, eval_time 0.6032, test_loss 2.3962, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:52:31,727 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:52:31,729 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:52:31,736 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:31,738 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:31,876 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.434, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:52:31,881 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1403.3008, eval_time 0.8239, test_loss 2.434, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:52:31,956 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:52:31,974 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:33,96 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:33,115 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:34,394 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:34,404 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:34,546 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:38,255 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:38,736 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:38,757 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:39,245 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:39,257 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:39,975 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:39,995 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:40,556 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:40,570 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:40,855 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:40,889 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:41,598 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:41,620 INFO     [learner.py:606] ====Pushing takes 0.020197629928588867 s
2021-08-18:15:52:41,630 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:41,643 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:41,649 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:41,652 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:41,655 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:41,656 INFO     [param_server.py:410] Lock worker 1 with localStep 93 , while globalStep is 92

2021-08-18:15:52:41,671 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:42,195 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:42,205 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:44,305 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:44,325 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:44,568 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:44,587 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:44,888 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:44,897 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:45,141 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:45,152 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:45,622 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:45,636 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:45,724 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:52:45,742 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:52:46,198 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:46,236 INFO     [learner.py:606] ====Pushing takes 0.03600454330444336 s
2021-08-18:15:52:46,290 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:46,300 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:46,301 INFO     [param_server.py:410] Lock worker 3 with localStep 93 , while globalStep is 92

2021-08-18:15:52:46,433 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:52:46,468 INFO     [learner.py:606] ====Pushing takes 0.03353261947631836 s
2021-08-18:15:52:46,503 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:46,512 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:52:46,513 INFO     [param_server.py:381] ====After aggregation in epoch: 92, virtual_clock: 2981.763108543908, top_1: : 57.7606 % (1790.0), top_5: : 100.0 % (3099.0), test loss: 2.4065083795123634, test len: 3099.0
2021-08-18:15:52:46,515 INFO     [param_server.py:410] Lock worker 2 with localStep 93 , while globalStep is 93

2021-08-18:15:52:46,515 INFO     [param_server.py:441] ====Epoch 94 completes 20 clients with loss 5.460738478153267, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:52:46,516 INFO     [param_server.py:450] ====Start to sample for epoch 94, global virtualClock: 2981.763108543908, round_duration: 37.343519273061496
2021-08-18:15:52:46,516 INFO     [oort.py:208] Training selector: Pacer 92: lastExploitationUtil 422.98190478080323, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:52:46,517 INFO     [oort.py:321] scores are 26,{5: 0.006489719644927303, 6: 0.04004740391067294, 7: 0.06972903925602372, 11: 0.12233554462845114, 14: 0.005563806782879422, 27: 0.04075281787794566, 50: 0.002977273954858547, 51: 0.2004043745071574, 53: 0.23090123345674057, 58: 0.0023009901281573646, 60: 0.0010267872579343383, 67: 0.0015029523377640124, 70: 0.004905997882290783, 76: 0.0011105396248358435, 79: 0.00528358803733581, 81: 0.018280201173759315, 84: 0.4731719060303227, 85: 0.0077639189542662275, 87: 0.008301898768439063, 93: 0.03874999498075196, 97: 0.34126842113783595, 98: 0.03155091140078895, 105: 0.012415934823515162, 107: 0.006672736588910709, 110: 0.007401854200719363, 113: 0.06972903925602372, 119: 0.00326682621694422},[84, 97, 53, 51, 11, 7, 113, 27, 6, 93, 98, 81, 105, 87, 85, 110, 107, 5, 14, 79, 70, 119, 50, 58, 67, 76, 60]
2021-08-18:15:52:46,518 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:52:46,519 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:52:46,519 INFO     [oort.py:398] At round 92, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 585.2155819175373, 'duration': 11.058674649423494, 'time_stamp': 93, 'count': 90, 'status': True, 'gradient': 20.348729545117063}, [0.27723864485752964, -3.2258411380767565e-06]), ({'reward': 2023.1834461758615, 'duration': 13.298442137908651, 'time_stamp': 93, 'count': 90, 'status': True, 'gradient': 21.080347470720746}, [0.958469766948089, -3.2258411380767565e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 93, 'count': 90, 'status': True, 'gradient': 21.28245734055546}, [4.737457206263072e-09, -3.2258411380767565e-06])]
2021-08-18:15:52:46,520 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:52:46,889 INFO     [param_server.py:553] For epoch: 94, median_reward: 339.82533549533434, dev: 679.6506709906687
2021-08-18:15:52:47,457 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5423, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:52:47,458 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1418.8724, eval_time 0.5437, test_loss 2.5423, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:52:47,497 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3058, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:52:47,498 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1418.9181, eval_time 0.5863, test_loss 2.3058, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:52:47,533 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:47,542 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:47,548 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5097, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:52:47,549 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1418.9658, eval_time 0.6361, test_loss 2.5097, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:52:47,557 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:47,573 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:47,622 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:47,648 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:49,346 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:49,360 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:50,192 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:50,206 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:50,590 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:50,602 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:50,802 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:50,822 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:51,719 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:51,730 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:52,384 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:52,394 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:52,416 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:52,443 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:53,242 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:53,270 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:53,461 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:53,472 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:53,984 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:54,0 INFO     [learner.py:606] ====Pushing takes 0.014982461929321289 s
2021-08-18:15:52:54,24 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:54,32 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:54,33 INFO     [param_server.py:410] Lock worker 1 with localStep 94 , while globalStep is 93

2021-08-18:15:52:54,95 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:54,106 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:54,672 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:54,692 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:56,763 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:56,772 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:57,431 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:57,444 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:57,596 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:57,615 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:58,91 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:58,105 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:58,683 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:58,693 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:58,697 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:58,738 INFO     [learner.py:606] ====Pushing takes 0.039646148681640625 s
2021-08-18:15:52:58,797 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:58,807 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:58,808 INFO     [param_server.py:410] Lock worker 3 with localStep 94 , while globalStep is 93

2021-08-18:15:53:00,939 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:00,950 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:01,551 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:01,586 INFO     [learner.py:606] ====Pushing takes 0.0334780216217041 s
2021-08-18:15:53:01,657 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:01,667 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:01,668 INFO     [param_server.py:381] ====After aggregation in epoch: 93, virtual_clock: 3026.1297456340108, top_1: : 59.1158 % (1832.0), top_5: : 100.0 % (3099.0), test loss: 2.4526272747251725, test len: 3099.0
2021-08-18:15:53:01,671 INFO     [param_server.py:410] Lock worker 2 with localStep 94 , while globalStep is 94

2021-08-18:15:53:01,672 INFO     [param_server.py:441] ====Epoch 95 completes 20 clients with loss 5.231627501073509, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:01,673 INFO     [param_server.py:450] ====Start to sample for epoch 95, global virtualClock: 3026.1297456340108, round_duration: 44.36663709010263
2021-08-18:15:53:01,674 INFO     [oort.py:208] Training selector: Pacer 93: lastExploitationUtil 343.2005975870162, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:01,675 INFO     [oort.py:321] scores are 26,{5: 0.027185850940845305, 6: 0.03988140738180545, 7: 0.06944001231925691, 11: 0.01899226589902252, 14: 0.006298930460462602, 27: 0.03825009783945596, 50: 0.03812576898215887, 51: 0.039054253548515626, 53: 0.04621117599368048, 58: 0.0026050108087997343, 60: 0.0013727385639213043, 67: 0.0014228244083204715, 70: 0.005554207884216555, 76: 0.0012572708117676566, 79: 0.0030992653597664314, 81: 0.018204429721791742, 84: 0.031955943672569466, 85: 0.007731737502512416, 87: 0.01436895758964931, 93: 0.16495170121933406, 97: 0.02215297762638542, 98: 0.4838989210214086, 105: 0.0029419505035569167, 107: 0.007554378754465075, 110: 0.013852486014108326, 113: 0.6011110870095285, 119: 0.02799689953377223},[113, 98, 93, 7, 53, 6, 51, 27, 50, 84, 119, 5, 97, 11, 81, 87, 110, 85, 107, 14, 70, 79, 105, 58, 67, 60, 76]
2021-08-18:15:53:01,676 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:53:01,677 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:01,678 INFO     [oort.py:398] At round 93, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 94, 'count': 91, 'status': True, 'gradient': 21.297313195916896}, [6.88709728661834e-09, -3.191523314077812e-06]), ({'reward': 1276.7139601098193, 'duration': 21.635252629006885, 'time_stamp': 94, 'count': 44, 'status': True, 'gradient': 21.70851673204868}, [0.8792784448358556, -3.191523314077812e-06]), ({'reward': 771.9913624867609, 'duration': 8.009219946401625, 'time_stamp': 94, 'count': 18, 'status': True, 'gradient': 21.089134750313903}, [0.5316710815773689, -3.191523314077812e-06])]
2021-08-18:15:53:01,678 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:02,50 INFO     [param_server.py:553] For epoch: 95, median_reward: 321.6152616785099, dev: 643.2305233570198
2021-08-18:15:53:02,570 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.296, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:53:02,695 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.487, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:53:02,575 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.318, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:53:05,326 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1436.7399, eval_time 3.2405, test_loss 2.318, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:53:05,326 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1436.7452, eval_time 3.2427, test_loss 2.487, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:53:05,325 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1436.7423, eval_time 3.2421, test_loss 2.296, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:53:05,390 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:53:05,399 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:53:05,413 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:05,421 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:05,434 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:53:05,444 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:06,508 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:06,539 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:07,595 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:07,604 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:08,26 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:08,45 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:08,683 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:08,696 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:09,29 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:09,56 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:10,379 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:10,410 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:10,675 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:10,702 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:11,119 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:11,142 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:11,330 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:11,350 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:11,736 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:11,767 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:11,900 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:11,920 INFO     [learner.py:606] ====Pushing takes 0.018590688705444336 s
2021-08-18:15:53:11,947 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:11,953 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:11,954 INFO     [param_server.py:410] Lock worker 1 with localStep 95 , while globalStep is 94

2021-08-18:15:53:12,389 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:12,399 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:14,19 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:14,31 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:14,650 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:14,661 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:14,754 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:14,773 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:15,260 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:15,272 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:15,312 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:15,326 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:15,792 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:15,801 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:16,119 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:16,152 INFO     [learner.py:606] ====Pushing takes 0.03172802925109863 s
2021-08-18:15:53:16,196 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:16,229 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:16,230 INFO     [param_server.py:410] Lock worker 2 with localStep 95 , while globalStep is 94

2021-08-18:15:53:16,382 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:16,417 INFO     [learner.py:606] ====Pushing takes 0.03348851203918457 s
2021-08-18:15:53:16,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:16,473 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:16,473 INFO     [param_server.py:381] ====After aggregation in epoch: 94, virtual_clock: 3063.4732649070725, top_1: : 58.89 % (1825.0), top_5: : 100.0 % (3099.0), test loss: 2.367016902676335, test len: 3099.0
2021-08-18:15:53:16,475 INFO     [param_server.py:410] Lock worker 3 with localStep 95 , while globalStep is 95

2021-08-18:15:53:16,476 INFO     [param_server.py:441] ====Epoch 96 completes 20 clients with loss 4.773663085016366, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:16,477 INFO     [param_server.py:450] ====Start to sample for epoch 96, global virtualClock: 3063.4732649070725, round_duration: 37.343519273061496
2021-08-18:15:53:16,477 INFO     [oort.py:208] Training selector: Pacer 94: lastExploitationUtil 393.2067455851142, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:16,478 INFO     [oort.py:321] scores are 26,{5: 0.0382233942650457, 6: 0.30629077987011094, 7: 0.06915501743634794, 11: 0.09888365323156675, 14: 0.006556145479032669, 27: 0.06335512897975926, 50: 0.02138372257676963, 51: 0.03889396753983833, 53: 0.046021516627969904, 58: 0.002711385677956718, 60: 0.0012844479383267151, 67: 0.0014809250349118019, 70: 0.005781012370001567, 76: 0.001308611104731086, 79: 0.003086545391281266, 81: 0.050790771047735966, 84: 0.03182479046390732, 85: 0.0676373258486832, 87: 0.008233556065188467, 93: 0.058270490641981906, 97: 0.022062057635823064, 98: 0.24914951060791918, 105: 0.04529666712652194, 107: 0.0078628596440084, 110: 0.015375707684644541, 113: 0.1732550830514239, 119: 0.002355655944581601},[6, 98, 113, 11, 7, 85, 27, 93, 81, 53, 105, 51, 5, 84, 97, 50, 110, 87, 107, 14, 70, 79, 58, 119, 67, 76, 60]
2021-08-18:15:53:16,480 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:53:16,480 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:16,481 INFO     [oort.py:398] At round 94, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 95, 'count': 92, 'status': True, 'gradient': 21.304317989125888}, [6.336036395612093e-09, -3.157927978189247e-06]), ({'reward': 732.5610522208495, 'duration': 11.90395711384456, 'time_stamp': 95, 'count': 92, 'status': True, 'gradient': 20.99076711822298}, [0.464147019187579, -3.157927978189247e-06]), ({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 95, 'count': 89, 'status': True, 'gradient': 27.25409096041626}, [6.336036395612093e-09, -3.157927978189247e-06])]
2021-08-18:15:53:16,481 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 50, 105, 119, 107]
2021-08-18:15:53:16,855 INFO     [param_server.py:553] For epoch: 96, median_reward: 332.4499687498878, dev: 664.8999374997755
2021-08-18:15:53:17,527 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1475, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:53:17,528 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1448.9423, eval_time 0.6283, test_loss 2.1475, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:53:17,574 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3833, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:53:17,575 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1448.9919, eval_time 0.6749, test_loss 2.3833, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:53:17,596 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:53:17,604 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:17,631 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3303, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:53:17,633 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1449.0529, eval_time 0.7341, test_loss 2.3303, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:53:17,646 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:53:17,659 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:17,707 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:53:17,725 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:19,347 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:19,407 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:20,330 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:20,341 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:20,585 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:20,596 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:21,232 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:21,258 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:21,740 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:21,757 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:22,690 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:22,711 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:22,809 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:22,828 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:23,436 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:23,448 INFO     [learner.py:606] ====Pushing takes 0.011225223541259766 s
2021-08-18:15:53:23,477 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:23,483 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:53:23,484 INFO     [param_server.py:410] Lock worker 1 with localStep 96 , while globalStep is 95

2021-08-18:15:53:23,936 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:23,951 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:24,515 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:24,526 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:24,623 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:24,641 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:27,102 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:27,112 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:27,490 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:27,502 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:27,714 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:27,725 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:28,373 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:28,382 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:28,599 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:28,610 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:28,901 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:28,939 INFO     [learner.py:606] ====Pushing takes 0.03599262237548828 s
2021-08-18:15:53:28,992 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:29,2 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:53:29,3 INFO     [param_server.py:410] Lock worker 3 with localStep 96 , while globalStep is 95

2021-08-18:15:53:30,952 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:30,964 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:31,464 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:31,478 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:53:32,45 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:53:32,83 INFO     [learner.py:606] ====Pushing takes 0.03665614128112793 s
2021-08-18:15:53:32,131 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:32,143 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:32,144 INFO     [param_server.py:381] ====After aggregation in epoch: 95, virtual_clock: 3107.8399019971753, top_1: : 60.9551 % (1889.0), top_5: : 100.0 % (3099.0), test loss: 2.2870055083875305, test len: 3099.0
2021-08-18:15:53:32,146 INFO     [param_server.py:410] Lock worker 2 with localStep 96 , while globalStep is 96

2021-08-18:15:53:32,147 INFO     [param_server.py:441] ====Epoch 97 completes 20 clients with loss 5.392177944033733, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:32,147 INFO     [param_server.py:450] ====Start to sample for epoch 97, global virtualClock: 3107.8399019971753, round_duration: 44.36663709010263
2021-08-18:15:53:32,148 INFO     [oort.py:208] Training selector: Pacer 95: lastExploitationUtil 421.51276052479056, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:32,149 INFO     [oort.py:321] scores are 26,{5: 0.09948068095758028, 6: 0.03955630755089272, 7: 0.40990972362703976, 11: 0.02967407253810229, 14: 0.0058108603185333075, 27: 0.042987678434874436, 31: 0.06177825331238226, 50: 0.0029407640126770064, 51: 0.4233489427511933, 53: 0.11224247667231338, 58: 0.0024031625739035427, 60: 0.0010723803980875188, 67: 0.0013125774203169816, 70: 0.005123842277329812, 76: 0.001159851678885543, 79: 0.0030901377889299025, 81: 0.018056033328260328, 84: 0.485631751029086, 85: 0.007668710976626193, 87: 0.017448684543730573, 93: 0.011974972110725369, 97: 0.1521165592413046, 98: 0.0854538873598618, 105: 0.00291796871168825, 107: 0.0017014408884835962, 110: 0.00731108617836003, 113: 0.0688739606740016, 119: 0.0032189637919139967},[84, 51, 7, 97, 53, 5, 98, 113, 31, 27, 6, 11, 81, 87, 93, 85, 110, 14, 70, 119, 79, 50, 105, 58, 107, 67, 76, 60]
2021-08-18:15:53:32,150 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:53:32,150 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:32,151 INFO     [oort.py:398] At round 95, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 237.18702278852015, 'duration': 13.411352670399307, 'time_stamp': 96, 'count': 93, 'status': True, 'gradient': 18.181902451224925}, [0.11998326599098093, -3.125032552422424e-06]), ({'reward': 674.152762025255, 'duration': 5.8943907365129, 'time_stamp': 96, 'count': 93, 'status': True, 'gradient': 21.313536161030925}, [0.34103576801184443, -3.125032552422424e-06]), ({'reward': 1949.8770894192248, 'duration': 13.298442137908651, 'time_stamp': 96, 'count': 93, 'status': True, 'gradient': 21.107709949432707}, [0.9863999902776548, -3.125032552422424e-06])]
2021-08-18:15:53:32,151 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:32,500 INFO     [param_server.py:553] For epoch: 97, median_reward: 335.0581828115446, dev: 670.1163656230892
2021-08-18:15:53:33,23 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.358, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:53:33,24 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1464.4383, eval_time 0.4792, test_loss 2.358, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:53:33,57 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6101, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:53:33,59 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1464.4762, eval_time 0.5142, test_loss 2.6101, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:53:33,96 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:33,104 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:33,133 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:33,145 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:33,170 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3585, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:53:33,174 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1464.5932, eval_time 0.6288, test_loss 2.3585, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:53:33,248 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:33,273 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:34,437 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:34,452 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:35,639 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:35,657 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:35,686 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:35,700 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:36,674 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:36,700 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:36,950 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:36,970 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:38,148 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:38,174 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:38,177 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:38,194 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:38,892 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:38,905 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:39,287 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:39,297 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:39,413 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:39,429 INFO     [learner.py:606] ====Pushing takes 0.015057563781738281 s
2021-08-18:15:53:39,460 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:39,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:39,466 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:39,467 INFO     [param_server.py:410] Lock worker 1 with localStep 97 , while globalStep is 96

2021-08-18:15:53:39,472 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:39,954 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:39,963 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:42,120 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:42,122 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:42,134 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:42,140 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:42,724 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:42,735 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:42,737 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:42,747 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:43,253 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:43,268 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:43,285 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:43,300 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:43,852 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:43,889 INFO     [learner.py:606] ====Pushing takes 0.035520076751708984 s
2021-08-18:15:53:43,934 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:43,940 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:43,948 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:43,949 INFO     [param_server.py:410] Lock worker 3 with localStep 97 , while globalStep is 96

2021-08-18:15:53:43,966 INFO     [learner.py:606] ====Pushing takes 0.02978658676147461 s
2021-08-18:15:53:43,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:44,5 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:44,5 INFO     [param_server.py:381] ====After aggregation in epoch: 96, virtual_clock: 3145.183421270237, top_1: : 59.0836 % (1831.0), top_5: : 100.0 % (3099.0), test loss: 2.442229915548254, test len: 3099.0
2021-08-18:15:53:44,8 INFO     [param_server.py:410] Lock worker 2 with localStep 97 , while globalStep is 97

2021-08-18:15:53:44,8 INFO     [param_server.py:441] ====Epoch 98 completes 20 clients with loss 5.231131981845369, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:44,8 INFO     [param_server.py:450] ====Start to sample for epoch 98, global virtualClock: 3145.183421270237, round_duration: 37.343519273061496
2021-08-18:15:53:44,9 INFO     [oort.py:208] Training selector: Pacer 96: lastExploitationUtil 501.9846780042316, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:44,10 INFO     [oort.py:321] scores are 26,{5: 0.07536439328303253, 6: 0.19020207937595557, 7: 0.5799200303774922, 11: 0.011797353975698576, 14: 0.00838867301449455, 27: 0.08269675308042522, 50: 0.01248078055402412, 51: 0.22300365594704802, 53: 0.22226303182867174, 58: 0.0034692530758055184, 60: 0.0015481095764801128, 67: 0.0016439196574842179, 70: 0.007396880166827317, 76: 0.0014526403891860005, 79: 0.03635885627217597, 81: 0.0693727880749531, 84: 0.49176283661415554, 85: 0.017323255256123948, 87: 0.03542165913914144, 93: 0.016300095970382913, 97: 0.09569083611647687, 98: 0.05581777455535503, 105: 0.03782905017662322, 107: 0.010060630704946385, 110: 0.007281660122113961, 113: 0.06859675302096073, 119: 0.008409379572833477},[7, 84, 51, 53, 6, 97, 27, 5, 81, 113, 98, 105, 79, 87, 85, 93, 50, 11, 107, 119, 14, 70, 110, 58, 67, 60, 76]
2021-08-18:15:53:44,11 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:53:44,11 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:44,12 INFO     [oort.py:398] At round 96, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 342.9357068767679, 'duration': 15.972045438625893, 'time_stamp': 97, 'count': 94, 'status': True, 'gradient': 21.115253624091835}, [0.23135267591303163, -3.0928153898493827e-06]), ({'reward': 1482.2738779079918, 'duration': 13.298442137908651, 'time_stamp': 97, 'count': 94, 'status': True, 'gradient': 21.117989637203053}, [1.0, -3.0928153898493827e-06]), ({'reward': 757.9260290723487, 'duration': 5.8943907365129, 'time_stamp': 97, 'count': 94, 'status': True, 'gradient': 21.321487206974087}, [0.5113232841029685, -3.0928153898493827e-06])]
2021-08-18:15:53:44,12 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:44,342 INFO     [param_server.py:553] For epoch: 98, median_reward: 355.3357827041147, dev: 710.6715654082294
2021-08-18:15:53:44,966 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.216, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:53:44,966 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1476.3805, eval_time 0.5903, test_loss 2.216, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:53:44,967 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6298, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:53:44,968 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1476.385, eval_time 0.592, test_loss 2.6298, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:53:45,38 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:45,39 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3243, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:53:45,39 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1476.459, eval_time 0.6636, test_loss 2.3243, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:53:45,47 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:45,56 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:45,66 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:45,109 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:45,127 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:46,608 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:46,619 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:47,518 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:47,528 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:47,666 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:47,684 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:48,777 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:48,792 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:48,796 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:48,823 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:49,739 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:49,754 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:50,226 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:50,247 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:50,948 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:50,950 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:50,957 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:50,970 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:51,615 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:51,625 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:51,625 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:51,645 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:51,646 INFO     [learner.py:606] ====Pushing takes 0.020028352737426758 s
2021-08-18:15:53:51,664 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:51,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:51,675 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:51,675 INFO     [param_server.py:410] Lock worker 1 with localStep 98 , while globalStep is 97

2021-08-18:15:53:54,165 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:54,176 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:54,407 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:54,419 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:54,883 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:54,892 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:55,508 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:55,518 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:55,605 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:55,616 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:56,102 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:56,136 INFO     [learner.py:606] ====Pushing takes 0.03309512138366699 s
2021-08-18:15:53:56,173 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:56,182 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:56,182 INFO     [param_server.py:410] Lock worker 3 with localStep 98 , while globalStep is 97

2021-08-18:15:53:57,912 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:57,930 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:58,481 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:58,513 INFO     [learner.py:606] ====Pushing takes 0.03098773956298828 s
2021-08-18:15:53:58,547 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:58,558 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:58,559 INFO     [param_server.py:381] ====After aggregation in epoch: 97, virtual_clock: 3189.55005836034, top_1: : 59.4708 % (1843.0), top_5: : 100.0 % (3099.0), test loss: 2.390033660111604, test len: 3099.0
2021-08-18:15:53:58,561 INFO     [param_server.py:410] Lock worker 2 with localStep 98 , while globalStep is 98

2021-08-18:15:53:58,562 INFO     [param_server.py:441] ====Epoch 99 completes 20 clients with loss 5.2224131400299125, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:58,563 INFO     [param_server.py:450] ====Start to sample for epoch 99, global virtualClock: 3189.55005836034, round_duration: 44.36663709010263
2021-08-18:15:53:58,563 INFO     [oort.py:208] Training selector: Pacer 97: lastExploitationUtil 583.3434261704637, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:58,564 INFO     [oort.py:321] scores are 25,{5: 0.006358886603664554, 6: 0.3042139955093342, 7: 0.6286489986816326, 11: 0.011750324960707914, 14: 0.0076915767783800135, 27: 0.05424735940775749, 50: 0.025036744910429738, 51: 0.08882249327180097, 53: 0.04546802159224219, 58: 0.0031809591755552506, 60: 0.001259045919280685, 67: 0.0017374002217427711, 70: 0.006782201621796882, 79: 0.00863721039767449, 81: 0.20738584976018076, 84: 0.23943580208177834, 85: 0.07470758330161935, 87: 0.008134532114167741, 93: 0.01187922965556885, 97: 0.24056186599275847, 98: 0.10861738677099933, 105: 0.04526142991823412, 107: 0.009224595281317582, 110: 0.007252632485599432, 113: 0.23382733933100205, 119: 0.0023273247645870685},[7, 6, 97, 84, 113, 81, 98, 51, 85, 27, 53, 105, 50, 93, 11, 107, 79, 87, 14, 110, 70, 5, 58, 119, 67, 60]
2021-08-18:15:53:58,565 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:53:58,566 INFO     [oort.py:365] exploration poss is [16.91829855  9.05547074  1.91505738  0.90032832]
2021-08-18:15:53:58,566 INFO     [oort.py:398] At round 97, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1311.1578306465663, 'duration': 15.972045438625893, 'time_stamp': 98, 'count': 95, 'status': True, 'gradient': 21.128341892803718}, [0.6857342070783199, -3.061255727099259e-06]), ({'reward': 1381.91628675548, 'duration': 17.619275735353515, 'time_stamp': 98, 'count': 94, 'status': True, 'gradient': 23.429798402051237}, [0.7227410893609499, -3.061255727099259e-06]), ({'reward': 583.3457595441681, 'duration': 62.85745079072042, 'time_stamp': 98, 'count': 68, 'status': True, 'gradient': 20.420721502545724}, [0.30508633655799877, -3.061255727099259e-06])]
2021-08-18:15:53:58,567 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:53:58,908 INFO     [param_server.py:553] For epoch: 99, median_reward: 372.9561922394967, dev: 745.9123844789934
2021-08-18:15:53:59,543 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3957, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:53:59,544 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1490.9585, eval_time 0.5746, test_loss 2.3957, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:53:59,629 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5144, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:53:59,630 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1491.047, eval_time 0.6623, test_loss 2.5144, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:53:59,640 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:59,658 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:59,708 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2902, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:53:59,711 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1491.1304, eval_time 0.7471, test_loss 2.2902, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:53:59,714 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:59,732 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:59,782 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:59,811 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:01,71 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:01,90 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:02,459 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:02,476 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:02,496 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:02,515 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:02,836 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:02,845 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:03,678 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:03,694 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:04,203 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:04,216 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:04,665 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:04,678 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:04,814 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:04,833 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:05,517 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:05,534 INFO     [learner.py:606] ====Pushing takes 0.015233993530273438 s
2021-08-18:15:54:05,555 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:05,560 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:54:05,561 INFO     [param_server.py:410] Lock worker 1 with localStep 99 , while globalStep is 98

2021-08-18:15:54:05,775 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:05,788 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:06,406 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:06,418 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:06,461 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:06,471 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:12,823 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:12,838 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:13,32 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:36,875 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:54:37,382 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:54:37,396 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:54:37,422 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:54:37,440 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:54:37,908 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:54:37,922 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:54:37,986 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:38,15 INFO     [learner.py:606] ====Pushing takes 0.027224302291870117 s
2021-08-18:15:54:38,56 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:38,67 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:54:38,68 INFO     [param_server.py:410] Lock worker 2 with localStep 99 , while globalStep is 98

2021-08-18:15:54:38,408 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:54:38,421 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:38,901 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:38,948 INFO     [learner.py:606] ====Pushing takes 0.0366368293762207 s
2021-08-18:15:54:38,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:38,997 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:38,998 INFO     [param_server.py:381] ====After aggregation in epoch: 98, virtual_clock: 3229.4132386718516, top_1: : 59.0513 % (1830.0), top_5: : 100.0 % (3099.0), test loss: 2.4001016506442316, test len: 3099.0
2021-08-18:15:54:39,21 INFO     [param_server.py:410] Lock worker 3 with localStep 99 , while globalStep is 99

2021-08-18:15:54:39,22 INFO     [param_server.py:441] ====Epoch 100 completes 20 clients with loss 4.883259577869055, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:54:39,22 INFO     [param_server.py:450] ====Start to sample for epoch 100, global virtualClock: 3229.4132386718516, round_duration: 39.863180311511634
2021-08-18:15:54:39,23 INFO     [oort.py:208] Training selector: Pacer 98: lastExploitationUtil 307.1716590904273, lastExplorationUtil 0.009999000099990002, last_util_record 60
2021-08-18:15:54:39,23 INFO     [oort.py:321] scores are 26,{5: 0.01728140027134016, 6: 0.3527504703674995, 7: 0.06805351636318191, 11: 0.11698183021757977, 14: 0.005012942983102443, 27: 0.006144664455812023, 36: 0.002948596299096649, 50: 0.0029057328763803115, 51: 0.038274464449925154, 53: 0.045288485940773615, 58: 0.002073172697626446, 60: 0.001394018965608721, 67: 0.001132341066256694, 70: 0.0044202627120018744, 79: 0.0030373828982777572, 81: 0.280001463425658, 84: 0.03131788522190455, 85: 0.00757735932165351, 87: 0.0803331227134247, 93: 0.011832323166997965, 97: 0.021710653196015388, 98: 0.030792772827447305, 105: 0.0028832091188722357, 107: 0.006012079384999698, 110: 0.007223994641845386, 113: 0.6901110031485704, 119: 0.008289933830180573},[113, 6, 81, 11, 87, 7, 53, 51, 84, 98, 97, 5, 93, 119, 85, 110, 27, 107, 14, 70, 79, 36, 50, 105, 58, 60, 67]
2021-08-18:15:54:39,24 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:54:39,25 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:39,25 INFO     [oort.py:398] At round 98, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1047.9801766743988, 'duration': 8.009219946401625, 'time_stamp': 99, 'count': 23, 'status': True, 'gradient': 21.137459548088458}, [0.6220574927212205, -3.0303336397337374e-06]), ({'reward': 198.17454732766657, 'duration': 29.570969934622333, 'time_stamp': 99, 'count': 83, 'status': True, 'gradient': 20.091293848877864}, [0.11762715127291917, -3.0303336397337374e-06]), ({'reward': 295.3589305548689, 'duration': 57.39721143529741, 'time_stamp': 99, 'count': 68, 'status': True, 'gradient': 19.22200996399144}, [0.17531416807042532, -3.0303336397337374e-06])]
2021-08-18:15:54:39,26 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:54:39,384 INFO     [param_server.py:553] For epoch: 100, median_reward: 313.6785939546831, dev: 627.3571879093662
2021-08-18:15:54:40,20 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2527, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:54:40,21 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1531.4356, eval_time 0.5845, test_loss 2.2527, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:54:40,92 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4903, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:54:40,93 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1531.5104, eval_time 0.6569, test_loss 2.4903, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:54:40,130 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:54:40,139 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:40,94 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5844, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:54:40,155 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1531.5751, eval_time 0.7258, test_loss 2.5844, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:54:40,177 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:54:40,200 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:40,264 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:54:40,281 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:41,414 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:41,429 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:42,149 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:42,163 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:42,307 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:42,317 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:43,152 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:43,167 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:43,436 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:43,457 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:44,198 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:44,209 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:44,458 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:44,470 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:44,567 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:44,581 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:44,807 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:44,816 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:45,207 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:45,227 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:45,404 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:45,413 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:45,657 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:45,682 INFO     [learner.py:606] ====Pushing takes 0.023199796676635742 s
2021-08-18:15:54:45,699 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:45,704 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:54:45,705 INFO     [param_server.py:410] Lock worker 1 with localStep 100 , while globalStep is 99

2021-08-18:15:54:46,266 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:46,285 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:54:46,652 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:46,661 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:46,893 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:54:46,912 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:54:47,259 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:54:47,268 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:54:47,593 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:47,621 INFO     [learner.py:606] ====Pushing takes 0.025936603546142578 s
2021-08-18:15:54:47,650 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:47,658 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:54:47,658 INFO     [param_server.py:410] Lock worker 2 with localStep 100 , while globalStep is 99

2021-08-18:15:54:47,911 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:54:47,921 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:54:48,464 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:54:48,477 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:48,988 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:49,41 INFO     [learner.py:606] ====Pushing takes 0.05193758010864258 s
2021-08-18:15:54:49,78 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:49,87 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:49,88 INFO     [param_server.py:381] ====After aggregation in epoch: 99, virtual_clock: 3257.4290941673403, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.442454037842927, test len: 3099.0
2021-08-18:15:54:49,91 INFO     [param_server.py:410] Lock worker 3 with localStep 100 , while globalStep is 100

2021-08-18:15:54:49,91 INFO     [param_server.py:441] ====Epoch 101 completes 20 clients with loss 5.77019725152207, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:54:49,92 INFO     [param_server.py:450] ====Start to sample for epoch 101, global virtualClock: 3257.4290941673403, round_duration: 28.015855495488744
2021-08-18:15:54:49,93 INFO     [oort.py:208] Training selector: Pacer 99: lastExploitationUtil 268.4053138270224, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:54:49,94 INFO     [oort.py:321] scores are 26,{5: 0.006309002813938373, 6: 0.03893221861453653, 7: 0.06778732040040242, 11: 0.011658146757810496, 14: 0.005298495813867408, 27: 0.0342345879433154, 36: 0.020132044441786068, 50: 0.002894366904393204, 51: 0.15215369731472847, 53: 0.04511133694448234, 58: 0.002191267065439401, 60: 0.0016085046429943932, 67: 0.001196842736822455, 70: 0.004672054630320441, 79: 0.015586589427062713, 81: 0.017771159149340875, 84: 0.03119538318153426, 85: 0.030325912758412243, 87: 0.0520081518725736, 93: 0.011786040229308925, 97: 0.021625730497837052, 98: 0.3065199833765275, 105: 0.04523872216115955, 107: 0.006354546134164252, 110: 0.007195737494947385, 113: 0.4719081526319603, 119: 0.008762154256393614},[113, 98, 51, 7, 87, 105, 53, 6, 27, 84, 85, 97, 36, 81, 79, 93, 11, 119, 110, 107, 5, 14, 70, 50, 58, 60, 67]
2021-08-18:15:54:49,94 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:54:49,95 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:49,95 INFO     [oort.py:398] At round 99, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 21.753601635627824, 'time_stamp': 100, 'count': 94, 'status': True, 'gradient': 21.35489217294786}, [7.058342673055814e-09, -3.0000300003000056e-06]), ({'reward': 287.2558870885435, 'duration': 12.029357192292537, 'time_stamp': 100, 'count': 94, 'status': True, 'gradient': 27.319964064267403}, [0.20274799730803478, -3.0000300003000056e-06]), ({'reward': 863.7207706440562, 'duration': 13.411352670399307, 'time_stamp': 100, 'count': 97, 'status': True, 'gradient': 18.217035272682907}, [0.609636666019854, -3.0000300003000056e-06])]
2021-08-18:15:54:49,96 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:54:49,377 INFO     [param_server.py:541] Handle Wight 0.040741682052612305 | Send 0.2852456569671631
2021-08-18:15:54:49,378 INFO     [param_server.py:553] For epoch: 101, median_reward: 307.83886733474463, dev: 615.6777346694893
2021-08-18:15:54:49,983 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5194, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:54:49,984 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1541.4009, eval_time 0.5624, test_loss 2.5194, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:54:49,986 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1665, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:54:49,986 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1541.4005, eval_time 0.5648, test_loss 2.1665, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:54:50,23 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5234, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:54:50,24 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1541.4438, eval_time 0.6029, test_loss 2.5234, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:54:50,57 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:50,65 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:50,75 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:50,83 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:50,189 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:50,208 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:51,141 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:51,151 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:51,729 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:51,740 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:52,258 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:52,272 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:52,794 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:52,816 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:53,143 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:53,169 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:54,131 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:54,144 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:54,160 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:54,178 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:54,304 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:54,331 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:54,737 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:54,751 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:54,880 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:54,908 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:55,65 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:55,82 INFO     [learner.py:606] ====Pushing takes 0.01558232307434082 s
2021-08-18:15:54:55,103 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:55,108 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:54:55,109 INFO     [param_server.py:410] Lock worker 1 with localStep 101 , while globalStep is 100

2021-08-18:15:54:55,283 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:55,292 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:55,723 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:55,734 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:54:56,334 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:54:56,343 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:54:56,438 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:56,447 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:56,860 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:56,890 INFO     [learner.py:606] ====Pushing takes 0.02837681770324707 s
2021-08-18:15:54:56,923 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:56,931 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:54:56,932 INFO     [param_server.py:410] Lock worker 2 with localStep 101 , while globalStep is 100

2021-08-18:15:54:57,82 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:54:57,91 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:54:57,652 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:54:57,667 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:54:58,249 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:54:58,258 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:58,769 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:58,812 INFO     [learner.py:606] ====Pushing takes 0.04209566116333008 s
2021-08-18:15:54:58,862 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:58,874 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:58,874 INFO     [param_server.py:381] ====After aggregation in epoch: 100, virtual_clock: 3285.300092868885, top_1: : 60.9229 % (1888.0), top_5: : 100.0 % (3099.0), test loss: 2.403112407083865, test len: 3099.0
2021-08-18:15:54:58,877 INFO     [param_server.py:410] Lock worker 3 with localStep 101 , while globalStep is 101

2021-08-18:15:54:58,877 INFO     [param_server.py:441] ====Epoch 102 completes 20 clients with loss 5.8933272660255955, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:54:58,878 INFO     [param_server.py:450] ====Start to sample for epoch 102, global virtualClock: 3285.300092868885, round_duration: 27.87099870154445
2021-08-18:15:54:58,878 INFO     [oort.py:208] Training selector: Pacer 100: lastExploitationUtil 425.9436676228522, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:54:58,879 INFO     [oort.py:321] scores are 26,{5: 0.01630512876165129, 6: 0.21732799034855446, 7: 0.4609543785198012, 11: 0.01161296825918893, 14: 0.005813645448148472, 27: 0.023864272142108674, 36: 0.004346591626459518, 50: 0.012709455493712767, 51: 0.03797700746596002, 53: 0.08271126566744447, 58: 0.002404314403217575, 60: 0.0010728943871083716, 67: 0.0009452671054315875, 70: 0.005126298121058237, 79: 0.04764604682615047, 81: 0.11642752217283422, 84: 0.12847553912451254, 85: 0.007518470491133413, 87: 0.018599821000416947, 93: 0.05174416669862796, 97: 0.03696744102866506, 98: 0.3620279969548122, 105: 0.006324045108121071, 107: 0.006972370934264922, 110: 0.014319793105081155, 113: 0.1899931389718739, 119: 0.009614060291476576},[7, 98, 6, 113, 84, 81, 53, 93, 79, 51, 97, 27, 87, 5, 110, 50, 11, 119, 85, 107, 105, 14, 70, 36, 58, 60, 67]
2021-08-18:15:54:58,880 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:54:58,880 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:58,881 INFO     [oort.py:398] At round 100, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 419.8676932759878, 'duration': 13.298442137908651, 'time_stamp': 101, 'count': 98, 'status': True, 'gradient': 18.433099365216876}, [0.2116517072239624, -2.970326438875635e-06]), ({'reward': 1453.2331019106618, 'duration': 13.411352670399307, 'time_stamp': 101, 'count': 98, 'status': True, 'gradient': 18.22449968353449}, [0.7325747514296034, -2.970326438875635e-06]), ({'reward': 780.4644288424074, 'duration': 5.8943907365129, 'time_stamp': 101, 'count': 98, 'status': True, 'gradient': 21.363285108908013}, [0.3934297575169968, -2.970326438875635e-06])]
2021-08-18:15:54:58,882 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:54:59,156 INFO     [param_server.py:553] For epoch: 102, median_reward: 340.0258057742376, dev: 680.0516115484752
2021-08-18:15:54:59,769 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2909, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:54:59,770 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1551.1846, eval_time 0.57, test_loss 2.2909, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:54:59,803 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4998, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:54:59,807 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1551.2269, eval_time 0.6069, test_loss 2.4998, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:54:59,811 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4316, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:54:59,812 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1551.2291, eval_time 0.6116, test_loss 2.4316, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:54:59,838 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:59,846 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:59,878 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:59,884 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:59,901 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:59,901 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:01,165 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:01,177 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:01,821 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:01,835 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:02,183 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:02,193 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:02,892 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:02,904 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:03,42 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:03,69 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:04,53 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:04,62 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:04,154 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:04,181 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:04,530 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:04,542 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:04,595 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:04,604 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:04,723 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:04,750 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:04,913 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:04,948 INFO     [learner.py:606] ====Pushing takes 0.022426128387451172 s
2021-08-18:15:55:04,970 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:04,974 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:04,975 INFO     [param_server.py:410] Lock worker 1 with localStep 102 , while globalStep is 101

2021-08-18:15:55:05,253 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:05,263 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:06,469 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:06,480 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:06,487 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:06,489 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:07,63 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:07,64 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:07,72 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:07,84 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:07,673 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:07,683 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:55:08,277 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:55:08,287 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:08,476 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:08,504 INFO     [learner.py:606] ====Pushing takes 0.026914358139038086 s
2021-08-18:15:55:08,536 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:08,544 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:08,544 INFO     [param_server.py:410] Lock worker 2 with localStep 102 , while globalStep is 101

2021-08-18:15:55:08,806 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:08,842 INFO     [learner.py:606] ====Pushing takes 0.033833980560302734 s
2021-08-18:15:55:08,879 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:08,889 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:08,889 INFO     [param_server.py:381] ====After aggregation in epoch: 101, virtual_clock: 3313.9834958919005, top_1: : 57.4056 % (1779.0), top_5: : 100.0 % (3099.0), test loss: 2.407411972681681, test len: 3099.0
2021-08-18:15:55:08,891 INFO     [param_server.py:410] Lock worker 3 with localStep 102 , while globalStep is 102

2021-08-18:15:55:08,891 INFO     [param_server.py:441] ====Epoch 103 completes 20 clients with loss 7.150820691998497, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:08,892 INFO     [param_server.py:450] ====Start to sample for epoch 103, global virtualClock: 3313.9834958919005, round_duration: 28.683403023015895
2021-08-18:15:55:08,892 INFO     [oort.py:208] Training selector: Pacer 101: lastExploitationUtil 419.1438251022756, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:55:08,893 INFO     [oort.py:321] scores are 26,{5: 0.09933096760487903, 6: 0.038632442105155235, 7: 0.3281116457771966, 11: 0.10093362549061569, 14: 0.0065345602674632694, 27: 0.05004996020918812, 36: 0.009266667004265533, 50: 0.00287208039624276, 51: 0.5085727412780109, 53: 0.044763981473769685, 58: 0.0027024588117527714, 60: 0.001205937495795439, 67: 0.0010608711012852466, 70: 0.005761979178091645, 79: 0.0030022057254256674, 81: 0.017634321942342872, 84: 0.030955179992202517, 85: 0.07965621333532605, 87: 0.008008574644437978, 93: 0.07256793867640379, 97: 0.09885920419632999, 98: 0.25404651036925174, 105: 0.0028498174955767994, 107: 0.007836972254916868, 110: 0.007141519200269459, 113: 0.0672653607738232, 119: 0.0108062414452342},[51, 7, 98, 11, 5, 97, 85, 93, 113, 27, 53, 6, 84, 81, 119, 36, 87, 107, 110, 14, 70, 79, 50, 105, 58, 60, 67]
2021-08-18:15:55:08,911 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:55:08,911 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:08,912 INFO     [oort.py:398] At round 101, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 587.0436774456152, 'duration': 21.635252629006885, 'time_stamp': 102, 'count': 52, 'status': True, 'gradient': 21.78417397632364}, [0.350108590480275, -2.9412053059343743e-06]), ({'reward': 871.2701712753667, 'duration': 21.753601635627824, 'time_stamp': 102, 'count': 96, 'status': True, 'gradient': 21.366775002742017}, [0.5196220941513975, -2.9412053059343743e-06]), ({'reward': 1403.418934966629, 'duration': 12.029357192292537, 'time_stamp': 102, 'count': 96, 'status': True, 'gradient': 27.337018652660127}, [0.8369971572290665, -2.9412053059343743e-06])]
2021-08-18:15:55:08,912 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:55:09,193 INFO     [param_server.py:553] For epoch: 103, median_reward: 338.5525008949106, dev: 677.1050017898212
2021-08-18:15:55:09,726 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7229, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:55:09,728 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1561.1474, eval_time 0.5205, test_loss 2.7229, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:55:09,735 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2193, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:55:09,736 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1561.1499, eval_time 0.5252, test_loss 2.2193, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:55:09,743 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.434, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:15:55:09,744 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1561.1613, eval_time 0.5341, test_loss 2.434, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:15:55:09,802 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:55:09,806 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:55:09,814 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:09,816 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:55:09,816 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:09,826 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:11,7 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:11,26 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:12,310 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:12,322 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:12,381 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:12,395 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:12,458 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:12,468 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:13,445 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:13,460 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:13,596 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:13,630 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:14,316 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:14,349 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:14,698 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:14,710 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:14,781 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:14,795 INFO     [learner.py:606] ====Pushing takes 0.013598203659057617 s
2021-08-18:15:55:14,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:14,824 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:14,825 INFO     [param_server.py:410] Lock worker 1 with localStep 103 , while globalStep is 102

2021-08-18:15:55:15,654 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:15,667 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:15,721 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:15,732 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:16,352 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:16,361 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:18,659 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:18,680 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:18,696 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:18,709 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:19,333 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:19,347 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:19,386 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:19,406 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:19,891 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:19,918 INFO     [learner.py:606] ====Pushing takes 0.026229143142700195 s
2021-08-18:15:55:19,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:19,970 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:19,971 INFO     [param_server.py:410] Lock worker 2 with localStep 103 , while globalStep is 102

2021-08-18:15:55:19,998 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:20,18 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:55:20,649 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:55:20,663 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:21,282 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:21,322 INFO     [learner.py:606] ====Pushing takes 0.037763357162475586 s
2021-08-18:15:55:21,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:21,369 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:21,370 INFO     [param_server.py:381] ====After aggregation in epoch: 102, virtual_clock: 3352.3795174506863, top_1: : 60.0194 % (1860.0), top_5: : 100.0 % (3099.0), test loss: 2.4587301126232854, test len: 3099.0
2021-08-18:15:55:21,372 INFO     [param_server.py:410] Lock worker 3 with localStep 103 , while globalStep is 103

2021-08-18:15:55:21,373 INFO     [param_server.py:441] ====Epoch 104 completes 20 clients with loss 5.990618232876153, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:21,373 INFO     [param_server.py:450] ====Start to sample for epoch 104, global virtualClock: 3352.3795174506863, round_duration: 38.39602155878561
2021-08-18:15:55:21,374 INFO     [oort.py:208] Training selector: Pacer 102: lastExploitationUtil 540.7155059870298, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:55:21,374 INFO     [oort.py:321] scores are 26,{5: 0.006236605510538481, 6: 0.3245561810001945, 7: 0.16067378051549364, 11: 0.15929840886154384, 14: 0.008264076819621742, 27: 0.09408744713001546, 36: 0.002903359173352972, 50: 0.026231918499209743, 51: 0.07787948556052078, 53: 0.044593673655391866, 58: 0.003417724576417204, 60: 0.0012407282702687065, 67: 0.0018667185302327788, 70: 0.007287014980626309, 79: 0.024699831529820047, 81: 0.1579790346462227, 84: 0.22307256459496336, 85: 0.08899906229783763, 87: 0.03694160693359108, 93: 0.011650792622749064, 97: 0.038408162500096175, 98: 0.16770450781268811, 105: 0.023856949119058016, 107: 0.009911201075052486, 110: 0.007113164700803635, 113: 0.4126662828872196, 119: 0.013666353324408707},[113, 6, 84, 98, 7, 11, 81, 27, 85, 51, 53, 97, 87, 50, 79, 105, 119, 93, 107, 14, 70, 110, 5, 58, 36, 67, 60]
2021-08-18:15:55:21,386 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:55:21,387 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:21,387 INFO     [oort.py:398] At round 102, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 491.2598627202863, 'duration': 13.411352670399307, 'time_stamp': 103, 'count': 100, 'status': True, 'gradient': 18.237170127431256}, [0.3036256298700071, -2.9126496373751228e-06]), ({'reward': 866.573417590205, 'duration': 17.619275735353515, 'time_stamp': 103, 'count': 99, 'status': True, 'gradient': 20.1225030292931}, [0.5355947780045563, -2.9126496373751228e-06]), ({'reward': 1184.8413069384703, 'duration': 27.035726288496562, 'time_stamp': 103, 'count': 96, 'status': True, 'gradient': 16.768635702223502}, [0.7323058485553827, -2.9126496373751228e-06])]
2021-08-18:15:55:21,388 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:55:21,669 INFO     [param_server.py:553] For epoch: 104, median_reward: 366.1492921549978, dev: 732.2985843099956
2021-08-18:15:55:22,272 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1683, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:55:22,273 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1573.6869, eval_time 0.5802, test_loss 2.1683, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:55:22,281 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5158, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:55:22,282 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1573.699, eval_time 0.5898, test_loss 2.5158, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:55:22,311 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5771, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:55:22,315 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1573.7348, eval_time 0.6231, test_loss 2.5771, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:55:22,339 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:22,349 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:22,349 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:22,366 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:22,382 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:22,405 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:23,570 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:23,581 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:24,270 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:24,279 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:24,578 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:24,588 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:25,293 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:25,302 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:25,609 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:25,637 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:26,239 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:26,248 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:26,604 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:26,613 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:26,774 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:26,786 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:26,944 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:26,971 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:27,338 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:27,348 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:27,718 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:27,745 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:28,205 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:28,228 INFO     [learner.py:606] ====Pushing takes 0.02092719078063965 s
2021-08-18:15:55:28,244 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:28,248 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:28,249 INFO     [param_server.py:410] Lock worker 1 with localStep 104 , while globalStep is 103

2021-08-18:15:55:28,258 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:28,279 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:28,499 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:28,512 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:28,966 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:28,980 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:29,8 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:29,17 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:29,642 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:29,656 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:55:30,163 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:55:30,172 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:30,243 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:30,274 INFO     [learner.py:606] ====Pushing takes 0.029306650161743164 s
2021-08-18:15:55:30,313 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:30,321 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:30,322 INFO     [param_server.py:410] Lock worker 2 with localStep 104 , while globalStep is 103

2021-08-18:15:55:30,777 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:30,815 INFO     [learner.py:606] ====Pushing takes 0.03594803810119629 s
2021-08-18:15:55:30,852 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:30,862 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:30,863 INFO     [param_server.py:381] ====After aggregation in epoch: 103, virtual_clock: 3380.395372946175, top_1: : 59.1481 % (1833.0), top_5: : 100.0 % (3099.0), test loss: 2.4203922318087683, test len: 3099.0
2021-08-18:15:55:30,865 INFO     [param_server.py:410] Lock worker 3 with localStep 104 , while globalStep is 104

2021-08-18:15:55:30,865 INFO     [param_server.py:441] ====Epoch 105 completes 20 clients with loss 4.256506029316296, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:30,866 INFO     [param_server.py:450] ====Start to sample for epoch 105, global virtualClock: 3380.395372946175, round_duration: 28.015855495488744
2021-08-18:15:55:30,867 INFO     [oort.py:208] Training selector: Pacer 103: lastExploitationUtil 448.01166390250313, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:55:30,868 INFO     [oort.py:321] scores are 26,{5: 0.04685076131676847, 6: 0.03834036442436136, 7: 0.06675680605913277, 11: 0.1546010604571303, 14: 0.008108645942031794, 27: 0.005886524742128475, 36: 0.002892412939178625, 50: 0.045548128398297166, 51: 0.4697749485853393, 53: 0.2478288541229937, 58: 0.0033534439626392723, 60: 0.0014188335934957553, 67: 0.0018316092608370012, 70: 0.0071499606963824095, 79: 0.0029795077742280286, 81: 0.1305630970710594, 84: 0.030721145675757556, 85: 0.007432978245774428, 87: 0.08922986186743882, 93: 0.12451539843763126, 97: 0.22681803793266014, 98: 0.03020603891641023, 105: 0.025263314383653007, 107: 0.009724791060396261, 110: 0.03446290351025628, 113: 0.06675680605913277, 119: 0.013409316351370937},[51, 53, 97, 11, 81, 93, 87, 7, 113, 5, 50, 6, 110, 84, 98, 105, 119, 107, 14, 85, 70, 27, 58, 79, 36, 67, 60]
2021-08-18:15:55:30,869 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:55:30,869 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:30,870 INFO     [oort.py:398] At round 103, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1053.2362012928006, 'duration': 12.029357192292537, 'time_stamp': 104, 'count': 98, 'status': True, 'gradient': 27.359575778985512}, [0.7685216985342936, -2.8846431215684793e-06]), ({'reward': 418.8867966720844, 'duration': 11.058674649423494, 'time_stamp': 104, 'count': 101, 'status': True, 'gradient': 18.45342857604037}, [0.3056474587212466, -2.8846431215684793e-06]), ({'reward': 882.8856679708825, 'duration': 15.972045438625893, 'time_stamp': 104, 'count': 101, 'status': True, 'gradient': 21.177076745713002}, [0.6442197396473365, -2.8846431215684793e-06])]
2021-08-18:15:55:30,870 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:55:31,171 INFO     [param_server.py:553] For epoch: 105, median_reward: 346.06338245014854, dev: 692.1267649002971
2021-08-18:15:55:31,729 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2492, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:55:31,730 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1583.1438, eval_time 0.5116, test_loss 2.2492, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:55:31,770 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4843, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:55:31,774 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1583.1911, eval_time 0.5565, test_loss 2.4843, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:55:31,795 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:31,805 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:31,813 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7022, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:55:31,816 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1583.2362, eval_time 0.6014, test_loss 2.7022, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:55:31,883 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:31,895 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:31,905 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:31,925 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:33,133 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:33,160 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:34,351 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:34,363 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:34,553 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:34,566 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:34,957 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:34,978 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:35,569 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:35,581 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:36,81 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:36,101 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:36,681 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:36,701 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:36,882 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:36,891 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:37,27 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:37,40 INFO     [learner.py:606] ====Pushing takes 0.011549711227416992 s
2021-08-18:15:55:37,62 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:37,67 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:37,68 INFO     [param_server.py:410] Lock worker 1 with localStep 105 , while globalStep is 104

2021-08-18:15:55:37,736 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:37,745 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:38,74 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:38,86 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:38,684 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:38,698 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:40,616 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:40,628 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:40,940 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:40,951 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:41,226 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:41,235 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:41,674 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:41,684 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:41,768 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:41,797 INFO     [learner.py:606] ====Pushing takes 0.028112173080444336 s
2021-08-18:15:55:41,835 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:41,845 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:41,846 INFO     [param_server.py:410] Lock worker 2 with localStep 105 , while globalStep is 104

2021-08-18:15:55:42,283 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:42,293 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:55:42,792 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:55:42,801 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:43,392 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:43,430 INFO     [learner.py:606] ====Pushing takes 0.03734588623046875 s
2021-08-18:15:55:43,469 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:43,479 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:43,479 INFO     [param_server.py:381] ====After aggregation in epoch: 104, virtual_clock: 3418.791394504961, top_1: : 60.7938 % (1884.0), top_5: : 100.0 % (3099.0), test loss: 2.478579269515144, test len: 3099.0
2021-08-18:15:55:43,481 INFO     [param_server.py:410] Lock worker 3 with localStep 105 , while globalStep is 105

2021-08-18:15:55:43,481 INFO     [param_server.py:441] ====Epoch 106 completes 20 clients with loss 5.805132243620164, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:43,482 INFO     [param_server.py:450] ====Start to sample for epoch 106, global virtualClock: 3418.791394504961, round_duration: 38.39602155878561
2021-08-18:15:55:43,482 INFO     [oort.py:208] Training selector: Pacer 104: lastExploitationUtil 562.7213477506781, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:55:43,482 INFO     [oort.py:321] scores are 26,{5: 0.03394716581855287, 6: 0.20702279985868874, 7: 0.06650737091284317, 11: 0.09884393386471547, 14: 0.009717811739867379, 27: 0.04542411656031227, 36: 0.043836090025613096, 50: 0.02206839011220832, 51: 0.037404885738406585, 53: 0.04425955179846763, 58: 0.004018936989245045, 60: 0.001404005991035635, 67: 0.0021950932504708237, 70: 0.00856887481481096, 79: 0.002968374917499124, 81: 0.17195818725329626, 84: 0.4120768621996385, 85: 0.11874933061354445, 87: 0.00791832881342553, 93: 0.011563498077432288, 97: 0.08722431387793864, 98: 0.42415533556678636, 105: 0.013633881860618901, 107: 0.011654681855648543, 110: 0.0941345714712151, 113: 0.6555805207323772, 119: 0.016070403467424842},[113, 98, 84, 6, 81, 85, 11, 110, 97, 7, 27, 53, 36, 51, 5, 50, 119, 105, 107, 93, 14, 70, 87, 58, 79, 67, 60]
2021-08-18:15:55:43,483 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:55:43,484 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:43,484 INFO     [oort.py:398] At round 104, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 818.4103226870369, 'duration': 17.619275735353515, 'time_stamp': 105, 'count': 101, 'status': True, 'gradient': 20.140310892723775}, [0.5894197278680774, -2.8571700682863672e-06]), ({'reward': 817.9291143347842, 'duration': 8.009219946401625, 'time_stamp': 105, 'count': 29, 'status': True, 'gradient': 21.188005937387725}, [0.5890731570216294, -2.8571700682863672e-06]), ({'reward': 408.15923311489337, 'duration': 11.90395711384456, 'time_stamp': 105, 'count': 102, 'status': True, 'gradient': 21.081039787661012}, [0.29395297899804085, -2.8571700682863672e-06])]
2021-08-18:15:55:43,485 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:55:43,789 INFO     [param_server.py:553] For epoch: 106, median_reward: 370.917242875323, dev: 741.834485750646
2021-08-18:15:55:44,403 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3199, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:55:44,404 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1595.8179, eval_time 0.5677, test_loss 2.3199, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:55:44,470 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:44,478 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:44,488 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5189, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:55:44,489 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1595.906, eval_time 0.655, test_loss 2.5189, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:55:44,552 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4573, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:55:44,554 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1595.974, eval_time 0.7214, test_loss 2.4573, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:55:44,579 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:44,599 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:44,634 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:44,663 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:45,789 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:45,800 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:46,392 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:46,402 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:46,685 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:46,695 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:47,494 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:47,513 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:47,713 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:47,734 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:48,586 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:48,596 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:49,137 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:49,157 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:49,224 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:49,239 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:49,243 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:49,248 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:49,782 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:49,809 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:49,851 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:49,860 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:50,217 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:50,238 INFO     [learner.py:606] ====Pushing takes 0.020200252532958984 s
2021-08-18:15:55:50,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:50,264 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:50,265 INFO     [param_server.py:410] Lock worker 1 with localStep 106 , while globalStep is 105

2021-08-18:15:55:50,921 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:50,930 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:51,421 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:51,431 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:51,531 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:51,543 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:51,939 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:51,948 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:52,584 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:52,597 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:55:52,833 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:52,866 INFO     [learner.py:606] ====Pushing takes 0.029428958892822266 s
2021-08-18:15:55:52,896 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:52,906 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:52,907 INFO     [param_server.py:410] Lock worker 2 with localStep 106 , while globalStep is 105

2021-08-18:15:55:53,154 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:55:53,166 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:53,658 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:53,718 INFO     [learner.py:606] ====Pushing takes 0.03933596611022949 s
2021-08-18:15:55:53,758 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:53,769 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:53,769 INFO     [param_server.py:381] ====After aggregation in epoch: 105, virtual_clock: 3447.4747975279765, top_1: : 59.5999 % (1847.0), top_5: : 100.0 % (3099.0), test loss: 2.432041587652984, test len: 3099.0
2021-08-18:15:55:53,772 INFO     [param_server.py:410] Lock worker 3 with localStep 106 , while globalStep is 106

2021-08-18:15:55:53,772 INFO     [param_server.py:441] ====Epoch 107 completes 20 clients with loss 7.222328338618981, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:53,773 INFO     [param_server.py:450] ====Start to sample for epoch 107, global virtualClock: 3447.4747975279765, round_duration: 28.683403023015895
2021-08-18:15:55:53,774 INFO     [oort.py:208] Training selector: Pacer 105: lastExploitationUtil 468.07833823389404, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:55:53,775 INFO     [oort.py:321] scores are 26,{5: 0.00815449825804987, 6: 0.21883899314366811, 7: 0.2534363774336049, 11: 0.049009801854808355, 14: 0.005658017703781219, 27: 0.039654464531552414, 36: 0.0028709338226527606, 50: 0.027922429034103902, 51: 0.03726636113830687, 53: 0.04409564174788351, 58: 0.002339952372429884, 60: 0.0010441736584538334, 67: 0.0014756006845227827, 70: 0.004989070245596986, 79: 0.010099182107829521, 81: 0.14132772935503457, 84: 0.030493009831514987, 85: 0.0073777808001702265, 87: 0.007889004212890485, 93: 0.011786006966263097, 97: 0.34016205802300736, 98: 0.049787901285595605, 105: 0.024152364469540954, 107: 0.006785724815049477, 110: 0.007033723320581443, 112: 0.2265635040830374, 113: 0.33962256258692486, 119: 0.00935669775867028},[97, 113, 7, 112, 6, 81, 98, 11, 53, 27, 51, 84, 50, 105, 93, 79, 119, 5, 87, 85, 110, 107, 14, 70, 36, 58, 67, 60]
2021-08-18:15:55:53,776 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:55:53,776 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:53,777 INFO     [oort.py:398] At round 105, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 106, 'count': 103, 'status': True, 'gradient': 18.4701178289371}, [4.452828604635275e-09, -2.830215379390374e-06]), ({'reward': 420.36147852078943, 'duration': 5.8943907365129, 'time_stamp': 106, 'count': 103, 'status': True, 'gradient': 21.408049218203224}, [0.18717531320864636, -2.830215379390374e-06]), ({'reward': 706.9161376863916, 'duration': 11.90395711384456, 'time_stamp': 106, 'count': 103, 'status': True, 'gradient': 21.090559484239797}, [0.3147731915210621, -2.830215379390374e-06])]
2021-08-18:15:55:53,777 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 27, 79, 36, 50, 105, 119]
2021-08-18:15:55:54,51 INFO     [param_server.py:553] For epoch: 107, median_reward: 351.6076625680922, dev: 703.2153251361844
2021-08-18:15:55:54,698 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3762, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:15:55:54,699 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1606.1166, eval_time 0.5925, test_loss 2.3762, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:15:55:54,705 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3285, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:55:54,706 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1606.1206, eval_time 0.5983, test_loss 2.3285, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:55:54,775 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:54,784 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:54,795 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:54,799 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.276, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:55:54,799 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1606.2191, eval_time 0.6927, test_loss 2.276, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:55:54,815 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:54,883 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:54,911 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:56,132 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:56,146 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:57,340 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:57,349 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:57,387 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:57,407 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:58,109 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:58,135 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:58,606 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:58,633 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:59,287 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:59,300 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:59,667 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:59,678 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:59,781 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:59,790 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:00,20 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:00,34 INFO     [learner.py:606] ====Pushing takes 0.012392520904541016 s
2021-08-18:15:56:00,57 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:00,65 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:00,65 INFO     [param_server.py:410] Lock worker 1 with localStep 107 , while globalStep is 106

2021-08-18:15:56:00,818 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:00,830 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:00,831 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:00,843 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:01,417 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:01,426 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:03,398 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:03,410 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:03,622 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:03,631 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:03,934 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:03,944 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:56:04,289 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:04,298 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:04,544 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:56:04,573 INFO     [learner.py:606] ====Pushing takes 0.028032541275024414 s
2021-08-18:15:56:04,609 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:04,617 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:04,618 INFO     [param_server.py:410] Lock worker 2 with localStep 107 , while globalStep is 106

2021-08-18:15:56:04,989 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:04,999 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:56:05,713 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:56:05,727 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:06,328 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:06,368 INFO     [learner.py:606] ====Pushing takes 0.03870081901550293 s
2021-08-18:15:56:06,419 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:06,430 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:06,431 INFO     [param_server.py:381] ====After aggregation in epoch: 106, virtual_clock: 3485.8708190867624, top_1: : 61.4714 % (1905.0), top_5: : 100.0 % (3099.0), test loss: 2.3269374988697193, test len: 3099.0
2021-08-18:15:56:06,433 INFO     [param_server.py:410] Lock worker 3 with localStep 107 , while globalStep is 107

2021-08-18:15:56:06,434 INFO     [param_server.py:441] ====Epoch 108 completes 20 clients with loss 5.774248551011022, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:56:06,434 INFO     [param_server.py:450] ====Start to sample for epoch 108, global virtualClock: 3485.8708190867624, round_duration: 38.39602155878561
2021-08-18:15:56:06,435 INFO     [oort.py:208] Training selector: Pacer 106: lastExploitationUtil 394.17290010432947, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:56:06,435 INFO     [oort.py:321] scores are 26,{5: 0.008799419700784183, 6: 0.0379159542884796, 7: 0.4147239041544455, 11: 0.0812161189835388, 14: 0.006136819492161604, 27: 0.029943082045755853, 36: 0.02590064888405154, 50: 0.03135649285238064, 51: 0.07893378292643687, 53: 0.0486535838560195, 58: 0.0025379675500592533, 60: 0.0012990118854613022, 67: 0.0013862062167079566, 70: 0.0054112632964159685, 79: 0.007584730440225368, 81: 0.01730727099400693, 84: 0.030381076774315216, 85: 0.045315739980243096, 87: 0.007860045433003232, 93: 0.02427641215119218, 97: 0.1265710106011415, 98: 0.03942555933268695, 105: 0.04516375496322918, 107: 0.007359957231242086, 110: 0.018951435153146238, 113: 0.41135969228367353, 119: 0.0022487929398112023},[7, 113, 97, 11, 51, 53, 85, 105, 98, 6, 50, 84, 27, 36, 93, 110, 81, 5, 87, 79, 107, 14, 70, 58, 119, 67, 60]
2021-08-18:15:56:06,436 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:56:06,437 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:06,437 INFO     [oort.py:398] At round 106, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 592.682024301022, 'duration': 5.8943907365129, 'time_stamp': 107, 'count': 104, 'status': True, 'gradient': 21.41360455909536}, [0.3487060710064037, -2.8037645211637515e-06]), ({'reward': 47.968835887409995, 'duration': 29.570969934622333, 'time_stamp': 106, 'count': 90, 'status': True, 'gradient': 11.753487486290155}, [0.028217192226934678, 0.0028009607566425853]), ({'reward': 0.01, 'duration': 26.145070720211294, 'time_stamp': 107, 'count': 101, 'status': True, 'gradient': 23.51624292113601}, [5.88362620176e-09, -2.8037645211637515e-06])]
2021-08-18:15:56:06,438 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:56:06,714 INFO     [param_server.py:553] For epoch: 108, median_reward: 331.9210274042775, dev: 663.842054808555
2021-08-18:15:56:07,432 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6357, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:15:56:07,433 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1618.8476, eval_time 0.6716, test_loss 2.6357, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:15:56:07,441 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6093, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:56:07,443 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1618.8601, eval_time 0.6814, test_loss 2.6093, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:56:07,504 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:56:07,509 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8302, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:56:07,512 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1618.9317, eval_time 0.7529, test_loss 2.8302, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:56:07,515 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:07,528 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:56:07,544 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:07,569 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:56:07,587 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:08,667 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:08,687 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:09,320 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:09,340 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:09,648 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:09,661 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:10,485 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:10,504 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:10,736 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:10,752 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:11,478 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:11,488 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:12,41 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:12,61 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:12,101 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:12,112 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:12,233 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:12,243 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:12,624 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:12,635 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:12,646 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:12,666 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:13,57 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:13,79 INFO     [learner.py:606] ====Pushing takes 0.020976781845092773 s
2021-08-18:15:56:13,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:13,107 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:13,108 INFO     [param_server.py:410] Lock worker 1 with localStep 108 , while globalStep is 107

2021-08-18:15:56:13,905 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:13,917 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:14,239 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:14,249 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:14,543 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:14,554 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:14,797 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:14,809 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:15,435 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:15,448 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:56:15,791 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:15,819 INFO     [learner.py:606] ====Pushing takes 0.026476621627807617 s
2021-08-18:15:56:15,860 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:15,867 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:15,868 INFO     [param_server.py:410] Lock worker 2 with localStep 108 , while globalStep is 107

2021-08-18:15:56:15,939 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:56:15,949 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:16,415 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:16,456 INFO     [learner.py:606] ====Pushing takes 0.03848433494567871 s
2021-08-18:15:56:16,495 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:16,507 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:16,508 INFO     [param_server.py:381] ====After aggregation in epoch: 107, virtual_clock: 3514.554222109778, top_1: : 61.052 % (1892.0), top_5: : 100.0 % (3099.0), test loss: 2.691723368785999, test len: 3099.0
2021-08-18:15:56:16,510 INFO     [param_server.py:410] Lock worker 3 with localStep 108 , while globalStep is 108

2021-08-18:15:56:16,510 INFO     [param_server.py:441] ====Epoch 109 completes 20 clients with loss 6.9600648742614, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:16,510 INFO     [param_server.py:450] ====Start to sample for epoch 109, global virtualClock: 3514.554222109778, round_duration: 28.683403023015895
2021-08-18:15:56:16,511 INFO     [oort.py:208] Training selector: Pacer 107: lastExploitationUtil 430.0412629873815, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:56:16,512 INFO     [oort.py:321] scores are 26,{5: 0.006121958246693395, 6: 0.37558940514949807, 7: 0.06577761294220033, 11: 0.012533888148650705, 14: 0.008082284462238501, 27: 0.07536064315722757, 36: 0.030905404408354722, 50: 0.002808556892724742, 51: 0.5994115990965286, 53: 0.04377390997773864, 58: 0.003342541803895256, 60: 0.0014915663006781, 67: 0.0017003333735248394, 70: 0.007126715934461865, 79: 0.002935804162917049, 81: 0.017244293197532068, 84: 0.18961227947993664, 85: 0.022170854403170424, 87: 0.007831444254820128, 93: 0.13553195694169778, 97: 0.1292257470452961, 98: 0.33186640743692464, 105: 0.02563069814344285, 107: 0.009693175438643219, 110: 0.006982403685240189, 113: 0.8266449524731644, 119: 0.013365722214376229},[113, 51, 6, 98, 84, 93, 97, 27, 7, 53, 36, 105, 85, 81, 119, 11, 107, 14, 87, 70, 110, 5, 58, 79, 50, 67, 60]
2021-08-18:15:56:16,512 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:56:16,513 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:16,513 INFO     [oort.py:398] At round 107, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 108, 'count': 105, 'status': True, 'gradient': 21.421118356107012}, [7.594768400060058e-09, -2.777803498180541e-06]), ({'reward': 774.4702025065271, 'duration': 11.90395711384456, 'time_stamp': 108, 'count': 105, 'status': True, 'gradient': 21.11037860461527}, [0.5881845949048609, -2.777803498180541e-06]), ({'reward': 1316.705835513935, 'duration': 12.029357192292537, 'time_stamp': 108, 'count': 102, 'status': True, 'gradient': 27.40596978907857}, [1.0, -2.777803498180541e-06])]
2021-08-18:15:56:16,514 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:56:16,794 INFO     [param_server.py:553] For epoch: 109, median_reward: 341.96168927322174, dev: 683.9233785464435
2021-08-18:15:56:17,451 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3514, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:56:17,452 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1628.866, eval_time 0.6017, test_loss 2.3514, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:56:17,492 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4326, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:56:17,493 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1628.9132, eval_time 0.6436, test_loss 2.4326, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:56:17,518 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:56:17,527 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:17,530 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6279, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:56:17,531 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1628.9479, eval_time 0.6807, test_loss 2.6279, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:56:17,576 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:56:17,599 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:56:17,613 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:17,620 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:18,897 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:18,908 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:20,29 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:20,49 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:20,282 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:20,292 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:20,590 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:20,604 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:21,284 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:21,302 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:21,626 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:21,640 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:22,170 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:22,184 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:22,504 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:22,519 INFO     [learner.py:606] ====Pushing takes 0.013356208801269531 s
2021-08-18:15:56:22,542 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:22,551 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:22,551 INFO     [param_server.py:410] Lock worker 1 with localStep 109 , while globalStep is 108

2021-08-18:15:56:22,577 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:22,586 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:23,629 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:23,641 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:23,644 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:23,657 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:24,173 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:24,184 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:26,282 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:26,301 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:26,516 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:26,534 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:26,964 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:26,978 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:27,102 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:27,112 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:27,595 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:27,623 INFO     [learner.py:606] ====Pushing takes 0.02662968635559082 s
2021-08-18:15:56:27,661 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:27,670 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:27,670 INFO     [param_server.py:410] Lock worker 2 with localStep 109 , while globalStep is 108

2021-08-18:15:56:27,724 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:27,733 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:56:28,367 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:56:28,377 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:28,981 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:29,18 INFO     [learner.py:606] ====Pushing takes 0.0358431339263916 s
2021-08-18:15:56:29,57 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:29,68 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:29,69 INFO     [param_server.py:381] ====After aggregation in epoch: 108, virtual_clock: 3552.950243668564, top_1: : 58.8577 % (1824.0), top_5: : 100.0 % (3099.0), test loss: 2.4706240936561863, test len: 3099.0
2021-08-18:15:56:29,71 INFO     [param_server.py:410] Lock worker 3 with localStep 109 , while globalStep is 109

2021-08-18:15:56:29,72 INFO     [param_server.py:441] ====Epoch 110 completes 20 clients with loss 6.168338840792272, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:29,72 INFO     [param_server.py:450] ====Start to sample for epoch 110, global virtualClock: 3552.950243668564, round_duration: 38.39602155878561
2021-08-18:15:56:29,73 INFO     [oort.py:208] Training selector: Pacer 108: lastExploitationUtil 483.3052974603447, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:56:29,74 INFO     [oort.py:321] scores are 26,{5: 0.07672734402149729, 6: 0.037641704366170224, 7: 0.06554032534210825, 11: 0.10890436312329675, 14: 0.009020994241623318, 27: 0.047632156768177586, 36: 0.04331572939684622, 50: 0.017257247103921517, 51: 0.27550184703102926, 53: 0.2166684249168576, 58: 0.0037307583649404262, 60: 0.0016648029492505477, 67: 0.001720966302376176, 70: 0.007954442052471337, 79: 0.04755748286308304, 81: 0.20079627441714543, 84: 0.030161327381180124, 85: 0.02498230813826976, 87: 0.007803192931469218, 93: 0.10348942896888828, 97: 0.28464398003881275, 98: 0.029655607191936224, 105: 0.01677250495427456, 107: 0.010818980725509722, 110: 0.022231658668742663, 113: 0.06554032534210825, 119: 0.014918072197823967},[97, 51, 53, 81, 11, 93, 5, 7, 113, 27, 79, 36, 6, 84, 98, 85, 110, 50, 105, 119, 107, 14, 70, 87, 58, 67, 60]
2021-08-18:15:56:29,75 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:56:29,75 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:29,76 INFO     [oort.py:398] At round 108, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 428.72092450362277, 'duration': 43.8287324306519, 'time_stamp': 109, 'count': 96, 'status': True, 'gradient': 11.766864887673798}, [0.33034769925619467, -2.7523188286131087e-06]), ({'reward': 550.6648880620501, 'duration': 12.029357192292537, 'time_stamp': 109, 'count': 103, 'status': True, 'gradient': 27.41311362067235}, [0.4243128971496188, -2.7523188286131087e-06]), ({'reward': 186.7476222117781, 'duration': 27.689063957948644, 'time_stamp': 109, 'count': 101, 'status': True, 'gradient': 20.692559757263684}, [0.14389263767469657, -2.7523188286131087e-06])]
2021-08-18:15:56:29,77 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:56:29,409 INFO     [param_server.py:553] For epoch: 110, median_reward: 353.5022744623924, dev: 707.0045489247848
2021-08-18:15:56:30,0 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2717, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:56:30,1 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1641.4151, eval_time 0.5525, test_loss 2.2717, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:56:30,71 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:30,80 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:30,80 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4662, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:56:30,83 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1641.5028, eval_time 0.6349, test_loss 2.4662, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:56:30,92 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5603, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:56:30,92 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1641.5096, eval_time 0.644, test_loss 2.5603, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:56:30,156 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:30,161 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:30,173 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:30,176 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:31,575 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:31,589 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:32,162 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:32,180 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:32,195 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:32,205 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:33,338 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:33,356 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:33,359 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:33,379 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:33,997 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:34,6 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:34,492 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:34,512 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:34,647 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:34,661 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:35,116 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:35,127 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:35,152 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:35,179 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:35,282 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:35,291 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:35,615 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:35,637 INFO     [learner.py:606] ====Pushing takes 0.02055525779724121 s
2021-08-18:15:56:35,660 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:35,666 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:35,667 INFO     [param_server.py:410] Lock worker 1 with localStep 110 , while globalStep is 109

2021-08-18:15:56:36,473 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:36,540 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:36,829 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:36,850 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:37,61 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:37,75 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:37,522 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:37,540 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:37,625 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:37,639 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:56:38,246 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:56:38,256 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:38,765 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:38,794 INFO     [learner.py:606] ====Pushing takes 0.026812314987182617 s
2021-08-18:15:56:38,829 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:38,833 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:38,839 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:38,840 INFO     [param_server.py:410] Lock worker 2 with localStep 110 , while globalStep is 109

2021-08-18:15:56:38,871 INFO     [learner.py:606] ====Pushing takes 0.03586578369140625 s
2021-08-18:15:56:38,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:38,917 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:38,918 INFO     [param_server.py:381] ====After aggregation in epoch: 109, virtual_clock: 3580.9660991640526, top_1: : 58.4382 % (1811.0), top_5: : 100.0 % (3099.0), test loss: 2.432760744183152, test len: 3099.0
2021-08-18:15:56:38,920 INFO     [param_server.py:410] Lock worker 3 with localStep 110 , while globalStep is 110

2021-08-18:15:56:38,920 INFO     [param_server.py:441] ====Epoch 111 completes 20 clients with loss 5.019600233937046, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:38,921 INFO     [param_server.py:450] ====Start to sample for epoch 111, global virtualClock: 3580.9660991640526, round_duration: 28.015855495488744
2021-08-18:15:56:38,921 INFO     [oort.py:208] Training selector: Pacer 109: lastExploitationUtil 390.2843983649567, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:56:38,922 INFO     [oort.py:321] scores are 26,{5: 0.0060780570904484035, 6: 0.037507075900201456, 7: 0.06530591530121138, 11: 0.011231391656103058, 14: 0.006651989084809429, 27: 0.026160041442618968, 36: 0.032374889987828365, 50: 0.010994545064052208, 51: 0.04580933723400978, 53: 0.043460003024448836, 58: 0.002751023141899202, 60: 0.0012276087036699394, 67: 0.0015187483644910895, 70: 0.005865524385842734, 79: 0.014200304937020214, 81: 0.12756345844549788, 84: 0.03331164629054093, 85: 0.03296662984601889, 87: 0.0077752842086387455, 93: 0.011354603492297792, 97: 0.3398573412139227, 98: 0.33316002640050085, 105: 0.04091373238695745, 107: 0.007977805967638413, 110: 0.06332562711274815, 113: 0.08174686241384217, 119: 0.011000434183678942},[97, 98, 81, 113, 7, 110, 51, 53, 105, 6, 84, 85, 36, 27, 79, 93, 11, 119, 50, 107, 87, 14, 5, 70, 58, 67, 60]
2021-08-18:15:56:38,923 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:56:38,924 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:38,924 INFO     [oort.py:398] At round 109, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1016.4627044277821, 'duration': 13.411352670399307, 'time_stamp': 110, 'count': 107, 'status': True, 'gradient': 18.289850665145824}, [0.6709938534311574, -2.727297520886556e-06]), ({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 110, 'count': 107, 'status': True, 'gradient': 18.498291377065513}, [6.601328757421538e-09, -2.727297520886556e-06]), ({'reward': 804.7753393420272, 'duration': 27.689063957948644, 'time_stamp': 110, 'count': 102, 'status': True, 'gradient': 20.70311426537569}, [0.5312520643588131, -2.727297520886556e-06])]
2021-08-18:15:56:38,925 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 27, 79, 36, 50, 105, 119]
2021-08-18:15:56:39,268 INFO     [param_server.py:553] For epoch: 111, median_reward: 333.3476688076423, dev: 666.6953376152846
2021-08-18:15:56:39,908 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3252, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:56:39,909 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1651.3287, eval_time 0.596, test_loss 3.3252, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:56:39,912 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5082, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:56:39,913 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1651.3272, eval_time 0.5998, test_loss 2.5082, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:56:39,956 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7615, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:56:39,957 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1651.3744, eval_time 0.6442, test_loss 2.7615, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:56:39,981 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:39,989 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:39,989 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:40,16 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:40,28 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:40,41 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:41,511 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:41,524 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:42,639 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:42,653 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:42,770 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:42,782 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:42,969 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:42,990 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:43,766 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:43,777 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:44,104 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:44,132 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:44,820 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:44,854 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:45,142 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:45,151 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:45,288 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:45,302 INFO     [learner.py:606] ====Pushing takes 0.013179302215576172 s
2021-08-18:15:56:45,319 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:45,325 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:45,326 INFO     [param_server.py:410] Lock worker 1 with localStep 111 , while globalStep is 110

2021-08-18:15:56:46,82 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:46,101 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:46,432 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:46,441 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:47,94 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:47,103 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:49,68 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:49,88 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:49,283 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:49,298 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:49,653 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:49,664 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:56:49,881 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:49,890 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:50,247 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:56:50,277 INFO     [learner.py:606] ====Pushing takes 0.028415441513061523 s
2021-08-18:15:56:50,317 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:50,329 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:50,330 INFO     [param_server.py:410] Lock worker 2 with localStep 111 , while globalStep is 110

2021-08-18:15:56:50,603 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:50,612 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:56:51,191 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:56:51,200 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:51,725 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:51,763 INFO     [learner.py:606] ====Pushing takes 0.03666067123413086 s
2021-08-18:15:56:51,802 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:51,811 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:51,812 INFO     [param_server.py:381] ====After aggregation in epoch: 110, virtual_clock: 3619.3621207228384, top_1: : 59.5353 % (1845.0), top_5: : 100.0 % (3099.0), test loss: 2.8650082791293108, test len: 3099.0
2021-08-18:15:56:51,814 INFO     [param_server.py:410] Lock worker 3 with localStep 111 , while globalStep is 111

2021-08-18:15:56:51,815 INFO     [param_server.py:441] ====Epoch 112 completes 20 clients with loss 6.504518863680261, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:56:51,815 INFO     [param_server.py:450] ====Start to sample for epoch 112, global virtualClock: 3619.3621207228384, round_duration: 38.39602155878561
2021-08-18:15:56:51,816 INFO     [oort.py:208] Training selector: Pacer 110: lastExploitationUtil 473.96635389966104, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:56:51,817 INFO     [oort.py:321] scores are 26,{3: 0.17450293567825959, 5: 0.006083970129046022, 6: 0.0373740669076561, 7: 0.5760154251395285, 11: 0.18317279169310163, 14: 0.007202442756586188, 27: 0.04822308891450913, 36: 0.018593731166240197, 50: 0.00277852807236901, 51: 0.03659891616103522, 53: 0.4364095931689889, 58: 0.0029786709582582745, 60: 0.0013291936145627364, 67: 0.0016269129208404047, 70: 0.006350897917566704, 79: 0.017907521353831418, 81: 0.017059918872079863, 84: 0.28969913404820363, 85: 0.0396824135054672, 87: 0.06176760844450703, 93: 0.05092712635740002, 97: 0.12149776160206523, 98: 0.029444751932505512, 105: 0.021430079738021336, 107: 0.008637971300386387, 110: 0.006907748496143463, 113: 0.12500786189393223, 119: 0.004067830576498504},[7, 53, 84, 11, 3, 113, 97, 87, 93, 27, 85, 6, 51, 98, 105, 36, 79, 81, 107, 14, 110, 70, 5, 119, 58, 50, 67, 60]
2021-08-18:15:56:51,818 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:56:51,818 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:51,819 INFO     [oort.py:398] At round 110, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 606.3344971554749, 'duration': 43.340041615965305, 'time_stamp': 111, 'count': 13, 'status': True, 'gradient': 16.82631939877019}, [0.36406845259487625, -2.7027270515950618e-06]), ({'reward': 99.8241199658067, 'duration': 8.009219946401625, 'time_stamp': 111, 'count': 35, 'status': True, 'gradient': 21.242062290500943}, [0.05993354287168365, -2.7027270515950618e-06]), ({'reward': 850.9381935946251, 'duration': 5.8943907365129, 'time_stamp': 111, 'count': 108, 'status': True, 'gradient': 21.453747827200704}, [0.5109411061172799, -2.7027270515950618e-06])]
2021-08-18:15:56:51,830 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50]
2021-08-18:15:56:52,167 INFO     [param_server.py:553] For epoch: 112, median_reward: 348.1941249351585, dev: 696.388249870317
2021-08-18:15:56:52,895 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5986, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:56:52,896 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1664.3104, eval_time 0.6916, test_loss 2.5986, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:56:52,897 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7732, Top-1 Accuracy: 586.0/1033 (0.5673), Top-5 Accuracy: 1.0
2021-08-18:15:56:52,904 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1664.3214, eval_time 0.6998, test_loss 2.7732, test_accuracy 0.5673, test_5_accuracy 1.0 

2021-08-18:15:56:52,924 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6012, Top-1 Accuracy: 592.0/1033 (0.5731), Top-5 Accuracy: 1.0
2021-08-18:15:56:52,928 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1664.3474, eval_time 0.7258, test_loss 2.6012, test_accuracy 0.5731, test_5_accuracy 1.0 

2021-08-18:15:56:52,964 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:52,972 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:52,977 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:52,985 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:52,995 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:53,9 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:54,178 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:54,189 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:54,834 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:54,843 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:55,183 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:55,192 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:55,992 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:56,10 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:56,194 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:56,227 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:56,945 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:56,955 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:57,557 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:57,566 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:56:57,614 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:57,640 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:57,721 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:57,739 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:58,132 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:56:58,141 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:58,213 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:58,240 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:58,575 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:58,597 INFO     [learner.py:606] ====Pushing takes 0.02073192596435547 s
2021-08-18:15:56:58,622 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:58,629 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:58,629 INFO     [param_server.py:410] Lock worker 1 with localStep 112 , while globalStep is 111

2021-08-18:15:56:58,726 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:58,736 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:59,440 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:59,458 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:00,84 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:00,105 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:00,258 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:00,278 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:00,902 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:00,911 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:01,509 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:01,529 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:01,540 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:57:01,558 INFO     [learner.py:606] ====Pushing takes 0.02774643898010254 s
2021-08-18:15:57:01,589 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:01,597 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:01,598 INFO     [param_server.py:410] Lock worker 2 with localStep 112 , while globalStep is 111

2021-08-18:15:57:02,44 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:57:02,82 INFO     [learner.py:606] ====Pushing takes 0.03581547737121582 s
2021-08-18:15:57:02,119 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:02,129 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:02,129 INFO     [param_server.py:381] ====After aggregation in epoch: 111, virtual_clock: 3648.7130712733815, top_1: : 57.0184 % (1767.0), top_5: : 100.0 % (3099.0), test loss: 2.6576423821625887, test len: 3099.0
2021-08-18:15:57:02,132 INFO     [param_server.py:410] Lock worker 3 with localStep 112 , while globalStep is 112

2021-08-18:15:57:02,132 INFO     [param_server.py:441] ====Epoch 113 completes 20 clients with loss 4.662929473113724, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:02,133 INFO     [param_server.py:450] ====Start to sample for epoch 113, global virtualClock: 3648.7130712733815, round_duration: 29.350950550543047
2021-08-18:15:57:02,134 INFO     [oort.py:208] Training selector: Pacer 111: lastExploitationUtil 650.8069533139511, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:57:02,134 INFO     [oort.py:321] scores are 26,{3: 0.04474293819166217, 5: 0.032822825787080824, 6: 0.03724264328139262, 7: 0.37068835879266754, 11: 0.011152208029088426, 14: 0.007116412621228444, 27: 0.09389663314188613, 36: 0.018502008120649758, 50: 0.002768757547907547, 51: 0.03647021830508391, 53: 0.4079727188426264, 58: 0.002943091992289984, 60: 0.0010245395912901933, 67: 0.001254020994925484, 70: 0.006275039125493437, 79: 0.009694325584568297, 81: 0.09788490897837077, 84: 0.02984157002093999, 85: 0.033618624810993064, 87: 0.05152273824118709, 93: 0.09131026577863749, 97: 0.18713329758287758, 98: 0.24640697607261447, 105: 0.014637160267685365, 107: 0.00853479438315105, 110: 0.006883457819966253, 113: 0.545422388387353, 119: 0.011768454166964159},[113, 53, 7, 98, 97, 81, 27, 93, 87, 3, 6, 51, 85, 5, 84, 36, 105, 119, 11, 79, 107, 14, 110, 70, 58, 50, 67, 60]
2021-08-18:15:57:02,135 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:02,136 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:02,136 INFO     [oort.py:398] At round 111, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 667.458436739985, 'duration': 29.570969934622333, 'time_stamp': 112, 'count': 94, 'status': True, 'gradient': 15.148645101330892}, [0.28782060772050166, -2.6785953446012936e-06]), ({'reward': 1271.2753158091036, 'duration': 11.058674649423494, 'time_stamp': 112, 'count': 109, 'status': True, 'gradient': 20.199054805944716}, [0.5482016782502431, -2.6785953446012936e-06]), ({'reward': 1112.4816338285918, 'duration': 13.411352670399307, 'time_stamp': 112, 'count': 109, 'status': True, 'gradient': 18.305308411598162}, [0.4797258367481177, -2.6785953446012936e-06])]
2021-08-18:15:57:02,137 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 105, 119]
2021-08-18:15:57:02,475 INFO     [param_server.py:553] For epoch: 113, median_reward: 387.0434647338444, dev: 774.0869294676888
2021-08-18:15:57:03,64 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4522, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:57:03,65 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1674.4848, eval_time 0.5511, test_loss 3.4522, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:57:03,77 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4042, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:57:03,77 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1674.4914, eval_time 0.563, test_loss 2.4042, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:57:03,79 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6986, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:57:03,81 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1674.498, eval_time 0.5668, test_loss 2.6986, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:57:03,143 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:57:03,146 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:57:03,156 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:03,164 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:03,173 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:57:03,182 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:04,315 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:04,334 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:05,538 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:05,553 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:05,788 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:05,802 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:06,397 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:06,417 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:07,373 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:07,382 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:07,474 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:07,501 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:07,890 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:07,901 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:08,60 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:08,80 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:08,204 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:08,218 INFO     [learner.py:606] ====Pushing takes 0.013567209243774414 s
2021-08-18:15:57:08,235 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:08,241 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:08,242 INFO     [param_server.py:410] Lock worker 1 with localStep 113 , while globalStep is 112

2021-08-18:15:57:08,584 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:08,595 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:09,97 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:09,110 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:09,610 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:09,623 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:09,628 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:09,632 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:10,237 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:10,255 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:57:10,842 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:57:10,866 INFO     [learner.py:606] ====Pushing takes 0.022989273071289062 s
2021-08-18:15:57:10,893 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:10,900 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:57:10,901 INFO     [param_server.py:410] Lock worker 2 with localStep 113 , while globalStep is 112

2021-08-18:15:57:11,287 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:11,301 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:11,938 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:11,947 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:12,440 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:12,449 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:57:13,21 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:57:13,33 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:13,682 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:13,722 INFO     [learner.py:606] ====Pushing takes 0.037909507751464844 s
2021-08-18:15:57:13,768 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:13,778 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:13,779 INFO     [param_server.py:381] ====After aggregation in epoch: 112, virtual_clock: 3681.868414019972, top_1: : 60.213 % (1866.0), top_5: : 100.0 % (3099.0), test loss: 2.8516599116501986, test len: 3099.0
2021-08-18:15:57:13,781 INFO     [param_server.py:410] Lock worker 3 with localStep 113 , while globalStep is 113

2021-08-18:15:57:13,781 INFO     [param_server.py:441] ====Epoch 114 completes 20 clients with loss 7.644300021152612, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:57:13,782 INFO     [param_server.py:450] ====Start to sample for epoch 114, global virtualClock: 3681.868414019972, round_duration: 33.1553427465904
2021-08-18:15:57:13,783 INFO     [oort.py:208] Training selector: Pacer 112: lastExploitationUtil 424.3974122600138, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:57:13,783 INFO     [oort.py:321] scores are 26,{3: 0.10025486635959352, 5: 0.00934109821604781, 6: 0.03711277497675594, 7: 0.06461937330635585, 11: 0.07005685716431456, 14: 0.005988345338417177, 27: 0.040384140514014566, 31: 0.06365905452561126, 36: 0.04612741407241649, 50: 0.0027713927012338177, 51: 0.10887872006940638, 53: 0.04300312071853192, 58: 0.002476563986746503, 60: 0.0012077276543021266, 67: 0.0013526683563873359, 70: 0.005280343242526516, 79: 0.027606882822447845, 81: 0.04337504422965892, 84: 0.029737509896178318, 85: 0.07001950982713086, 87: 0.007693544918919787, 93: 0.07664706551081216, 97: 0.10948090382510298, 105: 0.005653827923037532, 107: 0.007181890494408844, 110: 0.046422011636144074, 113: 0.06461937330635585, 119: 0.002201156423745579},[97, 51, 3, 93, 11, 85, 7, 113, 31, 110, 36, 81, 53, 27, 6, 84, 79, 5, 87, 107, 14, 105, 70, 50, 58, 119, 67, 60]
2021-08-18:15:57:13,784 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:57:13,785 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:13,785 INFO     [oort.py:398] At round 112, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 522.8541545216431, 'duration': 15.972045438625893, 'time_stamp': 113, 'count': 110, 'status': True, 'gradient': 21.25641611898472}, [0.2785559576391438, -2.6548907512455885e-06]), ({'reward': 1059.0727574087173, 'duration': 27.035726288496562, 'time_stamp': 113, 'count': 106, 'status': True, 'gradient': 15.15551725711018}, [0.5642374217667782, -2.6548907512455885e-06]), ({'reward': 242.08666506262486, 'duration': 12.029357192292537, 'time_stamp': 113, 'count': 107, 'status': True, 'gradient': 27.462001992764595}, [0.1289713161585415, -2.6548907512455885e-06])]
2021-08-18:15:57:13,786 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:57:14,127 INFO     [param_server.py:553] For epoch: 114, median_reward: 339.77225920355227, dev: 679.5445184071045
2021-08-18:15:57:14,753 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.524, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:57:14,756 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1686.1758, eval_time 0.5837, test_loss 2.524, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:57:14,823 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4162, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:57:14,823 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1686.2377, eval_time 0.6459, test_loss 2.4162, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:57:14,825 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:57:14,847 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:14,861 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8908, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:57:14,863 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1686.2805, eval_time 0.6871, test_loss 2.8908, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:57:14,893 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:57:14,902 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:14,944 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:57:14,983 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:16,165 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:16,179 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:17,297 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:17,308 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:17,584 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:17,594 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:17,765 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:17,785 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:18,893 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:18,914 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:19,488 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:19,508 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:19,580 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:19,589 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:19,825 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:19,828 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:19,839 INFO     [learner.py:606] ====Pushing takes 0.012711048126220703 s
2021-08-18:15:57:19,839 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:19,860 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:19,867 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:19,868 INFO     [param_server.py:410] Lock worker 1 with localStep 114 , while globalStep is 113

2021-08-18:15:57:21,48 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:21,60 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:21,681 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:21,690 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:22,225 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:22,246 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:22,534 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:22,549 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:23,167 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:23,181 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:23,719 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:23,744 INFO     [learner.py:606] ====Pushing takes 0.023978710174560547 s
2021-08-18:15:57:23,779 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:23,786 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:57:23,787 INFO     [param_server.py:410] Lock worker 2 with localStep 114 , while globalStep is 113

2021-08-18:15:57:24,441 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:24,458 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:25,64 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:25,73 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:25,667 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:25,677 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:57:26,211 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:57:26,221 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:26,815 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:26,857 INFO     [learner.py:606] ====Pushing takes 0.04096055030822754 s
2021-08-18:15:57:26,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:26,918 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:26,919 INFO     [param_server.py:381] ====After aggregation in epoch: 113, virtual_clock: 3720.264435578758, top_1: : 59.6644 % (1849.0), top_5: : 100.0 % (3099.0), test loss: 2.610344480585169, test len: 3099.0
2021-08-18:15:57:26,921 INFO     [param_server.py:410] Lock worker 3 with localStep 114 , while globalStep is 114

2021-08-18:15:57:26,922 INFO     [param_server.py:441] ====Epoch 115 completes 20 clients with loss 4.81059273248126, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:26,922 INFO     [param_server.py:450] ====Start to sample for epoch 115, global virtualClock: 3720.264435578758, round_duration: 38.39602155878561
2021-08-18:15:57:26,922 INFO     [oort.py:208] Training selector: Pacer 113: lastExploitationUtil 370.0913892909842, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:57:26,923 INFO     [oort.py:321] scores are 26,{3: 0.08791382091277511, 5: 0.07768174362760617, 6: 0.4234160882633883, 7: 0.6332745465974678, 11: 0.05370019699752554, 14: 0.008058897451790318, 27: 0.06204275253030347, 36: 0.01802027609739334, 50: 0.0047486072267177324, 51: 0.248570993663002, 53: 0.04285440614773685, 58: 0.0033328697785592982, 60: 0.0014872502837374568, 67: 0.002044850836094269, 70: 0.007106093970362579, 79: 0.00287413539324785, 81: 0.1935087221405706, 84: 0.029634670824342804, 85: 0.00717010575982025, 87: 0.07771396972085065, 93: 0.059511258795013906, 97: 0.020543790115029215, 105: 0.0053334173812941525, 107: 0.009665127131717277, 110: 0.006835733055761076, 113: 1.0643958959866473, 119: 0.002203228892431436},[113, 7, 6, 51, 81, 3, 87, 5, 27, 93, 11, 53, 84, 97, 36, 107, 14, 85, 70, 110, 105, 50, 58, 79, 119, 67, 60]
2021-08-18:15:57:26,924 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:26,924 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:26,924 INFO     [oort.py:398] At round 113, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 644.1421252454603, 'duration': 5.8943907365129, 'time_stamp': 114, 'count': 111, 'status': True, 'gradient': 21.476075932585612}, [0.5688786506108204, -2.6316020315967705e-06]), ({'reward': 1132.2938866690668, 'duration': 8.009219946401625, 'time_stamp': 114, 'count': 38, 'status': True, 'gradient': 21.268285026155496}, [1.0, -2.6316020315967705e-06]), ({'reward': 295.0218180461583, 'duration': 17.343863580585587, 'time_stamp': 114, 'count': 5, 'status': True, 'gradient': 20.217764394693383}, [0.26054581268356725, -2.6316020315967705e-06])]
2021-08-18:15:57:26,925 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:57:27,196 INFO     [param_server.py:553] For epoch: 115, median_reward: 328.04538360500607, dev: 656.0907672100121
2021-08-18:15:57:27,759 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6004, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:57:27,761 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1699.1776, eval_time 0.5285, test_loss 2.6004, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:57:27,766 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3864, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:57:27,766 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1699.1807, eval_time 0.5344, test_loss 2.3864, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:57:27,831 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:27,833 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:27,841 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:27,846 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6044, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:57:27,847 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:27,847 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1699.2667, eval_time 0.616, test_loss 2.6044, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:57:27,905 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:27,923 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:28,941 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:28,955 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:29,580 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:29,589 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:29,877 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:29,887 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:31,157 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:31,168 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:31,400 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:31,430 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:31,735 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:31,745 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:32,396 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:32,405 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:32,785 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:32,803 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:32,854 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:32,888 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:33,76 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:33,88 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:33,456 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:33,477 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:33,573 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:33,607 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:33,751 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:33,761 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:34,58 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:34,78 INFO     [learner.py:606] ====Pushing takes 0.018000364303588867 s
2021-08-18:15:57:34,103 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:34,108 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:34,109 INFO     [param_server.py:410] Lock worker 1 with localStep 115 , while globalStep is 114

2021-08-18:15:57:34,933 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:34,947 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:34,992 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:35,18 INFO     [learner.py:606] ====Pushing takes 0.02407979965209961 s
2021-08-18:15:57:35,46 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:35,53 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:57:35,54 INFO     [param_server.py:410] Lock worker 2 with localStep 115 , while globalStep is 114

2021-08-18:15:57:35,458 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:35,472 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:36,86 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:36,96 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:57:36,608 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:57:36,620 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:37,190 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:37,230 INFO     [learner.py:606] ====Pushing takes 0.03861379623413086 s
2021-08-18:15:57:37,283 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:37,294 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:37,295 INFO     [param_server.py:381] ====After aggregation in epoch: 114, virtual_clock: 3748.9478386017736, top_1: : 58.8254 % (1823.0), top_5: : 100.0 % (3099.0), test loss: 2.530379789846915, test len: 3099.0
2021-08-18:15:57:37,297 INFO     [param_server.py:410] Lock worker 3 with localStep 115 , while globalStep is 115

2021-08-18:15:57:37,298 INFO     [param_server.py:441] ====Epoch 116 completes 20 clients with loss 5.830779046642875, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:37,298 INFO     [param_server.py:450] ====Start to sample for epoch 116, global virtualClock: 3748.9478386017736, round_duration: 28.683403023015895
2021-08-18:15:57:37,299 INFO     [oort.py:208] Training selector: Pacer 114: lastExploitationUtil 580.3282367141844, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:57:37,299 INFO     [oort.py:321] scores are 26,{3: 0.08370215495121826, 5: 0.007372634467528729, 6: 0.03685757377831944, 7: 0.06417502654111595, 11: 0.022165301019788114, 14: 0.0068927711104663615, 27: 0.09383751209886969, 36: 0.014652362212870161, 50: 0.002740130039246378, 51: 0.03609313527331302, 53: 0.3471894256254419, 58: 0.0028506019169528543, 60: 0.0012720444516267021, 67: 0.001556963208039208, 70: 0.006077838751539534, 79: 0.03986121246229789, 81: 0.20871681716167942, 84: 0.36010232209601345, 85: 0.00714551226102066, 87: 0.007640641252062132, 93: 0.06168779065545771, 97: 0.020473324811663078, 105: 0.020784153875859402, 107: 0.008266578582369932, 110: 0.04464053216602077, 113: 0.06417502654111595, 119: 0.002205280919081142},[84, 53, 81, 27, 3, 7, 113, 93, 110, 79, 6, 51, 11, 105, 97, 36, 107, 87, 5, 85, 14, 70, 58, 50, 119, 67, 60]
2021-08-18:15:57:37,300 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:37,301 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:37,301 INFO     [oort.py:398] At round 114, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1570.6081414257117, 'duration': 17.619275735353515, 'time_stamp': 115, 'count': 111, 'status': True, 'gradient': 15.168252767736945}, [0.731966278694844, -2.608718336681191e-06]), ({'reward': 981.7543600638978, 'duration': 11.058674649423494, 'time_stamp': 115, 'count': 112, 'status': True, 'gradient': 20.223054590405344}, [0.45753509421424693, -2.608718336681191e-06]), ({'reward': 1778.6611850004358, 'duration': 42.701901101086094, 'time_stamp': 115, 'count': 68, 'status': True, 'gradient': 8.426790791879244}, [0.8289279438657138, -2.608718336681191e-06])]
2021-08-18:15:57:37,302 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:57:37,635 INFO     [param_server.py:553] For epoch: 116, median_reward: 373.1443114060834, dev: 746.2886228121668
2021-08-18:15:57:38,171 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8303, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:57:38,172 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1709.5916, eval_time 0.5137, test_loss 2.8303, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:57:38,232 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5438, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:15:57:38,236 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1709.6506, eval_time 0.573, test_loss 2.5438, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:15:57:38,240 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:38,256 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:38,281 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5085, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:57:38,282 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1709.6996, eval_time 0.6192, test_loss 2.5085, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:57:38,311 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:38,320 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:38,359 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:38,372 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:39,552 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:39,566 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:40,624 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:40,635 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:40,948 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:40,957 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:41,210 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:41,238 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:42,433 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:42,460 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:42,979 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:42,998 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:43,83 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:43,110 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:43,222 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:43,232 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:43,485 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:43,500 INFO     [learner.py:606] ====Pushing takes 0.014356613159179688 s
2021-08-18:15:57:43,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:43,527 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:43,528 INFO     [param_server.py:410] Lock worker 1 with localStep 116 , while globalStep is 115

2021-08-18:15:57:44,525 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:44,537 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:45,135 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:45,144 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:45,707 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:45,716 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:45,994 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:46,15 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:46,636 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:46,654 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:47,115 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:47,142 INFO     [learner.py:606] ====Pushing takes 0.024818897247314453 s
2021-08-18:15:57:47,176 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:47,184 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:57:47,184 INFO     [param_server.py:410] Lock worker 2 with localStep 116 , while globalStep is 115

2021-08-18:15:57:48,178 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:48,197 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:48,830 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:48,839 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:49,483 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:49,493 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:57:50,118 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:57:50,129 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:50,725 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:50,766 INFO     [learner.py:606] ====Pushing takes 0.039855241775512695 s
2021-08-18:15:57:50,805 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:50,815 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:50,816 INFO     [param_server.py:381] ====After aggregation in epoch: 115, virtual_clock: 3787.3438601605594, top_1: : 60.697 % (1881.0), top_5: : 100.0 % (3099.0), test loss: 2.6275136051354586, test len: 3099.0
2021-08-18:15:57:50,817 INFO     [param_server.py:410] Lock worker 3 with localStep 116 , while globalStep is 116

2021-08-18:15:57:50,818 INFO     [param_server.py:441] ====Epoch 117 completes 20 clients with loss 5.664483679996456, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:50,818 INFO     [param_server.py:450] ====Start to sample for epoch 117, global virtualClock: 3787.3438601605594, round_duration: 38.39602155878561
2021-08-18:15:57:50,818 INFO     [oort.py:208] Training selector: Pacer 115: lastExploitationUtil 755.2077262581805, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:57:50,819 INFO     [oort.py:321] scores are 26,{3: 0.2047022401877952, 5: 0.04886903348408696, 6: 0.036732181784924205, 7: 0.32779074043952666, 11: 0.010999351725188542, 14: 0.008337824881398578, 27: 0.01853640531558653, 36: 0.0027710909761585007, 50: 0.01738195216297156, 51: 0.03597034395213098, 53: 0.68832669049075, 58: 0.003448224119039965, 60: 0.0015387256749195208, 67: 0.0015174479342953103, 70: 0.00735204380873255, 79: 0.01654049066433772, 81: 0.11069408411946996, 84: 0.2604910857131699, 85: 0.043611352586795146, 87: 0.1266740638245877, 93: 0.09959424569576544, 97: 0.07647864264208237, 105: 0.023467109816817915, 107: 0.009999647962117974, 110: 0.03543555161837346, 113: 0.06395669870020647, 119: 0.013788310935794836},[53, 7, 84, 3, 87, 81, 93, 97, 113, 5, 85, 6, 51, 110, 105, 27, 50, 79, 119, 11, 107, 14, 70, 58, 36, 60, 67]
2021-08-18:15:57:50,819 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:50,820 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:50,820 INFO     [oort.py:398] At round 115, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 2150.143694365925, 'duration': 11.058674649423494, 'time_stamp': 116, 'count': 113, 'status': True, 'gradient': 20.54911345525355}, [0.9703691553408479, -2.5862291916309646e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 116, 'count': 40, 'status': True, 'gradient': 21.287063895295475}, [4.513064249774042e-09, -2.5862291916309646e-06]), ({'reward': 1112.5320872716509, 'duration': 13.298442137908651, 'time_stamp': 116, 'count': 113, 'status': True, 'gradient': 21.28695845812165}, [0.5020883704280531, -2.5862291916309646e-06])]
2021-08-18:15:57:50,821 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:57:51,101 INFO     [param_server.py:553] For epoch: 117, median_reward: 415.87101711307247, dev: 831.7420342261449
2021-08-18:15:57:51,870 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4094, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:15:57:51,871 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1723.2852, eval_time 0.725, test_loss 2.4094, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:15:57:51,919 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4381, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:57:51,919 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1723.3363, eval_time 0.773, test_loss 2.4381, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:57:51,934 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:51,943 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:51,990 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:51,991 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4366, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:57:51,991 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1723.411, eval_time 0.8455, test_loss 2.4366, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:57:52,6 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:52,61 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:52,85 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:53,160 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:53,183 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:53,895 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:53,915 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:54,67 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:54,77 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:55,461 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:55,488 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:55,508 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:55,519 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:55,960 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:55,970 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:56,613 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:56,622 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:56,858 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:56,886 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:57,127 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:57,137 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:57,208 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:57,222 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:57,517 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:57,544 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:57,636 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:57,649 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:57,802 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:57,822 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:57,987 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:58,6 INFO     [learner.py:606] ====Pushing takes 0.01784205436706543 s
2021-08-18:15:57:58,27 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:58,35 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:58,36 INFO     [param_server.py:410] Lock worker 1 with localStep 117 , while globalStep is 116

2021-08-18:15:57:59,189 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:59,198 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:59,277 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:59,295 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:57:59,735 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:59,745 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:59,891 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:57:59,919 INFO     [learner.py:606] ====Pushing takes 0.027021169662475586 s
2021-08-18:15:57:59,955 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:59,964 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:59,964 INFO     [param_server.py:410] Lock worker 2 with localStep 117 , while globalStep is 116

2021-08-18:15:58:00,462 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:00,477 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:00,988 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:01,25 INFO     [learner.py:606] ====Pushing takes 0.03498697280883789 s
2021-08-18:15:58:01,62 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:01,71 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:01,72 INFO     [param_server.py:381] ====After aggregation in epoch: 116, virtual_clock: 3815.9151383822887, top_1: : 61.5682 % (1908.0), top_5: : 100.0 % (3099.0), test loss: 2.4280563681213945, test len: 3099.0
2021-08-18:15:58:01,75 INFO     [param_server.py:410] Lock worker 3 with localStep 117 , while globalStep is 117

2021-08-18:15:58:01,75 INFO     [param_server.py:441] ====Epoch 118 completes 20 clients with loss 6.055028517729182, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:58:01,76 INFO     [param_server.py:450] ====Start to sample for epoch 118, global virtualClock: 3815.9151383822887, round_duration: 28.571278221729383
2021-08-18:15:58:01,77 INFO     [oort.py:208] Training selector: Pacer 116: lastExploitationUtil 592.8399954173558, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:58:01,77 INFO     [oort.py:321] scores are 26,{3: 0.01724525673759344, 5: 0.014666484079667148, 6: 0.41416146658312214, 7: 1.06374086286862, 11: 0.010962232771802105, 14: 0.006698304613556667, 27: 0.012967843884874632, 36: 0.0027736180197698496, 50: 0.0027215924101917496, 51: 0.035848956660060334, 53: 0.061812698335896955, 58: 0.0027701775767289155, 60: 0.0012361561239197748, 67: 0.0015130364366388186, 70: 0.0059063640294209985, 79: 0.03564496935171166, 81: 0.18464993865653828, 84: 0.06346736187146959, 85: 0.007097171177275402, 87: 0.08712857549185661, 93: 0.026229075651478348, 97: 0.04677278828306327, 105: 0.0027004960155502223, 107: 0.008033352706654841, 110: 0.05143302636176488, 113: 0.529108306384853, 119: 0.008690559591380216},[7, 113, 6, 81, 87, 84, 53, 110, 97, 51, 79, 93, 3, 5, 27, 11, 119, 107, 85, 14, 70, 36, 58, 50, 105, 67, 60]
2021-08-18:15:58:01,78 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:58:01,78 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:01,79 INFO     [oort.py:398] At round 116, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 2267.510082591684, 'duration': 5.8943907365129, 'time_stamp': 117, 'count': 114, 'status': True, 'gradient': 21.503958903573718}, [1.0, -2.56412447969641e-06]), ({'reward': 1490.6227508535362, 'duration': 11.90395711384456, 'time_stamp': 117, 'count': 114, 'status': True, 'gradient': 21.189002646184335}, [0.6573815655944741, -2.56412447969641e-06]), ({'reward': 1514.8511728047126, 'duration': 26.145070720211294, 'time_stamp': 117, 'count': 111, 'status': True, 'gradient': 11.809124326929954}, [0.6680666465037693, -2.56412447969641e-06])]
2021-08-18:15:58:01,92 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:58:01,377 INFO     [param_server.py:553] For epoch: 118, median_reward: 375.8552028849026, dev: 751.7104057698052
2021-08-18:15:58:01,957 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5961, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:58:01,958 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1733.3772, eval_time 0.5468, test_loss 2.5961, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:58:01,996 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4861, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:58:01,997 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1733.4114, eval_time 0.583, test_loss 2.4861, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:58:01,998 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.676, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:58:01,998 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1733.4154, eval_time 0.585, test_loss 2.676, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:58:02,24 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:58:02,40 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:02,66 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:58:02,70 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:58:02,75 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:02,82 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:03,236 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:03,253 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:04,503 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:04,517 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:04,527 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:04,538 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:05,120 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:05,141 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:06,265 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:06,285 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:06,711 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:06,723 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:06,758 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:06,770 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:06,873 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:06,893 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:07,216 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:07,229 INFO     [learner.py:606] ====Pushing takes 0.012640237808227539 s
2021-08-18:15:58:07,253 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:07,259 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:07,259 INFO     [param_server.py:410] Lock worker 1 with localStep 118 , while globalStep is 117

2021-08-18:15:58:07,934 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:07,948 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:08,550 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:08,564 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:09,185 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:09,206 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:09,614 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:09,628 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:10,328 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:10,338 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:10,923 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:10,950 INFO     [learner.py:606] ====Pushing takes 0.025269269943237305 s
2021-08-18:15:58:10,976 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:10,984 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:10,984 INFO     [param_server.py:410] Lock worker 2 with localStep 118 , while globalStep is 117

2021-08-18:15:58:11,542 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:11,551 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:12,80 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:12,89 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:12,655 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:12,669 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:58:13,262 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:58:13,274 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:13,762 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:13,802 INFO     [learner.py:606] ====Pushing takes 0.03902316093444824 s
2021-08-18:15:58:13,846 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:13,856 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:13,856 INFO     [param_server.py:381] ====After aggregation in epoch: 117, virtual_clock: 3854.3111599410745, top_1: : 60.3098 % (1869.0), top_5: : 100.0 % (3099.0), test loss: 2.5860733809294523, test len: 3099.0
2021-08-18:15:58:13,858 INFO     [param_server.py:410] Lock worker 3 with localStep 118 , while globalStep is 118

2021-08-18:15:58:13,859 INFO     [param_server.py:441] ====Epoch 119 completes 20 clients with loss 5.983065678294416, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:13,859 INFO     [param_server.py:450] ====Start to sample for epoch 119, global virtualClock: 3854.3111599410745, round_duration: 38.39602155878561
2021-08-18:15:58:13,860 INFO     [oort.py:208] Training selector: Pacer 117: lastExploitationUtil 358.22464602830877, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:58:13,860 INFO     [oort.py:321] scores are 26,{3: 0.28774011416141315, 5: 0.031204492396324175, 6: 0.3272146054522203, 7: 0.06352748694881871, 11: 0.01092553536014713, 14: 0.006972660229991533, 27: 0.0056017677568069545, 36: 0.022409134332859477, 50: 0.014147833634108821, 51: 0.035728947903875215, 53: 0.4356950497978015, 58: 0.002883641179915805, 60: 0.0019724428886706297, 67: 0.0015750088413309428, 70: 0.006148282580109319, 79: 0.0028353759326578826, 81: 0.05278751711300511, 84: 0.02923502929784715, 85: 0.11437942555316619, 87: 0.00756354556565708, 93: 0.011045391858286674, 97: 0.20642089075706274, 105: 0.016778925821250266, 107: 0.00836239050965537, 110: 0.04829026186542425, 113: 0.06352748694881871, 119: 0.011530729976742732},[53, 6, 3, 97, 85, 7, 113, 81, 110, 51, 5, 84, 36, 105, 50, 119, 93, 11, 107, 87, 14, 70, 27, 58, 79, 60, 67]
2021-08-18:15:58:13,861 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:58:13,861 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:13,862 INFO     [oort.py:398] At round 117, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1302.7071300117875, 'duration': 17.343863580585587, 'time_stamp': 118, 'count': 9, 'status': True, 'gradient': 20.253022643266355}, [1.0, -2.5423944270714182e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 118, 'count': 115, 'status': True, 'gradient': 21.513200305103677}, [7.6763813267519e-09, -2.5423944270714182e-06]), ({'reward': 770.1347381030262, 'duration': 11.058674649423494, 'time_stamp': 118, 'count': 115, 'status': True, 'gradient': 20.567879743822903}, [0.5911771235607822, -2.5423944270714182e-06])]
2021-08-18:15:58:13,863 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:58:14,201 INFO     [param_server.py:553] For epoch: 119, median_reward: 329.9619506342445, dev: 659.923901268489
2021-08-18:15:58:14,741 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3925, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:58:14,743 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1746.1604, eval_time 0.4976, test_loss 3.3925, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:58:14,746 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4896, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:58:14,747 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1746.1609, eval_time 0.4993, test_loss 2.4896, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:58:14,814 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:58:14,817 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:58:14,826 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:14,828 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:14,860 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4045, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:58:14,863 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1746.2823, eval_time 0.6171, test_loss 2.4045, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:58:14,920 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:58:14,948 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:16,19 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:16,37 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:16,628 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:16,642 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:16,877 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:16,887 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:18,332 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:18,351 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:18,432 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:18,465 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:18,592 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:18,601 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:19,202 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:19,214 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:19,805 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:19,819 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:19,831 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:19,864 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:20,131 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:20,158 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:20,437 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:20,447 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:20,562 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:20,589 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:20,731 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:20,751 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:21,50 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:21,70 INFO     [learner.py:606] ====Pushing takes 0.01908087730407715 s
2021-08-18:15:58:21,86 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:21,93 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:21,93 INFO     [param_server.py:410] Lock worker 1 with localStep 119 , while globalStep is 118

2021-08-18:15:58:22,77 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:22,86 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:22,288 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:22,313 INFO     [learner.py:606] ====Pushing takes 0.023723840713500977 s
2021-08-18:15:58:22,338 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:22,344 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:22,345 INFO     [param_server.py:410] Lock worker 2 with localStep 119 , while globalStep is 118

2021-08-18:15:58:22,647 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:22,661 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:23,217 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:23,227 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:58:23,838 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:58:23,848 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:24,430 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:24,468 INFO     [learner.py:606] ====Pushing takes 0.03718829154968262 s
2021-08-18:15:58:24,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:24,517 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:24,519 INFO     [param_server.py:381] ====After aggregation in epoch: 118, virtual_clock: 3882.99456296409, top_1: : 60.4066 % (1872.0), top_5: : 100.0 % (3099.0), test loss: 2.762202081856904, test len: 3099.0
2021-08-18:15:58:24,521 INFO     [param_server.py:410] Lock worker 3 with localStep 119 , while globalStep is 119

2021-08-18:15:58:24,521 INFO     [param_server.py:441] ====Epoch 120 completes 20 clients with loss 6.424685353307118, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:24,522 INFO     [param_server.py:450] ====Start to sample for epoch 120, global virtualClock: 3882.99456296409, round_duration: 28.683403023015895
2021-08-18:15:58:24,522 INFO     [oort.py:208] Training selector: Pacer 118: lastExploitationUtil 474.0064997773147, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:58:24,523 INFO     [oort.py:321] scores are 26,{3: 0.22229981826311102, 5: 0.005892901425482874, 6: 0.036364499008298315, 7: 0.08430053623575609, 11: 0.12439695566136794, 14: 0.00827921277321203, 27: 0.024136945086276455, 36: 0.046070963745382235, 50: 0.025487335928772874, 51: 0.3846987219934818, 53: 0.5702869167090927, 58: 0.003423984261764055, 60: 0.0015279089502928129, 67: 0.0014865305996248446, 70: 0.007300361410356561, 79: 0.03610701448005612, 81: 0.01659908739496353, 84: 0.029137935651702723, 85: 0.04275874320567977, 87: 0.007538425966519095, 93: 0.031788622518897705, 97: 0.335672241965096, 105: 0.0026825170723003477, 107: 0.009929353795891167, 110: 0.006721152770402017, 113: 0.06331650322530634, 119: 0.01369138374149965},[53, 51, 97, 3, 11, 7, 113, 36, 85, 6, 79, 93, 84, 50, 27, 81, 119, 107, 14, 87, 70, 110, 5, 58, 105, 60, 67]
2021-08-18:15:58:24,524 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:58:24,525 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:24,525 INFO     [oort.py:398] At round 118, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1399.7976095186543, 'duration': 43.340041615965305, 'time_stamp': 119, 'count': 20, 'status': True, 'gradient': 10.129721866935956}, [1.0, -2.521029588483939e-06]), ({'reward': 1384.2192819745228, 'duration': 15.972045438625893, 'time_stamp': 119, 'count': 116, 'status': True, 'gradient': 21.31149764667545}, [0.9888709348997611, -2.521029588483939e-06]), ({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 119, 'count': 116, 'status': True, 'gradient': 18.570458901646635}, [7.143940881144739e-09, -2.521029588483939e-06])]
2021-08-18:15:58:24,526 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:58:24,817 INFO     [param_server.py:553] For epoch: 120, median_reward: 353.0929800001091, dev: 706.1859600002182
2021-08-18:15:58:25,350 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5119, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:58:25,351 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1756.7704, eval_time 0.511, test_loss 2.5119, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:58:25,428 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:25,436 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2745, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:58:25,437 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1756.8515, eval_time 0.5973, test_loss 2.2745, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:58:25,440 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:25,444 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1859, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:58:25,445 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1756.862, eval_time 0.605, test_loss 3.1859, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:58:25,506 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:25,514 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:25,539 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:25,549 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:26,752 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:26,763 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:27,746 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:27,760 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:28,172 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:28,183 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:28,590 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:28,623 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:29,906 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:29,940 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:30,90 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:30,101 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:30,496 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:30,507 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:30,614 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:30,680 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:31,112 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:31,128 INFO     [learner.py:606] ====Pushing takes 0.014683961868286133 s
2021-08-18:15:58:31,151 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:31,156 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:31,156 INFO     [param_server.py:410] Lock worker 1 with localStep 120 , while globalStep is 119

2021-08-18:15:58:31,544 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:31,558 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:32,228 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:32,247 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:32,980 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:33,7 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:33,69 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:33,90 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:33,655 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:33,667 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:34,154 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:34,180 INFO     [learner.py:606] ====Pushing takes 0.024541616439819336 s
2021-08-18:15:58:34,209 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:34,218 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:34,219 INFO     [param_server.py:410] Lock worker 2 with localStep 120 , while globalStep is 119

2021-08-18:15:58:35,237 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:35,246 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:35,909 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:35,919 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:36,517 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:36,527 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:58:37,71 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:58:37,80 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:37,622 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:37,664 INFO     [learner.py:606] ====Pushing takes 0.04108142852783203 s
2021-08-18:15:58:37,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:37,722 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:37,723 INFO     [param_server.py:381] ====After aggregation in epoch: 119, virtual_clock: 3921.390584522876, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.65744400245172, test len: 3099.0
2021-08-18:15:58:37,740 INFO     [param_server.py:410] Lock worker 3 with localStep 120 , while globalStep is 120

2021-08-18:15:58:37,741 INFO     [param_server.py:441] ====Epoch 121 completes 20 clients with loss 5.703014004256547, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:37,741 INFO     [param_server.py:450] ====Start to sample for epoch 121, global virtualClock: 3921.390584522876, round_duration: 38.39602155878561
2021-08-18:15:58:37,742 INFO     [oort.py:208] Training selector: Pacer 119: lastExploitationUtil 331.7279165354907, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:58:37,742 INFO     [oort.py:321] scores are 26,{3: 0.17036767474873088, 5: 0.005873484283831824, 6: 0.036244677789966, 7: 0.10906504374418557, 11: 0.1823598673016472, 14: 0.006590376585728311, 27: 0.005564766944300194, 36: 0.03391975959236414, 50: 0.018099420515499214, 51: 0.035492950954367865, 53: 0.04199724368178847, 58: 0.0027255424309958324, 60: 0.001636011625275897, 67: 0.001488657276827488, 70: 0.005811196332800932, 79: 0.02073352742627698, 81: 0.060328914365260486, 84: 0.02904192599820306, 85: 0.007026691206063266, 87: 0.041220798140709884, 93: 0.010972434804200392, 97: 0.33915611491701897, 105: 0.027878431056721213, 107: 0.007903913398576186, 110: 0.006699006536148565, 113: 0.06310787500921936, 119: 0.010898545224994153},[97, 11, 3, 7, 113, 81, 53, 87, 6, 51, 36, 84, 105, 79, 50, 93, 119, 107, 85, 110, 14, 5, 70, 27, 58, 60, 67]
2021-08-18:15:58:37,743 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:58:37,744 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:37,745 INFO     [oort.py:398] At round 119, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1291.5460108032246, 'duration': 15.972045438625893, 'time_stamp': 120, 'count': 117, 'status': True, 'gradient': 21.3166660822876}, [1.0, -2.5000208335069482e-06]), ({'reward': 929.6049131297636, 'duration': 43.340041615965305, 'time_stamp': 120, 'count': 21, 'status': True, 'gradient': 15.19904722015956}, [0.7197591922768328, -2.5000208335069482e-06]), ({'reward': 1287.9808952392514, 'duration': 21.753601635627824, 'time_stamp': 120, 'count': 114, 'status': True, 'gradient': 21.52583788549382}, [0.9972396313331191, -2.5000208335069482e-06])]
2021-08-18:15:58:37,745 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:58:38,87 INFO     [param_server.py:541] Handle Wight 0.06599116325378418 | Send 0.34586572647094727
2021-08-18:15:58:38,88 INFO     [param_server.py:553] For epoch: 121, median_reward: 323.2306875577597, dev: 646.4613751155194
2021-08-18:15:58:38,852 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0793, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:15:58:38,854 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1770.2677, eval_time 0.7221, test_loss 3.0793, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:15:58:38,857 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7721, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:58:38,863 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1770.2805, eval_time 0.7322, test_loss 2.7721, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:58:38,922 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:38,931 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:38,946 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:38,955 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:39,25 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5171, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:58:39,28 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1770.4478, eval_time 0.897, test_loss 2.5171, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:58:39,98 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:39,131 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:39,959 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:39,973 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:40,724 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:40,745 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:40,925 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:40,935 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:42,671 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:42,699 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:42,838 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:42,847 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:43,41 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:43,74 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:43,440 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:43,449 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:44,80 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:44,89 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:44,240 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:44,267 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:44,662 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:44,683 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:44,709 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:44,722 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:44,843 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:44,870 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:45,236 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:45,256 INFO     [learner.py:606] ====Pushing takes 0.018691062927246094 s
2021-08-18:15:58:45,273 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:45,278 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:45,279 INFO     [param_server.py:410] Lock worker 1 with localStep 121 , while globalStep is 120

2021-08-18:15:58:45,334 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:45,354 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:45,918 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:45,928 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:46,541 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:46,551 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:46,631 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:46,655 INFO     [learner.py:606] ====Pushing takes 0.022823572158813477 s
2021-08-18:15:58:46,681 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:46,689 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:46,690 INFO     [param_server.py:410] Lock worker 2 with localStep 121 , while globalStep is 120

2021-08-18:15:58:47,189 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:47,199 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:58:47,733 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:58:47,744 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:48,352 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:48,392 INFO     [learner.py:606] ====Pushing takes 0.0384213924407959 s
2021-08-18:15:58:48,442 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:48,452 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:48,453 INFO     [param_server.py:381] ====After aggregation in epoch: 120, virtual_clock: 3949.4064400183647, top_1: : 61.2133 % (1897.0), top_5: : 100.0 % (3099.0), test loss: 2.7895035920319735, test len: 3099.0
2021-08-18:15:58:48,456 INFO     [param_server.py:410] Lock worker 3 with localStep 121 , while globalStep is 121

2021-08-18:15:58:48,456 INFO     [param_server.py:441] ====Epoch 122 completes 20 clients with loss 7.547605085517781, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:48,456 INFO     [param_server.py:450] ====Start to sample for epoch 122, global virtualClock: 3949.4064400183647, round_duration: 28.015855495488744
2021-08-18:15:58:48,487 INFO     [oort.py:208] Training selector: Pacer 120: lastExploitationUtil 557.7356078176282, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:58:48,488 INFO     [oort.py:321] scores are 26,{3: 0.2172582241493511, 5: 0.009247228007914273, 6: 0.0361261820022919, 7: 0.24431544996613214, 11: 0.03042913930937101, 14: 0.008810289497657534, 27: 0.030096406209925777, 36: 0.002725374102082276, 50: 0.034765827620858274, 51: 0.036370104078451225, 53: 0.041859940861797826, 58: 0.003643618470486672, 60: 0.001625917891818985, 67: 0.001990098957326165, 70: 0.005088268296036275, 79: 0.04678405429243754, 81: 0.27865082228897153, 84: 0.02894697837812289, 85: 0.04303694600863048, 87: 0.06292613252922968, 93: 0.12061809083140759, 97: 0.2125080481348829, 105: 0.030233074538305003, 107: 0.01056628013589832, 110: 0.00862209993822426, 113: 0.5781321962145654, 119: 0.014569628500963792},[113, 81, 7, 3, 97, 93, 87, 79, 85, 53, 51, 6, 50, 11, 105, 27, 84, 119, 107, 5, 14, 110, 70, 58, 36, 67, 60]
2021-08-18:15:58:48,489 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:58:48,489 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:48,490 INFO     [oort.py:398] At round 120, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 787.6835555945377, 'duration': 8.009219946401625, 'time_stamp': 121, 'count': 45, 'status': True, 'gradient': 21.33034268482665}, [0.5152306481723997, -2.4793593335482134e-06]), ({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 121, 'count': 118, 'status': True, 'gradient': 18.58572717284165}, [6.541169726617416e-09, -2.4793593335482134e-06]), ({'reward': 1131.4820270205691, 'duration': 17.343863580585587, 'time_stamp': 121, 'count': 12, 'status': True, 'gradient': 15.206387840532898}, [0.7401150635073388, -2.4793593335482134e-06])]
2021-08-18:15:58:48,491 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:58:48,843 INFO     [param_server.py:553] For epoch: 122, median_reward: 371.01354958807275, dev: 742.0270991761455
2021-08-18:15:58:49,377 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.399, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:58:49,378 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1780.7979, eval_time 0.5075, test_loss 2.399, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:58:49,452 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:49,468 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:49,573 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4141, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:58:49,574 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1780.988, eval_time 0.7001, test_loss 2.4141, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:58:49,585 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9352, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:15:58:49,586 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1781.0033, eval_time 0.7126, test_loss 2.9352, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:15:58:49,655 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:49,664 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:49,664 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:49,674 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:50,898 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:50,908 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:52,73 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:52,83 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:52,340 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:52,354 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:52,724 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:52,758 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:54,62 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:54,96 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:54,370 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:54,382 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:54,601 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:54,677 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:54,779 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:54,802 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:55,125 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:55,140 INFO     [learner.py:606] ====Pushing takes 0.014132261276245117 s
2021-08-18:15:58:55,162 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:55,169 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:55,170 INFO     [param_server.py:410] Lock worker 1 with localStep 122 , while globalStep is 121

2021-08-18:15:58:55,543 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:55,552 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:56,66 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:56,75 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:56,656 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:56,665 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:57,489 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:57,498 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:58,147 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:58,159 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:58,752 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:58,780 INFO     [learner.py:606] ====Pushing takes 0.02638411521911621 s
2021-08-18:15:58:58,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:58,820 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:58,821 INFO     [param_server.py:410] Lock worker 2 with localStep 122 , while globalStep is 121

2021-08-18:15:58:58,946 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:58,955 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:59,602 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:59,611 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:00,212 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:00,222 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:59:00,856 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:59:00,867 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:01,490 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:01,531 INFO     [learner.py:606] ====Pushing takes 0.03948259353637695 s
2021-08-18:15:59:01,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:01,591 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:01,592 INFO     [param_server.py:381] ====After aggregation in epoch: 121, virtual_clock: 3987.8024615771506, top_1: : 61.2133 % (1897.0), top_5: : 100.0 % (3099.0), test loss: 2.582755488102083, test len: 3099.0
2021-08-18:15:59:01,594 INFO     [param_server.py:410] Lock worker 3 with localStep 122 , while globalStep is 122

2021-08-18:15:59:01,595 INFO     [param_server.py:441] ====Epoch 123 completes 20 clients with loss 6.283539181289103, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:01,596 INFO     [param_server.py:450] ====Start to sample for epoch 123, global virtualClock: 3987.8024615771506, round_duration: 38.39602155878561
2021-08-18:15:59:01,596 INFO     [oort.py:208] Training selector: Pacer 121: lastExploitationUtil 479.31718712244276, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:59:01,597 INFO     [oort.py:321] scores are 26,{3: 0.03708019039390816, 5: 0.060078059437186325, 6: 0.03600898743184896, 7: 0.20969435214522886, 11: 0.10881182670483126, 14: 0.006193765547099626, 27: 0.005528580613122405, 36: 0.0027165328952486944, 50: 0.018098466238190627, 51: 0.03526214889373039, 53: 0.09599941749210625, 58: 0.002895422400001104, 60: 0.0011430446438154876, 67: 0.0013990693904533968, 70: 0.005461476619026386, 79: 0.004237959860568566, 81: 0.10229678000147574, 84: 0.2280425256413619, 85: 0.0069809983356139286, 87: 0.036535869129795125, 93: 0.18476900033198806, 97: 0.02000195944164374, 105: 0.01908128503869451, 107: 0.007428253280908716, 110: 0.011654981383803631, 113: 0.5341719150018693, 119: 0.010242667175386622},[113, 84, 7, 93, 11, 81, 53, 5, 3, 87, 6, 51, 97, 105, 50, 110, 119, 107, 85, 14, 27, 70, 79, 58, 36, 67, 60]
2021-08-18:15:59:01,598 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:59:01,598 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:01,599 INFO     [oort.py:398] At round 121, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 659.5912767373947, 'duration': 17.619275735353515, 'time_stamp': 122, 'count': 118, 'status': True, 'gradient': 20.28300223624075}, [0.3275091621328279, -2.4590365494799157e-06]), ({'reward': 296.05171191006696, 'duration': 5.8943907365129, 'time_stamp': 122, 'count': 119, 'status': True, 'gradient': 21.54458729161867}, [0.14699685732249682, -2.4590365494799157e-06]), ({'reward': 1147.9482877990463, 'duration': 21.753601635627824, 'time_stamp': 122, 'count': 116, 'status': True, 'gradient': 21.544420883594462}, [0.5699984484884801, -2.4590365494799157e-06])]
2021-08-18:15:59:01,600 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:59:01,913 INFO     [param_server.py:553] For epoch: 123, median_reward: 355.90623109328595, dev: 711.8124621865719
2021-08-18:15:59:02,568 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6638, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:59:02,569 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1793.983, eval_time 0.5983, test_loss 2.6638, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:59:02,574 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7396, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:59:02,575 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1793.9925, eval_time 0.6059, test_loss 2.7396, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:59:02,645 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:59:02,655 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:02,658 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:59:02,669 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:02,694 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5635, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:59:02,697 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1794.1169, eval_time 0.7285, test_loss 2.5635, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:59:02,764 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:59:02,794 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:03,688 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:03,697 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:04,211 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:04,231 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:04,851 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:04,869 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:05,958 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:05,985 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:06,572 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:06,581 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:06,765 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:06,798 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:07,181 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:07,191 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:07,794 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:07,805 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:07,882 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:07,902 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:08,69 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:08,96 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:08,293 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:08,302 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:08,487 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:08,507 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:08,891 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:08,912 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:09,362 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:09,383 INFO     [learner.py:606] ====Pushing takes 0.018866539001464844 s
2021-08-18:15:59:09,404 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:09,409 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:09,409 INFO     [param_server.py:410] Lock worker 1 with localStep 123 , while globalStep is 122

2021-08-18:15:59:09,594 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:09,604 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:09,741 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:09,768 INFO     [learner.py:606] ====Pushing takes 0.025003671646118164 s
2021-08-18:15:59:09,796 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:09,802 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:09,803 INFO     [param_server.py:410] Lock worker 2 with localStep 123 , while globalStep is 122

2021-08-18:15:59:10,167 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:10,177 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:10,700 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:10,710 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:59:11,227 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:59:11,239 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:11,817 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:11,859 INFO     [learner.py:606] ====Pushing takes 0.04076385498046875 s
2021-08-18:15:59:11,897 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:11,910 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:11,910 INFO     [param_server.py:381] ====After aggregation in epoch: 122, virtual_clock: 4015.8183170726393, top_1: : 58.3414 % (1808.0), top_5: : 100.0 % (3099.0), test loss: 2.655617603549251, test len: 3099.0
2021-08-18:15:59:11,913 INFO     [param_server.py:410] Lock worker 3 with localStep 123 , while globalStep is 123

2021-08-18:15:59:11,913 INFO     [param_server.py:441] ====Epoch 124 completes 20 clients with loss 5.994675497642215, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:11,914 INFO     [param_server.py:450] ====Start to sample for epoch 124, global virtualClock: 4015.8183170726393, round_duration: 28.015855495488744
2021-08-18:15:59:11,914 INFO     [oort.py:208] Training selector: Pacer 122: lastExploitationUtil 504.40734961579193, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:59:11,915 INFO     [oort.py:321] scores are 26,{3: 0.11443602455755426, 5: 0.00581650610323882, 6: 0.4613867040810693, 7: 0.2674958776755215, 11: 0.010748082346618682, 14: 0.007107711651583769, 27: 0.02506967973252764, 36: 0.0027077881265964317, 50: 0.033698073631819585, 51: 0.03514863680087238, 53: 0.2610948720776237, 58: 0.0029394935845739934, 60: 0.0013117112153094353, 67: 0.0015413053540870554, 70: 0.0062673668715284, 79: 0.00474291260488569, 81: 0.016383897535345006, 84: 0.39700892531340526, 85: 0.06783261435751271, 87: 0.007440698134447311, 93: 0.01086599213037905, 97: 0.33896080822504265, 105: 0.013819232529552902, 107: 0.008524359211554925, 110: 0.050398570409939523, 113: 0.06249567078335393, 119: 0.011754065321358715},[6, 84, 97, 7, 53, 3, 85, 113, 110, 51, 50, 27, 81, 105, 119, 93, 11, 107, 87, 14, 70, 5, 79, 58, 36, 67, 60]
2021-08-18:15:59:11,915 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:59:11,916 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:11,916 INFO     [oort.py:398] At round 122, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1428.4106535758704, 'duration': 13.298442137908651, 'time_stamp': 123, 'count': 120, 'status': True, 'gradient': 16.91011730779128}, [0.800201582851557, -2.4390442198717086e-06]), ({'reward': 1785.0610248726075, 'duration': 15.972045438625893, 'time_stamp': 123, 'count': 120, 'status': True, 'gradient': 21.349007785344625}, [1.0, -2.4390442198717086e-06]), ({'reward': 588.7965795673196, 'duration': 11.058674649423494, 'time_stamp': 123, 'count': 120, 'status': True, 'gradient': 18.601020151645255}, [0.3298430006004501, -2.4390442198717086e-06])]
2021-08-18:15:59:11,917 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:59:12,204 INFO     [param_server.py:553] For epoch: 124, median_reward: 360.6889645227762, dev: 721.3779290455524
2021-08-18:15:59:12,733 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9133, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:59:12,734 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1804.1542, eval_time 0.5073, test_loss 2.9133, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:59:12,799 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:59:12,814 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:12,837 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.384, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:15:59:12,838 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1804.2517, eval_time 0.607, test_loss 2.384, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:15:59:12,835 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5615, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:59:12,839 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1804.2559, eval_time 0.6093, test_loss 2.5615, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:59:12,915 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:59:12,922 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:59:12,924 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:12,930 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:14,108 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:14,117 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:15,221 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:15,230 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:15,527 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:15,537 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:15,909 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:15,949 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:17,311 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:17,344 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:17,692 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:17,720 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:17,802 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:17,814 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:18,17 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:18,50 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:18,470 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:18,484 INFO     [learner.py:606] ====Pushing takes 0.01330113410949707 s
2021-08-18:15:59:18,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:18,509 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:18,510 INFO     [param_server.py:410] Lock worker 1 with localStep 124 , while globalStep is 123

2021-08-18:15:59:18,897 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:18,909 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:19,530 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:19,539 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:20,163 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:20,178 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:20,708 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:20,720 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:21,313 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:21,325 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:21,902 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:21,929 INFO     [learner.py:606] ====Pushing takes 0.025243520736694336 s
2021-08-18:15:59:21,963 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:21,970 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:21,971 INFO     [param_server.py:410] Lock worker 2 with localStep 124 , while globalStep is 123

2021-08-18:15:59:22,550 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:22,563 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:23,215 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:23,229 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:23,919 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:23,930 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:59:24,619 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:59:24,629 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:25,169 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:25,211 INFO     [learner.py:606] ====Pushing takes 0.040448904037475586 s
2021-08-18:15:59:25,252 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:25,262 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:25,263 INFO     [param_server.py:381] ====After aggregation in epoch: 123, virtual_clock: 4054.214338631425, top_1: : 60.9551 % (1889.0), top_5: : 100.0 % (3099.0), test loss: 2.6196045036669133, test len: 3099.0
2021-08-18:15:59:25,266 INFO     [param_server.py:410] Lock worker 3 with localStep 124 , while globalStep is 124

2021-08-18:15:59:25,266 INFO     [param_server.py:441] ====Epoch 125 completes 20 clients with loss 5.650055244489891, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:25,267 INFO     [param_server.py:450] ====Start to sample for epoch 125, global virtualClock: 4054.214338631425, round_duration: 38.39602155878561
2021-08-18:15:59:25,268 INFO     [oort.py:208] Training selector: Pacer 123: lastExploitationUtil 399.8935100819275, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:59:25,268 INFO     [oort.py:321] scores are 26,{3: 0.034313710425888336, 5: 0.005797924819252031, 6: 0.03577840797202919, 7: 0.18862951855286902, 11: 0.14466355730184466, 14: 0.005946721200520404, 27: 0.036311264938022475, 36: 0.0100352835130607, 50: 0.045357663032798735, 51: 0.035036351729636594, 53: 0.20315009133640463, 58: 0.0024593497422317127, 60: 0.0010974531994840972, 67: 0.0015548585292044287, 70: 0.005243640326637682, 79: 0.02232360373969549, 81: 0.10661317407960098, 84: 0.24007028933924926, 85: 0.006936296305925506, 87: 0.007416928241896326, 93: 0.03789437797405708, 97: 0.019873879166903443, 105: 0.0056209814325775195, 107: 0.00713197019365715, 110: 0.04152880326738424, 113: 0.06229602347169311, 119: 0.009834128460072035},[84, 53, 7, 11, 81, 113, 50, 110, 93, 27, 6, 51, 3, 79, 97, 36, 119, 87, 107, 85, 14, 5, 105, 70, 58, 67, 60]
2021-08-18:15:59:25,269 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:59:25,270 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:25,270 INFO     [oort.py:398] At round 123, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 608.2597893757909, 'duration': 17.619275735353515, 'time_stamp': 124, 'count': 120, 'status': True, 'gradient': 20.299626885555604}, [0.34437533826227423, -2.4193743497931457e-06]), ({'reward': 223.14538311226292, 'duration': 5.8943907365129, 'time_stamp': 124, 'count': 121, 'status': True, 'gradient': 21.567965763417263}, [0.12633350074291783, -2.4193743497931457e-06]), ({'reward': 274.93104822751167, 'duration': 21.635252629006885, 'time_stamp': 124, 'count': 74, 'status': True, 'gradient': 21.991172014807322}, [0.1556532078098207, -2.4193743497931457e-06])]
2021-08-18:15:59:25,271 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:59:25,612 INFO     [param_server.py:553] For epoch: 125, median_reward: 338.0442121955728, dev: 676.0884243911456
2021-08-18:15:59:26,297 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3038, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:59:26,298 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1817.7118, eval_time 0.6376, test_loss 2.3038, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:59:26,309 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4932, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:59:26,310 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1817.7268, eval_time 0.6505, test_loss 2.4932, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:59:26,382 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:59:26,388 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:59:26,392 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:26,397 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:26,464 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6328, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:59:26,465 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1817.8849, eval_time 0.8081, test_loss 2.6328, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:59:26,533 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:59:26,566 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:27,616 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:27,625 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:28,235 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:28,249 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:28,572 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:28,590 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:29,931 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:29,944 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:30,558 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:30,568 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:30,581 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:30,598 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:31,252 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:31,261 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:31,832 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:31,859 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:31,861 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:31,870 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:31,896 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:31,916 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:32,495 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:32,504 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:32,519 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:32,546 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:32,577 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:32,598 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:32,965 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:32,988 INFO     [learner.py:606] ====Pushing takes 0.01844644546508789 s
2021-08-18:15:59:33,9 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:33,14 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:33,15 INFO     [param_server.py:410] Lock worker 1 with localStep 125 , while globalStep is 124

2021-08-18:15:59:33,733 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:33,747 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:34,122 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:34,152 INFO     [learner.py:606] ====Pushing takes 0.02853250503540039 s
2021-08-18:15:59:34,180 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:34,211 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:34,211 INFO     [param_server.py:410] Lock worker 2 with localStep 125 , while globalStep is 124

2021-08-18:15:59:34,278 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:34,292 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:34,846 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:34,855 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:59:35,406 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:59:35,415 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:35,880 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:35,921 INFO     [learner.py:606] ====Pushing takes 0.040328025817871094 s
2021-08-18:15:59:35,966 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:35,977 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:35,978 INFO     [param_server.py:381] ====After aggregation in epoch: 124, virtual_clock: 4082.230194126914, top_1: : 60.0839 % (1862.0), top_5: : 100.0 % (3099.0), test loss: 2.4765768536814936, test len: 3099.0
2021-08-18:15:59:35,980 INFO     [param_server.py:410] Lock worker 3 with localStep 125 , while globalStep is 125

2021-08-18:15:59:35,981 INFO     [param_server.py:441] ====Epoch 126 completes 20 clients with loss 4.6389979886327035, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:35,981 INFO     [param_server.py:450] ====Start to sample for epoch 126, global virtualClock: 4082.230194126914, round_duration: 28.015855495488744
2021-08-18:15:59:35,981 INFO     [oort.py:208] Training selector: Pacer 124: lastExploitationUtil 428.2268614897989, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:59:35,982 INFO     [oort.py:321] scores are 26,{3: 0.09367831247230782, 5: 0.026718009249939268, 6: 0.36065293842038565, 7: 0.8550476551456715, 11: 0.0106797798718537, 14: 0.007938823948960455, 27: 0.005475763389515068, 36: 0.012887642620785244, 50: 0.02911662497591669, 51: 0.1791174452237214, 53: 0.5668450224492391, 58: 0.0032832117017340995, 60: 0.0013847209048066184, 67: 0.001793249276022407, 70: 0.0070002167583042415, 79: 0.0027715978958060216, 81: 0.0162797802880193, 84: 0.028577425925240575, 85: 0.056859272922876646, 87: 0.019515331069871515, 93: 0.01079694035636513, 97: 0.3388341072846745, 105: 0.023032826060010524, 110: 0.006591861816304237, 112: 0.28437219421877796, 113: 0.7272916263018613, 119: 0.013128480704483228},[7, 113, 53, 6, 97, 112, 51, 3, 85, 50, 84, 5, 105, 87, 81, 119, 36, 93, 11, 14, 70, 110, 27, 58, 79, 67, 60]
2021-08-18:15:59:35,983 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:59:35,984 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:35,984 INFO     [oort.py:398] At round 124, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1045.914273158412, 'duration': 11.058674649423494, 'time_stamp': 125, 'count': 122, 'status': True, 'gradient': 18.614173232759217}, [0.7896808351668217, -2.400019200153603e-06]), ({'reward': 584.0271979418741, 'duration': 16.330805291863395, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 19.37282713490919}, [0.4409458914602068, 0.29519996159969275]), ({'reward': 881.0346975638371, 'duration': 8.009219946401625, 'time_stamp': 125, 'count': 49, 'status': True, 'gradient': 21.3630713954502}, [0.6651931138198056, -2.400019200153603e-06])]
2021-08-18:15:59:35,985 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 79, 36, 50, 105]
2021-08-18:15:59:36,267 INFO     [param_server.py:553] For epoch: 126, median_reward: 343.5212620907695, dev: 687.042524181539
2021-08-18:15:59:36,796 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4854, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:59:36,797 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1828.2168, eval_time 0.5074, test_loss 2.4854, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:59:36,860 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:36,875 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:36,901 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7163, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:59:36,902 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1828.3191, eval_time 0.6122, test_loss 2.7163, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:59:36,902 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4175, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:59:36,903 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1828.317, eval_time 0.6102, test_loss 2.4175, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:59:36,975 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:36,984 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:37,17 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:37,26 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:38,299 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:38,311 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:39,479 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:39,497 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:39,845 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:39,846 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:39,857 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:39,886 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:41,292 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:41,323 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:41,937 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:41,946 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:41,948 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:41,973 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:42,204 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:42,214 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:42,346 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:42,360 INFO     [learner.py:606] ====Pushing takes 0.012627601623535156 s
2021-08-18:15:59:42,383 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:42,390 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:42,391 INFO     [param_server.py:410] Lock worker 1 with localStep 126 , while globalStep is 125

2021-08-18:15:59:43,536 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:43,546 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:44,128 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:44,137 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:44,816 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:44,826 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:44,935 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:44,944 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:45,591 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:45,603 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:46,208 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:46,234 INFO     [learner.py:606] ====Pushing takes 0.02484440803527832 s
2021-08-18:15:59:46,267 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:46,274 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:46,275 INFO     [param_server.py:410] Lock worker 2 with localStep 126 , while globalStep is 125

2021-08-18:15:59:47,138 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:47,152 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:47,899 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:47,913 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:48,523 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:48,533 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:15:59:49,87 INFO     [learner.py:439] Completed to run client 36
2021-08-18:15:59:49,97 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:49,653 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:49,695 INFO     [learner.py:606] ====Pushing takes 0.040251970291137695 s
2021-08-18:15:59:49,746 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:49,757 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:49,757 INFO     [param_server.py:381] ====After aggregation in epoch: 125, virtual_clock: 4120.626215685699, top_1: : 60.6325 % (1879.0), top_5: : 100.0 % (3099.0), test loss: 2.5397408494242915, test len: 3099.0
2021-08-18:15:59:49,759 INFO     [param_server.py:410] Lock worker 3 with localStep 126 , while globalStep is 126

2021-08-18:15:59:49,759 INFO     [param_server.py:441] ====Epoch 127 completes 20 clients with loss 5.259525033160301, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:49,760 INFO     [param_server.py:450] ====Start to sample for epoch 127, global virtualClock: 4120.626215685699, round_duration: 38.39602155878561
2021-08-18:15:59:49,760 INFO     [oort.py:208] Training selector: Pacer 125: lastExploitationUtil 505.33461551043916, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:59:49,761 INFO     [oort.py:321] scores are 25,{3: 0.16383683679214592, 5: 0.07200210266016285, 6: 0.33932459306833895, 7: 0.0619031151420898, 11: 0.05585742708267798, 14: 0.006611159501113574, 27: 0.05845510699449359, 36: 0.002682114106145881, 50: 0.002643124505996005, 51: 0.45567514140106646, 53: 0.04119549598056279, 58: 0.0027341374963893634, 60: 0.0012200737014813892, 67: 0.0013105796352825497, 70: 0.0058295220840081236, 79: 0.0027628765320409847, 81: 0.016228552840444187, 84: 0.028487501579670983, 85: 0.033024801094273075, 87: 0.04185974876855883, 93: 0.05600381316172958, 97: 0.3387717693569771, 105: 0.0026226363544798654, 110: 0.0065711192602228375, 113: 0.0619031151420898, 119: 0.010932914056621168},[51, 6, 97, 3, 5, 7, 113, 27, 93, 11, 87, 53, 85, 84, 81, 119, 14, 110, 70, 79, 58, 36, 50, 105, 67, 60]
2021-08-18:15:59:49,762 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:59:49,762 INFO     [oort.py:365] exploration poss is [16.91829855  9.79312991  1.91505738  0.90032832]
2021-08-18:15:59:49,763 INFO     [oort.py:398] At round 125, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1060.5054771375649, 'duration': 17.343863580585587, 'time_stamp': 126, 'count': 17, 'status': True, 'gradient': 20.315518088051963}, [0.5436606243053337, -2.380971277549824e-06]), ({'reward': 1950.6671458177873, 'duration': 15.972045438625893, 'time_stamp': 126, 'count': 123, 'status': True, 'gradient': 21.3688243219702}, [1.0, -2.380971277549824e-06]), ({'reward': 507.5756514907417, 'duration': 21.635252629006885, 'time_stamp': 126, 'count': 76, 'status': True, 'gradient': 22.001501760183164}, [0.2602023938327345, -2.380971277549824e-06])]
2021-08-18:15:59:49,763 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:15:59:50,47 INFO     [param_server.py:553] For epoch: 127, median_reward: 359.8215676632702, dev: 719.6431353265403
2021-08-18:15:59:50,690 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3983, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:59:50,690 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1842.1045, eval_time 0.5978, test_loss 2.3983, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:59:50,699 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.027, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:59:50,701 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1842.118, eval_time 0.6085, test_loss 3.027, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:59:50,770 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:50,772 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:50,780 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:50,781 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:50,815 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.673, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:59:50,816 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1842.2358, eval_time 0.7238, test_loss 2.673, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:59:50,873 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:50,901 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:51,932 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:51,950 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:52,928 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:52,947 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:53,520 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:53,534 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:54,692 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:54,719 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:54,760 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:54,780 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:55,742 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:55,755 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:56,10 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:56,37 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:56,405 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:56,415 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:56,743 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:56,770 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:59:56,973 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:56,984 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:57,302 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:57,323 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:57,436 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:59:57,463 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:57,550 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:57,559 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:57,817 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:57,844 INFO     [learner.py:606] ====Pushing takes 0.023102521896362305 s
2021-08-18:15:59:57,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:57,881 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:59:57,882 INFO     [param_server.py:410] Lock worker 1 with localStep 127 , while globalStep is 126

2021-08-18:15:59:58,40 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:58,60 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:59,275 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:59,288 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:59,832 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:59,859 INFO     [learner.py:606] ====Pushing takes 0.025313854217529297 s
2021-08-18:15:59:59,885 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:59,892 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:59:59,893 INFO     [param_server.py:410] Lock worker 2 with localStep 127 , while globalStep is 126

2021-08-18:15:59:59,900 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:59,909 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:00,533 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:00,542 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:00:01,245 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:00:01,286 INFO     [learner.py:606] ====Pushing takes 0.0399169921875 s
2021-08-18:16:00:01,324 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:01,334 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:01,334 INFO     [param_server.py:381] ====After aggregation in epoch: 126, virtual_clock: 4153.716333061759, top_1: : 60.6002 % (1878.0), top_5: : 100.0 % (3099.0), test loss: 2.6994263816762856, test len: 3099.0
2021-08-18:16:00:01,337 INFO     [param_server.py:410] Lock worker 3 with localStep 127 , while globalStep is 127

2021-08-18:16:00:01,338 INFO     [param_server.py:441] ====Epoch 128 completes 20 clients with loss 4.587826376927227, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:01,338 INFO     [param_server.py:450] ====Start to sample for epoch 128, global virtualClock: 4153.716333061759, round_duration: 33.09011737605898
2021-08-18:16:00:01,339 INFO     [oort.py:208] Training selector: Pacer 126: lastExploitationUtil 696.0581593577353, lastExplorationUtil 2378.113371004877, last_util_record 60
2021-08-18:16:00:01,340 INFO     [oort.py:321] scores are 26,{3: 0.19257689684999452, 5: 0.0344246072851938, 6: 0.1059115261681639, 7: 0.23279626283837493, 11: 0.08958699309688545, 14: 0.007859818967388847, 27: 0.044665633386679435, 36: 0.00267373720216218, 50: 0.024689141139016307, 51: 0.03470663634894712, 53: 0.04106683228441379, 58: 0.0032505380863902104, 60: 0.0014505108247502558, 67: 0.0017754033548990395, 70: 0.006930552536053854, 79: 0.023859324360416417, 81: 0.09322090384045148, 84: 0.17571093670707982, 85: 0.07735855367594532, 87: 0.007347130012397596, 93: 0.010729350318081947, 97: 0.09751611094068785, 103: 0.06882116053828503, 105: 0.0026247994924742187, 110: 0.07639714962944506, 113: 0.16461940357873941, 119: 0.01299782969335245},[7, 3, 84, 113, 6, 97, 81, 11, 85, 110, 103, 27, 53, 51, 5, 50, 79, 119, 93, 14, 87, 70, 58, 36, 105, 67, 60]
2021-08-18:16:00:01,341 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:00:01,341 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:01,341 INFO     [oort.py:398] At round 126, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 406.9120380469491, 'duration': 5.8943907365129, 'time_stamp': 127, 'count': 124, 'status': True, 'gradient': 21.591070848143108}, [0.1710864905998909, -2.362223324593109e-06]), ({'reward': 1564.9305543230716, 'duration': 27.689063957948644, 'time_stamp': 127, 'count': 119, 'status': True, 'gradient': 20.852056840012377}, [0.657988252216276, -2.362223324593109e-06]), ({'reward': 244.76420530525635, 'duration': 8.009219946401625, 'time_stamp': 127, 'count': 51, 'status': True, 'gradient': 21.384950856834926}, [0.1029096313402554, -2.362223324593109e-06])]
2021-08-18:16:00:01,342 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:00:01,668 INFO     [param_server.py:553] For epoch: 128, median_reward: 413.6319038496251, dev: 827.2638076992502
2021-08-18:16:00:02,254 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6464, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:00:02,255 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1853.6744, eval_time 0.5516, test_loss 2.6464, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:00:02,329 INFO     [learner.py:526] ====Start train round 128
2021-08-18:16:00:02,334 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5934, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:00:02,335 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1853.7494, eval_time 0.6319, test_loss 2.5934, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:00:02,345 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:02,358 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9563, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:00:02,359 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1853.7762, eval_time 0.6559, test_loss 2.9563, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:00:02,432 INFO     [learner.py:526] ====Start train round 128
2021-08-18:16:00:02,436 INFO     [learner.py:526] ====Start train round 128
2021-08-18:16:00:02,445 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:02,449 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:03,766 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:03,780 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:04,903 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:04,915 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:05,147 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:05,161 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:05,531 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:05,558 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:06,763 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:06,790 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:07,239 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:07,259 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:07,414 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:07,441 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:07,441 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:07,450 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:08,45 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:08,72 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:08,450 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:08,467 INFO     [learner.py:606] ====Pushing takes 0.01600480079650879 s
2021-08-18:16:00:08,498 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:08,503 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:08,504 INFO     [param_server.py:410] Lock worker 1 with localStep 128 , while globalStep is 127

2021-08-18:16:00:08,553 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:08,568 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:09,195 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:09,210 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:09,838 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:09,847 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:10,217 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:10,231 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:10,840 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:10,850 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:11,403 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:11,430 INFO     [learner.py:606] ====Pushing takes 0.02584385871887207 s
2021-08-18:16:00:11,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:11,464 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:11,465 INFO     [param_server.py:410] Lock worker 2 with localStep 128 , while globalStep is 127

2021-08-18:16:00:12,153 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:12,167 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:12,882 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:12,897 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:13,582 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:13,592 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:00:14,259 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:00:14,297 INFO     [learner.py:606] ====Pushing takes 0.036839962005615234 s
2021-08-18:16:00:14,345 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:14,355 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:14,355 INFO     [param_server.py:381] ====After aggregation in epoch: 127, virtual_clock: 4192.1123546205445, top_1: : 60.8906 % (1887.0), top_5: : 100.0 % (3099.0), test loss: 2.7320437828699746, test len: 3099.0
2021-08-18:16:00:14,357 INFO     [param_server.py:410] Lock worker 3 with localStep 128 , while globalStep is 128

2021-08-18:16:00:14,357 INFO     [param_server.py:441] ====Epoch 129 completes 20 clients with loss 4.4259489562768906, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:14,358 INFO     [param_server.py:450] ====Start to sample for epoch 129, global virtualClock: 4192.1123546205445, round_duration: 38.39602155878561
2021-08-18:16:00:14,358 INFO     [oort.py:208] Training selector: Pacer 127: lastExploitationUtil 549.5086355626113, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:00:14,359 INFO     [oort.py:321] scores are 26,{3: 0.15988831083114596, 5: 0.005725557306952128, 6: 0.0353318353689507, 7: 0.42547930127527206, 11: 0.1520378033925853, 14: 0.008094409646686786, 27: 0.0054246151857645685, 36: 0.021854214039789027, 50: 0.0026267009331232163, 51: 0.03459904119288747, 53: 0.040939519681023134, 58: 0.0033475563435452385, 60: 0.001493803974518592, 67: 0.0024223964512430154, 70: 0.007137407558299112, 79: 0.03801607299341873, 81: 0.21159834727409663, 84: 0.02831048889748517, 85: 0.03289966155188071, 87: 0.007324352939093041, 93: 0.1845640043426211, 97: 0.23722134669825948, 103: 0.029592787309964563, 105: 0.016648721424250543, 110: 0.0726896912958798, 113: 0.06151846798669384, 119: 0.013385773704507642},[7, 97, 81, 93, 3, 11, 110, 113, 53, 79, 6, 51, 85, 103, 84, 36, 105, 119, 14, 87, 70, 5, 27, 58, 50, 67, 60]
2021-08-18:16:00:14,373 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:00:14,373 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:14,374 INFO     [oort.py:398] At round 127, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 654.8923798910067, 'duration': 35.433463751176646, 'time_stamp': 128, 'count': 2, 'status': True, 'gradient': 15.25340412540055}, [0.3950119311541567, -2.3437683106899294e-06]), ({'reward': 1363.647357312163, 'duration': 21.753601635627824, 'time_stamp': 128, 'count': 122, 'status': True, 'gradient': 21.607183451107627}, [0.8225187272871952, -2.3437683106899294e-06]), ({'reward': 877.7761789487291, 'duration': 17.343863580585587, 'time_stamp': 128, 'count': 19, 'status': True, 'gradient': 20.3377732653134}, [0.5294509712746567, -2.3437683106899294e-06])]
2021-08-18:16:00:14,374 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:00:14,648 INFO     [param_server.py:553] For epoch: 129, median_reward: 374.1998964971396, dev: 748.3997929942792
2021-08-18:16:00:15,257 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3628, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:00:15,258 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1866.6723, eval_time 0.5653, test_loss 2.3628, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:00:15,302 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5187, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:00:15,303 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1866.7204, eval_time 0.6106, test_loss 2.5187, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:00:15,329 INFO     [learner.py:526] ====Start train round 129
2021-08-18:16:00:15,338 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:15,368 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5027, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:00:15,369 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1866.7889, eval_time 0.6766, test_loss 2.5027, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:00:15,379 INFO     [learner.py:526] ====Start train round 129
2021-08-18:16:00:15,394 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:15,449 INFO     [learner.py:526] ====Start train round 129
2021-08-18:16:00:15,475 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:16,619 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:16,638 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:17,321 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:17,333 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:17,763 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:17,781 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:18,544 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:18,553 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:18,826 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:18,854 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:19,603 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:19,612 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:20,29 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:20,56 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:20,240 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:20,250 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:20,568 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:20,588 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:20,807 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:20,818 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:20,821 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:20,849 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:21,184 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:21,204 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:21,434 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:21,444 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:21,463 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:21,490 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:21,917 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:21,943 INFO     [learner.py:606] ====Pushing takes 0.02431035041809082 s
2021-08-18:16:00:21,972 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:21,981 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:21,981 INFO     [param_server.py:410] Lock worker 1 with localStep 129 , while globalStep is 128

2021-08-18:16:00:22,621 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:22,625 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:22,630 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:22,651 INFO     [learner.py:606] ====Pushing takes 0.025023221969604492 s
2021-08-18:16:00:22,679 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:22,685 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:22,686 INFO     [param_server.py:410] Lock worker 2 with localStep 129 , while globalStep is 128

2021-08-18:16:00:23,207 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:23,222 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:23,788 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:23,798 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:00:24,403 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:00:24,446 INFO     [learner.py:606] ====Pushing takes 0.04142618179321289 s
2021-08-18:16:00:24,482 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:24,492 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:24,492 INFO     [param_server.py:381] ====After aggregation in epoch: 128, virtual_clock: 4220.128210116033, top_1: : 61.2778 % (1899.0), top_5: : 100.0 % (3099.0), test loss: 2.461406425193504, test len: 3099.0
2021-08-18:16:00:24,495 INFO     [param_server.py:410] Lock worker 3 with localStep 129 , while globalStep is 129

2021-08-18:16:00:24,495 INFO     [param_server.py:441] ====Epoch 130 completes 20 clients with loss 6.133188773358216, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:24,496 INFO     [param_server.py:450] ====Start to sample for epoch 130, global virtualClock: 4220.128210116033, round_duration: 28.015855495488744
2021-08-18:16:00:24,496 INFO     [oort.py:208] Training selector: Pacer 128: lastExploitationUtil 280.60754360160047, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:00:24,497 INFO     [oort.py:321] scores are 26,{3: 0.1321373947096826, 5: 0.015692321737226574, 6: 0.035223104909835865, 7: 0.06132915058502517, 11: 0.010547462767798657, 14: 0.005697400361300128, 27: 0.005407921433699035, 36: 0.017507805959696757, 50: 0.022867808199620882, 51: 0.03449256584014817, 53: 0.040813532091519916, 58: 0.004115632224099516, 60: 0.0010514416338710316, 67: 0.0012869486889741514, 70: 0.005023796691342961, 79: 0.002737259191115618, 81: 0.01607808199384002, 84: 0.028223365983449003, 85: 0.04796891130108908, 87: 0.08684614194203896, 93: 0.03586089149881202, 97: 0.06542701263099562, 103: 0.04466574844140268, 105: 0.01171851136747646, 110: 0.1126618645350125, 113: 0.06132915058502517, 119: 0.009421825095244606},[3, 110, 87, 97, 7, 113, 85, 103, 53, 93, 6, 51, 84, 50, 36, 81, 5, 105, 11, 119, 14, 27, 70, 58, 79, 67, 60]
2021-08-18:16:00:24,498 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:00:24,498 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:24,499 INFO     [oort.py:398] At round 128, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 129, 'count': 126, 'status': True, 'gradient': 21.613936151802854}, [7.671722334813332e-09, -2.325599423251345e-06]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 129, 'count': 125, 'status': True, 'gradient': 13.564866911997699}, [7.671722334813332e-09, -2.325599423251345e-06]), ({'reward': 556.6894763607945, 'duration': 17.343863580585587, 'time_stamp': 129, 'count': 20, 'status': True, 'gradient': 13.565461334640213}, [0.42706904488466946, -2.325599423251345e-06])]
2021-08-18:16:00:24,500 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:00:24,785 INFO     [param_server.py:553] For epoch: 130, median_reward: 314.1773219442253, dev: 628.3546438884506
2021-08-18:16:00:25,424 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5457, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:16:00:25,425 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1876.8448, eval_time 0.5951, test_loss 2.5457, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:16:00:25,509 INFO     [learner.py:526] ====Start train round 130
2021-08-18:16:00:25,514 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9765, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:16:00:25,515 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1876.9317, eval_time 0.6844, test_loss 3.9765, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:16:00:25,518 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3622, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:00:25,519 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1876.9331, eval_time 0.6887, test_loss 2.3622, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:00:25,530 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:25,585 INFO     [learner.py:526] ====Start train round 130
2021-08-18:16:00:25,586 INFO     [learner.py:526] ====Start train round 130
2021-08-18:16:00:25,599 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:25,602 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:26,799 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:26,818 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:27,910 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:27,923 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:28,453 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:28,462 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:28,627 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:28,647 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:29,746 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:29,760 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:30,152 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:30,161 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:30,290 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:30,304 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:30,839 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:30,860 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:30,870 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:30,887 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:31,208 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:31,232 INFO     [learner.py:606] ====Pushing takes 0.01636052131652832 s
2021-08-18:16:00:31,256 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:31,263 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:31,264 INFO     [param_server.py:410] Lock worker 1 with localStep 130 , while globalStep is 129

2021-08-18:16:00:32,62 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:32,74 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:32,777 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:32,795 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:33,329 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:33,344 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:33,371 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:33,381 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:34,55 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:34,69 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:34,685 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:34,710 INFO     [learner.py:606] ====Pushing takes 0.02367258071899414 s
2021-08-18:16:00:34,739 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:34,746 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:34,747 INFO     [param_server.py:410] Lock worker 2 with localStep 130 , while globalStep is 129

2021-08-18:16:00:35,755 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:35,766 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:36,398 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:36,407 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:37,34 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:37,44 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:00:37,672 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:00:37,710 INFO     [learner.py:606] ====Pushing takes 0.03357434272766113 s
2021-08-18:16:00:37,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:37,762 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:37,762 INFO     [param_server.py:381] ====After aggregation in epoch: 129, virtual_clock: 4258.524231674819, top_1: : 59.9548 % (1858.0), top_5: : 100.0 % (3099.0), test loss: 2.9614375211574413, test len: 3099.0
2021-08-18:16:00:37,765 INFO     [param_server.py:410] Lock worker 3 with localStep 130 , while globalStep is 130

2021-08-18:16:00:37,765 INFO     [param_server.py:441] ====Epoch 131 completes 20 clients with loss 4.821055975316672, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:37,766 INFO     [param_server.py:450] ====Start to sample for epoch 131, global virtualClock: 4258.524231674819, round_duration: 38.39602155878561
2021-08-18:16:00:37,767 INFO     [oort.py:208] Training selector: Pacer 129: lastExploitationUtil 407.7160735284031, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:00:37,768 INFO     [oort.py:321] scores are 26,{3: 0.28709465698333164, 5: 0.021753480343614212, 6: 0.03511549585441867, 7: 0.7285941400162853, 11: 0.010515239529432925, 14: 0.006259521503520517, 27: 0.07896643234168589, 36: 0.0026491275213455607, 50: 0.004536544033140865, 51: 0.03438718863281579, 53: 0.04068884388905025, 58: 0.002588712683357321, 60: 0.0008683950581816601, 67: 0.0014139225755100276, 70: 0.005519458248428322, 79: 0.02503062239233209, 81: 0.05640093591084126, 84: 0.05180369168026859, 85: 0.006807778712964693, 87: 0.04698013853987457, 93: 0.029579778233294, 97: 0.2650524715103393, 103: 0.011773706056708496, 105: 0.012874691831772514, 110: 0.013257147599735581, 113: 0.09503823089418904, 119: 0.010351408194286472},[7, 3, 97, 113, 27, 81, 84, 87, 53, 6, 51, 93, 79, 5, 110, 105, 103, 11, 119, 85, 14, 70, 50, 36, 58, 67, 60]
2021-08-18:16:00:37,769 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:00:37,769 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:37,770 INFO     [oort.py:398] At round 129, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1679.5843694279054, 'duration': 17.343863580585587, 'time_stamp': 130, 'count': 21, 'status': True, 'gradient': 20.35423815630485}, [1.0, -2.3077100593081503e-06]), ({'reward': 1292.7501501385284, 'duration': 15.972045438625893, 'time_stamp': 130, 'count': 127, 'status': True, 'gradient': 21.41006057155581}, [0.7696831863908641, -2.3077100593081503e-06]), ({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 130, 'count': 127, 'status': True, 'gradient': 21.30416631869122}, [5.953889343921631e-09, -2.3077100593081503e-06])]
2021-08-18:16:00:37,770 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:00:38,108 INFO     [param_server.py:553] For epoch: 131, median_reward: 339.4767583005077, dev: 678.9535166010154
2021-08-18:16:00:38,783 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8597, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:00:38,784 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1890.1983, eval_time 0.6175, test_loss 2.8597, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:00:38,828 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4697, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:00:38,829 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1890.2466, eval_time 0.6642, test_loss 2.4697, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:00:38,852 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:38,860 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:38,902 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:38,915 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:38,944 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6077, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:00:38,948 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1890.3676, eval_time 0.7839, test_loss 2.6077, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:00:39,18 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:39,46 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:40,83 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:40,95 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:40,641 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:40,653 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:41,311 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:41,332 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:41,795 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:41,806 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:42,528 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:42,556 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:43,261 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:43,275 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:43,521 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:43,548 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:43,762 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:43,783 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:43,897 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:43,907 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:44,191 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:44,212 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:44,406 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:44,426 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:44,543 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:44,552 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:45,33 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:45,47 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:45,122 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:45,131 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:45,451 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:45,478 INFO     [learner.py:606] ====Pushing takes 0.024878501892089844 s
2021-08-18:16:00:45,505 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:45,511 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:45,512 INFO     [param_server.py:410] Lock worker 1 with localStep 131 , while globalStep is 130

2021-08-18:16:00:45,694 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:45,720 INFO     [learner.py:606] ====Pushing takes 0.024787425994873047 s
2021-08-18:16:00:45,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:45,757 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:45,757 INFO     [param_server.py:410] Lock worker 2 with localStep 131 , while globalStep is 130

2021-08-18:16:00:46,296 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:46,314 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:46,838 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:46,847 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:47,474 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:47,483 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:00:48,8 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:00:48,47 INFO     [learner.py:606] ====Pushing takes 0.03772234916687012 s
2021-08-18:16:00:48,86 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:48,96 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:48,97 INFO     [param_server.py:381] ====After aggregation in epoch: 130, virtual_clock: 4286.540087170308, top_1: : 61.1488 % (1895.0), top_5: : 100.0 % (3099.0), test loss: 2.6456810423621424, test len: 3099.0
2021-08-18:16:00:48,99 INFO     [param_server.py:410] Lock worker 3 with localStep 131 , while globalStep is 131

2021-08-18:16:00:48,99 INFO     [param_server.py:441] ====Epoch 132 completes 20 clients with loss 4.628069050432048, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:48,100 INFO     [param_server.py:450] ====Start to sample for epoch 132, global virtualClock: 4286.540087170308, round_duration: 28.015855495488744
2021-08-18:16:00:48,101 INFO     [oort.py:208] Training selector: Pacer 130: lastExploitationUtil 360.09994693684285, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:00:48,101 INFO     [oort.py:321] scores are 25,{3: 0.016491896818580955, 5: 0.04959371836752683, 6: 0.035008991446589845, 7: 0.06095634424488821, 11: 0.12484814910470649, 27: 0.00537504787555884, 36: 0.0322229678369315, 50: 0.008257953713029224, 51: 0.034282893162308425, 53: 0.39385363250562044, 58: 0.0024080954694419617, 60: 0.0008903024691257076, 67: 0.0013152717063261027, 70: 0.005134359825740341, 79: 0.0030734896850731354, 81: 0.1260268617365772, 84: 0.02805180238476442, 85: 0.018130057579842228, 87: 0.007257426814058222, 93: 0.01059835263082019, 97: 0.019446490361131125, 103: 0.06877232213251169, 105: 0.011976411005312557, 110: 0.051271280796827544, 113: 0.06095634424488821, 119: 0.009629179528211452},[53, 81, 11, 103, 7, 113, 110, 5, 6, 51, 36, 84, 97, 85, 3, 105, 93, 119, 50, 87, 27, 70, 79, 58, 67, 60]
2021-08-18:16:00:48,102 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:00:48,102 INFO     [oort.py:365] exploration poss is [24.8550604   9.79312991  1.91505738  0.90032832]
2021-08-18:16:00:48,103 INFO     [oort.py:398] At round 130, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 63, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 862.1641123772436, 'duration': 11.058674649423494, 'time_stamp': 131, 'count': 128, 'status': True, 'gradient': 18.666918477327307}, [0.5308745449205694, -2.2900938175100593e-06]), ({'reward': 1079.9617153965096, 'duration': 21.753601635627824, 'time_stamp': 131, 'count': 125, 'status': True, 'gradient': 21.63305132499991}, [0.6649842132346666, -2.2900938175100593e-06]), ({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 131, 'count': 125, 'status': True, 'gradient': 27.675626065263224}, [6.157536467572078e-09, -2.2900938175100593e-06])]
2021-08-18:16:00:48,104 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:00:48,446 INFO     [param_server.py:553] For epoch: 132, median_reward: 329.5567053149834, dev: 659.1134106299668
2021-08-18:16:00:49,73 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5719, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:00:49,80 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4486, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:00:49,80 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1900.4975, eval_time 0.5895, test_loss 2.5719, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:00:49,81 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1900.495, eval_time 0.5885, test_loss 2.4486, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:00:49,95 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6296, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:00:49,96 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1900.5154, eval_time 0.6047, test_loss 2.6296, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:00:49,150 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:49,150 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:49,159 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:49,159 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:49,193 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:49,221 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:50,392 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:50,403 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:51,613 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:51,624 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:51,839 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:51,849 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:52,462 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:52,502 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:53,763 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:53,790 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:53,948 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:53,960 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:54,226 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:54,248 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:54,423 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:54,450 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:55,11 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:55,31 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:55,333 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:55,351 INFO     [learner.py:606] ====Pushing takes 0.016191720962524414 s
2021-08-18:16:00:55,377 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:55,386 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:55,387 INFO     [param_server.py:410] Lock worker 1 with localStep 132 , while globalStep is 131

2021-08-18:16:00:55,429 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:55,439 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:56,52 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:56,62 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:56,792 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:56,807 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:56,812 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:56,832 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:57,495 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:57,518 INFO     [learner.py:606] ====Pushing takes 0.021503210067749023 s
2021-08-18:16:00:57,545 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:57,551 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:00:57,552 INFO     [param_server.py:410] Lock worker 2 with localStep 132 , while globalStep is 131

2021-08-18:16:00:59,1 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:59,11 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:59,646 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:59,656 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:00,228 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:00,237 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:00,815 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:00,825 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:01,449 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:01,488 INFO     [learner.py:606] ====Pushing takes 0.0376129150390625 s
2021-08-18:16:01:01,533 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:01,544 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:01,545 INFO     [param_server.py:381] ====After aggregation in epoch: 131, virtual_clock: 4323.831838910391, top_1: : 61.2778 % (1899.0), top_5: : 100.0 % (3099.0), test loss: 2.550008848861412, test len: 3099.0
2021-08-18:16:01:01,547 INFO     [param_server.py:410] Lock worker 3 with localStep 132 , while globalStep is 132

2021-08-18:16:01:01,548 INFO     [param_server.py:441] ====Epoch 133 completes 20 clients with loss 5.365974578025676, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:01,548 INFO     [param_server.py:450] ====Start to sample for epoch 133, global virtualClock: 4323.831838910391, round_duration: 37.29175174008306
2021-08-18:16:01:01,549 INFO     [oort.py:208] Training selector: Pacer 131: lastExploitationUtil 613.5203799760234, lastExplorationUtil 518.7308953844378, last_util_record 60
2021-08-18:16:01:01,550 INFO     [oort.py:321] scores are 26,{3: 0.17772769414102743, 5: 0.005656156714249802, 6: 0.03490357132679557, 7: 0.060772790682017915, 11: 0.15825208038628363, 12: 0.019315290425657317, 27: 0.05636649171748322, 36: 0.002633139847388114, 50: 0.01934475513578076, 51: 0.4128935805964162, 53: 0.04044328380764158, 58: 0.003859496944887791, 60: 0.0009198004248894163, 67: 0.002108009087131124, 70: 0.00822892875837332, 79: 0.028014266248890585, 81: 0.01593222639249374, 84: 0.23748951885987638, 85: 0.08795445193589396, 87: 0.034896905433231575, 93: 0.10287530032714363, 97: 0.20538371240572884, 103: 0.0687604239768559, 105: 0.01919480447194885, 110: 0.02278383423504589, 113: 0.614045571030804, 119: 0.015432855317617572},[113, 51, 84, 97, 3, 11, 93, 85, 103, 7, 27, 53, 6, 87, 79, 110, 50, 12, 105, 81, 119, 70, 5, 58, 36, 67, 60]
2021-08-18:16:01:01,551 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:01:01,551 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:01,551 INFO     [oort.py:398] At round 131, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1046.8549113825654, 'duration': 12.029357192292537, 'time_stamp': 132, 'count': 126, 'status': True, 'gradient': 27.684368109532763}, [0.6733683839470388, -2.272744490488566e-06]), ({'reward': 860.1495819214649, 'duration': 8.009219946401625, 'time_stamp': 132, 'count': 56, 'status': True, 'gradient': 21.431981983404363}, [0.5532727867811466, -2.272744490488566e-06]), ({'reward': 1133.591812064158, 'duration': 27.035726288496562, 'time_stamp': 132, 'count': 125, 'status': True, 'gradient': 16.976798164006457}, [0.7291606846475115, -2.272744490488566e-06])]
2021-08-18:16:01:01,553 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:01,884 INFO     [param_server.py:553] For epoch: 133, median_reward: 385.00936311912324, dev: 770.0187262382465
2021-08-18:16:01:02,494 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2467, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:01:02,495 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1913.9091, eval_time 0.5551, test_loss 2.2467, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:01:02,514 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5732, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:01:02,515 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1913.9321, eval_time 0.5753, test_loss 2.5732, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:01:02,563 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:01:02,583 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:01:02,639 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:02,640 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:02,666 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6865, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:01:02,669 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1914.0885, eval_time 0.73, test_loss 2.6865, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:01:02,758 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:01:02,788 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:03,773 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:03,792 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:04,345 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:04,359 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:04,729 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:04,748 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:05,964 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:05,978 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:06,460 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:06,493 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:06,824 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:06,850 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:07,539 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:07,553 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:07,689 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:07,707 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:07,754 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:07,773 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:08,97 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:08,106 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:08,364 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:08,377 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:08,393 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:08,418 INFO     [learner.py:606] ====Pushing takes 0.02294301986694336 s
2021-08-18:16:01:08,445 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:08,451 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:08,451 INFO     [param_server.py:410] Lock worker 2 with localStep 133 , while globalStep is 132

2021-08-18:16:01:08,685 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:08,694 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:08,994 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:09,8 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:09,367 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:09,393 INFO     [learner.py:606] ====Pushing takes 0.02459716796875 s
2021-08-18:16:01:09,415 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:09,421 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:09,422 INFO     [param_server.py:410] Lock worker 1 with localStep 133 , while globalStep is 132

2021-08-18:16:01:10,78 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:10,87 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:10,570 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:10,579 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:11,59 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:11,68 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:11,597 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:11,608 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:12,240 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:12,282 INFO     [learner.py:606] ====Pushing takes 0.04021286964416504 s
2021-08-18:16:01:12,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:12,336 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:12,337 INFO     [param_server.py:381] ====After aggregation in epoch: 132, virtual_clock: 4351.847694405879, top_1: : 61.181 % (1896.0), top_5: : 100.0 % (3099.0), test loss: 2.5021518943486387, test len: 3099.0
2021-08-18:16:01:12,339 INFO     [param_server.py:410] Lock worker 3 with localStep 133 , while globalStep is 133

2021-08-18:16:01:12,339 INFO     [param_server.py:441] ====Epoch 134 completes 20 clients with loss 5.492335354704432, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:12,339 INFO     [param_server.py:450] ====Start to sample for epoch 134, global virtualClock: 4351.847694405879, round_duration: 28.015855495488744
2021-08-18:16:01:12,340 INFO     [oort.py:208] Training selector: Pacer 132: lastExploitationUtil 352.0294555955339, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:01:12,341 INFO     [oort.py:321] scores are 26,{3: 0.01639307737630386, 5: 0.005639246090520711, 6: 0.034799217577186424, 7: 0.06059109384296089, 11: 0.018658501951292348, 12: 0.007436303728639177, 27: 0.09352148544219785, 36: 0.007188613910265633, 50: 0.015139717043301396, 51: 0.08650340923484354, 53: 0.624052773683474, 58: 0.0030205443938140105, 60: 0.0011246807373793126, 67: 0.0016497836690030146, 70: 0.0064401773037087, 79: 0.023613961183072494, 81: 0.1502728703799755, 84: 0.15865023636903083, 85: 0.006746462405997498, 87: 0.0072139403141109225, 93: 0.04274317879482133, 97: 0.28521889967315067, 103: 0.05011725610581647, 105: 0.015022361687550665, 110: 0.03869569571015253, 113: 0.4250104308800831, 119: 0.012078160774791798},[53, 113, 97, 84, 81, 27, 51, 7, 103, 93, 110, 6, 79, 11, 3, 50, 105, 119, 12, 87, 36, 85, 70, 5, 58, 67, 60]
2021-08-18:16:01:12,341 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:01:12,342 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:12,342 INFO     [oort.py:398] At round 132, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 997.979477238741, 'duration': 15.972045438625893, 'time_stamp': 133, 'count': 130, 'status': True, 'gradient': 21.43882934798022}, [0.8334469188352033, -2.2556560575643446e-06]), ({'reward': 1050.3125070389028, 'duration': 11.058674649423494, 'time_stamp': 133, 'count': 130, 'status': True, 'gradient': 18.68247403873698}, [0.8771524659466066, -2.2556560575643446e-06]), ({'reward': 613.8192323653119, 'duration': 17.619275735353515, 'time_stamp': 133, 'count': 129, 'status': True, 'gradient': 15.285662501401404}, [0.5126182998013413, -2.2556560575643446e-06])]
2021-08-18:16:01:12,343 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:12,619 INFO     [param_server.py:553] For epoch: 134, median_reward: 329.142258356764, dev: 658.284516713528
2021-08-18:16:01:13,243 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7952, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:01:13,245 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3357, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:01:13,248 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1924.6652, eval_time 0.5841, test_loss 2.7952, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:01:13,249 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1924.6628, eval_time 0.5823, test_loss 2.3357, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:01:13,270 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7136, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:01:13,271 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1924.6911, eval_time 0.6073, test_loss 2.7136, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:01:13,321 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:01:13,321 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:01:13,331 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:13,331 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:13,350 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:01:13,379 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:14,582 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:14,595 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:15,223 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:15,237 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:15,574 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:15,584 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:16,788 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:16,822 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:16,918 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:16,936 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:17,453 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:17,473 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:17,955 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:17,983 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:18,206 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:18,219 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:18,523 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:18,544 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:18,646 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:18,664 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:18,854 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:18,863 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:19,41 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:19,62 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:19,186 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:19,202 INFO     [learner.py:606] ====Pushing takes 0.014727115631103516 s
2021-08-18:16:01:19,224 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:19,230 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:19,231 INFO     [param_server.py:410] Lock worker 1 with localStep 134 , while globalStep is 133

2021-08-18:16:01:19,269 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:19,293 INFO     [learner.py:606] ====Pushing takes 0.022280454635620117 s
2021-08-18:16:01:19,318 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:19,324 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:19,325 INFO     [param_server.py:410] Lock worker 2 with localStep 134 , while globalStep is 133

2021-08-18:16:01:19,403 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:19,413 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:20,666 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:20,676 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:21,310 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:21,320 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:21,876 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:21,888 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:22,444 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:22,455 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:23,22 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:23,64 INFO     [learner.py:606] ====Pushing takes 0.04129934310913086 s
2021-08-18:16:01:23,109 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:23,120 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:23,120 INFO     [param_server.py:381] ====After aggregation in epoch: 133, virtual_clock: 4380.447292884828, top_1: : 61.6651 % (1911.0), top_5: : 100.0 % (3099.0), test loss: 2.614828156100379, test len: 3099.0
2021-08-18:16:01:23,122 INFO     [param_server.py:410] Lock worker 3 with localStep 134 , while globalStep is 134

2021-08-18:16:01:23,123 INFO     [param_server.py:441] ====Epoch 135 completes 20 clients with loss 5.640339923510455, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:23,123 INFO     [param_server.py:450] ====Start to sample for epoch 135, global virtualClock: 4380.447292884828, round_duration: 28.599598478948877
2021-08-18:16:01:23,124 INFO     [oort.py:208] Training selector: Pacer 133: lastExploitationUtil 431.1799505675726, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:01:23,124 INFO     [oort.py:321] scores are 26,{3: 0.14562601806358833, 5: 0.09869304860141144, 6: 0.034695908051270145, 7: 0.1086768074802315, 11: 0.018148292286498863, 12: 0.002958074390154799, 27: 0.00532697913180616, 36: 0.024289160774707153, 50: 0.012379594740379415, 51: 0.03397630322214939, 53: 0.04020266130199982, 58: 0.002469868847865101, 60: 0.0008018614918851615, 67: 0.0013490115550468672, 70: 0.005266068371560379, 79: 0.004076504064049355, 81: 0.08741800689594613, 84: 0.18224366940637124, 85: 0.03978692960260876, 87: 0.09190820978472586, 93: 0.04549129140876147, 97: 0.08796698656965077, 103: 0.024094462323595918, 105: 0.0122836344433242, 110: 0.006412751581348418, 113: 0.20360595238158374, 119: 0.00987619089401847},[113, 84, 3, 7, 5, 87, 97, 81, 93, 53, 85, 6, 51, 36, 103, 11, 50, 105, 119, 110, 27, 70, 79, 12, 58, 67, 60]
2021-08-18:16:01:23,125 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:23,125 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:23,126 INFO     [oort.py:398] At round 133, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 58.102384622478155, 'duration': 42.701901101086094, 'time_stamp': 134, 'count': 87, 'status': True, 'gradient': 8.494598212110201}, [0.030924142108251874, -2.2388226777811796e-06]), ({'reward': 269.00776727864644, 'duration': 8.009219946401625, 'time_stamp': 134, 'count': 58, 'status': True, 'gradient': 21.446921352808168}, [0.14319474253777784, -2.2388226777811796e-06]), ({'reward': 512.9298298691094, 'duration': 17.619275735353515, 'time_stamp': 134, 'count': 130, 'status': True, 'gradient': 15.290186856847122}, [0.2730410085749276, -2.2388226777811796e-06])]
2021-08-18:16:01:23,127 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:23,431 INFO     [param_server.py:553] For epoch: 135, median_reward: 346.2915982261182, dev: 692.5831964522364
2021-08-18:16:01:24,51 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5284, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:01:24,52 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1935.4717, eval_time 0.5863, test_loss 2.5284, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:01:24,57 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5898, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:01:24,59 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1935.4759, eval_time 0.5928, test_loss 2.5898, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:01:24,88 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3809, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:01:24,89 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1935.5033, eval_time 0.6219, test_loss 2.3809, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:01:24,108 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:01:24,137 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:24,156 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:01:24,156 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:01:24,165 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:24,172 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:25,388 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:25,411 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:25,972 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:25,990 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:26,359 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:26,368 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:27,126 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:27,154 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:27,366 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:27,380 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:28,74 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:28,88 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:28,241 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:28,275 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:28,730 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:28,744 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:28,816 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:28,844 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:29,113 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:29,124 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:29,367 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:29,394 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:29,459 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:29,480 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:29,556 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:29,574 INFO     [learner.py:606] ====Pushing takes 0.017605304718017578 s
2021-08-18:16:01:29,597 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:29,606 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:29,607 INFO     [param_server.py:410] Lock worker 1 with localStep 135 , while globalStep is 134

2021-08-18:16:01:29,681 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:29,705 INFO     [learner.py:606] ====Pushing takes 0.022554397583007812 s
2021-08-18:16:01:29,727 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:29,733 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:29,733 INFO     [param_server.py:410] Lock worker 2 with localStep 135 , while globalStep is 134

2021-08-18:16:01:30,88 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:30,108 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:31,341 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:31,361 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:32,97 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:32,112 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:32,812 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:32,832 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:33,450 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:33,464 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:34,3 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:34,45 INFO     [learner.py:606] ====Pushing takes 0.03969717025756836 s
2021-08-18:16:01:34,89 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:34,99 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:34,100 INFO     [param_server.py:381] ====After aggregation in epoch: 134, virtual_clock: 4408.463148380317, top_1: : 61.1165 % (1894.0), top_5: : 100.0 % (3099.0), test loss: 2.499676938410159, test len: 3099.0
2021-08-18:16:01:34,102 INFO     [param_server.py:410] Lock worker 3 with localStep 135 , while globalStep is 135

2021-08-18:16:01:34,103 INFO     [param_server.py:441] ====Epoch 136 completes 20 clients with loss 5.973726881906185, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:34,103 INFO     [param_server.py:450] ====Start to sample for epoch 136, global virtualClock: 4408.463148380317, round_duration: 28.015855495488744
2021-08-18:16:01:34,104 INFO     [oort.py:208] Training selector: Pacer 134: lastExploitationUtil 528.8503059696968, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:01:34,104 INFO     [oort.py:321] scores are 26,{3: 0.12247308263528338, 5: 0.0056059304829369225, 6: 0.03459363033052002, 7: 0.06023313303168545, 11: 0.02768492069668716, 12: 0.024524253012289242, 27: 0.046349351322388446, 36: 0.002609757770522937, 50: 0.01819259298739511, 51: 0.3997679259445285, 53: 0.39179452269513504, 58: 0.0030559552870426257, 60: 0.001619674643418287, 67: 0.001982457315521819, 70: 0.007738818639604054, 79: 0.03830553338955701, 81: 0.01579074946238985, 84: 0.3024092432309404, 85: 0.08163933892624409, 87: 0.0071713217085775, 93: 0.18434052567667858, 97: 0.1799660181244732, 103: 0.02681874953181814, 105: 0.018051573296210814, 110: 0.016488651710145057, 113: 0.7784867482902921, 119: 0.014513683603441541},[113, 51, 53, 84, 93, 97, 3, 85, 7, 27, 79, 6, 11, 103, 12, 50, 105, 110, 81, 119, 70, 87, 5, 58, 36, 67, 60]
2021-08-18:16:01:34,105 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:01:34,105 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:34,106 INFO     [oort.py:398] At round 134, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 940.4322891935552, 'duration': 12.029357192292537, 'time_stamp': 135, 'count': 129, 'status': True, 'gradient': 27.718422091700816}, [0.6505701073405387, -2.2222386832495074e-06]), ({'reward': 1445.545664914271, 'duration': 21.635252629006885, 'time_stamp': 135, 'count': 85, 'status': True, 'gradient': 22.089529764873788}, [1.0, -2.2222386832495074e-06]), ({'reward': 728.3902287920554, 'duration': 15.972045438625893, 'time_stamp': 135, 'count': 132, 'status': True, 'gradient': 21.45540765036331}, [0.5038825754578854, -2.2222386832495074e-06])]
2021-08-18:16:01:34,107 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 27, 103, 12, 79, 36, 50]
2021-08-18:16:01:34,403 INFO     [param_server.py:553] For epoch: 136, median_reward: 368.70836483929634, dev: 737.4167296785927
2021-08-18:16:01:34,935 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.603, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:01:34,936 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1946.3553, eval_time 0.5091, test_loss 2.603, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:01:35,3 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:35,17 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:35,22 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0331, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:01:35,22 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4235, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:01:35,23 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1946.4399, eval_time 0.5962, test_loss 3.0331, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:01:35,23 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1946.4371, eval_time 0.5962, test_loss 2.4235, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:01:35,94 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:35,103 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:35,140 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:35,149 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:36,298 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:36,313 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:37,26 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:37,46 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:37,259 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:37,270 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:37,884 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:37,904 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:38,819 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:38,831 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:38,920 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:38,931 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:38,935 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:38,941 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:39,417 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:39,431 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:39,483 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:39,492 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:39,913 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:39,933 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:40,36 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:40,56 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:40,73 INFO     [learner.py:606] ====Pushing takes 0.016638755798339844 s
2021-08-18:16:01:40,77 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:40,103 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:40,108 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:40,109 INFO     [param_server.py:410] Lock worker 1 with localStep 136 , while globalStep is 135

2021-08-18:16:01:40,502 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:40,514 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:40,831 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:40,840 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:41,109 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:41,134 INFO     [learner.py:606] ====Pushing takes 0.023383617401123047 s
2021-08-18:16:01:41,155 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:41,161 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:41,161 INFO     [param_server.py:410] Lock worker 2 with localStep 136 , while globalStep is 135

2021-08-18:16:01:42,530 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:42,544 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:43,222 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:43,241 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:43,886 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:43,901 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:44,476 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:44,490 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:45,83 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:45,122 INFO     [learner.py:606] ====Pushing takes 0.0387420654296875 s
2021-08-18:16:01:45,161 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:45,171 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:45,172 INFO     [param_server.py:381] ====After aggregation in epoch: 135, virtual_clock: 4437.386649367585, top_1: : 61.4392 % (1904.0), top_5: : 100.0 % (3099.0), test loss: 2.686521887779236, test len: 3099.0
2021-08-18:16:01:45,174 INFO     [param_server.py:410] Lock worker 3 with localStep 136 , while globalStep is 136

2021-08-18:16:01:45,174 INFO     [param_server.py:441] ====Epoch 137 completes 20 clients with loss 5.366182007632953, sampled rewards are: 
 {3: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:45,175 INFO     [param_server.py:450] ====Start to sample for epoch 137, global virtualClock: 4437.386649367585, round_duration: 28.923500987268568
2021-08-18:16:01:45,175 INFO     [oort.py:208] Training selector: Pacer 135: lastExploitationUtil 252.57952979079255, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:01:45,176 INFO     [oort.py:321] scores are 26,{3: 0.016248525886758413, 5: 0.005610183864121273, 6: 0.2500177140364085, 7: 0.06005681143416507, 11: 0.010328644315338528, 12: 0.011060442924184859, 27: 0.09347437321167616, 36: 0.009884591574970632, 50: 0.002564291468842288, 51: 0.03377698048614595, 53: 0.19757562483884855, 58: 0.0021409704577024006, 60: 0.0009553805375701857, 67: 0.0011693713570868382, 70: 0.004564815990734561, 79: 0.01693804003086357, 81: 0.015744524900738906, 84: 0.3462403004388816, 85: 0.006686973197988332, 87: 0.007150328961955407, 93: 0.02936968355426232, 97: 0.07417165336573635, 103: 0.0038929466123438683, 105: 0.010647892692401446, 110: 0.06861412132605414, 113: 0.06005681143416507, 119: 0.008561034711215517},[84, 6, 53, 27, 97, 110, 7, 113, 51, 93, 79, 3, 81, 12, 105, 11, 36, 119, 87, 85, 5, 70, 103, 50, 58, 67, 60]
2021-08-18:16:01:45,176 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:45,177 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:45,200 INFO     [oort.py:398] At round 135, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 495.5450726724534, 'duration': 11.90395711384456, 'time_stamp': 136, 'count': 133, 'status': True, 'gradient': 21.360590392997675}, [0.37526467254786156, -2.205898572783625e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 136, 'count': 60, 'status': True, 'gradient': 21.465096684678244}, [7.572918359766157e-09, -2.205898572783625e-06]), ({'reward': 0.01, 'duration': 29.570969934622333, 'time_stamp': 135, 'count': 117, 'status': True, 'gradient': 11.897019545962848}, [7.572918359766157e-09, 0.0022036926742108397])]
2021-08-18:16:01:45,201 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:45,498 INFO     [param_server.py:553] For epoch: 137, median_reward: 305.25636970028694, dev: 610.5127394005739
2021-08-18:16:01:46,105 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8312, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:01:46,109 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1957.5262, eval_time 0.5769, test_loss 2.8312, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:01:46,124 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7396, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:01:46,125 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1957.5451, eval_time 0.5933, test_loss 2.7396, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:01:46,146 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4135, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:01:46,147 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1957.561, eval_time 0.6145, test_loss 2.4135, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:01:46,189 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:46,192 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:46,198 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:46,214 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:46,234 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:46,249 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:47,478 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:47,487 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:48,127 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:48,136 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:48,472 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:48,481 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:49,184 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:49,211 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:49,596 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:49,615 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:50,124 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:50,136 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:50,281 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:50,307 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:50,762 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:50,772 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:50,871 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:50,905 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:51,409 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:51,431 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:51,457 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:51,473 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:51,490 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:51,494 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:51,690 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:51,707 INFO     [learner.py:606] ====Pushing takes 0.016161680221557617 s
2021-08-18:16:01:51,731 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:51,741 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:51,742 INFO     [param_server.py:410] Lock worker 1 with localStep 137 , while globalStep is 136

2021-08-18:16:01:52,11 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:52,34 INFO     [learner.py:606] ====Pushing takes 0.021420001983642578 s
2021-08-18:16:01:52,47 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:52,56 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:52,61 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:52,62 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:52,63 INFO     [param_server.py:410] Lock worker 2 with localStep 137 , while globalStep is 136

2021-08-18:16:01:53,118 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:53,129 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:53,759 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:53,768 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:54,337 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:54,351 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:54,944 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:54,957 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:55,569 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:55,609 INFO     [learner.py:606] ====Pushing takes 0.038654327392578125 s
2021-08-18:16:01:55,652 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:55,662 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:55,663 INFO     [param_server.py:381] ====After aggregation in epoch: 136, virtual_clock: 4465.950030439622, top_1: : 61.4714 % (1905.0), top_5: : 100.0 % (3099.0), test loss: 2.6614310697272976, test len: 3099.0
2021-08-18:16:01:55,677 INFO     [param_server.py:410] Lock worker 3 with localStep 137 , while globalStep is 137

2021-08-18:16:01:55,677 INFO     [param_server.py:441] ====Epoch 138 completes 20 clients with loss 5.746174431090356, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:55,678 INFO     [param_server.py:450] ====Start to sample for epoch 138, global virtualClock: 4465.950030439622, round_duration: 28.563381072037195
2021-08-18:16:01:55,678 INFO     [oort.py:208] Training selector: Pacer 136: lastExploitationUtil 420.73843197575655, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:01:55,679 INFO     [oort.py:321] scores are 26,{3: 0.10086586349274661, 5: 0.039311754326538564, 6: 0.18199364261279619, 7: 0.05988222050662011, 11: 0.024643039492884555, 12: 0.02682915531883463, 27: 0.005280333099123581, 36: 0.039657745154690324, 50: 0.015368988059325968, 51: 0.03367878755495431, 53: 0.03985062413297418, 58: 0.0020464958827222787, 60: 0.0013682909452179717, 67: 0.0016747674634115387, 70: 0.006537705281911765, 79: 0.01999981050950494, 81: 0.01569875405242825, 84: 0.027557496054292377, 85: 0.033647425641034956, 87: 0.08154224376490031, 93: 0.18427951320948954, 97: 0.2586204120933769, 103: 0.01641726500979905, 105: 0.0152498555117313, 110: 0.04165787932919764, 113: 0.16964976242386434, 119: 0.01226106856524947},[97, 93, 6, 113, 3, 87, 7, 110, 53, 36, 5, 51, 85, 84, 12, 11, 79, 103, 81, 50, 105, 119, 70, 27, 58, 67, 60]
2021-08-18:16:01:55,680 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:55,680 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:55,681 INFO     [oort.py:398] At round 136, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 438.7796932285454, 'duration': 17.343863580585587, 'time_stamp': 137, 'count': 28, 'status': True, 'gradient': 15.310088077581234}, [0.3129320459709199, -2.1897970058175624e-06]), ({'reward': 466.2936829434608, 'duration': 27.689063957948644, 'time_stamp': 137, 'count': 129, 'status': True, 'gradient': 20.94170980235832}, [0.33255511709674596, -2.1897970058175624e-06]), ({'reward': 876.3445053259213, 'duration': 26.145070720211294, 'time_stamp': 137, 'count': 131, 'status': True, 'gradient': 15.309838013982974}, [0.625004759485486, -2.1897970058175624e-06])]
2021-08-18:16:01:55,681 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:56,1 INFO     [param_server.py:553] For epoch: 138, median_reward: 343.7956928165355, dev: 687.591385633071
2021-08-18:16:01:56,566 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.584, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:01:56,567 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1967.9838, eval_time 0.5321, test_loss 2.584, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:01:56,590 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6176, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:01:56,591 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1968.0104, eval_time 0.5562, test_loss 2.6176, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:01:56,595 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6663, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:01:56,596 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1968.0099, eval_time 0.5607, test_loss 2.6663, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:01:56,668 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:01:56,678 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:56,680 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:01:56,681 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:01:56,700 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:56,701 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:57,763 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:57,775 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:58,381 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:58,391 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:58,960 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:58,974 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:59,585 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:59,604 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:59,605 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:59,632 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:00,663 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:00,684 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:00,744 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:00,758 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:01,201 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:01,223 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:01,269 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:01,287 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:01,339 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:01,348 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:01,726 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:01,754 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:01,897 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:01,913 INFO     [learner.py:606] ====Pushing takes 0.015477180480957031 s
2021-08-18:16:02:01,937 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:01,943 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:01,944 INFO     [param_server.py:410] Lock worker 1 with localStep 138 , while globalStep is 137

2021-08-18:16:02:01,953 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:01,961 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:01,971 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:01,974 INFO     [learner.py:606] ====Pushing takes 0.019843101501464844 s
2021-08-18:16:02:01,997 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:02,3 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:02,4 INFO     [param_server.py:410] Lock worker 2 with localStep 138 , while globalStep is 137

2021-08-18:16:02:02,461 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:02,470 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:03,756 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:03,767 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:04,399 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:04,408 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:04,997 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:05,8 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:05,570 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:05,581 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:06,192 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:06,230 INFO     [learner.py:606] ====Pushing takes 0.036305904388427734 s
2021-08-18:16:02:06,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:06,280 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:06,281 INFO     [param_server.py:381] ====After aggregation in epoch: 137, virtual_clock: 4493.965885935111, top_1: : 61.6005 % (1909.0), top_5: : 100.0 % (3099.0), test loss: 2.6226030367392084, test len: 3099.0
2021-08-18:16:02:06,283 INFO     [param_server.py:410] Lock worker 3 with localStep 138 , while globalStep is 138

2021-08-18:16:02:06,284 INFO     [param_server.py:441] ====Epoch 139 completes 20 clients with loss 7.160927617176928, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:06,284 INFO     [param_server.py:450] ====Start to sample for epoch 139, global virtualClock: 4493.965885935111, round_duration: 28.015855495488744
2021-08-18:16:02:06,284 INFO     [oort.py:208] Training selector: Pacer 137: lastExploitationUtil 670.1710847616132, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:02:06,285 INFO     [oort.py:321] scores are 26,{3: 0.18487917858704217, 5: 0.09862772385727248, 6: 0.2918973333086344, 7: 0.059709330904780186, 11: 0.0882129203317511, 12: 0.04082846020049151, 27: 0.00526508792819695, 36: 0.0025870626756124937, 50: 0.017589024320320338, 51: 0.033581551478510156, 53: 0.5957677505353179, 58: 0.00350920883471258, 60: 0.0010684067596191812, 67: 0.0019166860909200722, 70: 0.007482070827223736, 79: 0.0035023832182367607, 81: 0.11829058377537686, 84: 0.18730005969911123, 85: 0.03764109550471609, 87: 0.09349498770481077, 93: 0.010381537018310585, 97: 0.019048664126651092, 103: 0.047487506458392253, 105: 0.017452683185243924, 110: 0.012311947820951585, 113: 0.478717613981049, 119: 0.01403216869938451},[53, 113, 6, 84, 3, 81, 5, 87, 11, 7, 103, 12, 85, 51, 97, 50, 105, 119, 110, 93, 70, 27, 58, 79, 36, 67, 60]
2021-08-18:16:02:06,286 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:02:06,286 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:06,287 INFO     [oort.py:398] At round 137, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1589.7030824398867, 'duration': 11.058674649423494, 'time_stamp': 138, 'count': 135, 'status': True, 'gradient': 18.718531276014414}, [0.8355312529991777, -2.1739287965854843e-06]), ({'reward': 744.8927240277716, 'duration': 17.619275735353515, 'time_stamp': 138, 'count': 134, 'status': True, 'gradient': 13.614446126351654}, [0.39150500625529505, -2.1739287965854843e-06]), ({'reward': 862.298169116668, 'duration': 21.753601635627824, 'time_stamp': 138, 'count': 132, 'status': True, 'gradient': 21.693419871233925}, [0.45321246356926786, -2.1739287965854843e-06])]
2021-08-18:16:02:06,287 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:06,584 INFO     [param_server.py:553] For epoch: 139, median_reward: 399.240971688598, dev: 798.481943377196
2021-08-18:16:02:07,138 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5505, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:02:07,139 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1978.5591, eval_time 0.5336, test_loss 2.5505, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:02:07,260 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:02:07,278 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:07,309 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7399, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:02:07,313 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1978.7303, eval_time 0.7073, test_loss 2.7399, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:02:07,345 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6255, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:02:07,346 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1978.7601, eval_time 0.7398, test_loss 2.6255, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:02:07,383 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:02:07,392 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:07,415 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:02:07,428 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:08,452 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:08,461 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:09,107 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:09,117 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:09,529 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:09,538 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:10,140 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:10,160 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:10,162 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:10,173 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:11,184 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:11,211 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:11,555 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:11,569 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:11,781 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:11,814 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:11,903 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:11,921 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:12,323 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:12,330 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:12,349 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:12,356 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:12,556 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:12,576 INFO     [learner.py:606] ====Pushing takes 0.018767118453979492 s
2021-08-18:16:02:12,600 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:12,604 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:12,611 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:12,612 INFO     [param_server.py:410] Lock worker 1 with localStep 139 , while globalStep is 138

2021-08-18:16:02:12,626 INFO     [learner.py:606] ====Pushing takes 0.025202035903930664 s
2021-08-18:16:02:12,648 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:12,653 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:12,654 INFO     [param_server.py:410] Lock worker 2 with localStep 139 , while globalStep is 138

2021-08-18:16:02:12,881 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:12,899 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:13,377 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:13,386 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:14,467 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:14,477 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:15,72 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:15,81 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:15,589 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:15,599 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:16,123 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:16,137 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:16,756 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:16,798 INFO     [learner.py:606] ====Pushing takes 0.04029703140258789 s
2021-08-18:16:02:16,839 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:16,849 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:16,850 INFO     [param_server.py:381] ====After aggregation in epoch: 138, virtual_clock: 4521.9817414306, top_1: : 61.3746 % (1902.0), top_5: : 100.0 % (3099.0), test loss: 2.6386457637504295, test len: 3099.0
2021-08-18:16:02:16,852 INFO     [param_server.py:410] Lock worker 3 with localStep 139 , while globalStep is 139

2021-08-18:16:02:16,853 INFO     [param_server.py:441] ====Epoch 140 completes 20 clients with loss 5.825586950568505, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:16,854 INFO     [param_server.py:450] ====Start to sample for epoch 140, global virtualClock: 4521.9817414306, round_duration: 28.015855495488744
2021-08-18:16:02:16,854 INFO     [oort.py:208] Training selector: Pacer 138: lastExploitationUtil 472.2834295039945, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:02:16,855 INFO     [oort.py:321] scores are 26,{3: 0.14799794002815367, 5: 0.005541245017589965, 6: 0.03419446286264268, 7: 0.9448113366566803, 11: 0.010239438710239423, 12: 0.005182289180588204, 27: 0.09340622815066871, 36: 0.002579644411760651, 50: 0.013084691446872581, 51: 0.03348525817577336, 53: 0.03962162935292624, 58: 0.002610543597452774, 60: 0.0010641270266648977, 67: 0.001425846348465607, 70: 0.005566004479552978, 79: 0.03425591677579413, 81: 0.117601598580033, 84: 0.027399141627356238, 85: 0.011091927638991172, 87: 0.007088573575455976, 93: 0.01035176851617282, 97: 0.02916372887677774, 103: 0.06868039122752556, 105: 0.012983265600191009, 110: 0.006320070812723525, 113: 0.409976568890848, 119: 0.010438702819336697},[7, 113, 3, 81, 27, 103, 53, 79, 6, 51, 97, 84, 50, 105, 85, 119, 93, 11, 87, 110, 70, 5, 12, 58, 36, 67, 60]
2021-08-18:16:02:16,856 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:02:16,856 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:16,856 INFO     [oort.py:398] At round 138, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 670.3058096510157, 'duration': 8.009219946401625, 'time_stamp': 139, 'count': 63, 'status': True, 'gradient': 21.49053981018955}, [0.35043845652696715, -2.1582889085533007e-06]), ({'reward': 1693.3028647983347, 'duration': 5.8943907365129, 'time_stamp': 139, 'count': 136, 'status': True, 'gradient': 21.699223482245024}, [0.8852732242927994, -2.1582889085533007e-06]), ({'reward': 60.98333735200231, 'duration': 15.972045438625893, 'time_stamp': 139, 'count': 136, 'status': True, 'gradient': 21.489673467640287}, [0.03187757570447493, -2.1582889085533007e-06])]
2021-08-18:16:02:16,857 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 50]
2021-08-18:16:02:17,122 INFO     [param_server.py:553] For epoch: 140, median_reward: 356.36514814306804, dev: 712.7302962861361
2021-08-18:16:02:17,710 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7955, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:17,714 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1989.1334, eval_time 0.5566, test_loss 2.7955, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:17,798 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:02:17,800 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7707, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:02:17,801 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1989.2149, eval_time 0.6429, test_loss 2.7707, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:02:17,809 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5353, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:02:17,810 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1989.2267, eval_time 0.6519, test_loss 2.5353, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:02:17,818 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:17,871 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:02:17,879 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:02:17,881 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:17,888 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:18,958 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:18,967 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:19,690 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:19,699 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:20,145 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:20,160 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:20,704 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:20,724 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:21,129 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:21,139 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:21,748 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:21,768 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:22,18 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:22,32 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:22,289 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:22,310 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:22,666 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:22,677 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:22,835 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:22,863 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:22,958 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:22,977 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:23,25 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:23,42 INFO     [learner.py:606] ====Pushing takes 0.016731977462768555 s
2021-08-18:16:02:23,68 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:23,74 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:23,75 INFO     [param_server.py:410] Lock worker 1 with localStep 140 , while globalStep is 139

2021-08-18:16:02:23,343 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:23,358 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:23,618 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:23,639 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:02:24,37 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:24,56 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:24,238 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:02:24,262 INFO     [learner.py:606] ====Pushing takes 0.022186756134033203 s
2021-08-18:16:02:24,289 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:24,296 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:02:24,297 INFO     [param_server.py:410] Lock worker 2 with localStep 140 , while globalStep is 139

2021-08-18:16:02:25,673 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:25,687 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:26,198 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:26,207 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:26,744 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:26,754 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:27,314 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:27,351 INFO     [learner.py:606] ====Pushing takes 0.035384178161621094 s
2021-08-18:16:02:27,390 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:27,405 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:27,406 INFO     [param_server.py:381] ====After aggregation in epoch: 139, virtual_clock: 4550.905242417868, top_1: : 61.8909 % (1918.0), top_5: : 100.0 % (3099.0), test loss: 2.700470659467909, test len: 3099.0
2021-08-18:16:02:27,428 INFO     [param_server.py:410] Lock worker 3 with localStep 140 , while globalStep is 140

2021-08-18:16:02:27,429 INFO     [param_server.py:441] ====Epoch 141 completes 20 clients with loss 9.431278554801558, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:27,429 INFO     [param_server.py:450] ====Start to sample for epoch 141, global virtualClock: 4550.905242417868, round_duration: 28.923500987268568
2021-08-18:16:02:27,430 INFO     [oort.py:208] Training selector: Pacer 139: lastExploitationUtil 464.1121452934765, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:16:02:27,430 INFO     [oort.py:321] scores are 26,{3: 0.016062315020457664, 5: 0.005525463285786728, 6: 0.0340970753909931, 7: 0.05936855017512186, 11: 0.024651442095993157, 12: 0.0029070196215712466, 27: 0.04590326320346453, 36: 0.0025815337462845134, 50: 0.045232666531016374, 51: 0.05522555548912518, 53: 0.2737324521744583, 58: 0.0022103522989265667, 60: 0.0009863412920859153, 67: 0.0012072668532799782, 70: 0.004712746728007118, 79: 0.0026497531447914856, 81: 0.061822242321577826, 84: 0.05872347427232583, 85: 0.012811905071308928, 87: 0.030495460609247734, 93: 0.11406841289862922, 97: 0.20168320457364297, 103: 0.026851187074836785, 105: 0.010992956024545213, 110: 0.0063020709476702295, 113: 0.10392651571794115, 119: 0.008838469810289963},[53, 97, 93, 113, 81, 7, 84, 51, 27, 50, 6, 87, 103, 11, 3, 85, 105, 119, 110, 5, 70, 12, 79, 36, 58, 67, 60]
2021-08-18:16:02:27,431 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:02:27,431 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:27,432 INFO     [oort.py:398] At round 139, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 409.25531219561765, 'duration': 17.619275735353515, 'time_stamp': 140, 'count': 136, 'status': True, 'gradient': 15.327629781433188}, [0.1764497321062266, -2.142872449088924e-06]), ({'reward': 158.27440299965673, 'duration': 13.298442137908651, 'time_stamp': 140, 'count': 137, 'status': True, 'gradient': 18.733582256679348}, [0.06823709829086394, -2.142872449088924e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 140, 'count': 137, 'status': True, 'gradient': 21.71354683685031}, [4.31158824637407e-09, -2.142872449088924e-06])]
2021-08-18:16:02:27,432 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:27,734 INFO     [param_server.py:541] Handle Wight 0.06828641891479492 | Send 0.3050704002380371
2021-08-18:16:02:27,738 INFO     [param_server.py:553] For epoch: 141, median_reward: 351.08861266971485, dev: 702.1772253394297
2021-08-18:16:02:28,329 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6654, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:28,331 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1999.7502, eval_time 0.5622, test_loss 2.6654, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:28,410 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7717, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:02:28,412 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1999.8257, eval_time 0.643, test_loss 2.7717, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:02:28,415 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8064, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:02:28,416 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1999.8329, eval_time 0.6475, test_loss 2.8064, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:02:28,425 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:28,447 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:28,484 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:28,488 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:28,495 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:28,497 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:29,758 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:29,769 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:30,355 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:30,364 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:30,756 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:30,765 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:31,317 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:31,338 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:31,636 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:31,651 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:32,410 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:32,431 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:32,588 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:32,602 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:32,964 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:32,987 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:33,198 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:33,211 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:33,495 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:33,522 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:33,548 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:33,558 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:33,683 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:33,699 INFO     [learner.py:606] ====Pushing takes 0.015209197998046875 s
2021-08-18:16:02:33,723 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:33,730 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:33,731 INFO     [param_server.py:410] Lock worker 1 with localStep 141 , while globalStep is 140

2021-08-18:16:02:33,760 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:33,769 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:34,159 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:34,181 INFO     [learner.py:606] ====Pushing takes 0.019977092742919922 s
2021-08-18:16:02:34,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:34,208 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:34,209 INFO     [param_server.py:410] Lock worker 2 with localStep 141 , while globalStep is 140

2021-08-18:16:02:34,465 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:34,474 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:35,523 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:35,532 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:36,159 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:36,172 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:36,672 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:36,685 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:37,261 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:37,279 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:37,879 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:37,924 INFO     [learner.py:606] ====Pushing takes 0.04067230224609375 s
2021-08-18:16:02:37,969 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:37,980 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:37,980 INFO     [param_server.py:381] ====After aggregation in epoch: 140, virtual_clock: 4579.588645440884, top_1: : 61.4069 % (1903.0), top_5: : 100.0 % (3099.0), test loss: 2.7478348988073846, test len: 3099.0
2021-08-18:16:02:37,982 INFO     [param_server.py:410] Lock worker 3 with localStep 141 , while globalStep is 141

2021-08-18:16:02:37,982 INFO     [param_server.py:441] ====Epoch 142 completes 20 clients with loss 4.882540960834781, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:37,983 INFO     [param_server.py:450] ====Start to sample for epoch 142, global virtualClock: 4579.588645440884, round_duration: 28.683403023015895
2021-08-18:16:02:37,984 INFO     [oort.py:208] Training selector: Pacer 140: lastExploitationUtil 272.170517417764, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:02:37,984 INFO     [oort.py:321] scores are 26,{3: 0.02820211367802151, 5: 0.13552863094659737, 6: 0.19306714043182457, 7: 0.25129938325626144, 11: 0.01399741334127794, 12: 0.004409244196776227, 27: 0.07158605550366842, 36: 0.003526399261399292, 50: 0.015433745531625643, 51: 0.2749324287963253, 53: 0.054163156692682776, 58: 0.00307920639519021, 60: 0.0021260174130777274, 67: 0.0016818241223927044, 70: 0.006565252005681906, 79: 0.06346847337254449, 81: 0.1947588680761209, 84: 0.10266479636240716, 85: 0.009062208456078689, 87: 0.009690149738041423, 93: 0.014150969289869435, 97: 0.025965043576287608, 103: 0.01137573047409487, 105: 0.015314111017172713, 110: 0.04053647520106353, 113: 0.05920060662093955, 119: 0.012312730770003204},[51, 7, 81, 6, 5, 84, 27, 79, 113, 53, 110, 3, 97, 50, 105, 93, 11, 119, 103, 87, 85, 70, 12, 36, 58, 60, 67]
2021-08-18:16:02:37,985 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:02:37,986 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:37,986 INFO     [oort.py:398] At round 140, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 0.01, 'duration': 21.635252629006885, 'time_stamp': 141, 'count': 91, 'status': True, 'gradient': 22.145862669693926}, [7.48528229182836e-09, -2.1276746643593236e-06]), ({'reward': 1335.9649493629267, 'duration': 29.570969934622333, 'time_stamp': 141, 'count': 122, 'status': True, 'gradient': 11.924281434817185}, [1.0, -2.1276746643593236e-06]), ({'reward': 395.9480482236954, 'duration': 12.029357192292537, 'time_stamp': 141, 'count': 135, 'status': True, 'gradient': 27.7823719724717}, [0.29637081358828543, -2.1276746643593236e-06])]
2021-08-18:16:02:37,987 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:38,310 INFO     [param_server.py:553] For epoch: 142, median_reward: 313.36863276478863, dev: 626.7372655295773
2021-08-18:16:02:38,904 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.744, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,905 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 2010.3245, eval_time 0.5611, test_loss 2.744, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:02:38,933 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5155, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,934 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 2010.3514, eval_time 0.5904, test_loss 2.5155, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:16:02:38,947 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3871, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,949 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 2010.3629, eval_time 0.6033, test_loss 2.3871, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:02:38,982 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:39,0 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:39,6 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:39,14 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:39,18 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:39,25 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:40,29 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:40,39 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:40,724 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:40,733 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:40,998 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:41,8 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:41,885 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:41,905 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:41,977 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:41,988 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:42,517 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:42,538 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:42,760 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:42,770 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:43,50 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:43,70 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:43,219 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:43,231 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:43,422 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:43,431 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:43,567 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:43,592 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:43,755 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:43,772 INFO     [learner.py:606] ====Pushing takes 0.016338109970092773 s
2021-08-18:16:02:43,795 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:43,803 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:43,804 INFO     [param_server.py:410] Lock worker 1 with localStep 142 , while globalStep is 141

2021-08-18:16:02:43,807 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:43,831 INFO     [learner.py:606] ====Pushing takes 0.02275252342224121 s
2021-08-18:16:02:43,854 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:43,860 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:43,860 INFO     [param_server.py:410] Lock worker 2 with localStep 142 , while globalStep is 141

2021-08-18:16:02:44,17 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:44,31 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:44,694 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:44,708 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:46,210 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:46,231 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:46,761 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:46,775 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:47,310 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:47,319 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:47,829 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:47,841 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:48,314 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:48,357 INFO     [learner.py:606] ====Pushing takes 0.04159832000732422 s
2021-08-18:16:02:48,407 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:48,418 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:48,418 INFO     [param_server.py:381] ====After aggregation in epoch: 141, virtual_clock: 4606.9369534088455, top_1: : 59.9871 % (1859.0), top_5: : 100.0 % (3099.0), test loss: 2.5488294009809143, test len: 3099.0
2021-08-18:16:02:48,420 INFO     [param_server.py:410] Lock worker 3 with localStep 142 , while globalStep is 142

2021-08-18:16:02:48,421 INFO     [param_server.py:441] ====Epoch 143 completes 20 clients with loss 5.055023875964487, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:48,421 INFO     [param_server.py:450] ====Start to sample for epoch 143, global virtualClock: 4606.9369534088455, round_duration: 27.34830796796159
2021-08-18:16:02:48,421 INFO     [oort.py:208] Training selector: Pacer 141: lastExploitationUtil 475.7627046506924, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:02:48,422 INFO     [oort.py:321] scores are 26,{3: 0.13822628959227323, 5: 0.007553650745247752, 6: 0.6300582890506853, 7: 0.059034252313671695, 11: 0.013958080467295082, 12: 0.003974075981540968, 27: 0.1191406646381521, 36: 0.031195920405923266, 50: 0.021676440857005534, 51: 0.2995216625037034, 53: 0.05401095767099463, 58: 0.004324694558108564, 60: 0.0018923312465188584, 67: 0.002362094220500652, 70: 0.009220788079010856, 79: 0.058477290422638495, 81: 0.021277075555548537, 84: 0.12554485221472222, 85: 0.009036743558063696, 87: 0.08167725749629098, 93: 0.22069425285233335, 97: 0.4644862934743027, 103: 0.005260909409890795, 105: 0.02150841615608756, 110: 0.008615321548317104, 113: 0.15787213568034492, 119: 0.017293027138312184},[6, 97, 51, 93, 113, 3, 84, 27, 87, 7, 79, 53, 36, 50, 105, 81, 119, 11, 70, 85, 110, 5, 103, 58, 12, 67, 60]
2021-08-18:16:02:48,423 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:02:48,423 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:48,424 INFO     [oort.py:398] At round 141, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1533.5431704836683, 'duration': 15.972045438625893, 'time_stamp': 142, 'count': 139, 'status': True, 'gradient': 20.448281089951138}, [1.0, -2.112690934443202e-06]), ({'reward': 503.5280345747649, 'duration': 12.029357192292537, 'time_stamp': 142, 'count': 136, 'status': True, 'gradient': 27.78835746976945}, [0.3283385393826027, -2.112690934443202e-06]), ({'reward': 1325.3515889252167, 'duration': 21.635252629006885, 'time_stamp': 142, 'count': 92, 'status': True, 'gradient': 22.144973604659608}, [0.8642405758101764, -2.112690934443202e-06])]
2021-08-18:16:02:48,424 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:48,757 INFO     [param_server.py:553] For epoch: 143, median_reward: 357.4804429920793, dev: 714.9608859841586
2021-08-18:16:02:49,288 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9157, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:02:49,290 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2020.7095, eval_time 0.5083, test_loss 2.9157, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:02:49,353 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:49,365 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:49,391 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.738, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:02:49,392 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2020.8086, eval_time 0.61, test_loss 2.738, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:02:49,436 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5142, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:02:49,436 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2020.8506, eval_time 0.6545, test_loss 2.5142, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:02:49,461 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:49,470 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:49,504 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:49,517 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:50,572 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:50,581 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:51,338 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:51,347 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:51,744 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:51,759 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:52,16 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:52,44 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:52,450 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:52,462 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:53,57 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:53,77 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:53,522 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:53,532 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:53,595 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:53,616 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:54,130 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:54,141 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:54,141 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:54,175 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:54,176 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:54,186 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:54,374 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:54,390 INFO     [learner.py:606] ====Pushing takes 0.015829086303710938 s
2021-08-18:16:02:54,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:54,420 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:54,421 INFO     [param_server.py:410] Lock worker 1 with localStep 143 , while globalStep is 142

2021-08-18:16:02:54,678 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:54,689 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:54,693 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:54,715 INFO     [learner.py:606] ====Pushing takes 0.021184921264648438 s
2021-08-18:16:02:54,739 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:54,745 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:54,746 INFO     [param_server.py:410] Lock worker 2 with localStep 143 , while globalStep is 142

2021-08-18:16:02:55,248 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:55,257 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:56,424 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:56,433 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:57,30 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:57,39 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:57,628 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:57,647 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:58,170 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:58,188 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:58,739 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:58,791 INFO     [learner.py:606] ====Pushing takes 0.03655505180358887 s
2021-08-18:16:02:58,831 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:58,845 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:58,847 INFO     [param_server.py:381] ====After aggregation in epoch: 142, virtual_clock: 4635.620356431861, top_1: : 61.8909 % (1918.0), top_5: : 100.0 % (3099.0), test loss: 2.722615599632263, test len: 3099.0
2021-08-18:16:02:58,849 INFO     [param_server.py:410] Lock worker 3 with localStep 143 , while globalStep is 143

2021-08-18:16:02:58,850 INFO     [param_server.py:441] ====Epoch 144 completes 20 clients with loss 5.598976413729292, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:58,851 INFO     [param_server.py:450] ====Start to sample for epoch 144, global virtualClock: 4635.620356431861, round_duration: 28.683403023015895
2021-08-18:16:02:58,852 INFO     [oort.py:208] Training selector: Pacer 142: lastExploitationUtil 394.12462704083794, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:02:58,853 INFO     [oort.py:321] scores are 26,{3: 0.03747298589071409, 5: 0.007532565955613799, 6: 0.04648270307701852, 7: 0.05886946778322268, 11: 0.016944551203940318, 12: 0.028631869806708513, 27: 0.007136645304550689, 36: 0.034178723360846944, 50: 0.021338364760239165, 51: 0.20877788612473908, 53: 0.05386019485195144, 58: 0.004257244561794268, 60: 0.002185744049213506, 67: 0.0023252538738990475, 70: 0.009076976275983499, 79: 0.049900164146558325, 81: 0.25592894182006626, 84: 0.39668399441371793, 85: 0.14164090733038134, 87: 0.17331923111288738, 93: 0.014071815784682936, 97: 0.27168857706843214, 103: 0.038861409620776145, 105: 0.02117296065259208, 110: 0.03306415377642157, 113: 0.05886946778322268, 119: 0.017023316849858347},[84, 97, 81, 51, 87, 85, 7, 113, 53, 79, 6, 103, 3, 36, 110, 12, 50, 105, 119, 11, 93, 70, 5, 27, 58, 67, 60]
2021-08-18:16:02:58,854 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:02:58,854 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:58,855 INFO     [oort.py:398] At round 142, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 725.2439209733213, 'duration': 15.972045438625893, 'time_stamp': 143, 'count': 140, 'status': True, 'gradient': 21.519086627016655}, [0.5605837107903597, -2.0979167686487338e-06]), ({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 143, 'count': 140, 'status': True, 'gradient': 21.41300928698274}, [7.72969502458316e-09, -2.0979167686487338e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 143, 'count': 140, 'status': True, 'gradient': 21.735911205514213}, [7.72969502458316e-09, -2.0979167686487338e-06])]
2021-08-18:16:02:58,857 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:59,211 INFO     [param_server.py:553] For epoch: 144, median_reward: 339.79212481154616, dev: 679.5842496230923
2021-08-18:16:02:59,785 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4992, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:02:59,786 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2031.206, eval_time 0.5524, test_loss 2.4992, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:02:59,813 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5445, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:02:59,813 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2031.2277, eval_time 0.5747, test_loss 2.5445, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:02:59,845 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:02:59,858 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8819, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:02:59,859 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2031.276, eval_time 0.6226, test_loss 2.8819, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:02:59,867 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:59,883 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:02:59,893 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:59,947 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:02:59,961 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:01,154 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:01,163 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:01,738 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:01,748 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:02,138 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:02,153 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:02,553 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:02,567 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:02,960 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:02,974 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:03,126 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:03,139 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:03,627 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:03,641 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:03,986 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:04,0 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:04,104 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:04,118 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:04,377 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:04,389 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:04,624 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:04,638 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:04,785 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:04,809 INFO     [learner.py:606] ====Pushing takes 0.021538972854614258 s
2021-08-18:16:03:04,832 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:04,839 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:04,840 INFO     [param_server.py:410] Lock worker 1 with localStep 144 , while globalStep is 143

2021-08-18:16:03:04,999 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:05,21 INFO     [learner.py:606] ====Pushing takes 0.020587682723999023 s
2021-08-18:16:03:05,42 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:05,48 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:05,49 INFO     [param_server.py:410] Lock worker 2 with localStep 144 , while globalStep is 143

2021-08-18:16:03:05,181 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:05,194 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:05,682 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:05,691 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:06,819 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:06,828 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:07,381 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:07,391 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:07,951 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:07,963 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:08,489 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:08,499 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:09,59 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:09,101 INFO     [learner.py:606] ====Pushing takes 0.04033994674682617 s
2021-08-18:16:03:09,146 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:09,157 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:09,158 INFO     [param_server.py:381] ====After aggregation in epoch: 143, virtual_clock: 4662.968664399823, top_1: : 62.2459 % (1929.0), top_5: : 100.0 % (3099.0), test loss: 2.6418717304865518, test len: 3099.0
2021-08-18:16:03:09,160 INFO     [param_server.py:410] Lock worker 3 with localStep 144 , while globalStep is 144

2021-08-18:16:03:09,160 INFO     [param_server.py:441] ====Epoch 145 completes 20 clients with loss 4.861519884678967, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:09,161 INFO     [param_server.py:450] ====Start to sample for epoch 145, global virtualClock: 4662.968664399823, round_duration: 27.34830796796159
2021-08-18:16:03:09,161 INFO     [oort.py:208] Training selector: Pacer 143: lastExploitationUtil 577.5115521380027, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:09,162 INFO     [oort.py:321] scores are 26,{3: 0.39379277015954667, 5: 0.0075116780767817614, 6: 0.4173512026168696, 7: 0.05870622217512468, 11: 0.054737893102939, 12: 0.0423627757641245, 27: 0.007116855317543992, 36: 0.026800057648900394, 50: 0.021923162694982037, 51: 0.5860061783931507, 53: 0.5258631557266499, 58: 0.004373918348909935, 60: 0.0019518048221712214, 67: 0.002388979641008569, 70: 0.006834952175245234, 79: 0.003602248640003358, 81: 0.03592636282035662, 84: 0.21169739268215035, 85: 0.00898652992571997, 87: 0.16271087167678489, 93: 0.04250858074715592, 97: 0.21386470800152094, 103: 0.0326771576498442, 105: 0.021753225532359234, 110: 0.008567449592454845, 113: 0.4260756867673099, 119: 0.017489856842408325},[51, 53, 113, 6, 3, 97, 84, 87, 7, 11, 93, 12, 81, 103, 36, 50, 105, 119, 85, 110, 5, 27, 70, 58, 79, 67, 60]
2021-08-18:16:03:09,163 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:03:09,163 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:09,164 INFO     [oort.py:398] At round 143, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 786.9324619033914, 'duration': 15.972045438625893, 'time_stamp': 144, 'count': 141, 'status': True, 'gradient': 20.461359677204626}, [0.42890784836638246, -2.083347801026398e-06]), ({'reward': 1834.7222129183017, 'duration': 17.343863580585587, 'time_stamp': 144, 'count': 35, 'status': True, 'gradient': 13.642933900688245}, [1.0, -2.083347801026398e-06]), ({'reward': 674.0272470142345, 'duration': 8.009219946401625, 'time_stamp': 144, 'count': 68, 'status': True, 'gradient': 21.52845915703175}, [0.36736947004263126, -2.083347801026398e-06])]
2021-08-18:16:03:09,164 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:09,436 INFO     [param_server.py:553] For epoch: 145, median_reward: 378.9428798430743, dev: 757.8857596861486
2021-08-18:16:03:10,86 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8578, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:03:10,87 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2041.5066, eval_time 0.5953, test_loss 2.8578, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:03:10,161 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:03:10,182 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:10,183 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.85, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:03:10,183 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2041.6005, eval_time 0.6917, test_loss 2.85, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:03:10,185 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4571, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:03:10,186 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2041.6, eval_time 0.6898, test_loss 2.4571, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:03:10,251 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:03:10,251 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:03:10,264 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:10,264 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:11,557 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:11,568 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:12,214 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:12,225 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:12,728 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:12,749 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:13,167 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:13,193 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:14,0 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:14,11 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:14,155 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:14,177 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:14,634 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:14,644 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:14,664 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:14,678 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:15,153 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:15,166 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:15,249 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:15,268 INFO     [learner.py:606] ====Pushing takes 0.017695903778076172 s
2021-08-18:16:03:15,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:15,303 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:15,304 INFO     [param_server.py:410] Lock worker 1 with localStep 145 , while globalStep is 144

2021-08-18:16:03:15,304 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:15,318 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:15,743 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:15,755 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:16,56 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:16,70 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:16,328 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:16,353 INFO     [learner.py:606] ====Pushing takes 0.023615360260009766 s
2021-08-18:16:03:16,375 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:16,381 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:16,382 INFO     [param_server.py:410] Lock worker 2 with localStep 145 , while globalStep is 144

2021-08-18:16:03:16,712 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:16,726 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:18,474 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:18,488 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:19,16 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:19,25 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:19,557 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:19,566 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:20,43 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:20,54 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:20,595 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:20,634 INFO     [learner.py:606] ====Pushing takes 0.03719639778137207 s
2021-08-18:16:03:20,679 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:20,690 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:20,691 INFO     [param_server.py:381] ====After aggregation in epoch: 144, virtual_clock: 4692.319614950366, top_1: : 61.6973 % (1912.0), top_5: : 100.0 % (3099.0), test loss: 2.721625363385236, test len: 3099.0
2021-08-18:16:03:20,693 INFO     [param_server.py:410] Lock worker 3 with localStep 145 , while globalStep is 145

2021-08-18:16:03:20,693 INFO     [param_server.py:441] ====Epoch 146 completes 20 clients with loss 5.697165239358977, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:20,710 INFO     [param_server.py:450] ====Start to sample for epoch 146, global virtualClock: 4692.319614950366, round_duration: 29.350950550543047
2021-08-18:16:03:20,710 INFO     [oort.py:208] Training selector: Pacer 144: lastExploitationUtil 470.8091587661566, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:20,711 INFO     [oort.py:321] scores are 26,{3: 0.021776012405994243, 5: 0.04190660700490892, 6: 0.04622610973428851, 7: 0.488137242703809, 11: 0.1483489720590789, 12: 0.024735848599412785, 27: 0.04350427863653068, 36: 0.04181251974355685, 50: 0.019920609002409353, 51: 0.04526736463538219, 53: 0.621226661554745, 58: 0.003974386289485597, 60: 0.0017735187779448207, 67: 0.0025791666063513796, 70: 0.008473887167536935, 79: 0.06495291831886991, 81: 0.021100558410925174, 84: 0.6399186139833196, 85: 0.0579127296906477, 87: 0.009582755584577171, 93: 0.013994136690924341, 97: 0.11264802578298151, 103: 0.005217264280900597, 105: 0.01976619461345066, 110: 0.008543847818022225, 113: 0.06329862470757505, 119: 0.015892259913095334},[84, 53, 7, 11, 97, 79, 113, 85, 6, 51, 27, 5, 36, 12, 3, 81, 50, 105, 119, 93, 87, 110, 70, 103, 58, 67, 60]
2021-08-18:16:03:20,712 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:03:20,713 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:20,713 INFO     [oort.py:398] At round 144, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 720.2508044617144, 'duration': 5.8943907365129, 'time_stamp': 145, 'count': 142, 'status': True, 'gradient': 21.74508674788707}, [0.4295927515198944, -2.0689797860674918e-06]), ({'reward': 1597.6111918268657, 'duration': 13.298442137908651, 'time_stamp': 145, 'count': 142, 'status': True, 'gradient': 18.765558006408753}, [0.9529005887249337, -2.0689797860674918e-06]), ({'reward': 1040.2514654693268, 'duration': 11.058674649423494, 'time_stamp': 145, 'count': 142, 'status': True, 'gradient': 20.471089152836083}, [0.6204594195706157, -2.0689797860674918e-06])]
2021-08-18:16:03:20,714 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:03:21,18 INFO     [param_server.py:553] For epoch: 146, median_reward: 357.35216928077574, dev: 714.7043385615515
2021-08-18:16:03:21,659 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6774, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:03:21,660 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2053.0801, eval_time 0.5979, test_loss 2.6774, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:03:21,728 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:21,757 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:21,792 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4452, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:03:21,794 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2053.2079, eval_time 0.7305, test_loss 2.4452, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:03:21,841 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7437, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:03:21,842 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2053.2588, eval_time 0.7791, test_loss 2.7437, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:03:21,878 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:21,886 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:21,909 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:21,923 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:22,974 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:22,992 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:23,653 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:23,671 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:24,113 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:24,153 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:24,857 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:24,877 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:25,241 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:25,256 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:25,891 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:25,925 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:26,144 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:26,158 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:26,438 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:26,452 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:26,760 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:26,771 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:26,960 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:26,980 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:27,0 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:27,18 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:27,104 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:27,122 INFO     [learner.py:606] ====Pushing takes 0.01703023910522461 s
2021-08-18:16:03:27,144 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:27,152 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:27,152 INFO     [param_server.py:410] Lock worker 1 with localStep 146 , while globalStep is 145

2021-08-18:16:03:27,308 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:27,317 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:27,672 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:27,686 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:03:27,950 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:27,962 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:28,222 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:03:28,247 INFO     [learner.py:606] ====Pushing takes 0.02400350570678711 s
2021-08-18:16:03:28,273 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:28,280 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:03:28,280 INFO     [param_server.py:410] Lock worker 2 with localStep 146 , while globalStep is 145

2021-08-18:16:03:28,544 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:28,553 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:29,137 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:29,150 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:29,757 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:29,770 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:30,421 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:30,457 INFO     [learner.py:606] ====Pushing takes 0.03472161293029785 s
2021-08-18:16:03:30,494 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:30,503 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:30,504 INFO     [param_server.py:381] ====After aggregation in epoch: 145, virtual_clock: 4722.295618223358, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 2.622075297214367, test len: 3099.0
2021-08-18:16:03:30,506 INFO     [param_server.py:410] Lock worker 3 with localStep 146 , while globalStep is 146

2021-08-18:16:03:30,507 INFO     [param_server.py:441] ====Epoch 147 completes 20 clients with loss 5.664391229475395, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:30,507 INFO     [param_server.py:450] ====Start to sample for epoch 147, global virtualClock: 4722.295618223358, round_duration: 29.976003272992685
2021-08-18:16:03:30,508 INFO     [oort.py:208] Training selector: Pacer 145: lastExploitationUtil 465.14518255208463, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:30,508 INFO     [oort.py:321] scores are 26,{3: 0.021716412840220925, 5: 0.0074704824114581, 6: 0.8356889083918002, 7: 0.2786721966174741, 11: 0.17492642199818378, 12: 0.02323839368472373, 27: 0.007077824945525697, 36: 0.02222447369889062, 50: 0.003427216263686876, 51: 0.0451434707274586, 53: 0.45436957220748353, 58: 0.003520389179339125, 60: 0.0015709284051600794, 67: 0.0019227926556891492, 70: 0.007505908716135077, 79: 0.022398743088549947, 81: 0.021042807519925523, 84: 0.29945280836251964, 85: 0.008937245854243941, 87: 0.06609217142135654, 93: 0.014003876505807535, 97: 0.02560700067562259, 103: 0.044623115887057085, 105: 0.017508287460127413, 110: 0.04675187532966923, 113: 0.1897357447552722, 119: 0.014076875209970328},[6, 53, 84, 7, 113, 11, 87, 110, 51, 103, 97, 12, 79, 36, 3, 81, 105, 119, 93, 85, 70, 5, 27, 58, 50, 67, 60]
2021-08-18:16:03:30,509 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:03:30,510 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:30,510 INFO     [oort.py:398] At round 145, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 796.835847409618, 'duration': 13.298442137908651, 'time_stamp': 146, 'count': 143, 'status': True, 'gradient': 20.480356667470396}, [0.4149260383289414, -2.0548085945794165e-06]), ({'reward': 1920.414553229453, 'duration': 11.90395711384456, 'time_stamp': 146, 'count': 143, 'status': True, 'gradient': 21.438594139321737}, [1.0, -2.0548085945794165e-06]), ({'reward': 841.6157700628339, 'duration': 11.058674649423494, 'time_stamp': 146, 'count': 143, 'status': True, 'gradient': 20.480688764372825}, [0.438244001382472, -2.0548085945794165e-06])]
2021-08-18:16:03:30,511 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:30,817 INFO     [param_server.py:553] For epoch: 147, median_reward: 351.31243826994415, dev: 702.6248765398883
2021-08-18:16:03:31,400 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7449, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:03:31,406 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2062.8253, eval_time 0.5537, test_loss 2.7449, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:03:31,434 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6169, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:03:31,435 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2062.8523, eval_time 0.5833, test_loss 2.6169, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:03:31,441 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6761, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:03:31,441 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2062.8556, eval_time 0.5869, test_loss 2.6761, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:03:31,488 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:31,504 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:31,510 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:31,515 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:31,525 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:31,536 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:32,676 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:32,687 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:33,311 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:33,321 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:33,651 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:33,662 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:34,469 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:34,490 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:34,582 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:34,592 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:35,109 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:35,131 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:35,437 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:35,446 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:35,651 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:35,672 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:35,825 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:35,834 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:35,979 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:35,989 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:36,146 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:36,166 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:36,288 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:36,306 INFO     [learner.py:606] ====Pushing takes 0.016476869583129883 s
2021-08-18:16:03:36,336 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:36,342 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:36,343 INFO     [param_server.py:410] Lock worker 1 with localStep 147 , while globalStep is 146

2021-08-18:16:03:36,421 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:36,445 INFO     [learner.py:606] ====Pushing takes 0.022507190704345703 s
2021-08-18:16:03:36,467 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:36,473 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:36,474 INFO     [param_server.py:410] Lock worker 2 with localStep 147 , while globalStep is 146

2021-08-18:16:03:36,664 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:36,679 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:37,362 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:37,377 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:38,701 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:38,714 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:39,444 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:39,458 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:40,43 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:40,57 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:40,750 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:40,764 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:41,239 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:41,280 INFO     [learner.py:606] ====Pushing takes 0.039362192153930664 s
2021-08-18:16:03:41,321 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:41,332 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:41,333 INFO     [param_server.py:381] ====After aggregation in epoch: 146, virtual_clock: 4749.64392619132, top_1: : 61.2778 % (1899.0), top_5: : 100.0 % (3099.0), test loss: 2.679264960465608, test len: 3099.0
2021-08-18:16:03:41,335 INFO     [param_server.py:410] Lock worker 3 with localStep 147 , while globalStep is 147

2021-08-18:16:03:41,336 INFO     [param_server.py:441] ====Epoch 148 completes 20 clients with loss 5.144127640627413, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:41,336 INFO     [param_server.py:450] ====Start to sample for epoch 148, global virtualClock: 4749.64392619132, round_duration: 27.34830796796159
2021-08-18:16:03:41,337 INFO     [oort.py:208] Training selector: Pacer 146: lastExploitationUtil 456.8500141902217, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:41,338 INFO     [oort.py:321] scores are 26,{3: 0.02165736088953295, 5: 0.08711286285417347, 6: 0.0459742363463688, 7: 0.2913818758446571, 11: 0.08239531934318764, 12: 0.03384285554294729, 27: 0.0591237918402295, 36: 0.0034683153922397372, 50: 0.020889518514428468, 51: 0.717040607693954, 53: 0.43517167468237034, 58: 0.004167694670763257, 60: 0.0018597801574783187, 67: 0.0023121865081513187, 70: 0.008886044741605589, 79: 0.016632732776580214, 81: 0.054959622674342505, 84: 0.03683797046099752, 85: 0.08194129616597069, 87: 0.040715899349198954, 93: 0.013917886479958824, 97: 0.15525424520827077, 103: 0.0943050561431082, 105: 0.02072759363368528, 110: 0.05988352159262971, 113: 0.0818758099177343, 119: 0.016665236371566847},[51, 53, 7, 97, 103, 5, 11, 85, 113, 110, 27, 81, 6, 87, 84, 12, 3, 50, 105, 119, 79, 93, 70, 58, 36, 67, 60]
2021-08-18:16:03:41,339 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:03:41,340 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:41,340 INFO     [oort.py:398] At round 146, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1334.026753658053, 'duration': 12.029357192292537, 'time_stamp': 147, 'count': 141, 'status': True, 'gradient': 27.844421166849006}, [0.8691265173586504, -2.0408302097293197e-06]), ({'reward': 357.8802318385386, 'duration': 5.8943907365129, 'time_stamp': 147, 'count': 144, 'status': True, 'gradient': 21.764372370412453}, [0.23315637811216752, -2.0408302097293197e-06]), ({'reward': 640.7043154896227, 'duration': 11.058674649423494, 'time_stamp': 147, 'count': 144, 'status': True, 'gradient': 18.78068554412316}, [0.4174193630650512, -2.0408302097293197e-06])]
2021-08-18:16:03:41,341 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:41,628 INFO     [param_server.py:553] For epoch: 148, median_reward: 353.391286308667, dev: 706.782572617334
2021-08-18:16:03:42,217 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.634, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:03:42,218 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2073.638, eval_time 0.5561, test_loss 2.634, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:03:42,282 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7282, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:03:42,283 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2073.7001, eval_time 0.6186, test_loss 2.7282, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:03:42,285 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:42,303 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:42,339 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5269, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:03:42,340 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2073.7541, eval_time 0.6755, test_loss 2.5269, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:03:42,352 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:42,363 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:42,409 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:42,424 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:43,555 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:43,569 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:44,103 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:44,117 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:44,674 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:44,688 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:45,193 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:45,207 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:45,281 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:45,299 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:46,251 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:46,272 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:46,342 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:46,353 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:46,588 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:46,601 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:46,820 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:46,847 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:46,958 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:46,968 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:47,202 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:47,224 INFO     [learner.py:606] ====Pushing takes 0.02097010612487793 s
2021-08-18:16:03:47,247 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:47,255 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:47,256 INFO     [param_server.py:410] Lock worker 2 with localStep 148 , while globalStep is 147

2021-08-18:16:03:47,362 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:47,385 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:47,508 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:47,526 INFO     [learner.py:606] ====Pushing takes 0.016405344009399414 s
2021-08-18:16:03:47,552 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:47,558 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:47,559 INFO     [param_server.py:410] Lock worker 1 with localStep 148 , while globalStep is 147

2021-08-18:16:03:47,582 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:47,592 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:48,220 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:48,235 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:49,378 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:49,387 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:49,869 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:49,879 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:50,429 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:50,443 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:50,984 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:50,998 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:51,594 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:51,631 INFO     [learner.py:606] ====Pushing takes 0.0363764762878418 s
2021-08-18:16:03:51,673 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:51,683 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:51,684 INFO     [param_server.py:381] ====After aggregation in epoch: 147, virtual_clock: 4777.659781686809, top_1: : 61.9232 % (1919.0), top_5: : 100.0 % (3099.0), test loss: 2.6297090097709934, test len: 3099.0
2021-08-18:16:03:51,686 INFO     [param_server.py:410] Lock worker 3 with localStep 148 , while globalStep is 148

2021-08-18:16:03:51,686 INFO     [param_server.py:441] ====Epoch 149 completes 20 clients with loss 6.3624163655804, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:51,687 INFO     [param_server.py:450] ====Start to sample for epoch 149, global virtualClock: 4777.659781686809, round_duration: 28.015855495488744
2021-08-18:16:03:51,687 INFO     [oort.py:208] Training selector: Pacer 147: lastExploitationUtil 426.1547273229777, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:51,687 INFO     [oort.py:321] scores are 26,{3: 0.0948653809493495, 5: 0.05892529938102761, 6: 0.29735265054843585, 7: 0.2226830164186782, 11: 0.12219506751833153, 12: 0.023283451957841567, 27: 0.0936781048351406, 36: 0.01315592701358351, 50: 0.018980061329260636, 51: 0.608239253654713, 53: 0.05312709829816667, 58: 0.0037867364151108864, 60: 0.001790669180543585, 67: 0.0020682681933969407, 70: 0.008073794235790337, 79: 0.003563098576909862, 81: 0.020928888012370802, 84: 0.3830283096979361, 85: 0.008888862260674174, 87: 0.009504791985774887, 93: 0.01388028287832043, 97: 0.025468371982461848, 103: 0.09429103687418809, 105: 0.018832937585593873, 110: 0.055588240508282066, 113: 0.058068189509468716, 119: 0.015141909957402284},[51, 84, 6, 7, 11, 3, 103, 27, 5, 113, 110, 53, 97, 12, 81, 50, 105, 119, 93, 36, 87, 85, 70, 58, 79, 67, 60]
2021-08-18:16:03:51,688 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:03:51,689 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:51,689 INFO     [oort.py:398] At round 147, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1170.4480893964267, 'duration': 12.029357192292537, 'time_stamp': 148, 'count': 142, 'status': True, 'gradient': 27.858484325720354}, [0.7285705251536596, -2.027040723248132e-06]), ({'reward': 264.4613585001965, 'duration': 5.8943907365129, 'time_stamp': 148, 'count': 145, 'status': True, 'gradient': 21.774115244169362}, [0.16461483313397715, -2.027040723248132e-06]), ({'reward': 879.3041857897227, 'duration': 13.298442137908651, 'time_stamp': 148, 'count': 145, 'status': True, 'gradient': 18.790337621112524}, [0.5473402090391991, -2.027040723248132e-06])]
2021-08-18:16:03:51,690 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:51,962 INFO     [param_server.py:553] For epoch: 149, median_reward: 346.67148857247224, dev: 693.3429771449445
2021-08-18:16:03:52,715 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5317, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:03:52,719 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2084.1384, eval_time 0.7013, test_loss 2.5317, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:03:52,746 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3647, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:03:52,747 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2084.1616, eval_time 0.726, test_loss 2.3647, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:03:52,750 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6675, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:03:52,751 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2084.1682, eval_time 0.7299, test_loss 2.6675, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:03:52,780 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:03:52,808 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:52,811 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:03:52,819 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:03:52,829 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:52,836 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:53,900 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:53,911 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:54,456 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:54,465 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:54,937 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:54,951 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:55,640 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:55,649 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:55,773 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:55,793 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:56,407 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:56,427 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:56,924 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:56,926 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:56,935 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:56,939 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:56,948 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:56,969 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:57,444 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:57,464 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:57,516 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:57,540 INFO     [learner.py:606] ====Pushing takes 0.022603273391723633 s
2021-08-18:16:03:57,569 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:57,578 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:57,579 INFO     [param_server.py:410] Lock worker 2 with localStep 149 , while globalStep is 148

2021-08-18:16:03:57,586 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:57,587 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:57,601 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:57,603 INFO     [learner.py:606] ====Pushing takes 0.01644444465637207 s
2021-08-18:16:03:57,626 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:57,632 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:57,632 INFO     [param_server.py:410] Lock worker 1 with localStep 149 , while globalStep is 148

2021-08-18:16:03:58,144 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:58,153 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:58,680 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:58,689 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:59,689 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:59,698 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:00,267 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:00,276 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:00,917 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:00,926 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:01,495 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:01,505 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:01,974 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:02,18 INFO     [learner.py:606] ====Pushing takes 0.042597293853759766 s
2021-08-18:16:04:02,65 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:02,76 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:02,77 INFO     [param_server.py:381] ====After aggregation in epoch: 148, virtual_clock: 4805.008089654771, top_1: : 62.6331 % (1941.0), top_5: : 100.0 % (3099.0), test loss: 2.5212836740193545, test len: 3099.0
2021-08-18:16:04:02,80 INFO     [param_server.py:410] Lock worker 3 with localStep 149 , while globalStep is 149

2021-08-18:16:04:02,81 INFO     [param_server.py:441] ====Epoch 150 completes 20 clients with loss 5.673381041576065, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:02,81 INFO     [param_server.py:450] ====Start to sample for epoch 150, global virtualClock: 4805.008089654771, round_duration: 27.34830796796159
2021-08-18:16:04:02,82 INFO     [oort.py:208] Training selector: Pacer 148: lastExploitationUtil 414.79783112386724, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:04:02,83 INFO     [oort.py:321] scores are 26,{3: 0.02154086254896063, 5: 0.043815585618080834, 6: 0.045726933719296634, 7: 1.0579122935202991, 11: 0.14385388443423866, 12: 0.04712277374011708, 27: 0.11420515696605271, 36: 0.0034496587798372243, 50: 0.019491284218148015, 51: 0.28054026661278797, 53: 0.05298447373042827, 58: 0.0038887311503230213, 60: 0.0018825926750755235, 67: 0.0021239764454662954, 70: 0.008291259729810624, 79: 0.04443227002179386, 81: 0.02087270249308539, 84: 0.09006562518100761, 85: 0.026567307757144887, 87: 0.056552162170163574, 93: 0.01384301998595434, 97: 0.2048674576139904, 103: 0.018565112139683777, 105: 0.019340197735691504, 110: 0.023477850445282437, 113: 0.05791230012921952, 119: 0.015549753262932705},[7, 51, 97, 11, 27, 84, 113, 87, 53, 12, 6, 79, 5, 85, 110, 3, 81, 50, 105, 103, 119, 93, 70, 58, 36, 67, 60]
2021-08-18:16:04:02,84 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:04:02,85 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:04:02,85 INFO     [oort.py:398] At round 148, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 832.9792920235179, 'duration': 21.753601635627824, 'time_stamp': 149, 'count': 143, 'status': True, 'gradient': 21.785171883682164}, [0.5505027768678376, -2.0134363317874635e-06]), ({'reward': 414.7994265001406, 'duration': 43.65853298740619, 'time_stamp': 149, 'count': 134, 'status': True, 'gradient': 16.26040372634259}, [0.2741310346660602, -2.0134363317874635e-06]), ({'reward': 619.1548922267937, 'duration': 15.972045438625893, 'time_stamp': 149, 'count': 146, 'status': True, 'gradient': 20.507152124872604}, [0.40918793421488225, -2.0134363317874635e-06])]
2021-08-18:16:04:02,86 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:04:02,420 INFO     [param_server.py:553] For epoch: 150, median_reward: 344.21081826525153, dev: 688.4216365305031
2021-08-18:16:04:03,66 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6183, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:04:03,67 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2094.4871, eval_time 0.6026, test_loss 2.6183, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:04:03,85 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0706, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:16:04:03,86 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2094.5032, eval_time 0.6212, test_loss 3.0706, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:16:04:03,119 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4789, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:04:03,120 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2094.5342, eval_time 0.6526, test_loss 2.4789, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:04:03,134 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:04:03,155 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:03,155 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:04:03,168 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:03,187 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:04:03,204 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:04,239 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:04,253 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:04,822 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:04,831 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:05,449 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:05,467 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:06,311 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:04:06,338 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:06,398 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:06,407 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:07,276 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:07,285 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:07,423 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:07,450 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:07,991 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:08,1 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:08,0 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:08,15 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:08,27 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:08,35 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:04:08,541 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:08,550 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:08,567 INFO     [learner.py:606] ====Pushing takes 0.02430248260498047 s
2021-08-18:16:04:08,577 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:08,598 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:08,606 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:08,607 INFO     [param_server.py:410] Lock worker 2 with localStep 150 , while globalStep is 149

2021-08-18:16:04:08,637 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:04:08,657 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:08,738 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:08,756 INFO     [learner.py:606] ====Pushing takes 0.01664137840270996 s
2021-08-18:16:04:08,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:08,784 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:08,785 INFO     [param_server.py:410] Lock worker 1 with localStep 150 , while globalStep is 149

2021-08-18:16:04:09,232 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:09,246 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:10,754 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:10,768 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:11,355 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:11,365 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:11,909 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:11,919 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:12,555 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:12,566 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:13,207 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:13,249 INFO     [learner.py:606] ====Pushing takes 0.03973889350891113 s
2021-08-18:16:04:13,296 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:13,306 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:13,307 INFO     [param_server.py:381] ====After aggregation in epoch: 149, virtual_clock: 4833.691492677786, top_1: : 60.9874 % (1890.0), top_5: : 100.0 % (3099.0), test loss: 2.7226184518248946, test len: 3099.0
2021-08-18:16:04:13,309 INFO     [param_server.py:410] Lock worker 3 with localStep 150 , while globalStep is 150

2021-08-18:16:04:13,310 INFO     [param_server.py:441] ====Epoch 151 completes 20 clients with loss 5.999415243210076, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:13,310 INFO     [param_server.py:450] ====Start to sample for epoch 151, global virtualClock: 4833.691492677786, round_duration: 28.683403023015895
2021-08-18:16:04:13,311 INFO     [oort.py:208] Training selector: Pacer 149: lastExploitationUtil 356.1506173706707, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:04:13,311 INFO     [oort.py:321] scores are 26,{3: 0.021483400394266685, 5: 0.016617345683572423, 6: 0.045604953082119926, 7: 0.05775781395016593, 11: 0.03542082841708227, 12: 0.05142605124371847, 27: 0.06135651221990096, 36: 0.005375662270705189, 50: 0.01910554254638881, 51: 0.04465909098157411, 53: 0.052843132963829205, 58: 0.0038117713339169256, 60: 0.0017009539449695569, 67: 0.0023651817179601515, 70: 0.00812717180449121, 79: 0.005364975466625823, 81: 0.25263471386070047, 84: 0.27305963044413056, 85: 0.13327483767066342, 87: 0.10508131651583533, 93: 0.013806092506655113, 97: 0.19764658242101454, 103: 0.019977260059055032, 105: 0.018957446136401136, 110: 0.008429041100827418, 113: 1.0577578064331017, 119: 0.015242016340523969},[113, 84, 81, 97, 85, 87, 27, 7, 53, 12, 6, 51, 11, 3, 103, 50, 105, 5, 119, 93, 110, 70, 36, 79, 58, 67, 60]
2021-08-18:16:04:13,312 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:04:13,313 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:04:13,313 INFO     [oort.py:398] At round 149, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1330.3165614934992, 'duration': 8.009219946401625, 'time_stamp': 150, 'count': 74, 'status': True, 'gradient': 21.58001244898226}, [1.0, -2.0000133334222246e-06]), ({'reward': 1081.3969277335123, 'duration': 27.035726288496562, 'time_stamp': 150, 'count': 143, 'status': True, 'gradient': 11.966186727557561}, [0.8128855114347577, -2.0000133334222246e-06]), ({'reward': 855.6487485094818, 'duration': 17.619275735353515, 'time_stamp': 150, 'count': 146, 'status': True, 'gradient': 15.38481534203563}, [0.6431891541728455, -2.0000133334222246e-06])]
2021-08-18:16:04:13,314 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:04:13,592 INFO     [param_server.py:553] For epoch: 151, median_reward: 331.1534368726681, dev: 662.3068737453362
2021-08-18:16:04:14,196 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8292, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:04:14,197 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2105.6114, eval_time 0.555, test_loss 2.8292, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:04:14,205 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7559, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:04:14,206 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2105.6255, eval_time 0.5685, test_loss 2.7559, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:04:14,237 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6451, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:04:14,238 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2105.6548, eval_time 0.5961, test_loss 2.6451, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:04:14,263 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:14,265 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:14,274 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:14,286 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:14,306 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:14,320 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:15,585 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:15,597 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:16,266 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:16,276 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:16,567 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:16,580 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:16,984 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:04:17,4 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:17,889 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:17,900 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:18,26 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:18,52 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:18,595 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:18,622 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:18,700 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:18,715 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:19,158 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:19,192 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:19,389 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:19,393 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:19,402 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:19,410 INFO     [learner.py:606] ====Pushing takes 0.016859769821166992 s
2021-08-18:16:04:19,441 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:19,447 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:19,448 INFO     [param_server.py:410] Lock worker 1 with localStep 151 , while globalStep is 150

2021-08-18:16:04:19,533 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:19,547 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:19,976 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:19,986 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:20,212 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:20,226 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:20,933 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:20,957 INFO     [learner.py:606] ====Pushing takes 0.023369312286376953 s
2021-08-18:16:04:20,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:20,989 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:04:20,990 INFO     [param_server.py:410] Lock worker 2 with localStep 151 , while globalStep is 150

2021-08-18:16:04:21,558 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:21,593 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:22,282 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:22,302 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:22,841 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:22,869 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:23,427 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:23,447 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:23,953 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:23,991 INFO     [learner.py:606] ====Pushing takes 0.03654336929321289 s
2021-08-18:16:04:24,32 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:24,41 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:24,43 INFO     [param_server.py:381] ====After aggregation in epoch: 150, virtual_clock: 4862.6149936650545, top_1: : 61.9232 % (1919.0), top_5: : 100.0 % (3099.0), test loss: 2.7433993507314614, test len: 3099.0
2021-08-18:16:04:24,45 INFO     [param_server.py:410] Lock worker 3 with localStep 151 , while globalStep is 151

2021-08-18:16:04:24,46 INFO     [param_server.py:441] ====Epoch 152 completes 20 clients with loss 6.59642110056859, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:24,46 INFO     [param_server.py:450] ====Start to sample for epoch 152, global virtualClock: 4862.6149936650545, round_duration: 28.923500987268568
2021-08-18:16:04:24,46 INFO     [oort.py:208] Training selector: Pacer 150: lastExploitationUtil 329.46267504678565, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:04:24,47 INFO     [oort.py:321] scores are 24,{5: 0.007370735149063452, 6: 0.04548406152858468, 11: 0.013620078261954839, 12: 0.003877841656979086, 27: 0.043774470574666206, 36: 0.0034313364013849328, 50: 0.028667346545793115, 51: 0.05377072529466011, 53: 0.5761387411487144, 58: 0.003212976705553146, 60: 0.0015265077689030613, 67: 0.0017548877972343017, 70: 0.0068504669882770266, 79: 0.0035346590196147147, 81: 0.3811809964289457, 84: 0.31244762654696945, 85: 0.06312637094324337, 87: 0.03855608520694931, 93: 0.026436046405173906, 97: 0.15339619147994765, 103: 0.0051335137420692204, 105: 0.015979403667545085, 110: 0.06903077215570073, 113: 0.05760470707502756, 119: 0.012847634120129839},[53, 81, 84, 97, 110, 85, 113, 51, 6, 27, 87, 50, 93, 105, 11, 119, 5, 70, 103, 12, 79, 36, 58, 67, 60]
2021-08-18:16:04:24,48 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:04:24,49 INFO     [oort.py:365] exploration poss is [143.26994305  49.77795679  34.17082011   2.63282729   1.23777438]
2021-08-18:16:04:24,49 INFO     [oort.py:398] At round 150, UCB exploited 25, augment_factor 1.0416666666666667, exploreLen 2, un-explored 62, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 869.6589376391154, 'duration': 11.058674649423494, 'time_stamp': 151, 'count': 148, 'status': True, 'gradient': 20.521526814678218}, [0.572117883203034, -1.9867681242922155e-06]), ({'reward': 663.1250832214259, 'duration': 13.298442137908651, 'time_stamp': 151, 'count': 148, 'status': True, 'gradient': 18.811136606534866}, [0.4362449980348379, -1.9867681242922155e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 151, 'count': 75, 'status': True, 'gradient': 21.588676271101818}, [6.578722193089189e-09, -1.9867681242922155e-06])]
2021-08-18:16:04:24,50 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:04:24,314 INFO     [param_server.py:553] For epoch: 152, median_reward: 322.1368595094895, dev: 644.273719018979
2021-08-18:16:04:24,909 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8713, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:04:24,911 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2116.3309, eval_time 0.5521, test_loss 2.8713, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:04:24,933 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7425, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:04:24,934 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2116.3481, eval_time 0.5733, test_loss 2.7425, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:04:24,946 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7484, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:04:24,949 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2116.3661, eval_time 0.5892, test_loss 2.7484, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:04:24,993 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:24,998 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:25,3 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:25,8 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:25,15 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:25,19 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:04:25,602 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:04:25,622 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:26,230 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:26,244 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:26,641 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:26,656 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:26,879 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:26,888 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:27,135 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:27,150 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:27,298 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:27,308 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:27,603 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:27,622 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:27,706 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:27,727 INFO     [learner.py:606] ====Pushing takes 0.017388343811035156 s
2021-08-18:16:04:27,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:27,763 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:27,764 INFO     [param_server.py:410] Lock worker 1 with localStep 152 , while globalStep is 151

2021-08-18:16:04:27,973 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:27,984 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:29,72 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:29,82 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:29,516 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:29,540 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:29,600 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:29,609 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:30,71 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:30,82 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:30,136 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:30,150 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:31,191 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:31,219 INFO     [learner.py:606] ====Pushing takes 0.026119470596313477 s
2021-08-18:16:04:31,249 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:31,255 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:04:31,256 INFO     [param_server.py:410] Lock worker 2 with localStep 152 , while globalStep is 151

2021-08-18:16:04:31,341 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:31,355 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:32,9 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:32,23 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:32,599 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:32,612 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:33,213 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:33,223 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:33,679 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:33,719 INFO     [learner.py:606] ====Pushing takes 0.038254499435424805 s
2021-08-18:16:04:33,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:33,764 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:33,765 INFO     [param_server.py:381] ====After aggregation in epoch: 151, virtual_clock: 4890.630849160543, top_1: : 62.1813 % (1927.0), top_5: : 100.0 % (3099.0), test loss: 2.7874073496571294, test len: 3099.0
2021-08-18:16:04:33,766 INFO     [param_server.py:410] Lock worker 3 with localStep 152 , while globalStep is 152

2021-08-18:16:04:33,767 INFO     [param_server.py:441] ====Epoch 153 completes 20 clients with loss 9.795425093958125, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:33,767 INFO     [param_server.py:450] ====Start to sample for epoch 153, global virtualClock: 4890.630849160543, round_duration: 28.015855495488744
2021-08-18:16:04:33,768 INFO     [oort.py:208] Training selector: Pacer 151: lastExploitationUtil 506.7460365141041, lastExplorationUtil 1547.4117733950247, last_util_record 120
2021-08-18:16:04:33,769 INFO     [oort.py:321] scores are 24,{5: 0.007351318711614246, 6: 0.3406753210723691, 11: 0.09659728577972918, 12: 0.036367936506575195, 27: 0.07786204018456248, 36: 0.022982269177464397, 50: 0.003372547803518954, 51: 0.3836126543379888, 53: 0.5794309687484933, 58: 0.004920405212473838, 60: 0.0021956675581601267, 67: 0.0017625220282802606, 70: 0.010490917478094577, 79: 0.04218127058882294, 81: 0.10300596483952622, 84: 0.47660707761966925, 85: 0.008794685411189771, 87: 0.08305462910519854, 93: 0.01373322229023867, 97: 0.46379274832675066, 103: 0.005119990728902726, 105: 0.024471120802749886, 110: 0.021567060400984564, 113: 0.05745296126282805, 119: 0.019675077563863132},[53, 84, 97, 51, 6, 81, 11, 87, 27, 113, 79, 12, 105, 36, 110, 119, 93, 70, 85, 5, 103, 58, 50, 60, 67]
2021-08-18:16:04:33,770 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:04:33,770 INFO     [oort.py:365] exploration poss is [34.17082011  2.63282729  1.23777438]
2021-08-18:16:04:33,771 INFO     [oort.py:398] At round 151, UCB exploited 25, augment_factor 1.0416666666666667, exploreLen 2, un-explored 61, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 870.7182385495156, 'duration': 11.058674649423494, 'time_stamp': 152, 'count': 149, 'status': True, 'gradient': 18.820766423186868}, [0.5758680506147404, -1.973697195376287e-06]), ({'reward': 565.5041872673619, 'duration': 11.90395711384456, 'time_stamp': 152, 'count': 149, 'status': True, 'gradient': 21.490548945087326}, [0.3740059216813358, -1.973697195376287e-06]), ({'reward': 663.2835213979395, 'duration': 12.029357192292537, 'time_stamp': 152, 'count': 146, 'status': True, 'gradient': 27.904575170635713}, [0.4386751086678892, -1.973697195376287e-06])]
2021-08-18:16:04:33,771 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 105, 119]
2021-08-18:16:04:34,53 INFO     [param_server.py:553] For epoch: 153, median_reward: 369.17382659368093, dev: 738.3476531873619
2021-08-18:16:04:34,746 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7056, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:04:34,747 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2126.167, eval_time 0.6389, test_loss 2.7056, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:04:34,769 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5388, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:04:34,771 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2126.1848, eval_time 0.655, test_loss 2.5388, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:04:34,776 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9185, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:04:34,777 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2126.1943, eval_time 0.6641, test_loss 2.9185, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:04:34,826 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:34,846 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:34,846 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:34,860 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:34,861 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:34,862 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:36,22 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:36,29 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:36,40 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:36,55 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:36,673 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:36,700 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:37,159 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:37,173 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:37,220 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:37,241 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:37,363 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:37,379 INFO     [learner.py:606] ====Pushing takes 0.014500141143798828 s
2021-08-18:16:04:37,395 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:37,399 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:16:04:37,400 INFO     [param_server.py:410] Lock worker 1 with localStep 153 , while globalStep is 152

2021-08-18:16:04:37,602 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:37,612 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:39,47 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:39,61 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:40,148 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:40,162 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:41,154 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:41,167 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:41,471 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:41,489 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:41,699 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:41,708 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:42,161 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:42,175 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:04:42,770 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:04:42,800 INFO     [learner.py:606] ====Pushing takes 0.024300813674926758 s
2021-08-18:16:04:42,833 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:42,843 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:42,844 INFO     [param_server.py:410] Lock worker 2 with localStep 153 , while globalStep is 152

2021-08-18:16:04:43,534 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:43,552 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:44,144 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:44,158 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:44,865 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:44,880 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:45,584 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:45,598 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:46,210 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:46,219 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:04:46,720 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:04:46,762 INFO     [learner.py:606] ====Pushing takes 0.03965401649475098 s
2021-08-18:16:04:46,808 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:46,818 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:46,819 INFO     [param_server.py:381] ====After aggregation in epoch: 152, virtual_clock: 4924.84332697812, top_1: : 61.536 % (1907.0), top_5: : 100.0 % (3099.0), test loss: 2.720989995532566, test len: 3099.0
2021-08-18:16:04:46,821 INFO     [param_server.py:410] Lock worker 3 with localStep 153 , while globalStep is 153

2021-08-18:16:04:46,822 INFO     [param_server.py:441] ====Epoch 154 completes 20 clients with loss 8.551359344410681, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:04:46,822 INFO     [param_server.py:450] ====Start to sample for epoch 154, global virtualClock: 4924.84332697812, round_duration: 34.212477817576975
2021-08-18:16:04:46,823 INFO     [oort.py:208] Training selector: Pacer 152: lastExploitationUtil 287.1002207613584, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:04:46,823 INFO     [oort.py:321] scores are 25,{5: 0.007332073632172155, 6: 0.045245485215976884, 11: 0.013548637235363039, 12: 0.003857501319456292, 27: 0.03633962305530236, 36: 0.0034133381057524104, 40: 0.629535003426089, 50: 0.003374765506107683, 51: 0.41814941315392673, 53: 0.6965017309881751, 58: 0.002818299513262235, 60: 0.0012576299193328413, 67: 0.0015393200380902853, 70: 0.006008965998823298, 79: 0.003516118768658991, 81: 0.02065293854745932, 84: 0.03625404096595292, 85: 0.008771661729855, 87: 0.08618732006386404, 93: 0.029680244642332383, 97: 0.2722607735376135, 103: 0.017344175221151028, 105: 0.003337644951706173, 110: 0.1543002760315611, 113: 0.057302554669526676, 119: 0.0026835069727609625},[53, 40, 51, 97, 110, 87, 113, 6, 27, 84, 93, 81, 103, 11, 85, 5, 70, 12, 79, 36, 50, 105, 58, 119, 67, 60]
2021-08-18:16:04:46,824 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:04:46,838 INFO     [oort.py:365] exploration poss is [1.23777438]
2021-08-18:16:04:46,839 INFO     [oort.py:398] At round 152, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 61, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1547.5665145723642, 'duration': 13.633360568989564, 'time_stamp': 152, 'count': 1, 'status': True, 'gradient': 17.111469009423796}, [0.9882926840407145, 0.0019588363322636092]), ({'reward': 757.1048443787424, 'duration': 12.029357192292537, 'time_stamp': 153, 'count': 147, 'status': True, 'gradient': 27.908636502973028}, [0.4834920688368005, -1.9607971293930042e-06]), ({'reward': 882.3182806921521, 'duration': 15.972045438625893, 'time_stamp': 153, 'count': 150, 'status': True, 'gradient': 21.60175363322686}, [0.5634552372815433, -1.9607971293930042e-06])]
2021-08-18:16:04:46,840 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:04:47,127 INFO     [param_server.py:553] For epoch: 154, median_reward: 322.49903046413976, dev: 644.9980609282795
2021-08-18:16:04:47,721 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7132, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:04:47,722 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2139.1391, eval_time 0.5604, test_loss 2.7132, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:04:47,754 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6987, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:04:47,759 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2139.1782, eval_time 0.597, test_loss 2.6987, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:04:47,763 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8074, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:04:47,764 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2139.1783, eval_time 0.6003, test_loss 2.8074, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:04:47,813 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:47,823 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:47,828 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:47,843 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:47,849 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:04:47,859 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:48,978 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:04:49,6 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:49,192 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:49,201 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:50,167 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:50,187 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:50,387 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:50,406 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:50,780 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:50,800 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:50,815 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:50,825 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:51,355 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:51,375 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:51,698 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:51,716 INFO     [learner.py:606] ====Pushing takes 0.016388416290283203 s
2021-08-18:16:04:51,740 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:51,746 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:51,747 INFO     [param_server.py:410] Lock worker 1 with localStep 154 , while globalStep is 153

2021-08-18:16:04:52,682 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:52,691 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:53,198 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:53,213 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:54,360 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:54,375 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:55,100 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:55,113 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:55,478 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:55,497 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:56,179 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:56,194 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:56,718 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:56,741 INFO     [learner.py:606] ====Pushing takes 0.022078752517700195 s
2021-08-18:16:04:56,767 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:56,774 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:04:56,774 INFO     [param_server.py:410] Lock worker 2 with localStep 154 , while globalStep is 153

2021-08-18:16:04:57,429 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:57,443 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:58,41 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:58,55 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:58,708 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:58,722 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:00,8 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:00,18 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:00,723 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:00,757 INFO     [learner.py:606] ====Pushing takes 0.03264665603637695 s
2021-08-18:16:05:00,794 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:00,804 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:00,805 INFO     [param_server.py:381] ====After aggregation in epoch: 153, virtual_clock: 4963.239348536906, top_1: : 61.6651 % (1911.0), top_5: : 100.0 % (3099.0), test loss: 2.7397432261043124, test len: 3099.0
2021-08-18:16:05:00,807 INFO     [param_server.py:410] Lock worker 3 with localStep 154 , while globalStep is 154

2021-08-18:16:05:00,808 INFO     [param_server.py:441] ====Epoch 155 completes 20 clients with loss 7.733226378401197, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:00,808 INFO     [param_server.py:450] ====Start to sample for epoch 155, global virtualClock: 4963.239348536906, round_duration: 38.39602155878561
2021-08-18:16:05:00,809 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:01,140 INFO     [param_server.py:553] For epoch: 155, median_reward: 355.5089090320132, dev: 711.0178180640264
2021-08-18:16:05:01,832 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6804, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:05:01,832 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8286, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:16:05:01,833 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2153.2476, eval_time 0.6572, test_loss 2.6804, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:05:01,834 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2153.2507, eval_time 0.6589, test_loss 2.8286, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:16:05:01,868 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4348, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:05:01,869 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2153.2888, eval_time 0.6957, test_loss 3.4348, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:05:01,903 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:05:01,919 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:01,925 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:05:01,937 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:01,941 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:05:01,963 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:02,606 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:02,633 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:02,989 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:03,16 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:03,699 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:03,756 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:03,765 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:03,783 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:04,85 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:04,99 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:04,405 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:04,432 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:05,83 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:05,110 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:05,496 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:05,514 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:05,596 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:05,620 INFO     [learner.py:606] ====Pushing takes 0.022291898727416992 s
2021-08-18:16:05:05,642 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:05,649 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:05,650 INFO     [param_server.py:410] Lock worker 1 with localStep 155 , while globalStep is 154

2021-08-18:16:05:05,897 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:05,912 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:06,525 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:06,534 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:07,87 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:07,100 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:07,200 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:07,214 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:07,725 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:07,739 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:08,739 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:08,753 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:09,85 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:09,112 INFO     [learner.py:606] ====Pushing takes 0.02516937255859375 s
2021-08-18:16:05:09,142 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:09,148 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:09,149 INFO     [param_server.py:410] Lock worker 2 with localStep 155 , while globalStep is 154

2021-08-18:16:05:09,336 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:09,348 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:09,990 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:10,5 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:10,509 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:10,523 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:11,8 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:11,47 INFO     [learner.py:606] ====Pushing takes 0.03751254081726074 s
2021-08-18:16:05:11,86 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:11,95 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:11,96 INFO     [param_server.py:381] ====After aggregation in epoch: 154, virtual_clock: 4992.708162341968, top_1: : 60.7293 % (1882.0), top_5: : 100.0 % (3099.0), test loss: 2.9812612930933633, test len: 3099.0
2021-08-18:16:05:11,98 INFO     [param_server.py:410] Lock worker 3 with localStep 155 , while globalStep is 155

2021-08-18:16:05:11,99 INFO     [param_server.py:441] ====Epoch 156 completes 20 clients with loss 7.739967269189604, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:11,99 INFO     [param_server.py:450] ====Start to sample for epoch 156, global virtualClock: 4992.708162341968, round_duration: 29.468813805062297
2021-08-18:16:05:11,100 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:11,372 INFO     [param_server.py:553] For epoch: 156, median_reward: 344.41464098936814, dev: 688.8292819787363
2021-08-18:16:05:12,5 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5239, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:05:12,6 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2163.4203, eval_time 0.5887, test_loss 2.5239, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:05:12,7 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8358, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:05:12,9 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2163.4283, eval_time 0.5914, test_loss 2.8358, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:05:12,16 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6477, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:05:12,17 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2163.434, eval_time 0.5995, test_loss 2.6477, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:05:12,76 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:12,86 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:12,89 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:12,94 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:12,95 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:12,97 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:12,753 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:12,774 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:13,371 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:13,382 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:13,931 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:13,958 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:14,351 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:14,370 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:14,592 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:14,637 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:14,859 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:14,873 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:15,234 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:15,260 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:15,635 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:15,653 INFO     [learner.py:606] ====Pushing takes 0.017499446868896484 s
2021-08-18:16:05:15,677 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:15,683 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:15,683 INFO     [param_server.py:410] Lock worker 1 with localStep 156 , while globalStep is 155

2021-08-18:16:05:16,662 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:16,674 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:17,186 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:17,196 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:18,266 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:18,280 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:18,827 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:18,837 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:19,344 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:19,363 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:19,959 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:19,973 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:20,522 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:20,547 INFO     [learner.py:606] ====Pushing takes 0.023027420043945312 s
2021-08-18:16:05:20,576 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:20,583 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:20,584 INFO     [param_server.py:410] Lock worker 2 with localStep 156 , while globalStep is 155

2021-08-18:16:05:20,871 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:20,881 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:21,534 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:21,543 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:22,193 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:22,213 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:23,399 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:23,420 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:24,122 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:24,165 INFO     [learner.py:606] ====Pushing takes 0.04152417182922363 s
2021-08-18:16:05:24,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:24,213 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:24,214 INFO     [param_server.py:381] ====After aggregation in epoch: 155, virtual_clock: 5031.104183900754, top_1: : 61.9555 % (1920.0), top_5: : 100.0 % (3099.0), test loss: 2.669146934593165, test len: 3099.0
2021-08-18:16:05:24,216 INFO     [param_server.py:410] Lock worker 3 with localStep 156 , while globalStep is 156

2021-08-18:16:05:24,217 INFO     [param_server.py:441] ====Epoch 157 completes 20 clients with loss 7.919601822739944, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:24,217 INFO     [param_server.py:450] ====Start to sample for epoch 157, global virtualClock: 5031.104183900754, round_duration: 38.39602155878561
2021-08-18:16:05:24,219 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:24,493 INFO     [param_server.py:553] For epoch: 157, median_reward: 388.7952707951185, dev: 777.590541590237
2021-08-18:16:05:25,65 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5663, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:05:25,66 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2176.48, eval_time 0.5283, test_loss 2.5663, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:05:25,79 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7679, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:16:05:25,83 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2176.5004, eval_time 0.546, test_loss 2.7679, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:16:05:25,132 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:25,145 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:25,153 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:25,153 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.123, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:05:25,156 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2176.5754, eval_time 0.6184, test_loss 3.123, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:05:25,164 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:25,225 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:25,247 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:25,975 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:25,996 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:26,347 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:26,366 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:27,35 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:27,49 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:27,389 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:27,416 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:27,488 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:27,502 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:28,46 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:28,73 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:28,751 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:28,778 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:28,925 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:28,939 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:29,252 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:29,277 INFO     [learner.py:606] ====Pushing takes 0.023953676223754883 s
2021-08-18:16:05:29,305 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:29,310 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:29,311 INFO     [param_server.py:410] Lock worker 1 with localStep 157 , while globalStep is 156

2021-08-18:16:05:29,347 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:29,357 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:29,916 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:29,935 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:30,493 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:30,502 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:30,945 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:30,963 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:31,531 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:31,550 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:32,152 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:32,161 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:32,776 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:32,802 INFO     [learner.py:606] ====Pushing takes 0.024157285690307617 s
2021-08-18:16:05:32,828 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:32,835 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:32,835 INFO     [param_server.py:410] Lock worker 2 with localStep 157 , while globalStep is 156

2021-08-18:16:05:32,868 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:32,878 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:33,571 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:33,581 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:34,240 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:34,249 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:34,851 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:34,890 INFO     [learner.py:606] ====Pushing takes 0.03664851188659668 s
2021-08-18:16:05:34,930 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:34,940 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:34,941 INFO     [param_server.py:381] ====After aggregation in epoch: 156, virtual_clock: 5060.572997705816, top_1: : 60.6325 % (1879.0), top_5: : 100.0 % (3099.0), test loss: 2.819059279229906, test len: 3099.0
2021-08-18:16:05:34,943 INFO     [param_server.py:410] Lock worker 3 with localStep 157 , while globalStep is 157

2021-08-18:16:05:34,944 INFO     [param_server.py:441] ====Epoch 158 completes 20 clients with loss 8.784244372351392, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:34,944 INFO     [param_server.py:450] ====Start to sample for epoch 158, global virtualClock: 5060.572997705816, round_duration: 29.468813805062297
2021-08-18:16:05:34,945 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:35,225 INFO     [param_server.py:553] For epoch: 158, median_reward: 363.7227473038113, dev: 727.4454946076225
2021-08-18:16:05:35,859 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9065, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:05:35,860 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2187.2802, eval_time 0.5911, test_loss 2.9065, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:05:35,880 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1888, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:16:05:35,881 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2187.2978, eval_time 0.6106, test_loss 3.1888, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:16:05:35,926 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:35,948 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:35,955 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:35,955 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6892, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:05:35,956 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2187.3702, eval_time 0.6859, test_loss 2.6892, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:05:35,957 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:36,22 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:36,43 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:36,840 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:36,880 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:37,49 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:37,59 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:38,176 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:38,204 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:38,259 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:38,273 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:38,818 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:38,823 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:38,836 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:38,850 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:39,449 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:39,476 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:39,849 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:39,865 INFO     [learner.py:606] ====Pushing takes 0.014927864074707031 s
2021-08-18:16:05:39,888 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:39,894 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:39,894 INFO     [param_server.py:410] Lock worker 1 with localStep 158 , while globalStep is 157

2021-08-18:16:05:40,534 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:40,547 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:41,400 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:41,409 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:42,563 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:42,573 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:43,188 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:43,199 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:43,335 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:43,353 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:44,59 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:44,73 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:44,647 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:44,672 INFO     [learner.py:606] ====Pushing takes 0.023291826248168945 s
2021-08-18:16:05:44,699 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:44,708 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:44,708 INFO     [param_server.py:410] Lock worker 2 with localStep 158 , while globalStep is 157

2021-08-18:16:05:45,419 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:45,428 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:46,139 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:46,154 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:46,703 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:46,712 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:47,821 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:47,836 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:48,434 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:48,469 INFO     [learner.py:606] ====Pushing takes 0.03331303596496582 s
2021-08-18:16:05:48,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:48,516 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:48,517 INFO     [param_server.py:381] ====After aggregation in epoch: 157, virtual_clock: 5098.969019264602, top_1: : 61.0197 % (1891.0), top_5: : 100.0 % (3099.0), test loss: 2.9281790344803422, test len: 3099.0
2021-08-18:16:05:48,520 INFO     [param_server.py:410] Lock worker 3 with localStep 158 , while globalStep is 158

2021-08-18:16:05:48,520 INFO     [param_server.py:441] ====Epoch 159 completes 20 clients with loss 7.349341325816255, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:48,521 INFO     [param_server.py:450] ====Start to sample for epoch 159, global virtualClock: 5098.969019264602, round_duration: 38.39602155878561
2021-08-18:16:05:48,521 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:48,802 INFO     [param_server.py:553] For epoch: 159, median_reward: 391.1865372933068, dev: 782.3730745866136
2021-08-18:16:05:49,475 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7826, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:05:49,476 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2200.8929, eval_time 0.617, test_loss 2.7826, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:05:49,555 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4133, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:05:49,556 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2200.9703, eval_time 0.6951, test_loss 2.4133, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:05:49,557 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:49,566 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:49,620 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:49,633 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6188, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:05:49,637 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2201.0572, eval_time 0.7804, test_loss 2.6188, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:05:49,640 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:49,692 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:49,727 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:50,499 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:50,533 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:50,660 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:50,672 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:51,293 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:51,312 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:51,729 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:51,762 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:52,229 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:52,243 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:52,376 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:52,403 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:52,973 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:52,987 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:52,991 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:53,14 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:53,362 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:53,387 INFO     [learner.py:606] ====Pushing takes 0.02364492416381836 s
2021-08-18:16:05:53,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:53,420 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:53,420 INFO     [param_server.py:410] Lock worker 1 with localStep 159 , while globalStep is 158

2021-08-18:16:05:54,163 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:54,184 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:54,775 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:54,794 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:54,808 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:54,818 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:55,417 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:55,431 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:55,508 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:55,517 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:56,792 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:56,818 INFO     [learner.py:606] ====Pushing takes 0.024306058883666992 s
2021-08-18:16:05:56,844 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:56,851 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:56,852 INFO     [param_server.py:410] Lock worker 2 with localStep 159 , while globalStep is 158

2021-08-18:16:05:57,215 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:57,225 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:57,863 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:57,875 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:58,568 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:58,578 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:59,153 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:59,165 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:59,753 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:59,789 INFO     [learner.py:606] ====Pushing takes 0.03544926643371582 s
2021-08-18:16:05:59,829 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:59,839 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:59,840 INFO     [param_server.py:381] ====After aggregation in epoch: 158, virtual_clock: 5128.4378330696645, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 2.604871909927439, test len: 3099.0
2021-08-18:16:05:59,842 INFO     [param_server.py:410] Lock worker 3 with localStep 159 , while globalStep is 159

2021-08-18:16:05:59,842 INFO     [param_server.py:441] ====Epoch 160 completes 20 clients with loss 6.784050432692917, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:59,843 INFO     [param_server.py:450] ====Start to sample for epoch 160, global virtualClock: 5128.4378330696645, round_duration: 29.468813805062297
2021-08-18:16:05:59,844 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:00,139 INFO     [param_server.py:553] For epoch: 160, median_reward: 390.91151350574006, dev: 781.8230270114801
2021-08-18:16:06:00,751 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0041, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:06:00,752 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2212.1687, eval_time 0.5678, test_loss 3.0041, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:06:00,752 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8853, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:06:00,753 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2212.1668, eval_time 0.5688, test_loss 2.8853, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:06:00,777 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7714, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:06:00,777 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2212.1971, eval_time 0.5938, test_loss 2.7714, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:06:00,823 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:06:00,833 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:00,835 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:06:00,843 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:00,853 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:06:00,879 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:01,726 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:01,766 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:02,125 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:02,136 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:03,167 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:03,176 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:03,185 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:03,216 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:03,793 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:03,805 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:03,923 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:03,956 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:04,585 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:04,618 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:05,18 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:05,34 INFO     [learner.py:606] ====Pushing takes 0.014970064163208008 s
2021-08-18:16:06:05,61 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:05,70 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:05,70 INFO     [param_server.py:410] Lock worker 1 with localStep 160 , while globalStep is 159

2021-08-18:16:06:05,470 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:05,488 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:06,591 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:06,605 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:07,815 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:07,825 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:08,382 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:08,400 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:08,434 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:08,445 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:08,983 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:09,1 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:09,515 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:09,539 INFO     [learner.py:606] ====Pushing takes 0.022587060928344727 s
2021-08-18:16:06:09,566 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:09,573 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:09,574 INFO     [param_server.py:410] Lock worker 2 with localStep 160 , while globalStep is 159

2021-08-18:16:06:10,555 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:10,568 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:11,139 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:11,148 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:11,727 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:11,739 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:12,856 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:12,866 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:13,459 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:13,496 INFO     [learner.py:606] ====Pushing takes 0.03584408760070801 s
2021-08-18:16:06:13,539 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:13,549 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:13,550 INFO     [param_server.py:381] ====After aggregation in epoch: 159, virtual_clock: 5166.83385462845, top_1: : 62.2782 % (1930.0), top_5: : 100.0 % (3099.0), test loss: 2.886895382845843, test len: 3099.0
2021-08-18:16:06:13,553 INFO     [param_server.py:410] Lock worker 3 with localStep 160 , while globalStep is 160

2021-08-18:16:06:13,553 INFO     [param_server.py:441] ====Epoch 161 completes 20 clients with loss 6.526421550816337, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:13,554 INFO     [param_server.py:450] ====Start to sample for epoch 161, global virtualClock: 5166.83385462845, round_duration: 38.39602155878561
2021-08-18:16:06:13,554 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:13,920 INFO     [param_server.py:541] Handle Wight 0.0441892147064209 | Send 0.3668222427368164
2021-08-18:16:06:13,921 INFO     [param_server.py:553] For epoch: 161, median_reward: 363.58616014821695, dev: 727.1723202964339
2021-08-18:16:06:14,668 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5953, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:06:14,669 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2226.0834, eval_time 0.6892, test_loss 2.5953, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:06:14,680 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2262, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:16:06:14,682 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2226.0988, eval_time 0.7037, test_loss 3.2262, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:16:06:14,736 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:14,752 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:14,752 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:14,766 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:14,788 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.258, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:06:14,791 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2226.211, eval_time 0.8151, test_loss 3.258, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:06:14,863 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:14,890 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:15,653 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:15,692 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:15,838 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:15,853 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:16,502 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:16,516 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:17,40 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:17,42 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:17,56 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:17,73 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:17,669 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:17,704 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:18,126 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:18,138 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:18,252 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:18,280 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:18,670 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:18,695 INFO     [learner.py:606] ====Pushing takes 0.023722410202026367 s
2021-08-18:16:06:18,718 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:18,724 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:18,725 INFO     [param_server.py:410] Lock worker 1 with localStep 161 , while globalStep is 160

2021-08-18:16:06:19,55 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:19,76 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:19,883 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:19,903 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:19,926 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:19,947 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:20,559 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:20,573 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:20,640 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:20,650 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:22,29 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:22,54 INFO     [learner.py:606] ====Pushing takes 0.02382349967956543 s
2021-08-18:16:06:22,83 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:22,89 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:22,90 INFO     [param_server.py:410] Lock worker 2 with localStep 161 , while globalStep is 160

2021-08-18:16:06:22,455 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:22,465 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:23,27 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:23,38 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:23,629 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:23,639 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:24,166 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:24,175 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:24,725 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:24,759 INFO     [learner.py:606] ====Pushing takes 0.03274989128112793 s
2021-08-18:16:06:24,797 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:24,809 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:24,810 INFO     [param_server.py:381] ====After aggregation in epoch: 160, virtual_clock: 5196.302668433513, top_1: : 60.342 % (1870.0), top_5: : 100.0 % (3099.0), test loss: 3.026517492753488, test len: 3099.0
2021-08-18:16:06:24,812 INFO     [param_server.py:410] Lock worker 3 with localStep 161 , while globalStep is 161

2021-08-18:16:06:24,813 INFO     [param_server.py:441] ====Epoch 162 completes 20 clients with loss 6.4699089613683185, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:24,830 INFO     [param_server.py:450] ====Start to sample for epoch 162, global virtualClock: 5196.302668433513, round_duration: 29.468813805062297
2021-08-18:16:06:24,832 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:25,149 INFO     [param_server.py:553] For epoch: 162, median_reward: 348.1652260807229, dev: 696.3304521614458
2021-08-18:16:06:25,774 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5877, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:06:25,775 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2237.1951, eval_time 0.5926, test_loss 2.5877, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:06:25,851 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:25,880 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:25,899 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4555, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:06:25,900 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2237.3138, eval_time 0.7147, test_loss 2.4555, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:06:25,898 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.651, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:06:25,901 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2237.3181, eval_time 0.7163, test_loss 2.651, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:06:25,967 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:25,969 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:25,977 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:25,979 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:26,619 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:26,646 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:27,316 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:27,330 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:27,930 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:27,970 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:28,572 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:28,587 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:28,632 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:28,650 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:28,721 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:28,761 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:29,419 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:29,453 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:29,857 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:29,875 INFO     [learner.py:606] ====Pushing takes 0.017319679260253906 s
2021-08-18:16:06:29,899 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:29,905 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:29,907 INFO     [param_server.py:410] Lock worker 1 with localStep 162 , while globalStep is 161

2021-08-18:16:06:30,827 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:30,837 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:31,13 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:31,27 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:32,110 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:32,130 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:32,827 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:32,845 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:33,776 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:33,797 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:34,398 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:34,417 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:34,927 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:34,952 INFO     [learner.py:606] ====Pushing takes 0.023856401443481445 s
2021-08-18:16:06:34,979 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:34,986 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:34,987 INFO     [param_server.py:410] Lock worker 2 with localStep 162 , while globalStep is 161

2021-08-18:16:06:35,182 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:35,192 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:36,39 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:36,49 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:36,675 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:36,684 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:37,783 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:37,793 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:38,473 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:38,510 INFO     [learner.py:606] ====Pushing takes 0.035907745361328125 s
2021-08-18:16:06:38,552 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:38,561 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:38,562 INFO     [param_server.py:381] ====After aggregation in epoch: 161, virtual_clock: 5234.698689992299, top_1: : 62.3104 % (1931.0), top_5: : 100.0 % (3099.0), test loss: 2.5647253968097545, test len: 3099.0
2021-08-18:16:06:38,564 INFO     [param_server.py:410] Lock worker 3 with localStep 162 , while globalStep is 162

2021-08-18:16:06:38,565 INFO     [param_server.py:441] ====Epoch 163 completes 20 clients with loss 5.5599867194865915, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:38,566 INFO     [param_server.py:450] ====Start to sample for epoch 163, global virtualClock: 5234.698689992299, round_duration: 38.39602155878561
2021-08-18:16:06:38,567 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:38,928 INFO     [param_server.py:553] For epoch: 163, median_reward: 390.62632694136636, dev: 781.2526538827327
2021-08-18:16:06:39,519 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5899, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:06:39,520 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2250.9345, eval_time 0.559, test_loss 2.5899, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:06:39,565 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0463, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:16:06:39,566 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2250.9834, eval_time 0.6037, test_loss 3.0463, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:16:06:39,587 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:39,596 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:39,638 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:39,650 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:39,688 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3134, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:06:39,691 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2251.1108, eval_time 0.73, test_loss 3.3134, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:06:39,758 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:39,789 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:40,617 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:40,651 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:40,870 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:40,889 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:41,498 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:41,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:41,971 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:41,984 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:41,988 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:42,28 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:42,660 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:42,699 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:43,151 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:43,162 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:43,374 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:43,401 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:43,748 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:43,774 INFO     [learner.py:606] ====Pushing takes 0.025374650955200195 s
2021-08-18:16:06:43,801 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:43,806 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:43,809 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:43,810 INFO     [param_server.py:410] Lock worker 1 with localStep 163 , while globalStep is 162

2021-08-18:16:06:43,825 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:44,469 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:44,483 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:45,25 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:45,39 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:45,96 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:45,116 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:45,592 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:45,604 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:46,848 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:46,875 INFO     [learner.py:606] ====Pushing takes 0.02539682388305664 s
2021-08-18:16:06:46,881 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:46,900 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:46,901 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:46,908 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:46,909 INFO     [param_server.py:410] Lock worker 2 with localStep 163 , while globalStep is 162

2021-08-18:16:06:47,471 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:47,486 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:48,62 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:48,76 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:48,592 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:48,604 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:49,153 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:49,190 INFO     [learner.py:606] ====Pushing takes 0.0352778434753418 s
2021-08-18:16:06:49,227 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:49,237 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:49,238 INFO     [param_server.py:381] ====After aggregation in epoch: 162, virtual_clock: 5264.167503797361, top_1: : 60.5357 % (1876.0), top_5: : 100.0 % (3099.0), test loss: 2.9832054509056944, test len: 3099.0
2021-08-18:16:06:49,240 INFO     [param_server.py:410] Lock worker 3 with localStep 163 , while globalStep is 163

2021-08-18:16:06:49,240 INFO     [param_server.py:441] ====Epoch 164 completes 20 clients with loss 8.388712383584492, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:49,240 INFO     [param_server.py:450] ====Start to sample for epoch 164, global virtualClock: 5264.167503797361, round_duration: 29.468813805062297
2021-08-18:16:06:49,241 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:49,531 INFO     [param_server.py:553] For epoch: 164, median_reward: 351.09318332602805, dev: 702.1863666520561
2021-08-18:16:06:50,134 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9701, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:06:50,135 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2261.5518, eval_time 0.569, test_loss 2.9701, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:06:50,134 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6686, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:06:50,135 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2261.5494, eval_time 0.5688, test_loss 2.6686, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:06:50,159 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0406, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:06:50,160 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2261.5795, eval_time 0.5946, test_loss 3.0406, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:06:50,203 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:50,212 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:50,219 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:50,224 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:50,234 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:50,240 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:50,978 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:51,5 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:51,412 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:51,426 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:52,189 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:52,216 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:52,661 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:52,680 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:52,797 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:52,821 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:52,887 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:52,920 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:53,571 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:53,599 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:53,973 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:53,991 INFO     [learner.py:606] ====Pushing takes 0.016271352767944336 s
2021-08-18:16:06:54,14 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:54,20 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:54,21 INFO     [param_server.py:410] Lock worker 1 with localStep 164 , while globalStep is 163

2021-08-18:16:06:54,851 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:54,869 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:55,430 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:55,444 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:56,539 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:56,558 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:57,184 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:57,197 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:57,677 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:57,691 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:58,388 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:58,402 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:58,874 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:58,900 INFO     [learner.py:606] ====Pushing takes 0.024466753005981445 s
2021-08-18:16:06:58,926 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:58,933 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:58,934 INFO     [param_server.py:410] Lock worker 2 with localStep 164 , while globalStep is 163

2021-08-18:16:06:59,404 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:59,414 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:00,65 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:00,82 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:00,792 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:00,805 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:01,997 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:02,15 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:02,637 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:02,676 INFO     [learner.py:606] ====Pushing takes 0.03739523887634277 s
2021-08-18:16:07:02,720 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:02,732 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:02,732 INFO     [param_server.py:381] ====After aggregation in epoch: 163, virtual_clock: 5302.563525356147, top_1: : 62.02 % (1922.0), top_5: : 100.0 % (3099.0), test loss: 2.8930887116326223, test len: 3099.0
2021-08-18:16:07:02,735 INFO     [param_server.py:410] Lock worker 3 with localStep 164 , while globalStep is 164

2021-08-18:16:07:02,735 INFO     [param_server.py:441] ====Epoch 165 completes 20 clients with loss 6.332094616932167, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:02,736 INFO     [param_server.py:450] ====Start to sample for epoch 165, global virtualClock: 5302.563525356147, round_duration: 38.39602155878561
2021-08-18:16:07:02,736 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:03,29 INFO     [param_server.py:553] For epoch: 165, median_reward: 326.0185757108811, dev: 652.0371514217622
2021-08-18:16:07:03,615 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.156, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:16:07:03,618 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2275.0321, eval_time 0.5543, test_loss 3.156, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:16:07:03,668 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2315, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:16:07:03,671 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2275.0884, eval_time 0.6077, test_loss 3.2315, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:16:07:03,693 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:07:03,703 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:03,707 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1793, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:07:03,710 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2275.1295, eval_time 0.6464, test_loss 3.1793, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:07:03,764 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:07:03,777 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:07:03,778 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:03,802 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:04,583 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:04,610 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:05,69 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:05,83 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:05,858 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:05,872 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:05,901 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:05,914 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:05,938 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:05,971 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:06,588 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:06,621 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:07,174 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:07,207 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:07,595 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:07,609 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:07,656 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:07,681 INFO     [learner.py:606] ====Pushing takes 0.023623228073120117 s
2021-08-18:16:07:07,703 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:07,709 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:07,710 INFO     [param_server.py:410] Lock worker 1 with localStep 165 , while globalStep is 164

2021-08-18:16:07:07,799 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:07,813 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:08,459 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:08,480 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:09,65 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:09,86 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:09,548 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:09,562 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:10,129 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:10,139 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:10,943 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:10,956 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:11,351 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:11,378 INFO     [learner.py:606] ====Pushing takes 0.025940895080566406 s
2021-08-18:16:07:11,407 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:11,414 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:11,415 INFO     [param_server.py:410] Lock worker 2 with localStep 165 , while globalStep is 164

2021-08-18:16:07:11,579 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:11,593 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:12,202 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:12,211 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:12,811 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:12,821 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:13,381 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:13,417 INFO     [learner.py:606] ====Pushing takes 0.03459453582763672 s
2021-08-18:16:07:13,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:13,462 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:13,463 INFO     [param_server.py:381] ====After aggregation in epoch: 164, virtual_clock: 5332.032339161209, top_1: : 59.2772 % (1837.0), top_5: : 100.0 % (3099.0), test loss: 3.188948662192733, test len: 3099.0
2021-08-18:16:07:13,465 INFO     [param_server.py:410] Lock worker 3 with localStep 165 , while globalStep is 165

2021-08-18:16:07:13,466 INFO     [param_server.py:441] ====Epoch 166 completes 20 clients with loss 7.805993294019352, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:13,466 INFO     [param_server.py:450] ====Start to sample for epoch 166, global virtualClock: 5332.032339161209, round_duration: 29.468813805062297
2021-08-18:16:07:13,467 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:13,741 INFO     [param_server.py:553] For epoch: 166, median_reward: 363.9923081945233, dev: 727.9846163890466
2021-08-18:16:07:14,329 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9271, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:07:14,330 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2285.7496, eval_time 0.5557, test_loss 2.9271, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:07:14,401 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:14,427 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:14,445 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7013, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:07:14,446 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.718, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:16:07:14,465 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2285.8787, eval_time 0.6888, test_loss 2.7013, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:07:14,465 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2285.8819, eval_time 0.6906, test_loss 2.718, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:16:07:14,535 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:14,550 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:14,578 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:14,586 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:15,168 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:15,196 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:15,749 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:15,764 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:16,406 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:16,428 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:17,31 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:17,49 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:17,57 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:17,84 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:17,449 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:17,458 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:17,688 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:17,716 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:18,81 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:18,99 INFO     [learner.py:606] ====Pushing takes 0.016761064529418945 s
2021-08-18:16:07:18,131 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:18,140 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:18,141 INFO     [param_server.py:410] Lock worker 1 with localStep 166 , while globalStep is 165

2021-08-18:16:07:19,290 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:19,302 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:19,806 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:19,821 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:20,974 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:20,988 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:21,621 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:21,634 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:22,107 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:22,126 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:22,892 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:22,915 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:23,392 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:23,420 INFO     [learner.py:606] ====Pushing takes 0.02741551399230957 s
2021-08-18:16:07:23,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:23,465 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:23,466 INFO     [param_server.py:410] Lock worker 2 with localStep 166 , while globalStep is 165

2021-08-18:16:07:24,7 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:24,20 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:24,571 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:24,581 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:25,326 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:25,335 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:26,427 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:26,439 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:27,33 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:27,71 INFO     [learner.py:606] ====Pushing takes 0.03641867637634277 s
2021-08-18:16:07:27,117 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:27,126 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:27,127 INFO     [param_server.py:381] ====After aggregation in epoch: 165, virtual_clock: 5370.428360719995, top_1: : 61.2778 % (1899.0), top_5: : 100.0 % (3099.0), test loss: 2.7821545954103826, test len: 3099.0
2021-08-18:16:07:27,129 INFO     [param_server.py:410] Lock worker 3 with localStep 166 , while globalStep is 166

2021-08-18:16:07:27,129 INFO     [param_server.py:441] ====Epoch 167 completes 20 clients with loss 6.057532638881335, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:27,130 INFO     [param_server.py:450] ====Start to sample for epoch 167, global virtualClock: 5370.428360719995, round_duration: 38.39602155878561
2021-08-18:16:07:27,130 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:27,407 INFO     [param_server.py:553] For epoch: 167, median_reward: 350.7934161687526, dev: 701.5868323375051
2021-08-18:16:07:28,14 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5123, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:07:28,15 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2299.4292, eval_time 0.571, test_loss 2.5123, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:07:28,16 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0237, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:07:28,17 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2299.4344, eval_time 0.5743, test_loss 3.0237, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:07:28,76 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:28,84 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:28,93 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:28,102 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:28,114 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.727, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:07:28,117 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2299.5369, eval_time 0.6764, test_loss 2.727, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:07:28,176 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:28,205 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:29,67 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:29,101 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:29,427 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:29,445 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:30,108 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:30,122 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:30,398 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:30,425 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:30,530 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:30,545 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:31,126 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:31,160 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:31,833 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:31,866 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:31,910 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:31,931 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:32,252 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:32,278 INFO     [learner.py:606] ====Pushing takes 0.0240781307220459 s
2021-08-18:16:07:32,307 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:32,314 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:32,314 INFO     [param_server.py:410] Lock worker 1 with localStep 167 , while globalStep is 166

2021-08-18:16:07:32,502 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:32,516 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:33,153 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:33,167 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:33,734 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:33,741 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:33,752 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:33,768 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:34,316 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:34,327 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:35,509 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:35,523 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:35,527 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:35,552 INFO     [learner.py:606] ====Pushing takes 0.023622751235961914 s
2021-08-18:16:07:35,589 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:35,596 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:35,597 INFO     [param_server.py:410] Lock worker 2 with localStep 167 , while globalStep is 166

2021-08-18:16:07:36,101 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:36,115 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:36,655 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:36,669 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:37,248 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:37,257 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:37,843 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:37,881 INFO     [learner.py:606] ====Pushing takes 0.03738903999328613 s
2021-08-18:16:07:37,926 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:37,939 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:37,940 INFO     [param_server.py:381] ====After aggregation in epoch: 166, virtual_clock: 5399.897174525057, top_1: : 62.02 % (1922.0), top_5: : 100.0 % (3099.0), test loss: 2.7543366176110724, test len: 3099.0
2021-08-18:16:07:37,942 INFO     [param_server.py:410] Lock worker 3 with localStep 167 , while globalStep is 167

2021-08-18:16:07:37,942 INFO     [param_server.py:441] ====Epoch 168 completes 20 clients with loss 6.323549900351874, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:37,943 INFO     [param_server.py:450] ====Start to sample for epoch 168, global virtualClock: 5399.897174525057, round_duration: 29.468813805062297
2021-08-18:16:07:37,944 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:07:38,220 INFO     [param_server.py:553] For epoch: 168, median_reward: 361.7469552372235, dev: 723.493910474447
2021-08-18:16:07:38,857 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0512, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:07:38,858 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2310.2777, eval_time 0.6037, test_loss 3.0512, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:07:38,861 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4521, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:07:38,862 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2310.276, eval_time 0.6064, test_loss 2.4521, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:07:38,863 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8353, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:16:07:38,864 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2310.2811, eval_time 0.6086, test_loss 2.8353, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:16:07:38,929 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:38,933 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:38,938 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:38,954 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:38,956 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:38,965 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:39,686 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:39,713 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:40,138 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:40,150 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:40,909 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:40,935 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:41,280 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:41,298 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:41,558 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:41,565 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:41,574 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:41,585 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:42,190 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:42,223 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:42,645 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:42,662 INFO     [learner.py:606] ====Pushing takes 0.01539468765258789 s
2021-08-18:16:07:42,692 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:42,698 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:42,698 INFO     [param_server.py:410] Lock worker 1 with localStep 168 , while globalStep is 167

2021-08-18:16:07:43,634 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:43,661 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:44,130 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:44,149 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:45,301 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:45,315 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:46,13 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:46,27 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:46,412 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:46,426 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:47,113 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:47,134 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:47,675 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:47,705 INFO     [learner.py:606] ====Pushing takes 0.028670072555541992 s
2021-08-18:16:07:47,741 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:47,748 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:47,748 INFO     [param_server.py:410] Lock worker 2 with localStep 168 , while globalStep is 167

2021-08-18:16:07:48,432 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:48,447 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:49,191 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:49,206 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:50,288 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:50,297 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:50,909 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:50,919 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:07:51,598 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:07:51,636 INFO     [learner.py:606] ====Pushing takes 0.03700971603393555 s
2021-08-18:16:07:51,684 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:51,694 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:51,694 INFO     [param_server.py:381] ====After aggregation in epoch: 167, virtual_clock: 5438.293196083843, top_1: : 61.9877 % (1921.0), top_5: : 100.0 % (3099.0), test loss: 2.779555073490849, test len: 3099.0
2021-08-18:16:07:51,699 INFO     [param_server.py:410] Lock worker 3 with localStep 168 , while globalStep is 168

2021-08-18:16:07:51,700 INFO     [param_server.py:441] ====Epoch 169 completes 20 clients with loss 8.452273240620329, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:51,700 INFO     [param_server.py:450] ====Start to sample for epoch 169, global virtualClock: 5438.293196083843, round_duration: 38.39602155878561
2021-08-18:16:07:51,701 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:07:51,987 INFO     [param_server.py:553] For epoch: 169, median_reward: 343.1952707378038, dev: 686.3905414756076
2021-08-18:16:07:52,676 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7987, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:07:52,678 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2324.0951, eval_time 0.6556, test_loss 2.7987, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:07:52,682 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.642, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:07:52,684 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2324.0979, eval_time 0.6612, test_loss 2.642, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:07:52,750 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:52,751 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:52,758 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:52,759 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:52,760 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8218, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:07:52,762 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2324.182, eval_time 0.7411, test_loss 2.8218, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:07:52,820 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:52,842 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:53,561 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:53,588 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:53,847 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:53,861 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:54,504 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:54,522 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:54,814 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:54,824 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:54,923 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:54,956 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:55,662 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:55,695 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:56,327 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:56,342 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:56,349 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:56,389 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:56,694 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:56,703 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:56,907 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:56,932 INFO     [learner.py:606] ====Pushing takes 0.023200273513793945 s
2021-08-18:16:07:56,953 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:56,959 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:56,960 INFO     [param_server.py:410] Lock worker 1 with localStep 169 , while globalStep is 168

2021-08-18:16:07:57,300 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:57,313 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:57,977 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:57,998 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:58,316 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:58,334 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:58,945 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:58,957 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:59,924 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:59,945 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:00,176 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:00,204 INFO     [learner.py:606] ====Pushing takes 0.02602529525756836 s
2021-08-18:16:08:00,236 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:00,245 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:00,246 INFO     [param_server.py:410] Lock worker 2 with localStep 169 , while globalStep is 168

2021-08-18:16:08:00,640 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:00,661 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:01,347 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:01,368 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:02,16 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:02,35 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:02,630 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:02,670 INFO     [learner.py:606] ====Pushing takes 0.03853106498718262 s
2021-08-18:16:08:02,711 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:02,720 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:02,721 INFO     [param_server.py:381] ====After aggregation in epoch: 168, virtual_clock: 5467.762009888906, top_1: : 61.9232 % (1919.0), top_5: : 100.0 % (3099.0), test loss: 2.7541711374565403, test len: 3099.0
2021-08-18:16:08:02,722 INFO     [param_server.py:410] Lock worker 3 with localStep 169 , while globalStep is 169

2021-08-18:16:08:02,723 INFO     [param_server.py:441] ====Epoch 170 completes 20 clients with loss 9.070382301355208, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:02,723 INFO     [param_server.py:450] ====Start to sample for epoch 170, global virtualClock: 5467.762009888906, round_duration: 29.468813805062297
2021-08-18:16:08:02,724 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:03,65 INFO     [param_server.py:553] For epoch: 170, median_reward: 386.7146538042103, dev: 773.4293076084206
2021-08-18:16:08:03,648 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9565, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:08:03,649 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2335.0684, eval_time 0.5579, test_loss 2.9565, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:08:03,664 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4909, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:08:03,667 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2335.0816, eval_time 0.5761, test_loss 2.4909, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:08:03,688 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0863, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:08:03,691 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2335.1085, eval_time 0.6004, test_loss 3.0863, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:08:03,724 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:08:03,736 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:08:03,742 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:03,746 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:03,759 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:08:03,768 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:04,402 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:04,422 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:05,112 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:05,130 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:05,573 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:05,600 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:06,213 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:06,240 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:06,348 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:06,362 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:06,414 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:06,423 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:06,810 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:06,837 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:07,212 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:07,229 INFO     [learner.py:606] ====Pushing takes 0.015212535858154297 s
2021-08-18:16:08:07,254 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:07,261 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:07,262 INFO     [param_server.py:410] Lock worker 1 with localStep 170 , while globalStep is 169

2021-08-18:16:08:08,595 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:08,613 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:08,620 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:08,629 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:09,860 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:09,869 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:10,394 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:10,502 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:11,557 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:11,576 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:12,201 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:12,215 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:12,735 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:12,760 INFO     [learner.py:606] ====Pushing takes 0.022968530654907227 s
2021-08-18:16:08:12,788 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:12,795 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:12,795 INFO     [param_server.py:410] Lock worker 2 with localStep 170 , while globalStep is 169

2021-08-18:16:08:13,54 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:13,74 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:13,867 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:13,888 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:15,171 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:15,180 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:15,848 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:15,858 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:16,390 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:16,428 INFO     [learner.py:606] ====Pushing takes 0.0364995002746582 s
2021-08-18:16:08:16,472 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:16,482 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:16,483 INFO     [param_server.py:381] ====After aggregation in epoch: 169, virtual_clock: 5506.158031447691, top_1: : 62.2459 % (1929.0), top_5: : 100.0 % (3099.0), test loss: 2.844568967819214, test len: 3099.0
2021-08-18:16:08:16,485 INFO     [param_server.py:410] Lock worker 3 with localStep 170 , while globalStep is 170

2021-08-18:16:08:16,486 INFO     [param_server.py:441] ====Epoch 171 completes 20 clients with loss 7.926655159006337, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:16,486 INFO     [param_server.py:450] ====Start to sample for epoch 171, global virtualClock: 5506.158031447691, round_duration: 38.39602155878561
2021-08-18:16:08:16,487 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:16,845 INFO     [param_server.py:553] For epoch: 171, median_reward: 333.8283453180778, dev: 667.6566906361556
2021-08-18:16:08:17,364 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6526, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:08:17,365 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2348.7794, eval_time 0.4949, test_loss 2.6526, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:08:17,409 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8658, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:08:17,410 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2348.8271, eval_time 0.5397, test_loss 2.8658, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:08:17,414 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5236, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:08:17,417 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2348.837, eval_time 0.5491, test_loss 3.5236, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:08:17,434 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:17,443 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:17,474 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:17,482 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:17,492 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:17,498 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:18,149 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:18,169 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:18,646 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:18,660 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:19,290 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:19,304 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:19,495 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:19,515 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:19,518 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:19,528 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:20,197 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:20,233 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:20,799 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:20,826 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:21,30 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:21,44 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:21,295 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:21,320 INFO     [learner.py:606] ====Pushing takes 0.022909879684448242 s
2021-08-18:16:08:21,350 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:21,355 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:21,360 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:21,360 INFO     [param_server.py:410] Lock worker 1 with localStep 171 , while globalStep is 170

2021-08-18:16:08:21,364 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:21,868 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:21,879 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:22,485 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:22,499 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:22,870 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:22,884 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:23,451 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:23,461 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:24,84 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:24,103 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:24,570 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:24,596 INFO     [learner.py:606] ====Pushing takes 0.024806737899780273 s
2021-08-18:16:08:24,632 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:24,639 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:24,640 INFO     [param_server.py:410] Lock worker 2 with localStep 171 , while globalStep is 170

2021-08-18:16:08:24,818 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:24,844 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:25,550 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:25,577 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:26,138 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:26,165 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:26,897 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:26,933 INFO     [learner.py:606] ====Pushing takes 0.03470134735107422 s
2021-08-18:16:08:26,979 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:26,988 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:26,989 INFO     [param_server.py:381] ====After aggregation in epoch: 170, virtual_clock: 5535.626845252754, top_1: : 62.3427 % (1932.0), top_5: : 100.0 % (3099.0), test loss: 3.0140009102997958, test len: 3099.0
2021-08-18:16:08:26,991 INFO     [param_server.py:410] Lock worker 3 with localStep 171 , while globalStep is 171

2021-08-18:16:08:26,992 INFO     [param_server.py:441] ====Epoch 172 completes 20 clients with loss 7.569264520047406, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:26,992 INFO     [param_server.py:450] ====Start to sample for epoch 172, global virtualClock: 5535.626845252754, round_duration: 29.468813805062297
2021-08-18:16:08:26,994 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:27,331 INFO     [param_server.py:553] For epoch: 172, median_reward: 368.3522285544254, dev: 736.7044571088508
2021-08-18:16:08:27,967 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.975, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:08:27,968 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2359.3882, eval_time 0.6045, test_loss 2.975, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:08:28,11 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7858, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:08:28,12 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2359.4263, eval_time 0.6468, test_loss 2.7858, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:08:28,19 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9003, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:08:28,32 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:28,20 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2359.4371, eval_time 0.6548, test_loss 2.9003, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:08:28,61 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:28,79 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:28,91 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:28,112 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:28,122 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:28,714 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:28,735 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:29,248 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:29,257 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:29,838 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:29,858 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:30,431 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:30,437 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:30,450 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:30,451 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:30,683 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:30,692 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:30,991 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:31,12 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:31,334 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:31,352 INFO     [learner.py:606] ====Pushing takes 0.016447782516479492 s
2021-08-18:16:08:31,389 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:31,395 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:31,395 INFO     [param_server.py:410] Lock worker 1 with localStep 172 , while globalStep is 171

2021-08-18:16:08:33,7 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:33,26 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:33,112 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:33,121 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:34,259 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:34,269 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:34,881 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:34,892 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:35,936 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:35,954 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:36,528 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:36,537 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:36,995 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:36,997 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:37,11 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:37,24 INFO     [learner.py:606] ====Pushing takes 0.02701425552368164 s
2021-08-18:16:08:37,63 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:37,70 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:37,72 INFO     [param_server.py:410] Lock worker 2 with localStep 172 , while globalStep is 171

2021-08-18:16:08:37,658 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:37,672 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:38,664 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:38,691 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:39,396 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:39,423 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:40,27 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:40,64 INFO     [learner.py:606] ====Pushing takes 0.03619790077209473 s
2021-08-18:16:08:40,110 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:40,122 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:40,123 INFO     [param_server.py:381] ====After aggregation in epoch: 171, virtual_clock: 5574.02286681154, top_1: : 62.6976 % (1943.0), top_5: : 100.0 % (3099.0), test loss: 2.8870053556230335, test len: 3099.0
2021-08-18:16:08:40,125 INFO     [param_server.py:410] Lock worker 3 with localStep 172 , while globalStep is 172

2021-08-18:16:08:40,125 INFO     [param_server.py:441] ====Epoch 173 completes 20 clients with loss 7.801135788020876, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:40,126 INFO     [param_server.py:450] ====Start to sample for epoch 173, global virtualClock: 5574.02286681154, round_duration: 38.39602155878561
2021-08-18:16:08:40,127 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:40,468 INFO     [param_server.py:553] For epoch: 173, median_reward: 379.78948571566707, dev: 759.5789714313341
2021-08-18:16:08:41,80 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.77, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:08:41,83 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2372.5027, eval_time 0.5818, test_loss 2.77, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:08:41,125 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5232, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:08:41,126 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2372.5401, eval_time 0.622, test_loss 2.5232, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:08:41,138 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7167, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:08:41,139 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2372.5558, eval_time 0.637, test_loss 2.7167, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:08:41,151 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:41,166 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:41,193 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:41,201 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:41,214 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:41,225 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:41,909 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:41,929 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:42,423 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:42,437 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:43,87 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:43,98 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:43,108 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:43,116 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:43,422 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:43,435 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:43,754 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:43,775 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:44,436 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:44,457 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:44,885 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:44,909 INFO     [learner.py:606] ====Pushing takes 0.02330803871154785 s
2021-08-18:16:08:44,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:44,942 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:44,943 INFO     [param_server.py:410] Lock worker 1 with localStep 173 , while globalStep is 172

2021-08-18:16:08:45,1 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:45,23 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:45,147 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:45,157 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:45,702 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:45,711 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:46,338 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:46,348 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:46,976 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:46,995 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:47,634 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:47,645 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:48,104 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:48,114 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:48,706 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:48,715 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:48,760 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:48,787 INFO     [learner.py:606] ====Pushing takes 0.025127887725830078 s
2021-08-18:16:08:48,815 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:48,823 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:48,824 INFO     [param_server.py:410] Lock worker 2 with localStep 173 , while globalStep is 172

2021-08-18:16:08:49,219 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:49,228 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:49,804 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:49,818 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:50,319 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:50,356 INFO     [learner.py:606] ====Pushing takes 0.035503387451171875 s
2021-08-18:16:08:50,396 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:50,405 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:50,406 INFO     [param_server.py:381] ====After aggregation in epoch: 172, virtual_clock: 5603.491680616602, top_1: : 62.9558 % (1951.0), top_5: : 100.0 % (3099.0), test loss: 2.6699796650144787, test len: 3099.0
2021-08-18:16:08:50,408 INFO     [param_server.py:410] Lock worker 3 with localStep 173 , while globalStep is 173

2021-08-18:16:08:50,408 INFO     [param_server.py:441] ====Epoch 174 completes 20 clients with loss 9.02514587065945, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:50,408 INFO     [param_server.py:450] ====Start to sample for epoch 174, global virtualClock: 5603.491680616602, round_duration: 29.468813805062297
2021-08-18:16:08:50,409 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:50,693 INFO     [param_server.py:553] For epoch: 174, median_reward: 318.9092486810795, dev: 637.818497362159
2021-08-18:16:08:51,390 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7795, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:08:51,391 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2382.811, eval_time 0.642, test_loss 2.7795, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:08:51,424 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7035, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:08:51,425 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2382.8426, eval_time 0.676, test_loss 2.7035, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:08:51,466 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:08:51,500 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:51,512 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2818, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:08:51,513 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2382.9273, eval_time 0.7606, test_loss 3.2818, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:08:51,543 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:08:51,553 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:51,582 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:08:51,599 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:52,328 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:52,368 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:52,695 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:52,709 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:53,609 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:53,636 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:53,999 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:54,13 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:54,260 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:54,287 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:54,409 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:54,423 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:54,854 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:54,881 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:55,255 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:55,273 INFO     [learner.py:606] ====Pushing takes 0.01689291000366211 s
2021-08-18:16:08:55,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:55,305 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:55,306 INFO     [param_server.py:410] Lock worker 1 with localStep 174 , while globalStep is 173

2021-08-18:16:08:56,415 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:56,425 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:56,836 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:56,845 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:58,58 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:58,70 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:58,721 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:58,730 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:59,326 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:59,345 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:00,79 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:00,98 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:00,647 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:00,673 INFO     [learner.py:606] ====Pushing takes 0.023861169815063477 s
2021-08-18:16:09:00,705 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:00,715 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:00,716 INFO     [param_server.py:410] Lock worker 2 with localStep 174 , while globalStep is 173

2021-08-18:16:09:00,738 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:00,752 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:01,318 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:01,329 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:02,582 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:02,601 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:03,291 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:03,311 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:04,18 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:04,56 INFO     [learner.py:606] ====Pushing takes 0.03638935089111328 s
2021-08-18:16:09:04,100 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:04,110 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:04,111 INFO     [param_server.py:381] ====After aggregation in epoch: 173, virtual_clock: 5641.887702175388, top_1: : 61.9555 % (1920.0), top_5: : 100.0 % (3099.0), test loss: 2.9216070660838374, test len: 3099.0
2021-08-18:16:09:04,113 INFO     [param_server.py:410] Lock worker 3 with localStep 174 , while globalStep is 174

2021-08-18:16:09:04,114 INFO     [param_server.py:441] ====Epoch 175 completes 20 clients with loss 8.00166483299687, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:04,114 INFO     [param_server.py:450] ====Start to sample for epoch 175, global virtualClock: 5641.887702175388, round_duration: 38.39602155878561
2021-08-18:16:09:04,115 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:08,369 INFO     [param_server.py:553] For epoch: 175, median_reward: 319.09051575161027, dev: 638.1810315032205
2021-08-18:16:09:09,72 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8963, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:09:09,75 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2400.4926, eval_time 0.6465, test_loss 2.8963, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:09:09,110 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7955, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:09:09,111 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2400.5255, eval_time 0.6753, test_loss 2.7955, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:09:09,157 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6421, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:09:09,160 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2400.58, eval_time 0.7358, test_loss 2.6421, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:09:09,182 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:09:09,182 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:09:09,196 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:09,199 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:09,230 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:09:09,255 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:10,5 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:10,30 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:10,614 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:10,629 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:11,344 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:11,354 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:11,359 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:11,369 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:11,613 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:11,622 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:12,68 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:12,82 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:12,671 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:12,681 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:13,128 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:13,141 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:13,151 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:13,153 INFO     [learner.py:606] ====Pushing takes 0.024420499801635742 s
2021-08-18:16:09:13,176 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:13,181 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:13,182 INFO     [param_server.py:410] Lock worker 1 with localStep 175 , while globalStep is 174

2021-08-18:16:09:13,417 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:13,427 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:14,11 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:14,21 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:14,604 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:14,615 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:14,953 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:14,963 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:15,641 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:15,653 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:16,199 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:16,209 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:16,847 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:16,856 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:16,912 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:16,937 INFO     [learner.py:606] ====Pushing takes 0.02368330955505371 s
2021-08-18:16:09:16,964 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:16,970 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:16,971 INFO     [param_server.py:410] Lock worker 2 with localStep 175 , while globalStep is 174

2021-08-18:16:09:17,443 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:17,452 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:18,47 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:18,66 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:18,601 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:18,636 INFO     [learner.py:606] ====Pushing takes 0.03354310989379883 s
2021-08-18:16:09:18,672 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:18,684 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:18,685 INFO     [param_server.py:381] ====After aggregation in epoch: 174, virtual_clock: 5671.35651598045, top_1: : 62.2782 % (1930.0), top_5: : 100.0 % (3099.0), test loss: 2.777974444407004, test len: 3099.0
2021-08-18:16:09:18,705 INFO     [param_server.py:410] Lock worker 3 with localStep 175 , while globalStep is 175

2021-08-18:16:09:18,706 INFO     [param_server.py:441] ====Epoch 176 completes 20 clients with loss 7.497274975422247, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:18,706 INFO     [param_server.py:450] ====Start to sample for epoch 176, global virtualClock: 5671.35651598045, round_duration: 29.468813805062297
2021-08-18:16:09:18,707 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:18,962 INFO     [param_server.py:553] For epoch: 176, median_reward: 311.08518898837457, dev: 622.1703779767491
2021-08-18:16:09:19,571 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6721, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:09:19,572 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2410.989, eval_time 0.5445, test_loss 2.6721, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:09:19,601 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7083, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:09:19,602 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2411.0164, eval_time 0.5747, test_loss 2.7083, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:09:19,663 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:19,669 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:19,676 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:19,687 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:19,718 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8616, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:09:19,719 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2411.1386, eval_time 0.6915, test_loss 2.8616, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:09:19,784 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:19,816 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:20,718 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:20,752 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:20,814 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:20,828 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:21,821 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:21,832 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:21,940 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:21,960 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:22,443 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:22,458 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:22,536 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:22,556 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:23,89 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:23,109 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:23,431 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:23,449 INFO     [learner.py:606] ====Pushing takes 0.017297744750976562 s
2021-08-18:16:09:23,477 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:23,483 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:23,483 INFO     [param_server.py:410] Lock worker 1 with localStep 176 , while globalStep is 175

2021-08-18:16:09:24,215 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:24,233 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:24,795 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:24,809 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:26,69 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:26,79 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:26,713 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:26,723 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:26,937 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:26,949 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:27,551 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:27,614 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:28,160 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:28,189 INFO     [learner.py:606] ====Pushing takes 0.02513289451599121 s
2021-08-18:16:09:28,219 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:28,226 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:28,226 INFO     [param_server.py:410] Lock worker 2 with localStep 176 , while globalStep is 175

2021-08-18:16:09:28,901 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:28,910 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:29,507 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:29,516 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:30,556 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:30,566 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:31,134 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:31,148 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:31,650 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:31,690 INFO     [learner.py:606] ====Pushing takes 0.037729501724243164 s
2021-08-18:16:09:31,733 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:31,743 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:31,744 INFO     [param_server.py:381] ====After aggregation in epoch: 175, virtual_clock: 5709.752537539236, top_1: : 62.1813 % (1927.0), top_5: : 100.0 % (3099.0), test loss: 2.747349324049773, test len: 3099.0
2021-08-18:16:09:31,747 INFO     [param_server.py:410] Lock worker 3 with localStep 176 , while globalStep is 176

2021-08-18:16:09:31,747 INFO     [param_server.py:441] ====Epoch 177 completes 20 clients with loss 7.127072405982667, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:31,748 INFO     [param_server.py:450] ====Start to sample for epoch 177, global virtualClock: 5709.752537539236, round_duration: 38.39602155878561
2021-08-18:16:09:31,749 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:32,48 INFO     [param_server.py:553] For epoch: 177, median_reward: 357.45569772989984, dev: 714.9113954597997
2021-08-18:16:09:32,780 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8994, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:09:32,781 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2424.1978, eval_time 0.667, test_loss 2.8994, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:09:32,810 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5079, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:09:32,811 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2424.225, eval_time 0.6942, test_loss 2.5079, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:09:32,871 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:32,876 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:32,886 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:32,895 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:32,934 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8771, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:09:32,938 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2424.3579, eval_time 0.8247, test_loss 2.8771, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:09:33,6 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:33,47 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:33,854 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:33,883 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:33,950 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:33,959 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:34,649 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:34,663 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:35,106 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:35,127 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:35,128 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:35,137 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:35,744 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:35,765 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:36,334 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:36,344 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:36,426 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:36,440 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:36,810 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:36,833 INFO     [learner.py:606] ====Pushing takes 0.02193427085876465 s
2021-08-18:16:09:36,856 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:36,861 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:36,862 INFO     [param_server.py:410] Lock worker 1 with localStep 177 , while globalStep is 176

2021-08-18:16:09:37,129 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:37,143 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:37,812 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:37,826 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:38,38 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:38,57 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:38,395 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:38,405 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:38,586 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:38,598 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:39,883 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:39,909 INFO     [learner.py:606] ====Pushing takes 0.024530887603759766 s
2021-08-18:16:09:39,944 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:39,953 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:39,954 INFO     [param_server.py:410] Lock worker 2 with localStep 177 , while globalStep is 176

2021-08-18:16:09:40,9 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:40,19 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:40,553 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:40,563 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:41,97 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:41,107 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:41,702 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:41,712 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:42,287 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:42,324 INFO     [learner.py:606] ====Pushing takes 0.03570389747619629 s
2021-08-18:16:09:42,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:42,369 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:42,370 INFO     [param_server.py:381] ====After aggregation in epoch: 176, virtual_clock: 5739.2213513442985, top_1: : 62.7299 % (1944.0), top_5: : 100.0 % (3099.0), test loss: 2.761482486018428, test len: 3099.0
2021-08-18:16:09:42,372 INFO     [param_server.py:410] Lock worker 3 with localStep 177 , while globalStep is 177

2021-08-18:16:09:42,373 INFO     [param_server.py:441] ====Epoch 178 completes 20 clients with loss 6.592695460256635, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:42,373 INFO     [param_server.py:450] ====Start to sample for epoch 178, global virtualClock: 5739.2213513442985, round_duration: 29.468813805062297
2021-08-18:16:09:42,374 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:42,659 INFO     [param_server.py:553] For epoch: 178, median_reward: 367.3953411955324, dev: 734.7906823910648
2021-08-18:16:09:43,312 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5082, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:09:43,315 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2434.7294, eval_time 0.5989, test_loss 2.5082, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:09:43,347 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6699, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:09:43,348 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2434.7649, eval_time 0.6326, test_loss 2.6699, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:09:43,348 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6694, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:09:43,349 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2434.7684, eval_time 0.6347, test_loss 2.6694, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:09:43,382 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:43,391 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:43,412 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:43,417 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:43,430 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:43,442 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:44,245 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:44,272 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:44,622 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:44,631 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:45,464 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:45,492 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:45,680 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:45,692 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:46,164 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:46,197 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:46,485 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:46,500 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:46,776 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:46,804 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:47,176 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:47,193 INFO     [learner.py:606] ====Pushing takes 0.01526188850402832 s
2021-08-18:16:09:47,220 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:47,226 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:47,226 INFO     [param_server.py:410] Lock worker 1 with localStep 178 , while globalStep is 177

2021-08-18:16:09:48,163 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:48,181 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:48,873 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:48,882 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:49,994 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:50,13 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:50,660 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:50,674 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:51,2 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:51,13 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:51,718 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:51,727 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:52,240 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:52,265 INFO     [learner.py:606] ====Pushing takes 0.022934913635253906 s
2021-08-18:16:09:52,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:52,298 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:52,299 INFO     [param_server.py:410] Lock worker 2 with localStep 178 , while globalStep is 177

2021-08-18:16:09:52,826 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:52,836 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:53,509 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:53,518 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:54,653 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:54,662 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:55,240 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:55,249 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:55,787 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:55,825 INFO     [learner.py:606] ====Pushing takes 0.03600716590881348 s
2021-08-18:16:09:55,860 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:55,870 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:55,871 INFO     [param_server.py:381] ====After aggregation in epoch: 177, virtual_clock: 5777.617372903084, top_1: : 63.0203 % (1953.0), top_5: : 100.0 % (3099.0), test loss: 2.615843527846866, test len: 3099.0
2021-08-18:16:09:55,874 INFO     [param_server.py:410] Lock worker 3 with localStep 178 , while globalStep is 178

2021-08-18:16:09:55,874 INFO     [param_server.py:441] ====Epoch 179 completes 20 clients with loss 7.822911406647035, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:55,875 INFO     [param_server.py:450] ====Start to sample for epoch 179, global virtualClock: 5777.617372903084, round_duration: 38.39602155878561
2021-08-18:16:09:55,875 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:56,145 INFO     [param_server.py:553] For epoch: 179, median_reward: 335.6925197290258, dev: 671.3850394580516
2021-08-18:16:09:56,869 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9418, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:09:56,870 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2448.2874, eval_time 0.6681, test_loss 2.9418, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:09:56,872 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8293, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:09:56,873 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2448.2873, eval_time 0.6698, test_loss 2.8293, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:09:56,941 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:09:56,958 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:56,965 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:09:56,978 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:56,976 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7427, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:09:56,979 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2448.3983, eval_time 0.7773, test_loss 2.7427, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:09:57,33 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:09:57,62 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:57,768 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:57,802 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:58,57 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:58,68 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:58,686 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:58,707 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:59,199 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:59,226 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:59,336 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:59,350 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:59,883 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:59,910 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:00,444 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:00,456 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:00,499 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:00,513 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:00,890 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:00,915 INFO     [learner.py:606] ====Pushing takes 0.022844791412353516 s
2021-08-18:16:10:00,937 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:00,945 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:00,946 INFO     [param_server.py:410] Lock worker 1 with localStep 179 , while globalStep is 178

2021-08-18:16:10:01,205 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:01,214 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:01,737 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:01,746 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:02,197 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:02,206 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:02,270 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:02,280 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:02,791 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:02,804 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:03,828 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:03,846 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:03,907 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:03,933 INFO     [learner.py:606] ====Pushing takes 0.023602962493896484 s
2021-08-18:16:10:03,960 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:03,967 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:03,968 INFO     [param_server.py:410] Lock worker 2 with localStep 179 , while globalStep is 178

2021-08-18:16:10:04,369 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:04,383 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:04,868 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:04,883 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:05,470 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:05,484 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:06,90 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:06,128 INFO     [learner.py:606] ====Pushing takes 0.03595685958862305 s
2021-08-18:16:10:06,170 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:06,179 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:06,180 INFO     [param_server.py:381] ====After aggregation in epoch: 178, virtual_clock: 5807.086186708147, top_1: : 62.5686 % (1939.0), top_5: : 100.0 % (3099.0), test loss: 2.837948375278049, test len: 3099.0
2021-08-18:16:10:06,182 INFO     [param_server.py:410] Lock worker 3 with localStep 179 , while globalStep is 179

2021-08-18:16:10:06,182 INFO     [param_server.py:441] ====Epoch 180 completes 20 clients with loss 7.708596566669259, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:06,183 INFO     [param_server.py:450] ====Start to sample for epoch 180, global virtualClock: 5807.086186708147, round_duration: 29.468813805062297
2021-08-18:16:10:06,183 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:06,461 INFO     [param_server.py:553] For epoch: 180, median_reward: 346.6758527661094, dev: 693.3517055322188
2021-08-18:16:10:07,14 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6892, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:10:07,15 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2458.4292, eval_time 0.509, test_loss 2.6892, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:10:07,63 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8724, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:10:07,64 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2458.4811, eval_time 0.558, test_loss 2.8724, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:10:07,91 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:10:07,100 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:07,101 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3338, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:10:07,102 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2458.5218, eval_time 0.5962, test_loss 3.3338, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:10:07,136 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:10:07,150 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:07,185 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:10:07,217 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:08,25 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:08,54 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:08,384 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:08,396 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:09,266 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:09,293 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:09,381 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:09,392 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:09,743 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:09,758 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:09,918 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:09,946 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:10,505 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:10,533 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:10,907 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:10,925 INFO     [learner.py:606] ====Pushing takes 0.017157793045043945 s
2021-08-18:16:10:10,947 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:10,953 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:10,954 INFO     [param_server.py:410] Lock worker 1 with localStep 180 , while globalStep is 179

2021-08-18:16:10:11,667 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:11,686 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:12,370 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:12,385 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:13,489 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:13,503 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:14,177 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:14,186 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:14,711 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:14,724 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:15,324 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:15,335 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:15,854 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:15,895 INFO     [learner.py:606] ====Pushing takes 0.03914284706115723 s
2021-08-18:16:10:15,931 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:15,938 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:15,939 INFO     [param_server.py:410] Lock worker 2 with localStep 180 , while globalStep is 179

2021-08-18:16:10:16,472 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:16,482 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:17,59 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:17,68 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:18,108 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:18,122 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:18,847 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:18,862 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:19,495 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:19,534 INFO     [learner.py:606] ====Pushing takes 0.037180185317993164 s
2021-08-18:16:10:19,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:19,593 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:19,594 INFO     [param_server.py:381] ====After aggregation in epoch: 179, virtual_clock: 5845.4822082669325, top_1: : 62.4072 % (1934.0), top_5: : 100.0 % (3099.0), test loss: 2.9651163154178195, test len: 3099.0
2021-08-18:16:10:19,596 INFO     [param_server.py:410] Lock worker 3 with localStep 180 , while globalStep is 180

2021-08-18:16:10:19,597 INFO     [param_server.py:441] ====Epoch 181 completes 20 clients with loss 6.075586168679246, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:19,597 INFO     [param_server.py:450] ====Start to sample for epoch 181, global virtualClock: 5845.4822082669325, round_duration: 38.39602155878561
2021-08-18:16:10:19,598 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:19,885 INFO     [param_server.py:541] Handle Wight 0.05011487007141113 | Send 0.2872023582458496
2021-08-18:16:10:19,886 INFO     [param_server.py:553] For epoch: 181, median_reward: 387.712294996028, dev: 775.424589992056
2021-08-18:16:10:20,547 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8445, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:10:20,548 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2471.9624, eval_time 0.6159, test_loss 2.8445, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:10:20,592 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8358, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:10:20,593 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2472.0106, eval_time 0.6635, test_loss 2.8358, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:10:20,616 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:20,623 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:20,669 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.992, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:10:20,673 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2472.0923, eval_time 0.7431, test_loss 2.992, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:10:20,694 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:20,709 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:20,743 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:20,772 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:21,556 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:21,590 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:21,960 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:21,970 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:22,627 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:22,641 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:22,918 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:22,945 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:22,986 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:23,4 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:23,515 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:23,542 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:24,131 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:24,158 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:24,409 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:24,425 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:24,641 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:24,668 INFO     [learner.py:606] ====Pushing takes 0.025583505630493164 s
2021-08-18:16:10:24,698 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:24,704 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:24,704 INFO     [param_server.py:410] Lock worker 1 with localStep 181 , while globalStep is 180

2021-08-18:16:10:25,317 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:25,332 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:25,923 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:25,937 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:26,200 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:26,211 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:26,548 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:26,557 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:26,810 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:26,819 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:28,117 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:28,147 INFO     [learner.py:606] ====Pushing takes 0.024825096130371094 s
2021-08-18:16:10:28,181 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:28,188 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:28,189 INFO     [param_server.py:410] Lock worker 2 with localStep 181 , while globalStep is 180

2021-08-18:16:10:28,199 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:28,209 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:28,811 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:28,821 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:29,337 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:29,346 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:29,824 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:29,833 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:30,303 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:30,340 INFO     [learner.py:606] ====Pushing takes 0.03613901138305664 s
2021-08-18:16:10:30,394 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:30,403 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:30,404 INFO     [param_server.py:381] ====After aggregation in epoch: 180, virtual_clock: 5874.951022071995, top_1: : 61.3424 % (1901.0), top_5: : 100.0 % (3099.0), test loss: 2.8907701041963367, test len: 3099.0
2021-08-18:16:10:30,408 INFO     [param_server.py:410] Lock worker 3 with localStep 181 , while globalStep is 181

2021-08-18:16:10:30,409 INFO     [param_server.py:441] ====Epoch 182 completes 20 clients with loss 6.9182177322304526, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:30,409 INFO     [param_server.py:450] ====Start to sample for epoch 182, global virtualClock: 5874.951022071995, round_duration: 29.468813805062297
2021-08-18:16:10:30,410 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:30,759 INFO     [param_server.py:553] For epoch: 182, median_reward: 369.36417841581897, dev: 738.7283568316379
2021-08-18:16:10:31,395 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8206, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:10:31,396 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2482.8158, eval_time 0.5912, test_loss 2.8206, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:10:31,424 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4564, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:10:31,425 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2482.8392, eval_time 0.6184, test_loss 2.4564, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:10:31,461 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:31,476 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9358, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:10:31,478 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2482.8949, eval_time 0.6727, test_loss 2.9358, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:10:31,487 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:31,493 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:31,502 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:31,584 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:31,598 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:32,298 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:32,332 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:32,900 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:32,915 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:33,538 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:33,571 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:34,30 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:34,50 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:34,193 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:34,221 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:34,376 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:34,385 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:34,790 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:34,817 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:35,195 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:35,213 INFO     [learner.py:606] ====Pushing takes 0.016847610473632812 s
2021-08-18:16:10:35,246 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:35,252 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:35,252 INFO     [param_server.py:410] Lock worker 1 with localStep 182 , while globalStep is 181

2021-08-18:16:10:36,451 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:36,469 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:37,24 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:37,44 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:38,119 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:38,139 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:38,770 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:38,784 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:39,134 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:39,145 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:39,850 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:39,862 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:40,400 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:40,427 INFO     [learner.py:606] ====Pushing takes 0.025861263275146484 s
2021-08-18:16:10:40,461 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:40,471 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:40,471 INFO     [param_server.py:410] Lock worker 2 with localStep 182 , while globalStep is 181

2021-08-18:16:10:41,45 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:41,56 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:41,683 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:41,693 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:42,937 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:42,949 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:43,578 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:43,588 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:44,142 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:44,181 INFO     [learner.py:606] ====Pushing takes 0.03804588317871094 s
2021-08-18:16:10:44,226 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:44,237 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:44,238 INFO     [param_server.py:381] ====After aggregation in epoch: 181, virtual_clock: 5913.347043630781, top_1: : 63.5044 % (1968.0), top_5: : 100.0 % (3099.0), test loss: 2.737621340486738, test len: 3099.0
2021-08-18:16:10:44,240 INFO     [param_server.py:410] Lock worker 3 with localStep 182 , while globalStep is 182

2021-08-18:16:10:44,241 INFO     [param_server.py:441] ====Epoch 183 completes 20 clients with loss 6.279939745429868, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:44,241 INFO     [param_server.py:450] ====Start to sample for epoch 183, global virtualClock: 5913.347043630781, round_duration: 38.39602155878561
2021-08-18:16:10:44,243 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:44,538 INFO     [param_server.py:553] For epoch: 183, median_reward: 365.0581695584559, dev: 730.1163391169118
2021-08-18:16:10:45,129 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5869, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:10:45,130 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2496.544, eval_time 0.5456, test_loss 2.5869, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:10:45,165 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1034, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:10:45,166 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2496.5832, eval_time 0.5828, test_loss 3.1034, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:10:45,198 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:45,207 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:45,237 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:45,252 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:45,253 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2883, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:10:45,256 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2496.6758, eval_time 0.6728, test_loss 3.2883, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:10:45,322 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:45,345 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:46,204 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:46,231 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:46,398 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:46,407 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:47,74 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:47,95 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:47,494 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:47,504 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:47,597 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:47,624 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:48,245 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:48,272 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:48,759 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:48,773 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:48,781 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:48,801 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:49,135 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:49,160 INFO     [learner.py:606] ====Pushing takes 0.022897005081176758 s
2021-08-18:16:10:49,189 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:49,195 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:49,196 INFO     [param_server.py:410] Lock worker 1 with localStep 183 , while globalStep is 182

2021-08-18:16:10:49,429 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:49,442 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:50,61 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:50,81 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:50,336 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:50,346 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:50,812 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:50,833 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:51,3 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:51,17 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:52,312 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:52,349 INFO     [learner.py:606] ====Pushing takes 0.035657644271850586 s
2021-08-18:16:10:52,376 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:52,383 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:52,384 INFO     [param_server.py:410] Lock worker 2 with localStep 183 , while globalStep is 182

2021-08-18:16:10:52,691 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:52,706 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:53,375 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:53,384 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:54,6 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:54,16 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:54,572 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:54,581 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:55,217 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:55,252 INFO     [learner.py:606] ====Pushing takes 0.03380918502807617 s
2021-08-18:16:10:55,290 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:55,300 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:55,301 INFO     [param_server.py:381] ====After aggregation in epoch: 182, virtual_clock: 5942.815857435843, top_1: : 61.1165 % (1894.0), top_5: : 100.0 % (3099.0), test loss: 2.992849597224483, test len: 3099.0
2021-08-18:16:10:55,303 INFO     [param_server.py:410] Lock worker 3 with localStep 183 , while globalStep is 183

2021-08-18:16:10:55,303 INFO     [param_server.py:441] ====Epoch 184 completes 20 clients with loss 7.056462382380408, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:55,304 INFO     [param_server.py:450] ====Start to sample for epoch 184, global virtualClock: 5942.815857435843, round_duration: 29.468813805062297
2021-08-18:16:10:55,304 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:55,571 INFO     [param_server.py:553] For epoch: 184, median_reward: 333.8429176505746, dev: 667.6858353011492
2021-08-18:16:10:56,172 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6524, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:10:56,173 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2507.5875, eval_time 0.5547, test_loss 2.6524, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:10:56,203 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7179, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:10:56,204 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2507.6234, eval_time 0.5879, test_loss 2.7179, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:10:56,214 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0524, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:10:56,215 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2507.6323, eval_time 0.5966, test_loss 3.0524, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:10:56,228 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:10:56,236 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:56,270 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:10:56,283 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:10:56,293 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:56,299 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:57,27 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:57,54 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:57,500 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:57,510 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:58,169 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:58,196 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:58,534 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:58,548 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:58,821 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:58,848 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:58,929 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:58,938 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:59,419 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:59,453 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:59,874 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:59,892 INFO     [learner.py:606] ====Pushing takes 0.01685643196105957 s
2021-08-18:16:10:59,921 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:59,930 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:59,930 INFO     [param_server.py:410] Lock worker 1 with localStep 184 , while globalStep is 183

2021-08-18:16:11:00,991 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:01,11 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:01,536 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:01,557 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:02,940 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:02,967 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:03,714 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:03,728 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:03,788 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:03,809 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:04,392 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:04,407 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:05,10 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:05,36 INFO     [learner.py:606] ====Pushing takes 0.024866104125976562 s
2021-08-18:16:11:05,64 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:05,71 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:05,72 INFO     [param_server.py:410] Lock worker 2 with localStep 184 , while globalStep is 183

2021-08-18:16:11:06,200 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:06,209 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:06,851 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:06,860 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:07,908 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:07,921 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:08,482 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:08,491 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:08,964 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:09,1 INFO     [learner.py:606] ====Pushing takes 0.03542184829711914 s
2021-08-18:16:11:09,41 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:09,51 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:09,52 INFO     [param_server.py:381] ====After aggregation in epoch: 183, virtual_clock: 5981.211878994629, top_1: : 63.5366 % (1969.0), top_5: : 100.0 % (3099.0), test loss: 2.8075436971805714, test len: 3099.0
2021-08-18:16:11:09,54 INFO     [param_server.py:410] Lock worker 3 with localStep 184 , while globalStep is 184

2021-08-18:16:11:09,55 INFO     [param_server.py:441] ====Epoch 185 completes 20 clients with loss 6.902341754758806, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:09,55 INFO     [param_server.py:450] ====Start to sample for epoch 185, global virtualClock: 5981.211878994629, round_duration: 38.39602155878561
2021-08-18:16:11:09,56 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:09,332 INFO     [param_server.py:553] For epoch: 185, median_reward: 341.73503350008184, dev: 683.4700670001637
2021-08-18:16:11:09,955 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6712, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:11:09,956 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2521.37, eval_time 0.5887, test_loss 2.6712, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:11:09,993 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9236, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:16:11:09,996 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2521.4128, eval_time 0.6286, test_loss 2.9236, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:16:11:10,24 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:11:10,34 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:10,62 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7861, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:11:10,65 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2521.4848, eval_time 0.7003, test_loss 2.7861, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:11:10,66 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:11:10,79 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:10,134 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:11:10,163 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:10,894 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:10,922 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:11,346 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:11,360 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:12,143 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:12,157 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:12,198 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:12,225 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:12,261 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:12,270 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:12,940 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:12,960 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:13,558 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:13,585 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:13,938 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:13,963 INFO     [learner.py:606] ====Pushing takes 0.02319931983947754 s
2021-08-18:16:11:13,985 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:13,990 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:13,990 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:13,991 INFO     [param_server.py:410] Lock worker 1 with localStep 185 , while globalStep is 184

2021-08-18:16:11:14,0 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:14,131 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:14,145 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:14,799 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:14,819 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:15,438 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:15,458 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:15,895 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:15,907 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:16,514 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:16,524 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:17,157 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:17,205 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:17,738 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:17,753 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:17,768 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:17,792 INFO     [learner.py:606] ====Pushing takes 0.023109912872314453 s
2021-08-18:16:11:17,818 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:17,828 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:17,829 INFO     [param_server.py:410] Lock worker 2 with localStep 185 , while globalStep is 184

2021-08-18:16:11:18,355 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:18,370 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:18,968 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:18,977 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:19,514 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:19,552 INFO     [learner.py:606] ====Pushing takes 0.03632235527038574 s
2021-08-18:16:11:19,594 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:19,609 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:19,609 INFO     [param_server.py:381] ====After aggregation in epoch: 184, virtual_clock: 6010.680692799691, top_1: : 61.0197 % (1891.0), top_5: : 100.0 % (3099.0), test loss: 2.7936334587909557, test len: 3099.0
2021-08-18:16:11:19,612 INFO     [param_server.py:410] Lock worker 3 with localStep 185 , while globalStep is 185

2021-08-18:16:11:19,612 INFO     [param_server.py:441] ====Epoch 186 completes 20 clients with loss 6.43772798553821, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:19,613 INFO     [param_server.py:450] ====Start to sample for epoch 186, global virtualClock: 6010.680692799691, round_duration: 29.468813805062297
2021-08-18:16:11:19,614 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:19,887 INFO     [param_server.py:553] For epoch: 186, median_reward: 353.92057595892067, dev: 707.8411519178413
2021-08-18:16:11:20,454 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0178, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:11:20,455 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2531.8695, eval_time 0.5339, test_loss 3.0178, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:11:20,471 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0954, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:11:20,472 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2531.8913, eval_time 0.5509, test_loss 3.0954, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:11:20,522 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:20,530 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:20,545 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:20,561 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:20,588 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9154, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:11:20,590 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2532.0067, eval_time 0.6683, test_loss 2.9154, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:11:20,685 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:20,699 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:21,222 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:21,243 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:21,933 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:21,943 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:22,321 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:22,335 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:22,868 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:22,882 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:23,77 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:23,96 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:23,182 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:23,194 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:23,423 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:23,443 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:23,773 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:23,791 INFO     [learner.py:606] ====Pushing takes 0.016753673553466797 s
2021-08-18:16:11:23,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:23,823 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:23,823 INFO     [param_server.py:410] Lock worker 1 with localStep 186 , while globalStep is 185

2021-08-18:16:11:25,467 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:25,486 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:25,513 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:25,523 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:26,562 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:26,574 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:27,167 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:27,184 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:28,130 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:28,146 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:28,744 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:28,754 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:29,284 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:29,311 INFO     [learner.py:606] ====Pushing takes 0.025543689727783203 s
2021-08-18:16:11:29,338 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:29,345 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:29,345 INFO     [param_server.py:410] Lock worker 2 with localStep 186 , while globalStep is 185

2021-08-18:16:11:29,800 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:29,827 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:30,501 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:30,515 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:31,600 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:31,614 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:32,252 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:32,261 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:32,780 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:32,815 INFO     [learner.py:606] ====Pushing takes 0.034619808197021484 s
2021-08-18:16:11:32,858 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:32,868 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:32,868 INFO     [param_server.py:381] ====After aggregation in epoch: 185, virtual_clock: 6049.076714358477, top_1: : 63.3753 % (1964.0), top_5: : 100.0 % (3099.0), test loss: 3.009536593048661, test len: 3099.0
2021-08-18:16:11:32,871 INFO     [param_server.py:410] Lock worker 3 with localStep 186 , while globalStep is 186

2021-08-18:16:11:32,872 INFO     [param_server.py:441] ====Epoch 187 completes 20 clients with loss 9.370802259565679, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:32,872 INFO     [param_server.py:450] ====Start to sample for epoch 187, global virtualClock: 6049.076714358477, round_duration: 38.39602155878561
2021-08-18:16:11:32,881 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:33,165 INFO     [param_server.py:553] For epoch: 187, median_reward: 347.05122952086225, dev: 694.1024590417245
2021-08-18:16:11:33,712 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8534, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:16:11:33,713 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2545.1276, eval_time 0.5132, test_loss 2.8534, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:16:11:33,762 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6488, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:16:11:33,763 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2545.1803, eval_time 0.5639, test_loss 3.6488, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:16:11:33,782 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:33,793 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:33,805 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8776, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:11:33,808 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2545.2281, eval_time 0.6093, test_loss 2.8776, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:11:33,843 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:33,859 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:33,881 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:33,900 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:34,561 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:34,581 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:35,7 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:35,25 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:35,670 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:35,688 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:35,713 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:35,726 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:35,906 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:35,916 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:36,367 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:36,381 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:37,5 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:37,32 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:37,544 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:37,550 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:37,558 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:37,575 INFO     [learner.py:606] ====Pushing takes 0.023465871810913086 s
2021-08-18:16:11:37,606 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:37,612 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:37,613 INFO     [param_server.py:410] Lock worker 1 with localStep 187 , while globalStep is 186

2021-08-18:16:11:37,826 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:37,841 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:38,501 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:38,510 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:39,65 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:39,75 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:39,100 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:39,113 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:39,756 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:39,769 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:40,818 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:40,832 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:40,948 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:40,975 INFO     [learner.py:606] ====Pushing takes 0.025513887405395508 s
2021-08-18:16:11:41,11 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:41,20 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:41,20 INFO     [param_server.py:410] Lock worker 2 with localStep 187 , while globalStep is 186

2021-08-18:16:11:41,525 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:41,539 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:42,22 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:42,36 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:42,679 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:42,700 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:43,326 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:43,372 INFO     [learner.py:606] ====Pushing takes 0.044527530670166016 s
2021-08-18:16:11:43,415 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:43,424 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:43,425 INFO     [param_server.py:381] ====After aggregation in epoch: 186, virtual_clock: 6078.5455281635395, top_1: : 59.3095 % (1838.0), top_5: : 100.0 % (3099.0), test loss: 3.1265783376163903, test len: 3099.0
2021-08-18:16:11:43,429 INFO     [param_server.py:410] Lock worker 3 with localStep 187 , while globalStep is 187

2021-08-18:16:11:43,430 INFO     [param_server.py:441] ====Epoch 188 completes 20 clients with loss 7.916354397200138, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:43,430 INFO     [param_server.py:450] ====Start to sample for epoch 188, global virtualClock: 6078.5455281635395, round_duration: 29.468813805062297
2021-08-18:16:11:43,431 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:43,710 INFO     [param_server.py:553] For epoch: 188, median_reward: 364.14120209587065, dev: 728.2824041917413
2021-08-18:16:11:44,347 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.21, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:11:44,347 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2555.7644, eval_time 0.5812, test_loss 3.21, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:11:44,358 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8899, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:11:44,358 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2555.7782, eval_time 0.594, test_loss 2.8899, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:11:44,390 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7281, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:11:44,391 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2555.8048, eval_time 0.6232, test_loss 2.7281, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:11:44,413 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:44,422 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:44,430 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:44,453 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:44,454 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:44,465 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:45,185 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:45,206 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:45,701 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:45,710 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:46,327 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:46,348 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:46,830 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:46,839 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:46,937 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:46,957 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:47,143 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:47,154 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:47,493 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:47,514 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:47,832 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:47,851 INFO     [learner.py:606] ====Pushing takes 0.015504121780395508 s
2021-08-18:16:11:47,883 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:47,889 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:47,890 INFO     [param_server.py:410] Lock worker 1 with localStep 188 , while globalStep is 187

2021-08-18:16:11:49,70 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:49,89 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:49,418 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:49,428 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:50,457 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:50,467 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:51,47 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:51,57 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:51,985 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:51,996 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:52,590 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:52,601 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:53,152 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:53,178 INFO     [learner.py:606] ====Pushing takes 0.02460193634033203 s
2021-08-18:16:11:53,195 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:53,210 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:53,211 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:53,218 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:53,219 INFO     [param_server.py:410] Lock worker 2 with localStep 188 , while globalStep is 187

2021-08-18:16:11:53,925 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:53,939 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:55,113 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:55,134 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:55,786 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:55,813 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:56,461 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:56,498 INFO     [learner.py:606] ====Pushing takes 0.03531336784362793 s
2021-08-18:16:11:56,534 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:56,544 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:56,545 INFO     [param_server.py:381] ====After aggregation in epoch: 187, virtual_clock: 6116.941549722325, top_1: : 63.698 % (1974.0), top_5: : 100.0 % (3099.0), test loss: 2.9426488169917353, test len: 3099.0
2021-08-18:16:11:56,633 INFO     [param_server.py:410] Lock worker 3 with localStep 188 , while globalStep is 188

2021-08-18:16:11:56,634 INFO     [param_server.py:441] ====Epoch 189 completes 20 clients with loss 6.157840304262606, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:56,634 INFO     [param_server.py:450] ====Start to sample for epoch 189, global virtualClock: 6116.941549722325, round_duration: 38.39602155878561
2021-08-18:16:11:56,635 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:11:56,949 INFO     [param_server.py:553] For epoch: 189, median_reward: 369.78541820143516, dev: 739.5708364028703
2021-08-18:16:11:57,608 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9082, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:11:57,609 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2569.0259, eval_time 0.6142, test_loss 2.9082, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:11:57,657 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5949, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:11:57,659 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2569.0729, eval_time 0.6575, test_loss 2.5949, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:11:57,675 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:11:57,690 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:57,722 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:11:57,745 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:57,773 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1021, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:11:57,777 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2569.1964, eval_time 0.7823, test_loss 3.1021, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:11:57,833 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:11:57,869 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:58,561 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:58,582 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:58,996 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:59,10 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:59,718 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:59,732 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:59,978 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:59,988 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:00,18 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:00,39 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:00,722 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:00,742 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:01,269 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:01,283 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:01,553 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:01,567 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:01,781 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:01,810 INFO     [learner.py:606] ====Pushing takes 0.027800559997558594 s
2021-08-18:16:12:01,820 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:01,831 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:01,838 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:01,846 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:01,847 INFO     [param_server.py:410] Lock worker 1 with localStep 189 , while globalStep is 188

2021-08-18:16:12:02,506 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:02,516 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:03,92 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:03,106 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:03,308 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:03,321 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:03,933 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:03,961 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:04,865 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:04,876 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:05,196 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:05,207 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:05,474 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:05,483 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:05,871 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:05,896 INFO     [learner.py:606] ====Pushing takes 0.02454066276550293 s
2021-08-18:16:12:05,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:05,938 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:12:05,938 INFO     [param_server.py:410] Lock worker 2 with localStep 189 , while globalStep is 188

2021-08-18:16:12:06,16 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:06,30 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:06,580 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:06,617 INFO     [learner.py:606] ====Pushing takes 0.03574538230895996 s
2021-08-18:16:12:06,651 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:06,660 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:06,661 INFO     [param_server.py:381] ====After aggregation in epoch: 188, virtual_clock: 6146.410363527388, top_1: : 63.1494 % (1957.0), top_5: : 100.0 % (3099.0), test loss: 2.8683824495032986, test len: 3099.0
2021-08-18:16:12:06,663 INFO     [param_server.py:410] Lock worker 3 with localStep 189 , while globalStep is 189

2021-08-18:16:12:06,664 INFO     [param_server.py:441] ====Epoch 190 completes 20 clients with loss 5.707579260452066, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:06,664 INFO     [param_server.py:450] ====Start to sample for epoch 190, global virtualClock: 6146.410363527388, round_duration: 29.468813805062297
2021-08-18:16:12:06,665 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:06,966 INFO     [param_server.py:553] For epoch: 190, median_reward: 324.13969760262717, dev: 648.2793952052543
2021-08-18:16:12:07,605 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8667, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:12:07,606 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2579.0235, eval_time 0.595, test_loss 2.8667, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:12:07,639 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5844, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:12:07,639 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2579.0592, eval_time 0.6282, test_loss 3.5844, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:12:07,642 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9682, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:12:07,643 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2579.0572, eval_time 0.6316, test_loss 2.9682, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:12:07,699 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:07,710 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:07,711 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:07,718 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:07,727 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:07,748 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:08,592 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:08,626 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:08,820 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:08,835 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:09,879 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:09,891 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:09,898 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:09,931 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:10,549 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:10,570 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:10,615 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:10,648 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:11,235 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:11,262 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:11,593 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:11,608 INFO     [learner.py:606] ====Pushing takes 0.014482736587524414 s
2021-08-18:16:12:11,632 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:11,637 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:11,638 INFO     [param_server.py:410] Lock worker 1 with localStep 190 , while globalStep is 189

2021-08-18:16:12:12,96 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:12,109 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:12,818 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:12,833 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:14,11 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:14,22 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:14,683 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:14,697 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:15,6 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:15,25 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:15,907 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:15,922 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:16,538 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:16,557 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:16,833 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:16,847 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:17,310 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:17,341 INFO     [learner.py:606] ====Pushing takes 0.02964186668395996 s
2021-08-18:16:12:17,379 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:17,386 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:12:17,387 INFO     [param_server.py:410] Lock worker 2 with localStep 190 , while globalStep is 189

2021-08-18:16:12:17,485 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:17,494 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:18,553 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:18,566 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:19,92 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:19,131 INFO     [learner.py:606] ====Pushing takes 0.03770041465759277 s
2021-08-18:16:12:19,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:19,178 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:19,179 INFO     [param_server.py:381] ====After aggregation in epoch: 189, virtual_clock: 6184.806385086174, top_1: : 63.4076 % (1965.0), top_5: : 100.0 % (3099.0), test loss: 3.139755999600446, test len: 3099.0
2021-08-18:16:12:19,181 INFO     [param_server.py:410] Lock worker 3 with localStep 190 , while globalStep is 190

2021-08-18:16:12:19,181 INFO     [param_server.py:441] ====Epoch 191 completes 20 clients with loss 6.4322271540711276, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:19,181 INFO     [param_server.py:450] ====Start to sample for epoch 191, global virtualClock: 6184.806385086174, round_duration: 38.39602155878561
2021-08-18:16:12:19,182 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:19,452 INFO     [param_server.py:553] For epoch: 191, median_reward: 391.18747657507265, dev: 782.3749531501453
2021-08-18:16:12:20,115 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9088, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:12:20,116 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2591.5327, eval_time 0.6191, test_loss 2.9088, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:12:20,154 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.757, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:12:20,155 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2591.569, eval_time 0.6554, test_loss 2.757, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:12:20,195 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:20,205 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:20,211 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7517, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:12:20,213 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2591.633, eval_time 0.717, test_loss 2.7517, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:12:20,223 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:20,239 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:20,270 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:20,299 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:21,725 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:21,752 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:21,888 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:21,898 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:23,94 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:23,106 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:23,107 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:23,121 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:23,401 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:23,435 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:24,310 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:24,338 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:25,178 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:25,206 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:25,648 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:25,658 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:25,895 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:25,907 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:25,917 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:25,923 INFO     [learner.py:606] ====Pushing takes 0.01470804214477539 s
2021-08-18:16:12:25,948 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:25,953 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:25,954 INFO     [param_server.py:410] Lock worker 1 with localStep 191 , while globalStep is 190

2021-08-18:16:12:26,782 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:26,856 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:27,485 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:27,495 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:28,840 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:28,854 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:29,991 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:30,0 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:30,78 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:30,90 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:30,690 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:30,702 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:31,753 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:31,767 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:32,227 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:32,239 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:32,327 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:32,362 INFO     [learner.py:606] ====Pushing takes 0.0335235595703125 s
2021-08-18:16:12:32,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:32,410 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:12:32,411 INFO     [param_server.py:410] Lock worker 3 with localStep 191 , while globalStep is 190

2021-08-18:16:12:32,805 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:32,835 INFO     [learner.py:606] ====Pushing takes 0.02863144874572754 s
2021-08-18:16:12:32,865 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:32,873 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:32,874 INFO     [param_server.py:381] ====After aggregation in epoch: 190, virtual_clock: 6229.173022176276, top_1: : 63.0849 % (1955.0), top_5: : 100.0 % (3099.0), test loss: 2.805811034308539, test len: 3099.0
2021-08-18:16:12:32,875 INFO     [param_server.py:410] Lock worker 2 with localStep 191 , while globalStep is 191

2021-08-18:16:12:32,876 INFO     [param_server.py:441] ====Epoch 192 completes 20 clients with loss 6.5224028459706025, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:32,876 INFO     [param_server.py:450] ====Start to sample for epoch 192, global virtualClock: 6229.173022176276, round_duration: 44.36663709010263
2021-08-18:16:12:32,877 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:33,147 INFO     [param_server.py:553] For epoch: 192, median_reward: 349.97236854007116, dev: 699.9447370801423
2021-08-18:16:12:33,772 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8568, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:12:33,776 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2605.19, eval_time 0.5735, test_loss 2.8568, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:12:33,781 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9525, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:12:33,782 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2605.1996, eval_time 0.5806, test_loss 2.9525, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:12:33,845 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:33,852 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:33,856 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:33,865 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:33,929 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2298, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:12:33,930 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2605.3495, eval_time 0.7281, test_loss 3.2298, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:12:33,993 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:34,27 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:34,946 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:34,979 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:35,6 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:35,15 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:36,59 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:36,73 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:36,468 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:36,494 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:36,681 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:36,691 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:37,172 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:37,198 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:37,896 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:37,922 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:38,251 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:38,271 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:38,682 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:38,708 INFO     [learner.py:606] ====Pushing takes 0.024563312530517578 s
2021-08-18:16:12:38,734 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:38,743 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:38,743 INFO     [param_server.py:410] Lock worker 1 with localStep 192 , while globalStep is 191

2021-08-18:16:12:39,177 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:39,187 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:40,418 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:40,429 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:41,17 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:41,26 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:41,161 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:41,180 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:41,803 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:41,813 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:42,316 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:42,327 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:42,966 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:42,995 INFO     [learner.py:606] ====Pushing takes 0.02462005615234375 s
2021-08-18:16:12:43,23 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:43,31 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:12:43,32 INFO     [param_server.py:410] Lock worker 2 with localStep 192 , while globalStep is 191

2021-08-18:16:12:43,800 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:43,814 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:44,545 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:44,559 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:45,113 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:45,127 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:45,718 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:45,750 INFO     [learner.py:606] ====Pushing takes 0.03114461898803711 s
2021-08-18:16:12:45,783 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:45,792 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:45,793 INFO     [param_server.py:381] ====After aggregation in epoch: 191, virtual_clock: 6267.569043735062, top_1: : 61.8587 % (1917.0), top_5: : 100.0 % (3099.0), test loss: 3.013003137376573, test len: 3099.0
2021-08-18:16:12:45,795 INFO     [param_server.py:410] Lock worker 3 with localStep 192 , while globalStep is 192

2021-08-18:16:12:45,796 INFO     [param_server.py:441] ====Epoch 193 completes 20 clients with loss 6.652949594339716, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:45,796 INFO     [param_server.py:450] ====Start to sample for epoch 193, global virtualClock: 6267.569043735062, round_duration: 38.39602155878561
2021-08-18:16:12:45,797 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:46,80 INFO     [param_server.py:553] For epoch: 193, median_reward: 339.6744110261106, dev: 679.3488220522212
2021-08-18:16:12:46,792 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7565, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:12:46,793 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2618.2101, eval_time 0.6535, test_loss 2.7565, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:12:46,831 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4976, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:12:46,831 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2618.2453, eval_time 0.6895, test_loss 2.4976, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:12:46,886 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:46,897 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:46,898 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:46,914 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:46,957 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7873, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:12:46,958 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2618.3777, eval_time 0.8227, test_loss 2.7873, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:12:47,28 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:47,56 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:48,497 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:48,512 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:48,545 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:48,579 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:49,706 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:49,715 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:49,764 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:49,775 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:50,185 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:50,211 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:50,994 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:51,21 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:51,697 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:51,724 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:52,120 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:52,134 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:52,330 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:52,348 INFO     [learner.py:606] ====Pushing takes 0.01635432243347168 s
2021-08-18:16:12:52,379 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:52,385 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:52,386 INFO     [param_server.py:410] Lock worker 1 with localStep 193 , while globalStep is 192

2021-08-18:16:12:52,739 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:52,757 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:53,277 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:53,291 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:53,846 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:53,855 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:55,317 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:55,329 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:56,419 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:56,434 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:56,552 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:56,563 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:57,170 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:57,184 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:58,440 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:58,454 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:58,846 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:58,859 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:59,95 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:59,130 INFO     [learner.py:606] ====Pushing takes 0.0331268310546875 s
2021-08-18:16:12:59,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:59,175 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:12:59,175 INFO     [param_server.py:410] Lock worker 3 with localStep 193 , while globalStep is 192

2021-08-18:16:12:59,506 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:59,538 INFO     [learner.py:606] ====Pushing takes 0.030262231826782227 s
2021-08-18:16:12:59,568 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:59,575 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:59,576 INFO     [param_server.py:381] ====After aggregation in epoch: 192, virtual_clock: 6311.935680825165, top_1: : 63.1494 % (1957.0), top_5: : 100.0 % (3099.0), test loss: 2.6804677733668574, test len: 3099.0
2021-08-18:16:12:59,578 INFO     [param_server.py:410] Lock worker 2 with localStep 193 , while globalStep is 193

2021-08-18:16:12:59,578 INFO     [param_server.py:441] ====Epoch 194 completes 20 clients with loss 5.696896869222457, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:59,579 INFO     [param_server.py:450] ====Start to sample for epoch 194, global virtualClock: 6311.935680825165, round_duration: 44.36663709010263
2021-08-18:16:12:59,579 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:59,853 INFO     [param_server.py:553] For epoch: 194, median_reward: 381.8090846287495, dev: 763.618169257499
2021-08-18:16:13:00,523 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7807, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:13:00,524 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2631.9414, eval_time 0.6156, test_loss 2.7807, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:13:00,565 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6689, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:13:00,566 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2631.9798, eval_time 0.6532, test_loss 2.6689, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:13:00,616 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:13:00,625 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:00,631 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:13:00,644 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5647, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:13:00,647 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:00,647 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2632.0669, eval_time 0.7406, test_loss 3.5647, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:13:00,702 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:13:00,736 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:01,643 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:01,676 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:01,713 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:01,731 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:02,890 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:02,913 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:03,118 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:03,145 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:03,316 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:03,326 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:03,955 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:03,981 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:04,693 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:04,720 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:05,387 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:05,398 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:05,400 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:05,419 INFO     [learner.py:606] ====Pushing takes 0.01782059669494629 s
2021-08-18:16:13:05,447 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:05,453 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:05,454 INFO     [param_server.py:410] Lock worker 1 with localStep 194 , while globalStep is 193

2021-08-18:16:13:05,645 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:05,659 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:06,853 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:06,864 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:07,469 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:07,478 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:08,16 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:08,28 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:08,684 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:08,695 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:09,268 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:09,279 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:09,817 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:09,831 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:09,979 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:10,8 INFO     [learner.py:606] ====Pushing takes 0.0275266170501709 s
2021-08-18:16:13:10,41 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:10,49 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:10,49 INFO     [param_server.py:410] Lock worker 2 with localStep 194 , while globalStep is 193

2021-08-18:16:13:10,540 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:10,554 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:11,137 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:11,150 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:11,692 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:11,729 INFO     [learner.py:606] ====Pushing takes 0.033349037170410156 s
2021-08-18:16:13:11,764 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:11,773 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:11,773 INFO     [param_server.py:381] ====After aggregation in epoch: 193, virtual_clock: 6349.279200098226, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 3.0047779304009894, test len: 3099.0
2021-08-18:16:13:11,775 INFO     [param_server.py:410] Lock worker 3 with localStep 194 , while globalStep is 194

2021-08-18:16:13:11,776 INFO     [param_server.py:441] ====Epoch 195 completes 20 clients with loss 5.6185477629981175, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:11,776 INFO     [param_server.py:450] ====Start to sample for epoch 195, global virtualClock: 6349.279200098226, round_duration: 37.343519273061496
2021-08-18:16:13:11,777 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:12,59 INFO     [param_server.py:553] For epoch: 195, median_reward: 340.1555911044686, dev: 680.3111822089372
2021-08-18:16:13:12,755 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9529, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:13:12,755 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2644.1724, eval_time 0.6614, test_loss 2.9529, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:13:12,786 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7408, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:13:12,789 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2644.2031, eval_time 0.695, test_loss 2.7408, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:13:12,827 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:12,836 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:12,871 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0904, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:13:12,872 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2644.2917, eval_time 0.7787, test_loss 3.0904, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:13:12,874 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:12,889 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:12,944 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:12,973 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:14,427 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:14,436 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:14,511 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:14,545 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:15,664 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:15,673 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:15,722 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:15,734 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:16,113 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:16,140 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:16,926 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:16,953 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:17,699 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:17,727 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:18,12 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:18,24 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:18,437 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:18,454 INFO     [learner.py:606] ====Pushing takes 0.015491485595703125 s
2021-08-18:16:13:18,479 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:18,487 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:18,488 INFO     [param_server.py:410] Lock worker 1 with localStep 195 , while globalStep is 194

2021-08-18:16:13:18,763 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:18,781 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:19,301 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:19,317 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:19,992 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:20,5 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:21,372 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:21,383 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:22,372 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:22,384 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:22,940 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:22,958 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:23,606 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:23,616 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:24,557 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:24,571 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:24,838 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:24,847 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:25,182 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:25,208 INFO     [learner.py:606] ====Pushing takes 0.02492976188659668 s
2021-08-18:16:13:25,236 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:25,244 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:25,245 INFO     [param_server.py:410] Lock worker 2 with localStep 195 , while globalStep is 194

2021-08-18:16:13:25,473 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:25,507 INFO     [learner.py:606] ====Pushing takes 0.0329432487487793 s
2021-08-18:16:13:25,543 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:25,551 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:25,552 INFO     [param_server.py:381] ====After aggregation in epoch: 194, virtual_clock: 6393.645837188329, top_1: : 62.8267 % (1947.0), top_5: : 100.0 % (3099.0), test loss: 2.9279918317441584, test len: 3099.0
2021-08-18:16:13:25,554 INFO     [param_server.py:410] Lock worker 3 with localStep 195 , while globalStep is 195

2021-08-18:16:13:25,554 INFO     [param_server.py:441] ====Epoch 196 completes 20 clients with loss 5.260733412005836, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:25,555 INFO     [param_server.py:450] ====Start to sample for epoch 196, global virtualClock: 6393.645837188329, round_duration: 44.36663709010263
2021-08-18:16:13:25,555 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:25,837 INFO     [param_server.py:553] For epoch: 196, median_reward: 336.000147825543, dev: 672.000295651086
2021-08-18:16:13:26,449 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7017, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:16:13:26,450 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2657.8675, eval_time 0.566, test_loss 2.7017, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:16:13:26,492 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7104, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:13:26,493 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2657.9075, eval_time 0.6066, test_loss 2.7104, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:13:26,546 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:26,556 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:26,562 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:26,570 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4444, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:13:26,571 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2657.9904, eval_time 0.6887, test_loss 3.4444, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:13:26,578 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:26,629 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:26,655 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:27,509 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:27,536 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:27,872 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:27,884 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:28,971 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:28,997 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:29,171 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:29,185 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:29,321 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:29,332 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:29,876 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:29,902 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:30,505 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:30,539 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:31,169 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:31,188 INFO     [learner.py:606] ====Pushing takes 0.017493009567260742 s
2021-08-18:16:13:31,217 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:31,223 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:31,224 INFO     [param_server.py:410] Lock worker 1 with localStep 196 , while globalStep is 195

2021-08-18:16:13:31,527 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:31,537 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:31,552 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:31,561 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:32,657 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:32,678 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:33,259 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:33,279 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:34,211 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:34,223 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:34,946 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:34,959 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:35,544 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:35,554 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:35,777 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:35,791 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:36,258 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:36,287 INFO     [learner.py:606] ====Pushing takes 0.028417110443115234 s
2021-08-18:16:13:36,323 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:36,331 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:36,332 INFO     [param_server.py:410] Lock worker 2 with localStep 196 , while globalStep is 195

2021-08-18:16:13:36,487 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:36,497 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:37,131 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:37,140 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:37,836 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:37,871 INFO     [learner.py:606] ====Pushing takes 0.03325796127319336 s
2021-08-18:16:13:37,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:37,926 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:37,926 INFO     [param_server.py:381] ====After aggregation in epoch: 195, virtual_clock: 6430.98935646139, top_1: : 61.7941 % (1915.0), top_5: : 100.0 % (3099.0), test loss: 2.952158021706122, test len: 3099.0
2021-08-18:16:13:37,929 INFO     [param_server.py:410] Lock worker 3 with localStep 196 , while globalStep is 196

2021-08-18:16:13:37,929 INFO     [param_server.py:441] ====Epoch 197 completes 20 clients with loss 5.391717581104946, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:37,930 INFO     [param_server.py:450] ====Start to sample for epoch 197, global virtualClock: 6430.98935646139, round_duration: 37.343519273061496
2021-08-18:16:13:37,931 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:38,253 INFO     [param_server.py:553] For epoch: 197, median_reward: 393.2224512614684, dev: 786.4449025229368
2021-08-18:16:13:38,832 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8698, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:13:38,833 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2670.2502, eval_time 0.5351, test_loss 2.8698, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:13:38,872 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.685, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:13:38,872 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2670.2866, eval_time 0.5699, test_loss 2.685, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:13:38,908 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:38,917 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:38,942 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:38,954 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:38,957 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4289, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:13:38,960 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2670.3798, eval_time 0.6622, test_loss 3.4289, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:13:39,31 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:39,54 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:40,452 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:40,486 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:40,645 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:40,660 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:41,732 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:41,741 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:41,758 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:41,767 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:41,964 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:41,992 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:42,870 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:42,897 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:43,593 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:43,626 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:44,45 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:44,54 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:44,279 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:44,295 INFO     [learner.py:606] ====Pushing takes 0.014347553253173828 s
2021-08-18:16:13:44,327 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:44,333 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:44,333 INFO     [param_server.py:410] Lock worker 1 with localStep 197 , while globalStep is 196

2021-08-18:16:13:44,552 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:44,566 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:45,153 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:45,176 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:45,846 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:45,860 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:47,233 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:47,245 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:48,433 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:48,444 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:48,826 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:48,836 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:49,526 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:49,541 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:50,673 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:50,682 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:50,683 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:50,692 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:51,205 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:51,233 INFO     [learner.py:606] ====Pushing takes 0.026213884353637695 s
2021-08-18:16:13:51,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:51,278 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:51,279 INFO     [param_server.py:410] Lock worker 2 with localStep 197 , while globalStep is 196

2021-08-18:16:13:51,332 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:51,367 INFO     [learner.py:606] ====Pushing takes 0.032944440841674805 s
2021-08-18:16:13:51,406 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:51,414 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:51,416 INFO     [param_server.py:381] ====After aggregation in epoch: 196, virtual_clock: 6475.355993551493, top_1: : 63.0849 % (1955.0), top_5: : 100.0 % (3099.0), test loss: 2.994525123525549, test len: 3099.0
2021-08-18:16:13:51,418 INFO     [param_server.py:410] Lock worker 3 with localStep 197 , while globalStep is 197

2021-08-18:16:13:51,419 INFO     [param_server.py:441] ====Epoch 198 completes 20 clients with loss 5.253063082467694, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:51,419 INFO     [param_server.py:450] ====Start to sample for epoch 198, global virtualClock: 6475.355993551493, round_duration: 44.36663709010263
2021-08-18:16:13:51,420 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:51,721 INFO     [param_server.py:553] For epoch: 198, median_reward: 341.84567624153016, dev: 683.6913524830603
2021-08-18:16:13:52,452 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9165, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:13:52,454 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2683.8708, eval_time 0.6871, test_loss 2.9165, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:13:52,485 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7423, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:13:52,486 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2683.8999, eval_time 0.7156, test_loss 2.7423, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:13:52,537 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:52,550 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:52,555 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:52,559 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9523, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:13:52,560 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2683.9802, eval_time 0.794, test_loss 2.9523, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:13:52,569 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:52,618 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:52,641 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:53,440 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:53,461 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:53,665 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:53,675 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:54,709 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:54,718 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:54,815 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:54,848 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:55,131 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:55,141 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:55,655 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:55,689 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:56,440 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:56,473 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:56,991 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:57,9 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:57,112 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:57,129 INFO     [learner.py:606] ====Pushing takes 0.015596151351928711 s
2021-08-18:16:13:57,161 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:57,168 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:57,168 INFO     [param_server.py:410] Lock worker 1 with localStep 198 , while globalStep is 197

2021-08-18:16:13:57,347 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:57,357 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:58,532 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:58,556 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:59,243 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:59,264 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:59,664 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:59,678 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:00,333 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:00,342 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:00,852 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:00,883 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:01,567 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:01,595 INFO     [learner.py:606] ====Pushing takes 0.026863813400268555 s
2021-08-18:16:14:01,633 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:01,643 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:01,644 INFO     [param_server.py:410] Lock worker 2 with localStep 198 , while globalStep is 197

2021-08-18:16:14:01,655 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:01,667 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:02,198 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:02,207 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:02,867 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:02,881 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:03,548 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:03,582 INFO     [learner.py:606] ====Pushing takes 0.03325295448303223 s
2021-08-18:16:14:03,618 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:03,627 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:03,628 INFO     [param_server.py:381] ====After aggregation in epoch: 197, virtual_clock: 6512.699512824554, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 2.8703815903928542, test len: 3099.0
2021-08-18:16:14:03,631 INFO     [param_server.py:410] Lock worker 3 with localStep 198 , while globalStep is 198

2021-08-18:16:14:03,631 INFO     [param_server.py:441] ====Epoch 199 completes 20 clients with loss 5.887535062105245, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:03,632 INFO     [param_server.py:450] ====Start to sample for epoch 199, global virtualClock: 6512.699512824554, round_duration: 37.343519273061496
2021-08-18:16:14:03,632 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:03,911 INFO     [param_server.py:553] For epoch: 199, median_reward: 361.1697835536836, dev: 722.3395671073672
2021-08-18:16:14:04,616 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9559, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:14:04,617 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2696.0343, eval_time 0.6701, test_loss 2.9559, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:14:04,660 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8415, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:14:04,665 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2696.0792, eval_time 0.7163, test_loss 2.8415, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:14:04,684 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:14:04,692 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:04,737 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:14:04,747 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5272, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:14:04,750 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2696.1699, eval_time 0.8045, test_loss 3.5272, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:14:04,751 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:04,806 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:14:04,827 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:06,213 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:06,233 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:06,261 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:06,273 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:07,423 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:07,434 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:07,565 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:07,576 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:07,953 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:07,980 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:08,823 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:08,857 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:09,631 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:09,664 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:09,743 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:09,756 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:10,422 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:10,436 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:10,554 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:10,573 INFO     [learner.py:606] ====Pushing takes 0.017146825790405273 s
2021-08-18:16:14:10,604 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:10,610 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:10,610 INFO     [param_server.py:410] Lock worker 1 with localStep 199 , while globalStep is 198

2021-08-18:16:14:10,975 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:10,995 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:11,758 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:11,778 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:13,46 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:13,59 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:14,294 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:14,312 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:14,857 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:14,867 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:15,540 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:15,550 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:16,534 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:16,545 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:16,756 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:16,770 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:17,133 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:17,164 INFO     [learner.py:606] ====Pushing takes 0.029395341873168945 s
2021-08-18:16:14:17,201 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:17,209 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:17,210 INFO     [param_server.py:410] Lock worker 2 with localStep 199 , while globalStep is 198

2021-08-18:16:14:17,404 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:17,439 INFO     [learner.py:606] ====Pushing takes 0.03321409225463867 s
2021-08-18:16:14:17,473 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:17,482 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:17,483 INFO     [param_server.py:381] ====After aggregation in epoch: 198, virtual_clock: 6557.066149914657, top_1: : 62.4395 % (1935.0), top_5: : 100.0 % (3099.0), test loss: 3.1081775338561446, test len: 3099.0
2021-08-18:16:14:17,485 INFO     [param_server.py:410] Lock worker 3 with localStep 199 , while globalStep is 199

2021-08-18:16:14:17,485 INFO     [param_server.py:441] ====Epoch 200 completes 20 clients with loss 7.142274958559618, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:17,485 INFO     [param_server.py:450] ====Start to sample for epoch 200, global virtualClock: 6557.066149914657, round_duration: 44.36663709010263
2021-08-18:16:14:17,486 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:17,760 INFO     [param_server.py:553] For epoch: 200, median_reward: 323.69409565541133, dev: 647.3881913108227
2021-08-18:16:14:18,420 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4181, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:14:18,421 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2709.8352, eval_time 0.6261, test_loss 2.4181, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:14:18,422 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9214, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:14:18,425 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2709.8426, eval_time 0.6305, test_loss 2.9214, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:14:18,439 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9364, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:14:18,440 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2709.8598, eval_time 0.6452, test_loss 2.9364, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:14:18,504 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:18,504 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:18,513 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:18,513 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:18,513 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:18,530 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:19,211 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:19,225 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:19,698 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:19,708 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:20,802 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:20,847 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:20,915 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:20,924 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:21,164 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:21,174 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:21,656 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:21,683 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:22,324 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:22,358 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:23,108 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:23,130 INFO     [learner.py:606] ====Pushing takes 0.017000913619995117 s
2021-08-18:16:14:23,160 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:23,166 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:23,167 INFO     [param_server.py:410] Lock worker 1 with localStep 200 , while globalStep is 199

2021-08-18:16:14:23,318 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:23,328 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:23,337 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:23,338 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:24,581 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:24,602 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:25,362 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:25,376 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:26,215 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:26,233 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:26,823 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:26,833 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:27,471 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:27,485 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:27,609 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:27,623 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:28,175 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:28,204 INFO     [learner.py:606] ====Pushing takes 0.027059555053710938 s
2021-08-18:16:14:28,207 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:28,220 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:28,245 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:28,252 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:28,253 INFO     [param_server.py:410] Lock worker 2 with localStep 200 , while globalStep is 199

2021-08-18:16:14:28,789 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:28,803 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:29,440 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:29,474 INFO     [learner.py:606] ====Pushing takes 0.03308892250061035 s
2021-08-18:16:14:29,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:29,530 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:29,531 INFO     [param_server.py:381] ====After aggregation in epoch: 199, virtual_clock: 6594.4096691877185, top_1: : 63.5366 % (1969.0), top_5: : 100.0 % (3099.0), test loss: 2.7586440157007286, test len: 3099.0
2021-08-18:16:14:29,533 INFO     [param_server.py:410] Lock worker 3 with localStep 200 , while globalStep is 200

2021-08-18:16:14:29,534 INFO     [param_server.py:441] ====Epoch 201 completes 20 clients with loss 7.11435882987341, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:29,535 INFO     [param_server.py:450] ====Start to sample for epoch 201, global virtualClock: 6594.4096691877185, round_duration: 37.343519273061496
2021-08-18:16:14:29,535 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:29,814 INFO     [param_server.py:541] Handle Wight 0.04589104652404785 | Send 0.27942562103271484
2021-08-18:16:14:29,815 INFO     [param_server.py:553] For epoch: 201, median_reward: 394.1599424053854, dev: 788.3198848107708
2021-08-18:16:14:30,529 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0066, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:14:30,530 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2721.9475, eval_time 0.69, test_loss 3.0066, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:14:30,558 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8099, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:14:30,559 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2721.9791, eval_time 0.7213, test_loss 2.8099, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:14:30,568 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6796, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:14:30,569 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2721.9832, eval_time 0.7287, test_loss 2.6796, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:14:30,600 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:30,608 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:30,633 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:30,637 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:30,649 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:30,651 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:31,951 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:31,965 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:32,246 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:32,257 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:33,299 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:33,308 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:33,513 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:33,540 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:33,549 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:33,558 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:34,316 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:34,350 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:35,146 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:35,179 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:35,609 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:35,619 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:35,883 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:35,902 INFO     [learner.py:606] ====Pushing takes 0.017038822174072266 s
2021-08-18:16:14:35,933 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:35,941 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:35,942 INFO     [param_server.py:410] Lock worker 1 with localStep 201 , while globalStep is 200

2021-08-18:16:14:36,154 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:36,165 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:36,737 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:36,755 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:37,461 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:37,481 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:38,851 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:38,867 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:39,893 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:39,905 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:40,374 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:40,388 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:41,112 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:41,126 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:42,204 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:42,215 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:42,269 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:42,283 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:42,771 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:42,799 INFO     [learner.py:606] ====Pushing takes 0.026383638381958008 s
2021-08-18:16:14:42,839 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:42,846 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:42,847 INFO     [param_server.py:410] Lock worker 2 with localStep 201 , while globalStep is 200

2021-08-18:16:14:42,945 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:42,980 INFO     [learner.py:606] ====Pushing takes 0.033483028411865234 s
2021-08-18:16:14:43,13 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:43,22 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:43,23 INFO     [param_server.py:381] ====After aggregation in epoch: 200, virtual_clock: 6638.776306277821, top_1: : 63.7948 % (1977.0), top_5: : 100.0 % (3099.0), test loss: 2.8320505309987953, test len: 3099.0
2021-08-18:16:14:43,25 INFO     [param_server.py:410] Lock worker 3 with localStep 201 , while globalStep is 201

2021-08-18:16:14:43,25 INFO     [param_server.py:441] ====Epoch 202 completes 20 clients with loss 5.109417526582109, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:43,26 INFO     [param_server.py:450] ====Start to sample for epoch 202, global virtualClock: 6638.776306277821, round_duration: 44.36663709010263
2021-08-18:16:14:43,26 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:43,310 INFO     [param_server.py:553] For epoch: 202, median_reward: 357.6297603376763, dev: 715.2595206753526
2021-08-18:16:14:43,967 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2819, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:14:43,968 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2735.3854, eval_time 0.6316, test_loss 3.2819, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:14:44,11 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2108, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:14:44,14 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2735.4333, eval_time 0.681, test_loss 3.2108, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:14:44,37 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:44,47 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:44,61 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6845, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:14:44,61 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2735.4757, eval_time 0.7212, test_loss 2.6845, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:14:44,70 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:44,86 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:44,128 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:44,137 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:44,945 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:44,971 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:45,358 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:45,369 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:46,401 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:46,428 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:46,535 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:46,545 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:46,793 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:46,803 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:47,185 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:47,212 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:47,969 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:47,996 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:48,768 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:48,768 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:48,782 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:48,786 INFO     [learner.py:606] ====Pushing takes 0.017240047454833984 s
2021-08-18:16:14:48,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:48,823 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:48,824 INFO     [param_server.py:410] Lock worker 1 with localStep 202 , while globalStep is 201

2021-08-18:16:14:49,119 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:49,137 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:50,336 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:50,364 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:51,40 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:51,52 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:51,843 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:51,853 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:52,555 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:52,566 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:53,101 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:53,111 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:53,242 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:53,251 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:53,785 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:53,813 INFO     [learner.py:606] ====Pushing takes 0.027004241943359375 s
2021-08-18:16:14:53,849 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:53,859 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:53,860 INFO     [param_server.py:410] Lock worker 2 with localStep 202 , while globalStep is 201

2021-08-18:16:14:53,932 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:53,953 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:54,653 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:54,674 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:55,268 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:55,302 INFO     [learner.py:606] ====Pushing takes 0.032732248306274414 s
2021-08-18:16:14:55,336 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:55,345 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:55,345 INFO     [param_server.py:381] ====After aggregation in epoch: 201, virtual_clock: 6676.1198255508825, top_1: : 61.2456 % (1898.0), top_5: : 100.0 % (3099.0), test loss: 3.0590485466851134, test len: 3099.0
2021-08-18:16:14:55,348 INFO     [param_server.py:410] Lock worker 3 with localStep 202 , while globalStep is 202

2021-08-18:16:14:55,348 INFO     [param_server.py:441] ====Epoch 203 completes 20 clients with loss 5.178091415360862, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:55,348 INFO     [param_server.py:450] ====Start to sample for epoch 203, global virtualClock: 6676.1198255508825, round_duration: 37.343519273061496
2021-08-18:16:14:55,349 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:55,627 INFO     [param_server.py:553] For epoch: 203, median_reward: 427.5063168938013, dev: 855.0126337876026
2021-08-18:16:14:56,242 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1615, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:14:56,243 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2747.6603, eval_time 0.5893, test_loss 3.1615, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:14:56,278 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2738, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:14:56,279 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9684, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:14:56,279 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2747.693, eval_time 0.623, test_loss 3.2738, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:14:56,279 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2747.699, eval_time 0.6281, test_loss 2.9684, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:14:56,315 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:14:56,331 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:56,348 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:14:56,348 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:14:56,361 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:56,365 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:57,589 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:57,603 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:58,69 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:58,85 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:59,72 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:59,82 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:59,221 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:59,248 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:59,446 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:59,456 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:00,173 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:00,201 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:00,939 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:00,967 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:01,156 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:01,170 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:15:01,711 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:01,727 INFO     [learner.py:606] ====Pushing takes 0.015169858932495117 s
2021-08-18:16:15:01,751 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:01,757 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:15:01,758 INFO     [param_server.py:410] Lock worker 1 with localStep 203 , while globalStep is 202

2021-08-18:16:15:02,47 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:02,60 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:02,443 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:15:02,461 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:03,187 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:03,196 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:04,891 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:04,902 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:05,927 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:05,937 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:05,983 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:05,994 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:06,553 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:06,567 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:07,697 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:07,718 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:08,126 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:08,139 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:08,431 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:08,468 INFO     [learner.py:606] ====Pushing takes 0.03316235542297363 s
2021-08-18:16:15:08,508 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:08,517 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:08,518 INFO     [param_server.py:410] Lock worker 3 with localStep 203 , while globalStep is 202

2021-08-18:16:15:08,667 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:08,696 INFO     [learner.py:606] ====Pushing takes 0.027707576751708984 s
2021-08-18:16:15:08,727 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:08,735 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:08,735 INFO     [param_server.py:381] ====After aggregation in epoch: 202, virtual_clock: 6720.486462640985, top_1: : 63.6012 % (1971.0), top_5: : 100.0 % (3099.0), test loss: 3.1345460503189653, test len: 3099.0
2021-08-18:16:15:08,748 INFO     [param_server.py:410] Lock worker 2 with localStep 203 , while globalStep is 203

2021-08-18:16:15:08,749 INFO     [param_server.py:441] ====Epoch 204 completes 20 clients with loss 5.4618326657040965, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:08,750 INFO     [param_server.py:450] ====Start to sample for epoch 204, global virtualClock: 6720.486462640985, round_duration: 44.36663709010263
2021-08-18:16:15:08,751 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:09,40 INFO     [param_server.py:553] For epoch: 204, median_reward: 389.98877940016524, dev: 779.9775588003305
2021-08-18:16:15:09,710 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9069, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:15:09,711 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2761.1251, eval_time 0.6551, test_loss 2.9069, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:15:09,716 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2927, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:15:09,717 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2761.1343, eval_time 0.6613, test_loss 3.2927, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:15:09,777 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1924, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:15:09,801 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2761.2203, eval_time 0.7471, test_loss 3.1924, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:15:09,806 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:09,810 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:09,815 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:09,820 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:09,857 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:09,878 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:11,455 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:11,468 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:11,536 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:11,563 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:12,382 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:12,392 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:13,128 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:13,137 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:13,696 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:13,724 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:14,950 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:14,970 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:15,91 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:15,124 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:15,736 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:15,750 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:15,911 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:15,932 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:16,30 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:16,49 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:16,768 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:16,789 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:17,398 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:17,418 INFO     [learner.py:606] ====Pushing takes 0.018508434295654297 s
2021-08-18:16:15:17,448 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:17,458 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:17,459 INFO     [param_server.py:410] Lock worker 1 with localStep 204 , while globalStep is 203

2021-08-18:16:15:18,595 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:18,613 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:18,674 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:18,688 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:19,447 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:19,462 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:19,919 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:19,933 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:20,862 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:20,875 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:21,522 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:21,552 INFO     [learner.py:606] ====Pushing takes 0.028325796127319336 s
2021-08-18:16:15:21,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:21,589 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:21,590 INFO     [param_server.py:410] Lock worker 3 with localStep 204 , while globalStep is 203

2021-08-18:16:15:22,346 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:22,357 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:23,563 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:23,591 INFO     [learner.py:606] ====Pushing takes 0.026397228240966797 s
2021-08-18:16:15:23,620 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:23,628 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:23,629 INFO     [param_server.py:381] ====After aggregation in epoch: 203, virtual_clock: 6782.687783297522, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 3.1306731965806747, test len: 3099.0
2021-08-18:16:15:23,632 INFO     [param_server.py:410] Lock worker 2 with localStep 204 , while globalStep is 204

2021-08-18:16:15:23,632 INFO     [param_server.py:441] ====Epoch 205 completes 20 clients with loss 352.9359275757719, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:23,633 INFO     [param_server.py:450] ====Start to sample for epoch 205, global virtualClock: 6782.687783297522, round_duration: 62.20132065653664
2021-08-18:16:15:23,634 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:23,973 INFO     [param_server.py:553] For epoch: 205, median_reward: 459.25619541605414, dev: 918.5123908321083
2021-08-18:16:15:24,558 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6998, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:15:24,560 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2775.9767, eval_time 0.5414, test_loss 2.6998, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:15:24,564 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5613, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:15:24,565 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2775.9792, eval_time 0.5456, test_loss 2.5613, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:15:24,635 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:24,643 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:24,660 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:24,669 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:24,680 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8885, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:15:24,687 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2776.107, eval_time 0.6692, test_loss 2.8885, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:15:24,749 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:24,772 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:26,177 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:26,204 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:26,259 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:26,271 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:27,427 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:27,438 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:27,545 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:27,557 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:28,219 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:28,247 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:29,52 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:29,77 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:29,731 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:29,744 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:29,785 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:29,812 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:30,232 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:30,250 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:30,429 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:30,439 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:30,518 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:30,538 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:31,74 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:31,96 INFO     [learner.py:606] ====Pushing takes 0.019348621368408203 s
2021-08-18:16:15:31,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:31,137 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:31,137 INFO     [param_server.py:410] Lock worker 1 with localStep 205 , while globalStep is 204

2021-08-18:16:15:32,972 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:32,984 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:33,129 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:33,143 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:33,916 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:33,926 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:34,48 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:34,60 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:35,92 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:35,113 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:35,731 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:35,760 INFO     [learner.py:606] ====Pushing takes 0.02683424949645996 s
2021-08-18:16:15:35,788 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:35,789 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:35,799 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:35,800 INFO     [param_server.py:410] Lock worker 3 with localStep 205 , while globalStep is 204

2021-08-18:16:15:35,802 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:36,411 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:36,439 INFO     [learner.py:606] ====Pushing takes 0.026701927185058594 s
2021-08-18:16:15:36,471 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:36,479 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:36,480 INFO     [param_server.py:381] ====After aggregation in epoch: 204, virtual_clock: 6829.339644688495, top_1: : 64.3756 % (1995.0), top_5: : 100.0 % (3099.0), test loss: 2.7165137926737466, test len: 3099.0
2021-08-18:16:15:36,482 INFO     [param_server.py:410] Lock worker 2 with localStep 205 , while globalStep is 205

2021-08-18:16:15:36,483 INFO     [param_server.py:441] ====Epoch 206 completes 20 clients with loss 90.7747224961146, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:36,483 INFO     [param_server.py:450] ====Start to sample for epoch 206, global virtualClock: 6829.339644688495, round_duration: 46.65186139097271
2021-08-18:16:15:36,484 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:36,773 INFO     [param_server.py:553] For epoch: 206, median_reward: 398.97267293223035, dev: 797.9453458644607
2021-08-18:16:15:37,449 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8935, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:15:37,450 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2788.8637, eval_time 0.6327, test_loss 2.8935, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:15:37,450 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3049, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:15:37,451 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2788.8678, eval_time 0.6339, test_loss 3.3049, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:15:37,537 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:37,537 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:37,546 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:37,550 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:37,572 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7611, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:15:37,573 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2788.9931, eval_time 0.7566, test_loss 2.7611, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:15:37,646 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:37,671 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:39,113 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:39,140 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:39,161 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:39,177 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:40,379 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:40,391 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:40,629 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:40,643 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:40,851 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:40,878 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:41,716 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:41,743 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:42,546 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:42,566 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:42,881 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:42,890 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:43,177 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:43,197 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:43,484 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:43,496 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:43,535 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:43,546 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:43,761 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:43,780 INFO     [learner.py:606] ====Pushing takes 0.017116308212280273 s
2021-08-18:16:15:43,809 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:43,816 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:43,816 INFO     [param_server.py:410] Lock worker 1 with localStep 206 , while globalStep is 205

2021-08-18:16:15:46,392 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:46,404 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:46,560 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:46,571 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:47,349 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:47,358 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:47,618 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:47,629 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:48,585 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:48,604 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:48,836 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:48,855 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:49,246 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:49,276 INFO     [learner.py:606] ====Pushing takes 0.028101444244384766 s
2021-08-18:16:15:49,311 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:49,319 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:49,320 INFO     [param_server.py:410] Lock worker 3 with localStep 206 , while globalStep is 205

2021-08-18:16:15:50,181 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:50,209 INFO     [learner.py:606] ====Pushing takes 0.02643108367919922 s
2021-08-18:16:15:50,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:50,247 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:50,248 INFO     [param_server.py:381] ====After aggregation in epoch: 205, virtual_clock: 6875.991506079468, top_1: : 63.0203 % (1953.0), top_5: : 100.0 % (3099.0), test loss: 2.9864896889086125, test len: 3099.0
2021-08-18:16:15:50,250 INFO     [param_server.py:410] Lock worker 2 with localStep 206 , while globalStep is 206

2021-08-18:16:15:50,251 INFO     [param_server.py:441] ====Epoch 207 completes 20 clients with loss 185.3851324395553, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:50,251 INFO     [param_server.py:450] ====Start to sample for epoch 207, global virtualClock: 6875.991506079468, round_duration: 46.65186139097271
2021-08-18:16:15:50,252 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:50,526 INFO     [param_server.py:553] For epoch: 207, median_reward: 406.01082741845727, dev: 812.0216548369145
2021-08-18:16:15:51,175 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1476, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:15:51,176 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2802.5928, eval_time 0.614, test_loss 3.1476, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:15:51,217 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4466, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:15:51,217 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2802.6313, eval_time 0.6554, test_loss 2.4466, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:15:51,252 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7336, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:15:51,255 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2802.6748, eval_time 0.6947, test_loss 2.7336, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:15:51,272 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:51,280 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:51,297 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:51,313 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:51,314 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:51,341 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:52,737 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:52,757 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:52,916 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:52,928 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:54,46 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:54,64 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:54,88 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:54,106 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:54,706 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:54,727 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:55,467 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:55,487 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:56,193 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:56,212 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:56,221 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:56,222 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:56,665 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:56,687 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:56,989 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:57,10 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:57,77 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:57,95 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:57,627 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:57,646 INFO     [learner.py:606] ====Pushing takes 0.017884016036987305 s
2021-08-18:16:15:57,682 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:57,690 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:57,691 INFO     [param_server.py:410] Lock worker 1 with localStep 207 , while globalStep is 206

2021-08-18:16:15:59,309 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:59,325 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:59,918 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:59,927 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:00,435 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:00,446 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:00,527 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:00,536 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:01,666 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:01,680 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:01,741 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:01,753 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:02,270 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:02,310 INFO     [learner.py:606] ====Pushing takes 0.03870081901550293 s
2021-08-18:16:16:02,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:02,350 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:02,355 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:02,357 INFO     [param_server.py:410] Lock worker 2 with localStep 207 , while globalStep is 206

2021-08-18:16:16:02,380 INFO     [learner.py:606] ====Pushing takes 0.028322935104370117 s
2021-08-18:16:16:02,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:02,417 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:02,418 INFO     [param_server.py:381] ====After aggregation in epoch: 206, virtual_clock: 6922.643367470441, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 2.775914967060089, test len: 3099.0
2021-08-18:16:16:02,420 INFO     [param_server.py:410] Lock worker 3 with localStep 207 , while globalStep is 207

2021-08-18:16:16:02,421 INFO     [param_server.py:441] ====Epoch 208 completes 20 clients with loss 265.22182505274486, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:02,421 INFO     [param_server.py:450] ====Start to sample for epoch 208, global virtualClock: 6922.643367470441, round_duration: 46.65186139097271
2021-08-18:16:16:02,422 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:02,694 INFO     [param_server.py:553] For epoch: 208, median_reward: 412.65880191864363, dev: 825.3176038372873
2021-08-18:16:16:03,349 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.431, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:16:03,350 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2814.7668, eval_time 0.6014, test_loss 3.431, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:16:03,402 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6405, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:16:03,403 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2814.8169, eval_time 0.6494, test_loss 2.6405, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:16:03,422 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:16:03,430 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:03,430 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1559, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:16:03,431 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2814.851, eval_time 0.6831, test_loss 3.1559, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:16:03,472 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:16:03,484 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:03,499 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:16:03,519 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:04,845 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:04,878 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:04,914 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:04,932 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:06,199 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:06,211 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:06,211 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:06,220 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:06,621 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:06,648 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:07,578 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:07,606 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:08,329 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:08,350 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:08,642 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:08,656 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:09,9 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:09,23 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:09,97 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:09,118 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:09,320 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:09,341 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:09,745 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:09,767 INFO     [learner.py:606] ====Pushing takes 0.02039933204650879 s
2021-08-18:16:16:09,803 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:09,810 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:09,811 INFO     [param_server.py:410] Lock worker 1 with localStep 208 , while globalStep is 207

2021-08-18:16:16:11,835 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:11,846 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:12,142 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:12,152 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:12,833 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:12,842 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:13,33 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:13,45 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:14,109 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:14,120 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:14,260 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:14,271 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:14,697 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:14,727 INFO     [learner.py:606] ====Pushing takes 0.028151273727416992 s
2021-08-18:16:16:14,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:14,774 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:14,774 INFO     [param_server.py:410] Lock worker 3 with localStep 208 , while globalStep is 207

2021-08-18:16:16:15,441 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:15,470 INFO     [learner.py:606] ====Pushing takes 0.027894020080566406 s
2021-08-18:16:16:15,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:15,508 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:15,508 INFO     [param_server.py:381] ====After aggregation in epoch: 207, virtual_clock: 6969.295228861414, top_1: : 61.8264 % (1916.0), top_5: : 100.0 % (3099.0), test loss: 3.0758297929057368, test len: 3099.0
2021-08-18:16:16:15,511 INFO     [param_server.py:410] Lock worker 2 with localStep 208 , while globalStep is 208

2021-08-18:16:16:15,511 INFO     [param_server.py:441] ====Epoch 209 completes 20 clients with loss 263.003509995549, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:15,511 INFO     [param_server.py:450] ====Start to sample for epoch 209, global virtualClock: 6969.295228861414, round_duration: 46.65186139097271
2021-08-18:16:16:15,512 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:15,783 INFO     [param_server.py:553] For epoch: 209, median_reward: 413.5104179897648, dev: 827.0208359795296
2021-08-18:16:16:16,405 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7916, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:16:16,406 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2827.8231, eval_time 0.5864, test_loss 2.7916, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:16:16,443 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5502, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:16:16,444 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2827.858, eval_time 0.6242, test_loss 2.5502, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:16:16,476 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:16,480 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8093, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:16:16,481 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2827.9009, eval_time 0.6638, test_loss 2.8093, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:16:16,484 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:16,514 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:16,531 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:16,551 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:16,574 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:18,61 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:18,82 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:18,164 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:18,178 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:19,173 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:19,183 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:19,335 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:19,386 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:20,136 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:20,163 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:20,880 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:20,900 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:21,460 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:21,470 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:21,672 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:21,693 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:22,141 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:22,152 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:22,232 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:22,253 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:22,358 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:22,379 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:23,0 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:23,21 INFO     [learner.py:606] ====Pushing takes 0.019646167755126953 s
2021-08-18:16:16:23,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:23,60 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:23,61 INFO     [param_server.py:410] Lock worker 1 with localStep 209 , while globalStep is 208

2021-08-18:16:16:24,888 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:24,899 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:25,172 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:25,182 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:25,858 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:25,868 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:26,115 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:26,126 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:27,71 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:27,81 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:27,264 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:27,275 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:27,731 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:27,760 INFO     [learner.py:606] ====Pushing takes 0.028208494186401367 s
2021-08-18:16:16:27,793 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:27,801 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:27,801 INFO     [param_server.py:410] Lock worker 3 with localStep 209 , while globalStep is 208

2021-08-18:16:16:27,804 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:27,834 INFO     [learner.py:606] ====Pushing takes 0.028490304946899414 s
2021-08-18:16:16:27,866 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:27,873 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:27,874 INFO     [param_server.py:381] ====After aggregation in epoch: 208, virtual_clock: 7015.947090252387, top_1: : 63.7948 % (1977.0), top_5: : 100.0 % (3099.0), test loss: 2.7170020324626454, test len: 3099.0
2021-08-18:16:16:27,876 INFO     [param_server.py:410] Lock worker 2 with localStep 209 , while globalStep is 209

2021-08-18:16:16:27,877 INFO     [param_server.py:441] ====Epoch 210 completes 20 clients with loss 225.7079188679419, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:27,878 INFO     [param_server.py:450] ====Start to sample for epoch 210, global virtualClock: 7015.947090252387, round_duration: 46.65186139097271
2021-08-18:16:16:27,879 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:28,166 INFO     [param_server.py:553] For epoch: 210, median_reward: 382.0383312259923, dev: 764.0766624519846
2021-08-18:16:16:28,719 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8184, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:16:28,760 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2840.177, eval_time 0.5485, test_loss 2.8184, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:16:28,809 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5957, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:16:28,810 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2840.2237, eval_time 0.5956, test_loss 2.5957, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:16:28,829 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:28,840 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:28,845 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4831, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:16:28,848 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2840.2679, eval_time 0.6369, test_loss 3.4831, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:16:28,876 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:28,900 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:28,918 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:28,940 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:30,217 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:30,231 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:30,636 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:30,647 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:31,665 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:31,674 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:31,796 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:31,823 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:31,932 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:31,944 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:32,658 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:32,686 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:33,411 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:33,432 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:34,58 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:34,72 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:34,100 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:34,120 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:34,594 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:34,605 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:34,761 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:34,783 INFO     [learner.py:606] ====Pushing takes 0.019849538803100586 s
2021-08-18:16:16:34,815 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:34,824 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:34,825 INFO     [param_server.py:410] Lock worker 1 with localStep 210 , while globalStep is 209

2021-08-18:16:16:34,828 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:34,842 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:37,263 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:37,275 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:37,729 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:37,741 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:38,485 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:38,494 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:38,504 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:38,518 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:39,630 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:39,640 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:39,704 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:39,715 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:40,209 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:40,245 INFO     [learner.py:606] ====Pushing takes 0.03427743911743164 s
2021-08-18:16:16:40,284 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:40,293 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:40,294 INFO     [param_server.py:410] Lock worker 3 with localStep 210 , while globalStep is 209

2021-08-18:16:16:41,124 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:41,170 INFO     [learner.py:606] ====Pushing takes 0.04422116279602051 s
2021-08-18:16:16:41,206 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:41,214 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:41,214 INFO     [param_server.py:381] ====After aggregation in epoch: 209, virtual_clock: 7062.59895164336, top_1: : 63.1817 % (1958.0), top_5: : 100.0 % (3099.0), test loss: 2.965708984269036, test len: 3099.0
2021-08-18:16:16:41,217 INFO     [param_server.py:410] Lock worker 2 with localStep 210 , while globalStep is 210

2021-08-18:16:16:41,217 INFO     [param_server.py:441] ====Epoch 211 completes 20 clients with loss 313.59849941029347, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:41,217 INFO     [param_server.py:450] ====Start to sample for epoch 211, global virtualClock: 7062.59895164336, round_duration: 46.65186139097271
2021-08-18:16:16:41,218 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:41,498 INFO     [param_server.py:553] For epoch: 211, median_reward: 395.14025757758805, dev: 790.2805151551761
2021-08-18:16:16:42,136 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9521, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:16:42,138 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2853.5547, eval_time 0.5942, test_loss 2.9521, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:16:42,213 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:42,213 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4502, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:16:42,214 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2853.6285, eval_time 0.6665, test_loss 2.4502, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:16:42,223 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:42,247 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8051, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:16:42,247 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2853.6672, eval_time 0.7042, test_loss 2.8051, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:16:42,283 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:42,297 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:42,321 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:42,337 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:43,547 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:43,574 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:43,866 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:43,878 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:44,871 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:44,883 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:45,172 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:45,182 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:45,643 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:45,670 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:46,567 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:46,587 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:47,188 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:47,202 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:47,250 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:47,271 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:47,900 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:47,912 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:47,923 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:47,943 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:48,23 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:48,44 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:48,520 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:48,541 INFO     [learner.py:606] ====Pushing takes 0.019243478775024414 s
2021-08-18:16:16:48,575 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:48,591 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:48,594 INFO     [param_server.py:410] Lock worker 1 with localStep 211 , while globalStep is 210

2021-08-18:16:16:50,543 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:50,553 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:50,650 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:50,659 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:51,356 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:51,366 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:51,703 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:51,715 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:52,428 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:52,442 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:52,957 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:52,966 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:53,45 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:53,75 INFO     [learner.py:606] ====Pushing takes 0.029438257217407227 s
2021-08-18:16:16:53,111 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:53,122 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:53,122 INFO     [param_server.py:410] Lock worker 3 with localStep 211 , while globalStep is 210

2021-08-18:16:16:53,497 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:53,534 INFO     [learner.py:606] ====Pushing takes 0.03592276573181152 s
2021-08-18:16:16:53,564 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:53,573 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:53,574 INFO     [param_server.py:381] ====After aggregation in epoch: 210, virtual_clock: 7109.250813034333, top_1: : 64.6338 % (2003.0), top_5: : 100.0 % (3099.0), test loss: 2.7358108460903168, test len: 3099.0
2021-08-18:16:16:53,576 INFO     [param_server.py:410] Lock worker 2 with localStep 211 , while globalStep is 211

2021-08-18:16:16:53,576 INFO     [param_server.py:441] ====Epoch 212 completes 20 clients with loss 164.51287547967968, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:53,577 INFO     [param_server.py:450] ====Start to sample for epoch 212, global virtualClock: 7109.250813034333, round_duration: 46.65186139097271
2021-08-18:16:16:53,578 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:53,923 INFO     [param_server.py:553] For epoch: 212, median_reward: 408.2153473774805, dev: 816.430694754961
2021-08-18:16:16:54,701 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2486, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:16:54,707 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2866.1245, eval_time 0.7388, test_loss 3.2486, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:16:54,713 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8011, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:16:54,714 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2866.1283, eval_time 0.7456, test_loss 2.8011, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:16:54,771 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7416, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:16:54,773 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2866.1923, eval_time 0.8046, test_loss 2.7416, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:16:54,777 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:16:54,785 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:54,794 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:16:54,802 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:54,842 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:16:54,861 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:56,316 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:56,320 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:56,329 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:56,354 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:57,584 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:57,594 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:57,643 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:57,653 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:58,46 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:58,73 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:58,893 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:58,913 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:59,617 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:59,637 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:00,204 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:00,218 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:00,319 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:00,340 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:00,366 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:00,378 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:00,831 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:00,851 INFO     [learner.py:606] ====Pushing takes 0.01877570152282715 s
2021-08-18:16:17:00,880 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:00,892 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:00,893 INFO     [param_server.py:410] Lock worker 1 with localStep 212 , while globalStep is 211

2021-08-18:16:17:00,939 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:00,953 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:02,880 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:02,893 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:03,739 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:03,751 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:03,999 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:04,11 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:04,439 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:04,448 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:05,190 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:05,200 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:05,600 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:05,614 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:06,153 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:06,183 INFO     [learner.py:606] ====Pushing takes 0.028360366821289062 s
2021-08-18:16:17:06,226 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:06,234 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:06,235 INFO     [param_server.py:410] Lock worker 3 with localStep 212 , while globalStep is 211

2021-08-18:16:17:06,511 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:06,552 INFO     [learner.py:606] ====Pushing takes 0.039420127868652344 s
2021-08-18:16:17:06,582 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:06,590 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:06,591 INFO     [param_server.py:381] ====After aggregation in epoch: 211, virtual_clock: 7155.902674425306, top_1: : 63.9561 % (1982.0), top_5: : 100.0 % (3099.0), test loss: 2.9304574816315263, test len: 3099.0
2021-08-18:16:17:06,593 INFO     [param_server.py:410] Lock worker 2 with localStep 212 , while globalStep is 212

2021-08-18:16:17:06,593 INFO     [param_server.py:441] ====Epoch 213 completes 20 clients with loss 195.49382428763474, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:06,594 INFO     [param_server.py:450] ====Start to sample for epoch 213, global virtualClock: 7155.902674425306, round_duration: 46.65186139097271
2021-08-18:16:17:06,595 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:06,946 INFO     [param_server.py:553] For epoch: 213, median_reward: 413.9951665657745, dev: 827.990333131549
2021-08-18:16:17:07,579 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4414, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:17:07,580 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2878.9943, eval_time 0.5997, test_loss 2.4414, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:17:07,583 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8982, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:17:07,584 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2879.0012, eval_time 0.6038, test_loss 2.8982, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:17:07,645 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:17:07,651 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:17:07,652 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2241, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:17:07,653 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2879.0725, eval_time 0.6736, test_loss 3.2241, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:17:07,653 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:07,660 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:07,726 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:17:07,745 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:09,78 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:09,111 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:09,246 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:09,257 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:10,337 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:10,349 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:10,350 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:10,362 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:11,103 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:11,130 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:11,871 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:11,891 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:12,645 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:12,666 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:12,831 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:12,849 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:12,944 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:12,959 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:13,452 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:13,472 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:13,523 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:13,537 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:14,57 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:14,77 INFO     [learner.py:606] ====Pushing takes 0.019215822219848633 s
2021-08-18:16:17:14,107 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:14,116 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:14,116 INFO     [param_server.py:410] Lock worker 1 with localStep 213 , while globalStep is 212

2021-08-18:16:17:15,577 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:15,588 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:16,66 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:16,76 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:16,694 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:16,705 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:16,797 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:16,811 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:17,901 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:17,915 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:17,922 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:17,934 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:18,461 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:18,490 INFO     [learner.py:606] ====Pushing takes 0.027656078338623047 s
2021-08-18:16:17:18,498 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:18,528 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:18,529 INFO     [learner.py:606] ====Pushing takes 0.02969956398010254 s
2021-08-18:16:17:18,536 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:18,537 INFO     [param_server.py:410] Lock worker 2 with localStep 213 , while globalStep is 212

2021-08-18:16:17:18,561 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:18,569 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:18,570 INFO     [param_server.py:381] ====After aggregation in epoch: 212, virtual_clock: 7202.554535816279, top_1: : 64.0529 % (1985.0), top_5: : 100.0 % (3099.0), test loss: 2.8545925374384282, test len: 3099.0
2021-08-18:16:17:18,572 INFO     [param_server.py:410] Lock worker 3 with localStep 213 , while globalStep is 213

2021-08-18:16:17:18,573 INFO     [param_server.py:441] ====Epoch 214 completes 20 clients with loss 241.91078108864613, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:18,573 INFO     [param_server.py:450] ====Start to sample for epoch 214, global virtualClock: 7202.554535816279, round_duration: 46.65186139097271
2021-08-18:16:17:18,574 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:18,877 INFO     [param_server.py:553] For epoch: 214, median_reward: 431.9295248480188, dev: 863.8590496960376
2021-08-18:16:17:19,651 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.723, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:17:19,652 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2891.069, eval_time 0.7408, test_loss 2.723, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:17:19,657 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5204, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:17:19,658 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2891.0721, eval_time 0.7461, test_loss 2.5204, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:17:19,724 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:19,732 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:19,737 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9312, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:17:19,738 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2891.1582, eval_time 0.8279, test_loss 2.9312, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:17:19,764 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:19,773 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:19,809 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:19,827 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:21,173 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:21,200 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:21,275 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:21,289 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:22,375 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:22,386 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:22,444 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:22,453 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:22,856 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:22,889 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:23,761 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:23,795 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:24,559 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:24,586 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:25,33 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:25,44 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:25,148 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:25,167 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:25,184 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:25,204 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:25,821 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:25,842 INFO     [learner.py:606] ====Pushing takes 0.01939702033996582 s
2021-08-18:16:17:25,859 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:25,871 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:25,873 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:25,878 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:25,879 INFO     [param_server.py:410] Lock worker 1 with localStep 214 , while globalStep is 213

2021-08-18:16:17:27,731 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:27,742 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:28,669 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:28,678 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:29,8 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:29,20 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:29,411 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:29,426 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:30,342 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:30,351 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:30,789 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:30,803 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:31,439 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:31,465 INFO     [learner.py:606] ====Pushing takes 0.025125503540039062 s
2021-08-18:16:17:31,495 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:31,503 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:31,504 INFO     [param_server.py:410] Lock worker 3 with localStep 214 , while globalStep is 213

2021-08-18:16:17:31,719 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:31,746 INFO     [learner.py:606] ====Pushing takes 0.02545952796936035 s
2021-08-18:16:17:31,779 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:31,787 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:31,787 INFO     [param_server.py:381] ====After aggregation in epoch: 213, virtual_clock: 7249.206397207252, top_1: : 61.9877 % (1921.0), top_5: : 100.0 % (3099.0), test loss: 2.724860588709513, test len: 3099.0
2021-08-18:16:17:31,790 INFO     [param_server.py:410] Lock worker 2 with localStep 214 , while globalStep is 214

2021-08-18:16:17:31,790 INFO     [param_server.py:441] ====Epoch 215 completes 20 clients with loss 208.39305829475197, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:31,816 INFO     [param_server.py:450] ====Start to sample for epoch 215, global virtualClock: 7249.206397207252, round_duration: 46.65186139097271
2021-08-18:16:17:31,818 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:32,115 INFO     [param_server.py:553] For epoch: 215, median_reward: 373.06903515656006, dev: 746.1380703131201
2021-08-18:16:17:32,767 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9421, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:17:32,772 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2904.1859, eval_time 0.6232, test_loss 2.9421, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:17:32,776 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6715, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:17:32,779 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2904.1962, eval_time 0.6306, test_loss 2.6715, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:17:32,849 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9625, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:17:32,850 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2904.2699, eval_time 0.7017, test_loss 2.9625, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:17:32,851 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:32,862 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:32,877 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:32,886 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:32,921 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:32,940 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:34,582 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:34,616 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:34,629 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:34,642 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:35,612 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:35,622 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:35,820 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:35,829 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:36,704 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:36,737 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:37,578 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:37,605 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:38,343 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:38,356 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:38,439 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:38,466 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:38,479 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:38,492 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:39,57 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:39,70 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:39,90 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:39,110 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:39,638 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:39,658 INFO     [learner.py:606] ====Pushing takes 0.018116235733032227 s
2021-08-18:16:17:39,688 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:39,698 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:39,699 INFO     [param_server.py:410] Lock worker 1 with localStep 215 , while globalStep is 214

2021-08-18:16:17:41,100 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:41,112 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:41,679 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:41,694 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:42,382 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:42,394 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:42,497 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:42,510 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:43,634 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:43,646 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:43,768 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:43,781 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:44,179 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:44,225 INFO     [learner.py:606] ====Pushing takes 0.04531574249267578 s
2021-08-18:16:17:44,262 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:44,270 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:44,270 INFO     [param_server.py:410] Lock worker 2 with localStep 215 , while globalStep is 214

2021-08-18:16:17:44,370 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:44,399 INFO     [learner.py:606] ====Pushing takes 0.028385639190673828 s
2021-08-18:16:17:44,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:44,439 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:44,440 INFO     [param_server.py:381] ====After aggregation in epoch: 214, virtual_clock: 7295.858258598225, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.858661047838352, test len: 3099.0
2021-08-18:16:17:44,442 INFO     [param_server.py:410] Lock worker 3 with localStep 215 , while globalStep is 215

2021-08-18:16:17:44,442 INFO     [param_server.py:441] ====Epoch 216 completes 20 clients with loss 243.5097741089296, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:44,442 INFO     [param_server.py:450] ====Start to sample for epoch 216, global virtualClock: 7295.858258598225, round_duration: 46.65186139097271
2021-08-18:16:17:44,443 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:44,781 INFO     [param_server.py:553] For epoch: 216, median_reward: 382.64623596340425, dev: 765.2924719268085
2021-08-18:16:17:45,451 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.074, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:17:45,452 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2916.869, eval_time 0.6363, test_loss 3.074, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:17:45,452 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.59, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:17:45,453 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2916.8672, eval_time 0.6367, test_loss 2.59, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:17:45,540 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:45,540 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:45,550 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:45,550 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:45,555 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5004, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:17:45,576 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2916.9954, eval_time 0.7602, test_loss 3.5004, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:17:45,652 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:45,677 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:47,157 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:47,169 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:47,171 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:47,204 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:48,162 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:48,171 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:48,305 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:48,316 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:49,16 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:49,50 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:49,927 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:49,954 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:50,708 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:50,741 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:50,742 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:50,762 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:50,951 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:50,963 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:51,405 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:51,439 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:51,490 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:51,511 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:52,42 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:52,64 INFO     [learner.py:606] ====Pushing takes 0.020102500915527344 s
2021-08-18:16:17:52,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:52,108 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:52,109 INFO     [param_server.py:410] Lock worker 1 with localStep 216 , while globalStep is 215

2021-08-18:16:17:53,675 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:53,690 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:54,229 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:54,247 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:54,892 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:54,906 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:54,935 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:54,948 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:56,213 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:56,223 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:56,293 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:56,305 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:56,865 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:56,895 INFO     [learner.py:606] ====Pushing takes 0.027898550033569336 s
2021-08-18:16:17:56,934 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:56,942 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:56,943 INFO     [param_server.py:410] Lock worker 3 with localStep 216 , while globalStep is 215

2021-08-18:16:17:57,707 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:57,748 INFO     [learner.py:606] ====Pushing takes 0.03957080841064453 s
2021-08-18:16:17:57,779 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:57,789 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:57,790 INFO     [param_server.py:381] ====After aggregation in epoch: 215, virtual_clock: 7342.510119989198, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 3.0548066033257375, test len: 3099.0
2021-08-18:16:17:57,791 INFO     [param_server.py:410] Lock worker 2 with localStep 216 , while globalStep is 216

2021-08-18:16:17:57,792 INFO     [param_server.py:441] ====Epoch 217 completes 20 clients with loss 245.48677858269792, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:57,792 INFO     [param_server.py:450] ====Start to sample for epoch 217, global virtualClock: 7342.510119989198, round_duration: 46.65186139097271
2021-08-18:16:17:57,793 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:58,78 INFO     [param_server.py:553] For epoch: 217, median_reward: 349.5938574794543, dev: 699.1877149589086
2021-08-18:16:17:58,736 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6288, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:17:58,737 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2930.1545, eval_time 0.6234, test_loss 2.6288, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:17:58,746 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.417, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:17:58,747 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2930.1607, eval_time 0.6322, test_loss 2.417, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:17:58,813 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:17:58,818 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:17:58,821 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:58,826 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:58,846 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9614, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:17:58,847 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2930.2669, eval_time 0.7334, test_loss 2.9614, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:17:58,927 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:17:58,956 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:00,459 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:00,475 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:00,487 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:00,492 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:01,485 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:01,495 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:01,573 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:01,582 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:02,442 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:02,475 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:03,303 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:03,336 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:04,63 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:04,81 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:04,171 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:04,198 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:04,347 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:04,366 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:04,824 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:04,838 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:04,868 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:04,889 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:05,486 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:05,507 INFO     [learner.py:606] ====Pushing takes 0.019025802612304688 s
2021-08-18:16:18:05,543 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:05,556 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:05,557 INFO     [param_server.py:410] Lock worker 1 with localStep 217 , while globalStep is 216

2021-08-18:16:18:07,5 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:07,16 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:07,689 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:07,702 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:08,191 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:08,202 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:08,313 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:08,323 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:09,291 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:09,303 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:09,306 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:09,318 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:09,927 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:09,936 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:09,955 INFO     [learner.py:606] ====Pushing takes 0.026688575744628906 s
2021-08-18:16:18:10,2 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:10,9 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:10,10 INFO     [param_server.py:410] Lock worker 2 with localStep 217 , while globalStep is 216

2021-08-18:16:18:10,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:09,997 INFO     [learner.py:606] ====Pushing takes 0.05931854248046875 s
2021-08-18:16:18:10,44 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:10,45 INFO     [param_server.py:381] ====After aggregation in epoch: 216, virtual_clock: 7389.161981380171, top_1: : 64.1497 % (1988.0), top_5: : 100.0 % (3099.0), test loss: 2.6690811393437563, test len: 3099.0
2021-08-18:16:18:10,47 INFO     [param_server.py:410] Lock worker 3 with localStep 217 , while globalStep is 217

2021-08-18:16:18:10,48 INFO     [param_server.py:441] ====Epoch 218 completes 20 clients with loss 347.5276151186888, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:10,48 INFO     [param_server.py:450] ====Start to sample for epoch 218, global virtualClock: 7389.161981380171, round_duration: 46.65186139097271
2021-08-18:16:18:10,50 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:10,404 INFO     [param_server.py:553] For epoch: 218, median_reward: 405.828609539265, dev: 811.65721907853
2021-08-18:16:18:10,986 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5487, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:18:10,987 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2942.4008, eval_time 0.5483, test_loss 2.5487, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:18:11,2 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.811, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:18:11,4 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2942.4206, eval_time 0.5651, test_loss 2.811, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:18:11,54 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:11,63 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:11,86 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1439, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:18:11,87 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2942.5066, eval_time 0.6486, test_loss 3.1439, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:18:11,103 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:11,111 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:11,168 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:11,193 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:12,654 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:12,687 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:12,812 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:12,823 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:13,586 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:13,601 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:13,976 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:13,987 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:14,323 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:14,357 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:15,178 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:15,205 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:15,961 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:15,988 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:16,113 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:16,123 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:16,665 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:16,675 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:16,686 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:16,687 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:16,762 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:16,777 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:17,214 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:17,235 INFO     [learner.py:606] ====Pushing takes 0.019921064376831055 s
2021-08-18:16:18:17,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:17,279 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:17,279 INFO     [param_server.py:410] Lock worker 1 with localStep 218 , while globalStep is 217

2021-08-18:16:18:19,549 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:19,561 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:19,647 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:19,656 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:20,306 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:20,316 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:20,766 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:20,778 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:21,537 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:21,552 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:22,169 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:22,187 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:22,203 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:22,232 INFO     [learner.py:606] ====Pushing takes 0.027800321578979492 s
2021-08-18:16:18:22,264 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:22,272 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:22,273 INFO     [param_server.py:410] Lock worker 3 with localStep 218 , while globalStep is 217

2021-08-18:16:18:23,486 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:23,515 INFO     [learner.py:606] ====Pushing takes 0.026777029037475586 s
2021-08-18:16:18:23,545 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:23,553 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:23,554 INFO     [param_server.py:381] ====After aggregation in epoch: 217, virtual_clock: 7435.813842771144, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 2.8345273026713618, test len: 3099.0
2021-08-18:16:18:23,556 INFO     [param_server.py:410] Lock worker 2 with localStep 218 , while globalStep is 218

2021-08-18:16:18:23,556 INFO     [param_server.py:441] ====Epoch 219 completes 20 clients with loss 336.722774318514, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:23,556 INFO     [param_server.py:450] ====Start to sample for epoch 219, global virtualClock: 7435.813842771144, round_duration: 46.65186139097271
2021-08-18:16:18:23,557 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:23,837 INFO     [param_server.py:553] For epoch: 219, median_reward: 411.50199030584207, dev: 823.0039806116841
2021-08-18:16:18:24,533 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8112, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:16:18:24,530 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4012, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:18:24,533 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2955.9504, eval_time 0.6609, test_loss 2.8112, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:16:18:24,534 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2955.9477, eval_time 0.6599, test_loss 3.4012, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:18:24,599 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:24,603 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:24,609 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:24,607 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7661, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:18:24,610 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2956.0293, eval_time 0.7382, test_loss 2.7661, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:18:24,611 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:24,687 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:24,710 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:26,46 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:26,80 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:26,225 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:26,237 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:27,353 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:27,370 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:27,506 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:27,516 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:28,127 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:28,154 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:28,795 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:28,816 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:29,634 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:29,654 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:29,707 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:29,716 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:30,104 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:30,115 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:30,308 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:30,329 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:30,547 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:30,567 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:30,974 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:30,994 INFO     [learner.py:606] ====Pushing takes 0.018764734268188477 s
2021-08-18:16:18:31,26 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:31,33 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:31,34 INFO     [param_server.py:410] Lock worker 1 with localStep 219 , while globalStep is 218

2021-08-18:16:18:32,770 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:32,787 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:33,387 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:33,400 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:34,22 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:34,36 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:34,81 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:34,100 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:35,314 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:35,324 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:35,364 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:35,375 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:35,948 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:35,953 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:35,978 INFO     [learner.py:606] ====Pushing takes 0.028559207916259766 s
2021-08-18:16:18:35,994 INFO     [learner.py:606] ====Pushing takes 0.03894305229187012 s
2021-08-18:16:18:36,22 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:36,31 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:36,56 INFO     [param_server.py:410] Lock worker 2 with localStep 219 , while globalStep is 218

2021-08-18:16:18:36,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:36,88 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:36,88 INFO     [param_server.py:381] ====After aggregation in epoch: 218, virtual_clock: 7482.465704162117, top_1: : 61.6005 % (1909.0), top_5: : 100.0 % (3099.0), test loss: 2.9928033506428755, test len: 3099.0
2021-08-18:16:18:36,90 INFO     [param_server.py:410] Lock worker 3 with localStep 219 , while globalStep is 219

2021-08-18:16:18:36,91 INFO     [param_server.py:441] ====Epoch 220 completes 20 clients with loss 225.97543424805085, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:36,91 INFO     [param_server.py:450] ====Start to sample for epoch 220, global virtualClock: 7482.465704162117, round_duration: 46.65186139097271
2021-08-18:16:18:36,92 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:36,380 INFO     [param_server.py:553] For epoch: 220, median_reward: 388.68856203043214, dev: 777.3771240608643
2021-08-18:16:18:36,955 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6615, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:18:36,956 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2968.3703, eval_time 0.5425, test_loss 2.6615, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:18:36,962 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9617, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:18:36,963 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2968.3802, eval_time 0.5494, test_loss 2.9617, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:18:37,24 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:37,33 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:37,33 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:37,40 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.868, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:18:37,40 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2968.4601, eval_time 0.6268, test_loss 2.868, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:18:37,41 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:37,110 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:37,134 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:38,369 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:38,400 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:38,605 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:38,615 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:39,795 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:39,813 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:39,817 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:39,834 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:40,94 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:40,121 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:40,975 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:41,3 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:41,732 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:41,752 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:42,135 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:42,147 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:42,480 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:42,489 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:42,500 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:42,521 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:42,808 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:42,821 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:43,157 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:43,178 INFO     [learner.py:606] ====Pushing takes 0.016936063766479492 s
2021-08-18:16:18:43,206 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:43,213 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:43,214 INFO     [param_server.py:410] Lock worker 1 with localStep 220 , while globalStep is 219

2021-08-18:16:18:45,133 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:45,145 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:45,727 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:45,747 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:46,300 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:46,319 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:46,448 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:46,460 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:47,647 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:47,657 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:47,698 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:47,707 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:48,407 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:48,442 INFO     [learner.py:606] ====Pushing takes 0.03409290313720703 s
2021-08-18:16:18:48,478 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:48,486 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:48,503 INFO     [param_server.py:410] Lock worker 3 with localStep 220 , while globalStep is 219

2021-08-18:16:18:48,940 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:48,968 INFO     [learner.py:606] ====Pushing takes 0.026330232620239258 s
2021-08-18:16:18:49,1 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:49,9 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:49,9 INFO     [param_server.py:381] ====After aggregation in epoch: 219, virtual_clock: 7529.11756555309, top_1: : 64.4079 % (1996.0), top_5: : 100.0 % (3099.0), test loss: 2.830386581244292, test len: 3099.0
2021-08-18:16:18:49,11 INFO     [param_server.py:410] Lock worker 2 with localStep 220 , while globalStep is 220

2021-08-18:16:18:49,12 INFO     [param_server.py:441] ====Epoch 221 completes 20 clients with loss 392.3071381324361, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:49,12 INFO     [param_server.py:450] ====Start to sample for epoch 221, global virtualClock: 7529.11756555309, round_duration: 46.65186139097271
2021-08-18:16:18:49,13 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:49,330 INFO     [param_server.py:541] Handle Wight 0.037282466888427734 | Send 0.31774449348449707
2021-08-18:16:18:49,331 INFO     [param_server.py:553] For epoch: 221, median_reward: 371.0349497579257, dev: 742.0698995158514
2021-08-18:16:18:50,52 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8821, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:18:50,53 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2981.4705, eval_time 0.6884, test_loss 2.8821, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:18:50,57 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6339, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:18:50,58 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2981.4725, eval_time 0.6925, test_loss 2.6339, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:18:50,124 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:50,125 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:50,132 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:50,133 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:50,141 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7522, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:18:50,142 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2981.5617, eval_time 0.7776, test_loss 2.7522, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:18:50,200 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:50,219 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:51,658 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:51,668 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:51,678 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:51,685 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:52,891 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:52,909 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:52,943 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:52,959 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:53,672 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:53,692 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:54,428 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:54,449 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:55,296 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:55,307 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:55,317 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:55,323 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:55,710 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:55,721 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:55,882 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:55,900 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:55,945 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:55,972 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:56,495 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:56,516 INFO     [learner.py:606] ====Pushing takes 0.019307374954223633 s
2021-08-18:16:18:56,544 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:56,553 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:56,554 INFO     [param_server.py:410] Lock worker 1 with localStep 221 , while globalStep is 220

2021-08-18:16:18:58,498 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:58,519 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:58,781 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:58,799 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:59,520 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:59,530 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:59,641 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:59,655 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:00,652 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:00,662 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:00,827 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:00,839 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:01,314 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:01,316 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:01,343 INFO     [learner.py:606] ====Pushing takes 0.02547907829284668 s
2021-08-18:16:19:01,370 INFO     [learner.py:606] ====Pushing takes 0.054944753646850586 s
2021-08-18:16:19:01,374 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:01,382 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:01,383 INFO     [param_server.py:410] Lock worker 3 with localStep 221 , while globalStep is 220

2021-08-18:16:19:01,407 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:01,415 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:01,416 INFO     [param_server.py:381] ====After aggregation in epoch: 220, virtual_clock: 7575.769426944063, top_1: : 63.1494 % (1957.0), top_5: : 100.0 % (3099.0), test loss: 2.7560668228952974, test len: 3099.0
2021-08-18:16:19:01,424 INFO     [param_server.py:410] Lock worker 2 with localStep 221 , while globalStep is 221

2021-08-18:16:19:01,425 INFO     [param_server.py:441] ====Epoch 222 completes 20 clients with loss 129.07768760344922, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:01,425 INFO     [param_server.py:450] ====Start to sample for epoch 222, global virtualClock: 7575.769426944063, round_duration: 46.65186139097271
2021-08-18:16:19:01,426 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:01,715 INFO     [param_server.py:553] For epoch: 222, median_reward: 357.75642472007456, dev: 715.5128494401491
2021-08-18:16:19:02,359 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0137, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:19:02,360 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2993.7743, eval_time 0.6092, test_loss 3.0137, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:19:02,364 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1438, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:19:02,365 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2993.7819, eval_time 0.6146, test_loss 3.1438, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:19:02,432 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9725, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:19:02,433 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2993.8525, eval_time 0.683, test_loss 2.9725, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:19:02,443 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:19:02,452 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:02,452 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:19:02,461 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:02,492 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:19:02,511 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:03,986 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:04,14 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:04,183 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:04,194 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:05,367 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:05,377 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:05,407 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:05,426 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:05,576 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:05,597 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:06,595 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:06,622 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:07,319 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:07,346 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:07,855 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:07,865 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:07,976 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:07,987 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:08,57 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:08,83 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:08,496 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:08,536 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:08,768 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:08,786 INFO     [learner.py:606] ====Pushing takes 0.01695728302001953 s
2021-08-18:16:19:08,814 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:08,820 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:08,821 INFO     [param_server.py:410] Lock worker 1 with localStep 222 , while globalStep is 221

2021-08-18:16:19:10,829 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:10,843 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:11,473 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:11,492 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:11,938 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:11,950 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:12,155 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:12,169 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:13,193 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:13,212 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:13,389 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:13,399 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:14,18 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:14,48 INFO     [learner.py:606] ====Pushing takes 0.02901768684387207 s
2021-08-18:16:19:14,86 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:14,95 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:14,96 INFO     [param_server.py:410] Lock worker 3 with localStep 222 , while globalStep is 221

2021-08-18:16:19:14,431 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:14,461 INFO     [learner.py:606] ====Pushing takes 0.02876877784729004 s
2021-08-18:16:19:14,493 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:14,501 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:14,502 INFO     [param_server.py:381] ====After aggregation in epoch: 221, virtual_clock: 7622.421288335036, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 3.043346996660586, test len: 3099.0
2021-08-18:16:19:14,504 INFO     [param_server.py:410] Lock worker 2 with localStep 222 , while globalStep is 222

2021-08-18:16:19:14,505 INFO     [param_server.py:441] ====Epoch 223 completes 20 clients with loss 279.11770325902086, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:14,505 INFO     [param_server.py:450] ====Start to sample for epoch 223, global virtualClock: 7622.421288335036, round_duration: 46.65186139097271
2021-08-18:16:19:14,506 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:14,781 INFO     [param_server.py:553] For epoch: 223, median_reward: 434.69048616243924, dev: 869.3809723248785
2021-08-18:16:19:15,459 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.032, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:19:15,460 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 3006.8769, eval_time 0.6438, test_loss 3.032, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:19:15,466 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6263, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:19:15,467 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 3006.8808, eval_time 0.6486, test_loss 2.6263, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:19:15,540 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7849, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:19:15,540 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 3006.9601, eval_time 0.7251, test_loss 2.7849, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:19:15,544 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:15,550 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:15,551 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:15,560 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:15,608 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:15,627 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:17,20 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:17,47 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:17,51 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:17,62 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:18,207 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:18,222 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:18,270 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:18,281 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:18,861 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:18,882 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:19,625 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:19,645 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:20,416 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:20,444 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:20,660 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:20,669 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:20,853 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:20,866 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:21,164 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:21,192 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:21,395 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:21,409 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:21,849 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:21,867 INFO     [learner.py:606] ====Pushing takes 0.016571044921875 s
2021-08-18:16:19:21,893 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:21,900 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:21,901 INFO     [param_server.py:410] Lock worker 1 with localStep 223 , while globalStep is 222

2021-08-18:16:19:23,588 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:23,600 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:24,198 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:24,212 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:24,756 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:24,768 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:24,826 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:24,835 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:25,844 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:25,858 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:25,879 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:25,890 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:26,408 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:26,424 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:26,437 INFO     [learner.py:606] ====Pushing takes 0.027581214904785156 s
2021-08-18:16:19:26,453 INFO     [learner.py:606] ====Pushing takes 0.02800440788269043 s
2021-08-18:16:19:26,479 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:26,488 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:26,488 INFO     [param_server.py:410] Lock worker 2 with localStep 223 , while globalStep is 222

2021-08-18:16:19:26,514 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:26,522 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:26,522 INFO     [param_server.py:381] ====After aggregation in epoch: 222, virtual_clock: 7669.0731497260085, top_1: : 64.4079 % (1996.0), top_5: : 100.0 % (3099.0), test loss: 2.8143877585728965, test len: 3099.0
2021-08-18:16:19:26,525 INFO     [param_server.py:410] Lock worker 3 with localStep 223 , while globalStep is 223

2021-08-18:16:19:26,525 INFO     [param_server.py:441] ====Epoch 224 completes 20 clients with loss 160.21006173962277, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:26,525 INFO     [param_server.py:450] ====Start to sample for epoch 224, global virtualClock: 7669.0731497260085, round_duration: 46.65186139097271
2021-08-18:16:19:26,526 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:26,805 INFO     [param_server.py:553] For epoch: 224, median_reward: 403.46908808480674, dev: 806.9381761696135
2021-08-18:16:19:27,487 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8615, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:19:27,488 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3018.9054, eval_time 0.6465, test_loss 2.8615, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:19:27,499 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0697, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:19:27,501 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3018.9147, eval_time 0.658, test_loss 3.0697, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:19:27,536 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4239, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:19:27,541 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3018.9608, eval_time 0.7016, test_loss 3.4239, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:19:27,573 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:27,573 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:27,582 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:27,583 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:27,596 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:27,618 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:28,934 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:28,954 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:29,262 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:29,273 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:30,433 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:30,454 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:30,516 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:30,531 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:30,562 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:30,574 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:31,310 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:31,337 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:32,48 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:32,69 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:32,782 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:32,801 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:32,811 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:32,832 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:33,198 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:33,213 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:33,464 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:33,483 INFO     [learner.py:606] ====Pushing takes 0.017324447631835938 s
2021-08-18:16:19:33,515 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:33,525 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:33,526 INFO     [param_server.py:410] Lock worker 1 with localStep 224 , while globalStep is 223

2021-08-18:16:19:33,561 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:33,575 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:36,68 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:36,80 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:36,271 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:36,282 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:36,933 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:36,943 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:37,186 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:37,198 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:38,25 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:38,35 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:38,462 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:38,473 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:38,630 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:38,668 INFO     [learner.py:606] ====Pushing takes 0.03649139404296875 s
2021-08-18:16:19:38,698 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:38,706 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:38,707 INFO     [param_server.py:410] Lock worker 3 with localStep 224 , while globalStep is 223

2021-08-18:16:19:39,684 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:39,714 INFO     [learner.py:606] ====Pushing takes 0.028450965881347656 s
2021-08-18:16:19:39,745 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:39,753 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:39,754 INFO     [param_server.py:381] ====After aggregation in epoch: 223, virtual_clock: 7715.7250111169815, top_1: : 64.4724 % (1998.0), top_5: : 100.0 % (3099.0), test loss: 3.118361256740711, test len: 3099.0
2021-08-18:16:19:39,755 INFO     [param_server.py:410] Lock worker 2 with localStep 224 , while globalStep is 224

2021-08-18:16:19:39,756 INFO     [param_server.py:441] ====Epoch 225 completes 20 clients with loss 122.94597359277911, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:39,756 INFO     [param_server.py:450] ====Start to sample for epoch 225, global virtualClock: 7715.7250111169815, round_duration: 46.65186139097271
2021-08-18:16:19:39,757 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:40,22 INFO     [param_server.py:553] For epoch: 225, median_reward: 398.9657606973787, dev: 797.9315213947574
2021-08-18:16:19:40,643 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1243, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:19:40,645 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3032.0616, eval_time 0.5692, test_loss 3.1243, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:19:40,645 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5693, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:19:40,646 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3032.0599, eval_time 0.5703, test_loss 2.5693, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:19:40,710 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:40,715 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:40,720 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:40,725 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:40,733 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1108, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:19:40,734 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3032.1538, eval_time 0.6588, test_loss 3.1108, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:19:40,794 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:40,813 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:42,53 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:42,80 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:42,378 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:42,389 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:43,659 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:43,672 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:43,675 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:43,686 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:43,955 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:43,976 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:44,757 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:44,778 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:45,484 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:45,505 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:45,922 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:45,936 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:46,117 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:46,138 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:46,207 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:46,219 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:46,576 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:46,586 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:46,755 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:46,775 INFO     [learner.py:606] ====Pushing takes 0.018087387084960938 s
2021-08-18:16:19:46,806 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:46,813 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:46,813 INFO     [param_server.py:410] Lock worker 1 with localStep 225 , while globalStep is 224

2021-08-18:16:19:49,5 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:49,17 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:49,421 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:49,431 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:50,137 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:50,146 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:50,222 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:50,233 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:51,200 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:51,212 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:51,436 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:51,450 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:51,859 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:51,889 INFO     [learner.py:606] ====Pushing takes 0.02822136878967285 s
2021-08-18:16:19:51,925 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:51,933 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:51,934 INFO     [param_server.py:410] Lock worker 3 with localStep 225 , while globalStep is 224

2021-08-18:16:19:52,26 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:52,66 INFO     [learner.py:606] ====Pushing takes 0.03857755661010742 s
2021-08-18:16:19:52,96 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:52,104 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:52,105 INFO     [param_server.py:381] ====After aggregation in epoch: 224, virtual_clock: 7762.376872507954, top_1: : 63.4721 % (1967.0), top_5: : 100.0 % (3099.0), test loss: 2.934791264710603, test len: 3099.0
2021-08-18:16:19:52,108 INFO     [param_server.py:410] Lock worker 2 with localStep 225 , while globalStep is 225

2021-08-18:16:19:52,109 INFO     [param_server.py:441] ====Epoch 226 completes 20 clients with loss 150.36410196331278, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:52,109 INFO     [param_server.py:450] ====Start to sample for epoch 226, global virtualClock: 7762.376872507954, round_duration: 46.65186139097271
2021-08-18:16:19:52,110 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:52,397 INFO     [param_server.py:553] For epoch: 226, median_reward: 410.351341500926, dev: 820.702683001852
2021-08-18:16:19:52,982 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8511, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:19:52,993 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3044.4099, eval_time 0.5499, test_loss 2.8511, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:19:53,45 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6986, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:19:53,47 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3044.461, eval_time 0.6039, test_loss 2.6986, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:19:53,61 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:19:53,76 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:53,111 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0856, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:19:53,112 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3044.5322, eval_time 0.6697, test_loss 3.0856, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:19:53,115 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:19:53,131 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:53,183 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:19:53,202 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:54,531 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:54,541 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:54,552 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:54,573 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:55,773 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:55,791 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:55,814 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:55,828 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:56,328 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:56,348 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:57,11 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:57,31 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:57,784 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:57,805 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:58,74 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:58,86 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:58,326 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:58,335 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:58,500 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:58,514 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:58,690 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:58,700 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:59,38 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:59,56 INFO     [learner.py:606] ====Pushing takes 0.017148494720458984 s
2021-08-18:16:19:59,85 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:59,94 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:59,95 INFO     [param_server.py:410] Lock worker 1 with localStep 226 , while globalStep is 225

2021-08-18:16:20:01,185 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:01,197 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:01,350 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:01,360 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:02,63 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:02,73 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:02,256 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:02,268 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:03,194 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:03,205 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:03,373 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:03,384 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:03,807 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:03,832 INFO     [learner.py:606] ====Pushing takes 0.024610042572021484 s
2021-08-18:16:20:03,862 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:03,870 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:03,871 INFO     [param_server.py:410] Lock worker 3 with localStep 226 , while globalStep is 225

2021-08-18:16:20:04,684 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:04,713 INFO     [learner.py:606] ====Pushing takes 0.02709794044494629 s
2021-08-18:16:20:04,744 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:04,751 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:04,752 INFO     [param_server.py:381] ====After aggregation in epoch: 225, virtual_clock: 7809.028733898927, top_1: : 65.021 % (2015.0), top_5: : 100.0 % (3099.0), test loss: 2.8784195206783436, test len: 3099.0
2021-08-18:16:20:04,755 INFO     [param_server.py:410] Lock worker 2 with localStep 226 , while globalStep is 226

2021-08-18:16:20:04,756 INFO     [param_server.py:441] ====Epoch 227 completes 20 clients with loss 91.84661039537735, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:04,757 INFO     [param_server.py:450] ====Start to sample for epoch 227, global virtualClock: 7809.028733898927, round_duration: 46.65186139097271
2021-08-18:16:20:04,757 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:05,71 INFO     [param_server.py:553] For epoch: 227, median_reward: 369.9309733014316, dev: 739.8619466028632
2021-08-18:16:20:05,785 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8955, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:20:05,788 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3057.2078, eval_time 0.6832, test_loss 2.8955, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:20:05,807 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5771, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:20:05,807 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3057.2244, eval_time 0.7015, test_loss 3.5771, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:20:05,834 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0417, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:20:05,835 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3057.2491, eval_time 0.7292, test_loss 3.0417, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:20:05,842 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:20:05,860 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:05,885 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:20:05,894 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:05,905 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:20:05,922 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:07,404 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:07,431 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:07,565 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:07,584 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:08,822 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:08,836 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:08,846 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:08,860 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:09,369 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:09,396 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:10,193 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:10,213 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:10,847 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:10,867 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:11,316 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:11,326 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:11,469 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:11,483 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:11,588 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:11,622 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:12,3 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:12,12 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:12,36 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:12,53 INFO     [learner.py:606] ====Pushing takes 0.01609635353088379 s
2021-08-18:16:20:12,81 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:12,88 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:12,89 INFO     [param_server.py:410] Lock worker 1 with localStep 227 , while globalStep is 226

2021-08-18:16:20:14,283 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:14,301 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:14,770 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:14,780 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:15,405 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:15,416 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:15,473 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:15,483 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:16,631 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:16,640 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:16,665 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:16,674 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:17,318 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:17,343 INFO     [learner.py:606] ====Pushing takes 0.02344489097595215 s
2021-08-18:16:20:17,351 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:17,373 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:17,378 INFO     [learner.py:606] ====Pushing takes 0.025543689727783203 s
2021-08-18:16:20:17,381 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:17,382 INFO     [param_server.py:410] Lock worker 3 with localStep 227 , while globalStep is 226

2021-08-18:16:20:17,409 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:17,417 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:17,418 INFO     [param_server.py:381] ====After aggregation in epoch: 226, virtual_clock: 7855.6805952899, top_1: : 62.859 % (1948.0), top_5: : 100.0 % (3099.0), test loss: 3.171453870005078, test len: 3099.0
2021-08-18:16:20:17,420 INFO     [param_server.py:410] Lock worker 2 with localStep 227 , while globalStep is 227

2021-08-18:16:20:17,420 INFO     [param_server.py:441] ====Epoch 228 completes 20 clients with loss 106.40599671992352, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:17,421 INFO     [param_server.py:450] ====Start to sample for epoch 228, global virtualClock: 7855.6805952899, round_duration: 46.65186139097271
2021-08-18:16:20:17,421 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:17,725 INFO     [param_server.py:553] For epoch: 228, median_reward: 377.11222266282283, dev: 754.2244453256457
2021-08-18:16:20:18,281 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1315, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:20:18,282 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3069.6963, eval_time 0.522, test_loss 3.1315, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:20:18,291 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9398, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:20:18,292 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3069.709, eval_time 0.5318, test_loss 2.9398, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:20:18,353 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:18,361 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:18,367 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9367, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:20:18,368 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3069.7881, eval_time 0.6101, test_loss 2.9367, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:20:18,384 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:18,393 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:18,437 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:18,462 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:19,908 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:19,948 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:19,972 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:19,988 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:21,122 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:21,131 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:21,283 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:21,297 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:21,491 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:21,519 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:22,281 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:22,301 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:23,87 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:23,115 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:23,732 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:23,743 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:23,751 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:23,764 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:23,938 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:23,950 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:24,428 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:24,450 INFO     [learner.py:606] ====Pushing takes 0.019541501998901367 s
2021-08-18:16:20:24,484 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:24,492 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:24,493 INFO     [param_server.py:410] Lock worker 1 with localStep 228 , while globalStep is 227

2021-08-18:16:20:24,528 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:24,537 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:26,422 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:26,433 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:27,67 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:27,77 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:27,599 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:27,611 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:27,708 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:27,718 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:28,829 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:28,840 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:28,876 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:28,885 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:29,402 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:29,432 INFO     [learner.py:606] ====Pushing takes 0.028413772583007812 s
2021-08-18:16:20:29,467 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:29,476 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:29,477 INFO     [param_server.py:410] Lock worker 3 with localStep 228 , while globalStep is 227

2021-08-18:16:20:30,40 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:30,69 INFO     [learner.py:606] ====Pushing takes 0.02746725082397461 s
2021-08-18:16:20:30,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:30,110 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:30,111 INFO     [param_server.py:381] ====After aggregation in epoch: 227, virtual_clock: 7902.332456680873, top_1: : 65.2469 % (2022.0), top_5: : 100.0 % (3099.0), test loss: 3.0026622745725846, test len: 3099.0
2021-08-18:16:20:30,114 INFO     [param_server.py:410] Lock worker 2 with localStep 228 , while globalStep is 228

2021-08-18:16:20:30,114 INFO     [param_server.py:441] ====Epoch 229 completes 20 clients with loss 278.91197610408443, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:30,115 INFO     [param_server.py:450] ====Start to sample for epoch 229, global virtualClock: 7902.332456680873, round_duration: 46.65186139097271
2021-08-18:16:20:30,116 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:30,465 INFO     [param_server.py:553] For epoch: 229, median_reward: 452.4383147642694, dev: 904.8766295285388
2021-08-18:16:20:31,98 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6335, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:20:31,98 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.24, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:20:31,99 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3082.513, eval_time 0.5867, test_loss 2.6335, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:20:31,99 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3082.5161, eval_time 0.587, test_loss 3.24, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:20:31,137 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9224, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:20:31,139 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3082.5584, eval_time 0.629, test_loss 2.9224, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:20:31,165 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:31,167 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:31,173 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:31,175 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:31,207 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:31,230 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:32,541 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:32,581 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:32,757 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:32,773 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:34,44 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:34,55 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:34,148 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:34,162 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:34,638 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:34,659 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:35,376 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:35,396 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:36,78 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:36,93 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:36,624 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:36,634 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:36,667 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:36,678 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:36,780 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:36,794 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:37,254 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:37,268 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:37,417 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:37,439 INFO     [learner.py:606] ====Pushing takes 0.02040386199951172 s
2021-08-18:16:20:37,472 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:37,482 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:37,504 INFO     [param_server.py:410] Lock worker 1 with localStep 229 , while globalStep is 228

2021-08-18:16:20:39,444 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:39,456 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:40,48 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:40,58 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:40,605 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:40,618 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:40,674 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:40,683 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:41,825 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:41,834 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:41,872 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:41,883 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:42,397 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:42,426 INFO     [learner.py:606] ====Pushing takes 0.02697610855102539 s
2021-08-18:16:20:42,439 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:42,456 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:42,464 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:42,465 INFO     [param_server.py:410] Lock worker 3 with localStep 229 , while globalStep is 228

2021-08-18:16:20:42,480 INFO     [learner.py:606] ====Pushing takes 0.03888130187988281 s
2021-08-18:16:20:42,510 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:42,518 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:42,518 INFO     [param_server.py:381] ====After aggregation in epoch: 228, virtual_clock: 7948.984318071846, top_1: : 61.9555 % (1920.0), top_5: : 100.0 % (3099.0), test loss: 2.93196341947273, test len: 3099.0
2021-08-18:16:20:42,521 INFO     [param_server.py:410] Lock worker 2 with localStep 229 , while globalStep is 229

2021-08-18:16:20:42,521 INFO     [param_server.py:441] ====Epoch 230 completes 20 clients with loss 156.76254625439267, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:42,522 INFO     [param_server.py:450] ====Start to sample for epoch 230, global virtualClock: 7948.984318071846, round_duration: 46.65186139097271
2021-08-18:16:20:42,523 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:42,865 INFO     [param_server.py:553] For epoch: 230, median_reward: 383.6546589227374, dev: 767.3093178454748
2021-08-18:16:20:43,519 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5996, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:20:43,523 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3094.937, eval_time 0.6103, test_loss 2.5996, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:20:43,526 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9041, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:20:43,527 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3094.9441, eval_time 0.6153, test_loss 2.9041, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:20:43,590 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:43,597 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:43,599 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:43,606 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:43,651 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8466, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:20:43,654 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3095.0742, eval_time 0.745, test_loss 2.8466, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:20:43,722 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:43,744 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:45,126 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:45,139 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:45,393 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:45,426 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:46,317 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:46,331 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:46,531 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:46,545 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:47,126 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:47,146 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:47,884 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:47,905 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:48,578 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:48,591 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:48,960 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:48,969 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:49,47 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:49,60 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:49,241 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:49,258 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:49,682 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:49,704 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:49,826 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:49,847 INFO     [learner.py:606] ====Pushing takes 0.018825054168701172 s
2021-08-18:16:20:49,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:49,889 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:49,890 INFO     [param_server.py:410] Lock worker 1 with localStep 230 , while globalStep is 229

2021-08-18:16:20:51,759 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:51,770 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:52,454 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:52,465 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:53,4 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:53,17 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:53,73 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:53,84 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:54,211 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:54,225 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:54,246 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:54,258 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:54,729 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:54,756 INFO     [learner.py:606] ====Pushing takes 0.02569746971130371 s
2021-08-18:16:20:54,788 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:54,799 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:54,799 INFO     [param_server.py:410] Lock worker 3 with localStep 230 , while globalStep is 229

2021-08-18:16:20:55,267 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:55,296 INFO     [learner.py:606] ====Pushing takes 0.027113676071166992 s
2021-08-18:16:20:55,329 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:55,337 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:55,338 INFO     [param_server.py:381] ====After aggregation in epoch: 229, virtual_clock: 7995.636179462819, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 2.7834271258778043, test len: 3099.0
2021-08-18:16:20:55,340 INFO     [param_server.py:410] Lock worker 2 with localStep 230 , while globalStep is 230

2021-08-18:16:20:55,340 INFO     [param_server.py:441] ====Epoch 231 completes 20 clients with loss 206.30559401097062, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:55,341 INFO     [param_server.py:450] ====Start to sample for epoch 231, global virtualClock: 7995.636179462819, round_duration: 46.65186139097271
2021-08-18:16:20:55,342 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:55,681 INFO     [param_server.py:553] For epoch: 231, median_reward: 416.0908558811936, dev: 832.1817117623872
2021-08-18:16:20:56,368 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6888, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:20:56,369 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3107.7857, eval_time 0.6421, test_loss 2.6888, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:20:56,406 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7102, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:20:56,407 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3107.8212, eval_time 0.6806, test_loss 2.7102, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:20:56,435 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:20:56,445 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:56,476 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:20:56,492 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:56,518 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2146, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:20:56,519 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3107.9388, eval_time 0.7927, test_loss 3.2146, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:20:56,589 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:20:56,621 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:58,61 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:58,62 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:58,72 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:58,89 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:59,290 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:59,300 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:59,499 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:59,520 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:00,136 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:00,163 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:00,791 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:00,805 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:01,447 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:01,462 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:01,773 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:01,782 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:02,79 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:02,94 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:02,202 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:02,213 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:02,404 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:02,414 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:02,734 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:02,752 INFO     [learner.py:606] ====Pushing takes 0.016933202743530273 s
2021-08-18:16:21:02,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:02,785 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:02,785 INFO     [param_server.py:410] Lock worker 1 with localStep 231 , while globalStep is 230

2021-08-18:16:21:04,927 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:04,941 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:05,121 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:05,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:05,716 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:05,725 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:06,237 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:06,248 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:06,837 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:06,847 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:07,512 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:07,541 INFO     [learner.py:606] ====Pushing takes 0.027858495712280273 s
2021-08-18:16:21:07,541 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:07,551 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:07,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:07,588 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:07,589 INFO     [param_server.py:410] Lock worker 3 with localStep 231 , while globalStep is 230

2021-08-18:16:21:08,175 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:08,217 INFO     [learner.py:606] ====Pushing takes 0.036849021911621094 s
2021-08-18:16:21:08,247 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:08,255 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:08,256 INFO     [param_server.py:381] ====After aggregation in epoch: 230, virtual_clock: 8042.288040853792, top_1: : 63.9561 % (1982.0), top_5: : 100.0 % (3099.0), test loss: 2.8712323738469014, test len: 3099.0
2021-08-18:16:21:08,259 INFO     [param_server.py:410] Lock worker 2 with localStep 231 , while globalStep is 231

2021-08-18:16:21:08,259 INFO     [param_server.py:441] ====Epoch 232 completes 20 clients with loss 186.6085985590459, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:08,259 INFO     [param_server.py:450] ====Start to sample for epoch 232, global virtualClock: 8042.288040853792, round_duration: 46.65186139097271
2021-08-18:16:21:08,260 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:08,546 INFO     [param_server.py:553] For epoch: 232, median_reward: 362.39554346536806, dev: 724.7910869307361
2021-08-18:16:21:09,229 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9141, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:21:09,230 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3120.6472, eval_time 0.6302, test_loss 2.9141, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:21:09,268 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1307, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:21:09,269 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3120.683, eval_time 0.6689, test_loss 3.1307, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:21:09,295 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:21:09,304 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:09,334 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:21:09,350 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:09,397 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3689, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:21:09,400 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3120.8201, eval_time 0.8018, test_loss 3.3689, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:21:09,459 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:21:09,492 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:10,885 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:10,901 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:10,911 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:10,912 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:12,273 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:12,285 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:12,353 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:12,368 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:12,552 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:12,579 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:13,357 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:13,378 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:14,79 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:14,93 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:14,754 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:14,760 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:14,763 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:14,774 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:14,967 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:14,978 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:15,349 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:15,369 INFO     [learner.py:606] ====Pushing takes 0.019104957580566406 s
2021-08-18:16:21:15,393 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:15,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:15,406 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:15,410 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:15,411 INFO     [param_server.py:410] Lock worker 1 with localStep 232 , while globalStep is 231

2021-08-18:16:21:17,621 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:17,633 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:18,15 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:18,26 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:18,621 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:18,631 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:18,719 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:18,731 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:19,845 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:19,859 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:20,36 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:20,45 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:20,530 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:20,557 INFO     [learner.py:606] ====Pushing takes 0.025295734405517578 s
2021-08-18:16:21:20,587 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:20,595 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:20,595 INFO     [param_server.py:410] Lock worker 3 with localStep 232 , while globalStep is 231

2021-08-18:16:21:21,202 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:21,229 INFO     [learner.py:606] ====Pushing takes 0.0257110595703125 s
2021-08-18:16:21:21,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:21,268 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:21,268 INFO     [param_server.py:381] ====After aggregation in epoch: 231, virtual_clock: 8088.939902244765, top_1: : 65.3759 % (2026.0), top_5: : 100.0 % (3099.0), test loss: 3.1379142734739514, test len: 3099.0
2021-08-18:16:21:21,270 INFO     [param_server.py:410] Lock worker 2 with localStep 232 , while globalStep is 232

2021-08-18:16:21:21,271 INFO     [param_server.py:441] ====Epoch 233 completes 20 clients with loss 112.69284324232876, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:21,271 INFO     [param_server.py:450] ====Start to sample for epoch 233, global virtualClock: 8088.939902244765, round_duration: 46.65186139097271
2021-08-18:16:21:21,272 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:21,604 INFO     [param_server.py:553] For epoch: 233, median_reward: 363.84220129148235, dev: 727.6844025829647
2021-08-18:16:21:22,178 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0523, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:21:22,178 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3133.5955, eval_time 0.5302, test_loss 3.0523, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:21:22,164 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5277, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:21:22,181 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3133.5951, eval_time 0.5327, test_loss 2.5277, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:21:22,246 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:22,246 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:22,254 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:22,254 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:22,304 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.057, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:21:22,305 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3133.7243, eval_time 0.6565, test_loss 3.057, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:21:22,376 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:22,403 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:23,953 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:23,987 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:23,994 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:24,13 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:25,219 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:25,230 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:25,249 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:25,265 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:25,859 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:25,880 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:26,768 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:26,788 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:27,594 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:27,608 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:27,768 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:27,777 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:27,782 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:27,791 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:28,221 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:28,239 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:28,407 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:28,416 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:28,936 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:28,954 INFO     [learner.py:606] ====Pushing takes 0.016902923583984375 s
2021-08-18:16:21:28,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:28,995 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:28,996 INFO     [param_server.py:410] Lock worker 1 with localStep 233 , while globalStep is 232

2021-08-18:16:21:30,475 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:30,487 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:31,125 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:31,136 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:31,701 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:31,710 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:31,773 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:31,787 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:32,784 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:32,796 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:32,992 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:33,6 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:33,390 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:33,417 INFO     [learner.py:606] ====Pushing takes 0.026283740997314453 s
2021-08-18:16:21:33,448 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:33,458 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:33,459 INFO     [param_server.py:410] Lock worker 2 with localStep 233 , while globalStep is 232

2021-08-18:16:21:33,703 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:33,733 INFO     [learner.py:606] ====Pushing takes 0.028423547744750977 s
2021-08-18:16:21:33,765 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:33,773 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:33,773 INFO     [param_server.py:381] ====After aggregation in epoch: 232, virtual_clock: 8135.591763635738, top_1: : 63.5366 % (1969.0), top_5: : 100.0 % (3099.0), test loss: 2.879008879264196, test len: 3099.0
2021-08-18:16:21:33,776 INFO     [param_server.py:410] Lock worker 3 with localStep 233 , while globalStep is 233

2021-08-18:16:21:33,776 INFO     [param_server.py:441] ====Epoch 234 completes 20 clients with loss 157.49301092099748, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:33,776 INFO     [param_server.py:450] ====Start to sample for epoch 234, global virtualClock: 8135.591763635738, round_duration: 46.65186139097271
2021-08-18:16:21:33,777 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:34,68 INFO     [param_server.py:553] For epoch: 234, median_reward: 401.8748129580083, dev: 803.7496259160166
2021-08-18:16:21:34,684 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9854, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:21:34,685 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3146.0988, eval_time 0.582, test_loss 2.9854, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:21:34,693 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1849, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:21:34,694 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3146.1111, eval_time 0.5923, test_loss 3.1849, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:21:34,751 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:34,760 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:34,775 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:34,786 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:34,812 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9974, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:21:34,813 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3146.2329, eval_time 0.7116, test_loss 2.9974, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:21:34,869 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:34,895 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:36,389 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:36,416 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:36,469 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:36,489 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:37,641 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:37,651 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:37,664 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:37,673 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:37,851 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:37,872 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:38,643 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:38,663 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:39,345 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:39,365 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:39,995 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:40,1 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:40,15 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:40,15 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:40,298 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:40,310 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:40,654 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:40,675 INFO     [learner.py:606] ====Pushing takes 0.01978445053100586 s
2021-08-18:16:21:40,705 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:40,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:40,715 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:40,715 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:40,716 INFO     [param_server.py:410] Lock worker 1 with localStep 234 , while globalStep is 233

2021-08-18:16:21:43,14 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:43,28 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:43,558 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:43,572 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:44,239 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:44,249 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:44,400 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:44,415 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:45,427 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:45,442 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:45,542 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:45,551 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:46,68 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:46,96 INFO     [learner.py:606] ====Pushing takes 0.02715468406677246 s
2021-08-18:16:21:46,132 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:46,140 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:46,141 INFO     [param_server.py:410] Lock worker 3 with localStep 234 , while globalStep is 233

2021-08-18:16:21:46,658 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:46,688 INFO     [learner.py:606] ====Pushing takes 0.027659177780151367 s
2021-08-18:16:21:46,717 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:46,725 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:46,726 INFO     [param_server.py:381] ====After aggregation in epoch: 233, virtual_clock: 8182.243625026711, top_1: : 65.5373 % (2031.0), top_5: : 100.0 % (3099.0), test loss: 3.0558669920320862, test len: 3099.0
2021-08-18:16:21:46,729 INFO     [param_server.py:410] Lock worker 2 with localStep 234 , while globalStep is 234

2021-08-18:16:21:46,729 INFO     [param_server.py:441] ====Epoch 235 completes 20 clients with loss 130.78799091329623, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:46,729 INFO     [param_server.py:450] ====Start to sample for epoch 235, global virtualClock: 8182.243625026711, round_duration: 46.65186139097271
2021-08-18:16:21:46,741 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:47,69 INFO     [param_server.py:553] For epoch: 235, median_reward: 419.07909911119685, dev: 838.1581982223937
2021-08-18:16:21:47,887 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7616, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:21:47,888 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3159.3052, eval_time 0.7737, test_loss 2.7616, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:21:47,926 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0174, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:21:47,927 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3159.3415, eval_time 0.813, test_loss 3.0174, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:21:47,954 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:47,961 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:47,990 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:48,2 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3993, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:21:48,5 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3159.425, eval_time 0.8909, test_loss 3.3993, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:21:48,6 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:48,73 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:48,99 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:49,203 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:49,217 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:49,522 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:49,533 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:50,558 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:50,567 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:50,866 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:50,876 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:51,45 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:51,66 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:51,838 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:51,859 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:52,566 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:52,587 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:53,41 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:53,54 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:53,213 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:53,233 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:53,587 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:53,598 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:53,719 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:53,733 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:53,872 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:53,891 INFO     [learner.py:606] ====Pushing takes 0.01723504066467285 s
2021-08-18:16:21:53,918 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:53,927 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:53,927 INFO     [param_server.py:410] Lock worker 1 with localStep 235 , while globalStep is 234

2021-08-18:16:21:56,150 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:56,161 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:56,700 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:56,714 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:57,440 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:57,450 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:57,569 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:57,578 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:58,640 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:58,649 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:58,744 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:58,756 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:59,294 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:59,320 INFO     [learner.py:606] ====Pushing takes 0.02393794059753418 s
2021-08-18:16:21:59,349 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:59,351 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:59,357 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:59,358 INFO     [param_server.py:410] Lock worker 2 with localStep 235 , while globalStep is 234

2021-08-18:16:21:59,378 INFO     [learner.py:606] ====Pushing takes 0.026248693466186523 s
2021-08-18:16:21:59,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:59,418 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:59,418 INFO     [param_server.py:381] ====After aggregation in epoch: 234, virtual_clock: 8228.895486417683, top_1: : 62.504 % (1937.0), top_5: : 100.0 % (3099.0), test loss: 3.0594028587694524, test len: 3099.0
2021-08-18:16:21:59,421 INFO     [param_server.py:410] Lock worker 3 with localStep 235 , while globalStep is 235

2021-08-18:16:21:59,421 INFO     [param_server.py:441] ====Epoch 236 completes 20 clients with loss 175.4879602758487, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:59,421 INFO     [param_server.py:450] ====Start to sample for epoch 236, global virtualClock: 8228.895486417683, round_duration: 46.65186139097271
2021-08-18:16:21:59,422 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:59,719 INFO     [param_server.py:553] For epoch: 236, median_reward: 447.90389722261773, dev: 895.8077944452355
2021-08-18:16:22:00,388 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6439, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:22:00,389 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3171.8036, eval_time 0.631, test_loss 2.6439, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:22:00,393 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8209, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:22:00,394 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3171.8113, eval_time 0.6402, test_loss 2.8209, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:22:00,421 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1005, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:22:00,422 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3171.8418, eval_time 0.6689, test_loss 3.1005, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:22:00,456 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:22:00,470 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:00,473 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:22:00,481 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:00,491 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:22:00,503 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:01,660 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:01,674 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:02,31 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:02,42 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:02,956 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:02,974 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:03,102 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:03,116 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:03,189 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:03,201 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:03,723 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:03,743 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:04,523 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:04,543 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:05,123 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:05,144 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:05,448 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:05,457 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:05,825 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:05,846 INFO     [learner.py:606] ====Pushing takes 0.019657135009765625 s
2021-08-18:16:22:05,882 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:05,889 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:05,889 INFO     [param_server.py:410] Lock worker 1 with localStep 236 , while globalStep is 235

2021-08-18:16:22:05,919 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:05,930 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:06,84 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:06,101 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:08,753 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:08,766 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:09,15 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:09,33 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:09,778 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:09,793 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:10,8 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:10,19 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:10,897 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:10,910 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:11,135 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:11,147 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:11,647 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:11,677 INFO     [learner.py:606] ====Pushing takes 0.028478384017944336 s
2021-08-18:16:22:11,715 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:11,723 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:11,724 INFO     [param_server.py:410] Lock worker 3 with localStep 236 , while globalStep is 235

2021-08-18:16:22:12,419 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:12,447 INFO     [learner.py:606] ====Pushing takes 0.026421785354614258 s
2021-08-18:16:22:12,481 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:12,489 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:12,490 INFO     [param_server.py:381] ====After aggregation in epoch: 235, virtual_clock: 8275.547347808655, top_1: : 64.666 % (2004.0), top_5: : 100.0 % (3099.0), test loss: 2.855090640209339, test len: 3099.0
2021-08-18:16:22:12,493 INFO     [param_server.py:410] Lock worker 2 with localStep 236 , while globalStep is 236

2021-08-18:16:22:12,493 INFO     [param_server.py:441] ====Epoch 237 completes 20 clients with loss 252.00702584359146, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:12,494 INFO     [param_server.py:450] ====Start to sample for epoch 237, global virtualClock: 8275.547347808655, round_duration: 46.65186139097271
2021-08-18:16:22:12,495 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:12,814 INFO     [param_server.py:553] For epoch: 237, median_reward: 407.630058539862, dev: 815.260117079724
2021-08-18:16:22:13,424 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.755, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:22:13,425 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3184.8423, eval_time 0.5854, test_loss 2.755, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:22:13,461 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.89, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:22:13,461 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9397, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:22:13,462 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3184.8817, eval_time 0.6248, test_loss 2.89, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:22:13,462 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3184.8764, eval_time 0.6204, test_loss 2.9397, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:22:13,492 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:13,500 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:13,516 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:13,529 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:13,531 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:13,543 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:14,883 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:14,893 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:15,203 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:15,214 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:16,373 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:16,382 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:16,417 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:16,430 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:16,505 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:16,519 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:17,156 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:17,170 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:17,996 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:18,23 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:18,633 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:18,643 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:18,690 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:18,718 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:19,73 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:19,85 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:19,269 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:19,278 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:19,320 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:19,339 INFO     [learner.py:606] ====Pushing takes 0.018102169036865234 s
2021-08-18:16:22:19,366 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:19,373 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:19,373 INFO     [param_server.py:410] Lock worker 1 with localStep 237 , while globalStep is 236

2021-08-18:16:22:21,766 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:21,785 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:22,18 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:22,37 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:22,712 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:22,727 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:22,983 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:22,999 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:24,3 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:24,14 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:24,97 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:24,108 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:24,566 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:24,594 INFO     [learner.py:606] ====Pushing takes 0.0267636775970459 s
2021-08-18:16:22:24,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:24,632 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:24,633 INFO     [param_server.py:410] Lock worker 3 with localStep 237 , while globalStep is 236

2021-08-18:16:22:24,650 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:24,677 INFO     [learner.py:606] ====Pushing takes 0.025490760803222656 s
2021-08-18:16:22:24,709 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:24,717 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:24,718 INFO     [param_server.py:381] ====After aggregation in epoch: 236, virtual_clock: 8322.199209199627, top_1: : 65.4405 % (2028.0), top_5: : 100.0 % (3099.0), test loss: 2.861575691788285, test len: 3099.0
2021-08-18:16:22:24,720 INFO     [param_server.py:410] Lock worker 2 with localStep 237 , while globalStep is 237

2021-08-18:16:22:24,721 INFO     [param_server.py:441] ====Epoch 238 completes 20 clients with loss 164.1199502423158, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:24,721 INFO     [param_server.py:450] ====Start to sample for epoch 238, global virtualClock: 8322.199209199627, round_duration: 46.65186139097271
2021-08-18:16:22:24,722 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:25,2 INFO     [param_server.py:553] For epoch: 238, median_reward: 390.68158421944526, dev: 781.3631684388905
2021-08-18:16:22:25,655 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8098, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:22:25,656 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3197.0727, eval_time 0.6311, test_loss 2.8098, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:22:25,666 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4973, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:22:25,667 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3197.0816, eval_time 0.6429, test_loss 3.4973, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:22:25,698 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6493, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:22:25,702 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3197.1215, eval_time 0.6774, test_loss 3.6493, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:22:25,724 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:25,734 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:25,734 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:25,742 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:25,773 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:25,789 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:26,974 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:26,984 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:27,376 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:27,386 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:28,290 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:28,303 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:28,450 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:28,459 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:28,544 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:28,553 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:29,5 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:29,19 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:29,657 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:29,671 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:30,249 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:30,269 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:30,742 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:30,751 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:30,812 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:30,830 INFO     [learner.py:606] ====Pushing takes 0.016888141632080078 s
2021-08-18:16:22:30,859 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:30,867 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:30,868 INFO     [param_server.py:410] Lock worker 1 with localStep 238 , while globalStep is 237

2021-08-18:16:22:31,253 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:31,264 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:31,327 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:31,337 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:33,983 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:33,994 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:34,453 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:34,471 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:35,33 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:35,44 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:35,204 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:35,218 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:36,153 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:36,164 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:36,522 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:36,533 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:37,110 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:37,135 INFO     [learner.py:606] ====Pushing takes 0.023621320724487305 s
2021-08-18:16:22:37,165 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:37,175 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:37,176 INFO     [param_server.py:410] Lock worker 3 with localStep 238 , while globalStep is 237

2021-08-18:16:22:37,202 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:37,231 INFO     [learner.py:606] ====Pushing takes 0.027383089065551758 s
2021-08-18:16:22:37,262 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:37,270 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:37,271 INFO     [param_server.py:381] ====After aggregation in epoch: 237, virtual_clock: 8368.8510705906, top_1: : 64.5047 % (1999.0), top_5: : 100.0 % (3099.0), test loss: 3.318811659459714, test len: 3099.0
2021-08-18:16:22:37,273 INFO     [param_server.py:410] Lock worker 2 with localStep 238 , while globalStep is 238

2021-08-18:16:22:37,274 INFO     [param_server.py:441] ====Epoch 239 completes 20 clients with loss 272.16171901632396, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:37,274 INFO     [param_server.py:450] ====Start to sample for epoch 239, global virtualClock: 8368.8510705906, round_duration: 46.65186139097271
2021-08-18:16:22:37,275 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:37,552 INFO     [param_server.py:553] For epoch: 239, median_reward: 371.3524926543392, dev: 742.7049853086784
2021-08-18:16:22:38,149 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7441, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:22:38,153 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3209.5675, eval_time 0.5762, test_loss 2.7441, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:22:38,151 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1205, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:22:38,154 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3209.5716, eval_time 0.5799, test_loss 3.1205, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:22:38,195 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0135, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:22:38,196 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3209.6158, eval_time 0.6216, test_loss 3.0135, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:22:38,223 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:38,231 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:38,238 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:38,249 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:38,256 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:38,271 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:39,368 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:39,377 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:39,835 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:39,846 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:40,839 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:40,849 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:41,95 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:41,106 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:41,145 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:41,165 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:41,968 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:41,989 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:42,703 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:42,724 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:43,153 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:43,166 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:43,408 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:43,429 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:43,814 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:43,822 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:43,826 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:43,833 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:44,95 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:44,115 INFO     [learner.py:606] ====Pushing takes 0.018517494201660156 s
2021-08-18:16:22:44,147 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:44,154 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:44,154 INFO     [param_server.py:410] Lock worker 1 with localStep 239 , while globalStep is 238

2021-08-18:16:22:46,560 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:46,571 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:46,758 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:46,777 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:47,495 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:47,509 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:47,884 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:47,895 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:48,619 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:48,628 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:49,8 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:49,20 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:49,347 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:49,375 INFO     [learner.py:606] ====Pushing takes 0.02721381187438965 s
2021-08-18:16:22:49,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:49,417 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:49,418 INFO     [param_server.py:410] Lock worker 3 with localStep 239 , while globalStep is 238

2021-08-18:16:22:49,535 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:49,563 INFO     [learner.py:606] ====Pushing takes 0.02693653106689453 s
2021-08-18:16:22:49,592 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:49,600 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:49,601 INFO     [param_server.py:381] ====After aggregation in epoch: 238, virtual_clock: 8415.502931981571, top_1: : 62.9558 % (1951.0), top_5: : 100.0 % (3099.0), test loss: 2.9593708382712474, test len: 3099.0
2021-08-18:16:22:49,603 INFO     [param_server.py:410] Lock worker 2 with localStep 239 , while globalStep is 239

2021-08-18:16:22:49,604 INFO     [param_server.py:441] ====Epoch 240 completes 20 clients with loss 115.16638790902336, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:49,604 INFO     [param_server.py:450] ====Start to sample for epoch 240, global virtualClock: 8415.502931981571, round_duration: 46.65186139097271
2021-08-18:16:22:49,605 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:49,931 INFO     [param_server.py:553] For epoch: 240, median_reward: 368.9021046436596, dev: 737.8042092873192
2021-08-18:16:22:50,535 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8918, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:22:50,536 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3221.9504, eval_time 0.5797, test_loss 2.8918, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:22:50,548 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8887, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:22:50,549 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3221.966, eval_time 0.5924, test_loss 2.8887, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:22:50,573 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0087, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:22:50,574 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3221.9935, eval_time 0.6197, test_loss 3.0087, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:22:50,619 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:50,622 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:50,629 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:50,630 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:50,645 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:50,659 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:51,875 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:51,889 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:52,309 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:52,321 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:53,125 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:53,143 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:53,390 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:53,400 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:53,501 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:53,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:53,994 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:54,15 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:54,870 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:54,890 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:55,557 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:55,577 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:55,776 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:55,786 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:56,197 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:56,207 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:56,218 INFO     [learner.py:606] ====Pushing takes 0.018926382064819336 s
2021-08-18:16:22:56,220 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:56,252 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:56,262 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:56,263 INFO     [param_server.py:410] Lock worker 1 with localStep 240 , while globalStep is 239

2021-08-18:16:22:56,422 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:56,436 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:59,64 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:59,78 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:59,236 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:59,250 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:59,900 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:59,914 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:00,244 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:00,254 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:01,86 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:01,95 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:01,491 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:01,502 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:01,642 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:01,671 INFO     [learner.py:606] ====Pushing takes 0.02751779556274414 s
2021-08-18:16:23:01,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:01,716 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:01,717 INFO     [param_server.py:410] Lock worker 3 with localStep 240 , while globalStep is 239

2021-08-18:16:23:02,629 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:02,658 INFO     [learner.py:606] ====Pushing takes 0.02772235870361328 s
2021-08-18:16:23:02,697 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:02,705 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:02,706 INFO     [param_server.py:381] ====After aggregation in epoch: 239, virtual_clock: 8462.154793372543, top_1: : 64.2143 % (1990.0), top_5: : 100.0 % (3099.0), test loss: 2.929748274661877, test len: 3099.0
2021-08-18:16:23:02,708 INFO     [param_server.py:410] Lock worker 2 with localStep 240 , while globalStep is 240

2021-08-18:16:23:02,708 INFO     [param_server.py:441] ====Epoch 241 completes 20 clients with loss 118.19555113428639, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:02,709 INFO     [param_server.py:450] ====Start to sample for epoch 241, global virtualClock: 8462.154793372543, round_duration: 46.65186139097271
2021-08-18:16:23:02,710 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:03,17 INFO     [param_server.py:541] Handle Wight 0.03963136672973633 | Send 0.30817532539367676
2021-08-18:16:23:03,18 INFO     [param_server.py:553] For epoch: 241, median_reward: 356.01937184761937, dev: 712.0387436952387
2021-08-18:16:23:03,636 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4034, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:23:03,637 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3235.0543, eval_time 0.5969, test_loss 3.4034, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:23:03,672 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1417, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:23:03,676 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3235.0952, eval_time 0.6353, test_loss 3.1417, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:23:03,712 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:23:03,720 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:03,718 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2006, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:23:03,724 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3235.138, eval_time 0.6835, test_loss 3.2006, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:23:03,742 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:23:03,757 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:03,794 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:23:03,803 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:05,152 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:05,168 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:05,468 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:05,480 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:06,612 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:06,622 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:06,758 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:06,770 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:07,3 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:07,23 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:07,831 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:07,851 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:08,593 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:08,614 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:09,20 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:09,34 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:09,280 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:09,307 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:09,511 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:09,524 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:09,713 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:09,724 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:09,887 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:09,907 INFO     [learner.py:606] ====Pushing takes 0.018795490264892578 s
2021-08-18:16:23:09,941 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:09,949 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:09,949 INFO     [param_server.py:410] Lock worker 1 with localStep 241 , while globalStep is 240

2021-08-18:16:23:12,198 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:12,212 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:12,655 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:12,668 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:13,284 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:13,293 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:13,615 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:13,626 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:14,417 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:14,426 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:14,901 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:14,911 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:15,23 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:15,52 INFO     [learner.py:606] ====Pushing takes 0.027522563934326172 s
2021-08-18:16:23:15,92 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:15,102 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:15,103 INFO     [param_server.py:410] Lock worker 3 with localStep 241 , while globalStep is 240

2021-08-18:16:23:15,402 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:15,431 INFO     [learner.py:606] ====Pushing takes 0.027786970138549805 s
2021-08-18:16:23:15,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:15,470 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:15,470 INFO     [param_server.py:381] ====After aggregation in epoch: 240, virtual_clock: 8508.806654763515, top_1: : 63.1171 % (1956.0), top_5: : 100.0 % (3099.0), test loss: 3.2485513510527433, test len: 3099.0
2021-08-18:16:23:15,472 INFO     [param_server.py:410] Lock worker 2 with localStep 241 , while globalStep is 241

2021-08-18:16:23:15,473 INFO     [param_server.py:441] ====Epoch 242 completes 20 clients with loss 183.01533062444457, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:15,473 INFO     [param_server.py:450] ====Start to sample for epoch 242, global virtualClock: 8508.806654763515, round_duration: 46.65186139097271
2021-08-18:16:23:15,474 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:15,747 INFO     [param_server.py:553] For epoch: 242, median_reward: 375.8811113362152, dev: 751.7622226724304
2021-08-18:16:23:16,378 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3826, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:23:16,379 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3247.7965, eval_time 0.5942, test_loss 3.3826, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:23:16,420 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.253, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:23:16,421 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3247.8407, eval_time 0.64, test_loss 3.253, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:23:16,441 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7453, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:23:16,442 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3247.8562, eval_time 0.6526, test_loss 2.7453, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:23:16,449 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:16,456 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:16,478 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:16,490 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:16,514 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:16,522 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:17,666 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:17,687 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:18,88 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:18,99 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:18,945 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:18,960 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:19,185 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:19,196 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:19,221 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:19,231 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:19,753 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:19,774 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:20,480 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:20,500 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:21,151 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:21,171 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:21,479 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:21,491 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:21,842 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:21,863 INFO     [learner.py:606] ====Pushing takes 0.019210338592529297 s
2021-08-18:16:23:21,889 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:21,895 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:21,896 INFO     [param_server.py:410] Lock worker 1 with localStep 242 , while globalStep is 241

2021-08-18:16:23:21,928 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:21,939 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:22,108 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:22,117 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:24,562 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:24,590 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:24,974 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:24,988 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:25,625 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:25,635 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:25,856 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:25,867 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:26,857 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:26,866 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:26,961 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:26,973 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:27,471 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:27,501 INFO     [learner.py:606] ====Pushing takes 0.028336524963378906 s
2021-08-18:16:23:27,541 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:27,549 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:27,549 INFO     [param_server.py:410] Lock worker 3 with localStep 242 , while globalStep is 241

2021-08-18:16:23:28,313 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:28,342 INFO     [learner.py:606] ====Pushing takes 0.02497553825378418 s
2021-08-18:16:23:28,377 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:28,385 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:28,386 INFO     [param_server.py:381] ====After aggregation in epoch: 241, virtual_clock: 8555.458516154487, top_1: : 62.8267 % (1947.0), top_5: : 100.0 % (3099.0), test loss: 3.1269503302044335, test len: 3099.0
2021-08-18:16:23:28,388 INFO     [param_server.py:410] Lock worker 2 with localStep 242 , while globalStep is 242

2021-08-18:16:23:28,388 INFO     [param_server.py:441] ====Epoch 243 completes 20 clients with loss 103.96532262937204, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:28,389 INFO     [param_server.py:450] ====Start to sample for epoch 243, global virtualClock: 8555.458516154487, round_duration: 46.65186139097271
2021-08-18:16:23:28,389 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:28,681 INFO     [param_server.py:553] For epoch: 243, median_reward: 385.85856914711326, dev: 771.7171382942265
2021-08-18:16:23:29,347 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8845, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:23:29,348 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3260.7651, eval_time 0.6208, test_loss 2.8845, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:23:29,358 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.493, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:23:29,359 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3260.7731, eval_time 0.6304, test_loss 2.493, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:23:29,412 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8417, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:23:29,414 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3260.8341, eval_time 0.6891, test_loss 2.8417, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:23:29,417 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:29,425 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:29,429 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:29,437 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:29,486 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:29,504 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:30,754 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:30,768 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:30,948 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:30,958 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:32,86 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:32,97 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:32,106 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:32,117 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:32,577 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:32,591 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:33,366 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:33,387 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:34,135 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:34,155 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:34,418 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:34,431 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:34,782 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:34,794 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:34,907 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:34,927 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:35,46 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:35,61 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:35,456 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:35,474 INFO     [learner.py:606] ====Pushing takes 0.01726055145263672 s
2021-08-18:16:23:35,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:35,518 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:35,519 INFO     [param_server.py:410] Lock worker 1 with localStep 243 , while globalStep is 242

2021-08-18:16:23:37,479 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:37,490 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:38,95 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:38,106 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:38,576 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:38,587 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:38,657 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:38,667 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:39,873 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:39,883 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:39,896 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:39,905 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:40,500 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:40,512 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:40,528 INFO     [learner.py:606] ====Pushing takes 0.026839733123779297 s
2021-08-18:16:23:40,563 INFO     [learner.py:606] ====Pushing takes 0.04914045333862305 s
2021-08-18:16:23:40,570 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:40,579 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:40,580 INFO     [param_server.py:410] Lock worker 2 with localStep 243 , while globalStep is 242

2021-08-18:16:23:40,604 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:40,612 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:40,613 INFO     [param_server.py:381] ====After aggregation in epoch: 242, virtual_clock: 8602.11037754546, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 2.7397325149288885, test len: 3099.0
2021-08-18:16:23:40,616 INFO     [param_server.py:410] Lock worker 3 with localStep 243 , while globalStep is 243

2021-08-18:16:23:40,616 INFO     [param_server.py:441] ====Epoch 244 completes 20 clients with loss 170.93384612017175, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:40,616 INFO     [param_server.py:450] ====Start to sample for epoch 244, global virtualClock: 8602.11037754546, round_duration: 46.65186139097271
2021-08-18:16:23:40,617 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:40,895 INFO     [param_server.py:553] For epoch: 244, median_reward: 375.1903486670629, dev: 750.3806973341258
2021-08-18:16:23:41,706 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5512, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:23:41,707 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3273.1215, eval_time 0.7679, test_loss 2.5512, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:23:41,752 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1447, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:23:41,753 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3273.1697, eval_time 0.8132, test_loss 3.1447, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:23:41,772 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:41,786 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:41,798 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7082, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:23:41,799 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3273.2187, eval_time 0.8596, test_loss 2.7082, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:23:41,817 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:41,849 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:41,856 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:41,883 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:43,173 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:43,191 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:43,509 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:43,520 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:44,233 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:44,242 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:44,552 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:44,565 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:44,740 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:44,750 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:44,892 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:44,940 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:45,716 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:45,736 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:46,317 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:46,338 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:46,833 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:46,843 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:46,934 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:46,955 INFO     [learner.py:606] ====Pushing takes 0.018795251846313477 s
2021-08-18:16:23:46,992 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:47,0 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:47,1 INFO     [param_server.py:410] Lock worker 1 with localStep 244 , while globalStep is 243

2021-08-18:16:23:47,372 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:47,383 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:47,492 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:47,510 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:50,14 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:50,24 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:50,235 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:50,249 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:51,76 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:51,86 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:51,104 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:51,115 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:52,129 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:52,138 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:52,182 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:52,193 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:52,634 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:52,663 INFO     [learner.py:606] ====Pushing takes 0.027526378631591797 s
2021-08-18:16:23:52,699 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:52,708 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:52,709 INFO     [param_server.py:410] Lock worker 3 with localStep 244 , while globalStep is 243

2021-08-18:16:23:53,434 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:53,462 INFO     [learner.py:606] ====Pushing takes 0.026259422302246094 s
2021-08-18:16:23:53,492 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:53,502 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:53,503 INFO     [param_server.py:381] ====After aggregation in epoch: 243, virtual_clock: 8648.762238936431, top_1: : 64.7628 % (2007.0), top_5: : 100.0 % (3099.0), test loss: 2.8013904548629562, test len: 3099.0
2021-08-18:16:23:53,506 INFO     [param_server.py:410] Lock worker 2 with localStep 244 , while globalStep is 244

2021-08-18:16:23:53,506 INFO     [param_server.py:441] ====Epoch 245 completes 20 clients with loss 200.75786919347263, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:53,507 INFO     [param_server.py:450] ====Start to sample for epoch 245, global virtualClock: 8648.762238936431, round_duration: 46.65186139097271
2021-08-18:16:23:53,508 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:53,846 INFO     [param_server.py:553] For epoch: 245, median_reward: 351.6210454237422, dev: 703.2420908474844
2021-08-18:16:23:54,454 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9075, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:23:54,455 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3285.8718, eval_time 0.561, test_loss 2.9075, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:23:54,520 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6989, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:23:54,523 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3285.9426, eval_time 0.6315, test_loss 2.6989, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:23:54,530 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:23:54,546 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:54,551 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6098, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:23:54,552 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3285.9657, eval_time 0.6576, test_loss 2.6098, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:23:54,581 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:23:54,602 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:54,619 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:23:54,633 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:55,945 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:55,954 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:56,122 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:56,131 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:57,318 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:57,329 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:57,347 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:57,357 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:57,556 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:57,577 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:58,350 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:58,370 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:59,161 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:59,183 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:59,541 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:59,555 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:59,805 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:59,826 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:59,945 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:59,955 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:00,267 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:00,282 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:00,483 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:00,503 INFO     [learner.py:606] ====Pushing takes 0.01849985122680664 s
2021-08-18:16:24:00,537 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:00,544 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:00,545 INFO     [param_server.py:410] Lock worker 1 with localStep 245 , while globalStep is 244

2021-08-18:16:24:02,720 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:02,732 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:02,976 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:02,998 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:03,678 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:03,692 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:03,915 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:03,932 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:04,938 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:04,948 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:05,17 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:05,29 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:05,577 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:05,606 INFO     [learner.py:606] ====Pushing takes 0.0275418758392334 s
2021-08-18:16:24:05,623 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:05,639 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:05,647 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:05,648 INFO     [param_server.py:410] Lock worker 2 with localStep 245 , while globalStep is 244

2021-08-18:16:24:05,653 INFO     [learner.py:606] ====Pushing takes 0.029016494750976562 s
2021-08-18:16:24:05,689 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:05,699 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:05,700 INFO     [param_server.py:381] ====After aggregation in epoch: 244, virtual_clock: 8695.414100327404, top_1: : 65.021 % (2015.0), top_5: : 100.0 % (3099.0), test loss: 2.738729788197412, test len: 3099.0
2021-08-18:16:24:05,702 INFO     [param_server.py:410] Lock worker 3 with localStep 245 , while globalStep is 245

2021-08-18:16:24:05,703 INFO     [param_server.py:441] ====Epoch 246 completes 20 clients with loss 90.6226056734189, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:05,703 INFO     [param_server.py:450] ====Start to sample for epoch 246, global virtualClock: 8695.414100327404, round_duration: 46.65186139097271
2021-08-18:16:24:05,705 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:06,70 INFO     [param_server.py:553] For epoch: 246, median_reward: 400.84658709187187, dev: 801.6931741837437
2021-08-18:16:24:06,631 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.804, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:24:06,632 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3298.0495, eval_time 0.5274, test_loss 2.804, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:24:06,702 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:24:06,706 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8028, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:24:06,707 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3298.121, eval_time 0.6019, test_loss 2.8028, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:24:06,712 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:06,750 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9288, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:24:06,752 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3298.1713, eval_time 0.6474, test_loss 2.9288, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:24:06,776 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:24:06,791 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:06,820 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:24:06,841 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:08,62 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:08,76 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:08,344 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:08,363 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:09,345 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:09,354 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:09,413 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:09,422 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:09,676 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:09,685 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:10,16 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:10,31 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:10,740 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:10,761 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:11,492 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:11,512 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:11,676 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:11,690 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:12,186 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:12,197 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:12,264 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:12,285 INFO     [learner.py:606] ====Pushing takes 0.019817590713500977 s
2021-08-18:16:24:12,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:12,330 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:12,331 INFO     [param_server.py:410] Lock worker 1 with localStep 246 , while globalStep is 245

2021-08-18:16:24:12,529 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:12,544 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:14,805 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:14,815 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:15,232 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:15,243 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:15,902 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:15,916 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:15,979 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:15,998 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:17,40 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:17,54 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:17,108 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:17,121 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:17,675 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:17,705 INFO     [learner.py:606] ====Pushing takes 0.0280916690826416 s
2021-08-18:16:24:17,738 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:17,746 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:17,747 INFO     [param_server.py:410] Lock worker 3 with localStep 246 , while globalStep is 245

2021-08-18:16:24:18,213 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:18,244 INFO     [learner.py:606] ====Pushing takes 0.02800297737121582 s
2021-08-18:16:24:18,275 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:18,283 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:18,283 INFO     [param_server.py:381] ====After aggregation in epoch: 245, virtual_clock: 8742.065961718376, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 2.845205739692405, test len: 3099.0
2021-08-18:16:24:18,286 INFO     [param_server.py:410] Lock worker 2 with localStep 246 , while globalStep is 246

2021-08-18:16:24:18,287 INFO     [param_server.py:441] ====Epoch 247 completes 20 clients with loss 226.66222855726645, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:18,287 INFO     [param_server.py:450] ====Start to sample for epoch 247, global virtualClock: 8742.065961718376, round_duration: 46.65186139097271
2021-08-18:16:24:18,288 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:18,640 INFO     [param_server.py:553] For epoch: 247, median_reward: 374.0916538337519, dev: 748.1833076675038
2021-08-18:16:24:19,225 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9431, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:24:19,227 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3310.6408, eval_time 0.5515, test_loss 2.9431, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:24:19,236 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7643, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:24:19,237 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3310.6546, eval_time 0.564, test_loss 2.7643, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:24:19,295 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:19,304 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:19,309 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:19,313 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9213, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:24:19,317 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3310.7364, eval_time 0.6434, test_loss 2.9213, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:24:19,318 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:19,391 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:19,412 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:20,671 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:20,689 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:20,918 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:20,929 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:22,22 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:22,35 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:22,131 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:22,142 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:22,557 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:22,571 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:23,372 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:23,399 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:24,125 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:24,146 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:24,372 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:24,390 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:24,684 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:24,697 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:24,933 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:24,960 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:25,141 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:25,154 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:25,503 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:25,521 INFO     [learner.py:606] ====Pushing takes 0.017170190811157227 s
2021-08-18:16:24:25,550 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:25,557 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:25,558 INFO     [param_server.py:410] Lock worker 1 with localStep 247 , while globalStep is 246

2021-08-18:16:24:27,410 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:27,420 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:27,706 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:27,718 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:28,395 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:28,417 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:28,616 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:28,630 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:29,660 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:29,672 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:30,36 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:30,46 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:30,354 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:30,380 INFO     [learner.py:606] ====Pushing takes 0.025044679641723633 s
2021-08-18:16:24:30,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:30,420 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:30,421 INFO     [param_server.py:410] Lock worker 3 with localStep 247 , while globalStep is 246

2021-08-18:16:24:30,625 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:30,654 INFO     [learner.py:606] ====Pushing takes 0.027614831924438477 s
2021-08-18:16:24:30,685 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:30,692 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:30,693 INFO     [param_server.py:381] ====After aggregation in epoch: 246, virtual_clock: 8788.717823109348, top_1: : 64.2143 % (1990.0), top_5: : 100.0 % (3099.0), test loss: 2.8762487747051098, test len: 3099.0
2021-08-18:16:24:30,697 INFO     [param_server.py:410] Lock worker 2 with localStep 247 , while globalStep is 247

2021-08-18:16:24:30,697 INFO     [param_server.py:441] ====Epoch 248 completes 20 clients with loss 206.3170499856751, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:30,697 INFO     [param_server.py:450] ====Start to sample for epoch 248, global virtualClock: 8788.717823109348, round_duration: 46.65186139097271
2021-08-18:16:24:30,698 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:31,25 INFO     [param_server.py:553] For epoch: 248, median_reward: 408.4044669383503, dev: 816.8089338767006
2021-08-18:16:24:31,676 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6364, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:24:31,678 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3323.0924, eval_time 0.6146, test_loss 2.6364, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:24:31,683 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1474, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:24:31,684 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3323.1015, eval_time 0.6233, test_loss 4.1474, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:24:31,748 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:31,756 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9969, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:24:31,756 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3323.176, eval_time 0.697, test_loss 2.9969, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:24:31,757 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:31,763 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:31,771 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:31,827 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:31,850 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:33,191 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:33,219 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:33,485 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:33,496 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:34,527 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:34,536 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:34,542 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:34,552 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:34,711 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:34,732 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:35,515 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:35,533 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:36,164 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:36,185 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:36,930 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:36,956 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:36,986 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:37,0 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:37,113 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:37,125 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:37,521 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:37,543 INFO     [learner.py:606] ====Pushing takes 0.01987004280090332 s
2021-08-18:16:24:37,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:37,587 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:37,587 INFO     [param_server.py:410] Lock worker 1 with localStep 248 , while globalStep is 247

2021-08-18:16:24:37,741 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:37,761 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:39,759 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:39,773 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:40,457 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:40,466 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:41,46 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:41,57 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:41,73 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:41,83 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:42,148 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:42,158 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:42,178 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:42,187 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:42,776 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:42,809 INFO     [learner.py:606] ====Pushing takes 0.029262065887451172 s
2021-08-18:16:24:42,846 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:42,855 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:42,856 INFO     [param_server.py:410] Lock worker 3 with localStep 248 , while globalStep is 247

2021-08-18:16:24:43,478 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:43,508 INFO     [learner.py:606] ====Pushing takes 0.02567768096923828 s
2021-08-18:16:24:43,541 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:43,548 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:43,549 INFO     [param_server.py:381] ====After aggregation in epoch: 247, virtual_clock: 8835.36968450032, top_1: : 65.3114 % (2024.0), top_5: : 100.0 % (3099.0), test loss: 3.260250162195277, test len: 3099.0
2021-08-18:16:24:43,551 INFO     [param_server.py:410] Lock worker 2 with localStep 248 , while globalStep is 248

2021-08-18:16:24:43,552 INFO     [param_server.py:441] ====Epoch 249 completes 20 clients with loss 146.79950237276995, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:43,552 INFO     [param_server.py:450] ====Start to sample for epoch 249, global virtualClock: 8835.36968450032, round_duration: 46.65186139097271
2021-08-18:16:24:43,553 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:43,892 INFO     [param_server.py:553] For epoch: 249, median_reward: 406.2031452896851, dev: 812.4062905793702
2021-08-18:16:24:44,495 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0724, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:24:44,496 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3335.9104, eval_time 0.5809, test_loss 3.0724, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:24:44,498 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0622, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:24:44,515 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3335.9319, eval_time 0.5995, test_loss 3.0622, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:24:44,564 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:44,564 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1237, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:24:44,567 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3335.9867, eval_time 0.6518, test_loss 3.1237, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:24:44,571 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:44,587 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:44,596 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:44,663 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:44,683 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:46,70 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:46,90 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:46,203 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:46,212 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:47,169 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:47,179 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:47,570 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:47,579 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:48,118 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:48,146 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:48,927 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:48,954 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:49,683 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:49,711 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:49,742 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:49,757 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:50,270 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:50,280 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:50,429 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:50,431 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:50,439 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:50,451 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:51,28 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:51,51 INFO     [learner.py:606] ====Pushing takes 0.0216829776763916 s
2021-08-18:16:24:51,79 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:51,89 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:51,89 INFO     [param_server.py:410] Lock worker 1 with localStep 249 , while globalStep is 248

2021-08-18:16:24:52,890 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:52,902 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:53,95 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:53,104 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:53,836 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:53,846 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:54,22 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:54,33 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:55,118 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:55,129 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:55,245 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:55,257 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:55,721 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:55,730 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:55,750 INFO     [learner.py:606] ====Pushing takes 0.02797412872314453 s
2021-08-18:16:24:55,772 INFO     [learner.py:606] ====Pushing takes 0.039896249771118164 s
2021-08-18:16:24:55,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:55,807 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:55,808 INFO     [param_server.py:410] Lock worker 3 with localStep 249 , while globalStep is 248

2021-08-18:16:24:55,833 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:55,841 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:55,842 INFO     [param_server.py:381] ====After aggregation in epoch: 248, virtual_clock: 8882.021545891292, top_1: : 63.3753 % (1964.0), top_5: : 100.0 % (3099.0), test loss: 3.086102812378495, test len: 3099.0
2021-08-18:16:24:55,845 INFO     [param_server.py:410] Lock worker 2 with localStep 249 , while globalStep is 249

2021-08-18:16:24:55,845 INFO     [param_server.py:441] ====Epoch 250 completes 20 clients with loss 237.86460471018037, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:55,846 INFO     [param_server.py:450] ====Start to sample for epoch 250, global virtualClock: 8882.021545891292, round_duration: 46.65186139097271
2021-08-18:16:24:55,847 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:56,170 INFO     [param_server.py:553] For epoch: 250, median_reward: 362.9190565312973, dev: 725.8381130625946
2021-08-18:16:24:56,754 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3363, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:24:56,757 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3348.1736, eval_time 0.562, test_loss 3.3363, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:24:56,774 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7942, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:24:56,776 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3348.1901, eval_time 0.5813, test_loss 2.7942, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:24:56,803 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1814, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:24:56,804 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3348.2233, eval_time 0.6113, test_loss 3.1814, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:24:56,848 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:24:56,856 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:56,858 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:24:56,868 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:56,923 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:24:56,936 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:58,317 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:58,324 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:58,330 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:58,351 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:59,399 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:59,412 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:59,496 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:59,510 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:59,774 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:59,801 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:00,654 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:00,681 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:01,358 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:01,385 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:01,911 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:01,931 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:02,66 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:02,87 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:02,181 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:02,199 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:02,669 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:02,680 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:02,707 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:02,728 INFO     [learner.py:606] ====Pushing takes 0.01949906349182129 s
2021-08-18:16:25:02,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:02,770 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:02,770 INFO     [param_server.py:410] Lock worker 1 with localStep 250 , while globalStep is 249

2021-08-18:16:25:04,901 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:04,912 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:05,133 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:05,144 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:05,876 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:05,885 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:06,203 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:06,217 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:06,944 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:06,958 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:07,496 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:07,508 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:07,569 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:07,596 INFO     [learner.py:606] ====Pushing takes 0.025825977325439453 s
2021-08-18:16:25:07,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:07,638 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:07,638 INFO     [param_server.py:410] Lock worker 3 with localStep 250 , while globalStep is 249

2021-08-18:16:25:08,732 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:08,772 INFO     [learner.py:606] ====Pushing takes 0.038094282150268555 s
2021-08-18:16:25:08,814 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:08,826 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:08,827 INFO     [param_server.py:381] ====After aggregation in epoch: 249, virtual_clock: 8928.673407282264, top_1: : 64.6983 % (2005.0), top_5: : 100.0 % (3099.0), test loss: 3.1039514320868036, test len: 3099.0
2021-08-18:16:25:08,837 INFO     [param_server.py:410] Lock worker 2 with localStep 250 , while globalStep is 250

2021-08-18:16:25:08,837 INFO     [param_server.py:441] ====Epoch 251 completes 20 clients with loss 168.71830902299874, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:08,838 INFO     [param_server.py:450] ====Start to sample for epoch 251, global virtualClock: 8928.673407282264, round_duration: 46.65186139097271
2021-08-18:16:25:08,839 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:09,181 INFO     [param_server.py:553] For epoch: 251, median_reward: 373.4899395718815, dev: 746.979879143763
2021-08-18:16:25:09,800 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0419, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:25:09,801 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3361.215, eval_time 0.5857, test_loss 3.0419, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:25:09,803 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3258, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:25:09,804 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3361.2216, eval_time 0.5893, test_loss 3.3258, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:25:09,870 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:25:09,878 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:09,885 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:25:09,885 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2238, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:25:09,886 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3361.3056, eval_time 0.6709, test_loss 3.2238, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:25:09,894 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:09,968 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:25:09,986 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:11,464 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:11,477 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:11,578 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:11,604 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:12,548 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:12,562 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:12,695 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:12,709 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:13,412 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:13,430 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:14,117 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:14,137 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:14,853 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:14,870 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:14,874 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:14,885 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:15,427 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:15,438 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:15,500 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:15,514 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:15,589 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:15,599 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:16,23 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:16,47 INFO     [learner.py:606] ====Pushing takes 0.02193593978881836 s
2021-08-18:16:25:16,83 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:16,90 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:16,91 INFO     [param_server.py:410] Lock worker 1 with localStep 251 , while globalStep is 250

2021-08-18:16:25:18,30 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:18,46 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:18,125 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:18,138 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:18,885 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:18,899 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:19,255 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:19,267 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:20,158 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:20,167 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:20,470 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:20,480 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:20,739 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:20,768 INFO     [learner.py:606] ====Pushing takes 0.027249574661254883 s
2021-08-18:16:25:20,805 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:20,813 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:20,814 INFO     [param_server.py:410] Lock worker 3 with localStep 251 , while globalStep is 250

2021-08-18:16:25:21,4 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:21,34 INFO     [learner.py:606] ====Pushing takes 0.028578519821166992 s
2021-08-18:16:25:21,69 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:21,78 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:21,79 INFO     [param_server.py:381] ====After aggregation in epoch: 250, virtual_clock: 8975.325268673236, top_1: : 62.1813 % (1927.0), top_5: : 100.0 % (3099.0), test loss: 3.197175855989809, test len: 3099.0
2021-08-18:16:25:21,81 INFO     [param_server.py:410] Lock worker 2 with localStep 251 , while globalStep is 251

2021-08-18:16:25:21,82 INFO     [param_server.py:441] ====Epoch 252 completes 20 clients with loss 104.10136264064417, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:21,82 INFO     [param_server.py:450] ====Start to sample for epoch 252, global virtualClock: 8975.325268673236, round_duration: 46.65186139097271
2021-08-18:16:25:21,83 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:21,373 INFO     [param_server.py:553] For epoch: 252, median_reward: 378.0448255040508, dev: 756.0896510081016
2021-08-18:16:25:22,29 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8368, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:25:22,30 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3373.4439, eval_time 0.611, test_loss 2.8368, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:25:22,39 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9562, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:25:22,39 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3373.4566, eval_time 0.6212, test_loss 2.9562, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:25:22,97 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:22,109 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:22,119 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:22,134 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:22,151 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0871, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:25:22,154 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3373.5739, eval_time 0.736, test_loss 3.0871, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:25:22,247 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:22,268 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:23,587 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:23,614 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:23,834 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:23,849 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:25,9 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:25,52 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:25,76 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:25,88 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:25,106 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:25,121 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:25,812 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:25,826 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:26,499 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:26,517 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:27,210 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:27,231 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:27,274 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:27,288 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:27,680 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:27,692 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:27,721 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:27,744 INFO     [learner.py:606] ====Pushing takes 0.020500659942626953 s
2021-08-18:16:25:27,780 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:27,790 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:27,791 INFO     [param_server.py:410] Lock worker 1 with localStep 252 , while globalStep is 251

2021-08-18:16:25:27,972 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:27,991 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:30,352 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:30,362 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:30,598 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:30,607 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:31,191 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:31,200 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:31,572 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:31,582 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:32,596 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:32,606 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:32,672 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:32,683 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:33,223 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:33,252 INFO     [learner.py:606] ====Pushing takes 0.027310848236083984 s
2021-08-18:16:25:33,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:33,299 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:33,300 INFO     [param_server.py:410] Lock worker 3 with localStep 252 , while globalStep is 251

2021-08-18:16:25:33,973 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:34,14 INFO     [learner.py:606] ====Pushing takes 0.03980135917663574 s
2021-08-18:16:25:34,45 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:34,53 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:34,53 INFO     [param_server.py:381] ====After aggregation in epoch: 251, virtual_clock: 9021.977130064208, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 2.9600602167624017, test len: 3099.0
2021-08-18:16:25:34,56 INFO     [param_server.py:410] Lock worker 2 with localStep 252 , while globalStep is 252

2021-08-18:16:25:34,56 INFO     [param_server.py:441] ====Epoch 253 completes 20 clients with loss 130.87999826688335, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:34,57 INFO     [param_server.py:450] ====Start to sample for epoch 253, global virtualClock: 9021.977130064208, round_duration: 46.65186139097271
2021-08-18:16:25:34,58 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:34,403 INFO     [param_server.py:553] For epoch: 253, median_reward: 370.5629459826171, dev: 741.1258919652342
2021-08-18:16:25:35,23 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2871, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:25:35,24 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3386.4414, eval_time 0.5765, test_loss 3.2871, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:25:35,32 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.07, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:25:35,44 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3386.4577, eval_time 0.5951, test_loss 3.07, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:25:35,70 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9885, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:25:35,71 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3386.4909, eval_time 0.6234, test_loss 2.9885, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:25:35,101 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:35,111 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:35,111 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:35,128 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:35,140 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:35,160 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:36,531 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:36,544 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:36,793 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:36,802 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:37,963 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:37,975 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:37,994 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:38,6 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:38,378 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:38,396 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:39,159 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:39,180 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:40,32 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:40,53 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:40,170 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:40,180 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:40,526 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:40,537 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:40,614 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:40,634 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:40,949 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:40,963 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:41,167 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:41,187 INFO     [learner.py:606] ====Pushing takes 0.019025564193725586 s
2021-08-18:16:25:41,215 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:41,222 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:41,223 INFO     [param_server.py:410] Lock worker 1 with localStep 253 , while globalStep is 252

2021-08-18:16:25:43,156 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:43,167 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:43,591 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:43,605 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:44,257 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:44,271 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:44,370 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:44,389 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:45,551 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:45,566 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:45,711 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:45,729 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:46,192 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:46,222 INFO     [learner.py:606] ====Pushing takes 0.02878427505493164 s
2021-08-18:16:25:46,258 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:46,266 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:46,267 INFO     [param_server.py:410] Lock worker 3 with localStep 253 , while globalStep is 252

2021-08-18:16:25:46,337 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:46,365 INFO     [learner.py:606] ====Pushing takes 0.026781320571899414 s
2021-08-18:16:25:46,396 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:46,404 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:46,405 INFO     [param_server.py:381] ====After aggregation in epoch: 252, virtual_clock: 9068.62899145518, top_1: : 63.343 % (1963.0), top_5: : 100.0 % (3099.0), test loss: 3.115193812935441, test len: 3099.0
2021-08-18:16:25:46,407 INFO     [param_server.py:410] Lock worker 2 with localStep 253 , while globalStep is 253

2021-08-18:16:25:46,411 INFO     [param_server.py:441] ====Epoch 254 completes 20 clients with loss 216.20818217328045, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:46,412 INFO     [param_server.py:450] ====Start to sample for epoch 254, global virtualClock: 9068.62899145518, round_duration: 46.65186139097271
2021-08-18:16:25:46,439 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:46,727 INFO     [param_server.py:553] For epoch: 254, median_reward: 391.72549068541355, dev: 783.4509813708271
2021-08-18:16:25:47,249 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8819, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:25:47,250 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3398.6645, eval_time 0.4884, test_loss 2.8819, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:25:47,267 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0346, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:25:47,268 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3398.6849, eval_time 0.5059, test_loss 3.0346, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:25:47,334 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9212, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:25:47,335 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3398.7545, eval_time 0.5734, test_loss 2.9212, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:25:47,339 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:47,344 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:47,347 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:47,356 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:47,407 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:47,425 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:48,678 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:48,696 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:49,103 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:49,117 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:49,860 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:49,869 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:50,245 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:50,256 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:50,257 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:50,266 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:50,566 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:50,581 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:51,327 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:51,341 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:52,71 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:52,92 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:52,484 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:52,500 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:52,742 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:52,763 INFO     [learner.py:606] ====Pushing takes 0.01959824562072754 s
2021-08-18:16:25:52,795 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:52,817 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:52,818 INFO     [param_server.py:410] Lock worker 1 with localStep 254 , while globalStep is 253

2021-08-18:16:25:53,11 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:53,23 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:53,121 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:53,132 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:55,677 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:55,696 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:55,815 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:55,826 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:56,552 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:56,566 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:56,678 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:56,689 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:57,755 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:57,764 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:57,832 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:57,845 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:58,328 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:58,358 INFO     [learner.py:606] ====Pushing takes 0.027412891387939453 s
2021-08-18:16:25:58,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:58,405 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:58,406 INFO     [param_server.py:410] Lock worker 3 with localStep 254 , while globalStep is 253

2021-08-18:16:25:58,994 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:59,23 INFO     [learner.py:606] ====Pushing takes 0.02702045440673828 s
2021-08-18:16:25:59,66 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:59,73 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:59,74 INFO     [param_server.py:381] ====After aggregation in epoch: 253, virtual_clock: 9115.280852846152, top_1: : 65.5373 % (2031.0), top_5: : 100.0 % (3099.0), test loss: 2.945885552300347, test len: 3099.0
2021-08-18:16:25:59,76 INFO     [param_server.py:410] Lock worker 2 with localStep 254 , while globalStep is 254

2021-08-18:16:25:59,77 INFO     [param_server.py:441] ====Epoch 255 completes 20 clients with loss 182.9115312856169, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:59,77 INFO     [param_server.py:450] ====Start to sample for epoch 255, global virtualClock: 9115.280852846152, round_duration: 46.65186139097271
2021-08-18:16:25:59,78 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:59,394 INFO     [param_server.py:553] For epoch: 255, median_reward: 397.8440918733015, dev: 795.688183746603
2021-08-18:16:26:00,70 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1924, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:26:00,72 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3411.4887, eval_time 0.653, test_loss 4.1924, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:26:00,73 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6666, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:26:00,73 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3411.4877, eval_time 0.6534, test_loss 2.6666, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:26:00,106 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9648, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:26:00,110 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3411.5298, eval_time 0.6916, test_loss 2.9648, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:26:00,142 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:26:00,151 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:26:00,151 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:00,160 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:00,181 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:26:00,196 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:01,542 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:01,557 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:01,701 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:01,711 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:02,797 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:02,805 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:02,809 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:02,816 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:03,100 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:03,109 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:03,970 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:03,998 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:04,790 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:04,817 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:05,57 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:05,66 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:05,527 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:05,529 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:05,548 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:05,561 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:05,743 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:05,753 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:06,135 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:06,156 INFO     [learner.py:606] ====Pushing takes 0.019103527069091797 s
2021-08-18:16:26:06,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:06,197 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:06,198 INFO     [param_server.py:410] Lock worker 1 with localStep 255 , while globalStep is 254

2021-08-18:16:26:08,263 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:08,275 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:08,638 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:08,652 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:09,435 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:09,450 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:09,493 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:09,505 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:10,792 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:10,806 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:10,925 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:10,939 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:11,341 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:11,370 INFO     [learner.py:606] ====Pushing takes 0.02764606475830078 s
2021-08-18:16:26:11,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:11,420 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:11,421 INFO     [param_server.py:410] Lock worker 2 with localStep 255 , while globalStep is 254

2021-08-18:16:26:11,569 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:11,598 INFO     [learner.py:606] ====Pushing takes 0.027721643447875977 s
2021-08-18:16:26:11,630 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:11,637 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:11,638 INFO     [param_server.py:381] ====After aggregation in epoch: 254, virtual_clock: 9161.932714237124, top_1: : 63.1817 % (1958.0), top_5: : 100.0 % (3099.0), test loss: 3.2745664384629993, test len: 3099.0
2021-08-18:16:26:11,641 INFO     [param_server.py:410] Lock worker 3 with localStep 255 , while globalStep is 255

2021-08-18:16:26:11,641 INFO     [param_server.py:441] ====Epoch 256 completes 20 clients with loss 158.5615325355931, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:11,642 INFO     [param_server.py:450] ====Start to sample for epoch 256, global virtualClock: 9161.932714237124, round_duration: 46.65186139097271
2021-08-18:16:26:11,643 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:11,942 INFO     [param_server.py:553] For epoch: 256, median_reward: 365.2722926994402, dev: 730.5445853988804
2021-08-18:16:26:12,544 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6785, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:26:12,546 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3423.9628, eval_time 0.5794, test_loss 2.6785, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:26:12,555 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5327, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:26:12,556 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3423.9706, eval_time 0.5879, test_loss 2.5327, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:26:12,576 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.177, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:26:12,577 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3423.9965, eval_time 0.6107, test_loss 3.177, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:26:12,625 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:12,635 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:12,636 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:12,650 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:12,656 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:12,664 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:13,919 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:13,933 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:14,274 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:14,285 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:15,189 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:15,203 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:15,431 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:15,442 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:15,599 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:15,610 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:15,959 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:15,973 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:16,610 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:16,623 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:17,190 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:17,217 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:17,728 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:17,737 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:17,772 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:17,792 INFO     [learner.py:606] ====Pushing takes 0.01942610740661621 s
2021-08-18:16:26:17,830 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:17,838 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:17,841 INFO     [param_server.py:410] Lock worker 1 with localStep 256 , while globalStep is 255

2021-08-18:16:26:18,459 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:18,470 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:18,472 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:18,487 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:21,82 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:21,117 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:21,125 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:21,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:21,785 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:21,805 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:22,131 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:22,142 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:23,127 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:23,136 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:23,410 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:23,420 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:23,779 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:23,808 INFO     [learner.py:606] ====Pushing takes 0.027910709381103516 s
2021-08-18:16:26:23,846 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:23,855 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:23,855 INFO     [param_server.py:410] Lock worker 3 with localStep 256 , while globalStep is 255

2021-08-18:16:26:24,610 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:24,637 INFO     [learner.py:606] ====Pushing takes 0.026122570037841797 s
2021-08-18:16:26:24,674 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:24,682 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:24,683 INFO     [param_server.py:381] ====After aggregation in epoch: 255, virtual_clock: 9208.584575628096, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 2.79605621430609, test len: 3099.0
2021-08-18:16:26:24,686 INFO     [param_server.py:410] Lock worker 2 with localStep 256 , while globalStep is 256

2021-08-18:16:26:24,686 INFO     [param_server.py:441] ====Epoch 257 completes 20 clients with loss 319.7306107337687, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:24,687 INFO     [param_server.py:450] ====Start to sample for epoch 257, global virtualClock: 9208.584575628096, round_duration: 46.65186139097271
2021-08-18:16:26:24,688 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:25,46 INFO     [param_server.py:553] For epoch: 257, median_reward: 400.2956072066621, dev: 800.5912144133242
2021-08-18:16:26:25,702 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7334, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:26:25,703 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3437.1176, eval_time 0.6342, test_loss 2.7334, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:26:25,703 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9843, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:26:25,705 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3437.1218, eval_time 0.6355, test_loss 2.9843, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:26:25,732 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8696, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:26:25,735 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3437.1544, eval_time 0.6656, test_loss 2.8696, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:26:25,772 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:25,780 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:25,798 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:25,805 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:25,806 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:25,821 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:27,183 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:27,198 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:27,551 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:27,588 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:28,502 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:28,511 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:28,976 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:28,977 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:28,990 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:28,991 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:29,683 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:29,703 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:30,454 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:30,474 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:30,679 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:30,690 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:31,135 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:31,162 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:31,267 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:31,276 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:31,749 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:31,760 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:31,818 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:31,837 INFO     [learner.py:606] ====Pushing takes 0.017382383346557617 s
2021-08-18:16:26:31,868 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:31,878 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:31,879 INFO     [param_server.py:410] Lock worker 1 with localStep 257 , while globalStep is 256

2021-08-18:16:26:34,57 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:34,75 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:34,425 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:34,446 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:34,693 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:34,703 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:35,653 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:35,666 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:36,21 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:36,41 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:36,724 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:36,754 INFO     [learner.py:606] ====Pushing takes 0.02861809730529785 s
2021-08-18:16:26:36,792 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:36,799 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:36,800 INFO     [param_server.py:410] Lock worker 3 with localStep 257 , while globalStep is 256

2021-08-18:16:26:36,975 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:36,985 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:37,538 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:37,566 INFO     [learner.py:606] ====Pushing takes 0.026768207550048828 s
2021-08-18:16:26:37,597 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:37,605 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:37,606 INFO     [param_server.py:381] ====After aggregation in epoch: 256, virtual_clock: 9255.236437019068, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 2.862420316095706, test len: 3099.0
2021-08-18:16:26:37,608 INFO     [param_server.py:410] Lock worker 2 with localStep 257 , while globalStep is 257

2021-08-18:16:26:37,609 INFO     [param_server.py:441] ====Epoch 258 completes 20 clients with loss 158.3214525769976, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:37,609 INFO     [param_server.py:450] ====Start to sample for epoch 258, global virtualClock: 9255.236437019068, round_duration: 46.65186139097271
2021-08-18:16:26:37,610 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:37,963 INFO     [param_server.py:553] For epoch: 258, median_reward: 378.5010153132586, dev: 757.0020306265172
2021-08-18:16:26:38,611 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6934, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:26:38,612 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3450.0264, eval_time 0.6263, test_loss 2.6934, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:26:38,652 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0211, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:26:38,652 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3450.0696, eval_time 0.6665, test_loss 3.0211, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:26:38,688 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1265, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:26:38,689 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3450.1084, eval_time 0.7028, test_loss 3.1265, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:26:38,693 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:38,702 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:38,721 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:38,735 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:38,745 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:38,766 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:39,972 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:39,992 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:40,455 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:40,469 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:41,100 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:41,110 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:41,574 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:41,583 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:41,662 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:41,674 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:41,717 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:41,731 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:42,406 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:42,420 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:42,997 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:43,16 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:43,559 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:43,581 INFO     [learner.py:606] ====Pushing takes 0.020505189895629883 s
2021-08-18:16:26:43,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:43,617 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:43,618 INFO     [param_server.py:410] Lock worker 1 with localStep 258 , while globalStep is 257

2021-08-18:16:26:43,801 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:43,810 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:44,268 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:44,279 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:44,434 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:44,443 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:47,53 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:47,63 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:47,171 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:47,182 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:47,764 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:47,774 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:48,196 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:48,208 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:48,787 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:48,808 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:49,298 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:49,310 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:49,406 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:49,433 INFO     [learner.py:606] ====Pushing takes 0.025107622146606445 s
2021-08-18:16:26:49,463 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:49,473 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:49,474 INFO     [param_server.py:410] Lock worker 3 with localStep 258 , while globalStep is 257

2021-08-18:16:26:50,459 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:50,486 INFO     [learner.py:606] ====Pushing takes 0.025053024291992188 s
2021-08-18:16:26:50,521 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:50,529 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:50,553 INFO     [param_server.py:381] ====After aggregation in epoch: 257, virtual_clock: 9301.88829841004, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 2.9470065346470586, test len: 3099.0
2021-08-18:16:26:50,556 INFO     [param_server.py:410] Lock worker 2 with localStep 258 , while globalStep is 258

2021-08-18:16:26:50,556 INFO     [param_server.py:441] ====Epoch 259 completes 20 clients with loss 294.2884381671001, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:50,557 INFO     [param_server.py:450] ====Start to sample for epoch 259, global virtualClock: 9301.88829841004, round_duration: 46.65186139097271
2021-08-18:16:26:50,557 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:50,931 INFO     [param_server.py:553] For epoch: 259, median_reward: 419.0320503655213, dev: 838.0641007310426
2021-08-18:16:26:51,590 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8845, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:26:51,590 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3463.0076, eval_time 0.6257, test_loss 2.8845, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:26:51,593 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6874, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:26:51,594 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3463.0086, eval_time 0.6272, test_loss 2.6874, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:26:51,618 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9773, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:26:51,619 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3463.0384, eval_time 0.6539, test_loss 2.9773, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:26:51,663 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:26:51,664 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:26:51,672 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:51,673 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:51,686 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:26:51,700 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:52,807 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:52,818 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:53,311 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:53,325 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:54,322 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:54,334 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:54,537 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:54,542 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:54,551 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:54,552 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:55,176 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:55,190 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:55,990 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:56,11 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:56,566 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:56,577 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:56,668 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:56,689 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:57,178 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:57,189 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:57,285 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:57,292 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:57,303 INFO     [learner.py:606] ====Pushing takes 0.0162355899810791 s
2021-08-18:16:26:57,306 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:57,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:57,340 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:57,341 INFO     [param_server.py:410] Lock worker 1 with localStep 259 , while globalStep is 258

2021-08-18:16:26:59,858 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:59,870 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:00,139 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:00,148 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:00,827 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:00,841 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:01,155 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:01,169 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:01,996 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:02,23 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:02,649 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:02,660 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:02,663 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:02,694 INFO     [learner.py:606] ====Pushing takes 0.029911518096923828 s
2021-08-18:16:27:02,737 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:02,746 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:02,747 INFO     [param_server.py:410] Lock worker 3 with localStep 259 , while globalStep is 258

2021-08-18:16:27:03,211 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:03,238 INFO     [learner.py:606] ====Pushing takes 0.025910139083862305 s
2021-08-18:16:27:03,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:03,279 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:03,279 INFO     [param_server.py:381] ====After aggregation in epoch: 258, virtual_clock: 9348.540159801012, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 2.8497302267286515, test len: 3099.0
2021-08-18:16:27:03,281 INFO     [param_server.py:410] Lock worker 2 with localStep 259 , while globalStep is 259

2021-08-18:16:27:03,282 INFO     [param_server.py:441] ====Epoch 260 completes 20 clients with loss 135.05360866660754, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:03,282 INFO     [param_server.py:450] ====Start to sample for epoch 260, global virtualClock: 9348.540159801012, round_duration: 46.65186139097271
2021-08-18:16:27:03,285 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:03,628 INFO     [param_server.py:553] For epoch: 260, median_reward: 380.3965454491272, dev: 760.7930908982544
2021-08-18:16:27:04,315 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2934, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:27:04,316 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3475.7299, eval_time 0.6626, test_loss 3.2934, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:27:04,321 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0436, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:27:04,322 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3475.7391, eval_time 0.6693, test_loss 3.0436, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:27:04,360 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7139, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:27:04,363 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3475.7829, eval_time 0.7127, test_loss 3.7139, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:27:04,388 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:27:04,389 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:27:04,396 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:04,398 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:04,436 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:27:04,448 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:05,546 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:05,560 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:05,968 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:05,978 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:06,849 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:06,864 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:07,47 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:07,56 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:07,84 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:07,93 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:07,647 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:07,661 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:08,284 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:08,303 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:09,62 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:09,83 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:09,226 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:09,235 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:09,741 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:09,761 INFO     [learner.py:606] ====Pushing takes 0.019388914108276367 s
2021-08-18:16:27:09,790 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:09,801 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:09,801 INFO     [param_server.py:410] Lock worker 1 with localStep 260 , while globalStep is 259

2021-08-18:16:27:09,833 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:09,846 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:09,899 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:09,911 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:12,581 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:12,590 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:12,718 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:12,737 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:13,210 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:13,221 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:14,53 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:14,64 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:14,488 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:14,509 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:15,266 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:15,293 INFO     [learner.py:606] ====Pushing takes 0.02514171600341797 s
2021-08-18:16:27:15,298 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:15,308 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:15,323 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:15,331 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:15,332 INFO     [param_server.py:410] Lock worker 3 with localStep 260 , while globalStep is 259

2021-08-18:16:27:16,605 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:16,631 INFO     [learner.py:606] ====Pushing takes 0.024427413940429688 s
2021-08-18:16:27:16,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:16,670 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:16,671 INFO     [param_server.py:381] ====After aggregation in epoch: 259, virtual_clock: 9395.192021191984, top_1: : 66.2149 % (2052.0), top_5: : 100.0 % (3099.0), test loss: 3.3502979278564453, test len: 3099.0
2021-08-18:16:27:16,673 INFO     [param_server.py:410] Lock worker 2 with localStep 260 , while globalStep is 260

2021-08-18:16:27:16,674 INFO     [param_server.py:441] ====Epoch 261 completes 20 clients with loss 280.9269066343414, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:16,674 INFO     [param_server.py:450] ====Start to sample for epoch 261, global virtualClock: 9395.192021191984, round_duration: 46.65186139097271
2021-08-18:16:27:16,675 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:17,19 INFO     [param_server.py:541] Handle Wight 0.03570866584777832 | Send 0.34460949897766113
2021-08-18:16:27:17,20 INFO     [param_server.py:553] For epoch: 261, median_reward: 405.99372742367837, dev: 811.9874548473567
2021-08-18:16:27:17,655 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0652, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:27:17,657 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3489.0737, eval_time 0.6148, test_loss 3.0652, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:27:17,684 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9964, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:27:17,685 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3489.0996, eval_time 0.6437, test_loss 2.9964, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:27:17,699 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3929, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:27:17,700 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3489.1201, eval_time 0.6587, test_loss 3.3929, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:27:17,733 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:17,742 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:17,753 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:17,768 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:17,771 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:17,790 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:19,61 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:19,75 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:19,367 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:19,386 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:20,381 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:20,396 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:20,655 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:20,667 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:20,891 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:20,906 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:21,638 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:21,659 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:22,395 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:22,415 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:22,702 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:22,712 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:23,67 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:23,94 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:23,294 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:23,312 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:23,427 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:23,438 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:23,842 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:23,863 INFO     [learner.py:606] ====Pushing takes 0.01947188377380371 s
2021-08-18:16:27:23,900 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:23,908 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:23,909 INFO     [param_server.py:410] Lock worker 1 with localStep 261 , while globalStep is 260

2021-08-18:16:27:25,916 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:25,927 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:26,148 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:26,158 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:26,735 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:26,749 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:27,14 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:27,26 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:28,30 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:28,48 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:28,460 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:28,476 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:28,693 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:28,721 INFO     [learner.py:606] ====Pushing takes 0.027159690856933594 s
2021-08-18:16:27:28,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:28,765 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:28,765 INFO     [param_server.py:410] Lock worker 3 with localStep 261 , while globalStep is 260

2021-08-18:16:27:29,23 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:29,51 INFO     [learner.py:606] ====Pushing takes 0.026358604431152344 s
2021-08-18:16:27:29,81 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:29,89 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:29,90 INFO     [param_server.py:381] ====After aggregation in epoch: 260, virtual_clock: 9441.843882582956, top_1: : 63.698 % (1974.0), top_5: : 100.0 % (3099.0), test loss: 3.1514908914212825, test len: 3099.0
2021-08-18:16:27:29,93 INFO     [param_server.py:410] Lock worker 2 with localStep 261 , while globalStep is 261

2021-08-18:16:27:29,94 INFO     [param_server.py:441] ====Epoch 262 completes 20 clients with loss 228.4315302681468, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:29,94 INFO     [param_server.py:450] ====Start to sample for epoch 262, global virtualClock: 9441.843882582956, round_duration: 46.65186139097271
2021-08-18:16:27:29,95 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:29,427 INFO     [param_server.py:553] For epoch: 262, median_reward: 368.1794865512815, dev: 736.358973102563
2021-08-18:16:27:30,141 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7154, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:27:30,142 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3501.5564, eval_time 0.6688, test_loss 2.7154, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:27:30,157 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.227, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:27:30,158 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3501.5747, eval_time 0.6863, test_loss 3.227, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:27:30,199 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1831, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:27:30,200 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3501.6198, eval_time 0.7289, test_loss 3.1831, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:27:30,211 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:30,224 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:30,225 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:30,239 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:30,271 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:30,290 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:31,536 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:31,550 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:31,904 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:31,915 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:32,802 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:32,816 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:32,898 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:32,907 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:33,131 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:33,145 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:33,463 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:33,477 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:34,164 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:34,178 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:34,827 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:34,840 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:35,359 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:35,370 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:35,531 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:35,551 INFO     [learner.py:606] ====Pushing takes 0.018324613571166992 s
2021-08-18:16:27:35,588 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:35,596 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:35,597 INFO     [param_server.py:410] Lock worker 1 with localStep 262 , while globalStep is 261

2021-08-18:16:27:36,35 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:36,43 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:36,47 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:36,53 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:38,606 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:38,619 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:38,656 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:38,666 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:39,279 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:39,288 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:39,701 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:39,713 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:40,572 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:40,586 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:40,921 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:40,939 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:41,317 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:41,345 INFO     [learner.py:606] ====Pushing takes 0.026946544647216797 s
2021-08-18:16:27:41,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:41,385 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:41,386 INFO     [param_server.py:410] Lock worker 3 with localStep 262 , while globalStep is 261

2021-08-18:16:27:42,200 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:42,230 INFO     [learner.py:606] ====Pushing takes 0.028046369552612305 s
2021-08-18:16:27:42,261 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:42,268 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:42,269 INFO     [param_server.py:381] ====After aggregation in epoch: 261, virtual_clock: 9488.495743973928, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.041867379788999, test len: 3099.0
2021-08-18:16:27:42,271 INFO     [param_server.py:410] Lock worker 2 with localStep 262 , while globalStep is 262

2021-08-18:16:27:42,271 INFO     [param_server.py:441] ====Epoch 263 completes 20 clients with loss 315.957132867503, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:42,272 INFO     [param_server.py:450] ====Start to sample for epoch 263, global virtualClock: 9488.495743973928, round_duration: 46.65186139097271
2021-08-18:16:27:42,273 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:42,616 INFO     [param_server.py:553] For epoch: 263, median_reward: 439.3172649999169, dev: 878.6345299998338
2021-08-18:16:27:43,309 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9696, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:27:43,312 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3514.729, eval_time 0.6612, test_loss 2.9696, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:27:43,381 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:43,382 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2077, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:27:43,385 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3514.7995, eval_time 0.7337, test_loss 3.2077, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:27:43,395 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:43,422 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3374, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:27:43,424 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3514.8441, eval_time 0.7738, test_loss 3.3374, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:27:43,452 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:43,475 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:43,516 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:43,544 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:44,743 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:44,757 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:45,86 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:45,104 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:46,73 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:46,84 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:46,426 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:46,437 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:46,462 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:46,474 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:47,90 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:47,100 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:47,776 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:47,789 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:48,412 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:48,422 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:48,540 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:48,558 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:49,121 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:49,131 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:49,142 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:49,151 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:49,163 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:49,163 INFO     [learner.py:606] ====Pushing takes 0.01979994773864746 s
2021-08-18:16:27:49,197 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:49,212 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:49,213 INFO     [param_server.py:410] Lock worker 1 with localStep 263 , while globalStep is 262

2021-08-18:16:27:51,627 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:51,637 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:51,718 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:51,737 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:52,343 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:52,352 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:52,850 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:52,869 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:53,439 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:53,453 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:54,60 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:54,79 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:54,90 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:54,121 INFO     [learner.py:606] ====Pushing takes 0.02716350555419922 s
2021-08-18:16:27:54,157 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:54,165 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:54,166 INFO     [param_server.py:410] Lock worker 3 with localStep 263 , while globalStep is 262

2021-08-18:16:27:54,735 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:54,764 INFO     [learner.py:606] ====Pushing takes 0.027770280838012695 s
2021-08-18:16:27:54,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:54,806 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:54,807 INFO     [param_server.py:381] ====After aggregation in epoch: 262, virtual_clock: 9535.1476053649, top_1: : 64.182 % (1989.0), top_5: : 100.0 % (3099.0), test loss: 3.1715735108764083, test len: 3099.0
2021-08-18:16:27:54,809 INFO     [param_server.py:410] Lock worker 2 with localStep 263 , while globalStep is 263

2021-08-18:16:27:54,810 INFO     [param_server.py:441] ====Epoch 264 completes 20 clients with loss 162.82807553737516, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:54,810 INFO     [param_server.py:450] ====Start to sample for epoch 264, global virtualClock: 9535.1476053649, round_duration: 46.65186139097271
2021-08-18:16:27:54,811 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:55,141 INFO     [param_server.py:553] For epoch: 264, median_reward: 393.6792012347253, dev: 787.3584024694507
2021-08-18:16:27:55,757 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1664, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:27:55,758 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3527.1723, eval_time 0.5701, test_loss 3.1664, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:27:55,774 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3062, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:27:55,775 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3527.1921, eval_time 0.5875, test_loss 3.3062, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:27:55,825 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:27:55,842 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:55,851 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:27:55,866 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:55,848 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.064, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:27:55,867 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3527.287, eval_time 0.682, test_loss 5.064, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:27:55,948 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:27:55,969 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:57,165 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:57,178 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:57,534 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:57,553 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:58,225 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:58,236 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:58,616 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:58,629 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:58,711 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:58,724 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:58,751 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:58,760 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:59,261 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:59,271 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:59,775 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:59,785 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:00,372 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:00,392 INFO     [learner.py:606] ====Pushing takes 0.019036054611206055 s
2021-08-18:16:28:00,425 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:00,433 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:00,434 INFO     [param_server.py:410] Lock worker 1 with localStep 264 , while globalStep is 263

2021-08-18:16:28:00,807 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:00,817 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:01,219 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:01,230 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:01,512 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:01,521 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:04,116 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:04,126 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:04,128 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:04,144 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:04,825 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:04,835 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:05,243 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:05,254 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:06,45 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:06,54 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:06,519 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:06,537 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:06,669 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:06,697 INFO     [learner.py:606] ====Pushing takes 0.02656722068786621 s
2021-08-18:16:28:06,729 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:06,738 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:06,739 INFO     [param_server.py:410] Lock worker 3 with localStep 264 , while globalStep is 263

2021-08-18:16:28:07,792 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:07,830 INFO     [learner.py:606] ====Pushing takes 0.03711080551147461 s
2021-08-18:16:28:07,864 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:07,874 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:07,874 INFO     [param_server.py:381] ====After aggregation in epoch: 263, virtual_clock: 9581.799466755872, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 3.845524858545374, test len: 3099.0
2021-08-18:16:28:07,876 INFO     [param_server.py:410] Lock worker 2 with localStep 264 , while globalStep is 264

2021-08-18:16:28:07,877 INFO     [param_server.py:441] ====Epoch 265 completes 20 clients with loss 381.7752615400558, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:07,877 INFO     [param_server.py:450] ====Start to sample for epoch 265, global virtualClock: 9581.799466755872, round_duration: 46.65186139097271
2021-08-18:16:28:07,878 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:08,226 INFO     [param_server.py:553] For epoch: 265, median_reward: 419.99223410579674, dev: 839.9844682115935
2021-08-18:16:28:08,863 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.6134, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:28:08,865 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3540.2817, eval_time 0.6054, test_loss 4.6134, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:28:08,900 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7896, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:28:08,901 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3540.3154, eval_time 0.642, test_loss 2.7896, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:28:08,938 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9804, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:28:08,939 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3540.3585, eval_time 0.6796, test_loss 2.9804, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:28:08,959 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:28:08,974 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:08,980 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:28:08,993 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:09,11 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:28:09,27 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:10,259 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:10,274 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:10,573 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:10,582 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:11,617 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:11,626 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:11,644 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:11,656 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:11,836 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:11,847 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:12,578 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:12,592 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:13,259 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:13,277 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:13,919 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:13,939 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:13,956 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:13,968 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:14,439 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:14,447 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:14,467 INFO     [learner.py:606] ====Pushing takes 0.018897056579589844 s
2021-08-18:16:28:14,470 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:14,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:14,508 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:14,508 INFO     [param_server.py:410] Lock worker 1 with localStep 265 , while globalStep is 264

2021-08-18:16:28:14,528 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:14,539 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:17,125 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:17,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:17,215 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:17,235 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:17,819 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:17,828 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:18,517 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:18,528 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:19,12 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:19,22 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:19,577 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:19,588 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:19,594 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:19,624 INFO     [learner.py:606] ====Pushing takes 0.0278170108795166 s
2021-08-18:16:28:19,664 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:19,673 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:19,674 INFO     [param_server.py:410] Lock worker 3 with localStep 265 , while globalStep is 264

2021-08-18:16:28:20,108 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:20,140 INFO     [learner.py:606] ====Pushing takes 0.03093409538269043 s
2021-08-18:16:28:20,172 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:20,180 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:20,180 INFO     [param_server.py:381] ====After aggregation in epoch: 264, virtual_clock: 9628.451328146844, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.461153498402348, test len: 3099.0
2021-08-18:16:28:20,183 INFO     [param_server.py:410] Lock worker 2 with localStep 265 , while globalStep is 265

2021-08-18:16:28:20,183 INFO     [param_server.py:441] ====Epoch 266 completes 20 clients with loss 143.43710568350218, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:20,184 INFO     [param_server.py:450] ====Start to sample for epoch 266, global virtualClock: 9628.451328146844, round_duration: 46.65186139097271
2021-08-18:16:28:20,184 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:20,481 INFO     [param_server.py:553] For epoch: 266, median_reward: 429.59589209585124, dev: 859.1917841917025
2021-08-18:16:28:21,82 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.738, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:28:21,83 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3552.5004, eval_time 0.5556, test_loss 2.738, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:28:21,130 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4806, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:28:21,131 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3552.5449, eval_time 0.6027, test_loss 2.4806, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:28:21,161 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8376, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:28:21,162 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3552.5814, eval_time 0.6365, test_loss 2.8376, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:28:21,176 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:21,186 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:21,200 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:21,216 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:21,232 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:21,251 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:22,620 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:22,634 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:22,874 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:22,892 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:23,874 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:23,888 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:23,993 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:24,6 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:24,67 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:24,77 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:24,631 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:24,645 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:25,410 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:25,441 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:26,78 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:26,98 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:26,389 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:26,401 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:26,689 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:26,709 INFO     [learner.py:606] ====Pushing takes 0.018331289291381836 s
2021-08-18:16:28:26,736 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:26,745 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:26,746 INFO     [param_server.py:410] Lock worker 1 with localStep 266 , while globalStep is 265

2021-08-18:16:28:27,49 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:27,61 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:27,131 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:27,149 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:29,714 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:29,726 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:29,876 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:29,887 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:30,390 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:30,400 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:30,925 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:30,936 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:31,404 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:31,413 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:32,17 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:32,49 INFO     [learner.py:606] ====Pushing takes 0.030153274536132812 s
2021-08-18:16:28:32,85 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:32,94 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:32,95 INFO     [param_server.py:410] Lock worker 3 with localStep 266 , while globalStep is 265

2021-08-18:16:28:32,291 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:32,302 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:33,553 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:33,592 INFO     [learner.py:606] ====Pushing takes 0.03469038009643555 s
2021-08-18:16:28:33,621 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:33,628 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:33,629 INFO     [param_server.py:381] ====After aggregation in epoch: 265, virtual_clock: 9675.103189537816, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 2.6854242233352523, test len: 3099.0
2021-08-18:16:28:33,632 INFO     [param_server.py:410] Lock worker 2 with localStep 266 , while globalStep is 266

2021-08-18:16:28:33,632 INFO     [param_server.py:441] ====Epoch 267 completes 20 clients with loss 397.4407903972617, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:33,633 INFO     [param_server.py:450] ====Start to sample for epoch 267, global virtualClock: 9675.103189537816, round_duration: 46.65186139097271
2021-08-18:16:28:33,634 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:33,965 INFO     [param_server.py:553] For epoch: 267, median_reward: 399.30494001204113, dev: 798.6098800240823
2021-08-18:16:28:34,598 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9028, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:28:34,599 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3566.0161, eval_time 0.5997, test_loss 2.9028, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:28:34,637 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6295, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:28:34,641 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3566.0551, eval_time 0.6402, test_loss 2.6295, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:28:34,670 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2007, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:28:34,673 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:34,673 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3566.0926, eval_time 0.6745, test_loss 3.2007, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:28:34,687 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:34,709 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:34,723 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:34,729 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:34,747 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:35,992 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:36,13 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:36,316 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:36,331 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:37,368 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:37,382 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:37,628 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:37,649 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:37,829 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:37,847 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:38,474 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:38,488 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:39,166 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:39,180 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:39,695 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:39,705 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:39,943 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:39,963 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:40,411 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:40,466 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:40,490 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:40,501 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:40,567 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:40,588 INFO     [learner.py:606] ====Pushing takes 0.01975727081298828 s
2021-08-18:16:28:40,621 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:40,628 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:40,629 INFO     [param_server.py:410] Lock worker 1 with localStep 267 , while globalStep is 266

2021-08-18:16:28:43,3 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:43,13 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:43,40 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:43,52 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:43,660 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:43,669 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:44,156 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:44,168 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:44,809 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:44,820 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:45,507 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:45,520 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:45,532 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:45,534 INFO     [learner.py:606] ====Pushing takes 0.025531768798828125 s
2021-08-18:16:28:45,565 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:45,579 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:45,580 INFO     [param_server.py:410] Lock worker 3 with localStep 267 , while globalStep is 266

2021-08-18:16:28:46,68 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:46,99 INFO     [learner.py:606] ====Pushing takes 0.030088424682617188 s
2021-08-18:16:28:46,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:46,138 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:46,139 INFO     [param_server.py:381] ====After aggregation in epoch: 266, virtual_clock: 9721.755050928788, top_1: : 63.0849 % (1955.0), top_5: : 100.0 % (3099.0), test loss: 2.911016790955155, test len: 3099.0
2021-08-18:16:28:46,141 INFO     [param_server.py:410] Lock worker 2 with localStep 267 , while globalStep is 267

2021-08-18:16:28:46,141 INFO     [param_server.py:441] ====Epoch 268 completes 20 clients with loss 308.3073664763156, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:46,142 INFO     [param_server.py:450] ====Start to sample for epoch 268, global virtualClock: 9721.755050928788, round_duration: 46.65186139097271
2021-08-18:16:28:46,142 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:46,454 INFO     [param_server.py:553] For epoch: 268, median_reward: 443.9043362030849, dev: 887.8086724061698
2021-08-18:16:28:47,110 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0377, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:28:47,112 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3578.5288, eval_time 0.61, test_loss 3.0377, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:28:47,117 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6883, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:28:47,119 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3578.5329, eval_time 0.617, test_loss 2.6883, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:28:47,187 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2551, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:28:47,187 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:47,188 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3578.6075, eval_time 0.6888, test_loss 3.2551, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:28:47,201 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:47,208 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:47,220 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:47,258 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:47,288 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:48,817 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:48,838 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:48,933 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:48,951 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:49,922 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:49,936 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:50,143 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:50,154 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:50,178 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:50,187 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:50,701 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:50,711 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:51,227 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:51,238 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:51,766 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:51,775 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:52,231 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:52,241 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:52,250 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:52,269 INFO     [learner.py:606] ====Pushing takes 0.017937898635864258 s
2021-08-18:16:28:52,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:52,306 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:52,306 INFO     [param_server.py:410] Lock worker 1 with localStep 268 , while globalStep is 267

2021-08-18:16:28:52,697 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:52,709 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:52,922 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:52,936 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:55,422 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:55,433 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:55,490 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:55,503 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:56,162 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:56,172 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:56,571 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:56,584 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:57,369 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:57,379 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:57,957 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:57,975 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:58,1 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:58,30 INFO     [learner.py:606] ====Pushing takes 0.027146577835083008 s
2021-08-18:16:28:58,66 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:58,74 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:58,75 INFO     [param_server.py:410] Lock worker 3 with localStep 268 , while globalStep is 267

2021-08-18:16:28:59,315 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:59,344 INFO     [learner.py:606] ====Pushing takes 0.027608156204223633 s
2021-08-18:16:28:59,373 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:59,381 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:59,382 INFO     [param_server.py:381] ====After aggregation in epoch: 267, virtual_clock: 9768.40691231976, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 2.9937260592425314, test len: 3099.0
2021-08-18:16:28:59,384 INFO     [param_server.py:410] Lock worker 2 with localStep 268 , while globalStep is 268

2021-08-18:16:28:59,384 INFO     [param_server.py:441] ====Epoch 269 completes 20 clients with loss 138.2925080129943, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:59,385 INFO     [param_server.py:450] ====Start to sample for epoch 269, global virtualClock: 9768.40691231976, round_duration: 46.65186139097271
2021-08-18:16:28:59,385 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:59,644 INFO     [param_server.py:553] For epoch: 269, median_reward: 395.15500492557453, dev: 790.3100098511491
2021-08-18:16:29:00,279 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8738, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:29:00,280 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3591.6944, eval_time 0.5829, test_loss 2.8738, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:29:00,306 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.524, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:29:00,306 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3591.7236, eval_time 0.6091, test_loss 3.524, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:29:00,345 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:29:00,348 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8895, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:29:00,350 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3591.7702, eval_time 0.6532, test_loss 3.8895, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:29:00,355 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:00,374 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:29:00,389 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:00,405 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:29:00,426 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:01,664 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:01,677 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:02,98 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:02,116 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:03,139 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:03,148 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:03,342 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:03,351 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:03,390 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:03,399 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:04,11 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:04,22 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:04,639 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:04,648 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:05,291 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:05,307 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:05,520 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:05,529 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:05,958 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:05,978 INFO     [learner.py:606] ====Pushing takes 0.01920604705810547 s
2021-08-18:16:29:06,9 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:06,18 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:06,19 INFO     [param_server.py:410] Lock worker 1 with localStep 269 , while globalStep is 268

2021-08-18:16:29:06,75 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:06,85 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:06,89 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:06,101 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:08,893 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:08,908 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:08,967 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:08,986 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:09,514 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:09,524 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:10,212 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:10,230 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:10,768 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:10,782 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:11,466 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:11,490 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:11,493 INFO     [learner.py:606] ====Pushing takes 0.025685548782348633 s
2021-08-18:16:29:11,500 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:11,527 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:11,535 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:11,535 INFO     [param_server.py:410] Lock worker 3 with localStep 269 , while globalStep is 268

2021-08-18:16:29:12,107 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:12,134 INFO     [learner.py:606] ====Pushing takes 0.025100231170654297 s
2021-08-18:16:29:12,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:12,171 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:12,172 INFO     [param_server.py:381] ====After aggregation in epoch: 268, virtual_clock: 9815.058773710733, top_1: : 63.4398 % (1966.0), top_5: : 100.0 % (3099.0), test loss: 3.429120390503495, test len: 3099.0
2021-08-18:16:29:12,174 INFO     [param_server.py:410] Lock worker 2 with localStep 269 , while globalStep is 269

2021-08-18:16:29:12,175 INFO     [param_server.py:441] ====Epoch 270 completes 20 clients with loss 387.6330761011562, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:12,175 INFO     [param_server.py:450] ====Start to sample for epoch 270, global virtualClock: 9815.058773710733, round_duration: 46.65186139097271
2021-08-18:16:29:12,176 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:12,455 INFO     [param_server.py:553] For epoch: 270, median_reward: 410.96347829462013, dev: 821.9269565892403
2021-08-18:16:29:13,32 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0129, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:29:13,33 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3604.4503, eval_time 0.543, test_loss 3.0129, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:29:13,73 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8084, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:29:13,74 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3604.4881, eval_time 0.5823, test_loss 2.8084, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:29:13,109 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8723, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:29:13,111 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3604.5304, eval_time 0.6206, test_loss 2.8723, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:29:13,130 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:13,139 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:13,143 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:13,157 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:13,182 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:13,202 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:14,533 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:14,547 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:14,782 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:14,792 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:15,880 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:15,887 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:15,889 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:15,892 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:15,896 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:15,899 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:16,427 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:16,436 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:16,962 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:16,971 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:17,512 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:17,526 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:18,22 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:18,26 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:18,36 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:18,47 INFO     [learner.py:606] ====Pushing takes 0.020885467529296875 s
2021-08-18:16:29:18,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:18,87 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:18,88 INFO     [param_server.py:410] Lock worker 1 with localStep 270 , while globalStep is 269

2021-08-18:16:29:18,460 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:18,472 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:18,700 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:18,710 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:21,275 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:21,285 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:21,494 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:21,508 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:22,3 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:22,18 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:22,770 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:22,781 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:23,234 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:23,243 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:23,878 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:23,909 INFO     [learner.py:606] ====Pushing takes 0.028911828994750977 s
2021-08-18:16:29:23,945 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:23,955 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:23,956 INFO     [param_server.py:410] Lock worker 3 with localStep 270 , while globalStep is 269

2021-08-18:16:29:24,8 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:24,19 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:25,121 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:25,149 INFO     [learner.py:606] ====Pushing takes 0.02638530731201172 s
2021-08-18:16:29:25,180 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:25,188 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:25,189 INFO     [param_server.py:381] ====After aggregation in epoch: 269, virtual_clock: 9861.710635101705, top_1: : 66.1181 % (2049.0), top_5: : 100.0 % (3099.0), test loss: 2.897874978957353, test len: 3099.0
2021-08-18:16:29:25,191 INFO     [param_server.py:410] Lock worker 2 with localStep 270 , while globalStep is 270

2021-08-18:16:29:25,192 INFO     [param_server.py:441] ====Epoch 271 completes 20 clients with loss 358.5032128359922, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:25,192 INFO     [param_server.py:450] ====Start to sample for epoch 271, global virtualClock: 9861.710635101705, round_duration: 46.65186139097271
2021-08-18:16:29:25,193 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:25,519 INFO     [param_server.py:553] For epoch: 271, median_reward: 402.15592342228484, dev: 804.3118468445697
2021-08-18:16:29:26,172 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.784, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:29:26,173 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3617.5872, eval_time 0.6174, test_loss 2.784, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:29:26,178 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2455, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:29:26,179 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3617.5965, eval_time 0.6258, test_loss 3.2455, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:29:26,193 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4284, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:29:26,194 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3617.6136, eval_time 0.641, test_loss 3.4284, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:29:26,245 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:26,254 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:26,259 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:26,264 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:26,268 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:26,279 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:27,493 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:27,507 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:27,887 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:27,909 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:28,954 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:28,967 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:29,112 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:29,123 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:29,170 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:29,184 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:29,998 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:30,19 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:30,785 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:30,806 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:31,299 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:31,309 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:31,540 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:31,585 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:31,956 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:31,970 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:32,160 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:32,180 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:32,205 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:32,226 INFO     [learner.py:606] ====Pushing takes 0.018885374069213867 s
2021-08-18:16:29:32,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:32,266 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:32,267 INFO     [param_server.py:410] Lock worker 1 with localStep 271 , while globalStep is 270

2021-08-18:16:29:34,655 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:34,664 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:35,19 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:35,28 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:35,358 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:35,367 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:36,289 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:36,299 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:36,568 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:36,581 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:37,254 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:37,284 INFO     [learner.py:606] ====Pushing takes 0.028473854064941406 s
2021-08-18:16:29:37,321 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:37,329 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:37,329 INFO     [param_server.py:410] Lock worker 3 with localStep 271 , while globalStep is 270

2021-08-18:16:29:37,643 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:37,655 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:38,218 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:38,244 INFO     [learner.py:606] ====Pushing takes 0.02494645118713379 s
2021-08-18:16:29:38,282 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:38,289 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:38,290 INFO     [param_server.py:381] ====After aggregation in epoch: 270, virtual_clock: 9908.362496492677, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 3.1526394729261042, test len: 3099.0
2021-08-18:16:29:38,293 INFO     [param_server.py:410] Lock worker 2 with localStep 271 , while globalStep is 271

2021-08-18:16:29:38,293 INFO     [param_server.py:441] ====Epoch 272 completes 20 clients with loss 228.65100924896473, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:38,294 INFO     [param_server.py:450] ====Start to sample for epoch 272, global virtualClock: 9908.362496492677, round_duration: 46.65186139097271
2021-08-18:16:29:38,294 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:38,578 INFO     [param_server.py:553] For epoch: 272, median_reward: 388.84722184585627, dev: 777.6944436917125
2021-08-18:16:29:39,216 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7883, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:29:39,218 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3630.6347, eval_time 0.6059, test_loss 2.7883, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:29:39,254 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.955, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:29:39,255 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3630.6696, eval_time 0.6425, test_loss 2.955, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:29:39,287 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:39,290 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.827, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:29:39,293 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3630.7128, eval_time 0.6814, test_loss 2.827, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:29:39,295 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:39,332 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:39,348 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:39,351 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:39,374 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:40,660 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:40,680 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:41,39 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:41,53 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:42,75 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:42,85 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:42,211 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:42,232 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:42,340 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:42,360 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:42,936 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:42,956 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:43,569 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:43,583 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:44,114 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:44,123 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:44,562 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:44,571 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:44,596 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:44,618 INFO     [learner.py:606] ====Pushing takes 0.020536184310913086 s
2021-08-18:16:29:44,657 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:44,666 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:44,667 INFO     [param_server.py:410] Lock worker 1 with localStep 272 , while globalStep is 271

2021-08-18:16:29:45,149 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:45,163 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:45,280 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:45,292 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:47,792 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:47,802 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:47,805 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:47,819 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:48,548 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:48,558 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:49,97 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:49,107 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:49,740 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:49,750 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:50,364 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:50,376 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:50,393 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:50,423 INFO     [learner.py:606] ====Pushing takes 0.028197765350341797 s
2021-08-18:16:29:50,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:50,470 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:50,470 INFO     [param_server.py:410] Lock worker 3 with localStep 272 , while globalStep is 271

2021-08-18:16:29:51,495 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:51,522 INFO     [learner.py:606] ====Pushing takes 0.026115894317626953 s
2021-08-18:16:29:51,560 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:51,573 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:51,574 INFO     [param_server.py:381] ====After aggregation in epoch: 271, virtual_clock: 9955.014357883649, top_1: : 65.9568 % (2044.0), top_5: : 100.0 % (3099.0), test loss: 2.8567664998549005, test len: 3099.0
2021-08-18:16:29:51,576 INFO     [param_server.py:410] Lock worker 2 with localStep 272 , while globalStep is 272

2021-08-18:16:29:51,577 INFO     [param_server.py:441] ====Epoch 273 completes 20 clients with loss 195.7346745262057, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:51,577 INFO     [param_server.py:450] ====Start to sample for epoch 273, global virtualClock: 9955.014357883649, round_duration: 46.65186139097271
2021-08-18:16:29:51,578 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:51,862 INFO     [param_server.py:553] For epoch: 273, median_reward: 388.0756693012191, dev: 776.1513386024382
2021-08-18:16:29:52,509 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0214, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:29:52,522 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3643.936, eval_time 0.601, test_loss 3.0214, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:29:52,594 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3325, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:29:52,595 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3644.0119, eval_time 0.674, test_loss 3.3325, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:29:52,628 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2379, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:29:52,629 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3644.0483, eval_time 0.7129, test_loss 3.2379, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:29:52,631 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:29:52,640 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:52,676 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:29:52,695 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:52,699 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:29:52,723 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:54,66 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:54,92 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:54,655 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:54,666 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:55,540 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:55,551 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:55,697 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:55,706 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:55,938 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:55,947 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:56,373 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:56,382 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:57,44 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:57,54 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:57,748 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:57,762 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:57,870 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:57,881 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:58,377 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:58,398 INFO     [learner.py:606] ====Pushing takes 0.01693129539489746 s
2021-08-18:16:29:58,425 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:58,440 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:58,440 INFO     [param_server.py:410] Lock worker 1 with localStep 273 , while globalStep is 272

2021-08-18:16:29:58,508 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:58,519 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:58,705 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:58,716 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:01,276 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:01,286 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:01,320 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:01,331 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:01,998 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:02,7 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:02,580 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:02,592 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:03,209 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:03,228 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:03,875 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:03,903 INFO     [learner.py:606] ====Pushing takes 0.026925086975097656 s
2021-08-18:16:30:03,945 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:03,959 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:03,960 INFO     [param_server.py:410] Lock worker 3 with localStep 273 , while globalStep is 272

2021-08-18:16:30:03,982 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:04,9 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:04,635 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:04,662 INFO     [learner.py:606] ====Pushing takes 0.025876998901367188 s
2021-08-18:16:30:04,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:04,699 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:04,700 INFO     [param_server.py:381] ====After aggregation in epoch: 272, virtual_clock: 10001.66621927462, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.197297709959525, test len: 3099.0
2021-08-18:16:30:04,702 INFO     [param_server.py:410] Lock worker 2 with localStep 273 , while globalStep is 273

2021-08-18:16:30:04,702 INFO     [param_server.py:441] ====Epoch 274 completes 20 clients with loss 227.55315653571878, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:04,703 INFO     [param_server.py:450] ====Start to sample for epoch 274, global virtualClock: 10001.66621927462, round_duration: 46.65186139097271
2021-08-18:16:30:04,704 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:04,978 INFO     [param_server.py:553] For epoch: 274, median_reward: 398.92145606148733, dev: 797.8429121229747
2021-08-18:16:30:05,636 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0923, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:30:05,637 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3657.0508, eval_time 0.5922, test_loss 3.0923, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:30:05,662 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5693, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:30:05,663 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3657.0825, eval_time 0.6298, test_loss 3.5693, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:30:05,671 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0198, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:30:05,672 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3657.0894, eval_time 0.632, test_loss 3.0198, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:30:05,719 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:30:05,741 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:06,136 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:30:06,144 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:30:06,151 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:06,157 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:07,13 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:07,27 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:07,893 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:07,903 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:08,213 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:08,222 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:08,792 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:08,804 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:08,944 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:08,954 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:09,111 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:09,120 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:09,664 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:09,676 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:10,275 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:10,285 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:10,810 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:10,833 INFO     [learner.py:606] ====Pushing takes 0.02160334587097168 s
2021-08-18:16:30:10,860 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:10,867 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:10,868 INFO     [param_server.py:410] Lock worker 1 with localStep 274 , while globalStep is 273

2021-08-18:16:30:11,77 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:11,86 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:11,779 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:11,790 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:11,832 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:11,844 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:14,385 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:14,404 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:14,450 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:14,460 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:15,59 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:15,69 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:15,692 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:15,713 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:16,206 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:16,227 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:16,911 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:16,939 INFO     [learner.py:606] ====Pushing takes 0.026769638061523438 s
2021-08-18:16:30:16,969 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:16,976 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:16,976 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:16,977 INFO     [param_server.py:410] Lock worker 3 with localStep 274 , while globalStep is 273

2021-08-18:16:30:16,992 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:18,284 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:18,309 INFO     [learner.py:606] ====Pushing takes 0.024107694625854492 s
2021-08-18:16:30:18,339 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:18,347 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:18,347 INFO     [param_server.py:381] ====After aggregation in epoch: 273, virtual_clock: 10048.318080665593, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 3.227128752955684, test len: 3099.0
2021-08-18:16:30:18,350 INFO     [param_server.py:410] Lock worker 2 with localStep 274 , while globalStep is 274

2021-08-18:16:30:18,351 INFO     [param_server.py:441] ====Epoch 275 completes 20 clients with loss 280.126269554596, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:18,351 INFO     [param_server.py:450] ====Start to sample for epoch 275, global virtualClock: 10048.318080665593, round_duration: 46.65186139097271
2021-08-18:16:30:18,352 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:18,660 INFO     [param_server.py:553] For epoch: 275, median_reward: 421.05544806040854, dev: 842.1108961208171
2021-08-18:16:30:19,279 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7419, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:30:19,283 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3670.697, eval_time 0.5961, test_loss 2.7419, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:30:19,319 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.991, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:30:19,320 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3670.7367, eval_time 0.635, test_loss 2.991, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:30:19,323 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.992, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:30:19,326 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3670.7454, eval_time 0.6429, test_loss 2.992, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:30:19,359 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:19,368 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:19,390 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:19,404 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:19,410 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:19,423 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:20,608 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:20,621 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:21,132 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:21,143 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:22,117 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:22,126 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:22,266 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:22,277 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:22,466 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:22,478 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:22,930 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:22,940 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:23,579 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:23,606 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:24,194 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:24,221 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:24,482 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:24,492 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:24,901 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:24,919 INFO     [learner.py:606] ====Pushing takes 0.016635894775390625 s
2021-08-18:16:30:24,950 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:24,961 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:24,962 INFO     [param_server.py:410] Lock worker 1 with localStep 275 , while globalStep is 274

2021-08-18:16:30:25,7 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:25,25 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:25,186 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:25,196 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:27,952 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:27,962 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:28,12 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:28,22 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:28,671 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:28,685 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:29,142 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:29,151 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:29,931 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:29,946 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:30,497 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:30,507 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:30,577 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:30,607 INFO     [learner.py:606] ====Pushing takes 0.028113365173339844 s
2021-08-18:16:30:30,640 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:30,649 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:30,649 INFO     [param_server.py:410] Lock worker 3 with localStep 275 , while globalStep is 274

2021-08-18:16:30:31,39 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:31,67 INFO     [learner.py:606] ====Pushing takes 0.02594780921936035 s
2021-08-18:16:30:31,98 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:31,106 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:31,106 INFO     [param_server.py:381] ====After aggregation in epoch: 274, virtual_clock: 10094.969942056565, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 2.9082917946356317, test len: 3099.0
2021-08-18:16:30:31,109 INFO     [param_server.py:410] Lock worker 2 with localStep 275 , while globalStep is 275

2021-08-18:16:30:31,110 INFO     [param_server.py:441] ====Epoch 276 completes 20 clients with loss 336.3500219039597, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:31,110 INFO     [param_server.py:450] ====Start to sample for epoch 276, global virtualClock: 10094.969942056565, round_duration: 46.65186139097271
2021-08-18:16:30:31,111 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:31,403 INFO     [param_server.py:553] For epoch: 276, median_reward: 406.6233532142899, dev: 813.2467064285798
2021-08-18:16:30:32,84 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4575, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:30:32,85 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3683.4988, eval_time 0.6475, test_loss 3.4575, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:30:32,111 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0615, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:30:32,112 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2674, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:30:32,112 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3683.5318, eval_time 0.675, test_loss 3.0615, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:30:32,112 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3683.5295, eval_time 0.6752, test_loss 3.2674, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:30:32,151 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:32,160 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:32,171 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:32,184 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:32,185 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:32,200 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:33,341 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:33,359 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:33,853 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:33,864 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:34,729 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:34,739 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:34,741 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:34,755 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:34,956 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:34,965 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:35,589 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:35,610 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:36,373 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:36,401 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:37,7 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:37,16 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:37,139 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:37,166 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:37,729 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:37,740 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:37,774 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:37,793 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:37,797 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:37,817 INFO     [learner.py:606] ====Pushing takes 0.019603967666625977 s
2021-08-18:16:30:37,846 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:37,853 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:37,853 INFO     [param_server.py:410] Lock worker 1 with localStep 276 , while globalStep is 275

2021-08-18:16:30:40,489 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:40,503 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:40,551 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:40,561 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:41,163 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:41,172 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:41,814 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:41,825 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:42,294 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:42,308 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:42,926 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:42,953 INFO     [learner.py:606] ====Pushing takes 0.024803638458251953 s
2021-08-18:16:30:42,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:42,995 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:42,996 INFO     [param_server.py:410] Lock worker 3 with localStep 276 , while globalStep is 275

2021-08-18:16:30:43,31 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:43,49 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:44,387 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:44,416 INFO     [learner.py:606] ====Pushing takes 0.026567459106445312 s
2021-08-18:16:30:44,451 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:44,458 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:44,459 INFO     [param_server.py:381] ====After aggregation in epoch: 275, virtual_clock: 10141.621803447537, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.2621191298520125, test len: 3099.0
2021-08-18:16:30:44,461 INFO     [param_server.py:410] Lock worker 2 with localStep 276 , while globalStep is 276

2021-08-18:16:30:44,462 INFO     [param_server.py:441] ====Epoch 277 completes 20 clients with loss 289.74596065520484, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:44,462 INFO     [param_server.py:450] ====Start to sample for epoch 277, global virtualClock: 10141.621803447537, round_duration: 46.65186139097271
2021-08-18:16:30:44,463 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:44,743 INFO     [param_server.py:553] For epoch: 277, median_reward: 395.5237318190641, dev: 791.0474636381282
2021-08-18:16:30:45,289 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6029, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:30:45,290 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3696.7046, eval_time 0.5224, test_loss 2.6029, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:30:45,299 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9782, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:30:45,300 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3696.7193, eval_time 0.5339, test_loss 2.9782, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:30:45,336 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9991, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:30:45,337 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3696.7539, eval_time 0.5689, test_loss 2.9991, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:30:45,365 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:45,371 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:45,376 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:45,387 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:45,411 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:45,424 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:46,668 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:46,695 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:47,258 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:47,272 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:48,22 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:48,36 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:48,569 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:48,582 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:48,597 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:48,610 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:49,193 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:49,207 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:49,766 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:49,780 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:50,213 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:50,224 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:50,488 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:50,503 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:50,815 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:50,826 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:51,151 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:51,170 INFO     [learner.py:606] ====Pushing takes 0.01731729507446289 s
2021-08-18:16:30:51,198 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:51,205 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:51,206 INFO     [param_server.py:410] Lock worker 1 with localStep 277 , while globalStep is 276

2021-08-18:16:30:51,214 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:51,226 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:53,523 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:53,531 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:54,63 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:54,77 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:54,111 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:54,121 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:55,249 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:55,259 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:55,261 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:55,275 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:55,865 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:55,894 INFO     [learner.py:606] ====Pushing takes 0.027350902557373047 s
2021-08-18:16:30:55,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:55,934 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:55,935 INFO     [param_server.py:410] Lock worker 3 with localStep 277 , while globalStep is 276

2021-08-18:16:30:56,424 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:56,433 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:56,973 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:56,999 INFO     [learner.py:606] ====Pushing takes 0.024478673934936523 s
2021-08-18:16:30:57,31 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:57,39 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:57,40 INFO     [param_server.py:381] ====After aggregation in epoch: 276, virtual_clock: 10188.273664838509, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 2.8600555405848556, test len: 3099.0
2021-08-18:16:30:57,42 INFO     [param_server.py:410] Lock worker 2 with localStep 277 , while globalStep is 277

2021-08-18:16:30:57,43 INFO     [param_server.py:441] ====Epoch 278 completes 20 clients with loss 264.2824945491993, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:57,43 INFO     [param_server.py:450] ====Start to sample for epoch 278, global virtualClock: 10188.273664838509, round_duration: 46.65186139097271
2021-08-18:16:30:57,44 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:57,326 INFO     [param_server.py:553] For epoch: 278, median_reward: 366.52673922505403, dev: 733.0534784501081
2021-08-18:16:30:58,24 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1205, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:30:58,27 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3709.441, eval_time 0.6492, test_loss 3.1205, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:30:58,95 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:30:58,99 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0288, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:30:58,103 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3709.5198, eval_time 0.7299, test_loss 3.0288, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:30:58,105 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:58,133 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0386, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:30:58,136 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3709.5555, eval_time 0.7648, test_loss 3.0386, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:30:58,170 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:30:58,186 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:58,191 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:30:58,217 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:59,476 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:59,497 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:00,34 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:00,55 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:00,742 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:00,752 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:00,804 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:00,813 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:01,301 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:01,310 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:01,382 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:01,391 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:01,944 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:01,955 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:02,495 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:02,505 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:02,949 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:02,960 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:03,9 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:03,30 INFO     [learner.py:606] ====Pushing takes 0.019246816635131836 s
2021-08-18:16:31:03,67 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:03,76 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:03,76 INFO     [param_server.py:410] Lock worker 1 with localStep 278 , while globalStep is 277

2021-08-18:16:31:03,544 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:03,554 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:03,985 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:03,996 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:06,246 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:06,260 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:06,727 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:06,738 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:06,849 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:06,860 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:07,985 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:08,9 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:08,19 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:07,997 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:08,652 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:08,680 INFO     [learner.py:606] ====Pushing takes 0.0269320011138916 s
2021-08-18:16:31:08,712 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:08,719 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:08,720 INFO     [param_server.py:410] Lock worker 3 with localStep 278 , while globalStep is 277

2021-08-18:16:31:09,278 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:09,291 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:10,595 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:10,623 INFO     [learner.py:606] ====Pushing takes 0.0261690616607666 s
2021-08-18:16:31:10,655 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:10,662 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:10,663 INFO     [param_server.py:381] ====After aggregation in epoch: 277, virtual_clock: 10234.925526229481, top_1: : 65.9568 % (2044.0), top_5: : 100.0 % (3099.0), test loss: 3.062635952675784, test len: 3099.0
2021-08-18:16:31:10,666 INFO     [param_server.py:410] Lock worker 2 with localStep 278 , while globalStep is 278

2021-08-18:16:31:10,667 INFO     [param_server.py:441] ====Epoch 279 completes 20 clients with loss 364.3455729308045, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:10,667 INFO     [param_server.py:450] ====Start to sample for epoch 279, global virtualClock: 10234.925526229481, round_duration: 46.65186139097271
2021-08-18:16:31:10,668 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:31:10,945 INFO     [param_server.py:553] For epoch: 279, median_reward: 402.11184144064816, dev: 804.2236828812963
2021-08-18:16:31:11,667 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9971, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:31:11,668 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3723.0825, eval_time 0.6702, test_loss 2.9971, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:31:11,692 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0466, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:16:31:11,692 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3723.1096, eval_time 0.6955, test_loss 3.0466, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:16:31:11,722 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1041, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:31:11,723 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3723.1432, eval_time 0.7332, test_loss 3.1041, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:31:11,738 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:31:11,746 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:11,762 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:31:11,778 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:11,782 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:31:11,799 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:13,93 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:13,114 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:13,501 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:13,521 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:14,498 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:14,514 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:14,562 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:14,576 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:14,912 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:14,922 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:15,569 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:15,579 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:16,176 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:16,190 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:16,635 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:16,647 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:16,733 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:16,754 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:17,137 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:17,149 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:17,306 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:17,316 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:17,388 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:17,407 INFO     [learner.py:606] ====Pushing takes 0.017003297805786133 s
2021-08-18:16:31:17,440 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:17,446 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:17,447 INFO     [param_server.py:410] Lock worker 1 with localStep 279 , while globalStep is 278

2021-08-18:16:31:19,950 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:19,960 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:19,993 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:20,11 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:20,505 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:20,519 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:21,219 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:21,233 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:21,719 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:21,733 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:22,375 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:22,403 INFO     [learner.py:606] ====Pushing takes 0.026722192764282227 s
2021-08-18:16:31:22,440 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:22,451 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:22,451 INFO     [param_server.py:410] Lock worker 3 with localStep 279 , while globalStep is 278

2021-08-18:16:31:22,548 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:22,561 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:23,81 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:23,113 INFO     [learner.py:606] ====Pushing takes 0.027242183685302734 s
2021-08-18:16:31:23,143 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:23,151 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:23,152 INFO     [param_server.py:381] ====After aggregation in epoch: 278, virtual_clock: 10281.577387620453, top_1: : 61.7296 % (1913.0), top_5: : 100.0 % (3099.0), test loss: 3.0492870388207614, test len: 3099.0
2021-08-18:16:31:23,154 INFO     [param_server.py:410] Lock worker 2 with localStep 279 , while globalStep is 279

2021-08-18:16:31:23,154 INFO     [param_server.py:441] ====Epoch 280 completes 20 clients with loss 142.0842641612702, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:23,155 INFO     [param_server.py:450] ====Start to sample for epoch 280, global virtualClock: 10281.577387620453, round_duration: 46.65186139097271
2021-08-18:16:31:23,156 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:31:23,427 INFO     [param_server.py:553] For epoch: 280, median_reward: 394.8998749833519, dev: 789.7997499667038
2021-08-18:16:31:24,25 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6923, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:31:24,26 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3735.4406, eval_time 0.5626, test_loss 2.6923, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:31:24,80 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.393, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:31:24,81 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3735.498, eval_time 0.617, test_loss 3.393, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:31:24,93 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:24,103 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:24,106 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3603, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:31:24,107 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3735.5271, eval_time 0.6463, test_loss 3.3603, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:31:24,149 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:24,164 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:24,176 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:24,196 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:25,691 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:25,711 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:26,26 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:26,40 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:26,873 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:26,882 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:26,910 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:26,919 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:27,365 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:27,376 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:27,502 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:27,513 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:28,113 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:28,132 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:28,696 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:28,710 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:29,84 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:29,93 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:29,274 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:29,295 INFO     [learner.py:606] ====Pushing takes 0.019268035888671875 s
2021-08-18:16:31:29,321 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:29,333 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:29,334 INFO     [param_server.py:410] Lock worker 1 with localStep 280 , while globalStep is 279

2021-08-18:16:31:29,741 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:29,751 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:30,155 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:30,175 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:32,315 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:32,324 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:33,127 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:33,138 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:33,148 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:33,159 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:34,277 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:34,292 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:34,319 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:34,331 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:34,921 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:34,948 INFO     [learner.py:606] ====Pushing takes 0.025409221649169922 s
2021-08-18:16:31:34,978 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:34,986 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:34,987 INFO     [param_server.py:410] Lock worker 3 with localStep 280 , while globalStep is 279

2021-08-18:16:31:35,560 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:35,576 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:36,837 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:36,863 INFO     [learner.py:606] ====Pushing takes 0.024250030517578125 s
2021-08-18:16:31:36,894 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:36,901 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:36,902 INFO     [param_server.py:381] ====After aggregation in epoch: 279, virtual_clock: 10328.229249011425, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.1485543206886004, test len: 3099.0
2021-08-18:16:31:36,904 INFO     [param_server.py:410] Lock worker 2 with localStep 280 , while globalStep is 280

2021-08-18:16:31:36,905 INFO     [param_server.py:441] ====Epoch 281 completes 20 clients with loss 154.75054408673103, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:36,906 INFO     [param_server.py:450] ====Start to sample for epoch 281, global virtualClock: 10328.229249011425, round_duration: 46.65186139097271
2021-08-18:16:31:36,906 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:31:37,217 INFO     [param_server.py:541] Handle Wight 0.03461313247680664 | Send 0.31124424934387207
2021-08-18:16:31:37,218 INFO     [param_server.py:553] For epoch: 281, median_reward: 358.5456381029106, dev: 717.0912762058211
2021-08-18:16:31:37,846 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3008, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:31:37,850 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3749.264, eval_time 0.5859, test_loss 3.3008, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:31:37,883 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2509, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:31:37,884 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3749.3006, eval_time 0.6212, test_loss 3.2509, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:31:37,918 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:37,922 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2126, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:31:37,923 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3749.343, eval_time 0.6656, test_loss 3.2126, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:31:37,926 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:37,976 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:37,991 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:37,992 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:38,14 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:39,358 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:39,373 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:39,815 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:39,826 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:40,590 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:40,600 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:41,56 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:41,70 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:41,219 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:41,240 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:42,76 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:42,97 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:42,949 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:42,976 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:43,35 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:43,45 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:43,693 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:43,714 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:43,749 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:43,758 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:44,181 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:44,195 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:44,383 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:44,404 INFO     [learner.py:606] ====Pushing takes 0.019728899002075195 s
2021-08-18:16:31:44,439 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:44,447 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:44,448 INFO     [param_server.py:410] Lock worker 1 with localStep 281 , while globalStep is 280

2021-08-18:16:31:46,524 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:46,534 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:47,28 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:47,38 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:47,229 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:47,238 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:48,278 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:48,292 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:48,447 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:48,476 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:49,84 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:49,113 INFO     [learner.py:606] ====Pushing takes 0.027807235717773438 s
2021-08-18:16:31:49,144 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:49,152 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:49,153 INFO     [param_server.py:410] Lock worker 3 with localStep 281 , while globalStep is 280

2021-08-18:16:31:49,637 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:49,657 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:50,286 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:50,313 INFO     [learner.py:606] ====Pushing takes 0.02621173858642578 s
2021-08-18:16:31:50,356 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:50,366 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:50,367 INFO     [param_server.py:381] ====After aggregation in epoch: 280, virtual_clock: 10374.881110402397, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 3.2547807693481445, test len: 3099.0
2021-08-18:16:31:50,369 INFO     [param_server.py:410] Lock worker 2 with localStep 281 , while globalStep is 281

2021-08-18:16:31:50,370 INFO     [param_server.py:441] ====Epoch 282 completes 20 clients with loss 300.94354149399686, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:50,370 INFO     [param_server.py:450] ====Start to sample for epoch 282, global virtualClock: 10374.881110402397, round_duration: 46.65186139097271
2021-08-18:16:31:50,371 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:31:50,675 INFO     [param_server.py:553] For epoch: 282, median_reward: 380.45520708655096, dev: 760.9104141731019
2021-08-18:16:31:51,381 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9572, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:31:51,382 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3762.7992, eval_time 0.6589, test_loss 2.9572, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:31:51,457 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9544, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:31:51,458 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3762.8721, eval_time 0.7332, test_loss 2.9544, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:31:51,459 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:31:51,471 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:51,527 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:31:51,540 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:51,567 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3958, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:31:51,568 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3762.9873, eval_time 0.8474, test_loss 3.3958, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:31:51,649 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:31:51,677 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:53,769 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:53,788 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:53,922 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:53,943 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:54,258 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:54,269 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:56,32 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:56,42 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:56,627 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:56,638 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:56,640 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:56,650 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:57,358 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:57,368 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:57,416 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:57,430 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:58,729 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:58,756 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:59,294 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:59,305 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:59,513 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:59,534 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:00,82 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:00,94 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:00,657 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:00,690 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:01,44 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:01,56 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:01,175 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:01,189 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:01,287 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:01,310 INFO     [learner.py:606] ====Pushing takes 0.021289825439453125 s
2021-08-18:16:32:01,350 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:01,358 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:01,358 INFO     [param_server.py:410] Lock worker 1 with localStep 282 , while globalStep is 281

2021-08-18:16:32:02,785 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:02,796 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:03,564 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:03,591 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:04,6 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:04,39 INFO     [learner.py:606] ====Pushing takes 0.028708696365356445 s
2021-08-18:16:32:04,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:04,92 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:04,92 INFO     [param_server.py:410] Lock worker 3 with localStep 282 , while globalStep is 281

2021-08-18:16:32:05,871 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:05,896 INFO     [learner.py:606] ====Pushing takes 0.024451494216918945 s
2021-08-18:16:32:05,933 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:05,941 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:05,942 INFO     [param_server.py:381] ====After aggregation in epoch: 281, virtual_clock: 10451.99065875099, top_1: : 65.989 % (2045.0), top_5: : 100.0 % (3099.0), test loss: 3.1024949462325484, test len: 3099.0
2021-08-18:16:32:05,944 INFO     [param_server.py:410] Lock worker 2 with localStep 282 , while globalStep is 282

2021-08-18:16:32:05,945 INFO     [param_server.py:441] ====Epoch 283 completes 20 clients with loss 87.58010122661089, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:05,945 INFO     [param_server.py:450] ====Start to sample for epoch 283, global virtualClock: 10451.99065875099, round_duration: 77.10954834859407
2021-08-18:16:32:05,946 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:06,287 INFO     [param_server.py:553] For epoch: 283, median_reward: 449.6605183883985, dev: 899.321036776797
2021-08-18:16:32:06,907 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9636, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:32:06,908 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3778.328, eval_time 0.6089, test_loss 2.9636, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:32:06,932 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5379, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:32:06,934 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.726, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:32:06,934 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3778.3482, eval_time 0.6343, test_loss 2.5379, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:32:06,935 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3778.3518, eval_time 0.6354, test_loss 2.726, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:32:06,979 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:32:06,988 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:07,6 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:32:07,6 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:32:07,15 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:07,16 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:08,141 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:08,165 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:08,631 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:08,641 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:09,558 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:09,568 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:10,170 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:10,184 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:11,413 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:11,424 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:11,529 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:11,550 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:11,827 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:11,861 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:12,307 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:12,334 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:12,563 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:12,573 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:13,88 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:13,128 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:13,785 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:13,825 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:14,268 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:14,283 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:14,615 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:14,638 INFO     [learner.py:606] ====Pushing takes 0.02138376235961914 s
2021-08-18:16:32:14,688 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:14,697 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:14,698 INFO     [param_server.py:410] Lock worker 1 with localStep 283 , while globalStep is 282

2021-08-18:16:32:15,390 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:15,399 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:15,549 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:15,569 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:16,98 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:16,108 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:17,950 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:17,962 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:18,154 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:18,167 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:18,591 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:18,620 INFO     [learner.py:606] ====Pushing takes 0.028411149978637695 s
2021-08-18:16:32:18,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:18,670 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:18,671 INFO     [param_server.py:410] Lock worker 3 with localStep 283 , while globalStep is 282

2021-08-18:16:32:18,783 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:18,810 INFO     [learner.py:606] ====Pushing takes 0.025405406951904297 s
2021-08-18:16:32:18,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:18,843 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:18,844 INFO     [param_server.py:381] ====After aggregation in epoch: 282, virtual_clock: 10514.191979407527, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 2.7425021611981926, test len: 3099.0
2021-08-18:16:32:18,847 INFO     [param_server.py:410] Lock worker 2 with localStep 283 , while globalStep is 283

2021-08-18:16:32:18,847 INFO     [param_server.py:441] ====Epoch 284 completes 20 clients with loss 243.54336427126123, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:18,847 INFO     [param_server.py:450] ====Start to sample for epoch 284, global virtualClock: 10514.191979407527, round_duration: 62.20132065653664
2021-08-18:16:32:18,848 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:19,178 INFO     [param_server.py:553] For epoch: 284, median_reward: 411.659042040437, dev: 823.318084080874
2021-08-18:16:32:19,776 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8933, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:32:19,776 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.258, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:32:19,777 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3791.1909, eval_time 0.5849, test_loss 2.8933, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:32:19,777 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3791.1965, eval_time 0.5862, test_loss 3.258, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:32:19,780 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9189, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:32:19,781 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3791.1978, eval_time 0.5901, test_loss 2.9189, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:32:19,847 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:19,848 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:19,852 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:19,855 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:19,856 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:19,862 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:21,62 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:21,71 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:21,564 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:21,575 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:22,490 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:22,502 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:22,975 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:22,995 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:24,267 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:24,281 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:24,383 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:24,410 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:24,756 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:24,770 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:25,290 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:25,323 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:25,509 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:25,526 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:26,202 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:26,235 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:27,54 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:27,87 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:27,117 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:27,135 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:27,634 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:27,656 INFO     [learner.py:606] ====Pushing takes 0.02082347869873047 s
2021-08-18:16:32:27,694 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:27,720 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:27,721 INFO     [param_server.py:410] Lock worker 1 with localStep 284 , while globalStep is 283

2021-08-18:16:32:28,192 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:28,204 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:28,300 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:28,313 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:28,889 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:28,899 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:30,555 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:30,564 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:30,792 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:30,811 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:31,231 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:31,260 INFO     [learner.py:606] ====Pushing takes 0.028319835662841797 s
2021-08-18:16:32:31,293 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:31,301 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:31,302 INFO     [param_server.py:410] Lock worker 3 with localStep 284 , while globalStep is 283

2021-08-18:16:32:31,598 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:31,623 INFO     [learner.py:606] ====Pushing takes 0.024733543395996094 s
2021-08-18:16:32:31,654 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:31,661 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:31,662 INFO     [param_server.py:381] ====After aggregation in epoch: 283, virtual_clock: 10578.32595413028, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 3.0233805930172952, test len: 3099.0
2021-08-18:16:32:31,664 INFO     [param_server.py:410] Lock worker 2 with localStep 284 , while globalStep is 284

2021-08-18:16:32:31,665 INFO     [param_server.py:441] ====Epoch 285 completes 20 clients with loss 108.59885712112056, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:31,665 INFO     [param_server.py:450] ====Start to sample for epoch 285, global virtualClock: 10578.32595413028, round_duration: 64.13397472275163
2021-08-18:16:32:31,666 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:31,979 INFO     [param_server.py:553] For epoch: 285, median_reward: 391.12346025043274, dev: 782.2469205008655
2021-08-18:16:32:32,560 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.693, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:32:32,560 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3803.9744, eval_time 0.5635, test_loss 2.693, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:32:32,558 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0144, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:32:32,561 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3803.9807, eval_time 0.5696, test_loss 3.0144, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:32:32,628 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:32,633 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:32,639 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:32,641 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:32,692 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7971, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:32:32,693 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3804.1102, eval_time 0.7009, test_loss 2.7971, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:32:32,764 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:32,773 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:33,745 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:33,759 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:34,653 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:34,668 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:35,143 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:35,152 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:35,676 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:35,697 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:37,9 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:37,26 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:37,514 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:37,523 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:37,569 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:37,588 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:37,724 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:37,742 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:38,106 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:38,120 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:38,571 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:38,598 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:39,290 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:39,327 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:39,861 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:39,886 INFO     [learner.py:606] ====Pushing takes 0.023262977600097656 s
2021-08-18:16:32:39,924 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:39,936 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:39,937 INFO     [param_server.py:410] Lock worker 1 with localStep 285 , while globalStep is 284

2021-08-18:16:32:40,362 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:40,374 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:40,772 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:40,784 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:41,444 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:41,459 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:41,534 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:41,548 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:42,833 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:42,851 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:43,391 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:43,422 INFO     [learner.py:606] ====Pushing takes 0.027592182159423828 s
2021-08-18:16:32:43,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:43,465 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:43,466 INFO     [param_server.py:410] Lock worker 3 with localStep 285 , while globalStep is 284

2021-08-18:16:32:44,11 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:44,23 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:44,608 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:44,634 INFO     [learner.py:606] ====Pushing takes 0.024428844451904297 s
2021-08-18:16:32:44,661 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:44,669 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:44,669 INFO     [param_server.py:381] ====After aggregation in epoch: 284, virtual_clock: 10635.97214204011, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 2.8348416343883236, test len: 3099.0
2021-08-18:16:32:44,671 INFO     [param_server.py:410] Lock worker 2 with localStep 285 , while globalStep is 285

2021-08-18:16:32:44,672 INFO     [param_server.py:441] ====Epoch 286 completes 20 clients with loss 294.0466538942816, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:44,672 INFO     [param_server.py:450] ====Start to sample for epoch 286, global virtualClock: 10635.97214204011, round_duration: 57.6461879098304
2021-08-18:16:32:44,673 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:44,980 INFO     [param_server.py:553] For epoch: 286, median_reward: 429.94176019931894, dev: 859.8835203986379
2021-08-18:16:32:45,656 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0564, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:32:45,656 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3817.0736, eval_time 0.6533, test_loss 3.0564, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:32:45,661 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9017, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:32:45,662 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3817.0763, eval_time 0.6585, test_loss 2.9017, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:32:45,687 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.145, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:32:45,690 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3817.1097, eval_time 0.6867, test_loss 3.145, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:32:45,728 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:45,733 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:45,743 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:45,744 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:45,762 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:45,775 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:47,173 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:47,187 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:47,568 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:47,578 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:48,333 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:48,343 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:49,71 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:49,89 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:50,275 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:50,286 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:50,543 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:50,553 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:50,556 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:50,565 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:50,967 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:50,993 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:51,214 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:51,224 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:51,856 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:51,883 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:52,534 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:52,561 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:53,105 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:53,126 INFO     [learner.py:606] ====Pushing takes 0.020362138748168945 s
2021-08-18:16:32:53,161 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:53,169 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:53,170 INFO     [param_server.py:410] Lock worker 1 with localStep 286 , while globalStep is 285

2021-08-18:16:32:53,194 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:53,208 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:53,852 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:53,864 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:54,413 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:54,431 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:54,559 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:54,568 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:55,843 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:55,857 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:56,578 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:56,604 INFO     [learner.py:606] ====Pushing takes 0.0244903564453125 s
2021-08-18:16:32:56,634 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:56,642 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:56,643 INFO     [param_server.py:410] Lock worker 3 with localStep 286 , while globalStep is 285

2021-08-18:16:32:56,972 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:56,990 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:57,927 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:57,953 INFO     [learner.py:606] ====Pushing takes 0.022071123123168945 s
2021-08-18:16:32:57,978 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:57,988 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:57,988 INFO     [param_server.py:381] ====After aggregation in epoch: 285, virtual_clock: 10693.618329949939, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 3.0343730670434454, test len: 3099.0
2021-08-18:16:32:57,991 INFO     [param_server.py:410] Lock worker 2 with localStep 286 , while globalStep is 286

2021-08-18:16:32:57,991 INFO     [param_server.py:441] ====Epoch 287 completes 20 clients with loss 171.60181958054042, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:57,992 INFO     [param_server.py:450] ====Start to sample for epoch 287, global virtualClock: 10693.618329949939, round_duration: 57.6461879098304
2021-08-18:16:32:57,993 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:58,334 INFO     [param_server.py:553] For epoch: 287, median_reward: 373.8664380286795, dev: 747.732876057359
2021-08-18:16:32:58,995 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8495, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:32:58,995 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3830.4126, eval_time 0.6278, test_loss 2.8495, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:32:58,994 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0738, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:32:58,997 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3830.4114, eval_time 0.6296, test_loss 3.0738, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:32:59,39 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.996, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:32:59,40 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3830.4595, eval_time 0.6721, test_loss 2.996, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:32:59,89 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:32:59,91 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:32:59,99 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:59,106 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:59,110 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:32:59,123 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:00,337 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:00,355 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:00,867 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:00,878 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:01,792 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:01,802 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:01,840 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:01,849 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:02,951 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:02,960 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:03,403 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:03,412 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:03,748 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:03,767 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:04,31 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:04,41 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:04,648 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:04,652 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:04,662 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:04,682 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:05,397 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:05,431 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:06,16 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:06,38 INFO     [learner.py:606] ====Pushing takes 0.020144224166870117 s
2021-08-18:16:33:06,77 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:06,86 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:06,87 INFO     [param_server.py:410] Lock worker 1 with localStep 287 , while globalStep is 286

2021-08-18:16:33:06,99 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:06,110 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:07,369 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:07,384 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:07,422 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:07,441 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:08,148 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:08,158 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:09,574 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:09,584 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:10,147 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:10,157 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:10,165 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:10,202 INFO     [learner.py:606] ====Pushing takes 0.04429984092712402 s
2021-08-18:16:33:10,238 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:10,246 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:10,247 INFO     [param_server.py:410] Lock worker 3 with localStep 287 , while globalStep is 286

2021-08-18:16:33:10,902 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:10,930 INFO     [learner.py:606] ====Pushing takes 0.02662038803100586 s
2021-08-18:16:33:10,958 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:10,965 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:10,966 INFO     [param_server.py:381] ====After aggregation in epoch: 286, virtual_clock: 10751.264517859769, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 2.973080181413227, test len: 3099.0
2021-08-18:16:33:10,969 INFO     [param_server.py:410] Lock worker 2 with localStep 287 , while globalStep is 287

2021-08-18:16:33:10,970 INFO     [param_server.py:441] ====Epoch 288 completes 20 clients with loss 282.52052230147115, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:10,971 INFO     [param_server.py:450] ====Start to sample for epoch 288, global virtualClock: 10751.264517859769, round_duration: 57.6461879098304
2021-08-18:16:33:10,972 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:11,306 INFO     [param_server.py:553] For epoch: 288, median_reward: 404.067789458553, dev: 808.135578917106
2021-08-18:16:33:11,989 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7323, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:33:11,990 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2761, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:33:11,991 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3843.4082, eval_time 0.6565, test_loss 3.2761, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:33:11,994 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7388, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:33:11,997 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3843.4171, eval_time 0.6664, test_loss 3.7388, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:33:11,990 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3843.4037, eval_time 0.6516, test_loss 2.7323, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:33:12,70 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:33:12,71 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:33:12,79 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:12,79 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:12,90 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:33:12,98 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:13,371 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:13,384 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:13,877 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:13,887 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:14,824 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:14,834 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:15,38 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:15,48 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:16,252 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:16,280 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:16,556 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:16,566 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:17,120 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:17,129 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:17,168 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:17,202 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:17,684 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:17,696 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:17,910 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:17,943 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:18,605 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:18,638 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:19,308 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:19,332 INFO     [learner.py:606] ====Pushing takes 0.02313375473022461 s
2021-08-18:16:33:19,369 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:19,377 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:19,387 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:19,388 INFO     [param_server.py:410] Lock worker 1 with localStep 288 , while globalStep is 287

2021-08-18:16:33:19,388 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:20,424 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:20,443 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:20,744 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:20,769 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:21,235 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:21,254 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:22,386 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:22,403 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:22,976 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:23,23 INFO     [learner.py:606] ====Pushing takes 0.04488706588745117 s
2021-08-18:16:33:23,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:23,62 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:23,63 INFO     [param_server.py:410] Lock worker 3 with localStep 288 , while globalStep is 287

2021-08-18:16:33:23,275 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:23,287 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:23,978 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:24,4 INFO     [learner.py:606] ====Pushing takes 0.024306535720825195 s
2021-08-18:16:33:24,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:24,43 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:24,44 INFO     [param_server.py:381] ====After aggregation in epoch: 287, virtual_clock: 10808.910705769598, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 3.2490647501415673, test len: 3099.0
2021-08-18:16:33:24,46 INFO     [param_server.py:410] Lock worker 2 with localStep 288 , while globalStep is 288

2021-08-18:16:33:24,47 INFO     [param_server.py:441] ====Epoch 289 completes 20 clients with loss 263.0922250612413, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:24,47 INFO     [param_server.py:450] ====Start to sample for epoch 289, global virtualClock: 10808.910705769598, round_duration: 57.6461879098304
2021-08-18:16:33:24,48 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:24,389 INFO     [param_server.py:553] For epoch: 289, median_reward: 439.5039923903585, dev: 879.007984780717
2021-08-18:16:33:25,31 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1129, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:33:25,32 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3856.4522, eval_time 0.6323, test_loss 3.1129, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:33:25,39 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6792, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:33:25,40 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9433, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:33:25,41 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3856.4548, eval_time 0.6384, test_loss 2.6792, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:33:25,41 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3856.4579, eval_time 0.6388, test_loss 3.9433, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:33:25,102 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:25,112 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:25,113 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:25,114 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:25,121 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:25,123 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:26,315 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:26,324 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:26,949 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:26,959 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:27,849 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:27,862 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:28,276 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:28,294 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:29,601 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:29,635 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:29,757 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:29,775 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:30,163 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:30,173 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:30,536 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:30,576 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:30,874 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:30,884 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:31,533 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:31,567 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:32,151 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:32,185 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:32,707 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:32,728 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:32,758 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:32,777 INFO     [learner.py:606] ====Pushing takes 0.018285036087036133 s
2021-08-18:16:33:32,818 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:32,826 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:32,826 INFO     [param_server.py:410] Lock worker 1 with localStep 289 , while globalStep is 288

2021-08-18:16:33:33,542 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:33,555 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:34,31 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:34,50 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:34,380 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:34,394 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:35,657 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:35,667 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:36,230 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:36,239 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:36,391 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:36,420 INFO     [learner.py:606] ====Pushing takes 0.027789831161499023 s
2021-08-18:16:33:36,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:36,460 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:36,461 INFO     [param_server.py:410] Lock worker 3 with localStep 289 , while globalStep is 288

2021-08-18:16:33:36,877 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:36,902 INFO     [learner.py:606] ====Pushing takes 0.023599863052368164 s
2021-08-18:16:33:36,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:36,934 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:36,935 INFO     [param_server.py:381] ====After aggregation in epoch: 288, virtual_clock: 10866.556893679428, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 3.2451171875, test len: 3099.0
2021-08-18:16:33:36,937 INFO     [param_server.py:410] Lock worker 2 with localStep 289 , while globalStep is 289

2021-08-18:16:33:36,938 INFO     [param_server.py:441] ====Epoch 290 completes 20 clients with loss 220.53248233419777, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:36,938 INFO     [param_server.py:450] ====Start to sample for epoch 290, global virtualClock: 10866.556893679428, round_duration: 57.6461879098304
2021-08-18:16:33:36,939 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:37,234 INFO     [param_server.py:553] For epoch: 290, median_reward: 390.9954725172877, dev: 781.9909450345754
2021-08-18:16:33:37,925 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9414, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:33:37,925 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3869.3452, eval_time 0.6794, test_loss 2.9414, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:33:37,935 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7955, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:33:37,938 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3869.3524, eval_time 0.6889, test_loss 2.7955, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:33:37,942 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4564, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:33:37,943 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3869.3598, eval_time 0.6953, test_loss 3.4564, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:33:37,986 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:37,995 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:38,14 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:38,24 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:38,25 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:38,33 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:39,158 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:39,172 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:39,525 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:39,537 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:40,486 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:40,496 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:41,91 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:41,111 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:42,323 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:42,341 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:42,398 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:42,425 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:42,836 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:42,847 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:43,334 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:43,368 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:43,439 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:43,451 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:44,251 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:44,278 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:44,988 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:45,15 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:45,58 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:45,77 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:45,676 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:45,697 INFO     [learner.py:606] ====Pushing takes 0.02054429054260254 s
2021-08-18:16:33:45,737 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:45,746 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:45,747 INFO     [param_server.py:410] Lock worker 1 with localStep 290 , while globalStep is 289

2021-08-18:16:33:46,223 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:46,244 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:46,343 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:46,364 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:47,23 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:47,44 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:48,339 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:48,348 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:48,728 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:48,743 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:48,952 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:48,982 INFO     [learner.py:606] ====Pushing takes 0.028591156005859375 s
2021-08-18:16:33:49,13 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:49,21 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:49,22 INFO     [param_server.py:410] Lock worker 3 with localStep 290 , while globalStep is 289

2021-08-18:16:33:49,488 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:49,514 INFO     [learner.py:606] ====Pushing takes 0.02404642105102539 s
2021-08-18:16:33:49,541 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:49,549 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:49,550 INFO     [param_server.py:381] ====After aggregation in epoch: 289, virtual_clock: 10924.203081589258, top_1: : 65.1178 % (2018.0), top_5: : 100.0 % (3099.0), test loss: 3.0644599386939295, test len: 3099.0
2021-08-18:16:33:49,552 INFO     [param_server.py:410] Lock worker 2 with localStep 290 , while globalStep is 290

2021-08-18:16:33:49,552 INFO     [param_server.py:441] ====Epoch 291 completes 20 clients with loss 144.75093855804462, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:49,553 INFO     [param_server.py:450] ====Start to sample for epoch 291, global virtualClock: 10924.203081589258, round_duration: 57.6461879098304
2021-08-18:16:33:49,553 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:49,865 INFO     [param_server.py:553] For epoch: 291, median_reward: 397.3676663774881, dev: 794.7353327549762
2021-08-18:16:33:50,490 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7495, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:33:50,491 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3881.9054, eval_time 0.5968, test_loss 2.7495, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:33:50,504 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7222, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:33:50,505 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3881.9225, eval_time 0.6136, test_loss 2.7222, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:33:50,534 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8529, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:33:50,535 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3881.9549, eval_time 0.6453, test_loss 2.8529, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:33:50,564 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:33:50,572 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:50,575 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:33:50,585 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:50,611 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:33:50,625 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:51,803 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:51,824 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:52,206 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:52,219 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:53,149 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:53,163 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:53,685 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:53,705 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:54,902 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:54,929 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:55,217 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:55,230 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:55,637 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:55,647 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:55,758 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:55,784 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:56,305 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:56,316 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:56,523 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:56,550 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:57,298 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:57,326 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:57,854 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:57,873 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:57,993 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:58,18 INFO     [learner.py:606] ====Pushing takes 0.02128911018371582 s
2021-08-18:16:33:58,58 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:58,66 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:58,66 INFO     [param_server.py:410] Lock worker 1 with localStep 291 , while globalStep is 290

2021-08-18:16:33:58,919 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:58,934 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:59,132 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:59,146 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:59,571 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:59,586 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:00,912 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:00,921 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:01,561 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:01,591 INFO     [learner.py:606] ====Pushing takes 0.02855372428894043 s
2021-08-18:16:34:01,599 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:01,610 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:01,623 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:01,631 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:01,632 INFO     [param_server.py:410] Lock worker 3 with localStep 291 , while globalStep is 290

2021-08-18:16:34:02,314 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:02,339 INFO     [learner.py:606] ====Pushing takes 0.023468732833862305 s
2021-08-18:16:34:02,365 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:02,372 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:02,373 INFO     [param_server.py:381] ====After aggregation in epoch: 290, virtual_clock: 10981.849269499087, top_1: : 65.9568 % (2044.0), top_5: : 100.0 % (3099.0), test loss: 2.774858585110417, test len: 3099.0
2021-08-18:16:34:02,376 INFO     [param_server.py:410] Lock worker 2 with localStep 291 , while globalStep is 291

2021-08-18:16:34:02,376 INFO     [param_server.py:441] ====Epoch 292 completes 20 clients with loss 159.36336930010827, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:02,377 INFO     [param_server.py:450] ====Start to sample for epoch 292, global virtualClock: 10981.849269499087, round_duration: 57.6461879098304
2021-08-18:16:34:02,377 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:02,663 INFO     [param_server.py:553] For epoch: 292, median_reward: 398.85268783027664, dev: 797.7053756605533
2021-08-18:16:34:03,320 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0184, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:34:03,323 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3894.7405, eval_time 0.638, test_loss 3.0184, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:34:03,325 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.514, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:34:03,326 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3894.7401, eval_time 0.6378, test_loss 2.514, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:34:03,380 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:34:03,395 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:34:03,396 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:03,398 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4604, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:34:03,399 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3894.8188, eval_time 0.7137, test_loss 3.4604, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:34:03,405 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:03,473 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:34:03,491 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:04,817 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:04,838 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:05,283 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:05,297 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:06,82 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:06,97 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:06,571 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:06,580 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:07,696 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:07,710 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:08,25 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:08,34 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:08,352 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:08,365 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:08,591 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:08,618 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:09,98 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:09,109 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:09,438 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:09,465 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:10,142 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:10,169 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:10,800 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:10,810 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:10,814 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:10,831 INFO     [learner.py:606] ====Pushing takes 0.01963186264038086 s
2021-08-18:16:34:10,866 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:10,876 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:10,877 INFO     [param_server.py:410] Lock worker 1 with localStep 292 , while globalStep is 291

2021-08-18:16:34:11,906 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:11,920 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:12,155 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:12,169 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:12,727 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:12,741 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:13,924 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:13,935 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:14,457 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:14,475 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:14,476 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:14,505 INFO     [learner.py:606] ====Pushing takes 0.028510332107543945 s
2021-08-18:16:34:14,542 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:14,550 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:14,550 INFO     [param_server.py:410] Lock worker 3 with localStep 292 , while globalStep is 291

2021-08-18:16:34:15,260 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:15,285 INFO     [learner.py:606] ====Pushing takes 0.02364349365234375 s
2021-08-18:16:34:15,310 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:15,317 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:15,317 INFO     [param_server.py:381] ====After aggregation in epoch: 291, virtual_clock: 11039.495457408917, top_1: : 67.0539 % (2078.0), top_5: : 100.0 % (3099.0), test loss: 2.9975874644738654, test len: 3099.0
2021-08-18:16:34:15,319 INFO     [param_server.py:410] Lock worker 2 with localStep 292 , while globalStep is 292

2021-08-18:16:34:15,320 INFO     [param_server.py:441] ====Epoch 293 completes 20 clients with loss 246.34051045829747, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:15,320 INFO     [param_server.py:450] ====Start to sample for epoch 293, global virtualClock: 11039.495457408917, round_duration: 57.6461879098304
2021-08-18:16:34:15,321 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:15,633 INFO     [param_server.py:553] For epoch: 293, median_reward: 390.9377888666738, dev: 781.8755777333477
2021-08-18:16:34:16,268 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5454, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:34:16,270 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3907.6838, eval_time 0.5962, test_loss 2.5454, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:34:16,299 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.566, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:34:16,303 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3907.723, eval_time 0.6362, test_loss 4.566, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:34:16,303 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9484, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:34:16,306 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3907.723, eval_time 0.6345, test_loss 2.9484, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:34:16,356 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:34:16,365 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:16,377 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:34:16,379 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:34:16,390 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:16,393 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:17,741 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:17,751 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:18,262 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:18,276 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:18,860 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:18,869 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:19,546 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:19,556 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:20,835 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:20,856 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:20,913 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:20,924 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:21,67 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:21,78 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:21,691 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:21,718 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:21,793 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:21,804 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:22,618 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:22,652 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:23,323 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:23,357 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:23,689 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:23,702 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:24,29 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:24,49 INFO     [learner.py:606] ====Pushing takes 0.018486738204956055 s
2021-08-18:16:34:24,85 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:24,93 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:24,93 INFO     [param_server.py:410] Lock worker 1 with localStep 293 , while globalStep is 292

2021-08-18:16:34:24,512 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:24,530 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:25,11 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:25,25 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:25,129 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:25,143 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:26,274 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:26,285 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:26,896 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:26,923 INFO     [learner.py:606] ====Pushing takes 0.025490760803222656 s
2021-08-18:16:34:26,954 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:26,962 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:26,963 INFO     [param_server.py:410] Lock worker 3 with localStep 293 , while globalStep is 292

2021-08-18:16:34:27,466 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:27,484 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:28,171 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:28,197 INFO     [learner.py:606] ====Pushing takes 0.02441716194152832 s
2021-08-18:16:34:28,226 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:28,237 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:28,238 INFO     [param_server.py:381] ====After aggregation in epoch: 292, virtual_clock: 11097.141645318747, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 3.3532910512553316, test len: 3099.0
2021-08-18:16:34:28,241 INFO     [param_server.py:410] Lock worker 2 with localStep 293 , while globalStep is 293

2021-08-18:16:34:28,241 INFO     [param_server.py:441] ====Epoch 294 completes 20 clients with loss 223.36795418236025, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:28,242 INFO     [param_server.py:450] ====Start to sample for epoch 294, global virtualClock: 11097.141645318747, round_duration: 57.6461879098304
2021-08-18:16:34:28,243 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:28,584 INFO     [param_server.py:553] For epoch: 294, median_reward: 418.9509278180337, dev: 837.9018556360674
2021-08-18:16:34:29,238 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2544, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:34:29,239 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3920.6588, eval_time 0.631, test_loss 3.2544, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:34:29,241 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8623, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:34:29,241 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1311, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:34:29,242 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3920.6589, eval_time 0.6302, test_loss 2.8623, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:34:29,242 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3920.6561, eval_time 0.628, test_loss 3.1311, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:34:29,310 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:29,313 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:29,319 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:29,322 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:29,338 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:29,347 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:30,340 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:30,349 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:30,962 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:30,974 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:31,948 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:31,957 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:32,50 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:32,60 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:33,101 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:33,127 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:33,655 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:33,666 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:34,58 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:34,92 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:34,248 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:34,260 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:34,829 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:34,839 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:34,865 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:34,899 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:35,583 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:35,623 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:36,252 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:36,271 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:36,319 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:36,341 INFO     [learner.py:606] ====Pushing takes 0.02027153968811035 s
2021-08-18:16:34:36,376 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:36,384 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:36,385 INFO     [param_server.py:410] Lock worker 1 with localStep 294 , while globalStep is 293

2021-08-18:16:34:37,490 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:37,509 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:37,696 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:37,716 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:38,234 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:38,255 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:39,563 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:39,576 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:40,212 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:40,256 INFO     [learner.py:606] ====Pushing takes 0.04201340675354004 s
2021-08-18:16:34:40,287 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:40,296 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:40,298 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:40,305 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:40,306 INFO     [param_server.py:410] Lock worker 3 with localStep 294 , while globalStep is 293

2021-08-18:16:34:40,935 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:40,961 INFO     [learner.py:606] ====Pushing takes 0.02453470230102539 s
2021-08-18:16:34:40,987 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:40,994 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:40,995 INFO     [param_server.py:381] ====After aggregation in epoch: 293, virtual_clock: 11154.787833228576, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 3.082613159109045, test len: 3099.0
2021-08-18:16:34:40,997 INFO     [param_server.py:410] Lock worker 2 with localStep 294 , while globalStep is 294

2021-08-18:16:34:40,998 INFO     [param_server.py:441] ====Epoch 295 completes 20 clients with loss 215.5842687742617, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:40,998 INFO     [param_server.py:450] ====Start to sample for epoch 295, global virtualClock: 11154.787833228576, round_duration: 57.6461879098304
2021-08-18:16:34:40,999 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:41,351 INFO     [param_server.py:553] For epoch: 295, median_reward: 413.23272656955015, dev: 826.4654531391003
2021-08-18:16:34:42,13 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2481, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:34:42,14 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3933.4342, eval_time 0.6502, test_loss 3.2481, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:34:42,21 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.537, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:34:42,21 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8842, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:34:42,23 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3933.44, eval_time 0.6574, test_loss 3.537, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:34:42,23 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3933.4372, eval_time 0.6575, test_loss 2.8842, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:34:42,75 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:42,82 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:42,94 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:42,103 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:42,119 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:42,128 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:43,189 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:43,199 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:43,762 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:43,772 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:44,764 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:44,778 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:45,2 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:45,16 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:46,401 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:46,430 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:46,438 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:46,447 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:47,221 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:47,232 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:47,242 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:47,282 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:47,803 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:47,813 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:48,72 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:48,112 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:48,888 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:48,928 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:49,470 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:49,477 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:49,493 INFO     [learner.py:606] ====Pushing takes 0.021160602569580078 s
2021-08-18:16:34:49,504 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:49,531 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:49,541 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:49,542 INFO     [param_server.py:410] Lock worker 1 with localStep 295 , while globalStep is 294

2021-08-18:16:34:50,541 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:50,560 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:50,780 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:50,794 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:51,399 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:51,413 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:52,516 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:52,525 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:53,76 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:53,88 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:53,100 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:53,106 INFO     [learner.py:606] ====Pushing takes 0.02760028839111328 s
2021-08-18:16:34:53,140 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:53,148 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:53,149 INFO     [param_server.py:410] Lock worker 3 with localStep 295 , while globalStep is 294

2021-08-18:16:34:53,769 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:53,792 INFO     [learner.py:606] ====Pushing takes 0.02228832244873047 s
2021-08-18:16:34:53,818 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:53,825 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:53,826 INFO     [param_server.py:381] ====After aggregation in epoch: 294, virtual_clock: 11212.434021138406, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.223095518571359, test len: 3099.0
2021-08-18:16:34:53,829 INFO     [param_server.py:410] Lock worker 2 with localStep 295 , while globalStep is 295

2021-08-18:16:34:53,829 INFO     [param_server.py:441] ====Epoch 296 completes 20 clients with loss 163.10083567401009, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:53,830 INFO     [param_server.py:450] ====Start to sample for epoch 296, global virtualClock: 11212.434021138406, round_duration: 57.6461879098304
2021-08-18:16:34:53,831 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:54,174 INFO     [param_server.py:553] For epoch: 296, median_reward: 396.5098056379203, dev: 793.0196112758406
2021-08-18:16:34:54,805 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7878, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:34:54,805 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0067, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:34:54,805 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3946.2226, eval_time 0.6168, test_loss 2.7878, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:34:54,806 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3946.2253, eval_time 0.6196, test_loss 3.0067, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:34:54,810 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9333, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:34:54,811 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3946.2254, eval_time 0.622, test_loss 2.9333, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:34:54,876 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:34:54,876 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:34:54,885 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:54,886 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:54,901 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:34:54,911 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:56,136 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:56,151 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:56,575 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:56,585 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:57,524 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:57,535 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:58,164 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:58,184 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:59,335 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:59,337 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:59,356 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:59,371 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:59,765 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:59,776 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:00,362 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:00,380 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:00,473 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:00,513 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:01,310 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:01,337 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:02,74 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:02,101 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:02,415 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:02,430 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:02,643 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:02,664 INFO     [learner.py:606] ====Pushing takes 0.01920032501220703 s
2021-08-18:16:35:02,704 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:02,713 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:02,714 INFO     [param_server.py:410] Lock worker 1 with localStep 296 , while globalStep is 295

2021-08-18:16:35:03,71 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:03,95 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:03,768 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:03,782 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:03,815 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:03,829 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:05,52 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:05,62 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:05,642 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:05,670 INFO     [learner.py:606] ====Pushing takes 0.026851892471313477 s
2021-08-18:16:35:05,699 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:05,707 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:05,708 INFO     [param_server.py:410] Lock worker 3 with localStep 296 , while globalStep is 295

2021-08-18:16:35:06,91 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:06,101 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:06,823 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:06,850 INFO     [learner.py:606] ====Pushing takes 0.024806976318359375 s
2021-08-18:16:35:06,877 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:06,884 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:06,885 INFO     [param_server.py:381] ====After aggregation in epoch: 295, virtual_clock: 11270.080209048236, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 2.9092460296772145, test len: 3099.0
2021-08-18:16:35:06,887 INFO     [param_server.py:410] Lock worker 2 with localStep 296 , while globalStep is 296

2021-08-18:16:35:06,888 INFO     [param_server.py:441] ====Epoch 297 completes 20 clients with loss 252.87114933844754, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:06,888 INFO     [param_server.py:450] ====Start to sample for epoch 297, global virtualClock: 11270.080209048236, round_duration: 57.6461879098304
2021-08-18:16:35:06,889 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:07,233 INFO     [param_server.py:553] For epoch: 297, median_reward: 390.93837120773657, dev: 781.8767424154731
2021-08-18:16:35:07,821 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6526, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:35:07,821 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3959.2355, eval_time 0.5738, test_loss 2.6526, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:35:07,827 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.448, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:35:07,831 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3959.2481, eval_time 0.5848, test_loss 3.448, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:35:07,864 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2819, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:35:07,866 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3959.2858, eval_time 0.6198, test_loss 3.2819, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:35:07,901 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:35:07,911 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:07,926 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:35:07,929 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:35:07,938 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:07,939 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:09,409 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:09,430 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:09,670 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:09,681 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:10,641 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:10,654 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:11,473 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:11,500 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:12,614 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:12,627 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:12,935 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:12,962 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:13,124 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:13,134 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:13,692 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:13,702 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:13,833 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:13,861 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:14,593 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:14,621 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:15,240 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:15,255 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:15,306 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:15,332 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:15,869 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:15,891 INFO     [learner.py:606] ====Pushing takes 0.020506858825683594 s
2021-08-18:16:35:15,929 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:15,940 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:15,941 INFO     [param_server.py:410] Lock worker 1 with localStep 297 , while globalStep is 296

2021-08-18:16:35:16,228 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:16,243 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:16,654 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:16,668 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:16,974 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:16,988 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:18,201 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:18,219 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:18,727 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:18,755 INFO     [learner.py:606] ====Pushing takes 0.02658867835998535 s
2021-08-18:16:35:18,789 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:18,798 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:18,799 INFO     [param_server.py:410] Lock worker 3 with localStep 297 , while globalStep is 296

2021-08-18:16:35:19,50 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:19,63 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:19,786 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:19,809 INFO     [learner.py:606] ====Pushing takes 0.022800922393798828 s
2021-08-18:16:35:19,835 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:19,842 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:19,843 INFO     [param_server.py:381] ====After aggregation in epoch: 296, virtual_clock: 11327.726396958065, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 3.1274795267317033, test len: 3099.0
2021-08-18:16:35:19,845 INFO     [param_server.py:410] Lock worker 2 with localStep 297 , while globalStep is 297

2021-08-18:16:35:19,859 INFO     [param_server.py:441] ====Epoch 298 completes 20 clients with loss 241.33575192241884, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:19,859 INFO     [param_server.py:450] ====Start to sample for epoch 298, global virtualClock: 11327.726396958065, round_duration: 57.6461879098304
2021-08-18:16:35:19,860 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:20,197 INFO     [param_server.py:553] For epoch: 298, median_reward: 417.6092855390978, dev: 835.2185710781956
2021-08-18:16:35:20,845 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0197, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:35:20,846 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3972.2599, eval_time 0.6117, test_loss 3.0197, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:35:20,849 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7765, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:35:20,850 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3972.2671, eval_time 0.6177, test_loss 2.7765, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:35:20,921 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:20,923 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4872, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:35:20,924 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3972.3434, eval_time 0.6921, test_loss 3.4872, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:35:20,929 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:20,937 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:20,948 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:20,994 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:21,17 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:22,552 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:22,573 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:22,872 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:22,899 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:23,618 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:23,632 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:24,415 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:24,434 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:25,707 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:25,735 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:25,790 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:25,800 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:26,75 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:26,84 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:26,682 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:26,709 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:26,823 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:26,833 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:27,378 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:27,405 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:28,91 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:28,118 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:28,599 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:28,614 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:28,707 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:28,731 INFO     [learner.py:606] ====Pushing takes 0.02144002914428711 s
2021-08-18:16:35:28,768 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:28,776 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:28,777 INFO     [param_server.py:410] Lock worker 1 with localStep 298 , while globalStep is 297

2021-08-18:16:35:29,647 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:29,666 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:29,892 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:29,913 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:30,463 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:30,472 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:31,604 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:31,622 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:32,104 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:32,117 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:32,274 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:32,305 INFO     [learner.py:606] ====Pushing takes 0.029939889907836914 s
2021-08-18:16:35:32,336 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:32,344 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:32,345 INFO     [param_server.py:410] Lock worker 3 with localStep 298 , while globalStep is 297

2021-08-18:16:35:32,975 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:33,3 INFO     [learner.py:606] ====Pushing takes 0.024282217025756836 s
2021-08-18:16:35:33,30 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:33,39 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:33,40 INFO     [param_server.py:381] ====After aggregation in epoch: 297, virtual_clock: 11385.372584867895, top_1: : 66.6344 % (2065.0), top_5: : 100.0 % (3099.0), test loss: 3.0944852806903698, test len: 3099.0
2021-08-18:16:35:33,42 INFO     [param_server.py:410] Lock worker 2 with localStep 298 , while globalStep is 298

2021-08-18:16:35:33,42 INFO     [param_server.py:441] ====Epoch 299 completes 20 clients with loss 306.16675975358015, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:33,43 INFO     [param_server.py:450] ====Start to sample for epoch 299, global virtualClock: 11385.372584867895, round_duration: 57.6461879098304
2021-08-18:16:35:33,43 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:33,383 INFO     [param_server.py:553] For epoch: 299, median_reward: 427.36152117754676, dev: 854.7230423550935
2021-08-18:16:35:34,57 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3222, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:35:34,61 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3985.4749, eval_time 0.6472, test_loss 3.3222, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:35:34,89 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9713, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:35:34,90 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3985.5093, eval_time 0.6833, test_loss 2.9713, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:35:34,100 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.068, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:35:34,101 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3985.5182, eval_time 0.6897, test_loss 3.068, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:35:34,151 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:34,161 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:34,162 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:34,176 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:34,177 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:34,192 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:35,422 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:35,431 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:35,938 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:35,949 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:36,703 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:36,714 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:37,254 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:37,268 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:38,618 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:38,629 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:38,751 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:38,778 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:39,125 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:39,135 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:39,754 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:39,780 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:39,788 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:39,789 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:40,651 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:40,684 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:41,293 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:41,312 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:41,323 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:41,350 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:41,933 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:41,955 INFO     [learner.py:606] ====Pushing takes 0.01988053321838379 s
2021-08-18:16:35:41,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:41,996 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:41,997 INFO     [param_server.py:410] Lock worker 1 with localStep 299 , while globalStep is 298

2021-08-18:16:35:42,535 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:42,558 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:42,616 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:42,637 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:43,271 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:43,280 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:44,586 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:44,595 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:45,143 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:45,162 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:45,174 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:45,202 INFO     [learner.py:606] ====Pushing takes 0.02657794952392578 s
2021-08-18:16:35:45,232 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:45,240 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:45,241 INFO     [param_server.py:410] Lock worker 3 with localStep 299 , while globalStep is 298

2021-08-18:16:35:45,955 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:45,979 INFO     [learner.py:606] ====Pushing takes 0.023218154907226562 s
2021-08-18:16:35:46,5 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:46,12 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:46,12 INFO     [param_server.py:381] ====After aggregation in epoch: 298, virtual_clock: 11443.018772777725, top_1: : 66.9894 % (2076.0), top_5: : 100.0 % (3099.0), test loss: 3.1204939418368873, test len: 3099.0
2021-08-18:16:35:46,15 INFO     [param_server.py:410] Lock worker 2 with localStep 299 , while globalStep is 299

2021-08-18:16:35:46,16 INFO     [param_server.py:441] ====Epoch 300 completes 20 clients with loss 186.2498333967184, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:46,17 INFO     [param_server.py:450] ====Start to sample for epoch 300, global virtualClock: 11443.018772777725, round_duration: 57.6461879098304
2021-08-18:16:35:46,18 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:46,290 INFO     [param_server.py:553] For epoch: 300, median_reward: 395.9814201864279, dev: 791.9628403728558
2021-08-18:16:35:46,966 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1536, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:35:46,967 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3998.3845, eval_time 0.6512, test_loss 3.1536, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:35:46,969 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1425, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:35:46,969 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2212, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:35:46,970 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3998.3843, eval_time 0.6538, test_loss 3.1425, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:35:46,970 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3998.39, eval_time 0.6564, test_loss 3.2212, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:35:47,38 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:47,41 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:47,46 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:47,49 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:47,61 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:47,71 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:48,351 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:48,369 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:48,833 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:48,843 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:49,695 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:49,705 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:50,382 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:50,403 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:51,628 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:51,641 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:51,716 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:51,749 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:51,907 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:51,925 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:52,669 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:52,701 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:52,721 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:52,735 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:53,571 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:53,591 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:54,243 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:54,270 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:54,576 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:54,600 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:54,847 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:54,869 INFO     [learner.py:606] ====Pushing takes 0.020277738571166992 s
2021-08-18:16:35:54,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:54,919 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:54,920 INFO     [param_server.py:410] Lock worker 1 with localStep 300 , while globalStep is 299

2021-08-18:16:35:55,543 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:55,569 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:55,976 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:55,990 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:56,231 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:56,241 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:57,363 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:57,372 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:57,890 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:57,920 INFO     [learner.py:606] ====Pushing takes 0.028694868087768555 s
2021-08-18:16:35:57,955 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:57,963 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:57,964 INFO     [param_server.py:410] Lock worker 3 with localStep 300 , while globalStep is 299

2021-08-18:16:35:58,445 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:58,460 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:59,136 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:59,161 INFO     [learner.py:606] ====Pushing takes 0.02454543113708496 s
2021-08-18:16:35:59,188 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:59,196 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:59,196 INFO     [param_server.py:381] ====After aggregation in epoch: 299, virtual_clock: 11500.664960687554, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 3.1724251376258006, test len: 3099.0
2021-08-18:16:35:59,199 INFO     [param_server.py:410] Lock worker 2 with localStep 300 , while globalStep is 300

2021-08-18:16:35:59,200 INFO     [param_server.py:441] ====Epoch 301 completes 20 clients with loss 186.07491100515992, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:59,200 INFO     [param_server.py:450] ====Start to sample for epoch 301, global virtualClock: 11500.664960687554, round_duration: 57.6461879098304
2021-08-18:16:35:59,201 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:59,554 INFO     [param_server.py:541] Handle Wight 0.03168916702270508 | Send 0.3536374568939209
2021-08-18:16:35:59,555 INFO     [param_server.py:553] For epoch: 301, median_reward: 413.1785992748143, dev: 826.3571985496286
2021-08-18:16:36:00,226 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3474, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:36:00,227 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4011.6439, eval_time 0.6592, test_loss 3.3474, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:36:00,229 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6847, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:36:00,230 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4011.6443, eval_time 0.6613, test_loss 2.6847, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:36:00,233 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5366, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:36:00,236 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4011.6555, eval_time 0.6699, test_loss 3.5366, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:36:00,298 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:36:00,306 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:00,306 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:36:00,321 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:00,323 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:36:00,333 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:01,723 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:01,744 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:01,914 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:01,923 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:03,204 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:03,216 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:03,601 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:03,615 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:04,799 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:04,810 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:04,941 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:04,974 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:05,505 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:05,515 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:05,913 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:05,947 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:06,235 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:06,249 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:06,776 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:06,803 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:07,504 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:07,531 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:07,608 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:07,635 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:08,85 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:08,105 INFO     [learner.py:606] ====Pushing takes 0.018731117248535156 s
2021-08-18:16:36:08,149 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:08,157 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:08,158 INFO     [param_server.py:410] Lock worker 1 with localStep 301 , while globalStep is 300

2021-08-18:16:36:08,999 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:09,11 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:09,136 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:09,157 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:09,747 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:09,757 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:11,59 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:11,73 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:11,659 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:11,673 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:11,685 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:11,691 INFO     [learner.py:606] ====Pushing takes 0.03019094467163086 s
2021-08-18:16:36:11,732 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:11,742 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:36:11,743 INFO     [param_server.py:410] Lock worker 3 with localStep 301 , while globalStep is 300

2021-08-18:16:36:12,345 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:12,371 INFO     [learner.py:606] ====Pushing takes 0.0245053768157959 s
2021-08-18:16:36:12,396 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:12,403 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:12,404 INFO     [param_server.py:381] ====After aggregation in epoch: 300, virtual_clock: 11558.311148597384, top_1: : 66.7635 % (2069.0), top_5: : 100.0 % (3099.0), test loss: 3.1895534859763255, test len: 3099.0
2021-08-18:16:36:12,406 INFO     [param_server.py:410] Lock worker 2 with localStep 301 , while globalStep is 301

2021-08-18:16:36:12,407 INFO     [param_server.py:441] ====Epoch 302 completes 20 clients with loss 345.81860381032897, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:12,407 INFO     [param_server.py:450] ====Start to sample for epoch 302, global virtualClock: 11558.311148597384, round_duration: 57.6461879098304
2021-08-18:16:36:12,408 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:12,751 INFO     [param_server.py:553] For epoch: 302, median_reward: 428.0470940442932, dev: 856.0941880885864
2021-08-18:16:36:13,368 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0167, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:36:13,369 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0372, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:36:13,369 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4024.7887, eval_time 0.6053, test_loss 3.0167, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:36:13,370 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4024.7869, eval_time 0.6061, test_loss 3.0372, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:36:13,371 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8043, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:36:13,376 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4024.79, eval_time 0.6116, test_loss 2.8043, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:36:13,429 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:36:13,439 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:13,441 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:36:13,445 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:36:13,451 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:13,454 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:14,823 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:14,837 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:15,177 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:15,193 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:16,142 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:16,153 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:16,730 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:16,757 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:17,742 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:17,755 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:18,84 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:18,118 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:18,407 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:18,416 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:18,989 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:19,7 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:19,102 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:19,136 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:19,861 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:19,895 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:20,607 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:20,634 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:20,736 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:20,755 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:21,210 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:21,232 INFO     [learner.py:606] ====Pushing takes 0.02079629898071289 s
2021-08-18:16:36:21,271 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:21,281 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:21,282 INFO     [param_server.py:410] Lock worker 1 with localStep 302 , while globalStep is 301

2021-08-18:16:36:21,802 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:21,816 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:22,172 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:22,186 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:22,526 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:22,536 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:23,881 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:23,891 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:24,415 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:24,455 INFO     [learner.py:606] ====Pushing takes 0.03896665573120117 s
2021-08-18:16:36:24,495 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:24,503 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:36:24,504 INFO     [param_server.py:410] Lock worker 3 with localStep 302 , while globalStep is 301

2021-08-18:16:36:24,509 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:24,527 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:25,146 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:25,171 INFO     [learner.py:606] ====Pushing takes 0.023810148239135742 s
2021-08-18:16:36:25,196 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:25,203 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:25,204 INFO     [param_server.py:381] ====After aggregation in epoch: 301, virtual_clock: 11615.957336507214, top_1: : 65.5373 % (2031.0), top_5: : 100.0 % (3099.0), test loss: 2.952744903387847, test len: 3099.0
2021-08-18:16:36:25,207 INFO     [param_server.py:410] Lock worker 2 with localStep 302 , while globalStep is 302

2021-08-18:16:36:25,207 INFO     [param_server.py:441] ====Epoch 303 completes 20 clients with loss 129.97496368315745, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:25,208 INFO     [param_server.py:450] ====Start to sample for epoch 303, global virtualClock: 11615.957336507214, round_duration: 57.6461879098304
2021-08-18:16:36:25,208 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:25,518 INFO     [param_server.py:553] For epoch: 303, median_reward: 374.09229691445415, dev: 748.1845938289083
2021-08-18:16:36:26,95 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9214, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:36:26,96 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4037.5132, eval_time 0.5645, test_loss 2.9214, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:36:26,96 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1243, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:36:26,97 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4037.5169, eval_time 0.5673, test_loss 3.1243, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:36:26,102 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6262, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:36:26,103 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4037.5173, eval_time 0.5707, test_loss 2.6262, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:36:26,158 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:26,166 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:26,176 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:26,186 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:26,192 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:26,201 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:27,609 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:27,630 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:27,859 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:27,869 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:28,820 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:28,833 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:29,892 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:29,925 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:30,573 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:30,592 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:31,127 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:31,144 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:31,518 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:31,557 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:31,825 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:31,834 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:32,403 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:32,424 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:33,110 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:33,132 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:33,588 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:33,607 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:33,729 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:33,743 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:34,252 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:34,274 INFO     [learner.py:606] ====Pushing takes 0.01940608024597168 s
2021-08-18:16:36:34,314 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:34,321 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:34,322 INFO     [param_server.py:410] Lock worker 1 with localStep 303 , while globalStep is 302

2021-08-18:16:36:34,563 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:34,573 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:34,897 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:34,911 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:35,194 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:35,203 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:36,353 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:36,362 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:36,918 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:36,947 INFO     [learner.py:606] ====Pushing takes 0.02805328369140625 s
2021-08-18:16:36:36,990 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:36,998 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:36:36,998 INFO     [param_server.py:410] Lock worker 3 with localStep 303 , while globalStep is 302

2021-08-18:16:36:37,343 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:37,357 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:38,85 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:38,111 INFO     [learner.py:606] ====Pushing takes 0.024406909942626953 s
2021-08-18:16:36:38,138 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:38,147 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:38,148 INFO     [param_server.py:381] ====After aggregation in epoch: 302, virtual_clock: 11673.603524417043, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 2.8906081440272153, test len: 3099.0
2021-08-18:16:36:38,150 INFO     [param_server.py:410] Lock worker 2 with localStep 303 , while globalStep is 303

2021-08-18:16:36:38,150 INFO     [param_server.py:441] ====Epoch 304 completes 20 clients with loss 93.29824241139926, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:38,165 INFO     [param_server.py:450] ====Start to sample for epoch 304, global virtualClock: 11673.603524417043, round_duration: 57.6461879098304
2021-08-18:16:36:38,166 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:38,474 INFO     [param_server.py:553] For epoch: 304, median_reward: 397.1210953125148, dev: 794.2421906250296
2021-08-18:16:36:39,54 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9515, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:36:39,56 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4050.4697, eval_time 0.5564, test_loss 2.9515, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:36:39,62 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2017, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:36:39,63 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4050.4803, eval_time 0.5649, test_loss 3.2017, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:36:39,99 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0994, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:36:39,100 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4050.5199, eval_time 0.604, test_loss 3.0994, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:36:39,132 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:39,135 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:39,141 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:39,143 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:39,167 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:39,187 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:40,778 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:40,805 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:40,899 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:40,911 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:41,969 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:41,979 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:42,886 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:42,912 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:43,749 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:43,761 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:43,888 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:43,908 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:44,289 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:44,298 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:44,655 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:44,683 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:44,920 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:44,940 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:45,471 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:45,492 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:46,9 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:46,34 INFO     [learner.py:606] ====Pushing takes 0.02315807342529297 s
2021-08-18:16:36:46,73 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:46,81 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:36:46,81 INFO     [param_server.py:410] Lock worker 1 with localStep 304 , while globalStep is 303

2021-08-18:16:36:46,515 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:46,534 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:47,659 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:47,670 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:47,796 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:47,814 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:48,361 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:48,382 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:49,585 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:49,594 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:50,71 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:50,87 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:50,315 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:50,345 INFO     [learner.py:606] ====Pushing takes 0.027996540069580078 s
2021-08-18:16:36:50,383 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:50,391 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 13 clients
2021-08-18:16:36:50,392 INFO     [param_server.py:410] Lock worker 3 with localStep 304 , while globalStep is 303

2021-08-18:16:36:50,783 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:50,808 INFO     [learner.py:606] ====Pushing takes 0.02398824691772461 s
2021-08-18:16:36:50,834 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:50,841 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:36:50,841 INFO     [param_server.py:381] ====After aggregation in epoch: 303, virtual_clock: 11734.493605733334, top_1: : 67.5379 % (2093.0), top_5: : 100.0 % (3099.0), test loss: 3.08421547766085, test len: 3099.0
2021-08-18:16:36:50,844 INFO     [param_server.py:410] Lock worker 2 with localStep 304 , while globalStep is 304

2021-08-18:16:36:50,845 INFO     [param_server.py:441] ====Epoch 305 completes 19 clients with loss 112.30852672822895, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:50,845 INFO     [param_server.py:450] ====Start to sample for epoch 305, global virtualClock: 11734.493605733334, round_duration: 60.89008131629102
2021-08-18:16:36:50,846 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:51,204 INFO     [param_server.py:553] For epoch: 305, median_reward: 381.6848506560506, dev: 763.3697013121013
2021-08-18:16:36:51,906 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1661, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:36:51,909 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4063.3285, eval_time 0.6717, test_loss 3.1661, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:36:51,943 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2321, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:36:51,943 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4063.3606, eval_time 0.7063, test_loss 3.2321, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:36:51,945 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9081, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:36:51,946 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4063.3598, eval_time 0.7084, test_loss 2.9081, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:36:51,980 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:51,993 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:52,14 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:52,14 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:52,23 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:52,24 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:53,298 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:53,318 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:53,657 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:53,672 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:54,561 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:54,571 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:55,377 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:55,398 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:56,47 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:56,67 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:56,472 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:56,484 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:56,788 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:56,815 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:56,853 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:56,863 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:57,615 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:57,625 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:57,637 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:57,664 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:58,277 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:58,295 INFO     [learner.py:606] ====Pushing takes 0.016699552536010742 s
2021-08-18:16:36:58,328 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:58,337 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:36:58,338 INFO     [param_server.py:410] Lock worker 1 with localStep 305 , while globalStep is 304

2021-08-18:16:36:59,284 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:59,298 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:00,358 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:00,378 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:00,651 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:00,665 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:01,286 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:01,300 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:02,507 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:02,517 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:02,946 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:02,959 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:37:03,57 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:03,89 INFO     [learner.py:606] ====Pushing takes 0.027831077575683594 s
2021-08-18:16:37:03,122 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:03,130 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 13 clients
2021-08-18:16:37:03,131 INFO     [param_server.py:410] Lock worker 3 with localStep 305 , while globalStep is 304

2021-08-18:16:37:03,705 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:37:03,731 INFO     [learner.py:606] ====Pushing takes 0.024655818939208984 s
2021-08-18:16:37:03,757 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:03,764 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:37:03,765 INFO     [param_server.py:381] ====After aggregation in epoch: 304, virtual_clock: 11795.383687049625, top_1: : 64.3756 % (1995.0), top_5: : 100.0 % (3099.0), test loss: 3.1020783406716803, test len: 3099.0
2021-08-18:16:37:03,768 INFO     [param_server.py:410] Lock worker 2 with localStep 305 , while globalStep is 305

2021-08-18:16:37:03,768 INFO     [param_server.py:441] ====Epoch 306 completes 19 clients with loss 114.08171277255289, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:37:03,769 INFO     [param_server.py:450] ====Start to sample for epoch 306, global virtualClock: 11795.383687049625, round_duration: 60.89008131629102
2021-08-18:16:37:03,769 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:37:04,59 INFO     [param_server.py:553] For epoch: 306, median_reward: 365.0183726929669, dev: 730.0367453859338
2021-08-18:16:37:04,623 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5897, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:37:04,624 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4076.041, eval_time 0.54, test_loss 3.5897, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:37:04,631 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1974, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:37:04,632 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4076.0458, eval_time 0.5478, test_loss 3.1974, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:37:04,673 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1212, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:37:04,679 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4076.0991, eval_time 0.598, test_loss 3.1212, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:37:04,698 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:37:04,702 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:37:04,706 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:04,712 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:04,739 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:37:04,753 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:06,169 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:06,189 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:06,493 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:06,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:07,282 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:07,293 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:08,208 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:08,228 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:09,115 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:09,142 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:09,293 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:09,307 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:09,546 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:09,558 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:10,2 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:10,36 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:10,153 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:10,167 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:10,699 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:10,732 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:11,285 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:11,304 INFO     [learner.py:606] ====Pushing takes 0.018575668334960938 s
2021-08-18:16:37:11,339 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:11,346 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:37:11,347 INFO     [param_server.py:410] Lock worker 1 with localStep 306 , while globalStep is 305

2021-08-18:16:37:12,217 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:12,235 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:13,112 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:13,123 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:13,391 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:13,409 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:13,869 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:13,880 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:15,49 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:15,59 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:15,759 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:15,794 INFO     [learner.py:606] ====Pushing takes 0.03384685516357422 s
2021-08-18:16:37:15,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:15,846 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 13 clients
2021-08-18:16:37:15,846 INFO     [param_server.py:410] Lock worker 3 with localStep 306 , while globalStep is 305

2021-08-18:16:37:15,853 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:15,865 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:37:16,605 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:37:16,630 INFO     [learner.py:606] ====Pushing takes 0.023608684539794922 s
2021-08-18:16:37:16,660 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:16,667 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:37:16,667 INFO     [param_server.py:381] ====After aggregation in epoch: 305, virtual_clock: 11856.273768365916, top_1: : 67.0216 % (2077.0), top_5: : 100.0 % (3099.0), test loss: 3.302752715569955, test len: 3099.0
2021-08-18:16:37:16,670 INFO     [param_server.py:410] Lock worker 2 with localStep 306 , while globalStep is 306

2021-08-18:16:37:16,670 INFO     [param_server.py:441] ====Epoch 307 completes 19 clients with loss 177.84494640658872, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:37:16,670 INFO     [param_server.py:450] ====Start to sample for epoch 307, global virtualClock: 11856.273768365916, round_duration: 60.89008131629102
2021-08-18:16:37:16,671 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:37:16,956 INFO     [param_server.py:553] For epoch: 307, median_reward: 375.4210370960652, dev: 750.8420741921304
2021-08-18:16:37:17,604 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0524, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:37:17,605 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4089.0222, eval_time 0.6261, test_loss 3.0524, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:37:17,647 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7408, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:37:17,648 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4089.0626, eval_time 0.6688, test_loss 2.7408, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:37:17,677 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:37:17,689 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9416, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:37:17,690 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4089.1093, eval_time 0.7111, test_loss 2.9416, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:37:17,695 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:17,719 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:37:17,734 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:17,759 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:37:17,779 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:19,84 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:19,105 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:19,504 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:19,515 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:20,697 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:20,715 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:21,59 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:21,80 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:21,829 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:21,850 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:22,140 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:22,152 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:22,644 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:22,670 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:22,876 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:22,887 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:23,403 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:23,430 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:23,781 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:23,795 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:23,988 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:24,8 INFO     [learner.py:606] ====Pushing takes 0.018899202346801758 s
2021-08-18:16:37:24,45 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:24,52 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:37:24,53 INFO     [param_server.py:410] Lock worker 1 with localStep 307 , while globalStep is 306

2021-08-18:16:37:25,66 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:25,78 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:26,431 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:26,451 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:26,563 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:26,574 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:27,167 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:27,177 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:28,469 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:28,483 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:29,127 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:29,138 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:29,145 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:37:29,168 INFO     [learner.py:606] ====Pushing takes 0.028397083282470703 s
2021-08-18:16:37:29,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:29,211 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 13 clients
2021-08-18:16:37:29,211 INFO     [param_server.py:410] Lock worker 3 with localStep 307 , while globalStep is 306

2021-08-18:16:37:29,796 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:37:29,823 INFO     [learner.py:606] ====Pushing takes 0.025368213653564453 s
2021-08-18:16:37:29,858 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:29,865 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:37:29,866 INFO     [param_server.py:381] ====After aggregation in epoch: 306, virtual_clock: 11917.163849682207, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 2.9116127148822506, test len: 3099.0
2021-08-18:16:37:29,868 INFO     [param_server.py:410] Lock worker 2 with localStep 307 , while globalStep is 307

2021-08-18:16:37:29,868 INFO     [param_server.py:441] ====Epoch 308 completes 19 clients with loss 249.84378120108613, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:37:29,869 INFO     [param_server.py:450] ====Start to sample for epoch 308, global virtualClock: 11917.163849682207, round_duration: 60.89008131629102
2021-08-18:16:37:29,870 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:30,218 INFO     [param_server.py:553] For epoch: 308, median_reward: 420.197664680133, dev: 840.395329360266
2021-08-18:16:37:30,917 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5833, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:37:30,918 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4102.3353, eval_time 0.6746, test_loss 3.5833, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:37:30,947 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7976, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:37:30,948 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0592, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:37:30,949 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4102.3684, eval_time 0.7068, test_loss 3.0592, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:37:30,948 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4102.3626, eval_time 0.7044, test_loss 2.7976, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:37:30,987 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:31,1 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:31,8 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:31,19 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:31,21 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:31,34 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:32,518 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:32,539 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:32,844 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:32,853 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:33,779 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:33,788 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:34,756 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:34,777 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:35,566 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:35,585 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:35,598 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:35,618 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:35,992 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:36,1 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:36,288 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:36,314 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:36,874 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:36,895 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:37,49 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:37,83 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:37,696 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:37,716 INFO     [learner.py:606] ====Pushing takes 0.018915653228759766 s
2021-08-18:16:37:37,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:37,764 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:37,765 INFO     [param_server.py:410] Lock worker 1 with localStep 308 , while globalStep is 307

2021-08-18:16:37:38,253 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:38,272 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:39,685 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:39,704 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:39,765 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:39,779 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:40,563 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:40,577 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:42,338 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:42,347 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:42,348 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:42,375 INFO     [learner.py:606] ====Pushing takes 0.025728702545166016 s
2021-08-18:16:37:42,405 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:42,412 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:37:42,413 INFO     [param_server.py:410] Lock worker 2 with localStep 308 , while globalStep is 307

2021-08-18:16:37:42,973 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:43,2 INFO     [learner.py:606] ====Pushing takes 0.027690649032592773 s
2021-08-18:16:37:43,31 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:43,39 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:37:43,40 INFO     [param_server.py:381] ====After aggregation in epoch: 307, virtual_clock: 11981.29782440496, top_1: : 67.7638 % (2100.0), top_5: : 100.0 % (3099.0), test loss: 3.146688523115935, test len: 3099.0
2021-08-18:16:37:43,42 INFO     [param_server.py:410] Lock worker 3 with localStep 308 , while globalStep is 308

2021-08-18:16:37:43,43 INFO     [param_server.py:441] ====Epoch 309 completes 18 clients with loss 157.18793711696276, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:37:43,43 INFO     [param_server.py:450] ====Start to sample for epoch 309, global virtualClock: 11981.29782440496, round_duration: 64.13397472275163
2021-08-18:16:37:43,44 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:43,385 INFO     [param_server.py:553] For epoch: 309, median_reward: 416.52495480970896, dev: 833.0499096194179
2021-08-18:16:37:44,36 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5468, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:37:44,37 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4115.4514, eval_time 0.6378, test_loss 3.5468, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:37:44,38 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9083, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:37:44,40 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4115.4599, eval_time 0.6428, test_loss 2.9083, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:37:44,50 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.151, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:37:44,51 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4115.4682, eval_time 0.6517, test_loss 3.151, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:37:44,105 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:44,107 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:44,113 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:44,120 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:44,124 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:44,129 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:45,601 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:45,622 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:45,961 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:45,971 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:46,897 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:46,907 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:47,786 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:47,813 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:48,536 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:48,554 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:48,695 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:48,722 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:49,437 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:49,457 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:49,573 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:49,606 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:50,334 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:50,335 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:50,348 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:50,355 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:50,842 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:50,862 INFO     [learner.py:606] ====Pushing takes 0.01793503761291504 s
2021-08-18:16:37:50,899 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:50,906 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:50,907 INFO     [param_server.py:410] Lock worker 1 with localStep 309 , while globalStep is 308

2021-08-18:16:37:51,293 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:51,372 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:52,673 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:52,692 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:52,844 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:52,854 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:53,604 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:53,617 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:55,102 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:55,128 INFO     [learner.py:606] ====Pushing takes 0.02444934844970703 s
2021-08-18:16:37:55,153 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:55,161 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:37:55,161 INFO     [param_server.py:410] Lock worker 2 with localStep 309 , while globalStep is 308

2021-08-18:16:37:55,353 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:55,364 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:56,46 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:56,78 INFO     [learner.py:606] ====Pushing takes 0.030501365661621094 s
2021-08-18:16:37:56,111 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:56,119 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:37:56,120 INFO     [param_server.py:381] ====After aggregation in epoch: 308, virtual_clock: 12045.431799127711, top_1: : 64.6015 % (2002.0), top_5: : 100.0 % (3099.0), test loss: 3.202029582526949, test len: 3099.0
2021-08-18:16:37:56,124 INFO     [param_server.py:410] Lock worker 3 with localStep 309 , while globalStep is 309

2021-08-18:16:37:56,124 INFO     [param_server.py:441] ====Epoch 310 completes 18 clients with loss 98.21871795045419, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:37:56,125 INFO     [param_server.py:450] ====Start to sample for epoch 310, global virtualClock: 12045.431799127711, round_duration: 64.13397472275163
2021-08-18:16:37:56,126 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:56,472 INFO     [param_server.py:553] For epoch: 310, median_reward: 386.3280501715626, dev: 772.6561003431252
2021-08-18:16:37:57,88 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.158, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:37:57,88 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4128.5081, eval_time 0.5934, test_loss 3.158, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:37:57,110 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.261, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:37:57,111 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4128.5255, eval_time 0.614, test_loss 3.261, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:37:57,112 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0827, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:37:57,112 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4128.5295, eval_time 0.6148, test_loss 3.0827, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:37:57,148 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:37:57,170 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:57,183 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:37:57,185 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:37:57,192 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:57,194 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:58,762 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:58,789 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:58,960 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:58,969 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:00,117 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:00,135 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:00,962 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:00,990 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:01,459 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:01,470 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:01,740 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:01,761 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:02,537 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:02,546 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:02,652 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:02,679 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:03,221 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:03,232 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:03,333 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:03,351 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:03,913 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:03,941 INFO     [learner.py:606] ====Pushing takes 0.025603532791137695 s
2021-08-18:16:38:03,977 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:03,985 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:03,985 INFO     [param_server.py:410] Lock worker 1 with localStep 310 , while globalStep is 309

2021-08-18:16:38:04,306 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:04,326 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:05,508 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:05,522 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:05,686 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:05,697 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:06,329 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:06,338 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:07,900 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:07,919 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:08,29 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:08,53 INFO     [learner.py:606] ====Pushing takes 0.0221097469329834 s
2021-08-18:16:38:08,82 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:08,88 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:08,89 INFO     [param_server.py:410] Lock worker 2 with localStep 310 , while globalStep is 309

2021-08-18:16:38:08,708 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:08,737 INFO     [learner.py:606] ====Pushing takes 0.02797245979309082 s
2021-08-18:16:38:08,767 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:08,774 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:08,775 INFO     [param_server.py:381] ====After aggregation in epoch: 309, virtual_clock: 12109.565773850463, top_1: : 67.2152 % (2083.0), top_5: : 100.0 % (3099.0), test loss: 3.1672585098831743, test len: 3099.0
2021-08-18:16:38:08,777 INFO     [param_server.py:410] Lock worker 3 with localStep 310 , while globalStep is 310

2021-08-18:16:38:08,777 INFO     [param_server.py:441] ====Epoch 311 completes 18 clients with loss 103.85963807331895, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:08,778 INFO     [param_server.py:450] ====Start to sample for epoch 311, global virtualClock: 12109.565773850463, round_duration: 64.13397472275163
2021-08-18:16:38:08,779 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:09,126 INFO     [param_server.py:553] For epoch: 311, median_reward: 381.01288984786277, dev: 762.0257796957255
2021-08-18:16:38:09,780 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3968, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:38:09,781 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4141.1985, eval_time 0.6308, test_loss 3.3968, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:38:09,820 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7158, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:38:09,821 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4141.2349, eval_time 0.666, test_loss 3.7158, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:38:09,821 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1781, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:38:09,822 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4141.2418, eval_time 0.6715, test_loss 3.1781, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:38:09,852 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:38:09,860 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:09,892 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:38:09,892 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:38:09,907 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:09,907 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:11,660 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:11,680 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:11,717 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:11,726 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:12,704 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:12,715 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:13,660 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:13,681 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:14,218 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:14,228 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:14,448 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:14,468 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:15,48 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:15,57 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:15,211 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:15,231 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:15,913 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:15,924 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:15,963 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:15,984 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:16,653 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:16,675 INFO     [learner.py:606] ====Pushing takes 0.02024984359741211 s
2021-08-18:16:38:16,710 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:16,720 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:16,721 INFO     [param_server.py:410] Lock worker 1 with localStep 311 , while globalStep is 310

2021-08-18:16:38:17,80 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:17,91 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:18,402 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:18,420 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:18,573 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:18,592 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:19,390 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:19,404 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:20,796 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:20,819 INFO     [learner.py:606] ====Pushing takes 0.020975112915039062 s
2021-08-18:16:38:20,842 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:20,848 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:20,849 INFO     [param_server.py:410] Lock worker 2 with localStep 311 , while globalStep is 310

2021-08-18:16:38:21,178 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:21,193 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:21,847 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:21,877 INFO     [learner.py:606] ====Pushing takes 0.029268980026245117 s
2021-08-18:16:38:21,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:21,915 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:21,916 INFO     [param_server.py:381] ====After aggregation in epoch: 310, virtual_clock: 12173.699748573215, top_1: : 63.8593 % (1979.0), top_5: : 100.0 % (3099.0), test loss: 3.4302041574760715, test len: 3099.0
2021-08-18:16:38:21,918 INFO     [param_server.py:410] Lock worker 3 with localStep 311 , while globalStep is 311

2021-08-18:16:38:21,919 INFO     [param_server.py:441] ====Epoch 312 completes 18 clients with loss 82.24772847455786, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:21,919 INFO     [param_server.py:450] ====Start to sample for epoch 312, global virtualClock: 12173.699748573215, round_duration: 64.13397472275163
2021-08-18:16:38:21,919 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:22,207 INFO     [param_server.py:553] For epoch: 312, median_reward: 390.21149504641016, dev: 780.4229900928203
2021-08-18:16:38:22,780 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2135, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:38:22,783 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4154.2023, eval_time 0.5638, test_loss 3.2135, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:38:22,793 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0689, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:38:22,794 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4154.2108, eval_time 0.5707, test_loss 3.0689, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:38:22,794 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2177, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:38:22,795 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4154.209, eval_time 0.5714, test_loss 3.2177, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:38:22,849 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:22,858 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:22,861 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:22,872 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:22,870 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:22,883 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:24,363 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:24,384 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:24,601 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:24,613 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:25,458 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:25,468 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:26,495 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:26,522 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:27,289 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:27,302 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:27,407 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:27,434 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:27,718 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:27,733 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:28,210 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:28,230 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:28,641 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:28,659 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:28,749 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:28,763 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:29,312 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:29,335 INFO     [learner.py:606] ====Pushing takes 0.02187967300415039 s
2021-08-18:16:38:29,375 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:29,383 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:29,383 INFO     [param_server.py:410] Lock worker 1 with localStep 312 , while globalStep is 311

2021-08-18:16:38:30,178 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:30,190 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:31,444 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:31,459 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:31,515 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:31,533 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:32,147 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:32,156 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:33,851 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:33,871 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:34,70 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:34,95 INFO     [learner.py:606] ====Pushing takes 0.02318572998046875 s
2021-08-18:16:38:34,119 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:34,128 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:34,128 INFO     [param_server.py:410] Lock worker 2 with localStep 312 , while globalStep is 311

2021-08-18:16:38:34,585 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:34,615 INFO     [learner.py:606] ====Pushing takes 0.02872633934020996 s
2021-08-18:16:38:34,649 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:34,656 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:34,670 INFO     [param_server.py:381] ====After aggregation in epoch: 311, virtual_clock: 12237.833723295968, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.166692627800835, test len: 3099.0
2021-08-18:16:38:34,673 INFO     [param_server.py:410] Lock worker 3 with localStep 312 , while globalStep is 312

2021-08-18:16:38:34,674 INFO     [param_server.py:441] ====Epoch 313 completes 18 clients with loss 187.92128597236115, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:34,674 INFO     [param_server.py:450] ====Start to sample for epoch 313, global virtualClock: 12237.833723295968, round_duration: 64.13397472275163
2021-08-18:16:38:34,675 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:35,67 INFO     [param_server.py:553] For epoch: 313, median_reward: 413.34480860456347, dev: 826.6896172091269
2021-08-18:16:38:35,652 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0235, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:38:35,656 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2261, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:38:35,657 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4167.0738, eval_time 0.5664, test_loss 3.2261, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:38:35,653 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4167.0675, eval_time 0.5612, test_loss 3.0235, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:38:35,683 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2801, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:38:35,683 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4167.1032, eval_time 0.5932, test_loss 3.2801, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:38:35,737 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:35,745 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:35,745 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:35,752 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:35,754 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:35,766 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:37,237 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:37,264 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:37,424 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:37,433 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:38,455 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:38,473 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:39,501 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:39,528 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:40,288 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:40,316 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:40,352 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:40,370 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:41,91 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:41,100 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:41,105 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:41,127 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:41,750 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:41,777 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:41,842 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:41,869 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:42,430 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:42,452 INFO     [learner.py:606] ====Pushing takes 0.020224332809448242 s
2021-08-18:16:38:42,488 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:42,495 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:42,496 INFO     [param_server.py:410] Lock worker 1 with localStep 313 , while globalStep is 312

2021-08-18:16:38:43,281 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:43,292 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:44,460 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:44,470 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:44,579 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:44,597 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:45,106 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:45,116 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:46,752 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:46,772 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:47,165 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:47,189 INFO     [learner.py:606] ====Pushing takes 0.022110700607299805 s
2021-08-18:16:38:47,214 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:47,220 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:47,220 INFO     [param_server.py:410] Lock worker 2 with localStep 313 , while globalStep is 312

2021-08-18:16:38:47,550 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:47,579 INFO     [learner.py:606] ====Pushing takes 0.026983022689819336 s
2021-08-18:16:38:47,611 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:47,619 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:47,620 INFO     [param_server.py:381] ====After aggregation in epoch: 312, virtual_clock: 12301.96769801872, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 3.1765789764898797, test len: 3099.0
2021-08-18:16:38:47,623 INFO     [param_server.py:410] Lock worker 3 with localStep 313 , while globalStep is 313

2021-08-18:16:38:47,623 INFO     [param_server.py:441] ====Epoch 314 completes 18 clients with loss 298.51719130879394, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:47,624 INFO     [param_server.py:450] ====Start to sample for epoch 314, global virtualClock: 12301.96769801872, round_duration: 64.13397472275163
2021-08-18:16:38:47,624 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:47,912 INFO     [param_server.py:553] For epoch: 314, median_reward: 446.9966544142225, dev: 893.993308828445
2021-08-18:16:38:48,449 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9635, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:38:48,450 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4179.8696, eval_time 0.5159, test_loss 2.9635, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:38:48,466 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8636, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:38:48,467 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4179.8811, eval_time 0.5284, test_loss 2.8636, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:38:48,469 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2657, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:38:48,469 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4179.8865, eval_time 0.531, test_loss 3.2657, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:38:48,522 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:48,531 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:48,537 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:48,545 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:48,563 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:48,571 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:49,877 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:49,904 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:50,268 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:50,279 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:51,439 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:51,453 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:52,127 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:52,147 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:52,821 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:52,842 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:52,979 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:52,998 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:53,594 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:53,608 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:53,665 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:53,686 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:54,202 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:54,212 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:54,450 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:54,470 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:55,25 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:55,47 INFO     [learner.py:606] ====Pushing takes 0.020224809646606445 s
2021-08-18:16:38:55,90 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:55,100 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:55,101 INFO     [param_server.py:410] Lock worker 1 with localStep 314 , while globalStep is 313

2021-08-18:16:38:55,866 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:55,879 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:56,903 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:56,917 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:57,78 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:57,89 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:57,753 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:57,767 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:59,458 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:59,485 INFO     [learner.py:606] ====Pushing takes 0.02340841293334961 s
2021-08-18:16:38:59,520 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:59,527 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:59,527 INFO     [param_server.py:410] Lock worker 2 with localStep 314 , while globalStep is 313

2021-08-18:16:38:59,563 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:59,577 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:00,279 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:00,320 INFO     [learner.py:606] ====Pushing takes 0.03968310356140137 s
2021-08-18:16:39:00,352 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:00,360 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:39:00,360 INFO     [param_server.py:381] ====After aggregation in epoch: 313, virtual_clock: 12366.101672741472, top_1: : 64.6015 % (2002.0), top_5: : 100.0 % (3099.0), test loss: 3.0309221016036143, test len: 3099.0
2021-08-18:16:39:00,363 INFO     [param_server.py:410] Lock worker 3 with localStep 314 , while globalStep is 314

2021-08-18:16:39:00,363 INFO     [param_server.py:441] ====Epoch 315 completes 18 clients with loss 189.60669901364727, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:39:00,364 INFO     [param_server.py:450] ====Start to sample for epoch 315, global virtualClock: 12366.101672741472, round_duration: 64.13397472275163
2021-08-18:16:39:00,364 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:00,722 INFO     [param_server.py:553] For epoch: 315, median_reward: 405.3608929856039, dev: 810.7217859712079
2021-08-18:16:39:01,440 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7843, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:39:01,443 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4192.8626, eval_time 0.6984, test_loss 3.7843, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:39:01,444 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.825, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:39:01,445 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4192.8593, eval_time 0.696, test_loss 2.825, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:39:01,484 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9786, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:39:01,484 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4192.9014, eval_time 0.7375, test_loss 2.9786, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:39:01,509 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:39:01,510 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:39:01,521 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:01,524 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:01,564 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:39:01,577 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:02,877 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:02,898 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:03,330 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:03,342 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:04,245 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:04,256 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:04,877 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:04,904 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:05,771 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:05,799 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:06,202 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:06,220 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:39:06,612 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:06,623 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:06,653 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:06,680 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:07,421 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:07,460 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:07,474 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:07,490 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:08,74 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:08,103 INFO     [learner.py:606] ====Pushing takes 0.024518251419067383 s
2021-08-18:16:39:08,140 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:08,148 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:39:08,149 INFO     [param_server.py:410] Lock worker 1 with localStep 315 , while globalStep is 314

2021-08-18:16:39:09,228 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:39:09,240 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:10,368 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:10,377 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:10,332 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:10,412 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:11,253 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:11,267 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:12,975 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:12,984 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:13,59 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:13,82 INFO     [learner.py:606] ====Pushing takes 0.021918773651123047 s
2021-08-18:16:39:13,112 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:13,120 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:39:13,121 INFO     [param_server.py:410] Lock worker 2 with localStep 315 , while globalStep is 314

2021-08-18:16:39:13,689 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:13,731 INFO     [learner.py:606] ====Pushing takes 0.04088187217712402 s
2021-08-18:16:39:13,765 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:13,773 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:39:13,773 INFO     [param_server.py:381] ====After aggregation in epoch: 314, virtual_clock: 12430.235647464224, top_1: : 66.7635 % (2069.0), top_5: : 100.0 % (3099.0), test loss: 3.1959990748652705, test len: 3099.0
2021-08-18:16:39:13,776 INFO     [param_server.py:410] Lock worker 3 with localStep 315 , while globalStep is 315

2021-08-18:16:39:13,777 INFO     [param_server.py:441] ====Epoch 316 completes 18 clients with loss 175.28002240068292, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:39:13,777 INFO     [param_server.py:450] ====Start to sample for epoch 316, global virtualClock: 12430.235647464224, round_duration: 64.13397472275163
2021-08-18:16:39:13,778 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:14,139 INFO     [param_server.py:553] For epoch: 316, median_reward: 409.93729502398827, dev: 819.8745900479765
2021-08-18:16:39:14,685 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9391, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:39:14,686 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4206.1057, eval_time 0.5322, test_loss 3.9391, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:39:14,779 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:39:14,792 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:14,817 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9839, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:39:14,818 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4206.2318, eval_time 0.662, test_loss 2.9839, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:39:14,823 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1452, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:39:14,824 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4206.2411, eval_time 0.6703, test_loss 3.1452, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:39:14,887 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:39:14,896 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:39:14,898 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:14,904 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:16,214 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:16,241 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:16,992 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:17,4 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:17,536 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:17,550 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:18,852 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:18,873 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:19,605 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:19,625 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:19,904 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:19,925 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:20,34 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:20,55 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:20,363 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:20,383 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:20,677 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:20,697 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:21,30 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:21,44 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:21,407 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:21,417 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:21,562 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:21,583 INFO     [learner.py:606] ====Pushing takes 0.02026987075805664 s
2021-08-18:16:39:21,623 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:21,631 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:21,632 INFO     [param_server.py:410] Lock worker 1 with localStep 316 , while globalStep is 315

2021-08-18:16:39:23,593 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:23,610 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:23,806 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:23,824 INFO     [learner.py:606] ====Pushing takes 0.017014265060424805 s
2021-08-18:16:39:23,843 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:23,848 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:23,849 INFO     [param_server.py:410] Lock worker 2 with localStep 316 , while globalStep is 315

2021-08-18:16:39:24,354 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:24,364 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:26,78 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:26,93 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:26,845 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:26,874 INFO     [learner.py:606] ====Pushing takes 0.02703714370727539 s
2021-08-18:16:39:26,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:26,924 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:26,925 INFO     [param_server.py:381] ====After aggregation in epoch: 315, virtual_clock: 12497.613515593435, top_1: : 64.0529 % (1985.0), top_5: : 100.0 % (3099.0), test loss: 3.3560730616251626, test len: 3099.0
2021-08-18:16:39:26,928 INFO     [param_server.py:410] Lock worker 3 with localStep 316 , while globalStep is 316

2021-08-18:16:39:26,928 INFO     [param_server.py:441] ====Epoch 317 completes 17 clients with loss 177.46674109454395, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:26,929 INFO     [param_server.py:450] ====Start to sample for epoch 317, global virtualClock: 12497.613515593435, round_duration: 67.37786812921225
2021-08-18:16:39:26,930 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:27,261 INFO     [param_server.py:553] For epoch: 317, median_reward: 420.51545477429676, dev: 841.0309095485935
2021-08-18:16:39:27,872 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4478, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:39:27,873 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4219.2901, eval_time 0.5897, test_loss 3.4478, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:39:27,910 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7399, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:39:27,913 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4219.3274, eval_time 0.6219, test_loss 2.7399, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:39:27,942 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:27,947 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.199, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:39:27,948 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4219.3677, eval_time 0.6646, test_loss 3.199, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:39:27,956 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:27,980 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:27,995 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:28,40 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:28,57 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:29,475 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:29,495 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:30,75 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:30,92 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:30,726 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:30,746 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:32,49 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:32,76 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:32,829 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:32,850 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:33,81 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:33,95 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:33,229 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:33,240 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:33,539 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:33,553 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:34,111 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:34,121 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:34,207 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:34,226 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:34,286 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:34,295 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:34,744 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:34,765 INFO     [learner.py:606] ====Pushing takes 0.019704818725585938 s
2021-08-18:16:39:34,803 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:34,814 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:34,814 INFO     [param_server.py:410] Lock worker 1 with localStep 317 , while globalStep is 316

2021-08-18:16:39:36,687 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:36,703 INFO     [learner.py:606] ====Pushing takes 0.014684677124023438 s
2021-08-18:16:39:36,721 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:36,726 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:36,727 INFO     [param_server.py:410] Lock worker 2 with localStep 317 , while globalStep is 316

2021-08-18:16:39:36,790 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:36,808 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:37,655 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:37,669 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:39,321 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:39,333 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:39,988 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:40,17 INFO     [learner.py:606] ====Pushing takes 0.027481555938720703 s
2021-08-18:16:39:40,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:40,61 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:40,62 INFO     [param_server.py:381] ====After aggregation in epoch: 316, virtual_clock: 12564.991383722647, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.1288877460691666, test len: 3099.0
2021-08-18:16:39:40,65 INFO     [param_server.py:410] Lock worker 3 with localStep 317 , while globalStep is 317

2021-08-18:16:39:40,65 INFO     [param_server.py:441] ====Epoch 318 completes 17 clients with loss 56.95533837079797, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:40,66 INFO     [param_server.py:450] ====Start to sample for epoch 318, global virtualClock: 12564.991383722647, round_duration: 67.37786812921225
2021-08-18:16:39:40,67 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:40,406 INFO     [param_server.py:553] For epoch: 318, median_reward: 376.3834652531583, dev: 752.7669305063166
2021-08-18:16:39:41,29 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9157, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:39:41,32 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4232.4494, eval_time 0.6014, test_loss 2.9157, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:39:41,53 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8498, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:39:41,53 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4232.4674, eval_time 0.6178, test_loss 2.8498, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:39:41,89 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3115, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:39:41,93 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4232.5128, eval_time 0.6643, test_loss 3.3115, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:39:41,124 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:41,133 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:41,161 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:41,181 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:41,186 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:41,201 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:42,733 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:42,753 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:43,329 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:43,338 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:43,916 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:43,927 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:45,166 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:45,187 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:45,868 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:45,882 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:46,298 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:46,316 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:46,405 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:46,424 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:46,677 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:46,699 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:47,86 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:47,107 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:47,416 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:47,431 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:47,774 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:47,783 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:48,53 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:48,74 INFO     [learner.py:606] ====Pushing takes 0.019506454467773438 s
2021-08-18:16:39:48,111 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:48,118 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:48,119 INFO     [param_server.py:410] Lock worker 1 with localStep 318 , while globalStep is 317

2021-08-18:16:39:49,996 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:50,14 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:50,163 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:50,179 INFO     [learner.py:606] ====Pushing takes 0.014913797378540039 s
2021-08-18:16:39:50,195 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:50,200 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:50,200 INFO     [param_server.py:410] Lock worker 2 with localStep 318 , while globalStep is 317

2021-08-18:16:39:50,793 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:50,808 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:52,536 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:52,555 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:53,296 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:53,327 INFO     [learner.py:606] ====Pushing takes 0.029546499252319336 s
2021-08-18:16:39:53,359 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:53,369 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:53,370 INFO     [param_server.py:381] ====After aggregation in epoch: 317, virtual_clock: 12632.369251851858, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 3.025659975768239, test len: 3099.0
2021-08-18:16:39:53,371 INFO     [param_server.py:410] Lock worker 3 with localStep 318 , while globalStep is 318

2021-08-18:16:39:53,372 INFO     [param_server.py:441] ====Epoch 319 completes 17 clients with loss 97.81545702735023, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:53,372 INFO     [param_server.py:450] ====Start to sample for epoch 319, global virtualClock: 12632.369251851858, round_duration: 67.37786812921225
2021-08-18:16:39:53,373 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:53,710 INFO     [param_server.py:553] For epoch: 319, median_reward: 377.5164865431066, dev: 755.0329730862132
2021-08-18:16:39:54,376 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4258, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:39:54,376 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4245.7934, eval_time 0.632, test_loss 3.4258, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:39:54,392 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8245, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:39:54,393 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4245.8071, eval_time 0.6483, test_loss 2.8245, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:39:54,426 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.463, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:39:54,427 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4245.8468, eval_time 0.6826, test_loss 3.463, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:39:54,456 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:54,465 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:54,490 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:54,498 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:54,499 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:54,514 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:55,891 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:55,912 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:56,555 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:56,565 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:57,216 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:57,231 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:58,514 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:58,535 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:59,256 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:59,270 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:59,657 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:59,675 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:59,708 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:59,717 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:59,962 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:59,976 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:00,495 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:00,505 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:00,526 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:00,545 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:01,2 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:01,22 INFO     [learner.py:606] ====Pushing takes 0.01817774772644043 s
2021-08-18:16:40:01,34 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:01,45 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:01,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:01,61 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:01,62 INFO     [param_server.py:410] Lock worker 1 with localStep 319 , while globalStep is 318

2021-08-18:16:40:03,256 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:03,271 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:03,385 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:03,402 INFO     [learner.py:606] ====Pushing takes 0.015099525451660156 s
2021-08-18:16:40:03,416 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:03,421 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:03,422 INFO     [param_server.py:410] Lock worker 2 with localStep 319 , while globalStep is 318

2021-08-18:16:40:03,959 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:03,968 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:05,622 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:05,632 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:06,322 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:06,350 INFO     [learner.py:606] ====Pushing takes 0.026046276092529297 s
2021-08-18:16:40:06,379 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:06,387 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:06,388 INFO     [param_server.py:381] ====After aggregation in epoch: 318, virtual_clock: 12699.74711998107, top_1: : 66.344 % (2056.0), top_5: : 100.0 % (3099.0), test loss: 3.237763952325892, test len: 3099.0
2021-08-18:16:40:06,390 INFO     [param_server.py:410] Lock worker 3 with localStep 319 , while globalStep is 319

2021-08-18:16:40:06,391 INFO     [param_server.py:441] ====Epoch 320 completes 17 clients with loss 128.10332289063317, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:06,391 INFO     [param_server.py:450] ====Start to sample for epoch 320, global virtualClock: 12699.74711998107, round_duration: 67.37786812921225
2021-08-18:16:40:06,393 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:06,718 INFO     [param_server.py:553] For epoch: 320, median_reward: 453.3825971963125, dev: 906.765194392625
2021-08-18:16:40:07,353 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2057, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:40:07,354 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4258.7707, eval_time 0.6001, test_loss 3.2057, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:40:07,354 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0048, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:40:07,354 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4258.7686, eval_time 0.5963, test_loss 3.0048, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:40:07,397 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0978, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:40:07,398 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4258.8176, eval_time 0.646, test_loss 3.0978, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:40:07,424 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:40:07,435 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:40:07,437 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:07,448 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:07,454 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:40:07,482 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:08,965 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:08,992 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:09,588 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:09,598 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:10,217 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:10,231 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:11,591 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:11,616 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:12,362 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:12,383 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:12,580 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:12,594 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:12,649 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:12,667 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:13,159 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:13,186 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:13,558 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:13,572 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:13,776 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:13,786 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:13,811 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:13,820 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:14,262 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:14,283 INFO     [learner.py:606] ====Pushing takes 0.01938939094543457 s
2021-08-18:16:40:14,319 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:14,328 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:14,328 INFO     [param_server.py:410] Lock worker 1 with localStep 320 , while globalStep is 319

2021-08-18:16:40:16,67 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:16,84 INFO     [learner.py:606] ====Pushing takes 0.015465259552001953 s
2021-08-18:16:40:16,100 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:16,118 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:16,118 INFO     [param_server.py:410] Lock worker 2 with localStep 320 , while globalStep is 319

2021-08-18:16:40:16,301 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:16,311 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:17,105 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:17,119 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:18,861 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:18,879 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:19,677 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:19,709 INFO     [learner.py:606] ====Pushing takes 0.030815601348876953 s
2021-08-18:16:40:19,746 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:19,754 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:19,755 INFO     [param_server.py:381] ====After aggregation in epoch: 319, virtual_clock: 12767.124988110281, top_1: : 65.1178 % (2018.0), top_5: : 100.0 % (3099.0), test loss: 3.1027798807179487, test len: 3099.0
2021-08-18:16:40:19,786 INFO     [param_server.py:410] Lock worker 3 with localStep 320 , while globalStep is 320

2021-08-18:16:40:19,786 INFO     [param_server.py:441] ====Epoch 321 completes 17 clients with loss 212.94345519207002, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:19,787 INFO     [param_server.py:450] ====Start to sample for epoch 321, global virtualClock: 12767.124988110281, round_duration: 67.37786812921225
2021-08-18:16:40:19,788 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:20,70 INFO     [param_server.py:541] Handle Wight 0.06894254684448242 | Send 0.2830393314361572
2021-08-18:16:40:20,71 INFO     [param_server.py:553] For epoch: 321, median_reward: 412.2211175018776, dev: 824.4422350037552
2021-08-18:16:40:20,748 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6511, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:40:20,749 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4272.1631, eval_time 0.6446, test_loss 2.6511, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:40:20,783 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0156, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:40:20,787 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4272.2045, eval_time 0.6833, test_loss 3.0156, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:40:20,830 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3763, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:40:20,831 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4272.2507, eval_time 0.7274, test_loss 3.3763, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:40:20,859 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:20,869 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:20,873 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:20,886 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:20,899 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:20,916 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:22,351 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:22,384 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:23,215 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:23,228 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:23,771 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:23,781 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:24,963 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:24,977 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:25,635 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:25,648 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:26,25 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:26,37 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:26,183 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:26,202 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:26,522 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:26,538 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:26,788 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:26,798 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:27,118 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:27,127 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:27,261 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:27,270 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:27,730 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:27,748 INFO     [learner.py:606] ====Pushing takes 0.01690816879272461 s
2021-08-18:16:40:27,779 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:27,786 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:27,787 INFO     [param_server.py:410] Lock worker 1 with localStep 321 , while globalStep is 320

2021-08-18:16:40:29,457 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:29,476 INFO     [learner.py:606] ====Pushing takes 0.014968395233154297 s
2021-08-18:16:40:29,493 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:29,498 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:29,499 INFO     [param_server.py:410] Lock worker 2 with localStep 321 , while globalStep is 320

2021-08-18:16:40:29,530 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:29,544 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:30,220 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:30,230 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:32,2 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:32,15 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:32,728 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:32,757 INFO     [learner.py:606] ====Pushing takes 0.027456045150756836 s
2021-08-18:16:40:32,790 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:32,798 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:32,799 INFO     [param_server.py:381] ====After aggregation in epoch: 320, virtual_clock: 12834.502856239493, top_1: : 66.5053 % (2061.0), top_5: : 100.0 % (3099.0), test loss: 3.0143443831691035, test len: 3099.0
2021-08-18:16:40:32,801 INFO     [param_server.py:410] Lock worker 3 with localStep 321 , while globalStep is 321

2021-08-18:16:40:32,802 INFO     [param_server.py:441] ====Epoch 322 completes 17 clients with loss 129.2218456723165, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:32,802 INFO     [param_server.py:450] ====Start to sample for epoch 322, global virtualClock: 12834.502856239493, round_duration: 67.37786812921225
2021-08-18:16:40:32,803 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:33,124 INFO     [param_server.py:553] For epoch: 322, median_reward: 403.19038900889973, dev: 806.3807780177995
2021-08-18:16:40:33,833 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6431, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:40:33,834 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4285.2483, eval_time 0.6656, test_loss 2.6431, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:40:33,874 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3889, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:40:33,875 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4285.2925, eval_time 0.707, test_loss 3.3889, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:40:33,915 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:33,919 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.284, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:40:33,923 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4285.3423, eval_time 0.7541, test_loss 3.284, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:40:33,926 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:33,947 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:33,961 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:33,994 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:34,17 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:35,633 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:35,660 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:36,436 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:36,457 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:36,656 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:36,665 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:38,251 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:38,271 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:39,51 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:39,61 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:39,69 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:39,81 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:39,522 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:39,537 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:39,706 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:39,729 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:39,826 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:39,840 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:40,258 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:40,271 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:40,723 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:40,732 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:40,902 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:40,924 INFO     [learner.py:606] ====Pushing takes 0.020906686782836914 s
2021-08-18:16:40:40,954 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:40,961 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:40,962 INFO     [param_server.py:410] Lock worker 1 with localStep 322 , while globalStep is 321

2021-08-18:16:40:42,711 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:42,729 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:43,22 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:43,39 INFO     [learner.py:606] ====Pushing takes 0.014874935150146484 s
2021-08-18:16:40:43,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:43,59 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:43,59 INFO     [param_server.py:410] Lock worker 2 with localStep 322 , while globalStep is 321

2021-08-18:16:40:43,647 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:43,662 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:45,317 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:45,327 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:45,938 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:45,965 INFO     [learner.py:606] ====Pushing takes 0.025174617767333984 s
2021-08-18:16:40:46,1 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:46,9 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:46,10 INFO     [param_server.py:381] ====After aggregation in epoch: 321, virtual_clock: 12901.880724368704, top_1: : 65.021 % (2015.0), top_5: : 100.0 % (3099.0), test loss: 3.1053437756167512, test len: 3099.0
2021-08-18:16:40:46,12 INFO     [param_server.py:410] Lock worker 3 with localStep 322 , while globalStep is 322

2021-08-18:16:40:46,13 INFO     [param_server.py:441] ====Epoch 323 completes 17 clients with loss 184.92106045893718, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:46,13 INFO     [param_server.py:450] ====Start to sample for epoch 323, global virtualClock: 12901.880724368704, round_duration: 67.37786812921225
2021-08-18:16:40:46,14 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:46,285 INFO     [param_server.py:553] For epoch: 323, median_reward: 447.079803354981, dev: 894.159606709962
2021-08-18:16:40:46,899 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7907, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:40:46,903 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7786, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:40:46,903 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4298.3206, eval_time 0.5833, test_loss 2.7786, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:40:46,901 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4298.3148, eval_time 0.5784, test_loss 2.7907, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:40:46,974 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2542, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:40:46,975 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4298.3949, eval_time 0.655, test_loss 3.2542, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:40:46,982 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:46,991 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:46,996 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:47,9 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:47,46 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:47,63 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:48,797 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:48,831 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:49,501 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:49,528 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:49,778 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:49,793 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:51,643 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:51,667 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:52,315 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:52,329 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:52,396 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:52,411 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:52,596 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:52,615 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:53,173 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:53,193 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:53,233 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:53,247 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:53,870 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:53,878 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:53,882 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:53,892 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:54,467 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:54,488 INFO     [learner.py:606] ====Pushing takes 0.019750356674194336 s
2021-08-18:16:40:54,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:54,532 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:54,533 INFO     [param_server.py:410] Lock worker 1 with localStep 323 , while globalStep is 322

2021-08-18:16:40:55,992 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:56,2 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:56,93 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:56,109 INFO     [learner.py:606] ====Pushing takes 0.014903783798217773 s
2021-08-18:16:40:56,126 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:56,132 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:56,132 INFO     [param_server.py:410] Lock worker 2 with localStep 323 , while globalStep is 322

2021-08-18:16:40:56,787 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:56,797 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:58,529 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:58,548 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:59,217 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:59,247 INFO     [learner.py:606] ====Pushing takes 0.027876853942871094 s
2021-08-18:16:40:59,277 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:59,284 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:59,285 INFO     [param_server.py:381] ====After aggregation in epoch: 322, virtual_clock: 12969.258592497916, top_1: : 66.1826 % (2051.0), top_5: : 100.0 % (3099.0), test loss: 2.941176736796344, test len: 3099.0
2021-08-18:16:40:59,288 INFO     [param_server.py:410] Lock worker 3 with localStep 323 , while globalStep is 323

2021-08-18:16:40:59,289 INFO     [param_server.py:441] ====Epoch 324 completes 17 clients with loss 319.7256642323685, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:59,289 INFO     [param_server.py:450] ====Start to sample for epoch 324, global virtualClock: 12969.258592497916, round_duration: 67.37786812921225
2021-08-18:16:40:59,290 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:59,608 INFO     [param_server.py:553] For epoch: 324, median_reward: 428.7934636620697, dev: 857.5869273241394
2021-08-18:16:41:00,238 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9702, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:41:00,242 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4311.6589, eval_time 0.5869, test_loss 2.9702, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:41:00,277 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0736, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:41:00,278 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4311.6919, eval_time 0.6189, test_loss 3.0736, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:41:00,309 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:41:00,316 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:00,347 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:41:00,356 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2038, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:41:00,357 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4311.7764, eval_time 0.7037, test_loss 3.2038, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:41:00,361 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:00,430 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:41:00,460 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:01,999 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:02,27 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:02,584 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:02,605 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:03,114 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:03,128 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:04,741 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:04,762 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:05,485 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:05,500 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:05,655 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:05,664 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:05,745 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:05,764 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:06,144 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:06,153 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:06,377 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:06,387 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:06,750 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:06,759 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:06,908 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:06,917 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:07,346 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:07,367 INFO     [learner.py:606] ====Pushing takes 0.019719600677490234 s
2021-08-18:16:41:07,400 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:07,407 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:07,408 INFO     [param_server.py:410] Lock worker 1 with localStep 324 , while globalStep is 323

2021-08-18:16:41:08,922 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:08,935 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:09,149 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:09,165 INFO     [learner.py:606] ====Pushing takes 0.014326810836791992 s
2021-08-18:16:41:09,182 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:09,187 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:09,187 INFO     [param_server.py:410] Lock worker 2 with localStep 324 , while globalStep is 323

2021-08-18:16:41:09,799 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:09,813 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:11,690 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:11,704 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:12,409 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:12,437 INFO     [learner.py:606] ====Pushing takes 0.02678203582763672 s
2021-08-18:16:41:12,466 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:12,474 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:12,475 INFO     [param_server.py:381] ====After aggregation in epoch: 323, virtual_clock: 13036.636460627127, top_1: : 64.1497 % (1988.0), top_5: : 100.0 % (3099.0), test loss: 3.082526438766056, test len: 3099.0
2021-08-18:16:41:12,477 INFO     [param_server.py:410] Lock worker 3 with localStep 324 , while globalStep is 324

2021-08-18:16:41:12,478 INFO     [param_server.py:441] ====Epoch 325 completes 17 clients with loss 176.87539479972511, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:12,478 INFO     [param_server.py:450] ====Start to sample for epoch 325, global virtualClock: 13036.636460627127, round_duration: 67.37786812921225
2021-08-18:16:41:12,479 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:12,780 INFO     [param_server.py:553] For epoch: 325, median_reward: 406.14305629171537, dev: 812.2861125834307
2021-08-18:16:41:13,484 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9092, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:41:13,484 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4324.9014, eval_time 0.6587, test_loss 2.9092, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:41:13,523 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5608, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:41:13,527 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4324.9408, eval_time 0.7009, test_loss 2.5608, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:41:13,549 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:41:13,558 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:13,595 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:41:13,597 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4494, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:41:13,600 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4325.0194, eval_time 0.774, test_loss 3.4494, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:41:13,609 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:13,670 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:41:13,695 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:15,519 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:15,546 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:16,0 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:16,27 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:16,397 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:16,409 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:18,51 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:18,71 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:18,623 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:18,633 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:18,738 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:18,752 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:19,240 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:19,258 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:19,423 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:19,432 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:19,458 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:19,472 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:19,961 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:19,970 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:20,510 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:20,530 INFO     [learner.py:606] ====Pushing takes 0.01894235610961914 s
2021-08-18:16:41:20,558 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:20,568 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:20,566 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:20,575 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:20,576 INFO     [param_server.py:410] Lock worker 1 with localStep 325 , while globalStep is 324

2021-08-18:16:41:22,329 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:22,350 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:22,779 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:22,798 INFO     [learner.py:606] ====Pushing takes 0.012365102767944336 s
2021-08-18:16:41:22,819 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:22,824 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:22,825 INFO     [param_server.py:410] Lock worker 2 with localStep 325 , while globalStep is 324

2021-08-18:16:41:23,242 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:23,256 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:25,62 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:25,76 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:25,693 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:25,723 INFO     [learner.py:606] ====Pushing takes 0.027995824813842773 s
2021-08-18:16:41:25,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:25,761 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:25,762 INFO     [param_server.py:381] ====After aggregation in epoch: 324, virtual_clock: 13104.014328756339, top_1: : 66.5053 % (2061.0), top_5: : 100.0 % (3099.0), test loss: 2.973140226194152, test len: 3099.0
2021-08-18:16:41:25,764 INFO     [param_server.py:410] Lock worker 3 with localStep 325 , while globalStep is 325

2021-08-18:16:41:25,765 INFO     [param_server.py:441] ====Epoch 326 completes 17 clients with loss 305.15961093485845, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:25,765 INFO     [param_server.py:450] ====Start to sample for epoch 326, global virtualClock: 13104.014328756339, round_duration: 67.37786812921225
2021-08-18:16:41:25,766 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:26,42 INFO     [param_server.py:553] For epoch: 326, median_reward: 452.592334109474, dev: 905.184668218948
2021-08-18:16:41:26,775 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1158, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:41:26,776 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4338.193, eval_time 0.7003, test_loss 3.1158, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:41:26,783 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3033, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:41:26,784 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4338.1983, eval_time 0.7077, test_loss 3.3033, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:41:26,832 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:26,840 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:26,851 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:26,860 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:26,866 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5819, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:41:26,867 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4338.2862, eval_time 0.7909, test_loss 3.5819, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:41:26,934 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:26,962 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:28,638 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:28,665 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:29,139 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:29,160 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:29,460 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:29,472 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:31,166 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:31,193 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:31,856 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:31,870 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:32,183 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:32,210 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:32,426 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:32,447 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:32,867 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:32,881 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:32,944 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:32,964 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:33,438 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:33,457 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:33,867 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:33,877 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:33,997 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:34,18 INFO     [learner.py:606] ====Pushing takes 0.01962757110595703 s
2021-08-18:16:41:34,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:34,61 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:34,62 INFO     [param_server.py:410] Lock worker 1 with localStep 326 , while globalStep is 325

2021-08-18:16:41:36,30 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:36,42 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:36,163 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:36,181 INFO     [learner.py:606] ====Pushing takes 0.015857458114624023 s
2021-08-18:16:41:36,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:36,207 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:36,208 INFO     [param_server.py:410] Lock worker 2 with localStep 326 , while globalStep is 325

2021-08-18:16:41:36,807 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:36,816 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:38,424 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:38,433 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:39,177 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:39,207 INFO     [learner.py:606] ====Pushing takes 0.029489517211914062 s
2021-08-18:16:41:39,249 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:39,259 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:39,259 INFO     [param_server.py:381] ====After aggregation in epoch: 325, virtual_clock: 13171.39219688555, top_1: : 65.3759 % (2026.0), top_5: : 100.0 % (3099.0), test loss: 3.333681976353681, test len: 3099.0
2021-08-18:16:41:39,261 INFO     [param_server.py:410] Lock worker 3 with localStep 326 , while globalStep is 326

2021-08-18:16:41:39,262 INFO     [param_server.py:441] ====Epoch 327 completes 17 clients with loss 182.90700425059285, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:39,262 INFO     [param_server.py:450] ====Start to sample for epoch 327, global virtualClock: 13171.39219688555, round_duration: 67.37786812921225
2021-08-18:16:41:39,263 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:39,549 INFO     [param_server.py:553] For epoch: 327, median_reward: 398.44166673189017, dev: 796.8833334637803
2021-08-18:16:41:40,154 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7482, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:41:40,158 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4351.5752, eval_time 0.5753, test_loss 2.7482, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:41:40,165 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7353, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:41:40,166 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4351.5801, eval_time 0.583, test_loss 2.7353, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:41:40,223 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:40,231 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:40,231 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:40,240 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:40,243 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5922, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:41:40,245 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4351.6642, eval_time 0.6617, test_loss 3.5922, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:41:40,315 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:40,339 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:41,974 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:42,8 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:42,491 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:42,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:43,86 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:43,107 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:44,955 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:44,983 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:45,705 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:45,718 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:45,733 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:45,747 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:45,858 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:45,878 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:46,546 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:46,553 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:46,560 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:46,567 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:47,54 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:47,64 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:47,125 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:47,135 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:47,709 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:47,729 INFO     [learner.py:606] ====Pushing takes 0.01886439323425293 s
2021-08-18:16:41:47,765 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:47,771 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:47,772 INFO     [param_server.py:410] Lock worker 1 with localStep 327 , while globalStep is 326

2021-08-18:16:41:49,210 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:49,224 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:49,465 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:49,479 INFO     [learner.py:606] ====Pushing takes 0.012418985366821289 s
2021-08-18:16:41:49,500 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:49,505 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:49,506 INFO     [param_server.py:410] Lock worker 2 with localStep 327 , while globalStep is 326

2021-08-18:16:41:49,920 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:49,930 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:51,611 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:51,625 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:52,283 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:52,312 INFO     [learner.py:606] ====Pushing takes 0.027887582778930664 s
2021-08-18:16:41:52,345 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:52,353 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:52,354 INFO     [param_server.py:381] ====After aggregation in epoch: 326, virtual_clock: 13238.770065014762, top_1: : 66.7312 % (2068.0), top_5: : 100.0 % (3099.0), test loss: 3.0252393735227763, test len: 3099.0
2021-08-18:16:41:52,356 INFO     [param_server.py:410] Lock worker 3 with localStep 327 , while globalStep is 327

2021-08-18:16:41:52,357 INFO     [param_server.py:441] ====Epoch 328 completes 17 clients with loss 164.9021481671633, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:52,357 INFO     [param_server.py:450] ====Start to sample for epoch 328, global virtualClock: 13238.770065014762, round_duration: 67.37786812921225
2021-08-18:16:41:52,358 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:52,671 INFO     [param_server.py:553] For epoch: 328, median_reward: 392.94685463079315, dev: 785.8937092615863
2021-08-18:16:41:53,311 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3361, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:41:53,312 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4364.7296, eval_time 0.5968, test_loss 3.3361, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:41:53,351 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2083, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:41:53,352 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4364.7662, eval_time 0.6327, test_loss 3.2083, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:41:53,367 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:53,377 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:53,420 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:53,434 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:53,469 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6758, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:41:53,470 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4364.8897, eval_time 0.7547, test_loss 3.6758, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:41:53,540 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:53,584 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:55,210 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:55,244 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:55,753 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:55,774 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:56,267 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:56,282 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:57,770 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:57,791 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:58,607 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:58,628 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:58,736 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:58,747 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:58,954 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:58,972 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:59,431 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:59,450 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:59,463 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:59,481 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:00,36 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:00,57 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:00,301 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:00,311 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:00,745 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:00,766 INFO     [learner.py:606] ====Pushing takes 0.02054309844970703 s
2021-08-18:16:42:00,799 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:00,809 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:00,809 INFO     [param_server.py:410] Lock worker 1 with localStep 328 , while globalStep is 327

2021-08-18:16:42:02,374 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:02,387 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:02,633 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:02,650 INFO     [learner.py:606] ====Pushing takes 0.015215873718261719 s
2021-08-18:16:42:02,665 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:02,670 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:02,671 INFO     [param_server.py:410] Lock worker 2 with localStep 328 , while globalStep is 327

2021-08-18:16:42:03,246 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:03,264 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:05,189 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:05,204 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:05,950 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:05,978 INFO     [learner.py:606] ====Pushing takes 0.027503490447998047 s
2021-08-18:16:42:06,11 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:06,19 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:06,20 INFO     [param_server.py:381] ====After aggregation in epoch: 327, virtual_clock: 13306.147933143973, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 3.4067628471939653, test len: 3099.0
2021-08-18:16:42:06,22 INFO     [param_server.py:410] Lock worker 3 with localStep 328 , while globalStep is 328

2021-08-18:16:42:06,23 INFO     [param_server.py:441] ====Epoch 329 completes 17 clients with loss 154.67174717641123, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:06,23 INFO     [param_server.py:450] ====Start to sample for epoch 329, global virtualClock: 13306.147933143973, round_duration: 67.37786812921225
2021-08-18:16:42:06,24 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:06,323 INFO     [param_server.py:553] For epoch: 329, median_reward: 368.1247295654499, dev: 736.2494591308998
2021-08-18:16:42:07,79 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.988, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:42:07,80 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4378.4969, eval_time 0.7223, test_loss 2.988, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:42:07,80 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.726, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:42:07,80 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4378.4947, eval_time 0.7228, test_loss 2.726, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:42:07,147 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:42:07,147 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:42:07,157 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:07,160 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:07,158 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8915, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:42:07,161 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4378.5809, eval_time 0.8038, test_loss 2.8915, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:42:07,226 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:42:07,249 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:09,23 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:09,51 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:09,589 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:09,623 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:09,777 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:09,795 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:11,691 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:11,711 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:11,904 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:11,918 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:12,495 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:12,517 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:12,563 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:12,577 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:12,680 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:12,694 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:13,189 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:13,209 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:13,821 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:13,825 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:13,834 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:13,839 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:14,355 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:14,376 INFO     [learner.py:606] ====Pushing takes 0.019299745559692383 s
2021-08-18:16:42:14,407 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:14,417 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:14,418 INFO     [param_server.py:410] Lock worker 1 with localStep 329 , while globalStep is 328

2021-08-18:16:42:15,626 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:15,641 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:16,106 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:16,121 INFO     [learner.py:606] ====Pushing takes 0.013450384140014648 s
2021-08-18:16:42:16,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:16,142 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:16,142 INFO     [param_server.py:410] Lock worker 2 with localStep 329 , while globalStep is 328

2021-08-18:16:42:16,475 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:16,489 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:18,180 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:18,189 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:18,817 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:18,845 INFO     [learner.py:606] ====Pushing takes 0.027127981185913086 s
2021-08-18:16:42:18,880 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:18,890 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:18,891 INFO     [param_server.py:381] ====After aggregation in epoch: 328, virtual_clock: 13373.525801273185, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 2.868524370370088, test len: 3099.0
2021-08-18:16:42:18,893 INFO     [param_server.py:410] Lock worker 3 with localStep 329 , while globalStep is 329

2021-08-18:16:42:18,893 INFO     [param_server.py:441] ====Epoch 330 completes 17 clients with loss 171.66274481620846, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:18,894 INFO     [param_server.py:450] ====Start to sample for epoch 330, global virtualClock: 13373.525801273185, round_duration: 67.37786812921225
2021-08-18:16:42:18,894 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:19,177 INFO     [param_server.py:553] For epoch: 330, median_reward: 399.1077114339276, dev: 798.2154228678552
2021-08-18:16:42:19,801 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8274, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:42:19,802 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4391.2161, eval_time 0.5999, test_loss 2.8274, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:42:19,843 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.996, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:42:19,847 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4391.2642, eval_time 0.6473, test_loss 2.996, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:42:19,856 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1302, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:42:19,858 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4391.2774, eval_time 0.6579, test_loss 3.1302, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:42:19,870 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:42:19,880 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:19,918 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:42:19,928 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:42:19,934 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:19,946 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:21,479 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:21,507 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:22,188 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:22,209 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:22,547 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:22,565 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:24,184 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:24,211 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:25,16 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:25,43 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:25,194 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:25,215 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:25,280 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:25,299 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:25,748 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:25,769 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:26,92 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:26,106 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:26,518 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:26,539 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:26,564 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:26,578 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:27,66 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:27,88 INFO     [learner.py:606] ====Pushing takes 0.02071547508239746 s
2021-08-18:16:42:27,118 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:27,125 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:27,125 INFO     [param_server.py:410] Lock worker 1 with localStep 330 , while globalStep is 329

2021-08-18:16:42:28,773 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:28,790 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:28,800 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:28,817 INFO     [learner.py:606] ====Pushing takes 0.015038013458251953 s
2021-08-18:16:42:28,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:28,841 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:28,842 INFO     [param_server.py:410] Lock worker 2 with localStep 330 , while globalStep is 329

2021-08-18:16:42:29,481 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:29,491 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:31,261 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:31,272 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:31,998 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:32,25 INFO     [learner.py:606] ====Pushing takes 0.02595210075378418 s
2021-08-18:16:42:32,56 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:32,63 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:32,64 INFO     [param_server.py:381] ====After aggregation in epoch: 329, virtual_clock: 13440.903669402396, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 2.98452596311216, test len: 3099.0
2021-08-18:16:42:32,66 INFO     [param_server.py:410] Lock worker 3 with localStep 330 , while globalStep is 330

2021-08-18:16:42:32,67 INFO     [param_server.py:441] ====Epoch 331 completes 17 clients with loss 122.34373976012519, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:32,67 INFO     [param_server.py:450] ====Start to sample for epoch 331, global virtualClock: 13440.903669402396, round_duration: 67.37786812921225
2021-08-18:16:42:32,68 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:32,346 INFO     [param_server.py:553] For epoch: 331, median_reward: 407.25618284865527, dev: 814.5123656973105
2021-08-18:16:42:33,56 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8097, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:42:33,58 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4404.4747, eval_time 0.6747, test_loss 2.8097, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:42:33,92 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7277, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:42:33,94 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4404.5081, eval_time 0.7067, test_loss 2.7277, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:42:33,126 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:33,141 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:33,176 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:33,176 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.868, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:16:42:33,177 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4404.5971, eval_time 0.7969, test_loss 2.868, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:16:42:33,191 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:33,249 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:33,276 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:34,762 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:34,795 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:35,488 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:35,509 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:36,63 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:36,78 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:37,439 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:37,466 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:38,321 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:38,347 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:38,556 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:38,575 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:38,699 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:38,710 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:39,91 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:39,105 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:39,287 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:39,297 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:39,718 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:39,733 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:39,868 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:39,886 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:40,308 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:40,328 INFO     [learner.py:606] ====Pushing takes 0.017657756805419922 s
2021-08-18:16:42:40,353 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:40,363 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:40,364 INFO     [param_server.py:410] Lock worker 1 with localStep 331 , while globalStep is 330

2021-08-18:16:42:41,847 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:41,857 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:42,173 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:42,190 INFO     [learner.py:606] ====Pushing takes 0.015618324279785156 s
2021-08-18:16:42:42,211 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:42,216 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:42,216 INFO     [param_server.py:410] Lock worker 2 with localStep 331 , while globalStep is 330

2021-08-18:16:42:42,577 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:42,590 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:44,218 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:44,232 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:44,940 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:44,970 INFO     [learner.py:606] ====Pushing takes 0.027637958526611328 s
2021-08-18:16:42:45,1 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:45,9 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:45,9 INFO     [param_server.py:381] ====After aggregation in epoch: 330, virtual_clock: 13508.281537531608, top_1: : 67.3443 % (2087.0), top_5: : 100.0 % (3099.0), test loss: 2.8018156697227687, test len: 3099.0
2021-08-18:16:42:45,11 INFO     [param_server.py:410] Lock worker 3 with localStep 331 , while globalStep is 331

2021-08-18:16:42:45,12 INFO     [param_server.py:441] ====Epoch 332 completes 17 clients with loss 76.11565696932021, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:45,12 INFO     [param_server.py:450] ====Start to sample for epoch 332, global virtualClock: 13508.281537531608, round_duration: 67.37786812921225
2021-08-18:16:42:45,13 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:45,297 INFO     [param_server.py:553] For epoch: 332, median_reward: 371.65486357779525, dev: 743.3097271555905
2021-08-18:16:42:46,53 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2065, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:42:46,54 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4417.4715, eval_time 0.7246, test_loss 3.2065, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:42:46,78 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8511, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:42:46,79 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4417.4934, eval_time 0.7493, test_loss 2.8511, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:42:46,134 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9735, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:42:46,137 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4417.5567, eval_time 0.8072, test_loss 2.9735, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:42:46,142 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:46,146 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:46,158 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:46,160 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:46,204 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:46,226 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:47,752 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:47,779 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:48,530 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:48,558 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:49,107 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:49,121 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:50,395 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:50,416 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:51,268 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:51,288 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:51,473 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:51,485 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:51,492 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:51,501 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:52,19 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:52,33 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:52,233 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:52,247 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:52,642 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:52,653 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:52,676 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:52,706 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:53,189 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:53,211 INFO     [learner.py:606] ====Pushing takes 0.019904375076293945 s
2021-08-18:16:42:53,239 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:53,245 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:53,246 INFO     [param_server.py:410] Lock worker 1 with localStep 332 , while globalStep is 331

2021-08-18:16:42:55,27 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:55,44 INFO     [learner.py:606] ====Pushing takes 0.01434636116027832 s
2021-08-18:16:42:55,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:55,65 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:55,66 INFO     [param_server.py:410] Lock worker 2 with localStep 332 , while globalStep is 331

2021-08-18:16:42:55,228 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:55,247 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:56,273 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:56,295 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:57,988 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:58,3 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:58,670 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:58,696 INFO     [learner.py:606] ====Pushing takes 0.024540185928344727 s
2021-08-18:16:42:58,727 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:58,738 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:58,739 INFO     [param_server.py:381] ====After aggregation in epoch: 331, virtual_clock: 13575.65940566082, top_1: : 66.0213 % (2046.0), top_5: : 100.0 % (3099.0), test loss: 3.0103221292848943, test len: 3099.0
2021-08-18:16:42:58,742 INFO     [param_server.py:410] Lock worker 3 with localStep 332 , while globalStep is 332

2021-08-18:16:42:58,754 INFO     [param_server.py:441] ====Epoch 333 completes 17 clients with loss 124.3610443907995, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:58,755 INFO     [param_server.py:450] ====Start to sample for epoch 333, global virtualClock: 13575.65940566082, round_duration: 67.37786812921225
2021-08-18:16:42:58,756 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:59,87 INFO     [param_server.py:553] For epoch: 333, median_reward: 381.15436539350054, dev: 762.3087307870011
2021-08-18:16:42:59,689 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1243, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:42:59,690 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.676, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:42:59,691 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4431.108, eval_time 0.5686, test_loss 3.1243, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:42:59,691 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4431.1055, eval_time 0.5677, test_loss 2.676, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:42:59,765 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9326, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:42:59,766 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4431.186, eval_time 0.6454, test_loss 2.9326, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:42:59,793 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:42:59,800 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:42:59,807 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:59,810 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:59,837 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:42:59,856 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:01,310 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:01,337 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:02,223 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:02,244 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:02,350 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:02,362 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:04,81 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:04,105 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:04,879 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:04,893 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:04,957 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:04,976 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:05,364 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:05,374 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:05,637 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:05,652 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:05,804 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:05,817 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:06,365 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:06,384 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:06,755 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:06,774 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:06,987 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:07,8 INFO     [learner.py:606] ====Pushing takes 0.01919388771057129 s
2021-08-18:16:43:07,39 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:07,46 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:07,47 INFO     [param_server.py:410] Lock worker 1 with localStep 333 , while globalStep is 332

2021-08-18:16:43:08,828 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:08,846 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:08,996 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:09,12 INFO     [learner.py:606] ====Pushing takes 0.014429330825805664 s
2021-08-18:16:43:09,30 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:09,35 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:09,35 INFO     [param_server.py:410] Lock worker 2 with localStep 333 , while globalStep is 332

2021-08-18:16:43:09,632 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:09,643 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:11,313 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:11,329 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:12,43 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:12,72 INFO     [learner.py:606] ====Pushing takes 0.027619123458862305 s
2021-08-18:16:43:12,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:12,110 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:12,111 INFO     [param_server.py:381] ====After aggregation in epoch: 332, virtual_clock: 13643.03727379003, top_1: : 66.4731 % (2060.0), top_5: : 100.0 % (3099.0), test loss: 2.9109698269102307, test len: 3099.0
2021-08-18:16:43:12,114 INFO     [param_server.py:410] Lock worker 3 with localStep 333 , while globalStep is 333

2021-08-18:16:43:12,114 INFO     [param_server.py:441] ====Epoch 334 completes 17 clients with loss 114.9299081004942, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:12,115 INFO     [param_server.py:450] ====Start to sample for epoch 334, global virtualClock: 13643.03727379003, round_duration: 67.37786812921225
2021-08-18:16:43:12,116 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:12,432 INFO     [param_server.py:553] For epoch: 334, median_reward: 431.600863144459, dev: 863.201726288918
2021-08-18:16:43:12,983 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6428, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:43:12,984 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4444.3978, eval_time 0.5042, test_loss 2.6428, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:43:13,32 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.964, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:43:13,36 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4444.4531, eval_time 0.5566, test_loss 2.964, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:43:13,78 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:43:13,87 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:13,117 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9529, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:43:13,118 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4444.5378, eval_time 0.6409, test_loss 2.9529, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:43:13,136 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:43:13,151 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:13,206 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:43:13,234 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:14,989 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:15,16 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:15,590 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:15,611 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:15,894 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:15,915 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:17,529 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:17,542 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:18,265 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:18,285 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:18,574 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:18,577 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:18,584 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:18,591 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:19,13 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:19,27 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:19,352 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:19,366 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:19,719 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:19,729 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:19,846 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:19,857 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:20,312 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:20,333 INFO     [learner.py:606] ====Pushing takes 0.01951122283935547 s
2021-08-18:16:43:20,366 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:20,376 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:20,376 INFO     [param_server.py:410] Lock worker 1 with localStep 334 , while globalStep is 333

2021-08-18:16:43:22,71 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:22,83 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:22,90 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:22,107 INFO     [learner.py:606] ====Pushing takes 0.015116214752197266 s
2021-08-18:16:43:22,122 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:22,127 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:22,127 INFO     [param_server.py:410] Lock worker 2 with localStep 334 , while globalStep is 333

2021-08-18:16:43:22,772 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:22,782 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:24,367 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:24,380 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:25,107 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:25,136 INFO     [learner.py:606] ====Pushing takes 0.02757430076599121 s
2021-08-18:16:43:25,165 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:25,173 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:25,174 INFO     [param_server.py:381] ====After aggregation in epoch: 333, virtual_clock: 13710.415141919242, top_1: : 66.3763 % (2057.0), top_5: : 100.0 % (3099.0), test loss: 2.85324364900589, test len: 3099.0
2021-08-18:16:43:25,176 INFO     [param_server.py:410] Lock worker 3 with localStep 334 , while globalStep is 334

2021-08-18:16:43:25,177 INFO     [param_server.py:441] ====Epoch 335 completes 17 clients with loss 93.96266275683337, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:25,178 INFO     [param_server.py:450] ====Start to sample for epoch 335, global virtualClock: 13710.415141919242, round_duration: 67.37786812921225
2021-08-18:16:43:25,178 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:25,488 INFO     [param_server.py:553] For epoch: 335, median_reward: 402.69612000443647, dev: 805.3922400088729
2021-08-18:16:43:26,68 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7973, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:43:26,69 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4457.4858, eval_time 0.5341, test_loss 2.7973, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:43:26,76 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1661, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:43:26,77 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4457.4909, eval_time 0.5377, test_loss 3.1661, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:43:26,132 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8169, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:43:26,135 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4457.5551, eval_time 0.6029, test_loss 2.8169, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:43:26,155 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:26,167 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:26,176 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:26,189 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:26,192 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:26,224 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:27,912 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:27,940 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:28,283 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:28,304 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:29,63 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:29,82 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:30,338 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:30,352 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:31,60 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:31,74 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:31,385 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:31,399 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:31,474 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:31,484 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:31,731 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:31,740 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:32,275 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:32,285 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:32,367 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:32,378 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:32,791 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:32,800 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:32,874 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:32,894 INFO     [learner.py:606] ====Pushing takes 0.01730656623840332 s
2021-08-18:16:43:32,928 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:32,936 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:32,936 INFO     [param_server.py:410] Lock worker 1 with localStep 335 , while globalStep is 334

2021-08-18:16:43:34,990 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:34,991 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:35,8 INFO     [learner.py:606] ====Pushing takes 0.014302492141723633 s
2021-08-18:16:43:35,7 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:35,23 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:35,29 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:35,30 INFO     [param_server.py:410] Lock worker 2 with localStep 335 , while globalStep is 334

2021-08-18:16:43:35,802 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:35,816 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:37,778 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:37,794 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:38,437 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:38,465 INFO     [learner.py:606] ====Pushing takes 0.026775360107421875 s
2021-08-18:16:43:38,498 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:38,509 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:38,510 INFO     [param_server.py:381] ====After aggregation in epoch: 334, virtual_clock: 13777.793010048454, top_1: : 67.0539 % (2078.0), top_5: : 100.0 % (3099.0), test loss: 2.926766813353256, test len: 3099.0
2021-08-18:16:43:38,512 INFO     [param_server.py:410] Lock worker 3 with localStep 335 , while globalStep is 335

2021-08-18:16:43:38,513 INFO     [param_server.py:441] ====Epoch 336 completes 17 clients with loss 91.13720772813967, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:38,513 INFO     [param_server.py:450] ====Start to sample for epoch 336, global virtualClock: 13777.793010048454, round_duration: 67.37786812921225
2021-08-18:16:43:38,514 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:38,863 INFO     [param_server.py:553] For epoch: 336, median_reward: 391.55301443155616, dev: 783.1060288631123
2021-08-18:16:43:39,519 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6501, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:43:39,520 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4470.9369, eval_time 0.6236, test_loss 3.6501, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:43:39,524 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2217, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:43:39,525 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4470.939, eval_time 0.6261, test_loss 3.2217, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:43:39,591 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:39,600 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4613, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:43:39,601 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4471.0207, eval_time 0.7047, test_loss 3.4613, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:43:39,607 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:39,612 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:39,625 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:39,670 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:39,698 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:41,125 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:41,146 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:41,873 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:41,894 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:42,268 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:42,282 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:43,565 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:43,585 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:44,288 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:44,302 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:44,658 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:44,668 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:44,818 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:44,829 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:45,4 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:45,13 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:45,597 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:45,618 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:45,627 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:45,645 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:46,90 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:46,102 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:46,155 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:46,175 INFO     [learner.py:606] ====Pushing takes 0.018596649169921875 s
2021-08-18:16:43:46,204 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:46,211 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:46,213 INFO     [param_server.py:410] Lock worker 1 with localStep 336 , while globalStep is 335

2021-08-18:16:43:48,297 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:48,318 INFO     [learner.py:606] ====Pushing takes 0.017069101333618164 s
2021-08-18:16:43:48,338 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:48,343 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:48,343 INFO     [param_server.py:410] Lock worker 2 with localStep 336 , while globalStep is 335

2021-08-18:16:43:48,707 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:48,725 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:49,575 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:49,588 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:51,78 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:51,87 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:51,701 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:51,731 INFO     [learner.py:606] ====Pushing takes 0.028522968292236328 s
2021-08-18:16:43:51,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:51,771 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:51,772 INFO     [param_server.py:381] ====After aggregation in epoch: 335, virtual_clock: 13845.170878177665, top_1: : 63.7948 % (1977.0), top_5: : 100.0 % (3099.0), test loss: 3.4443722124452942, test len: 3099.0
2021-08-18:16:43:51,774 INFO     [param_server.py:410] Lock worker 3 with localStep 336 , while globalStep is 336

2021-08-18:16:43:51,774 INFO     [param_server.py:441] ====Epoch 337 completes 17 clients with loss 233.09880866064657, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:51,787 INFO     [param_server.py:450] ====Start to sample for epoch 337, global virtualClock: 13845.170878177665, round_duration: 67.37786812921225
2021-08-18:16:43:51,788 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:52,126 INFO     [param_server.py:553] For epoch: 337, median_reward: 438.7731239954453, dev: 877.5462479908906
2021-08-18:16:43:52,883 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9887, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:43:52,884 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4484.298, eval_time 0.7321, test_loss 2.9887, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:43:52,932 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9928, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:43:52,932 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4484.352, eval_time 0.7826, test_loss 2.9928, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:43:52,934 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.16, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:43:52,934 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4484.3515, eval_time 0.7829, test_loss 3.16, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:43:52,961 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:52,970 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:53,1 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:53,6 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:53,19 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:53,20 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:54,463 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:54,483 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:55,421 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:55,441 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:55,667 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:55,688 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:57,18 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:57,45 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:57,920 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:57,948 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:58,242 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:58,262 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:58,383 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:58,397 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:58,773 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:58,794 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:58,984 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:58,998 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:59,440 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:59,460 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:59,573 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:59,584 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:59,996 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:00,16 INFO     [learner.py:606] ====Pushing takes 0.018755435943603516 s
2021-08-18:16:44:00,46 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:00,56 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:00,57 INFO     [param_server.py:410] Lock worker 1 with localStep 337 , while globalStep is 336

2021-08-18:16:44:01,797 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:01,806 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:01,980 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:01,997 INFO     [learner.py:606] ====Pushing takes 0.015481948852539062 s
2021-08-18:16:44:02,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:02,17 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:02,17 INFO     [param_server.py:410] Lock worker 2 with localStep 337 , while globalStep is 336

2021-08-18:16:44:02,463 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:02,473 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:04,168 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:04,179 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:04,949 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:04,977 INFO     [learner.py:606] ====Pushing takes 0.026977062225341797 s
2021-08-18:16:44:05,15 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:05,23 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:05,24 INFO     [param_server.py:381] ====After aggregation in epoch: 336, virtual_clock: 13912.548746306877, top_1: : 67.3766 % (2088.0), top_5: : 100.0 % (3099.0), test loss: 3.047171742827804, test len: 3099.0
2021-08-18:16:44:05,27 INFO     [param_server.py:410] Lock worker 3 with localStep 337 , while globalStep is 337

2021-08-18:16:44:05,28 INFO     [param_server.py:441] ====Epoch 338 completes 17 clients with loss 185.70741425043823, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:05,29 INFO     [param_server.py:450] ====Start to sample for epoch 338, global virtualClock: 13912.548746306877, round_duration: 67.37786812921225
2021-08-18:16:44:05,29 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:05,382 INFO     [param_server.py:553] For epoch: 338, median_reward: 442.1391793231043, dev: 884.2783586462086
2021-08-18:16:44:05,983 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0608, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:44:05,984 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4497.3978, eval_time 0.5793, test_loss 3.0608, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:44:06,11 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6051, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:44:06,14 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4497.4313, eval_time 0.61, test_loss 3.6051, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:44:06,47 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4574, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:44:06,48 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4497.4678, eval_time 0.6438, test_loss 3.4574, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:44:06,76 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:44:06,91 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:06,104 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:44:06,117 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:44:06,120 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:06,138 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:07,915 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:07,955 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:08,601 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:08,621 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:08,964 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:08,991 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:10,744 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:10,772 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:11,480 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:11,494 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:11,599 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:11,608 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:11,659 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:11,672 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:12,241 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:12,251 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:12,261 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:12,272 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:12,812 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:12,823 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:12,878 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:12,887 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:13,521 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:13,542 INFO     [learner.py:606] ====Pushing takes 0.019134521484375 s
2021-08-18:16:44:13,577 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:13,584 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:13,585 INFO     [param_server.py:410] Lock worker 1 with localStep 338 , while globalStep is 337

2021-08-18:16:44:14,927 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:14,936 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:15,184 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:15,201 INFO     [learner.py:606] ====Pushing takes 0.01586174964904785 s
2021-08-18:16:44:15,222 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:15,226 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:15,227 INFO     [param_server.py:410] Lock worker 2 with localStep 338 , while globalStep is 337

2021-08-18:16:44:15,618 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:15,628 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:17,269 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:17,282 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:17,887 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:17,923 INFO     [learner.py:606] ====Pushing takes 0.03495669364929199 s
2021-08-18:16:44:17,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:17,970 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:17,970 INFO     [param_server.py:381] ====After aggregation in epoch: 337, virtual_clock: 13979.926614436088, top_1: : 63.6334 % (1972.0), top_5: : 100.0 % (3099.0), test loss: 3.374394023859942, test len: 3099.0
2021-08-18:16:44:17,972 INFO     [param_server.py:410] Lock worker 3 with localStep 338 , while globalStep is 338

2021-08-18:16:44:17,973 INFO     [param_server.py:441] ====Epoch 339 completes 17 clients with loss 172.62875494340346, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:17,973 INFO     [param_server.py:450] ====Start to sample for epoch 339, global virtualClock: 13979.926614436088, round_duration: 67.37786812921225
2021-08-18:16:44:17,974 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:18,253 INFO     [param_server.py:553] For epoch: 339, median_reward: 399.40027060168813, dev: 798.8005412033763
2021-08-18:16:44:18,873 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2843, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:44:18,884 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4510.3008, eval_time 0.583, test_loss 3.2843, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:44:18,920 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.198, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:44:18,921 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4510.3348, eval_time 0.6196, test_loss 3.198, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:44:18,962 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:44:18,978 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:18,989 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:44:18,992 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.873, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:44:18,993 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4510.4125, eval_time 0.6944, test_loss 3.873, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:44:19,7 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:19,63 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:44:19,89 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:20,648 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:20,682 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:21,181 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:21,202 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:21,721 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:21,731 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:23,404 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:23,418 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:24,102 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:24,116 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:24,148 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:24,160 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:24,317 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:24,336 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:24,766 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:24,776 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:24,917 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:24,926 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:25,356 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:25,367 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:25,472 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:25,483 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:25,860 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:25,881 INFO     [learner.py:606] ====Pushing takes 0.019994497299194336 s
2021-08-18:16:44:25,919 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:25,927 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:25,927 INFO     [param_server.py:410] Lock worker 1 with localStep 339 , while globalStep is 338

2021-08-18:16:44:27,478 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:27,493 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:27,628 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:27,645 INFO     [learner.py:606] ====Pushing takes 0.015310287475585938 s
2021-08-18:16:44:27,660 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:27,666 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:27,667 INFO     [param_server.py:410] Lock worker 2 with localStep 339 , while globalStep is 338

2021-08-18:16:44:28,304 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:28,322 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:30,107 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:30,121 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:30,761 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:30,789 INFO     [learner.py:606] ====Pushing takes 0.026790380477905273 s
2021-08-18:16:44:30,822 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:30,829 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:30,830 INFO     [param_server.py:381] ====After aggregation in epoch: 338, virtual_clock: 14047.3044825653, top_1: : 67.2152 % (2083.0), top_5: : 100.0 % (3099.0), test loss: 3.4517545523466886, test len: 3099.0
2021-08-18:16:44:30,833 INFO     [param_server.py:410] Lock worker 3 with localStep 339 , while globalStep is 339

2021-08-18:16:44:30,833 INFO     [param_server.py:441] ====Epoch 340 completes 17 clients with loss 263.1018114937685, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:30,834 INFO     [param_server.py:450] ====Start to sample for epoch 340, global virtualClock: 14047.3044825653, round_duration: 67.37786812921225
2021-08-18:16:44:30,834 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:31,172 INFO     [param_server.py:553] For epoch: 340, median_reward: 433.7814738000249, dev: 867.5629476000498
2021-08-18:16:44:31,864 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1883, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:44:31,865 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4523.2793, eval_time 0.6453, test_loss 3.1883, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:44:31,904 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4595, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:44:31,905 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4523.3226, eval_time 0.6892, test_loss 3.4595, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:44:31,918 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3171, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:44:31,921 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4523.341, eval_time 0.705, test_loss 3.3171, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:44:31,933 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:31,944 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:31,974 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:31,989 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:31,989 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:32,7 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:33,634 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:33,661 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:34,345 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:34,371 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:34,633 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:34,645 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:36,154 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:36,169 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:36,972 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:36,972 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:36,986 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:36,990 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:37,513 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:37,527 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:37,703 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:37,721 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:37,838 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:37,852 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:38,279 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:38,299 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:38,757 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:38,774 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:38,994 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:39,14 INFO     [learner.py:606] ====Pushing takes 0.019293785095214844 s
2021-08-18:16:44:39,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:39,58 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:39,59 INFO     [param_server.py:410] Lock worker 1 with localStep 340 , while globalStep is 339

2021-08-18:16:44:40,802 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:40,816 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:41,90 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:41,106 INFO     [learner.py:606] ====Pushing takes 0.014717340469360352 s
2021-08-18:16:44:41,127 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:41,131 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:41,132 INFO     [param_server.py:410] Lock worker 2 with localStep 340 , while globalStep is 339

2021-08-18:16:44:41,660 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:41,674 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:43,393 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:43,405 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:43,988 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:44,17 INFO     [learner.py:606] ====Pushing takes 0.028209686279296875 s
2021-08-18:16:44:44,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:44,61 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:44,62 INFO     [param_server.py:381] ====After aggregation in epoch: 339, virtual_clock: 14114.682350694511, top_1: : 63.3107 % (1962.0), top_5: : 100.0 % (3099.0), test loss: 3.321621325280931, test len: 3099.0
2021-08-18:16:44:44,64 INFO     [param_server.py:410] Lock worker 3 with localStep 340 , while globalStep is 340

2021-08-18:16:44:44,65 INFO     [param_server.py:441] ====Epoch 341 completes 17 clients with loss 202.02750769039724, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:44,65 INFO     [param_server.py:450] ====Start to sample for epoch 341, global virtualClock: 14114.682350694511, round_duration: 67.37786812921225
2021-08-18:16:44:44,66 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:44,354 INFO     [param_server.py:541] Handle Wight 0.03685307502746582 | Send 0.28870105743408203
2021-08-18:16:44:44,355 INFO     [param_server.py:553] For epoch: 341, median_reward: 453.3087302059238, dev: 906.6174604118476
2021-08-18:16:44:45,13 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1694, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:44:45,15 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4536.4295, eval_time 0.6251, test_loss 3.1694, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:44:45,24 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3958, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:44:45,26 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4536.4436, eval_time 0.6364, test_loss 3.3958, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:44:45,85 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:45,93 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3829, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:44:45,93 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4536.513, eval_time 0.7049, test_loss 3.3829, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:44:45,93 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:45,100 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:45,109 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:45,163 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:45,184 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:46,537 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:46,557 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:47,425 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:47,446 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:47,911 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:47,925 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:49,67 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:49,89 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:49,851 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:49,871 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:50,275 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:50,289 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:50,316 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:50,334 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:50,592 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:50,613 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:51,184 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:51,202 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:51,216 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:51,230 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:51,599 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:51,611 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:51,813 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:51,834 INFO     [learner.py:606] ====Pushing takes 0.01916050910949707 s
2021-08-18:16:44:51,871 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:51,878 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:51,879 INFO     [param_server.py:410] Lock worker 1 with localStep 341 , while globalStep is 340

2021-08-18:16:44:53,909 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:53,924 INFO     [learner.py:606] ====Pushing takes 0.014193058013916016 s
2021-08-18:16:44:53,939 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:53,945 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:53,949 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:53,950 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:53,950 INFO     [param_server.py:410] Lock worker 2 with localStep 341 , while globalStep is 340

2021-08-18:16:44:54,749 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:54,762 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:56,366 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:56,384 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:57,11 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:57,43 INFO     [learner.py:606] ====Pushing takes 0.03131270408630371 s
2021-08-18:16:44:57,82 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:57,90 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:57,91 INFO     [param_server.py:381] ====After aggregation in epoch: 340, virtual_clock: 14182.060218823723, top_1: : 67.1184 % (2080.0), top_5: : 100.0 % (3099.0), test loss: 3.3160295398147017, test len: 3099.0
2021-08-18:16:44:57,94 INFO     [param_server.py:410] Lock worker 3 with localStep 341 , while globalStep is 341

2021-08-18:16:44:57,94 INFO     [param_server.py:441] ====Epoch 342 completes 17 clients with loss 197.07163060388842, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:57,94 INFO     [param_server.py:450] ====Start to sample for epoch 342, global virtualClock: 14182.060218823723, round_duration: 67.37786812921225
2021-08-18:16:44:57,95 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:57,406 INFO     [param_server.py:553] For epoch: 342, median_reward: 404.2176760680217, dev: 808.4353521360434
2021-08-18:16:44:58,12 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1847, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:44:58,12 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4549.4265, eval_time 0.5712, test_loss 3.1847, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:44:58,57 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5799, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:44:58,58 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4549.4772, eval_time 0.6179, test_loss 3.5799, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:44:58,67 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3252, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:44:58,68 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4549.4847, eval_time 0.6268, test_loss 3.3252, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:44:58,86 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:44:58,98 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:58,128 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:44:58,138 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:44:58,148 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:58,150 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:59,789 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:59,816 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:00,349 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:00,367 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:00,821 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:00,839 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:02,490 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:02,510 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:03,257 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:03,278 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:03,380 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:03,393 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:03,456 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:03,474 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:03,922 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:03,940 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:04,122 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:04,137 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:04,568 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:04,580 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:04,913 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:04,924 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:05,254 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:05,274 INFO     [learner.py:606] ====Pushing takes 0.0195159912109375 s
2021-08-18:16:45:05,308 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:05,317 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:05,318 INFO     [param_server.py:410] Lock worker 1 with localStep 342 , while globalStep is 341

2021-08-18:16:45:07,71 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:07,92 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:07,368 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:07,384 INFO     [learner.py:606] ====Pushing takes 0.014748334884643555 s
2021-08-18:16:45:07,399 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:07,404 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:07,405 INFO     [param_server.py:410] Lock worker 2 with localStep 342 , while globalStep is 341

2021-08-18:16:45:08,171 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:08,191 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:10,70 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:10,81 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:10,772 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:10,805 INFO     [learner.py:606] ====Pushing takes 0.03139042854309082 s
2021-08-18:16:45:10,842 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:10,850 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:10,851 INFO     [param_server.py:381] ====After aggregation in epoch: 341, virtual_clock: 14249.438086952934, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 3.36328183721613, test len: 3099.0
2021-08-18:16:45:10,853 INFO     [param_server.py:410] Lock worker 3 with localStep 342 , while globalStep is 342

2021-08-18:16:45:10,854 INFO     [param_server.py:441] ====Epoch 343 completes 17 clients with loss 133.09650903835544, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:10,854 INFO     [param_server.py:450] ====Start to sample for epoch 343, global virtualClock: 14249.438086952934, round_duration: 67.37786812921225
2021-08-18:16:45:10,855 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:11,153 INFO     [param_server.py:553] For epoch: 343, median_reward: 402.68208793361106, dev: 805.3641758672221
2021-08-18:16:45:11,693 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1814, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:45:11,694 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4563.1112, eval_time 0.5067, test_loss 3.1814, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:45:11,736 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0012, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:45:11,737 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4563.1514, eval_time 0.5454, test_loss 3.0012, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:45:11,763 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:45:11,771 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:11,770 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1974, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:45:11,773 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4563.1928, eval_time 0.5864, test_loss 3.1974, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:45:11,805 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:45:11,823 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:11,847 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:45:11,867 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:13,417 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:13,445 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:13,914 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:13,928 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:14,526 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:14,536 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:15,864 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:15,879 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:16,589 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:16,609 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:16,890 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:16,901 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:16,973 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:16,988 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:17,346 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:17,366 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:17,844 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:17,871 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:18,84 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:18,105 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:18,333 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:18,346 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:18,744 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:18,765 INFO     [learner.py:606] ====Pushing takes 0.019225120544433594 s
2021-08-18:16:45:18,792 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:18,799 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:18,799 INFO     [param_server.py:410] Lock worker 1 with localStep 343 , while globalStep is 342

2021-08-18:16:45:20,738 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:20,755 INFO     [learner.py:606] ====Pushing takes 0.01639103889465332 s
2021-08-18:16:45:20,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:20,783 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:20,783 INFO     [param_server.py:410] Lock worker 2 with localStep 343 , while globalStep is 342

2021-08-18:16:45:20,893 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:20,904 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:21,586 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:21,600 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:23,298 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:23,312 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:24,27 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:24,56 INFO     [learner.py:606] ====Pushing takes 0.027645587921142578 s
2021-08-18:16:45:24,90 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:24,100 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:24,100 INFO     [param_server.py:381] ====After aggregation in epoch: 342, virtual_clock: 14316.815955082146, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 3.1266860211337058, test len: 3099.0
2021-08-18:16:45:24,102 INFO     [param_server.py:410] Lock worker 3 with localStep 343 , while globalStep is 343

2021-08-18:16:45:24,103 INFO     [param_server.py:441] ====Epoch 344 completes 17 clients with loss 206.71511283470636, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:24,103 INFO     [param_server.py:450] ====Start to sample for epoch 344, global virtualClock: 14316.815955082146, round_duration: 67.37786812921225
2021-08-18:16:45:24,104 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:24,384 INFO     [param_server.py:553] For epoch: 344, median_reward: 386.66635830619515, dev: 773.3327166123903
2021-08-18:16:45:25,9 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0206, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:45:25,10 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4576.4246, eval_time 0.6033, test_loss 3.0206, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:45:25,14 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8958, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:45:25,15 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4576.4318, eval_time 0.6077, test_loss 2.8958, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:45:25,44 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2566, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:45:25,45 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4576.465, eval_time 0.6383, test_loss 3.2566, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:45:25,83 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:25,88 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:25,90 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:25,96 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:25,117 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:25,134 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:26,698 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:26,718 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:27,536 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:27,550 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:27,724 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:27,734 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:29,514 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:29,541 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:30,432 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:30,459 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:30,551 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:30,571 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:30,588 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:30,609 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:31,248 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:31,269 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:31,358 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:31,377 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:31,858 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:31,868 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:31,872 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:31,886 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:32,570 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:32,591 INFO     [learner.py:606] ====Pushing takes 0.01937389373779297 s
2021-08-18:16:45:32,623 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:32,630 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:32,630 INFO     [param_server.py:410] Lock worker 1 with localStep 344 , while globalStep is 343

2021-08-18:16:45:34,219 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:34,240 INFO     [learner.py:606] ====Pushing takes 0.015264749526977539 s
2021-08-18:16:45:34,257 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:34,262 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:34,262 INFO     [param_server.py:410] Lock worker 2 with localStep 344 , while globalStep is 343

2021-08-18:16:45:34,376 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:34,388 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:35,72 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:35,83 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:36,831 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:36,841 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:37,602 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:37,630 INFO     [learner.py:606] ====Pushing takes 0.0276944637298584 s
2021-08-18:16:45:37,674 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:37,683 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:37,683 INFO     [param_server.py:381] ====After aggregation in epoch: 343, virtual_clock: 14384.193823211357, top_1: : 66.2149 % (2052.0), top_5: : 100.0 % (3099.0), test loss: 3.057693634872084, test len: 3099.0
2021-08-18:16:45:37,686 INFO     [param_server.py:410] Lock worker 3 with localStep 344 , while globalStep is 344

2021-08-18:16:45:37,687 INFO     [param_server.py:441] ====Epoch 345 completes 17 clients with loss 247.57077601116455, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:37,687 INFO     [param_server.py:450] ====Start to sample for epoch 345, global virtualClock: 14384.193823211357, round_duration: 67.37786812921225
2021-08-18:16:45:37,688 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:38,42 INFO     [param_server.py:553] For epoch: 345, median_reward: 402.7855006184322, dev: 805.5710012368644
2021-08-18:16:45:38,671 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4659, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:45:38,672 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4590.0888, eval_time 0.6059, test_loss 3.4659, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:45:38,720 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2437, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:45:38,724 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4590.1383, eval_time 0.6559, test_loss 3.2437, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:45:38,740 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:38,747 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:38,799 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8155, Top-1 Accuracy: 719.0/1033 (0.696), Top-5 Accuracy: 1.0
2021-08-18:16:45:38,800 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4590.2198, eval_time 0.7343, test_loss 2.8155, test_accuracy 0.696, test_5_accuracy 1.0 

2021-08-18:16:45:38,820 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:38,835 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:38,871 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:38,899 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:40,762 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:40,802 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:41,12 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:41,32 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:41,724 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:41,744 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:43,378 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:43,398 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:44,75 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:44,89 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:44,170 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:44,190 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:44,211 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:44,231 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:44,878 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:44,890 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:44,955 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:44,965 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:45,389 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:45,399 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:45,466 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:45,476 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:46,85 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:46,106 INFO     [learner.py:606] ====Pushing takes 0.019501686096191406 s
2021-08-18:16:45:46,143 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:46,153 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:46,153 INFO     [param_server.py:410] Lock worker 1 with localStep 345 , while globalStep is 344

2021-08-18:16:45:47,650 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:47,660 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:47,676 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:47,695 INFO     [learner.py:606] ====Pushing takes 0.01717209815979004 s
2021-08-18:16:45:47,712 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:47,717 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:47,718 INFO     [param_server.py:410] Lock worker 2 with localStep 345 , while globalStep is 344

2021-08-18:16:45:48,418 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:48,432 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:50,234 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:50,248 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:50,954 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:50,983 INFO     [learner.py:606] ====Pushing takes 0.027687788009643555 s
2021-08-18:16:45:51,22 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:51,30 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:51,31 INFO     [param_server.py:381] ====After aggregation in epoch: 344, virtual_clock: 14451.571691340569, top_1: : 67.5056 % (2092.0), top_5: : 100.0 % (3099.0), test loss: 3.175028065081548, test len: 3099.0
2021-08-18:16:45:51,34 INFO     [param_server.py:410] Lock worker 3 with localStep 345 , while globalStep is 345

2021-08-18:16:45:51,34 INFO     [param_server.py:441] ====Epoch 346 completes 17 clients with loss 88.03620396388554, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:51,34 INFO     [param_server.py:450] ====Start to sample for epoch 346, global virtualClock: 14451.571691340569, round_duration: 67.37786812921225
2021-08-18:16:45:51,35 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:51,372 INFO     [param_server.py:553] For epoch: 346, median_reward: 359.97990723200405, dev: 719.9598144640081
2021-08-18:16:45:52,50 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7051, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:45:52,51 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4603.4652, eval_time 0.6322, test_loss 2.7051, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:45:52,75 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9409, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:45:52,75 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4603.4925, eval_time 0.6568, test_loss 2.9409, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:45:52,140 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:52,143 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1377, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:45:52,145 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:52,145 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4603.5649, eval_time 0.7289, test_loss 3.1377, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:45:52,154 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:52,156 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:52,216 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:52,251 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:53,867 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:53,894 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:54,473 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:54,494 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:55,176 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:55,189 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:56,468 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:56,481 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:57,231 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:57,245 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:57,581 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:57,595 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:57,609 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:57,618 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:58,20 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:58,35 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:58,383 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:58,394 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:58,638 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:58,647 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:58,822 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:58,834 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:59,184 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:59,205 INFO     [learner.py:606] ====Pushing takes 0.019267559051513672 s
2021-08-18:16:45:59,239 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:59,246 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:59,247 INFO     [param_server.py:410] Lock worker 1 with localStep 346 , while globalStep is 345

2021-08-18:16:46:01,96 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:01,112 INFO     [learner.py:606] ====Pushing takes 0.014324426651000977 s
2021-08-18:16:46:01,128 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:01,133 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:01,134 INFO     [param_server.py:410] Lock worker 2 with localStep 346 , while globalStep is 345

2021-08-18:16:46:01,334 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:01,352 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:01,952 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:01,966 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:03,664 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:03,685 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:04,553 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:04,582 INFO     [learner.py:606] ====Pushing takes 0.02768421173095703 s
2021-08-18:16:46:04,623 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:04,634 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:04,634 INFO     [param_server.py:381] ====After aggregation in epoch: 345, virtual_clock: 14518.94955946978, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 2.927908667811641, test len: 3099.0
2021-08-18:16:46:04,637 INFO     [param_server.py:410] Lock worker 3 with localStep 346 , while globalStep is 346

2021-08-18:16:46:04,637 INFO     [param_server.py:441] ====Epoch 347 completes 17 clients with loss 194.9021282901672, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:04,638 INFO     [param_server.py:450] ====Start to sample for epoch 347, global virtualClock: 14518.94955946978, round_duration: 67.37786812921225
2021-08-18:16:46:04,639 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:04,982 INFO     [param_server.py:553] For epoch: 347, median_reward: 421.0138847856607, dev: 842.0277695713214
2021-08-18:16:46:05,638 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7766, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:46:05,639 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4617.0533, eval_time 0.6138, test_loss 2.7766, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:46:05,647 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.93, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:46:05,648 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4617.065, eval_time 0.6232, test_loss 2.93, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:46:05,682 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2963, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:46:05,683 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4617.1024, eval_time 0.6597, test_loss 3.2963, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:46:05,707 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:46:05,715 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:05,716 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:46:05,728 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:05,750 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:46:05,764 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:07,133 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:07,153 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:07,957 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:07,971 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:08,258 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:08,267 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:09,491 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:09,510 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:10,292 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:10,313 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:10,704 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:10,722 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:11,8 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:11,22 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:11,66 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:11,87 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:11,466 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:11,487 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:11,791 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:11,812 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:12,331 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:12,352 INFO     [learner.py:606] ====Pushing takes 0.019587278366088867 s
2021-08-18:16:46:12,362 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:12,372 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:12,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:12,385 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:12,386 INFO     [param_server.py:410] Lock worker 1 with localStep 347 , while globalStep is 346

2021-08-18:16:46:14,283 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:14,310 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:14,776 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:14,794 INFO     [learner.py:606] ====Pushing takes 0.014421701431274414 s
2021-08-18:16:46:14,808 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:14,813 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:14,813 INFO     [param_server.py:410] Lock worker 2 with localStep 347 , while globalStep is 346

2021-08-18:16:46:15,299 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:15,320 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:17,13 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:17,23 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:17,623 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:17,649 INFO     [learner.py:606] ====Pushing takes 0.024930715560913086 s
2021-08-18:16:46:17,679 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:17,686 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:17,687 INFO     [param_server.py:381] ====After aggregation in epoch: 346, virtual_clock: 14586.327427598992, top_1: : 67.2475 % (2084.0), top_5: : 100.0 % (3099.0), test loss: 3.0009739487259477, test len: 3099.0
2021-08-18:16:46:17,689 INFO     [param_server.py:410] Lock worker 3 with localStep 347 , while globalStep is 347

2021-08-18:16:46:17,690 INFO     [param_server.py:441] ====Epoch 348 completes 17 clients with loss 251.71196823008006, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:17,690 INFO     [param_server.py:450] ====Start to sample for epoch 348, global virtualClock: 14586.327427598992, round_duration: 67.37786812921225
2021-08-18:16:46:17,691 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:17,970 INFO     [param_server.py:553] For epoch: 348, median_reward: 425.70253149138927, dev: 851.4050629827785
2021-08-18:16:46:18,575 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1307, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:46:18,576 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4629.9934, eval_time 0.5817, test_loss 3.1307, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:46:18,584 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0963, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:46:18,585 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4629.9995, eval_time 0.5904, test_loss 3.0963, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:46:18,614 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3526, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:46:18,615 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4630.0347, eval_time 0.6204, test_loss 3.3526, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:46:18,651 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:46:18,660 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:18,662 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:46:18,670 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:18,685 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:46:18,698 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:20,257 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:20,284 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:21,44 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:21,58 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:21,371 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:21,384 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:23,42 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:23,63 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:23,821 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:23,828 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:23,835 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:23,848 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:24,216 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:24,231 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:24,568 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:24,595 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:24,603 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:24,631 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:25,244 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:25,264 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:25,479 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:25,492 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:25,863 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:25,883 INFO     [learner.py:606] ====Pushing takes 0.019246816635131836 s
2021-08-18:16:46:25,924 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:25,933 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:25,934 INFO     [param_server.py:410] Lock worker 1 with localStep 348 , while globalStep is 347

2021-08-18:16:46:27,583 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:27,594 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:27,651 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:27,671 INFO     [learner.py:606] ====Pushing takes 0.018488645553588867 s
2021-08-18:16:46:27,693 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:27,698 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:27,698 INFO     [param_server.py:410] Lock worker 2 with localStep 348 , while globalStep is 347

2021-08-18:16:46:28,284 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:28,295 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:29,895 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:29,904 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:30,520 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:30,548 INFO     [learner.py:606] ====Pushing takes 0.027080774307250977 s
2021-08-18:16:46:30,594 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:30,602 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:30,603 INFO     [param_server.py:381] ====After aggregation in epoch: 347, virtual_clock: 14653.705295728203, top_1: : 66.0213 % (2046.0), top_5: : 100.0 % (3099.0), test loss: 3.193190746837192, test len: 3099.0
2021-08-18:16:46:30,605 INFO     [param_server.py:410] Lock worker 3 with localStep 348 , while globalStep is 348

2021-08-18:16:46:30,606 INFO     [param_server.py:441] ====Epoch 349 completes 17 clients with loss 213.20501407205555, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:30,606 INFO     [param_server.py:450] ====Start to sample for epoch 349, global virtualClock: 14653.705295728203, round_duration: 67.37786812921225
2021-08-18:16:46:30,607 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:30,957 INFO     [param_server.py:553] For epoch: 349, median_reward: 451.00819743942105, dev: 902.0163948788421
2021-08-18:16:46:31,563 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5258, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:46:31,564 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4642.9815, eval_time 0.5708, test_loss 3.5258, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:46:31,605 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7731, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:46:31,606 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4643.0207, eval_time 0.6113, test_loss 2.7731, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:46:31,633 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:31,642 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:31,644 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.7308, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:46:31,647 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4643.0663, eval_time 0.6555, test_loss 4.7308, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:46:31,672 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:31,688 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:31,715 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:31,736 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:33,364 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:33,391 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:34,38 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:34,57 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:34,563 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:34,582 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:36,8 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:36,35 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:36,752 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:36,772 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:37,124 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:37,138 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:37,172 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:37,186 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:37,440 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:37,460 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:38,36 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:38,56 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:38,96 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:38,116 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:38,557 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:38,567 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:38,695 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:38,714 INFO     [learner.py:606] ====Pushing takes 0.018514394760131836 s
2021-08-18:16:46:38,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:38,756 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:38,757 INFO     [param_server.py:410] Lock worker 1 with localStep 349 , while globalStep is 348

2021-08-18:16:46:40,654 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:40,669 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:40,792 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:40,809 INFO     [learner.py:606] ====Pushing takes 0.014754295349121094 s
2021-08-18:16:46:40,824 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:40,830 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:40,830 INFO     [param_server.py:410] Lock worker 2 with localStep 349 , while globalStep is 348

2021-08-18:16:46:41,472 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:41,486 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:43,116 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:43,130 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:43,815 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:43,844 INFO     [learner.py:606] ====Pushing takes 0.02748870849609375 s
2021-08-18:16:46:43,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:43,891 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:43,891 INFO     [param_server.py:381] ====After aggregation in epoch: 348, virtual_clock: 14721.083163857415, top_1: : 67.0539 % (2078.0), top_5: : 100.0 % (3099.0), test loss: 3.6765732478212425, test len: 3099.0
2021-08-18:16:46:43,893 INFO     [param_server.py:410] Lock worker 3 with localStep 349 , while globalStep is 349

2021-08-18:16:46:43,893 INFO     [param_server.py:441] ====Epoch 350 completes 17 clients with loss 197.11909578349983, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:43,894 INFO     [param_server.py:450] ====Start to sample for epoch 350, global virtualClock: 14721.083163857415, round_duration: 67.37786812921225
2021-08-18:16:46:43,894 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:44,181 INFO     [param_server.py:553] For epoch: 350, median_reward: 426.2078929064422, dev: 852.4157858128845
2021-08-18:16:46:44,816 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2368, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:46:44,817 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4656.2346, eval_time 0.6025, test_loss 3.2368, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:46:44,851 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0828, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:46:44,852 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4656.266, eval_time 0.6367, test_loss 3.0828, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:46:44,887 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:44,894 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.335, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:46:44,894 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4656.3141, eval_time 0.6799, test_loss 3.335, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:46:44,895 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:44,920 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:44,935 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:44,961 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:44,983 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:46,594 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:46,615 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:47,202 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:47,216 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:47,711 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:47,729 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:49,124 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:49,160 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:49,836 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:49,850 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:50,204 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:50,216 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:50,225 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:50,244 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:50,659 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:50,680 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:50,805 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:50,814 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:51,329 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:51,350 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:51,401 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:51,419 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:51,897 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:51,916 INFO     [learner.py:606] ====Pushing takes 0.017838239669799805 s
2021-08-18:16:46:51,957 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:51,964 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:51,964 INFO     [param_server.py:410] Lock worker 1 with localStep 350 , while globalStep is 349

2021-08-18:16:46:53,552 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:53,572 INFO     [learner.py:606] ====Pushing takes 0.015384197235107422 s
2021-08-18:16:46:53,579 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:53,587 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:53,592 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:53,593 INFO     [param_server.py:410] Lock worker 2 with localStep 350 , while globalStep is 349

2021-08-18:16:46:53,598 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:54,446 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:54,459 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:56,78 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:56,92 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:56,773 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:56,802 INFO     [learner.py:606] ====Pushing takes 0.02759408950805664 s
2021-08-18:16:46:56,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:56,849 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:56,850 INFO     [param_server.py:381] ====After aggregation in epoch: 349, virtual_clock: 14788.461031986626, top_1: : 64.3756 % (1995.0), top_5: : 100.0 % (3099.0), test loss: 3.2181945950896655, test len: 3099.0
2021-08-18:16:46:56,852 INFO     [param_server.py:410] Lock worker 3 with localStep 350 , while globalStep is 350

2021-08-18:16:46:56,853 INFO     [param_server.py:441] ====Epoch 351 completes 17 clients with loss 86.31907309116633, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:56,853 INFO     [param_server.py:450] ====Start to sample for epoch 351, global virtualClock: 14788.461031986626, round_duration: 67.37786812921225
2021-08-18:16:46:56,854 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:57,166 INFO     [param_server.py:553] For epoch: 351, median_reward: 369.91119954624304, dev: 739.8223990924861
2021-08-18:16:46:57,780 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8853, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:46:57,781 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4669.1953, eval_time 0.5892, test_loss 2.8853, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:46:57,794 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9728, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:46:57,795 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4669.2124, eval_time 0.604, test_loss 2.9728, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:46:57,853 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:46:57,856 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9575, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:46:57,857 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4669.2769, eval_time 0.6677, test_loss 2.9575, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:46:57,868 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:46:57,868 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:57,876 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:57,928 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:46:57,945 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:59,392 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:59,412 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:00,133 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:00,146 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:00,759 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:00,772 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:02,44 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:02,71 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:02,976 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:02,996 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:03,147 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:03,167 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:03,269 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:03,283 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:03,873 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:03,900 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:04,111 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:04,125 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:04,594 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:04,615 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:04,656 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:04,684 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:05,294 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:05,316 INFO     [learner.py:606] ====Pushing takes 0.019985198974609375 s
2021-08-18:16:47:05,350 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:05,359 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:05,360 INFO     [param_server.py:410] Lock worker 1 with localStep 351 , while globalStep is 350

2021-08-18:16:47:07,15 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:07,25 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:07,92 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:07,109 INFO     [learner.py:606] ====Pushing takes 0.014780044555664062 s
2021-08-18:16:47:07,124 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:07,129 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:07,130 INFO     [param_server.py:410] Lock worker 2 with localStep 351 , while globalStep is 350

2021-08-18:16:47:07,701 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:07,711 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:09,254 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:09,269 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:09,903 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:09,932 INFO     [learner.py:606] ====Pushing takes 0.02809762954711914 s
2021-08-18:16:47:09,971 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:09,978 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:09,979 INFO     [param_server.py:381] ====After aggregation in epoch: 350, virtual_clock: 14855.838900115838, top_1: : 67.2475 % (2084.0), top_5: : 100.0 % (3099.0), test loss: 2.9385059608353505, test len: 3099.0
2021-08-18:16:47:09,981 INFO     [param_server.py:410] Lock worker 3 with localStep 351 , while globalStep is 351

2021-08-18:16:47:09,982 INFO     [param_server.py:441] ====Epoch 352 completes 17 clients with loss 160.08169382769043, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:09,982 INFO     [param_server.py:450] ====Start to sample for epoch 352, global virtualClock: 14855.838900115838, round_duration: 67.37786812921225
2021-08-18:16:47:09,983 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:10,291 INFO     [param_server.py:553] For epoch: 352, median_reward: 429.1270035048518, dev: 858.2540070097036
2021-08-18:16:47:10,874 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4697, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:47:10,878 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4682.2947, eval_time 0.5627, test_loss 3.4697, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:47:10,910 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9671, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:47:10,911 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4682.325, eval_time 0.5936, test_loss 2.9671, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:47:10,951 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:47:10,951 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4278, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:47:10,953 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4682.3731, eval_time 0.6384, test_loss 3.4278, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:47:10,960 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:10,977 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:47:10,994 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:11,24 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:47:11,41 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:12,695 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:12,715 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:13,143 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:13,156 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:13,693 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:13,707 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:15,516 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:15,543 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:16,219 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:16,232 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:16,239 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:16,253 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:16,363 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:16,384 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:17,84 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:17,99 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:17,99 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:17,159 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:17,600 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:17,614 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:17,738 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:17,752 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:18,425 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:18,446 INFO     [learner.py:606] ====Pushing takes 0.018826723098754883 s
2021-08-18:16:47:18,471 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:18,478 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:18,478 INFO     [param_server.py:410] Lock worker 1 with localStep 352 , while globalStep is 351

2021-08-18:16:47:19,683 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:19,695 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:19,812 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:19,829 INFO     [learner.py:606] ====Pushing takes 0.014936685562133789 s
2021-08-18:16:47:19,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:19,849 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:19,850 INFO     [param_server.py:410] Lock worker 2 with localStep 352 , while globalStep is 351

2021-08-18:16:47:20,465 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:20,474 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:22,152 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:22,166 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:22,851 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:22,881 INFO     [learner.py:606] ====Pushing takes 0.0282440185546875 s
2021-08-18:16:47:22,916 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:22,924 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:22,925 INFO     [param_server.py:381] ====After aggregation in epoch: 351, virtual_clock: 14923.216768245049, top_1: : 64.2788 % (1992.0), top_5: : 100.0 % (3099.0), test loss: 3.288194027211931, test len: 3099.0
2021-08-18:16:47:22,927 INFO     [param_server.py:410] Lock worker 3 with localStep 352 , while globalStep is 352

2021-08-18:16:47:22,928 INFO     [param_server.py:441] ====Epoch 353 completes 17 clients with loss 123.52954603852936, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:22,928 INFO     [param_server.py:450] ====Start to sample for epoch 353, global virtualClock: 14923.216768245049, round_duration: 67.37786812921225
2021-08-18:16:47:22,929 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:23,209 INFO     [param_server.py:553] For epoch: 353, median_reward: 388.53511763414554, dev: 777.0702352682911
2021-08-18:16:47:23,816 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.8364, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:47:23,817 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4695.237, eval_time 0.5747, test_loss 4.8364, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:47:23,839 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9388, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:47:23,844 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0609, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:47:23,845 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4695.2621, eval_time 0.6025, test_loss 3.0609, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:47:23,840 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4695.2544, eval_time 0.5916, test_loss 2.9388, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:47:23,884 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:23,909 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:23,914 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:23,914 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:23,923 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:23,929 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:25,649 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:25,670 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:26,219 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:26,237 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:27,48 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:27,61 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:28,211 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:28,238 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:29,54 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:29,75 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:29,258 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:29,270 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:29,406 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:29,427 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:29,766 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:29,780 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:29,961 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:29,970 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:30,406 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:30,420 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:30,720 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:30,738 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:31,74 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:31,95 INFO     [learner.py:606] ====Pushing takes 0.019573688507080078 s
2021-08-18:16:47:31,125 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:31,132 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:31,132 INFO     [param_server.py:410] Lock worker 1 with localStep 353 , while globalStep is 352

2021-08-18:16:47:32,618 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:32,633 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:33,173 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:33,189 INFO     [learner.py:606] ====Pushing takes 0.014909982681274414 s
2021-08-18:16:47:33,205 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:33,210 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:33,211 INFO     [param_server.py:410] Lock worker 2 with localStep 353 , while globalStep is 352

2021-08-18:16:47:33,409 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:33,429 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:35,369 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:35,387 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:36,188 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:36,215 INFO     [learner.py:606] ====Pushing takes 0.02508544921875 s
2021-08-18:16:47:36,246 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:36,254 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:36,255 INFO     [param_server.py:381] ====After aggregation in epoch: 352, virtual_clock: 14990.59463637426, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 3.6120263889983852, test len: 3099.0
2021-08-18:16:47:36,257 INFO     [param_server.py:410] Lock worker 3 with localStep 353 , while globalStep is 353

2021-08-18:16:47:36,258 INFO     [param_server.py:441] ====Epoch 354 completes 17 clients with loss 97.48927566589899, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:36,259 INFO     [param_server.py:450] ====Start to sample for epoch 354, global virtualClock: 14990.59463637426, round_duration: 67.37786812921225
2021-08-18:16:47:36,260 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:36,535 INFO     [param_server.py:553] For epoch: 354, median_reward: 406.67544710509463, dev: 813.3508942101893
2021-08-18:16:47:37,123 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0166, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:47:37,124 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4708.5414, eval_time 0.5623, test_loss 3.0166, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:47:37,164 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3361, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:47:37,164 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4708.584, eval_time 0.6022, test_loss 3.3361, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:47:37,169 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1156, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:47:37,170 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4708.5845, eval_time 0.6044, test_loss 3.1156, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:47:37,194 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:37,204 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:37,233 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:37,238 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:37,249 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:37,251 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:38,792 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:38,806 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:39,574 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:39,588 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:40,135 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:40,145 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:41,148 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:41,168 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:41,866 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:41,887 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:42,527 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:42,536 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:42,680 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:42,707 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:42,763 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:42,783 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:43,327 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:43,339 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:43,480 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:43,507 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:44,126 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:44,150 INFO     [learner.py:606] ====Pushing takes 0.022888660430908203 s
2021-08-18:16:47:44,184 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:44,192 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:44,193 INFO     [param_server.py:410] Lock worker 1 with localStep 354 , while globalStep is 353

2021-08-18:16:47:44,293 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:44,311 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:46,484 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:46,504 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:46,720 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:46,736 INFO     [learner.py:606] ====Pushing takes 0.014714717864990234 s
2021-08-18:16:47:46,752 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:46,757 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:46,758 INFO     [param_server.py:410] Lock worker 2 with localStep 354 , while globalStep is 353

2021-08-18:16:47:47,483 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:47,497 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:49,51 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:49,62 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:49,653 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:49,684 INFO     [learner.py:606] ====Pushing takes 0.03001546859741211 s
2021-08-18:16:47:49,719 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:49,726 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:49,727 INFO     [param_server.py:381] ====After aggregation in epoch: 353, virtual_clock: 15057.972504503472, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 3.156112790107727, test len: 3099.0
2021-08-18:16:47:49,730 INFO     [param_server.py:410] Lock worker 3 with localStep 354 , while globalStep is 354

2021-08-18:16:47:49,731 INFO     [param_server.py:441] ====Epoch 355 completes 17 clients with loss 102.37156101215537, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:49,731 INFO     [param_server.py:450] ====Start to sample for epoch 355, global virtualClock: 15057.972504503472, round_duration: 67.37786812921225
2021-08-18:16:47:49,732 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:50,52 INFO     [param_server.py:553] For epoch: 355, median_reward: 409.20747753571266, dev: 818.4149550714253
2021-08-18:16:47:50,675 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9041, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:47:50,676 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4722.09, eval_time 0.6098, test_loss 3.9041, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:47:50,676 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8586, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:47:50,679 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4722.0957, eval_time 0.6137, test_loss 2.8586, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:47:50,680 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4335, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:47:50,681 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4722.1004, eval_time 0.6168, test_loss 3.4335, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:47:50,747 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:50,750 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:50,754 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:50,754 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:50,758 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:50,762 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:52,178 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:52,192 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:52,991 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:53,5 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:53,519 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:53,528 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:54,786 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:54,825 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:55,893 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:55,933 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:56,135 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:56,156 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:56,360 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:56,387 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:56,776 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:56,816 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:57,464 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:57,487 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:57,513 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:57,540 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:57,704 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:57,720 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:58,114 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:58,137 INFO     [learner.py:606] ====Pushing takes 0.017380475997924805 s
2021-08-18:16:47:58,163 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:58,170 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:58,171 INFO     [param_server.py:410] Lock worker 1 with localStep 355 , while globalStep is 354

2021-08-18:16:47:59,987 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:00,3 INFO     [learner.py:606] ====Pushing takes 0.013759613037109375 s
2021-08-18:16:48:00,18 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:00,24 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:00,25 INFO     [param_server.py:410] Lock worker 2 with localStep 355 , while globalStep is 354

2021-08-18:16:48:00,328 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:00,337 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:01,41 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:01,53 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:02,860 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:02,870 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:03,506 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:03,535 INFO     [learner.py:606] ====Pushing takes 0.02747821807861328 s
2021-08-18:16:48:03,565 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:03,576 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:03,577 INFO     [param_server.py:381] ====After aggregation in epoch: 354, virtual_clock: 15125.350372632684, top_1: : 66.1181 % (2049.0), top_5: : 100.0 % (3099.0), test loss: 3.398728043944747, test len: 3099.0
2021-08-18:16:48:03,579 INFO     [param_server.py:410] Lock worker 3 with localStep 355 , while globalStep is 355

2021-08-18:16:48:03,579 INFO     [param_server.py:441] ====Epoch 356 completes 17 clients with loss 128.40103794734756, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:03,580 INFO     [param_server.py:450] ====Start to sample for epoch 356, global virtualClock: 15125.350372632684, round_duration: 67.37786812921225
2021-08-18:16:48:03,580 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:03,891 INFO     [param_server.py:553] For epoch: 356, median_reward: 434.68826790934787, dev: 869.3765358186957
2021-08-18:16:48:04,631 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8052, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:48:04,632 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4736.046, eval_time 0.7256, test_loss 2.8052, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:48:04,634 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2431, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:48:04,635 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4736.0521, eval_time 0.7308, test_loss 4.2431, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:48:04,670 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4077, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:48:04,671 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4736.0908, eval_time 0.7687, test_loss 3.4077, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:48:04,705 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:48:04,709 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:48:04,714 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:04,718 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:04,743 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:48:04,764 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:06,572 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:06,606 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:06,822 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:06,837 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:07,878 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:07,906 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:09,411 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:09,431 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:09,701 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:09,722 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:10,241 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:10,261 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:10,394 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:10,412 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:10,907 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:10,921 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:11,166 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:11,172 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:11,180 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:11,181 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:11,686 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:11,700 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:12,259 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:12,283 INFO     [learner.py:606] ====Pushing takes 0.02259039878845215 s
2021-08-18:16:48:12,321 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:12,328 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:12,329 INFO     [param_server.py:410] Lock worker 1 with localStep 356 , while globalStep is 355

2021-08-18:16:48:13,562 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:13,581 INFO     [learner.py:606] ====Pushing takes 0.014755964279174805 s
2021-08-18:16:48:13,598 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:13,603 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:13,604 INFO     [param_server.py:410] Lock worker 2 with localStep 356 , while globalStep is 355

2021-08-18:16:48:13,817 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:13,829 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:14,537 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:14,547 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:16,224 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:16,233 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:17,164 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:17,194 INFO     [learner.py:606] ====Pushing takes 0.028681516647338867 s
2021-08-18:16:48:17,226 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:17,234 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:17,235 INFO     [param_server.py:381] ====After aggregation in epoch: 355, virtual_clock: 15192.728240761895, top_1: : 66.3117 % (2055.0), top_5: : 100.0 % (3099.0), test loss: 3.4853664415853998, test len: 3099.0
2021-08-18:16:48:17,237 INFO     [param_server.py:410] Lock worker 3 with localStep 356 , while globalStep is 356

2021-08-18:16:48:17,238 INFO     [param_server.py:441] ====Epoch 357 completes 17 clients with loss 201.1780349477367, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:17,238 INFO     [param_server.py:450] ====Start to sample for epoch 357, global virtualClock: 15192.728240761895, round_duration: 67.37786812921225
2021-08-18:16:48:17,239 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:17,503 INFO     [param_server.py:553] For epoch: 357, median_reward: 448.0533002255509, dev: 896.1066004511018
2021-08-18:16:48:18,87 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.071, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:48:18,88 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4749.5055, eval_time 0.5414, test_loss 3.071, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:48:18,156 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:48:18,165 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:18,189 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4576, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:48:18,186 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9808, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:48:18,189 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4749.6034, eval_time 0.6308, test_loss 3.4576, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:48:18,189 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4749.6091, eval_time 0.6424, test_loss 2.9808, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:48:18,257 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:48:18,258 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:48:18,280 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:18,289 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:19,883 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:19,904 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:20,204 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:20,224 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:21,225 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:21,236 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:22,295 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:22,315 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:23,68 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:23,88 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:23,147 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:23,168 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:23,491 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:23,502 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:23,718 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:23,733 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:24,175 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:24,185 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:24,291 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:24,305 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:24,387 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:24,406 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:24,764 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:24,783 INFO     [learner.py:606] ====Pushing takes 0.0176389217376709 s
2021-08-18:16:48:24,819 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:24,829 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:24,829 INFO     [param_server.py:410] Lock worker 1 with localStep 357 , while globalStep is 356

2021-08-18:16:48:26,857 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:26,885 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:26,972 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:26,990 INFO     [learner.py:606] ====Pushing takes 0.015053272247314453 s
2021-08-18:16:48:27,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:27,17 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:27,18 INFO     [param_server.py:410] Lock worker 2 with localStep 357 , while globalStep is 356

2021-08-18:16:48:27,878 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:27,899 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:29,917 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:29,940 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:30,617 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:30,646 INFO     [learner.py:606] ====Pushing takes 0.027931690216064453 s
2021-08-18:16:48:30,683 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:30,691 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:30,691 INFO     [param_server.py:381] ====After aggregation in epoch: 356, virtual_clock: 15260.106108891106, top_1: : 66.2472 % (2053.0), top_5: : 100.0 % (3099.0), test loss: 3.1697805943312467, test len: 3099.0
2021-08-18:16:48:30,694 INFO     [param_server.py:410] Lock worker 3 with localStep 357 , while globalStep is 357

2021-08-18:16:48:30,694 INFO     [param_server.py:441] ====Epoch 358 completes 17 clients with loss 69.86082366466151, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:30,694 INFO     [param_server.py:450] ====Start to sample for epoch 358, global virtualClock: 15260.106108891106, round_duration: 67.37786812921225
2021-08-18:16:48:30,695 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:30,981 INFO     [param_server.py:553] For epoch: 358, median_reward: 365.88301683726115, dev: 731.7660336745223
2021-08-18:16:48:31,664 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0384, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:48:31,665 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4763.082, eval_time 0.6581, test_loss 3.0384, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:48:31,675 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7504, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:48:31,677 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4763.0907, eval_time 0.6686, test_loss 3.7504, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:48:31,710 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5348, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:48:31,710 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4763.13, eval_time 0.7061, test_loss 3.5348, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:48:31,737 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:31,745 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:31,746 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:31,755 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:31,769 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:31,783 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:32,932 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:32,946 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:33,804 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:33,823 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:34,249 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:34,259 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:35,271 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:35,299 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:36,79 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:36,112 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:36,429 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:36,444 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:36,786 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:36,802 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:37,40 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:37,67 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:37,101 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:37,110 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:37,865 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:37,892 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:38,185 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:38,199 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:38,514 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:38,535 INFO     [learner.py:606] ====Pushing takes 0.018824100494384766 s
2021-08-18:16:48:38,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:38,574 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:38,574 INFO     [param_server.py:410] Lock worker 1 with localStep 358 , while globalStep is 357

2021-08-18:16:48:40,346 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:40,360 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:40,859 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:40,876 INFO     [learner.py:606] ====Pushing takes 0.01514291763305664 s
2021-08-18:16:48:40,891 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:40,896 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:40,896 INFO     [param_server.py:410] Lock worker 2 with localStep 358 , while globalStep is 357

2021-08-18:16:48:41,177 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:41,198 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:43,74 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:43,83 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:43,732 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:43,761 INFO     [learner.py:606] ====Pushing takes 0.02768731117248535 s
2021-08-18:16:48:43,803 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:43,812 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:43,813 INFO     [param_server.py:381] ====After aggregation in epoch: 357, virtual_clock: 15327.483977020318, top_1: : 67.183 % (2082.0), top_5: : 100.0 % (3099.0), test loss: 3.441179299796069, test len: 3099.0
2021-08-18:16:48:43,815 INFO     [param_server.py:410] Lock worker 3 with localStep 358 , while globalStep is 358

2021-08-18:16:48:43,816 INFO     [param_server.py:441] ====Epoch 359 completes 17 clients with loss 204.79910907708862, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:43,816 INFO     [param_server.py:450] ====Start to sample for epoch 359, global virtualClock: 15327.483977020318, round_duration: 67.37786812921225
2021-08-18:16:48:43,817 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:44,106 INFO     [param_server.py:553] For epoch: 359, median_reward: 417.726738447537, dev: 835.453476895074
2021-08-18:16:48:44,791 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3272, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:48:44,792 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4776.2116, eval_time 0.6735, test_loss 3.3272, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:48:44,792 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9482, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:48:44,793 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4776.2069, eval_time 0.6733, test_loss 2.9482, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:48:44,801 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3175, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:48:44,805 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4776.2219, eval_time 0.6862, test_loss 3.3175, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:48:44,863 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:44,863 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:44,872 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:44,875 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:44,878 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:44,887 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:46,261 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:46,288 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:47,6 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:47,19 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:47,530 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:47,541 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:48,973 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:49,7 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:49,947 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:49,974 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:50,6 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:50,20 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:50,298 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:50,316 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:50,631 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:50,645 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:51,1 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:51,10 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:51,236 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:51,243 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:51,245 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:51,263 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:51,860 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:51,878 INFO     [learner.py:606] ====Pushing takes 0.01670551300048828 s
2021-08-18:16:48:51,914 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:51,921 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:51,921 INFO     [param_server.py:410] Lock worker 1 with localStep 359 , while globalStep is 358

2021-08-18:16:48:53,919 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:53,935 INFO     [learner.py:606] ====Pushing takes 0.014411449432373047 s
2021-08-18:16:48:53,957 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:53,961 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:53,962 INFO     [param_server.py:410] Lock worker 2 with localStep 359 , while globalStep is 358

2021-08-18:16:48:53,973 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:53,991 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:54,825 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:54,838 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:56,303 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:56,313 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:56,932 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:56,962 INFO     [learner.py:606] ====Pushing takes 0.02920079231262207 s
2021-08-18:16:48:56,999 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:57,6 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:57,7 INFO     [param_server.py:381] ====After aggregation in epoch: 358, virtual_clock: 15394.86184514953, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 3.19761934545305, test len: 3099.0
2021-08-18:16:48:57,10 INFO     [param_server.py:410] Lock worker 3 with localStep 359 , while globalStep is 359

2021-08-18:16:48:57,11 INFO     [param_server.py:441] ====Epoch 360 completes 17 clients with loss 196.35156569667814, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:57,11 INFO     [param_server.py:450] ====Start to sample for epoch 360, global virtualClock: 15394.86184514953, round_duration: 67.37786812921225
2021-08-18:16:48:57,12 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:57,298 INFO     [param_server.py:553] For epoch: 360, median_reward: 466.7739481417274, dev: 933.5478962834547
2021-08-18:16:48:57,888 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1065, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:48:57,889 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4789.3061, eval_time 0.5555, test_loss 3.1065, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:48:57,924 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8369, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:48:57,925 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4789.3387, eval_time 0.5909, test_loss 2.8369, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:48:57,969 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:48:57,968 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1774, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:48:57,971 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4789.391, eval_time 0.6392, test_loss 3.1774, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:48:57,978 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:57,994 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:48:58,8 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:58,29 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:48:58,54 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:59,766 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:59,794 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:00,136 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:00,156 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:01,80 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:01,94 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:02,128 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:02,142 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:02,956 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:02,984 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:03,183 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:03,201 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:03,318 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:03,332 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:03,854 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:03,875 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:49:04,114 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:04,133 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:04,503 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:04,510 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:49:04,513 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:04,530 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:05,133 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:05,153 INFO     [learner.py:606] ====Pushing takes 0.017686843872070312 s
2021-08-18:16:49:05,185 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:05,194 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:49:05,195 INFO     [param_server.py:410] Lock worker 1 with localStep 360 , while globalStep is 359

2021-08-18:16:49:06,918 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:06,929 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:07,159 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:07,174 INFO     [learner.py:606] ====Pushing takes 0.013956785202026367 s
2021-08-18:16:49:07,189 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:07,194 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:49:07,194 INFO     [param_server.py:410] Lock worker 2 with localStep 360 , while globalStep is 359

2021-08-18:16:49:07,614 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:07,623 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:09,286 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:09,305 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:09,971 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:10,8 INFO     [learner.py:606] ====Pushing takes 0.03527188301086426 s
2021-08-18:16:49:10,44 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:10,54 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:49:10,55 INFO     [param_server.py:381] ====After aggregation in epoch: 359, virtual_clock: 15462.239713278741, top_1: : 67.5379 % (2093.0), top_5: : 100.0 % (3099.0), test loss: 3.0402508267649897, test len: 3099.0
2021-08-18:16:49:10,58 INFO     [param_server.py:410] Lock worker 3 with localStep 360 , while globalStep is 360

2021-08-18:16:49:10,58 INFO     [param_server.py:441] ====Epoch 361 completes 17 clients with loss 118.85008809907693, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:10,59 INFO     [param_server.py:450] ====Start to sample for epoch 361, global virtualClock: 15462.239713278741, round_duration: 67.37786812921225
2021-08-18:16:49:10,59 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:10,400 INFO     [param_server.py:541] Handle Wight 0.04237651824951172 | Send 0.34177064895629883
2021-08-18:16:49:10,402 INFO     [param_server.py:553] For epoch: 361, median_reward: 449.79727607896535, dev: 899.5945521579307
2021-08-18:16:49:11,63 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3031, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:49:11,64 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4802.4815, eval_time 0.6377, test_loss 3.3031, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:49:11,107 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2761, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:49:11,109 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4802.5283, eval_time 0.6845, test_loss 3.2761, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:49:11,110 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0388, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:49:11,112 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4802.5266, eval_time 0.6837, test_loss 3.0388, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:49:11,124 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:49:11,131 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:11,167 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:49:11,180 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:11,181 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:49:11,196 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:12,551 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:12,565 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:13,386 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:13,395 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:13,896 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:13,907 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:15,5 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:15,33 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:15,998 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:16,25 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:16,253 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:16,270 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:16,359 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:16,373 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:16,829 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:16,849 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:17,142 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:17,156 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:17,493 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:17,511 INFO     [learner.py:606] ====Pushing takes 0.016383647918701172 s
2021-08-18:16:49:17,548 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:17,554 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:17,555 INFO     [param_server.py:410] Lock worker 1 with localStep 361 , while globalStep is 360

2021-08-18:16:49:18,33 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:18,42 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:19,861 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:19,880 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:20,332 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:20,349 INFO     [learner.py:606] ====Pushing takes 0.013811111450195312 s
2021-08-18:16:49:20,365 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:20,370 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:20,370 INFO     [param_server.py:410] Lock worker 2 with localStep 361 , while globalStep is 360

2021-08-18:16:49:21,256 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:21,270 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:23,130 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:23,140 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:23,757 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:23,787 INFO     [learner.py:606] ====Pushing takes 0.028842926025390625 s
2021-08-18:16:49:23,830 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:23,840 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:23,841 INFO     [param_server.py:381] ====After aggregation in epoch: 360, virtual_clock: 15532.861474814414, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 3.2060016658571033, test len: 3099.0
2021-08-18:16:49:23,843 INFO     [param_server.py:410] Lock worker 3 with localStep 361 , while globalStep is 361

2021-08-18:16:49:23,844 INFO     [param_server.py:441] ====Epoch 362 completes 16 clients with loss 4.402852168963497, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:23,844 INFO     [param_server.py:450] ====Start to sample for epoch 362, global virtualClock: 15532.861474814414, round_duration: 70.62176153567286
2021-08-18:16:49:23,845 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:24,178 INFO     [param_server.py:553] For epoch: 362, median_reward: 396.8281346592179, dev: 793.6562693184358
2021-08-18:16:49:24,815 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9969, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:49:24,816 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4816.2301, eval_time 0.612, test_loss 2.9969, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:49:24,818 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6582, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:49:24,818 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4816.2381, eval_time 0.6169, test_loss 3.6582, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:49:24,824 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5926, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:49:24,825 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4816.2418, eval_time 0.6209, test_loss 3.5926, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:49:24,888 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:24,894 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:24,898 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:24,903 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:24,903 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:24,917 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:26,475 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:26,496 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:27,247 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:27,261 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:27,744 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:27,758 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:28,979 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:28,997 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:29,801 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:29,829 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:30,79 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:30,92 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:30,313 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:30,324 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:30,556 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:30,577 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:30,814 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:30,823 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:31,287 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:31,307 INFO     [learner.py:606] ====Pushing takes 0.0185239315032959 s
2021-08-18:16:49:31,337 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:31,344 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:31,345 INFO     [param_server.py:410] Lock worker 1 with localStep 362 , while globalStep is 361

2021-08-18:16:49:31,873 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:31,887 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:33,554 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:33,565 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:34,138 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:34,153 INFO     [learner.py:606] ====Pushing takes 0.013929128646850586 s
2021-08-18:16:49:34,168 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:34,173 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:34,173 INFO     [param_server.py:410] Lock worker 2 with localStep 362 , while globalStep is 361

2021-08-18:16:49:34,770 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:34,779 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:36,453 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:36,462 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:37,145 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:37,173 INFO     [learner.py:606] ====Pushing takes 0.02703261375427246 s
2021-08-18:16:49:37,208 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:37,216 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:37,217 INFO     [param_server.py:381] ====After aggregation in epoch: 361, virtual_clock: 15603.483236350086, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 3.41588137767933, test len: 3099.0
2021-08-18:16:49:37,219 INFO     [param_server.py:410] Lock worker 3 with localStep 362 , while globalStep is 362

2021-08-18:16:49:37,220 INFO     [param_server.py:441] ====Epoch 363 completes 16 clients with loss 6.472165125335436, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:37,220 INFO     [param_server.py:450] ====Start to sample for epoch 363, global virtualClock: 15603.483236350086, round_duration: 70.62176153567286
2021-08-18:16:49:37,221 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:37,565 INFO     [param_server.py:553] For epoch: 363, median_reward: 432.6658823288793, dev: 865.3317646577586
2021-08-18:16:49:38,223 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.6675, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:49:38,227 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4829.6442, eval_time 0.6375, test_loss 5.6675, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:49:38,272 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2456, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:49:38,273 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4829.6873, eval_time 0.6813, test_loss 3.2456, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:49:38,292 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:38,300 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:38,308 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3045, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:49:38,312 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4829.7317, eval_time 0.7244, test_loss 3.3045, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:49:38,340 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:38,355 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:38,384 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:38,406 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:40,63 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:40,90 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:40,558 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:40,573 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:41,107 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:41,122 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:42,470 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:42,490 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:43,201 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:43,215 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:43,536 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:43,545 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:43,715 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:43,734 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:43,822 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:43,843 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:44,401 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:44,418 INFO     [learner.py:606] ====Pushing takes 0.015203714370727539 s
2021-08-18:16:49:44,447 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:44,449 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:44,457 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:44,457 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:44,457 INFO     [param_server.py:410] Lock worker 1 with localStep 363 , while globalStep is 362

2021-08-18:16:49:45,309 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:45,318 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:47,21 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:47,32 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:47,882 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:47,896 INFO     [learner.py:606] ====Pushing takes 0.012310266494750977 s
2021-08-18:16:49:47,913 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:47,918 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:47,919 INFO     [param_server.py:410] Lock worker 2 with localStep 363 , while globalStep is 362

2021-08-18:16:49:48,323 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:48,344 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:50,89 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:50,103 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:50,866 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:50,897 INFO     [learner.py:606] ====Pushing takes 0.029418468475341797 s
2021-08-18:16:49:50,931 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:50,940 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:50,941 INFO     [param_server.py:381] ====After aggregation in epoch: 362, virtual_clock: 15674.104997885759, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 4.072519993340528, test len: 3099.0
2021-08-18:16:49:50,943 INFO     [param_server.py:410] Lock worker 3 with localStep 363 , while globalStep is 363

2021-08-18:16:49:50,944 INFO     [param_server.py:441] ====Epoch 364 completes 16 clients with loss 4.697981475057647, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:50,944 INFO     [param_server.py:450] ====Start to sample for epoch 364, global virtualClock: 15674.104997885759, round_duration: 70.62176153567286
2021-08-18:16:49:50,945 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:51,286 INFO     [param_server.py:553] For epoch: 364, median_reward: 437.455960096561, dev: 874.911920193122
2021-08-18:16:49:51,911 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3275, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:49:51,912 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4843.3265, eval_time 0.5845, test_loss 3.3275, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:49:51,922 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.99, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:49:51,923 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4843.34, eval_time 0.5953, test_loss 3.99, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:49:51,981 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:51,990 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:51,993 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1483, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:49:51,993 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4843.4131, eval_time 0.6679, test_loss 4.1483, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:49:51,998 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:52,14 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:52,66 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:52,87 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:53,622 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:53,642 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:54,72 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:54,86 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:54,897 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:54,907 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:56,52 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:56,73 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:56,762 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:56,776 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:57,102 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:57,115 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:57,138 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:57,150 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:57,461 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:57,476 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:57,776 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:57,786 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:58,27 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:58,45 INFO     [learner.py:606] ====Pushing takes 0.01735067367553711 s
2021-08-18:16:49:58,76 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:58,83 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:58,84 INFO     [param_server.py:410] Lock worker 1 with localStep 364 , while globalStep is 363

2021-08-18:16:49:58,659 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:58,669 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:00,428 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:00,446 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:01,197 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:01,214 INFO     [learner.py:606] ====Pushing takes 0.015323162078857422 s
2021-08-18:16:50:01,230 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:01,235 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:01,236 INFO     [param_server.py:410] Lock worker 2 with localStep 364 , while globalStep is 363

2021-08-18:16:50:01,914 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:01,928 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:03,779 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:03,802 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:04,567 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:04,597 INFO     [learner.py:606] ====Pushing takes 0.02782750129699707 s
2021-08-18:16:50:04,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:04,642 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:04,642 INFO     [param_server.py:381] ====After aggregation in epoch: 363, virtual_clock: 15744.726759421432, top_1: : 66.9894 % (2076.0), top_5: : 100.0 % (3099.0), test loss: 3.8219121738716413, test len: 3099.0
2021-08-18:16:50:04,646 INFO     [param_server.py:410] Lock worker 3 with localStep 364 , while globalStep is 364

2021-08-18:16:50:04,646 INFO     [param_server.py:441] ====Epoch 365 completes 16 clients with loss 6.552695255110889, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:04,647 INFO     [param_server.py:450] ====Start to sample for epoch 365, global virtualClock: 15744.726759421432, round_duration: 70.62176153567286
2021-08-18:16:50:04,648 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:05,3 INFO     [param_server.py:553] For epoch: 365, median_reward: 455.85671382671796, dev: 911.7134276534359
2021-08-18:16:50:05,685 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4291, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:50:05,686 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4857.1054, eval_time 0.6482, test_loss 3.4291, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:50:05,732 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2015, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:50:05,732 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6027, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:50:05,733 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4857.1468, eval_time 0.6898, test_loss 3.2015, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:50:05,733 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4857.1499, eval_time 0.6952, test_loss 3.6027, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:50:05,754 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:50:05,766 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:05,803 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:50:05,813 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:05,826 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:50:05,835 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:07,224 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:07,238 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:08,125 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:08,144 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:08,480 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:08,492 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:09,534 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:09,547 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:10,394 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:10,421 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:10,797 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:10,811 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:11,25 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:11,38 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:11,255 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:11,283 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:11,609 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:11,622 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:11,981 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:12,1 INFO     [learner.py:606] ====Pushing takes 0.017148733139038086 s
2021-08-18:16:50:12,30 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:12,36 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:12,37 INFO     [param_server.py:410] Lock worker 1 with localStep 365 , while globalStep is 364

2021-08-18:16:50:12,686 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:12,696 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:14,513 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:14,527 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:15,246 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:15,265 INFO     [learner.py:606] ====Pushing takes 0.01538991928100586 s
2021-08-18:16:50:15,282 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:15,286 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:15,287 INFO     [param_server.py:410] Lock worker 2 with localStep 365 , while globalStep is 364

2021-08-18:16:50:15,736 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:15,754 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:17,318 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:17,330 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:17,970 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:18,0 INFO     [learner.py:606] ====Pushing takes 0.027848482131958008 s
2021-08-18:16:50:18,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:18,45 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:18,46 INFO     [param_server.py:381] ====After aggregation in epoch: 364, virtual_clock: 15815.348520957104, top_1: : 64.2788 % (1992.0), top_5: : 100.0 % (3099.0), test loss: 3.41107412620827, test len: 3099.0
2021-08-18:16:50:18,47 INFO     [param_server.py:410] Lock worker 3 with localStep 365 , while globalStep is 365

2021-08-18:16:50:18,48 INFO     [param_server.py:441] ====Epoch 366 completes 16 clients with loss 5.007099262100132, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:18,48 INFO     [param_server.py:450] ====Start to sample for epoch 366, global virtualClock: 15815.348520957104, round_duration: 70.62176153567286
2021-08-18:16:50:18,49 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:18,424 INFO     [param_server.py:553] For epoch: 366, median_reward: 420.1955320186557, dev: 840.3910640373114
2021-08-18:16:50:19,62 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9602, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:50:19,63 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4870.4769, eval_time 0.6221, test_loss 2.9602, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:50:19,66 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5558, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:50:19,67 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4870.4846, eval_time 0.6299, test_loss 3.5558, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:50:19,98 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9038, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:50:19,101 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4870.5206, eval_time 0.6632, test_loss 3.9038, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:50:19,137 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:19,144 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:19,146 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:19,153 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:19,170 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:19,185 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:20,767 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:20,781 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:21,451 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:21,469 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:21,894 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:21,904 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:23,325 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:23,351 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:24,168 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:24,202 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:24,364 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:24,377 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:24,517 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:24,538 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:24,974 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:24,995 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:25,307 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:25,321 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:25,607 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:25,626 INFO     [learner.py:606] ====Pushing takes 0.01774430274963379 s
2021-08-18:16:50:25,651 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:25,659 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:25,660 INFO     [param_server.py:410] Lock worker 1 with localStep 366 , while globalStep is 365

2021-08-18:16:50:26,54 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:26,66 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:28,107 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:28,117 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:28,478 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:28,494 INFO     [learner.py:606] ====Pushing takes 0.014720916748046875 s
2021-08-18:16:50:28,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:28,514 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:28,515 INFO     [param_server.py:410] Lock worker 2 with localStep 366 , while globalStep is 365

2021-08-18:16:50:29,434 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:29,444 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:31,188 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:31,197 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:31,746 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:31,773 INFO     [learner.py:606] ====Pushing takes 0.025583505630493164 s
2021-08-18:16:50:31,811 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:31,819 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:31,821 INFO     [param_server.py:381] ====After aggregation in epoch: 365, virtual_clock: 15885.970282492777, top_1: : 66.828 % (2071.0), top_5: : 100.0 % (3099.0), test loss: 3.4732784761322875, test len: 3099.0
2021-08-18:16:50:31,823 INFO     [param_server.py:410] Lock worker 3 with localStep 366 , while globalStep is 366

2021-08-18:16:50:31,824 INFO     [param_server.py:441] ====Epoch 367 completes 16 clients with loss 5.427331449738492, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:31,824 INFO     [param_server.py:450] ====Start to sample for epoch 367, global virtualClock: 15885.970282492777, round_duration: 70.62176153567286
2021-08-18:16:50:31,825 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:32,177 INFO     [param_server.py:553] For epoch: 367, median_reward: 402.76977184807726, dev: 805.5395436961545
2021-08-18:16:50:32,798 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1291, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:50:32,799 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4884.2129, eval_time 0.5973, test_loss 3.1291, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:50:32,804 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5833, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:50:32,805 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4884.2222, eval_time 0.6042, test_loss 3.5833, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:50:32,840 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3644, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:50:32,841 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4884.2611, eval_time 0.6404, test_loss 3.3644, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:50:32,871 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:32,877 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:32,880 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:32,885 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:32,915 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:32,932 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:34,652 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:34,680 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:35,7 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:35,27 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:35,863 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:35,884 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:37,228 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:37,248 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:37,910 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:37,924 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:38,216 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:38,229 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:38,328 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:38,565 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:38,629 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:38,648 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:39,272 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:39,280 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:39,290 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:39,291 INFO     [learner.py:606] ====Pushing takes 0.01791524887084961 s
2021-08-18:16:50:39,321 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:39,327 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:39,328 INFO     [param_server.py:410] Lock worker 1 with localStep 367 , while globalStep is 366

2021-08-18:16:50:39,920 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:39,931 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:42,70 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:42,80 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:42,417 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:42,434 INFO     [learner.py:606] ====Pushing takes 0.01532888412475586 s
2021-08-18:16:50:42,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:42,458 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:42,459 INFO     [param_server.py:410] Lock worker 2 with localStep 367 , while globalStep is 366

2021-08-18:16:50:43,439 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:43,451 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:45,131 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:45,144 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:45,868 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:45,901 INFO     [learner.py:606] ====Pushing takes 0.03250837326049805 s
2021-08-18:16:50:45,939 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:45,950 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:45,951 INFO     [param_server.py:381] ====After aggregation in epoch: 366, virtual_clock: 15956.59204402845, top_1: : 65.0532 % (2016.0), top_5: : 100.0 % (3099.0), test loss: 3.3589370162398726, test len: 3099.0
2021-08-18:16:50:45,953 INFO     [param_server.py:410] Lock worker 3 with localStep 367 , while globalStep is 367

2021-08-18:16:50:45,953 INFO     [param_server.py:441] ====Epoch 368 completes 16 clients with loss 6.047053923155927, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:45,954 INFO     [param_server.py:450] ====Start to sample for epoch 368, global virtualClock: 15956.59204402845, round_duration: 70.62176153567286
2021-08-18:16:50:45,955 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:46,287 INFO     [param_server.py:553] For epoch: 368, median_reward: 422.40190397196096, dev: 844.8038079439219
2021-08-18:16:50:46,981 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0487, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:50:46,983 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4898.3996, eval_time 0.6512, test_loss 3.0487, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:50:47,52 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:47,60 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:47,62 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0712, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:50:47,62 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4898.4764, eval_time 0.729, test_loss 3.0712, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:50:47,100 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8567, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:50:47,101 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4898.5207, eval_time 0.7696, test_loss 3.8567, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:50:47,132 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:47,154 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:47,160 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:47,186 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:48,673 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:48,687 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:49,242 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:49,260 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:49,899 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:49,910 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:51,73 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:51,87 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:51,913 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:51,940 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:52,113 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:52,122 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:52,129 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:52,138 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:52,701 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:52,712 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:52,723 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:52,743 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:53,302 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:53,326 INFO     [learner.py:606] ====Pushing takes 0.017061233520507812 s
2021-08-18:16:50:53,353 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:53,360 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:53,361 INFO     [param_server.py:410] Lock worker 1 with localStep 368 , while globalStep is 367

2021-08-18:16:50:53,662 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:53,676 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:55,443 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:55,457 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:56,265 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:56,280 INFO     [learner.py:606] ====Pushing takes 0.013622283935546875 s
2021-08-18:16:50:56,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:56,302 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:56,303 INFO     [param_server.py:410] Lock worker 2 with localStep 368 , while globalStep is 367

2021-08-18:16:50:56,858 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:56,879 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:58,790 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:58,811 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:59,396 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:59,424 INFO     [learner.py:606] ====Pushing takes 0.026515960693359375 s
2021-08-18:16:50:59,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:59,462 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:59,463 INFO     [param_server.py:381] ====After aggregation in epoch: 367, virtual_clock: 16027.213805564123, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 3.3255329035498478, test len: 3099.0
2021-08-18:16:50:59,465 INFO     [param_server.py:410] Lock worker 3 with localStep 368 , while globalStep is 368

2021-08-18:16:50:59,465 INFO     [param_server.py:441] ====Epoch 369 completes 16 clients with loss 5.800507606325404, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:59,466 INFO     [param_server.py:450] ====Start to sample for epoch 369, global virtualClock: 16027.213805564123, round_duration: 70.62176153567286
2021-08-18:16:50:59,467 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:59,823 INFO     [param_server.py:553] For epoch: 369, median_reward: 398.9153947514251, dev: 797.8307895028502
2021-08-18:16:51:00,408 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3899, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:51:00,409 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4911.823, eval_time 0.5599, test_loss 3.3899, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:51:00,412 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6511, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:51:00,413 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4911.8302, eval_time 0.565, test_loss 3.6511, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:51:00,479 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:51:00,484 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:51:00,487 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:00,488 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7634, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:51:00,488 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4911.9082, eval_time 0.6423, test_loss 3.7634, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:51:00,493 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:00,573 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:51:00,595 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:01,944 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:01,958 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:02,751 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:02,764 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:03,248 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:03,258 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:04,311 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:04,325 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:05,37 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:05,57 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:05,426 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:05,440 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:05,732 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:05,743 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:05,802 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:05,823 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:06,45 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:06,55 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:06,394 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:06,413 INFO     [learner.py:606] ====Pushing takes 0.017443180084228516 s
2021-08-18:16:51:06,443 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:06,452 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:06,453 INFO     [param_server.py:410] Lock worker 1 with localStep 369 , while globalStep is 368

2021-08-18:16:51:07,403 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:07,413 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:08,835 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:08,862 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:10,137 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:10,157 INFO     [learner.py:606] ====Pushing takes 0.015283823013305664 s
2021-08-18:16:51:10,178 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:10,183 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:10,184 INFO     [param_server.py:410] Lock worker 2 with localStep 369 , while globalStep is 368

2021-08-18:16:51:10,519 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:10,529 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:12,119 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:12,129 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:12,828 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:12,858 INFO     [learner.py:606] ====Pushing takes 0.028119564056396484 s
2021-08-18:16:51:12,900 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:12,908 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:12,909 INFO     [param_server.py:381] ====After aggregation in epoch: 368, virtual_clock: 16097.835567099795, top_1: : 63.5044 % (1968.0), top_5: : 100.0 % (3099.0), test loss: 3.6014646733248674, test len: 3099.0
2021-08-18:16:51:12,911 INFO     [param_server.py:410] Lock worker 3 with localStep 369 , while globalStep is 369

2021-08-18:16:51:12,912 INFO     [param_server.py:441] ====Epoch 370 completes 16 clients with loss 5.000590333190054, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:12,912 INFO     [param_server.py:450] ====Start to sample for epoch 370, global virtualClock: 16097.835567099795, round_duration: 70.62176153567286
2021-08-18:16:51:12,913 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:13,261 INFO     [param_server.py:553] For epoch: 370, median_reward: 417.7885598901867, dev: 835.5771197803734
2021-08-18:16:51:13,925 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9134, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:51:13,926 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4925.3402, eval_time 0.6395, test_loss 2.9134, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:51:13,956 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2892, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:51:13,959 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4925.3782, eval_time 0.6744, test_loss 3.2892, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:51:14,3 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7929, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:51:14,4 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4925.4209, eval_time 0.7174, test_loss 3.7929, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:51:14,8 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:51:14,17 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:14,28 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:51:14,43 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:14,73 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:51:14,83 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:15,487 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:15,502 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:16,369 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:16,384 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:16,629 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:16,639 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:18,32 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:18,52 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:19,92 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:19,126 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:19,159 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:19,186 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:19,277 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:19,292 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:19,916 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:19,943 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:20,91 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:20,111 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:20,536 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:20,554 INFO     [learner.py:606] ====Pushing takes 0.016927242279052734 s
2021-08-18:16:51:20,588 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:20,595 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:20,595 INFO     [param_server.py:410] Lock worker 1 with localStep 370 , while globalStep is 369

2021-08-18:16:51:21,35 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:21,44 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:22,759 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:22,768 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:23,495 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:23,513 INFO     [learner.py:606] ====Pushing takes 0.015592098236083984 s
2021-08-18:16:51:23,533 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:23,553 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:23,554 INFO     [param_server.py:410] Lock worker 2 with localStep 370 , while globalStep is 369

2021-08-18:16:51:23,971 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:23,982 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:25,558 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:25,572 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:26,263 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:26,294 INFO     [learner.py:606] ====Pushing takes 0.0292966365814209 s
2021-08-18:16:51:26,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:26,341 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:26,342 INFO     [param_server.py:381] ====After aggregation in epoch: 369, virtual_clock: 16168.457328635468, top_1: : 67.2475 % (2084.0), top_5: : 100.0 % (3099.0), test loss: 3.331798421012031, test len: 3099.0
2021-08-18:16:51:26,344 INFO     [param_server.py:410] Lock worker 3 with localStep 370 , while globalStep is 370

2021-08-18:16:51:26,344 INFO     [param_server.py:441] ====Epoch 371 completes 16 clients with loss 5.413081406342643, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:26,376 INFO     [param_server.py:450] ====Start to sample for epoch 371, global virtualClock: 16168.457328635468, round_duration: 70.62176153567286
2021-08-18:16:51:26,377 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:26,670 INFO     [param_server.py:553] For epoch: 371, median_reward: 413.5803685649917, dev: 827.1607371299834
2021-08-18:16:51:27,345 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2049, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:51:27,346 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4938.7636, eval_time 0.6599, test_loss 3.2049, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:51:27,347 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1506, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:51:27,348 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4938.7621, eval_time 0.6592, test_loss 3.1506, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:51:27,419 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:27,427 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:27,419 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3022, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:51:27,433 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4938.8523, eval_time 0.749, test_loss 3.3022, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:51:27,444 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:27,453 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:27,504 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:27,523 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:28,956 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:28,974 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:29,623 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:29,637 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:30,153 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:30,167 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:31,571 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:31,598 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:32,572 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:32,587 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:32,603 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:32,625 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:32,656 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:32,689 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:33,425 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:33,439 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:33,476 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:33,494 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:34,114 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:34,133 INFO     [learner.py:606] ====Pushing takes 0.017302513122558594 s
2021-08-18:16:51:34,165 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:34,171 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:34,172 INFO     [param_server.py:410] Lock worker 1 with localStep 371 , while globalStep is 370

2021-08-18:16:51:34,363 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:34,373 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:35,983 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:35,993 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:36,769 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:36,787 INFO     [learner.py:606] ====Pushing takes 0.015764951705932617 s
2021-08-18:16:51:36,808 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:36,814 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:36,815 INFO     [param_server.py:410] Lock worker 2 with localStep 371 , while globalStep is 370

2021-08-18:16:51:37,301 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:37,310 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:38,996 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:39,7 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:39,618 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:39,646 INFO     [learner.py:606] ====Pushing takes 0.027398347854614258 s
2021-08-18:16:51:39,679 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:39,689 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:39,689 INFO     [param_server.py:381] ====After aggregation in epoch: 370, virtual_clock: 16239.07909017114, top_1: : 65.4405 % (2028.0), top_5: : 100.0 % (3099.0), test loss: 3.2192285491360555, test len: 3099.0
2021-08-18:16:51:39,691 INFO     [param_server.py:410] Lock worker 3 with localStep 371 , while globalStep is 371

2021-08-18:16:51:39,692 INFO     [param_server.py:441] ====Epoch 372 completes 16 clients with loss 5.101794856419103, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:39,692 INFO     [param_server.py:450] ====Start to sample for epoch 372, global virtualClock: 16239.07909017114, round_duration: 70.62176153567286
2021-08-18:16:51:39,693 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:40,42 INFO     [param_server.py:553] For epoch: 372, median_reward: 463.4953836256027, dev: 926.9907672512054
2021-08-18:16:51:40,698 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3211, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:51:40,699 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4952.1158, eval_time 0.6221, test_loss 3.3211, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:51:40,699 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0585, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:51:40,700 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4952.1143, eval_time 0.6214, test_loss 3.0585, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:51:40,770 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:40,779 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:40,785 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:40,794 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:40,860 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0933, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:51:40,861 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4952.2806, eval_time 0.7855, test_loss 3.0933, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:51:40,919 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:40,952 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:42,737 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:42,765 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:42,996 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:43,8 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:43,702 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:43,716 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:45,342 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:45,356 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:45,985 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:45,996 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:46,55 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:46,68 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:46,75 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:46,88 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:46,603 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:46,615 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:46,651 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:46,660 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:47,89 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:47,108 INFO     [learner.py:606] ====Pushing takes 0.01741337776184082 s
2021-08-18:16:51:47,152 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:47,158 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:47,159 INFO     [param_server.py:410] Lock worker 1 with localStep 372 , while globalStep is 371

2021-08-18:16:51:47,571 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:47,606 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:49,231 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:49,244 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:49,956 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:49,975 INFO     [learner.py:606] ====Pushing takes 0.015604257583618164 s
2021-08-18:16:51:49,998 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:50,4 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:50,5 INFO     [param_server.py:410] Lock worker 2 with localStep 372 , while globalStep is 371

2021-08-18:16:51:50,550 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:50,561 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:52,357 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:52,372 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:52,985 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:53,14 INFO     [learner.py:606] ====Pushing takes 0.028183937072753906 s
2021-08-18:16:51:53,55 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:53,63 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:53,64 INFO     [param_server.py:381] ====After aggregation in epoch: 371, virtual_clock: 16309.700851706813, top_1: : 66.9248 % (2074.0), top_5: : 100.0 % (3099.0), test loss: 3.1576073670092697, test len: 3099.0
2021-08-18:16:51:53,65 INFO     [param_server.py:410] Lock worker 3 with localStep 372 , while globalStep is 372

2021-08-18:16:51:53,66 INFO     [param_server.py:441] ====Epoch 373 completes 16 clients with loss 4.37156910127692, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:53,66 INFO     [param_server.py:450] ====Start to sample for epoch 373, global virtualClock: 16309.700851706813, round_duration: 70.62176153567286
2021-08-18:16:51:53,67 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:53,399 INFO     [param_server.py:553] For epoch: 373, median_reward: 408.8935773433788, dev: 817.7871546867576
2021-08-18:16:51:53,940 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2307, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:51:53,941 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4965.358, eval_time 0.4977, test_loss 3.2307, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:51:53,984 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.218, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:51:53,985 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4965.3995, eval_time 0.5417, test_loss 3.218, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:51:54,12 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:51:54,27 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:54,63 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1817, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:51:54,66 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4965.4854, eval_time 0.6225, test_loss 3.1817, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:51:54,76 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:51:54,108 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:54,134 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:51:54,157 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:55,730 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:55,745 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:56,224 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:56,233 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:56,918 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:56,932 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:58,35 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:58,50 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:58,812 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:58,825 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:59,169 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:59,183 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:59,212 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:59,230 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:59,609 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:59,623 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:59,845 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:59,855 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:00,194 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:00,213 INFO     [learner.py:606] ====Pushing takes 0.017052650451660156 s
2021-08-18:16:52:00,246 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:00,256 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:52:00,257 INFO     [param_server.py:410] Lock worker 1 with localStep 373 , while globalStep is 372

2021-08-18:16:52:00,770 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:00,785 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:02,539 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:02,548 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:03,44 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:03,60 INFO     [learner.py:606] ====Pushing takes 0.014315366744995117 s
2021-08-18:16:52:03,81 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:03,87 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:52:03,88 INFO     [param_server.py:410] Lock worker 2 with localStep 373 , while globalStep is 372

2021-08-18:16:52:03,806 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:03,820 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:05,634 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:05,648 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:06,393 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:06,423 INFO     [learner.py:606] ====Pushing takes 0.028713464736938477 s
2021-08-18:16:52:06,468 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:06,476 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:52:06,477 INFO     [param_server.py:381] ====After aggregation in epoch: 372, virtual_clock: 16380.322613242486, top_1: : 67.0862 % (2079.0), top_5: : 100.0 % (3099.0), test loss: 3.210146365342317, test len: 3099.0
2021-08-18:16:52:06,480 INFO     [param_server.py:410] Lock worker 3 with localStep 373 , while globalStep is 373

2021-08-18:16:52:06,481 INFO     [param_server.py:441] ====Epoch 374 completes 16 clients with loss 5.518036196473952, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:06,481 INFO     [param_server.py:450] ====Start to sample for epoch 374, global virtualClock: 16380.322613242486, round_duration: 70.62176153567286
2021-08-18:16:52:06,482 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:06,834 INFO     [param_server.py:553] For epoch: 374, median_reward: 406.7942186220626, dev: 813.5884372441252
2021-08-18:16:52:07,501 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.896, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:52:07,502 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4978.9165, eval_time 0.6431, test_loss 2.896, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:52:07,518 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4799, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:52:07,519 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4978.936, eval_time 0.6597, test_loss 3.4799, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:52:07,545 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2507, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:52:07,546 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4978.966, eval_time 0.6888, test_loss 4.2507, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:52:07,583 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:52:07,591 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:52:07,596 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:52:07,605 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:07,623 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:52:07,635 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:09,165 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:09,184 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:09,755 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:09,774 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:10,213 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:52:10,224 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:11,463 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:11,483 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:12,347 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:12,375 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:12,613 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:12,627 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:12,749 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:12,770 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:13,157 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:13,178 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:13,359 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:13,373 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:13,713 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:13,731 INFO     [learner.py:606] ====Pushing takes 0.0171811580657959 s
2021-08-18:16:52:13,770 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:13,777 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:52:13,779 INFO     [param_server.py:410] Lock worker 1 with localStep 374 , while globalStep is 373

2021-08-18:16:52:14,439 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:14,449 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:16,155 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:16,175 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:16,886 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:16,902 INFO     [learner.py:606] ====Pushing takes 0.014743804931640625 s
2021-08-18:16:52:16,917 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:16,922 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:52:16,923 INFO     [param_server.py:410] Lock worker 2 with localStep 374 , while globalStep is 373

2021-08-18:16:52:17,598 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:17,616 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:19,368 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:19,379 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:19,996 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:20,25 INFO     [learner.py:606] ====Pushing takes 0.027947664260864258 s
2021-08-18:16:52:20,68 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:20,79 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:52:20,80 INFO     [param_server.py:381] ====After aggregation in epoch: 373, virtual_clock: 16450.94437477816, top_1: : 67.0216 % (2077.0), top_5: : 100.0 % (3099.0), test loss: 3.5422013843501055, test len: 3099.0
2021-08-18:16:52:20,83 INFO     [param_server.py:410] Lock worker 3 with localStep 374 , while globalStep is 374

2021-08-18:16:52:20,83 INFO     [param_server.py:441] ====Epoch 375 completes 16 clients with loss 3.980620662315395, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:20,84 INFO     [param_server.py:450] ====Start to sample for epoch 375, global virtualClock: 16450.94437477816, round_duration: 70.62176153567286
2021-08-18:16:52:20,85 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:20,437 INFO     [param_server.py:553] For epoch: 375, median_reward: 399.151892803926, dev: 798.303785607852
2021-08-18:16:52:21,45 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7957, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:52:21,46 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9878, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:52:21,46 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4992.4657, eval_time 0.5844, test_loss 3.7957, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:52:21,46 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4992.4606, eval_time 0.5843, test_loss 2.9878, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:52:21,51 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.428, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:52:21,52 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4992.4693, eval_time 0.5905, test_loss 3.428, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:52:21,115 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:52:21,120 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:52:21,121 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:52:21,123 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:21,130 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:21,133 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:22,593 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:22,607 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:23,417 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:23,426 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:23,476 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:23,488 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:24,231 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:24,241 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:24,920 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:24,947 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:25,850 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:25,878 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:26,382 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:26,396 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:26,718 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:26,744 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:26,880 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:26,890 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:27,310 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:27,328 INFO     [learner.py:606] ====Pushing takes 0.015955448150634766 s
2021-08-18:16:52:27,369 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:27,376 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:27,377 INFO     [param_server.py:410] Lock worker 1 with localStep 375 , while globalStep is 374

2021-08-18:16:52:28,119 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:28,138 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:28,294 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:28,315 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:30,107 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:30,117 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:30,511 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:30,527 INFO     [learner.py:606] ====Pushing takes 0.01440739631652832 s
2021-08-18:16:52:30,548 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:30,554 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:30,554 INFO     [param_server.py:410] Lock worker 2 with localStep 375 , while globalStep is 374

2021-08-18:16:52:30,758 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:30,784 INFO     [learner.py:606] ====Pushing takes 0.0253450870513916 s
2021-08-18:16:52:30,821 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:30,827 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:30,828 INFO     [param_server.py:381] ====After aggregation in epoch: 374, virtual_clock: 16524.81002972029, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 3.403850723195959, test len: 3099.0
2021-08-18:16:52:30,831 INFO     [param_server.py:410] Lock worker 3 with localStep 375 , while globalStep is 375

2021-08-18:16:52:30,831 INFO     [param_server.py:441] ====Epoch 376 completes 15 clients with loss 4.381852595809724, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:30,832 INFO     [param_server.py:450] ====Start to sample for epoch 376, global virtualClock: 16524.81002972029, round_duration: 73.86565494213346
2021-08-18:16:52:30,833 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:31,188 INFO     [param_server.py:553] For epoch: 376, median_reward: 395.1352298719836, dev: 790.2704597439672
2021-08-18:16:52:31,765 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.904, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:52:31,767 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 5003.1809, eval_time 0.564, test_loss 2.904, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:52:31,768 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5596, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:52:31,771 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 5003.1909, eval_time 0.5721, test_loss 3.5596, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:52:31,799 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.962, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:52:31,800 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 5003.2175, eval_time 0.5981, test_loss 2.962, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:52:31,829 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:31,835 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:31,842 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:31,843 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:31,868 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:31,878 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:33,251 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:33,260 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:34,132 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:34,144 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:34,233 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:34,244 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:34,953 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:34,963 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:35,562 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:35,588 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:36,499 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:36,527 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:36,823 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:36,843 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:37,443 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:37,471 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:37,529 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:37,543 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:38,64 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:38,82 INFO     [learner.py:606] ====Pushing takes 0.016039371490478516 s
2021-08-18:16:52:38,116 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:38,123 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:38,123 INFO     [param_server.py:410] Lock worker 1 with localStep 376 , while globalStep is 375

2021-08-18:16:52:38,685 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:38,698 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:38,812 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:38,831 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:40,661 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:40,670 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:41,245 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:41,262 INFO     [learner.py:606] ====Pushing takes 0.015640735626220703 s
2021-08-18:16:52:41,282 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:41,289 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:41,290 INFO     [param_server.py:410] Lock worker 2 with localStep 376 , while globalStep is 375

2021-08-18:16:52:41,433 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:41,462 INFO     [learner.py:606] ====Pushing takes 0.02833080291748047 s
2021-08-18:16:52:41,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:41,497 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:41,498 INFO     [param_server.py:381] ====After aggregation in epoch: 375, virtual_clock: 16598.675684662423, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 3.141859906691092, test len: 3099.0
2021-08-18:16:52:41,500 INFO     [param_server.py:410] Lock worker 3 with localStep 376 , while globalStep is 376

2021-08-18:16:52:41,501 INFO     [param_server.py:441] ====Epoch 377 completes 15 clients with loss 5.6923744201051445, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:41,501 INFO     [param_server.py:450] ====Start to sample for epoch 377, global virtualClock: 16598.675684662423, round_duration: 73.86565494213346
2021-08-18:16:52:41,502 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:41,855 INFO     [param_server.py:553] For epoch: 377, median_reward: 442.3636794111769, dev: 884.7273588223538
2021-08-18:16:52:42,494 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9828, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:52:42,496 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5013.9097, eval_time 0.6267, test_loss 2.9828, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:52:42,497 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3636, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:52:42,498 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5013.9175, eval_time 0.6311, test_loss 3.3636, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:52:42,505 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2269, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:52:42,506 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5013.9228, eval_time 0.6388, test_loss 3.2269, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:52:42,569 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:42,576 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:42,578 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:42,578 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:42,585 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:42,587 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:44,62 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:44,74 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:44,818 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:44,830 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:45,34 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:45,46 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:45,705 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:45,714 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:46,367 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:46,381 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:47,316 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:47,349 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:47,528 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:47,542 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:48,213 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:48,247 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:48,481 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:48,500 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:48,884 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:48,902 INFO     [learner.py:606] ====Pushing takes 0.016793489456176758 s
2021-08-18:16:52:48,933 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:48,939 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:48,939 INFO     [param_server.py:410] Lock worker 1 with localStep 377 , while globalStep is 376

2021-08-18:16:52:49,173 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:49,183 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:49,821 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:49,839 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:51,691 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:51,700 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:51,752 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:51,769 INFO     [learner.py:606] ====Pushing takes 0.014679908752441406 s
2021-08-18:16:52:51,786 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:51,791 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:51,792 INFO     [param_server.py:410] Lock worker 2 with localStep 377 , while globalStep is 376

2021-08-18:16:52:52,410 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:52,436 INFO     [learner.py:606] ====Pushing takes 0.024146318435668945 s
2021-08-18:16:52:52,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:52,469 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:52,470 INFO     [param_server.py:381] ====After aggregation in epoch: 376, virtual_clock: 16672.541339604555, top_1: : 66.3117 % (2055.0), top_5: : 100.0 % (3099.0), test loss: 3.1911008004788997, test len: 3099.0
2021-08-18:16:52:52,472 INFO     [param_server.py:410] Lock worker 3 with localStep 377 , while globalStep is 377

2021-08-18:16:52:52,472 INFO     [param_server.py:441] ====Epoch 378 completes 15 clients with loss 6.515397117640831, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:52,473 INFO     [param_server.py:450] ====Start to sample for epoch 378, global virtualClock: 16672.541339604555, round_duration: 73.86565494213346
2021-08-18:16:52:52,473 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:52,823 INFO     [param_server.py:553] For epoch: 378, median_reward: 462.4307427126904, dev: 924.8614854253808
2021-08-18:16:52:53,506 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0172, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:52:53,508 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5024.9218, eval_time 0.6574, test_loss 3.0172, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:52:53,539 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9096, Top-1 Accuracy: 716.0/1033 (0.6931), Top-5 Accuracy: 1.0
2021-08-18:16:52:53,540 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5024.9598, eval_time 0.6945, test_loss 3.9096, test_accuracy 0.6931, test_5_accuracy 1.0 

2021-08-18:16:52:53,573 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2817, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:52:53,574 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5024.9908, eval_time 0.7236, test_loss 3.2817, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:52:53,576 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:52:53,586 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:53,610 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:52:53,625 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:53,645 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:52:53,660 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:54,909 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:54,918 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:55,883 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:55,894 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:56,0 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:56,9 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:56,573 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:56,582 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:57,290 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:57,304 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:58,156 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:58,183 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:58,853 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:58,871 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:59,28 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:59,55 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:59,390 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:59,403 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:59,708 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:59,727 INFO     [learner.py:606] ====Pushing takes 0.017354726791381836 s
2021-08-18:16:52:59,758 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:59,766 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:59,766 INFO     [param_server.py:410] Lock worker 1 with localStep 378 , while globalStep is 377

2021-08-18:16:53:00,482 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:00,492 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:00,678 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:00,691 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:02,507 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:02,516 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:02,965 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:02,982 INFO     [learner.py:606] ====Pushing takes 0.01497507095336914 s
2021-08-18:16:53:02,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:03,1 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:03,2 INFO     [param_server.py:410] Lock worker 2 with localStep 378 , while globalStep is 377

2021-08-18:16:53:03,101 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:03,138 INFO     [learner.py:606] ====Pushing takes 0.032889366149902344 s
2021-08-18:16:53:03,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:03,173 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:03,174 INFO     [param_server.py:381] ====After aggregation in epoch: 377, virtual_clock: 16746.406994546687, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 3.4028203884760537, test len: 3099.0
2021-08-18:16:53:03,177 INFO     [param_server.py:410] Lock worker 3 with localStep 378 , while globalStep is 378

2021-08-18:16:53:03,178 INFO     [param_server.py:441] ====Epoch 379 completes 15 clients with loss 4.472151193686598, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:03,178 INFO     [param_server.py:450] ====Start to sample for epoch 379, global virtualClock: 16746.406994546687, round_duration: 73.86565494213346
2021-08-18:16:53:03,179 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:03,460 INFO     [param_server.py:553] For epoch: 379, median_reward: 414.8346497596703, dev: 829.6692995193406
2021-08-18:16:53:04,96 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.348, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:53:04,97 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5035.5115, eval_time 0.6112, test_loss 3.348, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:53:04,129 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3042, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:53:04,133 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5035.5523, eval_time 0.6486, test_loss 4.3042, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:53:04,134 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0872, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:53:04,138 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5035.5549, eval_time 0.6538, test_loss 3.0872, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:53:04,168 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:53:04,177 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:04,212 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:53:04,221 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:53:04,228 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:04,241 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:05,659 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:05,669 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:06,454 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:06,468 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:06,505 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:06,518 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:07,322 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:07,332 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:07,986 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:08,0 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:08,847 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:08,867 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:09,217 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:09,231 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:09,542 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:09,562 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:09,962 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:09,978 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:10,119 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:10,139 INFO     [learner.py:606] ====Pushing takes 0.017841577529907227 s
2021-08-18:16:53:10,171 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:10,178 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:10,178 INFO     [param_server.py:410] Lock worker 1 with localStep 379 , while globalStep is 378

2021-08-18:16:53:11,8 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:11,20 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:11,444 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:11,459 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:13,283 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:13,297 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:13,323 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:13,339 INFO     [learner.py:606] ====Pushing takes 0.015262126922607422 s
2021-08-18:16:53:13,354 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:13,360 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:13,360 INFO     [param_server.py:410] Lock worker 2 with localStep 379 , while globalStep is 378

2021-08-18:16:53:13,922 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:13,949 INFO     [learner.py:606] ====Pushing takes 0.025281667709350586 s
2021-08-18:16:53:13,975 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:13,982 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:13,982 INFO     [param_server.py:381] ====After aggregation in epoch: 378, virtual_clock: 16820.27264948882, top_1: : 66.0213 % (2046.0), top_5: : 100.0 % (3099.0), test loss: 3.579791640241941, test len: 3099.0
2021-08-18:16:53:13,985 INFO     [param_server.py:410] Lock worker 3 with localStep 379 , while globalStep is 379

2021-08-18:16:53:13,986 INFO     [param_server.py:441] ====Epoch 380 completes 15 clients with loss 5.363160454083654, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:13,986 INFO     [param_server.py:450] ====Start to sample for epoch 380, global virtualClock: 16820.27264948882, round_duration: 73.86565494213346
2021-08-18:16:53:13,987 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:14,309 INFO     [param_server.py:553] For epoch: 380, median_reward: 419.82138304111464, dev: 839.6427660822293
2021-08-18:16:53:14,896 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3972, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:53:14,896 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5046.3107, eval_time 0.5605, test_loss 3.3972, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:53:14,964 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:53:14,980 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5269, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:53:14,980 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:14,980 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3613, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:53:14,980 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5046.3975, eval_time 0.6465, test_loss 3.5269, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:53:14,981 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5046.4004, eval_time 0.649, test_loss 3.3613, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:53:15,51 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:53:15,58 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:53:15,69 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:15,78 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:16,472 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:16,483 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:17,342 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:17,352 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:17,410 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:17,420 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:18,125 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:18,139 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:18,771 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:18,785 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:19,542 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:19,557 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:20,169 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:20,183 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:20,343 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:20,370 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:20,998 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:21,14 INFO     [learner.py:606] ====Pushing takes 0.014214038848876953 s
2021-08-18:16:53:21,42 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:21,45 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:21,50 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:21,51 INFO     [param_server.py:410] Lock worker 1 with localStep 380 , while globalStep is 379

2021-08-18:16:53:21,59 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:21,944 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:21,955 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:22,309 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:22,319 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:24,287 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:24,301 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:24,329 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:24,348 INFO     [learner.py:606] ====Pushing takes 0.014786720275878906 s
2021-08-18:16:53:24,363 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:24,368 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:24,369 INFO     [param_server.py:410] Lock worker 2 with localStep 380 , while globalStep is 379

2021-08-18:16:53:24,988 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:25,12 INFO     [learner.py:606] ====Pushing takes 0.022914648056030273 s
2021-08-18:16:53:25,39 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:25,46 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:25,47 INFO     [param_server.py:381] ====After aggregation in epoch: 379, virtual_clock: 16894.13830443095, top_1: : 66.3117 % (2055.0), top_5: : 100.0 % (3099.0), test loss: 3.42845426665412, test len: 3099.0
2021-08-18:16:53:25,49 INFO     [param_server.py:410] Lock worker 3 with localStep 380 , while globalStep is 380

2021-08-18:16:53:25,50 INFO     [param_server.py:441] ====Epoch 381 completes 15 clients with loss 5.656229317296891, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:25,50 INFO     [param_server.py:450] ====Start to sample for epoch 381, global virtualClock: 16894.13830443095, round_duration: 73.86565494213346
2021-08-18:16:53:25,51 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:25,365 INFO     [param_server.py:541] Handle Wight 0.030317306518554688 | Send 0.31554079055786133
2021-08-18:16:53:25,366 INFO     [param_server.py:553] For epoch: 381, median_reward: 419.6719231974019, dev: 839.3438463948038
2021-08-18:16:53:25,925 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9498, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:53:25,926 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5057.3405, eval_time 0.538, test_loss 2.9498, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:53:25,963 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6255, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:53:25,966 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5057.3858, eval_time 0.5779, test_loss 3.6255, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:53:25,970 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:53:25,971 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5057.3881, eval_time 0.5828, test_loss 3.8, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:53:25,997 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:53:26,5 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:26,23 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:53:26,35 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:26,41 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:53:26,58 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:27,369 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:27,378 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:28,304 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:28,316 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:28,345 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:28,355 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:29,11 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:29,31 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:29,574 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:29,595 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:30,429 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:30,443 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:31,15 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:31,25 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:31,29 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:31,43 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:31,664 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:31,683 INFO     [learner.py:606] ====Pushing takes 0.01792430877685547 s
2021-08-18:16:53:31,713 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:31,719 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:31,720 INFO     [param_server.py:410] Lock worker 1 with localStep 381 , while globalStep is 380

2021-08-18:16:53:31,866 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:31,877 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:32,683 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:32,693 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:33,56 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:33,71 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:34,809 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:34,823 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:35,145 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:35,160 INFO     [learner.py:606] ====Pushing takes 0.014107465744018555 s
2021-08-18:16:53:35,176 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:35,181 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:35,181 INFO     [param_server.py:410] Lock worker 2 with localStep 381 , while globalStep is 380

2021-08-18:16:53:35,441 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:35,469 INFO     [learner.py:606] ====Pushing takes 0.025858402252197266 s
2021-08-18:16:53:35,496 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:35,503 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:35,503 INFO     [param_server.py:381] ====After aggregation in epoch: 380, virtual_clock: 16968.003959373083, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.4584145645300546, test len: 3099.0
2021-08-18:16:53:35,506 INFO     [param_server.py:410] Lock worker 3 with localStep 381 , while globalStep is 381

2021-08-18:16:53:35,506 INFO     [param_server.py:441] ====Epoch 382 completes 15 clients with loss 4.715740371702339, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:35,507 INFO     [param_server.py:450] ====Start to sample for epoch 382, global virtualClock: 16968.003959373083, round_duration: 73.86565494213346
2021-08-18:16:53:35,523 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:35,800 INFO     [param_server.py:553] For epoch: 382, median_reward: 399.3933443681254, dev: 798.7866887362508
2021-08-18:16:53:36,476 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0873, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:53:36,477 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5067.8911, eval_time 0.6519, test_loss 3.0873, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:53:36,486 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3388, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:53:36,487 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5067.9044, eval_time 0.6644, test_loss 3.3388, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:53:36,544 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:36,553 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:36,557 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:36,567 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9654, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:53:36,568 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5067.9879, eval_time 0.7452, test_loss 3.9654, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:53:36,578 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:36,652 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:36,670 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:38,57 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:38,71 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:38,854 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:38,865 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:38,866 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:38,881 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:39,826 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:39,839 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:40,544 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:40,557 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:41,234 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:41,243 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:41,772 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:41,784 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:41,978 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:41,992 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:42,552 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:42,570 INFO     [learner.py:606] ====Pushing takes 0.01702260971069336 s
2021-08-18:16:53:42,598 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:42,606 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:42,607 INFO     [param_server.py:410] Lock worker 1 with localStep 382 , while globalStep is 381

2021-08-18:16:53:42,652 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:42,662 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:43,404 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:43,418 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:43,862 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:43,871 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:45,712 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:45,726 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:46,31 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:46,47 INFO     [learner.py:606] ====Pushing takes 0.014306068420410156 s
2021-08-18:16:53:46,61 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:46,66 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:46,67 INFO     [param_server.py:410] Lock worker 2 with localStep 382 , while globalStep is 381

2021-08-18:16:53:46,408 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:46,432 INFO     [learner.py:606] ====Pushing takes 0.02268505096435547 s
2021-08-18:16:53:46,459 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:46,466 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:46,466 INFO     [param_server.py:381] ====After aggregation in epoch: 381, virtual_clock: 17041.869614315216, top_1: : 66.8925 % (2073.0), top_5: : 100.0 % (3099.0), test loss: 3.4638585602795637, test len: 3099.0
2021-08-18:16:53:46,469 INFO     [param_server.py:410] Lock worker 3 with localStep 382 , while globalStep is 382

2021-08-18:16:53:46,469 INFO     [param_server.py:441] ====Epoch 383 completes 15 clients with loss 5.121781420202946, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:46,469 INFO     [param_server.py:450] ====Start to sample for epoch 383, global virtualClock: 17041.869614315216, round_duration: 73.86565494213346
2021-08-18:16:53:46,470 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:46,771 INFO     [param_server.py:553] For epoch: 383, median_reward: 399.53191796888564, dev: 799.0638359377713
2021-08-18:16:53:47,400 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1441, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:53:47,401 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5078.8149, eval_time 0.6059, test_loss 3.1441, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:53:47,443 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6246, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:53:47,446 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5078.8662, eval_time 0.6518, test_loss 3.6246, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:53:47,438 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4028, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:53:47,453 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5078.8697, eval_time 0.6578, test_loss 3.4028, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:53:47,482 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:53:47,492 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:47,522 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:53:47,523 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:53:47,536 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:47,537 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:49,97 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:49,115 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:49,874 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:49,893 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:49,914 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:49,924 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:50,679 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:50,690 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:51,366 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:51,375 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:52,33 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:52,48 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:52,745 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:52,757 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:52,948 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:52,975 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:53,404 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:53,423 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:53,535 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:53,553 INFO     [learner.py:606] ====Pushing takes 0.016186237335205078 s
2021-08-18:16:53:53,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:53,583 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:53,585 INFO     [param_server.py:410] Lock worker 1 with localStep 383 , while globalStep is 382

2021-08-18:16:53:54,576 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:54,586 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:54,893 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:54,902 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:56,674 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:56,684 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:57,149 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:57,166 INFO     [learner.py:606] ====Pushing takes 0.01513361930847168 s
2021-08-18:16:53:57,186 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:57,191 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:57,192 INFO     [param_server.py:410] Lock worker 2 with localStep 383 , while globalStep is 382

2021-08-18:16:53:57,274 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:57,300 INFO     [learner.py:606] ====Pushing takes 0.02460765838623047 s
2021-08-18:16:53:57,327 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:57,334 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:57,335 INFO     [param_server.py:381] ====After aggregation in epoch: 382, virtual_clock: 17115.735269257348, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 3.3904990001961033, test len: 3099.0
2021-08-18:16:53:57,337 INFO     [param_server.py:410] Lock worker 3 with localStep 383 , while globalStep is 383

2021-08-18:16:53:57,338 INFO     [param_server.py:441] ====Epoch 384 completes 15 clients with loss 5.039010268968126, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:57,338 INFO     [param_server.py:450] ====Start to sample for epoch 384, global virtualClock: 17115.735269257348, round_duration: 73.86565494213346
2021-08-18:16:53:57,339 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:57,646 INFO     [param_server.py:553] For epoch: 384, median_reward: 433.4961419977147, dev: 866.9922839954294
2021-08-18:16:53:58,323 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0485, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:53:58,324 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5089.7384, eval_time 0.6539, test_loss 3.0485, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:53:58,331 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2429, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:53:58,334 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5089.7508, eval_time 0.6635, test_loss 3.2429, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:53:58,362 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3886, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:53:58,364 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5089.7836, eval_time 0.6936, test_loss 3.3886, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:53:58,405 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:53:58,414 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:53:58,414 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:58,422 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:58,439 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:53:58,458 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:59,871 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:59,886 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:00,553 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:00,565 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:00,762 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:54:00,771 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:01,534 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:01,544 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:02,283 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:02,292 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:02,901 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:02,914 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:03,324 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:03,334 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:03,691 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:03,710 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:04,266 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:04,277 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:04,402 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:04,422 INFO     [learner.py:606] ====Pushing takes 0.018470048904418945 s
2021-08-18:16:54:04,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:04,466 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:54:04,467 INFO     [param_server.py:410] Lock worker 1 with localStep 384 , while globalStep is 383

2021-08-18:16:54:04,887 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:04,900 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:05,568 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:05,586 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:07,192 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:07,208 INFO     [learner.py:606] ====Pushing takes 0.013980388641357422 s
2021-08-18:16:54:07,223 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:07,228 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:54:07,229 INFO     [param_server.py:410] Lock worker 2 with localStep 384 , while globalStep is 383

2021-08-18:16:54:07,354 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:07,363 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:07,941 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:07,965 INFO     [learner.py:606] ====Pushing takes 0.023318767547607422 s
2021-08-18:16:54:07,992 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:07,999 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:54:08,0 INFO     [param_server.py:381] ====After aggregation in epoch: 383, virtual_clock: 17189.60092419948, top_1: : 67.6347 % (2096.0), top_5: : 100.0 % (3099.0), test loss: 3.2266510989930897, test len: 3099.0
2021-08-18:16:54:08,2 INFO     [param_server.py:410] Lock worker 3 with localStep 384 , while globalStep is 384

2021-08-18:16:54:08,3 INFO     [param_server.py:441] ====Epoch 385 completes 15 clients with loss 5.554683474317485, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:08,3 INFO     [param_server.py:450] ====Start to sample for epoch 385, global virtualClock: 17189.60092419948, round_duration: 73.86565494213346
2021-08-18:16:54:08,4 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:08,291 INFO     [param_server.py:553] For epoch: 385, median_reward: 419.9675104837865, dev: 839.935020967573
2021-08-18:16:54:09,48 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7609, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:54:09,46 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2763, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:54:09,49 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5100.4662, eval_time 0.7352, test_loss 3.7609, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:54:09,49 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5100.4635, eval_time 0.7354, test_loss 3.2763, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:54:09,120 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:54:09,132 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:09,183 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:54:09,185 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0025, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:54:09,186 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5100.6059, eval_time 0.8722, test_loss 4.0025, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:54:09,199 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:09,266 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:54:09,301 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:10,141 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:10,164 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:11,91 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:11,102 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:11,587 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:11,598 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:12,766 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:12,805 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:13,398 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:13,407 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:14,148 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:14,157 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:14,337 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:14,348 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:14,653 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:14,667 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:15,349 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:15,363 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:15,754 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:15,765 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:15,988 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:15,997 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:16,23 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:16,41 INFO     [learner.py:606] ====Pushing takes 0.016785860061645508 s
2021-08-18:16:54:16,72 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:16,77 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:16,78 INFO     [param_server.py:410] Lock worker 1 with localStep 385 , while globalStep is 384

2021-08-18:16:54:16,948 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:16,970 INFO     [learner.py:606] ====Pushing takes 0.020153522491455078 s
2021-08-18:16:54:16,992 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:16,998 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:16,999 INFO     [param_server.py:410] Lock worker 3 with localStep 385 , while globalStep is 384

2021-08-18:16:54:18,384 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:18,401 INFO     [learner.py:606] ====Pushing takes 0.014625310897827148 s
2021-08-18:16:54:18,416 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:18,421 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:18,422 INFO     [param_server.py:381] ====After aggregation in epoch: 384, virtual_clock: 17266.710472548075, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 3.6799032202473394, test len: 3099.0
2021-08-18:16:54:18,424 INFO     [param_server.py:410] Lock worker 2 with localStep 385 , while globalStep is 385

2021-08-18:16:54:18,425 INFO     [param_server.py:441] ====Epoch 386 completes 14 clients with loss 6.1543435674961255, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:18,425 INFO     [param_server.py:450] ====Start to sample for epoch 386, global virtualClock: 17266.710472548075, round_duration: 77.10954834859407
2021-08-18:16:54:18,426 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:18,705 INFO     [param_server.py:553] For epoch: 386, median_reward: 411.7989709316876, dev: 823.5979418633752
2021-08-18:16:54:19,401 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9883, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:54:19,402 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5110.8193, eval_time 0.6617, test_loss 2.9883, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:54:19,448 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8309, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:54:19,449 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5110.863, eval_time 0.7077, test_loss 2.8309, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:54:19,466 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:54:19,474 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:19,479 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2372, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:54:19,483 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5110.9023, eval_time 0.7424, test_loss 3.2372, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:54:19,535 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:54:19,539 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:54:19,547 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:19,558 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:20,277 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:20,296 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:21,338 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:21,347 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:21,721 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:21,732 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:23,116 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:23,130 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:23,496 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:23,505 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:24,395 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:24,405 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:24,527 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:24,535 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:24,545 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:24,545 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:25,300 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:25,321 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:25,896 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:25,915 INFO     [learner.py:606] ====Pushing takes 0.017189502716064453 s
2021-08-18:16:54:25,937 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:25,945 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:25,946 INFO     [param_server.py:410] Lock worker 1 with localStep 386 , while globalStep is 385

2021-08-18:16:54:26,191 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:26,205 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:26,260 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:26,274 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:27,255 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:27,278 INFO     [learner.py:606] ====Pushing takes 0.020050525665283203 s
2021-08-18:16:54:27,302 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:27,308 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:27,309 INFO     [param_server.py:410] Lock worker 3 with localStep 386 , while globalStep is 385

2021-08-18:16:54:28,453 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:28,469 INFO     [learner.py:606] ====Pushing takes 0.015125274658203125 s
2021-08-18:16:54:28,486 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:28,491 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:28,492 INFO     [param_server.py:381] ====After aggregation in epoch: 385, virtual_clock: 17343.82002089667, top_1: : 67.2152 % (2083.0), top_5: : 100.0 % (3099.0), test loss: 3.0188292452582606, test len: 3099.0
2021-08-18:16:54:28,494 INFO     [param_server.py:410] Lock worker 2 with localStep 386 , while globalStep is 386

2021-08-18:16:54:28,494 INFO     [param_server.py:441] ====Epoch 387 completes 14 clients with loss 4.813509682391637, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:28,495 INFO     [param_server.py:450] ====Start to sample for epoch 387, global virtualClock: 17343.82002089667, round_duration: 77.10954834859407
2021-08-18:16:54:28,496 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:28,766 INFO     [param_server.py:553] For epoch: 387, median_reward: 407.58220442057615, dev: 815.1644088411523
2021-08-18:16:54:29,394 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7174, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:54:29,395 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5120.8122, eval_time 0.5945, test_loss 3.7174, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:54:29,401 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5486, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:54:29,401 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5120.821, eval_time 0.6018, test_loss 3.5486, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:54:29,433 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2091, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:54:29,436 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5120.8501, eval_time 0.6353, test_loss 3.2091, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:54:29,462 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:29,468 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:29,470 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:29,490 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:29,541 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:29,556 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:30,369 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:30,381 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:31,292 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:31,306 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:31,716 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:31,728 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:33,202 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:33,211 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:33,495 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:33,505 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:34,504 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:34,506 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:34,514 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:34,518 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:34,572 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:34,582 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:35,321 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:35,334 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:35,817 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:35,839 INFO     [learner.py:606] ====Pushing takes 0.019708633422851562 s
2021-08-18:16:54:35,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:35,879 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:35,905 INFO     [param_server.py:410] Lock worker 1 with localStep 387 , while globalStep is 386

2021-08-18:16:54:36,260 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:36,265 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:36,271 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:36,274 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:37,411 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:37,437 INFO     [learner.py:606] ====Pushing takes 0.02436089515686035 s
2021-08-18:16:54:37,461 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:37,468 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:37,469 INFO     [param_server.py:410] Lock worker 3 with localStep 387 , while globalStep is 386

2021-08-18:16:54:38,621 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:38,645 INFO     [learner.py:606] ====Pushing takes 0.020008563995361328 s
2021-08-18:16:54:38,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:38,667 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:38,668 INFO     [param_server.py:381] ====After aggregation in epoch: 386, virtual_clock: 17420.929569245265, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 3.49170007970598, test len: 3099.0
2021-08-18:16:54:38,671 INFO     [param_server.py:410] Lock worker 2 with localStep 387 , while globalStep is 387

2021-08-18:16:54:38,671 INFO     [param_server.py:441] ====Epoch 388 completes 14 clients with loss 7.074798140151936, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:38,672 INFO     [param_server.py:450] ====Start to sample for epoch 388, global virtualClock: 17420.929569245265, round_duration: 77.10954834859407
2021-08-18:16:54:38,672 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:38,944 INFO     [param_server.py:553] For epoch: 388, median_reward: 436.68836139943943, dev: 873.3767227988789
2021-08-18:16:54:39,562 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9758, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:54:39,563 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5130.9806, eval_time 0.5752, test_loss 3.9758, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:54:39,600 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3498, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:54:39,601 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5131.0147, eval_time 0.6085, test_loss 4.3498, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:54:39,640 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:39,647 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:39,674 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7815, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:54:39,679 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5131.099, eval_time 0.691, test_loss 3.7815, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:54:39,699 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:39,713 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:39,735 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:39,760 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:40,453 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:40,467 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:41,618 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:41,638 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:41,957 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:41,974 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:43,89 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:43,100 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:43,876 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:43,889 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:44,304 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:44,315 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:44,693 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:44,702 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:44,922 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:44,936 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:45,526 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:45,540 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:45,929 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:45,940 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:46,149 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:46,168 INFO     [learner.py:606] ====Pushing takes 0.01794743537902832 s
2021-08-18:16:54:46,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:46,210 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:46,211 INFO     [param_server.py:410] Lock worker 1 with localStep 388 , while globalStep is 387

2021-08-18:16:54:46,382 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:46,394 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:46,904 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:46,932 INFO     [learner.py:606] ====Pushing takes 0.026363372802734375 s
2021-08-18:16:54:46,958 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:46,964 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:46,964 INFO     [param_server.py:410] Lock worker 3 with localStep 388 , while globalStep is 387

2021-08-18:16:54:48,685 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:48,709 INFO     [learner.py:606] ====Pushing takes 0.02196669578552246 s
2021-08-18:16:54:48,736 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:48,742 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:48,743 INFO     [param_server.py:381] ====After aggregation in epoch: 387, virtual_clock: 17498.03911759386, top_1: : 62.5686 % (1939.0), top_5: : 100.0 % (3099.0), test loss: 4.035689353942871, test len: 3099.0
2021-08-18:16:54:48,746 INFO     [param_server.py:410] Lock worker 2 with localStep 388 , while globalStep is 388

2021-08-18:16:54:48,747 INFO     [param_server.py:441] ====Epoch 389 completes 14 clients with loss 5.869271290641864, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:48,748 INFO     [param_server.py:450] ====Start to sample for epoch 389, global virtualClock: 17498.03911759386, round_duration: 77.10954834859407
2021-08-18:16:54:48,751 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:49,101 INFO     [param_server.py:553] For epoch: 389, median_reward: 398.28609051950406, dev: 796.5721810390081
2021-08-18:16:54:49,672 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3033, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:54:49,673 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5141.0903, eval_time 0.5282, test_loss 3.3033, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:54:49,688 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0051, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:54:49,692 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5141.106, eval_time 0.5426, test_loss 4.0051, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:54:49,752 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3651, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:54:49,753 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5141.1729, eval_time 0.6082, test_loss 3.3651, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:54:49,757 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:54:49,760 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:54:49,769 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:49,770 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:49,807 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:54:49,829 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:50,505 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:50,524 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:51,659 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:51,679 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:51,957 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:51,975 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:53,144 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:53,156 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:54,38 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:54,51 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:54,508 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:54,517 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:54,786 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:54,799 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:55,216 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:55,234 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:56,3 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:56,22 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:56,100 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:56,111 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:56,509 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:56,520 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:56,582 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:56,605 INFO     [learner.py:606] ====Pushing takes 0.021669626235961914 s
2021-08-18:16:54:56,651 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:56,663 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:56,665 INFO     [param_server.py:410] Lock worker 1 with localStep 389 , while globalStep is 388

2021-08-18:16:54:57,132 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:57,163 INFO     [learner.py:606] ====Pushing takes 0.028676986694335938 s
2021-08-18:16:54:57,193 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:57,209 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:57,210 INFO     [param_server.py:410] Lock worker 3 with localStep 389 , while globalStep is 388

2021-08-18:16:54:58,795 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:58,817 INFO     [learner.py:606] ====Pushing takes 0.020731687545776367 s
2021-08-18:16:54:58,852 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:58,862 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:58,863 INFO     [param_server.py:381] ====After aggregation in epoch: 388, virtual_clock: 17575.148665942455, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 3.5578198532263436, test len: 3099.0
2021-08-18:16:54:58,866 INFO     [param_server.py:410] Lock worker 2 with localStep 389 , while globalStep is 389

2021-08-18:16:54:58,867 INFO     [param_server.py:441] ====Epoch 390 completes 14 clients with loss 5.92857460966825, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:58,868 INFO     [param_server.py:450] ====Start to sample for epoch 390, global virtualClock: 17575.148665942455, round_duration: 77.10954834859407
2021-08-18:16:54:58,870 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:59,241 INFO     [param_server.py:553] For epoch: 390, median_reward: 401.9038044231189, dev: 803.8076088462378
2021-08-18:16:54:59,794 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1932, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:54:59,795 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5151.2124, eval_time 0.5218, test_loss 3.1932, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:54:59,816 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0159, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:54:59,816 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5151.2307, eval_time 0.5384, test_loss 3.0159, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:54:59,869 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:54:59,881 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:54:59,882 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:59,887 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3212, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:54:59,891 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5151.3107, eval_time 0.6175, test_loss 3.3212, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:54:59,895 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:59,972 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:54:59,997 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:00,502 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:00,520 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:01,900 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:01,909 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:01,938 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:01,952 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:03,319 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:03,329 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:04,41 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:04,54 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:04,321 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:04,330 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:04,480 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:04,489 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:05,107 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:05,121 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:05,799 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:05,812 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:06,2 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:06,16 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:06,50 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:06,59 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:06,471 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:06,489 INFO     [learner.py:606] ====Pushing takes 0.01580953598022461 s
2021-08-18:16:55:06,530 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:06,539 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:06,539 INFO     [param_server.py:410] Lock worker 1 with localStep 390 , while globalStep is 389

2021-08-18:16:55:07,90 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:07,110 INFO     [learner.py:606] ====Pushing takes 0.019032716751098633 s
2021-08-18:16:55:07,131 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:07,139 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:07,139 INFO     [param_server.py:410] Lock worker 3 with localStep 390 , while globalStep is 389

2021-08-18:16:55:08,231 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:08,251 INFO     [learner.py:606] ====Pushing takes 0.015256881713867188 s
2021-08-18:16:55:08,278 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:08,286 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:08,287 INFO     [param_server.py:381] ====After aggregation in epoch: 389, virtual_clock: 17652.25821429105, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 3.176757393059907, test len: 3099.0
2021-08-18:16:55:08,290 INFO     [param_server.py:410] Lock worker 2 with localStep 390 , while globalStep is 390

2021-08-18:16:55:08,291 INFO     [param_server.py:441] ====Epoch 391 completes 14 clients with loss 4.488683517298305, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:08,291 INFO     [param_server.py:450] ====Start to sample for epoch 391, global virtualClock: 17652.25821429105, round_duration: 77.10954834859407
2021-08-18:16:55:08,292 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:08,650 INFO     [param_server.py:553] For epoch: 391, median_reward: 404.20057417140845, dev: 808.4011483428169
2021-08-18:16:55:09,339 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1395, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:55:09,340 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5160.7572, eval_time 0.6555, test_loss 3.1395, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:55:09,369 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9516, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:55:09,372 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5160.7864, eval_time 0.6876, test_loss 2.9516, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:55:09,410 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:55:09,425 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:09,439 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:55:09,442 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1332, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:55:09,443 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5160.8625, eval_time 0.7599, test_loss 3.1332, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:55:09,458 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:09,502 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:55:09,527 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:10,188 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:10,202 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:11,456 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:11,465 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:11,487 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:11,500 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:13,31 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:13,43 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:13,898 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:13,912 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:14,273 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:14,284 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:14,311 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:14,320 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:14,924 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:14,938 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:15,555 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:15,569 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:15,941 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:15,950 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:15,986 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:15,998 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:16,42 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:16,58 INFO     [learner.py:606] ====Pushing takes 0.014983415603637695 s
2021-08-18:16:55:16,89 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:16,95 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:16,96 INFO     [param_server.py:410] Lock worker 1 with localStep 391 , while globalStep is 390

2021-08-18:16:55:17,0 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:17,25 INFO     [learner.py:606] ====Pushing takes 0.02362370491027832 s
2021-08-18:16:55:17,50 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:17,58 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:17,59 INFO     [param_server.py:410] Lock worker 3 with localStep 391 , while globalStep is 390

2021-08-18:16:55:18,115 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:18,130 INFO     [learner.py:606] ====Pushing takes 0.013712644577026367 s
2021-08-18:16:55:18,146 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:18,152 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:18,152 INFO     [param_server.py:381] ====After aggregation in epoch: 390, virtual_clock: 17729.367762639646, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 3.074753733696761, test len: 3099.0
2021-08-18:16:55:18,155 INFO     [param_server.py:410] Lock worker 2 with localStep 391 , while globalStep is 391

2021-08-18:16:55:18,155 INFO     [param_server.py:441] ====Epoch 392 completes 14 clients with loss 4.7118906051136715, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:18,155 INFO     [param_server.py:450] ====Start to sample for epoch 392, global virtualClock: 17729.367762639646, round_duration: 77.10954834859407
2021-08-18:16:55:18,156 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:18,431 INFO     [param_server.py:553] For epoch: 392, median_reward: 415.31696118032454, dev: 830.6339223606491
2021-08-18:16:55:19,36 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3911, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:55:19,37 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5170.4545, eval_time 0.5714, test_loss 3.3911, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:55:19,78 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1882, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:55:19,79 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5170.4929, eval_time 0.6109, test_loss 3.1882, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:55:19,88 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.445, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:55:19,91 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5170.5103, eval_time 0.6262, test_loss 3.445, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:55:19,118 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:55:19,126 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:19,144 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:55:19,144 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:55:19,158 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:19,167 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:19,904 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:19,918 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:21,20 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:21,33 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:21,311 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:21,325 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:22,729 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:22,738 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:23,516 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:23,534 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:23,978 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:23,989 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:24,19 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:24,30 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:24,547 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:24,566 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:25,172 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:25,190 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:25,501 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:25,510 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:25,554 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:25,564 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:25,702 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:25,719 INFO     [learner.py:606] ====Pushing takes 0.01573324203491211 s
2021-08-18:16:55:25,751 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:25,761 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:25,761 INFO     [param_server.py:410] Lock worker 1 with localStep 392 , while globalStep is 391

2021-08-18:16:55:26,553 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:26,574 INFO     [learner.py:606] ====Pushing takes 0.019892454147338867 s
2021-08-18:16:55:26,598 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:26,604 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:26,605 INFO     [param_server.py:410] Lock worker 3 with localStep 392 , while globalStep is 391

2021-08-18:16:55:27,683 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:27,699 INFO     [learner.py:606] ====Pushing takes 0.014546632766723633 s
2021-08-18:16:55:27,716 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:27,722 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:27,723 INFO     [param_server.py:381] ====After aggregation in epoch: 391, virtual_clock: 17806.47731098824, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 3.3413946628570557, test len: 3099.0
2021-08-18:16:55:27,726 INFO     [param_server.py:410] Lock worker 2 with localStep 392 , while globalStep is 392

2021-08-18:16:55:27,727 INFO     [param_server.py:441] ====Epoch 393 completes 14 clients with loss 6.780090170004557, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:27,727 INFO     [param_server.py:450] ====Start to sample for epoch 393, global virtualClock: 17806.47731098824, round_duration: 77.10954834859407
2021-08-18:16:55:27,728 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:28,45 INFO     [param_server.py:553] For epoch: 393, median_reward: 438.266539102856, dev: 876.533078205712
2021-08-18:16:55:28,646 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5335, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:55:28,647 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5180.064, eval_time 0.5666, test_loss 3.5335, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:55:28,680 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0438, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:55:28,683 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5180.0976, eval_time 0.6015, test_loss 3.0438, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:55:28,715 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3066, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:55:28,716 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5180.1361, eval_time 0.6377, test_loss 3.3066, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:55:28,722 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:28,731 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:28,752 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:28,764 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:28,792 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:28,819 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:29,365 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:29,379 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:30,772 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:30,772 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:30,781 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:30,786 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:32,180 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:32,189 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:33,6 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:33,24 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:33,319 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:33,331 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:33,456 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:33,465 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:34,146 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:34,165 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:34,895 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:34,908 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:35,46 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:35,57 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:35,78 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:35,89 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:35,516 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:35,534 INFO     [learner.py:606] ====Pushing takes 0.01687908172607422 s
2021-08-18:16:55:35,565 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:35,571 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:35,572 INFO     [param_server.py:410] Lock worker 1 with localStep 393 , while globalStep is 392

2021-08-18:16:55:36,34 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:36,64 INFO     [learner.py:606] ====Pushing takes 0.028178930282592773 s
2021-08-18:16:55:36,87 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:36,93 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:36,94 INFO     [param_server.py:410] Lock worker 3 with localStep 393 , while globalStep is 392

2021-08-18:16:55:37,216 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:37,234 INFO     [learner.py:606] ====Pushing takes 0.016485214233398438 s
2021-08-18:16:55:37,252 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:37,257 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:37,258 INFO     [param_server.py:381] ====After aggregation in epoch: 392, virtual_clock: 17883.586859336836, top_1: : 66.2472 % (2053.0), top_5: : 100.0 % (3099.0), test loss: 3.29466677153552, test len: 3099.0
2021-08-18:16:55:37,261 INFO     [param_server.py:410] Lock worker 2 with localStep 393 , while globalStep is 393

2021-08-18:16:55:37,261 INFO     [param_server.py:441] ====Epoch 394 completes 14 clients with loss 6.2388128800711335, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:37,262 INFO     [param_server.py:450] ====Start to sample for epoch 394, global virtualClock: 17883.586859336836, round_duration: 77.10954834859407
2021-08-18:16:55:37,262 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:37,536 INFO     [param_server.py:553] For epoch: 394, median_reward: 409.8269468135122, dev: 819.6538936270244
2021-08-18:16:55:38,125 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2913, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:55:38,126 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5189.5434, eval_time 0.555, test_loss 3.2913, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:55:38,169 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1672, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:55:38,170 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5189.5845, eval_time 0.5976, test_loss 3.1672, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:55:38,194 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:38,202 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:38,211 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4974, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:55:38,215 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5189.6348, eval_time 0.6455, test_loss 3.4974, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:55:38,236 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:38,253 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:38,289 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:38,313 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:38,990 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:39,4 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:40,68 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:40,95 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:40,387 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:40,396 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:41,926 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:41,937 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:42,485 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:42,503 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:43,176 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:43,189 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:43,371 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:43,385 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:43,720 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:43,739 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:44,435 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:44,449 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:44,942 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:44,953 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:44,998 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:45,7 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:45,37 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:45,55 INFO     [learner.py:606] ====Pushing takes 0.01716136932373047 s
2021-08-18:16:55:45,86 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:45,94 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:45,95 INFO     [param_server.py:410] Lock worker 1 with localStep 394 , while globalStep is 393

2021-08-18:16:55:45,954 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:45,974 INFO     [learner.py:606] ====Pushing takes 0.01893782615661621 s
2021-08-18:16:55:46,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:46,14 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:46,15 INFO     [param_server.py:410] Lock worker 3 with localStep 394 , while globalStep is 393

2021-08-18:16:55:47,113 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:47,130 INFO     [learner.py:606] ====Pushing takes 0.01582169532775879 s
2021-08-18:16:55:47,145 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:47,152 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:47,153 INFO     [param_server.py:381] ====After aggregation in epoch: 393, virtual_clock: 17960.69640768543, top_1: : 65.989 % (2045.0), top_5: : 100.0 % (3099.0), test loss: 3.318623918074149, test len: 3099.0
2021-08-18:16:55:47,156 INFO     [param_server.py:410] Lock worker 2 with localStep 394 , while globalStep is 394

2021-08-18:16:55:47,156 INFO     [param_server.py:441] ====Epoch 395 completes 14 clients with loss 4.249307339110431, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:47,157 INFO     [param_server.py:450] ====Start to sample for epoch 395, global virtualClock: 17960.69640768543, round_duration: 77.10954834859407
2021-08-18:16:55:47,158 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:47,506 INFO     [param_server.py:553] For epoch: 395, median_reward: 389.4483201319726, dev: 778.8966402639452
2021-08-18:16:55:48,93 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1874, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:55:48,96 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5199.5135, eval_time 0.5574, test_loss 3.1874, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:55:48,108 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0701, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:55:48,109 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5199.5233, eval_time 0.5677, test_loss 3.0701, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:55:48,164 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:55:48,172 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:48,181 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:55:48,192 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5846, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:55:48,193 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5199.6127, eval_time 0.654, test_loss 3.5846, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:55:48,197 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:48,260 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:55:48,287 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:48,985 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:48,999 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:50,188 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:50,206 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:50,283 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:50,293 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:51,784 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:51,794 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:52,413 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:52,426 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:52,849 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:52,859 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:53,17 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:53,27 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:53,531 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:53,549 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:54,191 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:54,210 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:54,496 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:54,508 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:54,796 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:54,805 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:54,866 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:54,884 INFO     [learner.py:606] ====Pushing takes 0.017520904541015625 s
2021-08-18:16:55:54,913 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:54,919 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:54,919 INFO     [param_server.py:410] Lock worker 1 with localStep 395 , while globalStep is 394

2021-08-18:16:55:55,801 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:55,820 INFO     [learner.py:606] ====Pushing takes 0.01816105842590332 s
2021-08-18:16:55:55,846 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:55,854 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:55,855 INFO     [param_server.py:410] Lock worker 3 with localStep 395 , while globalStep is 394

2021-08-18:16:55:56,785 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:56,811 INFO     [learner.py:606] ====Pushing takes 0.023831605911254883 s
2021-08-18:16:55:56,828 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:56,833 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:56,834 INFO     [param_server.py:381] ====After aggregation in epoch: 394, virtual_clock: 18037.805956034026, top_1: : 66.6344 % (2065.0), top_5: : 100.0 % (3099.0), test loss: 3.280703700802944, test len: 3099.0
2021-08-18:16:55:56,837 INFO     [param_server.py:410] Lock worker 2 with localStep 395 , while globalStep is 395

2021-08-18:16:55:56,838 INFO     [param_server.py:441] ====Epoch 396 completes 14 clients with loss 4.952402918033286, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:56,838 INFO     [param_server.py:450] ====Start to sample for epoch 396, global virtualClock: 18037.805956034026, round_duration: 77.10954834859407
2021-08-18:16:55:56,839 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:57,108 INFO     [param_server.py:553] For epoch: 396, median_reward: 388.78643912713545, dev: 777.5728782542709
2021-08-18:16:55:57,717 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2903, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:55:57,719 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5209.1357, eval_time 0.5768, test_loss 3.2903, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:55:57,796 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9939, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:55:57,797 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5209.2114, eval_time 0.6553, test_loss 2.9939, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:55:57,811 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.631, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:55:57,812 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5209.2315, eval_time 0.6701, test_loss 3.631, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:55:57,826 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:55:57,839 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:57,888 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:55:57,893 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:55:57,908 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:57,912 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:58,542 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:58,564 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:59,683 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:59,704 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:00,13 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:00,23 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:01,171 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:01,197 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:02,71 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:02,84 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:02,295 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:02,306 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:02,658 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:02,669 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:03,140 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:03,153 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:03,786 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:03,799 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:03,830 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:03,841 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:04,186 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:04,200 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:04,269 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:04,288 INFO     [learner.py:606] ====Pushing takes 0.018161535263061523 s
2021-08-18:16:56:04,314 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:04,322 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:04,323 INFO     [param_server.py:410] Lock worker 1 with localStep 396 , while globalStep is 395

2021-08-18:16:56:04,818 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:04,837 INFO     [learner.py:606] ====Pushing takes 0.017945051193237305 s
2021-08-18:16:56:04,863 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:04,872 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:04,872 INFO     [param_server.py:410] Lock worker 3 with localStep 396 , while globalStep is 395

2021-08-18:16:56:06,385 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:06,404 INFO     [learner.py:606] ====Pushing takes 0.017557859420776367 s
2021-08-18:16:56:06,423 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:06,431 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:06,431 INFO     [param_server.py:381] ====After aggregation in epoch: 395, virtual_clock: 18114.91550438262, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.305087005650556, test len: 3099.0
2021-08-18:16:56:06,434 INFO     [param_server.py:410] Lock worker 2 with localStep 396 , while globalStep is 396

2021-08-18:16:56:06,435 INFO     [param_server.py:441] ====Epoch 397 completes 14 clients with loss 4.085491728384918, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:06,435 INFO     [param_server.py:450] ====Start to sample for epoch 397, global virtualClock: 18114.91550438262, round_duration: 77.10954834859407
2021-08-18:16:56:06,436 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:06,739 INFO     [param_server.py:553] For epoch: 397, median_reward: 380.7365182352349, dev: 761.4730364704698
2021-08-18:16:56:07,318 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3035, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:56:07,319 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5218.7335, eval_time 0.5457, test_loss 3.3035, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:56:07,321 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6311, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:56:07,322 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5218.7392, eval_time 0.5484, test_loss 3.6311, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:56:07,343 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5052, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:56:07,344 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5218.764, eval_time 0.572, test_loss 4.5052, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:56:07,399 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:56:07,402 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:56:07,407 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:07,411 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:07,413 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:56:07,434 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:08,146 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:08,160 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:09,170 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:09,191 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:09,592 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:09,601 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:10,788 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:10,797 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:11,502 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:11,520 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:11,976 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:11,995 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:12,499 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:12,511 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:12,606 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:12,620 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:13,208 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:13,226 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:13,548 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:13,562 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:13,797 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:13,815 INFO     [learner.py:606] ====Pushing takes 0.016923904418945312 s
2021-08-18:16:56:13,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:13,851 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:13,852 INFO     [param_server.py:410] Lock worker 1 with localStep 397 , while globalStep is 396

2021-08-18:16:56:14,74 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:14,86 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:14,534 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:14,562 INFO     [learner.py:606] ====Pushing takes 0.026537179946899414 s
2021-08-18:16:56:14,585 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:14,591 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:14,592 INFO     [param_server.py:410] Lock worker 3 with localStep 397 , while globalStep is 396

2021-08-18:16:56:16,361 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:16,379 INFO     [learner.py:606] ====Pushing takes 0.016230344772338867 s
2021-08-18:16:56:16,395 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:16,401 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:16,402 INFO     [param_server.py:381] ====After aggregation in epoch: 396, virtual_clock: 18192.025052731216, top_1: : 66.0536 % (2047.0), top_5: : 100.0 % (3099.0), test loss: 3.8132937131104647, test len: 3099.0
2021-08-18:16:56:16,406 INFO     [param_server.py:410] Lock worker 2 with localStep 397 , while globalStep is 397

2021-08-18:16:56:16,406 INFO     [param_server.py:441] ====Epoch 398 completes 14 clients with loss 4.028497409122662, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:16,407 INFO     [param_server.py:450] ====Start to sample for epoch 398, global virtualClock: 18192.025052731216, round_duration: 77.10954834859407
2021-08-18:16:56:16,408 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:16,724 INFO     [param_server.py:553] For epoch: 398, median_reward: 414.63910058748775, dev: 829.2782011749755
2021-08-18:16:56:17,316 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8942, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:56:17,317 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5228.7312, eval_time 0.5546, test_loss 2.8942, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:56:17,325 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1345, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:56:17,326 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5228.7433, eval_time 0.568, test_loss 3.1345, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:56:17,359 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1343, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:16:56:17,361 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5228.7803, eval_time 0.603, test_loss 3.1343, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:16:56:17,397 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:56:17,406 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:17,419 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:56:17,426 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:17,444 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:56:17,460 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:18,129 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:18,143 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:19,291 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:19,305 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:19,558 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:19,569 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:20,794 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:20,805 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:21,655 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:21,669 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:21,986 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:21,996 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:22,200 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:22,209 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:22,741 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:22,755 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:23,352 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:23,370 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:23,656 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:23,665 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:23,764 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:23,777 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:23,864 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:23,882 INFO     [learner.py:606] ====Pushing takes 0.017354965209960938 s
2021-08-18:16:56:23,910 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:23,919 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:23,920 INFO     [param_server.py:410] Lock worker 1 with localStep 398 , while globalStep is 397

2021-08-18:16:56:24,685 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:24,706 INFO     [learner.py:606] ====Pushing takes 0.018959999084472656 s
2021-08-18:16:56:24,732 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:24,738 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:24,739 INFO     [param_server.py:410] Lock worker 3 with localStep 398 , while globalStep is 397

2021-08-18:16:56:25,870 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:25,889 INFO     [learner.py:606] ====Pushing takes 0.017360448837280273 s
2021-08-18:16:56:25,905 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:25,909 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:25,910 INFO     [param_server.py:381] ====After aggregation in epoch: 397, virtual_clock: 18269.13460107981, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 3.0543037192137152, test len: 3099.0
2021-08-18:16:56:25,912 INFO     [param_server.py:410] Lock worker 2 with localStep 398 , while globalStep is 398

2021-08-18:16:56:25,913 INFO     [param_server.py:441] ====Epoch 399 completes 14 clients with loss 3.7243483233087153, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:25,913 INFO     [param_server.py:450] ====Start to sample for epoch 399, global virtualClock: 18269.13460107981, round_duration: 77.10954834859407
2021-08-18:16:56:25,914 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:26,196 INFO     [param_server.py:553] For epoch: 399, median_reward: 455.8583282496764, dev: 911.7166564993528
2021-08-18:16:56:26,854 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.197, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:56:26,855 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5238.269, eval_time 0.6206, test_loss 3.197, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:56:26,873 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5824, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:56:26,888 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5238.3047, eval_time 0.6579, test_loss 3.5824, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:56:26,898 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4465, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:56:26,899 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5238.3183, eval_time 0.6693, test_loss 3.4465, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:56:26,922 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:56:26,930 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:26,957 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:56:26,966 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:26,997 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:56:27,13 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:27,536 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:27,549 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:28,886 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:28,904 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:29,87 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:29,99 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:30,366 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:30,377 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:31,103 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:31,117 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:31,557 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:31,567 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:31,569 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:31,577 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:32,136 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:32,150 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:32,796 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:32,810 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:33,119 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:33,129 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:33,154 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:33,165 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:33,387 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:33,404 INFO     [learner.py:606] ====Pushing takes 0.015739917755126953 s
2021-08-18:16:56:33,429 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:33,435 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:33,436 INFO     [param_server.py:410] Lock worker 1 with localStep 399 , while globalStep is 398

2021-08-18:16:56:34,231 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:34,251 INFO     [learner.py:606] ====Pushing takes 0.0174558162689209 s
2021-08-18:16:56:34,274 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:34,280 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:34,281 INFO     [param_server.py:410] Lock worker 3 with localStep 399 , while globalStep is 398

2021-08-18:16:56:35,325 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:35,345 INFO     [learner.py:606] ====Pushing takes 0.01850605010986328 s
2021-08-18:16:56:35,361 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:35,367 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:35,368 INFO     [param_server.py:381] ====After aggregation in epoch: 398, virtual_clock: 18346.244149428407, top_1: : 65.021 % (2015.0), top_5: : 100.0 % (3099.0), test loss: 3.408656788705331, test len: 3099.0
2021-08-18:16:56:35,370 INFO     [param_server.py:410] Lock worker 2 with localStep 399 , while globalStep is 399

2021-08-18:16:56:35,371 INFO     [param_server.py:441] ====Epoch 400 completes 14 clients with loss 4.258990169608312, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:35,371 INFO     [param_server.py:450] ====Start to sample for epoch 400, global virtualClock: 18346.244149428407, round_duration: 77.10954834859407
2021-08-18:16:56:35,372 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:35,638 INFO     [param_server.py:553] For epoch: 400, median_reward: 391.0338624837657, dev: 782.0677249675314
2021-08-18:16:56:36,228 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9443, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:56:36,229 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5247.6431, eval_time 0.554, test_loss 2.9443, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:56:36,238 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7384, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:56:36,239 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5247.6561, eval_time 0.5661, test_loss 3.7384, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:56:36,267 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.8534, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:56:36,268 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5247.6875, eval_time 0.5961, test_loss 5.8534, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:56:36,305 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:36,307 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:36,314 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:36,318 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:36,350 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:36,370 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:36,902 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:36,915 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:38,110 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:38,124 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:38,401 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:38,410 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:39,560 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:39,569 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:40,307 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:40,321 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:40,758 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:40,768 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:41,130 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:41,139 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:41,446 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:41,460 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:42,61 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:42,124 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:42,417 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:42,426 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:42,759 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:42,773 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:42,776 INFO     [learner.py:606] ====Pushing takes 0.01526951789855957 s
2021-08-18:16:56:42,782 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:42,803 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:42,809 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:42,809 INFO     [param_server.py:410] Lock worker 1 with localStep 400 , while globalStep is 399

2021-08-18:16:56:43,410 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:43,432 INFO     [learner.py:606] ====Pushing takes 0.020787954330444336 s
2021-08-18:16:56:43,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:43,463 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:43,464 INFO     [param_server.py:410] Lock worker 3 with localStep 400 , while globalStep is 399

2021-08-18:16:56:44,988 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:45,15 INFO     [learner.py:606] ====Pushing takes 0.02401256561279297 s
2021-08-18:16:56:45,33 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:45,40 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:45,41 INFO     [param_server.py:381] ====After aggregation in epoch: 399, virtual_clock: 18423.353697777, top_1: : 67.0216 % (2077.0), top_5: : 100.0 % (3099.0), test loss: 4.1786946521865, test len: 3099.0
2021-08-18:16:56:45,43 INFO     [param_server.py:410] Lock worker 2 with localStep 400 , while globalStep is 400

2021-08-18:16:56:45,44 INFO     [param_server.py:441] ====Epoch 401 completes 14 clients with loss 4.721979427198867, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:45,44 INFO     [param_server.py:450] ====Start to sample for epoch 401, global virtualClock: 18423.353697777, round_duration: 77.10954834859407
2021-08-18:16:56:45,45 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:45,341 INFO     [param_server.py:541] Handle Wight 0.02482128143310547 | Send 0.297137975692749
2021-08-18:16:56:45,342 INFO     [param_server.py:553] For epoch: 401, median_reward: 426.8700058171326, dev: 853.7400116342652
2021-08-18:16:56:45,983 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.299, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:56:45,984 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5257.4013, eval_time 0.6081, test_loss 3.299, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:56:45,984 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8329, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:56:45,985 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5257.3993, eval_time 0.6044, test_loss 3.8329, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:56:46,54 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:46,57 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:46,62 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5426, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:56:46,63 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5257.4825, eval_time 0.6883, test_loss 3.5426, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:56:46,64 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:46,65 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:46,146 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:46,165 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:46,798 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:46,811 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:47,885 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:47,898 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:48,223 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:48,237 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:49,352 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:49,366 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:50,108 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:50,126 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:50,561 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:50,570 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:50,835 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:50,844 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:51,342 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:51,356 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:52,13 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:52,22 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:52,27 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:52,31 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:52,513 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:52,531 INFO     [learner.py:606] ====Pushing takes 0.016034603118896484 s
2021-08-18:16:56:52,533 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:52,544 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:52,566 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:52,573 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:52,574 INFO     [param_server.py:410] Lock worker 1 with localStep 401 , while globalStep is 400

2021-08-18:16:56:52,991 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:53,10 INFO     [learner.py:606] ====Pushing takes 0.017352581024169922 s
2021-08-18:16:56:53,34 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:53,40 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:53,41 INFO     [param_server.py:410] Lock worker 3 with localStep 401 , while globalStep is 400

2021-08-18:16:56:54,594 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:54,610 INFO     [learner.py:606] ====Pushing takes 0.014805316925048828 s
2021-08-18:16:56:54,627 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:54,633 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:54,634 INFO     [param_server.py:381] ====After aggregation in epoch: 400, virtual_clock: 18500.463246125597, top_1: : 66.7312 % (2068.0), top_5: : 100.0 % (3099.0), test loss: 3.558153673454567, test len: 3099.0
2021-08-18:16:56:54,636 INFO     [param_server.py:410] Lock worker 2 with localStep 401 , while globalStep is 401

2021-08-18:16:56:54,637 INFO     [param_server.py:441] ====Epoch 402 completes 14 clients with loss 3.7056532091013823, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:54,637 INFO     [param_server.py:450] ====Start to sample for epoch 402, global virtualClock: 18500.463246125597, round_duration: 77.10954834859407
2021-08-18:16:56:54,639 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:54,976 INFO     [param_server.py:553] For epoch: 402, median_reward: 423.7910673289535, dev: 847.582134657907
2021-08-18:16:56:55,562 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1557, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:56:55,563 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5266.9798, eval_time 0.5407, test_loss 3.1557, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:56:55,614 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0145, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:56:55,615 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5267.0291, eval_time 0.5899, test_loss 3.0145, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:56:55,624 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2358, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:56:55,635 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:56:55,624 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5267.0442, eval_time 0.6047, test_loss 3.2358, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:56:55,643 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:55,686 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:56:55,702 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:55,716 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:56:55,736 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:56,432 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:56,446 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:57,443 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:57,457 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:57,744 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:57,755 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:59,72 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:59,81 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:59,799 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:59,813 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:00,263 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:00,272 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:00,392 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:00,401 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:00,936 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:00,949 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:01,520 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:01,534 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:01,825 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:01,834 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:01,881 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:01,893 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:02,30 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:02,47 INFO     [learner.py:606] ====Pushing takes 0.01573038101196289 s
2021-08-18:16:57:02,78 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:02,88 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:02,89 INFO     [param_server.py:410] Lock worker 1 with localStep 402 , while globalStep is 401

2021-08-18:16:57:02,883 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:02,904 INFO     [learner.py:606] ====Pushing takes 0.019335269927978516 s
2021-08-18:16:57:02,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:02,933 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:02,934 INFO     [param_server.py:410] Lock worker 3 with localStep 402 , while globalStep is 401

2021-08-18:16:57:04,58 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:04,75 INFO     [learner.py:606] ====Pushing takes 0.015743732452392578 s
2021-08-18:16:57:04,95 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:04,100 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:04,101 INFO     [param_server.py:381] ====After aggregation in epoch: 401, virtual_clock: 18577.572794474192, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 3.135338834038487, test len: 3099.0
2021-08-18:16:57:04,103 INFO     [param_server.py:410] Lock worker 2 with localStep 402 , while globalStep is 402

2021-08-18:16:57:04,104 INFO     [param_server.py:441] ====Epoch 403 completes 14 clients with loss 3.6937831665775476, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:04,104 INFO     [param_server.py:450] ====Start to sample for epoch 403, global virtualClock: 18577.572794474192, round_duration: 77.10954834859407
2021-08-18:16:57:04,105 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:04,444 INFO     [param_server.py:553] For epoch: 403, median_reward: 421.9581678711071, dev: 843.9163357422142
2021-08-18:16:57:05,37 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5608, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:57:05,40 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5276.4568, eval_time 0.5513, test_loss 3.5608, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:57:05,54 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7838, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:57:05,58 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5276.4719, eval_time 0.5693, test_loss 2.7838, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:57:05,72 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0454, Top-1 Accuracy: 722.0/1033 (0.6989), Top-5 Accuracy: 1.0
2021-08-18:16:57:05,73 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5276.4929, eval_time 0.5848, test_loss 3.0454, test_accuracy 0.6989, test_5_accuracy 1.0 

2021-08-18:16:57:05,107 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:57:05,115 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:05,143 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:57:05,161 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:05,172 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:57:05,185 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:05,888 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:05,902 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:06,889 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:06,903 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:07,269 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:07,280 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:08,419 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:08,431 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:09,173 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:09,191 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:09,705 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:09,717 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:09,986 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:09,998 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:10,423 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:10,437 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:11,182 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:11,196 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:11,307 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:11,318 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:11,718 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:11,729 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:11,752 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:11,770 INFO     [learner.py:606] ====Pushing takes 0.01688218116760254 s
2021-08-18:16:57:11,809 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:11,817 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:11,818 INFO     [param_server.py:410] Lock worker 1 with localStep 403 , while globalStep is 402

2021-08-18:16:57:12,320 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:12,341 INFO     [learner.py:606] ====Pushing takes 0.01871323585510254 s
2021-08-18:16:57:12,365 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:12,371 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:12,372 INFO     [param_server.py:410] Lock worker 3 with localStep 403 , while globalStep is 402

2021-08-18:16:57:13,958 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:13,974 INFO     [learner.py:606] ====Pushing takes 0.015042304992675781 s
2021-08-18:16:57:13,995 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:14,1 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:14,2 INFO     [param_server.py:381] ====After aggregation in epoch: 402, virtual_clock: 18654.682342822787, top_1: : 67.5702 % (2094.0), top_5: : 100.0 % (3099.0), test loss: 3.1300107130297907, test len: 3099.0
2021-08-18:16:57:14,5 INFO     [param_server.py:410] Lock worker 2 with localStep 403 , while globalStep is 403

2021-08-18:16:57:14,5 INFO     [param_server.py:441] ====Epoch 404 completes 14 clients with loss 4.404373565526202, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:14,6 INFO     [param_server.py:450] ====Start to sample for epoch 404, global virtualClock: 18654.682342822787, round_duration: 77.10954834859407
2021-08-18:16:57:14,6 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:14,335 INFO     [param_server.py:553] For epoch: 404, median_reward: 425.19225094581856, dev: 850.3845018916371
2021-08-18:16:57:14,942 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.185, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:57:14,943 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5286.3601, eval_time 0.5639, test_loss 3.185, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:57:14,982 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2755, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:57:14,983 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5286.397, eval_time 0.6036, test_loss 3.2755, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:57:15,0 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2733, Top-1 Accuracy: 719.0/1033 (0.696), Top-5 Accuracy: 1.0
2021-08-18:16:57:15,0 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5286.4201, eval_time 0.6214, test_loss 3.2733, test_accuracy 0.696, test_5_accuracy 1.0 

2021-08-18:16:57:15,11 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:57:15,20 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:15,65 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:57:15,75 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:57:15,79 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:15,96 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:15,808 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:15,822 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:16,742 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:16,756 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:17,203 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:17,216 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:18,480 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:18,491 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:19,43 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:19,56 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:19,793 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:19,803 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:19,968 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:19,977 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:20,95 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:20,109 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:20,835 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:20,849 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:21,387 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:21,406 INFO     [learner.py:606] ====Pushing takes 0.01764702796936035 s
2021-08-18:16:57:21,441 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:21,449 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:21,449 INFO     [param_server.py:410] Lock worker 1 with localStep 404 , while globalStep is 403

2021-08-18:16:57:21,514 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:21,523 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:21,797 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:21,816 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:22,478 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:22,499 INFO     [learner.py:606] ====Pushing takes 0.018987417221069336 s
2021-08-18:16:57:22,520 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:22,526 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:22,526 INFO     [param_server.py:410] Lock worker 3 with localStep 404 , while globalStep is 403

2021-08-18:16:57:24,337 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:24,358 INFO     [learner.py:606] ====Pushing takes 0.014702796936035156 s
2021-08-18:16:57:24,373 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:24,378 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:24,396 INFO     [param_server.py:381] ====After aggregation in epoch: 403, virtual_clock: 18731.791891171382, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 3.2446029164172985, test len: 3099.0
2021-08-18:16:57:24,398 INFO     [param_server.py:410] Lock worker 2 with localStep 404 , while globalStep is 404

2021-08-18:16:57:24,399 INFO     [param_server.py:441] ====Epoch 405 completes 14 clients with loss 6.167627065861202, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:24,399 INFO     [param_server.py:450] ====Start to sample for epoch 405, global virtualClock: 18731.791891171382, round_duration: 77.10954834859407
2021-08-18:16:57:24,400 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:24,731 INFO     [param_server.py:553] For epoch: 405, median_reward: 404.75734722365127, dev: 809.5146944473025
2021-08-18:16:57:25,270 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1714, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:57:25,271 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5296.6878, eval_time 0.5036, test_loss 3.1714, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:57:25,311 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9009, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:57:25,314 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5296.728, eval_time 0.5444, test_loss 2.9009, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:57:25,340 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5026, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:57:25,340 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5296.7602, eval_time 0.5756, test_loss 3.5026, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:57:25,368 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:57:25,378 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:25,387 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:57:25,404 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:25,432 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:57:25,450 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:26,178 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:26,189 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:27,202 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:27,216 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:27,578 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:27,593 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:28,812 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:28,825 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:29,683 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:29,704 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:30,192 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:30,202 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:30,267 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:30,277 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:30,923 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:30,937 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:31,619 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:31,633 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:31,881 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:31,891 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:31,981 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:31,992 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:32,159 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:32,178 INFO     [learner.py:606] ====Pushing takes 0.01825118064880371 s
2021-08-18:16:57:32,210 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:32,217 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:32,217 INFO     [param_server.py:410] Lock worker 1 with localStep 405 , while globalStep is 404

2021-08-18:16:57:32,996 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:33,21 INFO     [learner.py:606] ====Pushing takes 0.022571325302124023 s
2021-08-18:16:57:33,44 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:33,55 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:33,56 INFO     [param_server.py:410] Lock worker 3 with localStep 405 , while globalStep is 404

2021-08-18:16:57:34,132 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:34,156 INFO     [learner.py:606] ====Pushing takes 0.02218341827392578 s
2021-08-18:16:57:34,173 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:34,178 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:34,179 INFO     [param_server.py:381] ====After aggregation in epoch: 404, virtual_clock: 18808.901439519977, top_1: : 67.183 % (2082.0), top_5: : 100.0 % (3099.0), test loss: 3.191631328038595, test len: 3099.0
2021-08-18:16:57:34,182 INFO     [param_server.py:410] Lock worker 2 with localStep 405 , while globalStep is 405

2021-08-18:16:57:34,182 INFO     [param_server.py:441] ====Epoch 406 completes 14 clients with loss 4.806835217650805, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:34,182 INFO     [param_server.py:450] ====Start to sample for epoch 406, global virtualClock: 18808.901439519977, round_duration: 77.10954834859407
2021-08-18:16:57:34,183 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:34,518 INFO     [param_server.py:553] For epoch: 406, median_reward: 381.2440051875472, dev: 762.4880103750944
2021-08-18:16:57:35,142 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2896, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:57:35,143 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5306.5603, eval_time 0.5801, test_loss 3.2896, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:57:35,225 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:35,234 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:35,261 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.268, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:57:35,262 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5306.6759, eval_time 0.6963, test_loss 3.268, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:57:35,357 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.401, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:57:35,358 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5306.7779, eval_time 0.795, test_loss 3.401, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:57:35,360 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:35,382 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:35,469 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:35,490 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:36,180 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:36,189 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:37,281 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:37,294 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:37,510 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:37,522 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:38,916 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:38,930 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:39,685 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:39,698 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:40,87 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:40,97 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:40,313 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:40,327 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:40,846 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:40,862 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:41,477 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:41,498 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:41,906 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:41,918 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:42,41 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:42,65 INFO     [learner.py:606] ====Pushing takes 0.02197551727294922 s
2021-08-18:16:57:42,97 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:42,106 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:42,107 INFO     [param_server.py:410] Lock worker 1 with localStep 406 , while globalStep is 405

2021-08-18:16:57:42,124 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:42,136 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:43,201 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:43,226 INFO     [learner.py:606] ====Pushing takes 0.0193941593170166 s
2021-08-18:16:57:43,250 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:43,257 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:43,257 INFO     [param_server.py:410] Lock worker 3 with localStep 406 , while globalStep is 405

2021-08-18:16:57:44,123 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:44,144 INFO     [learner.py:606] ====Pushing takes 0.016108274459838867 s
2021-08-18:16:57:44,160 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:44,165 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:44,166 INFO     [param_server.py:381] ====After aggregation in epoch: 405, virtual_clock: 18886.010987868573, top_1: : 65.9568 % (2044.0), top_5: : 100.0 % (3099.0), test loss: 3.3195224514713995, test len: 3099.0
2021-08-18:16:57:44,169 INFO     [param_server.py:410] Lock worker 2 with localStep 406 , while globalStep is 406

2021-08-18:16:57:44,170 INFO     [param_server.py:441] ====Epoch 407 completes 14 clients with loss 3.7035682756053663, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:44,170 INFO     [param_server.py:450] ====Start to sample for epoch 407, global virtualClock: 18886.010987868573, round_duration: 77.10954834859407
2021-08-18:16:57:44,171 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:44,514 INFO     [param_server.py:553] For epoch: 407, median_reward: 393.06451950941454, dev: 786.1290390188291
2021-08-18:16:57:45,109 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4006, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:57:45,110 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5316.5267, eval_time 0.5617, test_loss 3.4006, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:57:45,132 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0454, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:57:45,132 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5316.5464, eval_time 0.5829, test_loss 3.0454, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:57:45,142 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0809, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:57:45,142 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5316.5621, eval_time 0.5948, test_loss 4.0809, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:57:45,198 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:45,200 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:45,213 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:45,214 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:45,221 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:45,231 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:46,270 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:46,291 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:47,271 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:47,292 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:47,733 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:47,751 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:49,376 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:49,388 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:49,772 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:49,790 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:50,385 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:50,399 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:50,745 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:50,755 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:51,29 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:51,43 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:51,738 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:51,759 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:52,30 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:52,43 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:52,387 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:52,405 INFO     [learner.py:606] ====Pushing takes 0.016659021377563477 s
2021-08-18:16:57:52,436 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:52,443 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:52,444 INFO     [param_server.py:410] Lock worker 1 with localStep 407 , while globalStep is 406

2021-08-18:16:57:52,638 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:52,658 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:53,890 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:53,909 INFO     [learner.py:606] ====Pushing takes 0.01816415786743164 s
2021-08-18:16:57:53,948 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:53,954 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:53,954 INFO     [param_server.py:410] Lock worker 3 with localStep 407 , while globalStep is 406

2021-08-18:16:57:54,375 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:54,399 INFO     [learner.py:606] ====Pushing takes 0.022435426712036133 s
2021-08-18:16:57:54,416 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:54,421 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:54,422 INFO     [param_server.py:381] ====After aggregation in epoch: 406, virtual_clock: 18963.120536217168, top_1: : 66.6989 % (2067.0), top_5: : 100.0 % (3099.0), test loss: 3.5089626797923335, test len: 3099.0
2021-08-18:16:57:54,424 INFO     [param_server.py:410] Lock worker 2 with localStep 407 , while globalStep is 407

2021-08-18:16:57:54,425 INFO     [param_server.py:441] ====Epoch 408 completes 14 clients with loss 5.3392419873220796, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:54,425 INFO     [param_server.py:450] ====Start to sample for epoch 408, global virtualClock: 18963.120536217168, round_duration: 77.10954834859407
2021-08-18:16:57:54,426 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:54,766 INFO     [param_server.py:553] For epoch: 408, median_reward: 404.0145365857423, dev: 808.0290731714846
2021-08-18:16:57:55,500 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3769, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:57:55,501 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5326.9178, eval_time 0.6877, test_loss 3.3769, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:57:55,547 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4185, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:57:55,548 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5326.962, eval_time 0.7345, test_loss 3.4185, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:57:55,590 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1366, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:57:55,590 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:57:55,591 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5327.0107, eval_time 0.7804, test_loss 4.1366, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:57:55,604 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:55,615 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:57:55,629 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:55,660 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:57:55,682 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:56,451 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:56,465 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:57,472 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:57,489 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:57,924 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:57,933 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:59,355 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:59,374 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:00,116 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:00,137 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:00,630 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:00,643 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:00,781 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:00,800 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:01,351 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:01,373 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:02,210 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:02,237 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:02,570 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:02,584 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:02,760 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:02,778 INFO     [learner.py:606] ====Pushing takes 0.016721248626708984 s
2021-08-18:16:58:02,809 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:02,817 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:02,817 INFO     [param_server.py:410] Lock worker 1 with localStep 408 , while globalStep is 407

2021-08-18:16:58:02,945 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:02,968 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:04,190 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:04,210 INFO     [learner.py:606] ====Pushing takes 0.017961502075195312 s
2021-08-18:16:58:04,241 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:04,248 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:04,249 INFO     [param_server.py:410] Lock worker 3 with localStep 408 , while globalStep is 407

2021-08-18:16:58:04,897 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:04,916 INFO     [learner.py:606] ====Pushing takes 0.015354633331298828 s
2021-08-18:16:58:04,933 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:04,938 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:04,939 INFO     [param_server.py:381] ====After aggregation in epoch: 407, virtual_clock: 19040.230084565763, top_1: : 65.0532 % (2016.0), top_5: : 100.0 % (3099.0), test loss: 3.643986918308117, test len: 3099.0
2021-08-18:16:58:04,941 INFO     [param_server.py:410] Lock worker 2 with localStep 408 , while globalStep is 408

2021-08-18:16:58:04,942 INFO     [param_server.py:441] ====Epoch 409 completes 14 clients with loss 4.123869454897706, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:04,942 INFO     [param_server.py:450] ====Start to sample for epoch 409, global virtualClock: 19040.230084565763, round_duration: 77.10954834859407
2021-08-18:16:58:04,943 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:05,262 INFO     [param_server.py:553] For epoch: 409, median_reward: 407.42215370206617, dev: 814.8443074041323
2021-08-18:16:58:06,45 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.416, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:58:06,46 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5337.463, eval_time 0.7361, test_loss 3.416, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:58:06,46 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9751, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:58:06,46 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5337.4606, eval_time 0.732, test_loss 2.9751, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:58:06,104 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3849, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:58:06,106 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5337.5254, eval_time 0.7984, test_loss 3.3849, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:58:06,114 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:58:06,115 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:58:06,126 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:06,131 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:06,200 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:58:06,216 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:07,31 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:07,52 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:08,135 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:08,138 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:08,144 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:08,165 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:10,97 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:10,116 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:10,811 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:10,832 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:10,900 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:10,914 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:11,623 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:11,637 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:11,998 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:12,13 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:12,508 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:12,520 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:12,737 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:12,757 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:13,339 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:13,357 INFO     [learner.py:606] ====Pushing takes 0.01731705665588379 s
2021-08-18:16:58:13,387 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:13,393 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:13,394 INFO     [param_server.py:410] Lock worker 1 with localStep 409 , while globalStep is 408

2021-08-18:16:58:13,486 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:13,506 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:14,673 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:14,693 INFO     [learner.py:606] ====Pushing takes 0.018637657165527344 s
2021-08-18:16:58:14,715 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:14,720 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:14,721 INFO     [param_server.py:410] Lock worker 3 with localStep 409 , while globalStep is 408

2021-08-18:16:58:14,848 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:14,866 INFO     [learner.py:606] ====Pushing takes 0.015991926193237305 s
2021-08-18:16:58:14,885 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:14,890 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:14,891 INFO     [param_server.py:381] ====After aggregation in epoch: 408, virtual_clock: 19117.339632914358, top_1: : 66.8925 % (2073.0), top_5: : 100.0 % (3099.0), test loss: 3.258660451129631, test len: 3099.0
2021-08-18:16:58:14,893 INFO     [param_server.py:410] Lock worker 2 with localStep 409 , while globalStep is 409

2021-08-18:16:58:14,894 INFO     [param_server.py:441] ====Epoch 410 completes 14 clients with loss 6.455207120600697, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:14,894 INFO     [param_server.py:450] ====Start to sample for epoch 410, global virtualClock: 19117.339632914358, round_duration: 77.10954834859407
2021-08-18:16:58:14,895 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:15,229 INFO     [param_server.py:553] For epoch: 410, median_reward: 408.22860072764456, dev: 816.4572014552891
2021-08-18:16:58:15,995 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4112, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:58:15,996 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5347.4133, eval_time 0.7014, test_loss 3.4112, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:58:16,8 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1975, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:58:16,8 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5347.4226, eval_time 0.7136, test_loss 3.1975, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:58:16,30 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3831, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:58:16,31 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5347.4506, eval_time 0.736, test_loss 3.3831, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:58:16,68 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:58:16,77 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:58:16,81 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:16,93 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:16,112 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:58:16,135 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:16,857 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:16,871 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:17,874 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:17,888 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:18,292 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:18,306 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:19,757 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:19,776 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:20,450 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:20,478 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:21,177 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:21,195 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:21,384 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:21,405 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:21,749 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:21,783 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:22,662 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:22,682 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:22,966 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:22,978 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:23,233 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:23,248 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:23,255 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:23,276 INFO     [learner.py:606] ====Pushing takes 0.017218351364135742 s
2021-08-18:16:58:23,308 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:23,317 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:23,318 INFO     [param_server.py:410] Lock worker 1 with localStep 410 , while globalStep is 409

2021-08-18:16:58:24,419 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:24,439 INFO     [learner.py:606] ====Pushing takes 0.01831364631652832 s
2021-08-18:16:58:24,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:24,475 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:24,476 INFO     [param_server.py:410] Lock worker 3 with localStep 410 , while globalStep is 409

2021-08-18:16:58:25,341 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:25,360 INFO     [learner.py:606] ====Pushing takes 0.015186786651611328 s
2021-08-18:16:58:25,381 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:25,386 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:25,387 INFO     [param_server.py:381] ====After aggregation in epoch: 409, virtual_clock: 19194.449181262953, top_1: : 67.1184 % (2080.0), top_5: : 100.0 % (3099.0), test loss: 3.330591400464376, test len: 3099.0
2021-08-18:16:58:25,389 INFO     [param_server.py:410] Lock worker 2 with localStep 410 , while globalStep is 410

2021-08-18:16:58:25,390 INFO     [param_server.py:441] ====Epoch 411 completes 14 clients with loss 5.726458886509068, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:25,391 INFO     [param_server.py:450] ====Start to sample for epoch 411, global virtualClock: 19194.449181262953, round_duration: 77.10954834859407
2021-08-18:16:58:25,392 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:25,745 INFO     [param_server.py:553] For epoch: 411, median_reward: 438.68143821802255, dev: 877.3628764360451
2021-08-18:16:58:26,330 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5514, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:58:26,331 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5357.7481, eval_time 0.5478, test_loss 3.5514, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:58:26,364 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6361, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:58:26,365 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5357.7792, eval_time 0.5811, test_loss 3.6361, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:58:26,403 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:58:26,412 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:26,433 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:58:26,436 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.041, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:58:26,437 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5357.8566, eval_time 0.6581, test_loss 4.041, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:58:26,448 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:26,508 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:58:26,534 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:27,308 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:27,322 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:28,572 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:28,574 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:28,588 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:28,582 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:30,153 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:30,168 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:31,344 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:31,377 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:31,514 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:31,525 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:31,910 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:31,930 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:32,648 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:32,675 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:33,31 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:33,44 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:33,468 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:33,496 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:33,626 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:33,636 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:34,101 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:34,120 INFO     [learner.py:606] ====Pushing takes 0.016744613647460938 s
2021-08-18:16:58:34,150 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:34,156 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:34,156 INFO     [param_server.py:410] Lock worker 1 with localStep 411 , while globalStep is 410

2021-08-18:16:58:34,700 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:34,720 INFO     [learner.py:606] ====Pushing takes 0.018346786499023438 s
2021-08-18:16:58:34,742 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:34,748 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:34,749 INFO     [param_server.py:410] Lock worker 3 with localStep 411 , while globalStep is 410

2021-08-18:16:58:35,256 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:35,273 INFO     [learner.py:606] ====Pushing takes 0.014935970306396484 s
2021-08-18:16:58:35,290 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:35,295 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:35,296 INFO     [param_server.py:381] ====After aggregation in epoch: 410, virtual_clock: 19271.55872961155, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.7428340911865234, test len: 3099.0
2021-08-18:16:58:35,298 INFO     [param_server.py:410] Lock worker 2 with localStep 411 , while globalStep is 411

2021-08-18:16:58:35,299 INFO     [param_server.py:441] ====Epoch 412 completes 14 clients with loss 4.124452247193365, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:35,299 INFO     [param_server.py:450] ====Start to sample for epoch 412, global virtualClock: 19271.55872961155, round_duration: 77.10954834859407
2021-08-18:16:58:35,300 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:35,579 INFO     [param_server.py:553] For epoch: 412, median_reward: 427.3029171367882, dev: 854.6058342735764
2021-08-18:16:58:36,346 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4009, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:58:36,347 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5367.7642, eval_time 0.7215, test_loss 3.4009, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:58:36,347 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5907, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:58:36,348 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5367.7621, eval_time 0.7204, test_loss 3.5907, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:58:36,420 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:36,420 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:36,430 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:36,436 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:36,439 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2755, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:58:36,440 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5367.8597, eval_time 0.8166, test_loss 3.2755, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:58:36,510 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:36,529 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:37,354 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:37,374 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:38,405 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:38,423 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:38,690 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:38,702 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:40,173 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:40,188 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:40,955 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:40,976 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:41,529 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:41,541 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:41,576 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:41,597 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:42,186 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:42,213 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:43,116 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:43,156 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:43,241 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:43,254 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:43,739 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:43,757 INFO     [learner.py:606] ====Pushing takes 0.017029523849487305 s
2021-08-18:16:58:43,779 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:43,786 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:43,794 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:43,795 INFO     [param_server.py:410] Lock worker 1 with localStep 412 , while globalStep is 411

2021-08-18:16:58:43,805 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:45,99 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:45,118 INFO     [learner.py:606] ====Pushing takes 0.018218517303466797 s
2021-08-18:16:58:45,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:45,147 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:45,148 INFO     [param_server.py:410] Lock worker 3 with localStep 412 , while globalStep is 411

2021-08-18:16:58:45,817 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:45,834 INFO     [learner.py:606] ====Pushing takes 0.0152130126953125 s
2021-08-18:16:58:45,849 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:45,854 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:45,855 INFO     [param_server.py:381] ====After aggregation in epoch: 411, virtual_clock: 19348.668277960143, top_1: : 66.8925 % (2073.0), top_5: : 100.0 % (3099.0), test loss: 3.4223604180194713, test len: 3099.0
2021-08-18:16:58:45,857 INFO     [param_server.py:410] Lock worker 2 with localStep 412 , while globalStep is 412

2021-08-18:16:58:45,857 INFO     [param_server.py:441] ====Epoch 413 completes 14 clients with loss 5.72351166419066, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:45,858 INFO     [param_server.py:450] ====Start to sample for epoch 413, global virtualClock: 19348.668277960143, round_duration: 77.10954834859407
2021-08-18:16:58:45,858 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:46,144 INFO     [param_server.py:553] For epoch: 413, median_reward: 417.75510769730334, dev: 835.5102153946067
2021-08-18:16:58:46,934 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5814, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:58:46,935 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5378.3519, eval_time 0.757, test_loss 3.5814, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:58:46,935 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.224, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:58:46,935 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5378.3495, eval_time 0.7574, test_loss 3.224, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:58:46,975 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4094, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:58:46,976 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5378.3958, eval_time 0.799, test_loss 3.4094, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:58:47,3 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:47,10 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:47,18 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:47,26 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:47,48 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:47,63 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:47,959 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:47,973 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:49,317 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:49,351 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:49,453 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:49,471 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:51,128 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:51,138 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:51,878 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:51,892 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:52,237 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:52,247 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:52,478 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:52,488 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:53,78 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:53,99 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:53,944 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:53,978 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:54,0 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:54,11 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:54,265 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:54,299 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:54,696 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:54,715 INFO     [learner.py:606] ====Pushing takes 0.017292261123657227 s
2021-08-18:16:58:54,744 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:54,750 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:54,751 INFO     [param_server.py:410] Lock worker 1 with localStep 413 , while globalStep is 412

2021-08-18:16:58:55,431 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:55,451 INFO     [learner.py:606] ====Pushing takes 0.018492937088012695 s
2021-08-18:16:58:55,474 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:55,480 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:55,480 INFO     [param_server.py:410] Lock worker 3 with localStep 413 , while globalStep is 412

2021-08-18:16:58:56,456 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:56,473 INFO     [learner.py:606] ====Pushing takes 0.014855146408081055 s
2021-08-18:16:58:56,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:56,496 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:56,497 INFO     [param_server.py:381] ====After aggregation in epoch: 412, virtual_clock: 19425.77782630874, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.40494030934793, test len: 3099.0
2021-08-18:16:58:56,499 INFO     [param_server.py:410] Lock worker 2 with localStep 413 , while globalStep is 413

2021-08-18:16:58:56,499 INFO     [param_server.py:441] ====Epoch 414 completes 14 clients with loss 3.6584119174403713, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:56,499 INFO     [param_server.py:450] ====Start to sample for epoch 414, global virtualClock: 19425.77782630874, round_duration: 77.10954834859407
2021-08-18:16:58:56,500 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:56,844 INFO     [param_server.py:553] For epoch: 414, median_reward: 409.81559100455735, dev: 819.6311820091147
2021-08-18:16:58:57,431 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0091, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:58:57,432 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5388.8467, eval_time 0.5654, test_loss 3.0091, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:58:57,439 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6723, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:58:57,440 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5388.8572, eval_time 0.5731, test_loss 3.6723, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:58:57,476 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3352, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:58:57,477 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5388.8966, eval_time 0.6101, test_loss 3.3352, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:58:57,513 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:58:57,522 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:57,536 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:58:57,544 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:57,571 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:58:57,586 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:58,217 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:58,235 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:59,255 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:59,289 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:59,636 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:59,654 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:01,241 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:01,251 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:01,972 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:01,992 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:02,420 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:02,434 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:02,656 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:02,666 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:03,201 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:03,222 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:04,33 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:04,54 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:04,310 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:04,322 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:04,533 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:04,560 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:04,854 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:04,873 INFO     [learner.py:606] ====Pushing takes 0.01591324806213379 s
2021-08-18:16:59:04,897 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:04,905 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:04,906 INFO     [param_server.py:410] Lock worker 1 with localStep 414 , while globalStep is 413

2021-08-18:16:59:05,681 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:05,709 INFO     [learner.py:606] ====Pushing takes 0.026023387908935547 s
2021-08-18:16:59:05,733 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:05,739 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:05,739 INFO     [param_server.py:410] Lock worker 3 with localStep 414 , while globalStep is 413

2021-08-18:16:59:06,694 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:06,710 INFO     [learner.py:606] ====Pushing takes 0.014379739761352539 s
2021-08-18:16:59:06,726 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:06,731 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:06,732 INFO     [param_server.py:381] ====After aggregation in epoch: 413, virtual_clock: 19502.887374657334, top_1: : 66.2472 % (2053.0), top_5: : 100.0 % (3099.0), test loss: 3.3388679270391113, test len: 3099.0
2021-08-18:16:59:06,735 INFO     [param_server.py:410] Lock worker 2 with localStep 414 , while globalStep is 414

2021-08-18:16:59:06,735 INFO     [param_server.py:441] ====Epoch 415 completes 14 clients with loss 4.920435117013603, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:06,735 INFO     [param_server.py:450] ====Start to sample for epoch 415, global virtualClock: 19502.887374657334, round_duration: 77.10954834859407
2021-08-18:16:59:06,736 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:06,999 INFO     [param_server.py:553] For epoch: 415, median_reward: 385.8061659997763, dev: 771.6123319995526
2021-08-18:16:59:07,659 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8927, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:59:07,659 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5399.0735, eval_time 0.6196, test_loss 3.8927, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:59:07,667 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5861, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:59:07,668 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5399.0852, eval_time 0.6284, test_loss 3.5861, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:59:07,736 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:59:07,736 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9932, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:59:07,737 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5399.1564, eval_time 0.6996, test_loss 3.9932, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:59:07,742 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:59:07,749 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:07,751 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:07,817 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:59:07,835 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:08,536 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:08,549 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:09,739 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:09,760 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:10,84 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:10,94 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:11,578 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:11,597 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:12,413 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:12,440 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:12,925 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:12,937 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:13,92 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:13,111 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:13,797 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:13,824 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:14,634 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:14,661 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:14,691 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:14,705 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:15,116 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:15,135 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:15,241 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:15,259 INFO     [learner.py:606] ====Pushing takes 0.016850709915161133 s
2021-08-18:16:59:15,289 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:15,295 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:15,295 INFO     [param_server.py:410] Lock worker 1 with localStep 415 , while globalStep is 414

2021-08-18:16:59:16,301 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:16,322 INFO     [learner.py:606] ====Pushing takes 0.018818140029907227 s
2021-08-18:16:59:16,344 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:16,350 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:16,350 INFO     [param_server.py:410] Lock worker 3 with localStep 415 , while globalStep is 414

2021-08-18:16:59:16,939 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:16,955 INFO     [learner.py:606] ====Pushing takes 0.014371156692504883 s
2021-08-18:16:59:16,971 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:16,976 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:16,976 INFO     [param_server.py:381] ====After aggregation in epoch: 414, virtual_clock: 19579.99692300593, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 3.8240267788922346, test len: 3099.0
2021-08-18:16:59:16,979 INFO     [param_server.py:410] Lock worker 2 with localStep 415 , while globalStep is 415

2021-08-18:16:59:16,979 INFO     [param_server.py:441] ====Epoch 416 completes 14 clients with loss 4.394331155345522, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:16,980 INFO     [param_server.py:450] ====Start to sample for epoch 416, global virtualClock: 19579.99692300593, round_duration: 77.10954834859407
2021-08-18:16:59:16,980 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:17,273 INFO     [param_server.py:553] For epoch: 416, median_reward: 398.16451430280983, dev: 796.3290286056197
2021-08-18:16:59:17,945 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4175, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:59:17,946 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5409.3628, eval_time 0.6271, test_loss 3.4175, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:59:17,961 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2502, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:59:17,962 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5409.3759, eval_time 0.6388, test_loss 3.2502, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:59:18,9 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4904, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:59:18,10 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5409.4294, eval_time 0.6911, test_loss 3.4904, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:59:18,27 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:59:18,36 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:18,53 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:59:18,62 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:18,82 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:59:18,102 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:18,781 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:18,791 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:20,67 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:20,88 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:20,234 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:20,247 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:21,943 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:21,961 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:22,729 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:22,749 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:23,135 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:23,154 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:23,394 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:23,406 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:23,970 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:23,997 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:24,804 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:24,831 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:24,865 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:24,883 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:25,290 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:25,308 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:25,416 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:25,435 INFO     [learner.py:606] ====Pushing takes 0.017432689666748047 s
2021-08-18:16:59:25,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:25,480 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:25,481 INFO     [param_server.py:410] Lock worker 1 with localStep 416 , while globalStep is 415

2021-08-18:16:59:26,445 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:26,470 INFO     [learner.py:606] ====Pushing takes 0.023923635482788086 s
2021-08-18:16:59:26,491 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:26,497 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:26,498 INFO     [param_server.py:410] Lock worker 3 with localStep 416 , while globalStep is 415

2021-08-18:16:59:27,172 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:27,197 INFO     [learner.py:606] ====Pushing takes 0.022516965866088867 s
2021-08-18:16:59:27,212 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:27,217 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:27,218 INFO     [param_server.py:381] ====After aggregation in epoch: 415, virtual_clock: 19657.106471354524, top_1: : 66.1826 % (2051.0), top_5: : 100.0 % (3099.0), test loss: 3.3860517033824213, test len: 3099.0
2021-08-18:16:59:27,220 INFO     [param_server.py:410] Lock worker 2 with localStep 416 , while globalStep is 416

2021-08-18:16:59:27,220 INFO     [param_server.py:441] ====Epoch 417 completes 14 clients with loss 3.925708843723117, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:27,221 INFO     [param_server.py:450] ====Start to sample for epoch 417, global virtualClock: 19657.106471354524, round_duration: 77.10954834859407
2021-08-18:16:59:27,221 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:27,484 INFO     [param_server.py:553] For epoch: 417, median_reward: 425.3071774004192, dev: 850.6143548008384
2021-08-18:16:59:28,204 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.623, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:59:28,207 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5419.6213, eval_time 0.6735, test_loss 3.623, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:59:28,218 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.513, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:59:28,219 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5419.6362, eval_time 0.6854, test_loss 3.513, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:59:28,241 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4259, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:59:28,245 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5419.6643, eval_time 0.7135, test_loss 3.4259, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:59:28,290 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:59:28,293 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:59:28,298 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:28,309 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:28,315 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:59:28,336 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:29,222 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:29,236 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:30,364 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:30,378 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:30,746 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:30,755 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:31,992 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:32,7 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:33,9 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:33,36 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:33,460 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:33,478 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:33,625 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:33,636 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:34,364 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:34,398 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:35,199 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:35,220 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:35,281 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:35,292 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:35,396 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:35,407 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:35,722 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:35,741 INFO     [learner.py:606] ====Pushing takes 0.01660943031311035 s
2021-08-18:16:59:35,766 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:35,773 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:35,773 INFO     [param_server.py:410] Lock worker 1 with localStep 417 , while globalStep is 416

2021-08-18:16:59:36,379 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:36,400 INFO     [learner.py:606] ====Pushing takes 0.019198894500732422 s
2021-08-18:16:59:36,426 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:36,432 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:36,433 INFO     [param_server.py:410] Lock worker 3 with localStep 417 , while globalStep is 416

2021-08-18:16:59:37,720 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:37,740 INFO     [learner.py:606] ====Pushing takes 0.017423391342163086 s
2021-08-18:16:59:37,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:37,762 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:37,762 INFO     [param_server.py:381] ====After aggregation in epoch: 416, virtual_clock: 19734.21601970312, top_1: : 66.3763 % (2057.0), top_5: : 100.0 % (3099.0), test loss: 3.520625631014506, test len: 3099.0
2021-08-18:16:59:37,764 INFO     [param_server.py:410] Lock worker 2 with localStep 417 , while globalStep is 417

2021-08-18:16:59:37,765 INFO     [param_server.py:441] ====Epoch 418 completes 14 clients with loss 4.684069698135674, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:37,765 INFO     [param_server.py:450] ====Start to sample for epoch 418, global virtualClock: 19734.21601970312, round_duration: 77.10954834859407
2021-08-18:16:59:37,766 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:38,71 INFO     [param_server.py:553] For epoch: 418, median_reward: 423.4222191965079, dev: 846.8444383930158
2021-08-18:16:59:38,706 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3089, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:59:38,712 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5430.1292, eval_time 0.6078, test_loss 3.3089, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:59:38,718 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1403, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:59:38,718 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5430.1327, eval_time 0.6141, test_loss 3.1403, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:59:38,786 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:38,790 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:38,794 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:38,796 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3889, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:59:38,797 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5430.217, eval_time 0.693, test_loss 3.3889, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:59:38,798 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:38,857 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:38,883 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:39,755 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:39,775 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:41,17 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:41,38 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:41,44 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:41,48 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:42,762 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:42,776 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:43,390 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:43,411 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:43,699 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:43,710 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:43,990 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:44,8 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:44,701 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:44,722 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:45,421 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:45,431 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:45,543 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:45,570 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:45,888 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:45,909 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:46,117 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:46,136 INFO     [learner.py:606] ====Pushing takes 0.018184423446655273 s
2021-08-18:16:59:46,161 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:46,169 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:46,169 INFO     [param_server.py:410] Lock worker 1 with localStep 418 , while globalStep is 417

2021-08-18:16:59:47,152 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:47,171 INFO     [learner.py:606] ====Pushing takes 0.01780557632446289 s
2021-08-18:16:59:47,195 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:47,202 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:47,203 INFO     [param_server.py:410] Lock worker 3 with localStep 418 , while globalStep is 417

2021-08-18:16:59:47,609 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:47,625 INFO     [learner.py:606] ====Pushing takes 0.014619112014770508 s
2021-08-18:16:59:47,640 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:47,645 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:47,645 INFO     [param_server.py:381] ====After aggregation in epoch: 417, virtual_clock: 19811.325568051714, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 3.279329224869057, test len: 3099.0
2021-08-18:16:59:47,647 INFO     [param_server.py:410] Lock worker 2 with localStep 418 , while globalStep is 418

2021-08-18:16:59:47,648 INFO     [param_server.py:441] ====Epoch 419 completes 14 clients with loss 3.796591189356452, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:47,648 INFO     [param_server.py:450] ====Start to sample for epoch 419, global virtualClock: 19811.325568051714, round_duration: 77.10954834859407
2021-08-18:16:59:47,649 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:47,949 INFO     [param_server.py:553] For epoch: 419, median_reward: 451.90982807609004, dev: 903.8196561521801
2021-08-18:16:59:48,627 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7605, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:59:48,628 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5440.045, eval_time 0.6277, test_loss 3.7605, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:59:48,659 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3294, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:59:48,660 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5440.0738, eval_time 0.6594, test_loss 3.3294, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:59:48,688 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.913, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:59:48,688 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5440.1078, eval_time 0.6926, test_loss 3.913, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:59:48,698 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:48,707 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:48,727 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:48,742 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:48,761 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:48,780 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:49,658 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:49,668 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:50,790 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:50,804 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:50,970 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:50,981 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:52,449 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:52,464 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:53,592 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:53,607 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:53,774 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:53,802 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:54,19 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:54,33 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:55,257 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:55,267 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:55,276 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:55,297 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:55,847 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:55,866 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:56,243 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:56,270 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:56,945 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:56,964 INFO     [learner.py:606] ====Pushing takes 0.016852140426635742 s
2021-08-18:16:59:56,967 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:56,993 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:56,994 INFO     [learner.py:606] ====Pushing takes 0.025692462921142578 s
2021-08-18:16:59:57,1 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:57,2 INFO     [param_server.py:410] Lock worker 1 with localStep 419 , while globalStep is 418

2021-08-18:16:59:57,19 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:57,25 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:57,26 INFO     [param_server.py:410] Lock worker 3 with localStep 419 , while globalStep is 418

2021-08-18:16:59:57,713 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:57,730 INFO     [learner.py:606] ====Pushing takes 0.015616893768310547 s
2021-08-18:16:59:57,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:57,754 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:57,755 INFO     [param_server.py:381] ====After aggregation in epoch: 418, virtual_clock: 19888.43511640031, top_1: : 66.7957 % (2070.0), top_5: : 100.0 % (3099.0), test loss: 3.667647564852679, test len: 3099.0
2021-08-18:16:59:57,757 INFO     [param_server.py:410] Lock worker 2 with localStep 419 , while globalStep is 419

2021-08-18:16:59:57,758 INFO     [param_server.py:441] ====Epoch 420 completes 14 clients with loss 6.296435013121643, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:57,759 INFO     [param_server.py:450] ====Start to sample for epoch 420, global virtualClock: 19888.43511640031, round_duration: 77.10954834859407
2021-08-18:16:59:57,759 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:58,46 INFO     [param_server.py:553] For epoch: 420, median_reward: 436.93789042477323, dev: 873.8757808495465
2021-08-18:16:59:58,759 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4046, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:59:58,759 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5450.1766, eval_time 0.6679, test_loss 3.4046, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:59:58,802 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1326, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:59:58,802 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5450.2165, eval_time 0.7107, test_loss 3.1326, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:59:58,831 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6864, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:59:58,834 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5450.2541, eval_time 0.7428, test_loss 3.6864, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:59:58,850 INFO     [learner.py:526] ====Start train round 420
2021-08-18:16:59:58,859 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:58,895 INFO     [learner.py:526] ====Start train round 420
2021-08-18:16:59:58,911 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:58,914 INFO     [learner.py:526] ====Start train round 420
2021-08-18:16:59:58,932 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:59,685 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:59,700 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:00,917 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:00,938 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:01,104 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:01,116 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:02,377 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:02,391 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:03,816 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:03,835 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:03,879 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:03,919 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:04,4 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:04,31 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:05,214 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:05,241 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:05,433 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:05,442 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:06,105 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:06,117 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:06,119 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:06,138 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:06,920 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:06,940 INFO     [learner.py:606] ====Pushing takes 0.017868757247924805 s
2021-08-18:17:00:06,963 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:06,971 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:06,972 INFO     [param_server.py:410] Lock worker 1 with localStep 420 , while globalStep is 419

2021-08-18:17:00:07,354 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:07,382 INFO     [learner.py:606] ====Pushing takes 0.0260467529296875 s
2021-08-18:17:00:07,406 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:07,412 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:07,413 INFO     [param_server.py:410] Lock worker 3 with localStep 420 , while globalStep is 419

2021-08-18:17:00:07,772 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:07,789 INFO     [learner.py:606] ====Pushing takes 0.014823675155639648 s
2021-08-18:17:00:07,805 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:07,809 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:07,810 INFO     [param_server.py:381] ====After aggregation in epoch: 419, virtual_clock: 19965.544664748904, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 3.4078888517838934, test len: 3099.0
2021-08-18:17:00:07,812 INFO     [param_server.py:410] Lock worker 2 with localStep 420 , while globalStep is 420

2021-08-18:17:00:07,813 INFO     [param_server.py:441] ====Epoch 421 completes 14 clients with loss 2.8835569415330515, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:07,813 INFO     [param_server.py:450] ====Start to sample for epoch 421, global virtualClock: 19965.544664748904, round_duration: 77.10954834859407
2021-08-18:17:00:07,814 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:08,101 INFO     [param_server.py:541] Handle Wight 0.020730972290039062 | Send 0.2877805233001709
2021-08-18:17:00:08,102 INFO     [param_server.py:553] For epoch: 421, median_reward: 423.9359776765429, dev: 847.8719553530858
2021-08-18:17:00:08,742 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1221, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:00:08,749 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5460.1661, eval_time 0.6003, test_loss 3.1221, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:00:08,754 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9954, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:00:08,755 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5460.1696, eval_time 0.6063, test_loss 2.9954, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:00:08,833 INFO     [learner.py:526] ====Start train round 421
2021-08-18:17:00:08,834 INFO     [learner.py:526] ====Start train round 421
2021-08-18:17:00:08,840 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5011, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:00:08,841 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5460.2607, eval_time 0.6942, test_loss 4.5011, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:00:08,842 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:08,848 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:08,912 INFO     [learner.py:526] ====Start train round 421
2021-08-18:17:00:08,940 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:09,731 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:09,743 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:11,52 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:11,80 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:11,141 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:11,150 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:12,810 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:12,825 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:13,825 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:13,836 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:13,977 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:14,10 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:14,296 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:14,316 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:15,371 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:15,385 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:15,438 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:15,449 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:15,946 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:15,955 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:16,122 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:16,149 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:16,790 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:16,809 INFO     [learner.py:606] ====Pushing takes 0.017554521560668945 s
2021-08-18:17:00:16,843 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:16,849 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:16,850 INFO     [param_server.py:410] Lock worker 1 with localStep 421 , while globalStep is 420

2021-08-18:17:00:17,100 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:17,126 INFO     [learner.py:606] ====Pushing takes 0.0240023136138916 s
2021-08-18:17:00:17,148 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:17,154 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:17,154 INFO     [param_server.py:410] Lock worker 3 with localStep 421 , while globalStep is 420

2021-08-18:17:00:17,876 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:17,892 INFO     [learner.py:606] ====Pushing takes 0.01524043083190918 s
2021-08-18:17:00:17,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:17,913 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:17,914 INFO     [param_server.py:381] ====After aggregation in epoch: 420, virtual_clock: 20042.6542130975, top_1: : 66.0213 % (2046.0), top_5: : 100.0 % (3099.0), test loss: 3.5395393802060027, test len: 3099.0
2021-08-18:17:00:17,920 INFO     [param_server.py:410] Lock worker 2 with localStep 421 , while globalStep is 421

2021-08-18:17:00:17,921 INFO     [param_server.py:441] ====Epoch 422 completes 14 clients with loss 5.6115807016019685, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:17,921 INFO     [param_server.py:450] ====Start to sample for epoch 422, global virtualClock: 20042.6542130975, round_duration: 77.10954834859407
2021-08-18:17:00:17,922 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:18,202 INFO     [param_server.py:553] For epoch: 422, median_reward: 412.95529938834056, dev: 825.9105987766811
2021-08-18:17:00:18,873 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3767, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:00:18,874 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5470.2884, eval_time 0.637, test_loss 3.3767, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:00:18,936 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6258, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:00:18,937 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5470.3544, eval_time 0.7001, test_loss 3.6258, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:00:18,941 INFO     [learner.py:526] ====Start train round 422
2021-08-18:17:00:18,954 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.306, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:00:18,957 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5470.3769, eval_time 0.7211, test_loss 5.306, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:00:18,958 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:19,19 INFO     [learner.py:526] ====Start train round 422
2021-08-18:17:00:19,27 INFO     [learner.py:526] ====Start train round 422
2021-08-18:17:00:19,28 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:19,48 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:19,893 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:19,914 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:21,124 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:21,151 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:21,200 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:21,209 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:22,872 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:22,886 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:23,826 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:23,843 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:23,881 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:23,908 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:24,266 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:24,284 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:25,200 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:25,227 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:25,441 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:25,451 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:26,48 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:26,51 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:26,67 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:26,78 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:26,800 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:26,820 INFO     [learner.py:606] ====Pushing takes 0.01810622215270996 s
2021-08-18:17:00:26,855 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:26,863 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:26,864 INFO     [param_server.py:410] Lock worker 1 with localStep 422 , while globalStep is 421

2021-08-18:17:00:27,238 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:27,259 INFO     [learner.py:606] ====Pushing takes 0.020117759704589844 s
2021-08-18:17:00:27,280 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:27,286 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:27,287 INFO     [param_server.py:410] Lock worker 3 with localStep 422 , while globalStep is 421

2021-08-18:17:00:27,819 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:27,836 INFO     [learner.py:606] ====Pushing takes 0.015460729598999023 s
2021-08-18:17:00:27,853 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:27,858 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:27,859 INFO     [param_server.py:381] ====After aggregation in epoch: 421, virtual_clock: 20119.763761446095, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 4.102821990295692, test len: 3099.0
2021-08-18:17:00:27,861 INFO     [param_server.py:410] Lock worker 2 with localStep 422 , while globalStep is 422

2021-08-18:17:00:27,862 INFO     [param_server.py:441] ====Epoch 423 completes 14 clients with loss 5.3851702376089525, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:27,862 INFO     [param_server.py:450] ====Start to sample for epoch 423, global virtualClock: 20119.763761446095, round_duration: 77.10954834859407
2021-08-18:17:00:27,863 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:28,138 INFO     [param_server.py:553] For epoch: 423, median_reward: 405.99938347039557, dev: 811.9987669407911
2021-08-18:17:00:28,737 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.655, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:17:00:28,738 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5480.1551, eval_time 0.5479, test_loss 3.655, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:17:00:28,780 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4319, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:00:28,781 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5480.1948, eval_time 0.5875, test_loss 3.4319, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:00:28,807 INFO     [learner.py:526] ====Start train round 423
2021-08-18:17:00:28,816 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:28,851 INFO     [learner.py:526] ====Start train round 423
2021-08-18:17:00:28,857 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0042, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:17:00:28,858 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5480.278, eval_time 0.6682, test_loss 4.0042, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:17:00:28,868 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:28,931 INFO     [learner.py:526] ====Start train round 423
2021-08-18:17:00:28,956 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:29,745 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:29,765 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:30,955 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:30,967 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:31,26 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:31,47 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:32,638 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:32,650 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:33,590 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:33,599 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:33,698 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:33,732 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:33,893 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:33,903 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:35,128 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:35,155 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:35,324 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:35,336 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:35,745 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:35,765 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:36,41 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:36,75 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:36,661 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:36,680 INFO     [learner.py:606] ====Pushing takes 0.018087148666381836 s
2021-08-18:17:00:36,713 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:36,719 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:36,719 INFO     [param_server.py:410] Lock worker 1 with localStep 423 , while globalStep is 422

2021-08-18:17:00:37,30 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:37,52 INFO     [learner.py:606] ====Pushing takes 0.020847082138061523 s
2021-08-18:17:00:37,77 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:37,83 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:37,83 INFO     [param_server.py:410] Lock worker 3 with localStep 423 , while globalStep is 422

2021-08-18:17:00:37,668 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:37,684 INFO     [learner.py:606] ====Pushing takes 0.014859676361083984 s
2021-08-18:17:00:37,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:37,705 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:37,706 INFO     [param_server.py:381] ====After aggregation in epoch: 422, virtual_clock: 20196.87330979469, top_1: : 66.3117 % (2055.0), top_5: : 100.0 % (3099.0), test loss: 3.697045657369826, test len: 3099.0
2021-08-18:17:00:37,709 INFO     [param_server.py:410] Lock worker 2 with localStep 423 , while globalStep is 423

2021-08-18:17:00:37,709 INFO     [param_server.py:441] ====Epoch 424 completes 14 clients with loss 4.280996220713342, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:37,709 INFO     [param_server.py:450] ====Start to sample for epoch 424, global virtualClock: 20196.87330979469, round_duration: 77.10954834859407
2021-08-18:17:00:37,710 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:37,982 INFO     [param_server.py:553] For epoch: 424, median_reward: 422.55332196344773, dev: 845.1066439268955
2021-08-18:17:00:38,665 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.686, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:00:38,666 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5490.0831, eval_time 0.6499, test_loss 3.686, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:00:38,672 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1693, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:00:38,674 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5490.0879, eval_time 0.6531, test_loss 3.1693, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:00:38,715 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5075, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:17:00:38,728 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5490.1475, eval_time 0.7117, test_loss 3.5075, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:17:00:38,737 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:38,743 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:38,745 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:38,751 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:38,798 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:38,812 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:39,467 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:39,476 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:40,920 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:40,948 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:41,92 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:41,102 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:42,325 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:42,345 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:43,872 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:43,888 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:44,6 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:44,32 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:44,144 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:44,179 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:45,450 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:45,464 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:45,627 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:45,638 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:45,719 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:45,728 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:46,286 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:46,306 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:46,816 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:46,845 INFO     [learner.py:606] ====Pushing takes 0.027354001998901367 s
2021-08-18:17:00:46,877 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:46,885 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:46,885 INFO     [param_server.py:410] Lock worker 3 with localStep 424 , while globalStep is 423

2021-08-18:17:00:46,967 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:46,988 INFO     [learner.py:606] ====Pushing takes 0.019492626190185547 s
2021-08-18:17:00:47,10 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:47,16 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:47,17 INFO     [param_server.py:410] Lock worker 1 with localStep 424 , while globalStep is 423

2021-08-18:17:00:48,32 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:48,48 INFO     [learner.py:606] ====Pushing takes 0.014485597610473633 s
2021-08-18:17:00:48,65 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:48,70 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:48,71 INFO     [param_server.py:381] ====After aggregation in epoch: 423, virtual_clock: 20273.982858143285, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.454261468516455, test len: 3099.0
2021-08-18:17:00:48,75 INFO     [param_server.py:410] Lock worker 2 with localStep 424 , while globalStep is 424

2021-08-18:17:00:48,75 INFO     [param_server.py:441] ====Epoch 425 completes 14 clients with loss 3.890559610528023, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:48,76 INFO     [param_server.py:450] ====Start to sample for epoch 425, global virtualClock: 20273.982858143285, round_duration: 77.10954834859407
2021-08-18:17:00:48,77 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:48,413 INFO     [param_server.py:553] For epoch: 425, median_reward: 436.59275395981786, dev: 873.1855079196357
2021-08-18:17:00:49,34 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6328, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:00:49,35 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5500.4526, eval_time 0.5671, test_loss 3.6328, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:00:49,104 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:49,112 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:49,113 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2684, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:00:49,113 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5500.5276, eval_time 0.6415, test_loss 3.2684, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:00:49,182 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:49,200 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5293, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:17:00:49,201 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5500.6204, eval_time 0.7324, test_loss 3.5293, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:17:00:49,203 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:49,271 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:49,299 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:50,628 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:50,649 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:51,303 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:51,315 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:51,660 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:51,681 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:53,472 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:53,482 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:53,881 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:53,891 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:54,330 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:54,364 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:54,705 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:54,724 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:55,246 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:55,273 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:55,670 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:55,679 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:55,934 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:55,951 INFO     [learner.py:606] ====Pushing takes 0.014824867248535156 s
2021-08-18:17:00:55,974 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:55,980 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:00:55,993 INFO     [param_server.py:410] Lock worker 1 with localStep 425 , while globalStep is 424

2021-08-18:17:00:56,692 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:56,706 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:57,890 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:57,910 INFO     [learner.py:606] ====Pushing takes 0.01843571662902832 s
2021-08-18:17:00:57,935 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:57,941 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:00:57,941 INFO     [param_server.py:410] Lock worker 3 with localStep 425 , while globalStep is 424

2021-08-18:17:00:58,20 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:58,36 INFO     [learner.py:606] ====Pushing takes 0.014789342880249023 s
2021-08-18:17:00:58,51 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:58,56 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:00:58,57 INFO     [param_server.py:381] ====After aggregation in epoch: 424, virtual_clock: 20354.33629989834, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 3.4768353281197726, test len: 3099.0
2021-08-18:17:00:58,59 INFO     [param_server.py:410] Lock worker 2 with localStep 425 , while globalStep is 425

2021-08-18:17:00:58,60 INFO     [param_server.py:441] ====Epoch 426 completes 13 clients with loss 5.670731456582301, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:58,61 INFO     [param_server.py:450] ====Start to sample for epoch 426, global virtualClock: 20354.33629989834, round_duration: 80.35344175505469
2021-08-18:17:00:58,61 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:58,397 INFO     [param_server.py:553] For epoch: 426, median_reward: 436.35884445423017, dev: 872.7176889084603
2021-08-18:17:00:58,988 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4816, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:00:58,989 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5510.4061, eval_time 0.5579, test_loss 3.4816, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:00:59,32 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5466, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:00:59,33 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5510.4467, eval_time 0.6014, test_loss 3.5466, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:00:59,63 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:00:59,69 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0283, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:00:59,69 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5510.4892, eval_time 0.6391, test_loss 4.0283, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:00:59,72 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:59,103 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:00:59,118 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:59,146 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:00:59,163 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:00,307 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:00,322 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:01,224 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:01,252 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:01,269 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:01,278 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:03,248 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:03,267 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:03,895 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:03,922 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:03,990 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:04,2 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:04,809 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:04,811 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:04,827 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:04,839 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:05,500 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:05,516 INFO     [learner.py:606] ====Pushing takes 0.013935565948486328 s
2021-08-18:17:01:05,532 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:05,541 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:05,542 INFO     [param_server.py:410] Lock worker 1 with localStep 426 , while globalStep is 425

2021-08-18:17:01:05,754 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:05,765 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:06,756 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:06,774 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:07,963 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:07,983 INFO     [learner.py:606] ====Pushing takes 0.018250703811645508 s
2021-08-18:17:01:08,10 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:08,17 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:08,17 INFO     [param_server.py:410] Lock worker 3 with localStep 426 , while globalStep is 425

2021-08-18:17:01:08,137 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:08,153 INFO     [learner.py:606] ====Pushing takes 0.015182971954345703 s
2021-08-18:17:01:08,169 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:08,175 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:08,175 INFO     [param_server.py:381] ====After aggregation in epoch: 425, virtual_clock: 20434.689741653394, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 3.685469967347604, test len: 3099.0
2021-08-18:17:01:08,178 INFO     [param_server.py:410] Lock worker 2 with localStep 426 , while globalStep is 426

2021-08-18:17:01:08,178 INFO     [param_server.py:441] ====Epoch 427 completes 13 clients with loss 3.34658336511904, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:08,179 INFO     [param_server.py:450] ====Start to sample for epoch 427, global virtualClock: 20434.689741653394, round_duration: 80.35344175505469
2021-08-18:17:01:08,180 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:08,510 INFO     [param_server.py:553] For epoch: 427, median_reward: 396.3028107265914, dev: 792.6056214531828
2021-08-18:17:01:09,138 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4202, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:01:09,139 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5520.5562, eval_time 0.5933, test_loss 3.4202, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:01:09,141 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2291, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:01:09,142 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5520.5565, eval_time 0.5965, test_loss 3.2291, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:01:09,211 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:01:09,218 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5251, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:17:01:09,218 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5520.6381, eval_time 0.6745, test_loss 3.5251, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:17:01:09,220 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:09,220 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:01:09,237 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:09,292 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:01:09,315 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:10,406 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:10,420 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:11,105 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:11,126 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:11,376 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:11,386 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:13,392 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:13,407 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:14,103 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:14,117 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:14,378 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:14,406 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:14,785 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:14,799 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:15,238 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:15,259 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:15,763 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:15,773 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:15,935 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:15,951 INFO     [learner.py:606] ====Pushing takes 0.014393329620361328 s
2021-08-18:17:01:15,975 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:15,980 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:15,981 INFO     [param_server.py:410] Lock worker 1 with localStep 427 , while globalStep is 426

2021-08-18:17:01:16,730 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:16,748 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:18,73 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:18,93 INFO     [learner.py:606] ====Pushing takes 0.018760204315185547 s
2021-08-18:17:01:18,97 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:18,122 INFO     [learner.py:606] ====Pushing takes 0.0235898494720459 s
2021-08-18:17:01:18,122 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:18,128 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:18,129 INFO     [param_server.py:410] Lock worker 3 with localStep 427 , while globalStep is 426

2021-08-18:17:01:18,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:18,150 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:18,150 INFO     [param_server.py:381] ====After aggregation in epoch: 426, virtual_clock: 20515.04318340845, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 3.3914610500688904, test len: 3099.0
2021-08-18:17:01:18,170 INFO     [param_server.py:410] Lock worker 2 with localStep 427 , while globalStep is 427

2021-08-18:17:01:18,170 INFO     [param_server.py:441] ====Epoch 428 completes 13 clients with loss 4.534366954305577, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:18,170 INFO     [param_server.py:450] ====Start to sample for epoch 428, global virtualClock: 20515.04318340845, round_duration: 80.35344175505469
2021-08-18:17:01:18,171 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:18,479 INFO     [param_server.py:553] For epoch: 428, median_reward: 425.38437468167496, dev: 850.7687493633499
2021-08-18:17:01:19,177 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5102, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:01:19,178 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5530.5948, eval_time 0.6518, test_loss 3.5102, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:01:19,243 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:01:19,255 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.386, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:17:01:19,256 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5530.6704, eval_time 0.7303, test_loss 3.386, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:17:01:19,258 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:19,297 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5357, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:17:01:19,298 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5530.7176, eval_time 0.772, test_loss 4.5357, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:17:01:19,346 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:01:19,367 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:19,368 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:01:19,390 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:20,652 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:20,666 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:21,446 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:21,457 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:21,574 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:21,595 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:23,534 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:23,548 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:24,101 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:24,115 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:24,557 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:24,596 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:25,79 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:25,100 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:25,534 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:25,554 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:25,950 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:25,962 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:26,99 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:26,115 INFO     [learner.py:606] ====Pushing takes 0.014592409133911133 s
2021-08-18:17:01:26,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:26,145 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:26,145 INFO     [param_server.py:410] Lock worker 1 with localStep 428 , while globalStep is 427

2021-08-18:17:01:26,883 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:26,897 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:27,968 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:27,989 INFO     [learner.py:606] ====Pushing takes 0.01921844482421875 s
2021-08-18:17:01:28,14 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:28,20 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:28,21 INFO     [param_server.py:410] Lock worker 3 with localStep 428 , while globalStep is 427

2021-08-18:17:01:28,325 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:28,342 INFO     [learner.py:606] ====Pushing takes 0.01552724838256836 s
2021-08-18:17:01:28,363 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:28,367 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:28,368 INFO     [param_server.py:381] ====After aggregation in epoch: 427, virtual_clock: 20595.396625163503, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 3.8106304981090404, test len: 3099.0
2021-08-18:17:01:28,370 INFO     [param_server.py:410] Lock worker 2 with localStep 428 , while globalStep is 428

2021-08-18:17:01:28,371 INFO     [param_server.py:441] ====Epoch 429 completes 13 clients with loss 5.185324747063061, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:28,371 INFO     [param_server.py:450] ====Start to sample for epoch 429, global virtualClock: 20595.396625163503, round_duration: 80.35344175505469
2021-08-18:17:01:28,373 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:28,688 INFO     [param_server.py:553] For epoch: 429, median_reward: 457.1778998420788, dev: 914.3557996841575
2021-08-18:17:01:29,257 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.586, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:01:29,258 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5540.6747, eval_time 0.5241, test_loss 3.586, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:01:29,327 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:01:29,336 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:29,367 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4701, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:17:01:29,368 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5540.7825, eval_time 0.6329, test_loss 3.4701, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:17:01:29,436 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:01:29,449 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:29,486 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6611, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:01:29,487 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5540.9064, eval_time 0.7532, test_loss 3.6611, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:01:29,554 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:01:29,580 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:30,848 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:30,869 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:31,550 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:31,569 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:31,760 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:31,794 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:33,917 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:33,940 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:34,337 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:34,346 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:34,534 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:34,568 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:35,366 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:35,380 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:35,429 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:35,456 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:36,55 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:36,66 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:36,119 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:36,135 INFO     [learner.py:606] ====Pushing takes 0.014424800872802734 s
2021-08-18:17:01:36,160 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:36,165 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:36,166 INFO     [param_server.py:410] Lock worker 1 with localStep 429 , while globalStep is 428

2021-08-18:17:01:37,436 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:37,456 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:38,511 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:38,526 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:38,531 INFO     [learner.py:606] ====Pushing takes 0.018336772918701172 s
2021-08-18:17:01:38,554 INFO     [learner.py:606] ====Pushing takes 0.026719093322753906 s
2021-08-18:17:01:38,555 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:38,560 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:38,560 INFO     [param_server.py:410] Lock worker 2 with localStep 429 , while globalStep is 428

2021-08-18:17:01:38,590 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:38,596 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:38,597 INFO     [param_server.py:381] ====After aggregation in epoch: 428, virtual_clock: 20675.750066918557, top_1: : 66.1504 % (2050.0), top_5: : 100.0 % (3099.0), test loss: 3.5724057886335583, test len: 3099.0
2021-08-18:17:01:38,599 INFO     [param_server.py:410] Lock worker 3 with localStep 429 , while globalStep is 429

2021-08-18:17:01:38,599 INFO     [param_server.py:441] ====Epoch 430 completes 13 clients with loss 3.4458787867110097, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:38,599 INFO     [param_server.py:450] ====Start to sample for epoch 430, global virtualClock: 20675.750066918557, round_duration: 80.35344175505469
2021-08-18:17:01:38,600 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:38,884 INFO     [param_server.py:553] For epoch: 430, median_reward: 391.94634338723114, dev: 783.8926867744623
2021-08-18:17:01:39,624 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1968, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:01:39,625 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5551.0388, eval_time 0.6955, test_loss 3.1968, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:01:39,624 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6642, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:01:39,625 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5551.0424, eval_time 0.6962, test_loss 3.6642, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:01:39,694 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:39,701 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:39,705 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6509, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:17:01:39,706 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5551.1254, eval_time 0.7766, test_loss 3.6509, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:17:01:39,710 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:39,711 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:39,780 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:39,801 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:40,988 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:41,3 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:41,802 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:41,823 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:42,51 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:42,60 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:43,903 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:43,924 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:44,759 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:44,792 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:44,978 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:44,990 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:45,490 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:45,517 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:45,673 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:45,700 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:46,278 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:46,294 INFO     [learner.py:606] ====Pushing takes 0.014963388442993164 s
2021-08-18:17:01:46,318 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:46,325 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:46,325 INFO     [param_server.py:410] Lock worker 1 with localStep 430 , while globalStep is 429

2021-08-18:17:01:46,541 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:46,551 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:47,437 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:47,455 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:48,553 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:48,574 INFO     [learner.py:606] ====Pushing takes 0.01845097541809082 s
2021-08-18:17:01:48,603 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:48,609 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:48,610 INFO     [param_server.py:410] Lock worker 3 with localStep 430 , while globalStep is 429

2021-08-18:17:01:48,838 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:48,855 INFO     [learner.py:606] ====Pushing takes 0.015461444854736328 s
2021-08-18:17:01:48,869 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:48,874 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:48,875 INFO     [param_server.py:381] ====After aggregation in epoch: 429, virtual_clock: 20756.103508673612, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 3.503991272714403, test len: 3099.0
2021-08-18:17:01:48,877 INFO     [param_server.py:410] Lock worker 2 with localStep 430 , while globalStep is 430

2021-08-18:17:01:48,877 INFO     [param_server.py:441] ====Epoch 431 completes 13 clients with loss 5.314927259434219, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:48,877 INFO     [param_server.py:450] ====Start to sample for epoch 431, global virtualClock: 20756.103508673612, round_duration: 80.35344175505469
2021-08-18:17:01:48,879 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:49,217 INFO     [param_server.py:553] For epoch: 431, median_reward: 414.16987674421404, dev: 828.3397534884281
2021-08-18:17:01:49,898 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6211, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:01:49,899 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5561.316, eval_time 0.6479, test_loss 3.6211, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:01:49,933 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8687, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:01:49,934 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5561.3479, eval_time 0.6784, test_loss 3.8687, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:01:49,969 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:01:49,979 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:50,24 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:01:50,39 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:50,39 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8047, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:01:50,40 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5561.4597, eval_time 0.7892, test_loss 3.8047, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:01:50,98 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:01:50,127 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:51,362 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:51,377 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:52,354 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:52,364 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:52,374 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:52,381 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:54,498 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:54,521 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:55,159 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:55,169 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:55,346 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:55,373 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:56,88 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:56,102 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:56,207 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:56,228 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:56,865 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:56,880 INFO     [learner.py:606] ====Pushing takes 0.013667821884155273 s
2021-08-18:17:01:56,906 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:56,911 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:56,911 INFO     [param_server.py:410] Lock worker 1 with localStep 431 , while globalStep is 430

2021-08-18:17:01:56,927 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:56,945 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:57,952 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:57,961 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:59,126 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:59,144 INFO     [learner.py:606] ====Pushing takes 0.016504287719726562 s
2021-08-18:17:01:59,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:59,169 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:59,170 INFO     [param_server.py:410] Lock worker 2 with localStep 431 , while globalStep is 430

2021-08-18:17:01:59,180 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:59,200 INFO     [learner.py:606] ====Pushing takes 0.01842474937438965 s
2021-08-18:17:01:59,224 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:59,230 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:59,230 INFO     [param_server.py:381] ====After aggregation in epoch: 430, virtual_clock: 20836.456950428666, top_1: : 65.3759 % (2026.0), top_5: : 100.0 % (3099.0), test loss: 3.7648386778654874, test len: 3099.0
2021-08-18:17:01:59,232 INFO     [param_server.py:410] Lock worker 3 with localStep 431 , while globalStep is 431

2021-08-18:17:01:59,233 INFO     [param_server.py:441] ====Epoch 432 completes 13 clients with loss 3.86431590069033, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:59,233 INFO     [param_server.py:450] ====Start to sample for epoch 432, global virtualClock: 20836.456950428666, round_duration: 80.35344175505469
2021-08-18:17:01:59,233 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:59,525 INFO     [param_server.py:553] For epoch: 432, median_reward: 381.1108615831959, dev: 762.2217231663918
2021-08-18:17:02:00,245 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7193, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:02:00,245 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5571.6624, eval_time 0.6679, test_loss 3.7193, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:02:00,287 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2573, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:02:00,288 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5571.7024, eval_time 0.7041, test_loss 3.2573, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:02:00,314 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:02:00,323 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:00,331 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0484, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:02:00,332 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5571.7513, eval_time 0.7542, test_loss 4.0484, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:02:00,357 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:02:00,372 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:00,402 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:02:00,426 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:01,583 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:01,597 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:02,441 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:02,469 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:02,577 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:02,589 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:04,458 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:04,471 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:05,288 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:05,299 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:05,474 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:05,507 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:06,28 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:06,54 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:06,306 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:06,334 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:06,947 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:06,964 INFO     [learner.py:606] ====Pushing takes 0.015220403671264648 s
2021-08-18:17:02:06,987 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:06,993 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:06,994 INFO     [param_server.py:410] Lock worker 1 with localStep 432 , while globalStep is 431

2021-08-18:17:02:06,997 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:07,7 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:08,89 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:08,103 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:09,223 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:09,247 INFO     [learner.py:606] ====Pushing takes 0.02125072479248047 s
2021-08-18:17:02:09,271 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:09,277 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:09,278 INFO     [param_server.py:410] Lock worker 3 with localStep 432 , while globalStep is 431

2021-08-18:17:02:09,294 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:09,311 INFO     [learner.py:606] ====Pushing takes 0.015358686447143555 s
2021-08-18:17:02:09,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:09,330 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:09,331 INFO     [param_server.py:381] ====After aggregation in epoch: 431, virtual_clock: 20916.81039218372, top_1: : 63.6334 % (1972.0), top_5: : 100.0 % (3099.0), test loss: 3.6749908328056335, test len: 3099.0
2021-08-18:17:02:09,333 INFO     [param_server.py:410] Lock worker 2 with localStep 432 , while globalStep is 432

2021-08-18:17:02:09,333 INFO     [param_server.py:441] ====Epoch 433 completes 13 clients with loss 3.142870439666508, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:09,334 INFO     [param_server.py:450] ====Start to sample for epoch 433, global virtualClock: 20916.81039218372, round_duration: 80.35344175505469
2021-08-18:17:02:09,334 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:09,609 INFO     [param_server.py:553] For epoch: 433, median_reward: 427.6620541799944, dev: 855.3241083599888
2021-08-18:17:02:10,192 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5634, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:02:10,194 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5581.6111, eval_time 0.5367, test_loss 3.5634, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:02:10,200 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5195, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:17:02:10,201 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5581.6151, eval_time 0.5437, test_loss 3.5195, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:17:02:10,270 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:02:10,281 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:10,285 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6273, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:02:10,286 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5581.7059, eval_time 0.6316, test_loss 3.6273, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:02:10,287 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:02:10,295 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:10,357 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:02:10,387 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:11,607 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:11,621 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:12,460 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:12,494 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:12,614 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:12,626 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:14,831 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:14,849 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:15,291 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:15,318 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:15,456 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:15,465 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:16,211 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:16,227 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:16,317 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:16,344 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:17,12 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:17,33 INFO     [learner.py:606] ====Pushing takes 0.01465463638305664 s
2021-08-18:17:02:17,62 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:17,68 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:17,68 INFO     [param_server.py:410] Lock worker 1 with localStep 433 , while globalStep is 432

2021-08-18:17:02:17,104 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:17,116 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:18,90 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:18,104 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:19,199 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:19,219 INFO     [learner.py:606] ====Pushing takes 0.018723726272583008 s
2021-08-18:17:02:19,250 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:19,255 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:19,256 INFO     [param_server.py:410] Lock worker 3 with localStep 433 , while globalStep is 432

2021-08-18:17:02:19,395 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:19,423 INFO     [learner.py:606] ====Pushing takes 0.014437437057495117 s
2021-08-18:17:02:19,441 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:19,445 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:19,446 INFO     [param_server.py:381] ====After aggregation in epoch: 432, virtual_clock: 20997.163833938775, top_1: : 66.2472 % (2053.0), top_5: : 100.0 % (3099.0), test loss: 3.5700767906727613, test len: 3099.0
2021-08-18:17:02:19,449 INFO     [param_server.py:410] Lock worker 2 with localStep 433 , while globalStep is 433

2021-08-18:17:02:19,450 INFO     [param_server.py:441] ====Epoch 434 completes 13 clients with loss 5.178526691454584, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:19,450 INFO     [param_server.py:450] ====Start to sample for epoch 434, global virtualClock: 20997.163833938775, round_duration: 80.35344175505469
2021-08-18:17:02:19,451 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:19,803 INFO     [param_server.py:553] For epoch: 434, median_reward: 401.5622056311224, dev: 803.1244112622448
2021-08-18:17:02:20,562 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.762, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:17:02:20,563 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5591.9803, eval_time 0.7115, test_loss 3.762, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:17:02:20,599 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.934, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:02:20,600 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5592.0137, eval_time 0.7491, test_loss 3.934, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:02:20,642 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:02:20,651 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:20,671 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:02:20,671 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.935, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:17:02:20,672 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5592.0913, eval_time 0.8237, test_loss 3.935, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:17:02:20,690 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:20,744 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:02:20,771 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:22,14 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:22,28 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:22,792 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:22,804 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:22,808 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:22,829 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:24,675 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:24,689 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:25,468 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:25,485 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:25,494 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:25,513 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:26,79 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:26,100 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:26,380 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:26,413 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:27,11 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:27,27 INFO     [learner.py:606] ====Pushing takes 0.014566183090209961 s
2021-08-18:17:02:27,58 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:27,66 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:27,67 INFO     [param_server.py:410] Lock worker 1 with localStep 434 , while globalStep is 433

2021-08-18:17:02:27,184 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:27,194 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:28,82 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:28,97 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:29,276 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:29,295 INFO     [learner.py:606] ====Pushing takes 0.01840043067932129 s
2021-08-18:17:02:29,318 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:29,323 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:29,324 INFO     [param_server.py:410] Lock worker 3 with localStep 434 , while globalStep is 433

2021-08-18:17:02:29,541 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:29,558 INFO     [learner.py:606] ====Pushing takes 0.015910863876342773 s
2021-08-18:17:02:29,583 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:29,588 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:29,588 INFO     [param_server.py:381] ====After aggregation in epoch: 433, virtual_clock: 21077.51727569383, top_1: : 64.1497 % (1988.0), top_5: : 100.0 % (3099.0), test loss: 3.8769794128559254, test len: 3099.0
2021-08-18:17:02:29,591 INFO     [param_server.py:410] Lock worker 2 with localStep 434 , while globalStep is 434

2021-08-18:17:02:29,592 INFO     [param_server.py:441] ====Epoch 435 completes 13 clients with loss 3.9018418654433438, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:29,592 INFO     [param_server.py:450] ====Start to sample for epoch 435, global virtualClock: 21077.51727569383, round_duration: 80.35344175505469
2021-08-18:17:02:29,593 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:29,954 INFO     [param_server.py:553] For epoch: 435, median_reward: 426.8732676661358, dev: 853.7465353322716
2021-08-18:17:02:30,479 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2955, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:02:30,483 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5601.8969, eval_time 0.4945, test_loss 3.2955, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:02:30,544 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0282, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:02:30,545 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5601.962, eval_time 0.5567, test_loss 4.0282, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:02:30,554 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:02:30,564 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7764, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:17:02:30,567 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5601.9866, eval_time 0.5795, test_loss 3.7764, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:17:02:30,570 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:30,621 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:02:30,629 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:30,640 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:02:30,665 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:31,711 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:31,721 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:32,731 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:32,758 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:32,870 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:32,882 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:34,790 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:34,804 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:35,585 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:35,597 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:35,658 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:35,686 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:36,303 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:36,323 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:36,503 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:36,524 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:37,104 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:37,119 INFO     [learner.py:606] ====Pushing takes 0.014027118682861328 s
2021-08-18:17:02:37,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:37,142 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:37,143 INFO     [param_server.py:410] Lock worker 1 with localStep 435 , while globalStep is 434

2021-08-18:17:02:37,344 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:37,361 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:38,100 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:38,109 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:39,124 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:39,145 INFO     [learner.py:606] ====Pushing takes 0.019247055053710938 s
2021-08-18:17:02:39,170 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:39,177 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:39,177 INFO     [param_server.py:410] Lock worker 3 with localStep 435 , while globalStep is 434

2021-08-18:17:02:39,658 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:39,674 INFO     [learner.py:606] ====Pushing takes 0.014334917068481445 s
2021-08-18:17:02:39,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:39,696 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:39,696 INFO     [param_server.py:381] ====After aggregation in epoch: 434, virtual_clock: 21157.870717448885, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 3.7000273488186024, test len: 3099.0
2021-08-18:17:02:39,700 INFO     [param_server.py:410] Lock worker 2 with localStep 435 , while globalStep is 435

2021-08-18:17:02:39,700 INFO     [param_server.py:441] ====Epoch 436 completes 13 clients with loss 5.081019819508428, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:39,701 INFO     [param_server.py:450] ====Start to sample for epoch 436, global virtualClock: 21157.870717448885, round_duration: 80.35344175505469
2021-08-18:17:02:39,703 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:40,61 INFO     [param_server.py:553] For epoch: 436, median_reward: 406.9109416306749, dev: 813.8218832613499
2021-08-18:17:02:40,752 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7757, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:02:40,753 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5612.1697, eval_time 0.6437, test_loss 3.7757, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:02:40,820 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.482, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:02:40,821 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5612.2356, eval_time 0.7078, test_loss 3.482, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:02:40,823 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:40,833 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:40,843 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3999, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:17:02:40,844 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5612.2633, eval_time 0.7366, test_loss 4.3999, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:17:02:40,878 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:40,899 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:40,912 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:40,946 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:42,222 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:42,240 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:43,52 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:43,62 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:43,251 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:43,272 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:44,977 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:44,986 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:45,904 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:45,920 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:46,154 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:46,188 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:46,500 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:46,521 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:47,108 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:47,142 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:47,598 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:47,610 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:47,832 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:47,847 INFO     [learner.py:606] ====Pushing takes 0.013945341110229492 s
2021-08-18:17:02:47,864 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:47,871 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:47,872 INFO     [param_server.py:410] Lock worker 1 with localStep 436 , while globalStep is 435

2021-08-18:17:02:48,441 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:48,468 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:49,715 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:49,735 INFO     [learner.py:606] ====Pushing takes 0.017575740814208984 s
2021-08-18:17:02:49,756 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:49,762 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:49,763 INFO     [param_server.py:410] Lock worker 3 with localStep 436 , while globalStep is 435

2021-08-18:17:02:49,976 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:49,991 INFO     [learner.py:606] ====Pushing takes 0.013929128646850586 s
2021-08-18:17:02:50,6 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:50,13 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:50,14 INFO     [param_server.py:381] ====After aggregation in epoch: 435, virtual_clock: 21238.22415920394, top_1: : 64.0852 % (1986.0), top_5: : 100.0 % (3099.0), test loss: 3.8858535952038236, test len: 3099.0
2021-08-18:17:02:50,17 INFO     [param_server.py:410] Lock worker 2 with localStep 436 , while globalStep is 436

2021-08-18:17:02:50,17 INFO     [param_server.py:441] ====Epoch 437 completes 13 clients with loss 3.468190450727797, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:50,18 INFO     [param_server.py:450] ====Start to sample for epoch 437, global virtualClock: 21238.22415920394, round_duration: 80.35344175505469
2021-08-18:17:02:50,19 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:50,363 INFO     [param_server.py:553] For epoch: 437, median_reward: 408.3087903015704, dev: 816.6175806031408
2021-08-18:17:02:50,940 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.059, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:02:50,941 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5622.3583, eval_time 0.5533, test_loss 4.059, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:02:50,944 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3533, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:02:50,945 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5622.3591, eval_time 0.557, test_loss 3.3533, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:02:51,15 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:02:51,15 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:02:51,19 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8321, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:17:02:51,22 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5622.4421, eval_time 0.6368, test_loss 3.8321, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:17:02:51,22 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:51,23 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:51,98 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:02:51,115 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:52,295 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:52,308 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:53,460 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:53,492 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:53,494 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:53,506 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:55,220 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:55,238 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:56,252 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:56,262 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:56,292 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:56,306 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:56,658 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:56,667 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:57,90 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:57,111 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:57,737 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:57,751 INFO     [learner.py:606] ====Pushing takes 0.011650323867797852 s
2021-08-18:17:02:57,773 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:57,778 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:57,779 INFO     [param_server.py:410] Lock worker 1 with localStep 437 , while globalStep is 436

2021-08-18:17:02:58,136 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:58,145 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:58,347 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:58,357 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:59,547 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:59,567 INFO     [learner.py:606] ====Pushing takes 0.019045114517211914 s
2021-08-18:17:02:59,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:59,606 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:59,607 INFO     [param_server.py:410] Lock worker 3 with localStep 437 , while globalStep is 436

2021-08-18:17:03:00,549 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:00,566 INFO     [learner.py:606] ====Pushing takes 0.01592421531677246 s
2021-08-18:17:03:00,583 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:00,588 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:00,589 INFO     [param_server.py:381] ====After aggregation in epoch: 436, virtual_clock: 21318.577600958994, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 3.748160914138511, test len: 3099.0
2021-08-18:17:03:00,591 INFO     [param_server.py:410] Lock worker 2 with localStep 437 , while globalStep is 437

2021-08-18:17:03:00,591 INFO     [param_server.py:441] ====Epoch 438 completes 13 clients with loss 5.765640332817588, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:00,592 INFO     [param_server.py:450] ====Start to sample for epoch 438, global virtualClock: 21318.577600958994, round_duration: 80.35344175505469
2021-08-18:17:03:00,610 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:00,876 INFO     [param_server.py:553] For epoch: 438, median_reward: 414.54930023061974, dev: 829.0986004612395
2021-08-18:17:03:01,475 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1521, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:03:01,475 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5632.8894, eval_time 0.5526, test_loss 4.1521, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:03:01,478 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1743, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:17:03:01,479 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5632.8957, eval_time 0.5577, test_loss 4.1743, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:17:03:01,546 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:03:01,553 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9576, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:03:01,554 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5632.974, eval_time 0.6334, test_loss 3.9576, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:03:01,557 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:03:01,562 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:01,574 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:01,612 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:03:01,633 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:02,762 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:02,772 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:03,541 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:03,568 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:03,829 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:03,845 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:05,429 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:05,447 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:06,466 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:06,480 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:06,567 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:06,595 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:06,952 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:06,965 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:07,384 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:07,405 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:08,14 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:08,30 INFO     [learner.py:606] ====Pushing takes 0.014412164688110352 s
2021-08-18:17:03:08,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:08,62 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:08,62 INFO     [param_server.py:410] Lock worker 1 with localStep 438 , while globalStep is 437

2021-08-18:17:03:08,126 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:08,136 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:08,669 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:08,679 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:09,703 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:09,723 INFO     [learner.py:606] ====Pushing takes 0.017759323120117188 s
2021-08-18:17:03:09,745 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:09,755 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:09,755 INFO     [param_server.py:410] Lock worker 3 with localStep 438 , while globalStep is 437

2021-08-18:17:03:10,455 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:10,472 INFO     [learner.py:606] ====Pushing takes 0.015066146850585938 s
2021-08-18:17:03:10,486 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:10,491 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:10,492 INFO     [param_server.py:381] ====After aggregation in epoch: 437, virtual_clock: 21398.931042714048, top_1: : 63.343 % (1963.0), top_5: : 100.0 % (3099.0), test loss: 4.094699802222075, test len: 3099.0
2021-08-18:17:03:10,495 INFO     [param_server.py:410] Lock worker 2 with localStep 438 , while globalStep is 438

2021-08-18:17:03:10,496 INFO     [param_server.py:441] ====Epoch 439 completes 13 clients with loss 4.5231339846795775, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:10,496 INFO     [param_server.py:450] ====Start to sample for epoch 439, global virtualClock: 21398.931042714048, round_duration: 80.35344175505469
2021-08-18:17:03:10,498 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:10,854 INFO     [param_server.py:553] For epoch: 439, median_reward: 418.09869731927483, dev: 836.1973946385497
2021-08-18:17:03:11,506 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7119, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:17:03:11,506 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5642.9236, eval_time 0.594, test_loss 3.7119, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:17:03:11,539 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3599, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:03:11,539 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5642.9537, eval_time 0.6244, test_loss 3.3599, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:03:11,581 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:03:11,590 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:11,589 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0609, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:17:03:11,593 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5643.0126, eval_time 0.682, test_loss 4.0609, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:17:03:11,616 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:03:11,628 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:11,666 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:03:11,693 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:12,799 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:12,809 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:13,780 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:13,792 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:13,840 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:13,872 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:15,513 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:15,522 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:16,583 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:16,592 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:16,953 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:16,987 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:17,152 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:17,173 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:17,866 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:17,894 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:18,292 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:18,307 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:18,493 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:18,509 INFO     [learner.py:606] ====Pushing takes 0.014868497848510742 s
2021-08-18:17:03:18,531 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:18,537 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:18,538 INFO     [param_server.py:410] Lock worker 1 with localStep 439 , while globalStep is 438

2021-08-18:17:03:18,993 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:19,5 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:20,224 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:20,245 INFO     [learner.py:606] ====Pushing takes 0.01861119270324707 s
2021-08-18:17:03:20,274 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:20,280 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:20,281 INFO     [param_server.py:410] Lock worker 3 with localStep 439 , while globalStep is 438

2021-08-18:17:03:20,777 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:20,793 INFO     [learner.py:606] ====Pushing takes 0.014865636825561523 s
2021-08-18:17:03:20,808 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:20,813 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:20,815 INFO     [param_server.py:381] ====After aggregation in epoch: 438, virtual_clock: 21479.284484469103, top_1: : 67.0216 % (2077.0), top_5: : 100.0 % (3099.0), test loss: 3.710882928636339, test len: 3099.0
2021-08-18:17:03:20,818 INFO     [param_server.py:410] Lock worker 2 with localStep 439 , while globalStep is 439

2021-08-18:17:03:20,819 INFO     [param_server.py:441] ====Epoch 440 completes 13 clients with loss 6.479960452936659, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:20,819 INFO     [param_server.py:450] ====Start to sample for epoch 440, global virtualClock: 21479.284484469103, round_duration: 80.35344175505469
2021-08-18:17:03:20,820 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:21,134 INFO     [param_server.py:553] For epoch: 440, median_reward: 428.03055207423, dev: 856.06110414846
2021-08-18:17:03:21,852 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7061, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:03:21,853 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5653.2668, eval_time 0.6718, test_loss 3.7061, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:03:21,854 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0849, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:17:03:21,864 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5653.2807, eval_time 0.6853, test_loss 4.0849, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:17:03:21,923 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:03:21,933 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:03:21,933 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:21,942 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:21,973 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5587, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:03:21,974 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5653.394, eval_time 0.7961, test_loss 4.5587, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:03:22,56 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:03:22,83 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:23,193 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:23,219 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:24,243 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:24,255 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:24,283 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:24,311 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:26,47 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:26,61 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:27,46 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:27,56 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:27,93 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:27,120 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:27,447 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:27,457 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:28,23 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:28,51 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:28,629 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:28,646 INFO     [learner.py:606] ====Pushing takes 0.01385498046875 s
2021-08-18:17:03:28,668 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:28,676 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:28,676 INFO     [param_server.py:410] Lock worker 1 with localStep 440 , while globalStep is 439

2021-08-18:17:03:28,722 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:28,731 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:29,498 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:29,517 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:30,733 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:30,755 INFO     [learner.py:606] ====Pushing takes 0.019481182098388672 s
2021-08-18:17:03:30,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:30,783 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:30,784 INFO     [param_server.py:410] Lock worker 3 with localStep 440 , while globalStep is 439

2021-08-18:17:03:31,139 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:31,156 INFO     [learner.py:606] ====Pushing takes 0.01492619514465332 s
2021-08-18:17:03:31,176 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:31,181 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:31,182 INFO     [param_server.py:381] ====After aggregation in epoch: 439, virtual_clock: 21559.637926224157, top_1: : 62.6331 % (1941.0), top_5: : 100.0 % (3099.0), test loss: 4.11658368728779, test len: 3099.0
2021-08-18:17:03:31,185 INFO     [param_server.py:410] Lock worker 2 with localStep 440 , while globalStep is 440

2021-08-18:17:03:31,185 INFO     [param_server.py:441] ====Epoch 441 completes 13 clients with loss 4.167787671563118, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:31,185 INFO     [param_server.py:450] ====Start to sample for epoch 441, global virtualClock: 21559.637926224157, round_duration: 80.35344175505469
2021-08-18:17:03:31,186 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:31,470 INFO     [param_server.py:541] Handle Wight 0.02320122718811035 | Send 0.2847175598144531
2021-08-18:17:03:31,471 INFO     [param_server.py:553] For epoch: 441, median_reward: 422.3047177889306, dev: 844.6094355778612
2021-08-18:17:03:32,80 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2379, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:17:03:32,82 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5663.4958, eval_time 0.5701, test_loss 3.2379, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:17:03:32,126 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7098, Top-1 Accuracy: 716.0/1033 (0.6931), Top-5 Accuracy: 1.0
2021-08-18:17:03:32,127 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5663.5464, eval_time 0.6218, test_loss 3.7098, test_accuracy 0.6931, test_5_accuracy 1.0 

2021-08-18:17:03:32,141 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7561, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:03:32,142 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5663.5591, eval_time 0.6347, test_loss 3.7561, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:03:32,151 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:03:32,159 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:32,196 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:03:32,212 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:03:32,214 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:32,222 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:33,285 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:33,294 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:34,285 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:34,303 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:34,314 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:34,326 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:36,16 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:36,26 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:36,955 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:36,966 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:37,301 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:37,322 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:37,422 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:37,435 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:38,59 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:38,74 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:38,444 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:38,457 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:38,709 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:38,723 INFO     [learner.py:606] ====Pushing takes 0.01239156723022461 s
2021-08-18:17:03:38,740 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:38,746 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:38,746 INFO     [param_server.py:410] Lock worker 1 with localStep 441 , while globalStep is 440

2021-08-18:17:03:38,957 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:38,969 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:39,907 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:39,928 INFO     [learner.py:606] ====Pushing takes 0.01943182945251465 s
2021-08-18:17:03:39,955 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:39,962 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:39,963 INFO     [param_server.py:410] Lock worker 3 with localStep 441 , while globalStep is 440

2021-08-18:17:03:40,765 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:40,782 INFO     [learner.py:606] ====Pushing takes 0.01493072509765625 s
2021-08-18:17:03:40,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:40,802 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:40,803 INFO     [param_server.py:381] ====After aggregation in epoch: 440, virtual_clock: 21639.99136797921, top_1: : 67.2152 % (2083.0), top_5: : 100.0 % (3099.0), test loss: 3.567926552560594, test len: 3099.0
2021-08-18:17:03:40,806 INFO     [param_server.py:410] Lock worker 2 with localStep 441 , while globalStep is 441

2021-08-18:17:03:40,807 INFO     [param_server.py:441] ====Epoch 442 completes 13 clients with loss 5.780263145537493, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:40,807 INFO     [param_server.py:450] ====Start to sample for epoch 442, global virtualClock: 21639.99136797921, round_duration: 80.35344175505469
2021-08-18:17:03:40,808 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:41,142 INFO     [param_server.py:553] For epoch: 442, median_reward: 475.00610775658055, dev: 950.0122155131611
2021-08-18:17:03:41,761 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7497, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:03:41,762 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5673.1793, eval_time 0.5631, test_loss 3.7497, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:03:41,794 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5543, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:03:41,795 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5673.2091, eval_time 0.594, test_loss 3.5543, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:03:41,833 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:41,843 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:41,864 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:41,878 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:41,885 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1072, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:17:03:41,886 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5673.306, eval_time 0.6881, test_loss 4.1072, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:17:03:41,962 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:41,989 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:42,981 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:42,992 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:44,15 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:44,28 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:44,35 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:44,40 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:45,655 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:45,665 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:46,809 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:46,818 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:47,21 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:47,55 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:47,129 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:47,147 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:47,887 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:47,918 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:48,610 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:48,618 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:48,625 INFO     [learner.py:606] ====Pushing takes 0.014040231704711914 s
2021-08-18:17:03:48,630 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:48,642 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:48,648 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:48,651 INFO     [param_server.py:410] Lock worker 1 with localStep 442 , while globalStep is 441

2021-08-18:17:03:49,43 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:49,58 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:50,96 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:50,116 INFO     [learner.py:606] ====Pushing takes 0.017940759658813477 s
2021-08-18:17:03:50,139 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:50,145 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:50,145 INFO     [param_server.py:410] Lock worker 3 with localStep 442 , while globalStep is 441

2021-08-18:17:03:50,885 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:50,901 INFO     [learner.py:606] ====Pushing takes 0.014486312866210938 s
2021-08-18:17:03:50,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:50,921 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:50,922 INFO     [param_server.py:381] ====After aggregation in epoch: 441, virtual_clock: 21720.344809734266, top_1: : 65.7631 % (2038.0), top_5: : 100.0 % (3099.0), test loss: 3.8037664448773416, test len: 3099.0
2021-08-18:17:03:50,924 INFO     [param_server.py:410] Lock worker 2 with localStep 442 , while globalStep is 442

2021-08-18:17:03:50,924 INFO     [param_server.py:441] ====Epoch 443 completes 13 clients with loss 3.1462259657028824, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:50,925 INFO     [param_server.py:450] ====Start to sample for epoch 443, global virtualClock: 21720.344809734266, round_duration: 80.35344175505469
2021-08-18:17:03:50,925 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:51,208 INFO     [param_server.py:553] For epoch: 443, median_reward: 458.4482011882456, dev: 916.8964023764912
2021-08-18:17:03:51,851 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.685, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:03:51,852 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5683.2666, eval_time 0.5993, test_loss 4.685, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:03:51,853 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 6.5586, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:17:03:51,853 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5683.2705, eval_time 0.6004, test_loss 6.5586, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:17:03:51,920 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:03:51,930 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:51,935 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:03:51,943 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:51,972 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.0304, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:03:51,973 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5683.3923, eval_time 0.7195, test_loss 5.0304, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:03:52,47 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:03:52,76 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:53,103 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:53,124 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:54,252 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:54,270 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:54,305 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:54,326 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:55,775 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:55,785 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:56,991 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:57,2 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:57,53 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:57,87 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:57,334 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:57,344 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:58,31 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:58,65 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:58,665 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:58,681 INFO     [learner.py:606] ====Pushing takes 0.014424562454223633 s
2021-08-18:17:03:58,703 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:58,704 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:58,709 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:58,710 INFO     [param_server.py:410] Lock worker 1 with localStep 443 , while globalStep is 442

2021-08-18:17:03:58,713 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:59,341 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:59,361 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:00,361 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:00,382 INFO     [learner.py:606] ====Pushing takes 0.01941680908203125 s
2021-08-18:17:04:00,412 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:00,418 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:00,419 INFO     [param_server.py:410] Lock worker 3 with localStep 443 , while globalStep is 442

2021-08-18:17:04:01,4 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:01,21 INFO     [learner.py:606] ====Pushing takes 0.01567363739013672 s
2021-08-18:17:04:01,36 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:01,41 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:01,41 INFO     [param_server.py:381] ====After aggregation in epoch: 442, virtual_clock: 21800.69825148932, top_1: : 63.2139 % (1959.0), top_5: : 100.0 % (3099.0), test loss: 5.4246423421082675, test len: 3099.0
2021-08-18:17:04:01,43 INFO     [param_server.py:410] Lock worker 2 with localStep 443 , while globalStep is 443

2021-08-18:17:04:01,43 INFO     [param_server.py:441] ====Epoch 444 completes 13 clients with loss 5.119257181301088, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:01,44 INFO     [param_server.py:450] ====Start to sample for epoch 444, global virtualClock: 21800.69825148932, round_duration: 80.35344175505469
2021-08-18:17:04:01,44 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:01,322 INFO     [param_server.py:553] For epoch: 444, median_reward: 400.36857030449704, dev: 800.7371406089941
2021-08-18:17:04:01,986 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4748, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:04:01,987 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5693.4011, eval_time 0.6312, test_loss 3.4748, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:04:01,987 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5422, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:04:01,988 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5693.405, eval_time 0.6332, test_loss 3.5422, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:04:02,24 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.438, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:04:02,25 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5693.4449, eval_time 0.6706, test_loss 3.438, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:04:02,58 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:04:02,61 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:04:02,66 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:02,68 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:02,113 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:04:02,136 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:03,79 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:03,88 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:04,113 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:04,126 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:04,363 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:04,397 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:05,884 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:05,895 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:07,14 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:07,25 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:07,138 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:07,152 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:07,294 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:07,303 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:07,921 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:07,942 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:08,524 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:08,543 INFO     [learner.py:606] ====Pushing takes 0.015151262283325195 s
2021-08-18:17:04:08,566 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:08,573 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:08,573 INFO     [param_server.py:410] Lock worker 1 with localStep 444 , while globalStep is 443

2021-08-18:17:04:08,793 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:08,803 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:08,903 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:08,912 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:10,32 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:10,58 INFO     [learner.py:606] ====Pushing takes 0.022718429565429688 s
2021-08-18:17:04:10,82 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:10,88 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:10,89 INFO     [param_server.py:410] Lock worker 3 with localStep 444 , while globalStep is 443

2021-08-18:17:04:11,49 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:11,67 INFO     [learner.py:606] ====Pushing takes 0.016268491744995117 s
2021-08-18:17:04:11,87 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:11,93 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:11,93 INFO     [param_server.py:381] ====After aggregation in epoch: 443, virtual_clock: 21881.051693244375, top_1: : 66.1504 % (2050.0), top_5: : 100.0 % (3099.0), test loss: 3.484963884094247, test len: 3099.0
2021-08-18:17:04:11,96 INFO     [param_server.py:410] Lock worker 2 with localStep 444 , while globalStep is 444

2021-08-18:17:04:11,96 INFO     [param_server.py:441] ====Epoch 445 completes 13 clients with loss 3.3807828784347, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:11,97 INFO     [param_server.py:450] ====Start to sample for epoch 445, global virtualClock: 21881.051693244375, round_duration: 80.35344175505469
2021-08-18:17:04:11,97 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:11,372 INFO     [param_server.py:553] For epoch: 445, median_reward: 390.31266377142475, dev: 780.6253275428495
2021-08-18:17:04:12,18 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7059, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:04:12,21 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5703.4347, eval_time 0.5951, test_loss 3.7059, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:04:12,26 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1674, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:17:04:12,26 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5703.4436, eval_time 0.6077, test_loss 4.1674, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:17:04:12,48 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1266, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:04:12,49 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5703.4686, eval_time 0.6326, test_loss 4.1266, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:04:12,94 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:04:12,98 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:04:12,104 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:12,107 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:12,125 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:04:12,137 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:13,257 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:13,266 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:13,992 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:14,13 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:14,389 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:14,400 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:16,143 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:16,157 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:17,184 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:17,202 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:17,231 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:17,264 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:17,641 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:17,653 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:18,7 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:18,21 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:18,665 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:18,681 INFO     [learner.py:606] ====Pushing takes 0.01439809799194336 s
2021-08-18:17:04:18,706 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:18,712 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:18,713 INFO     [param_server.py:410] Lock worker 1 with localStep 445 , while globalStep is 444

2021-08-18:17:04:18,946 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:18,980 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:19,296 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:19,308 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:20,460 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:20,480 INFO     [learner.py:606] ====Pushing takes 0.018465757369995117 s
2021-08-18:17:04:20,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:20,515 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:20,516 INFO     [param_server.py:410] Lock worker 3 with localStep 445 , while globalStep is 444

2021-08-18:17:04:21,239 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:21,255 INFO     [learner.py:606] ====Pushing takes 0.015001535415649414 s
2021-08-18:17:04:21,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:21,275 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:21,276 INFO     [param_server.py:381] ====After aggregation in epoch: 444, virtual_clock: 21961.40513499943, top_1: : 63.6012 % (1971.0), top_5: : 100.0 % (3099.0), test loss: 3.9999682682531854, test len: 3099.0
2021-08-18:17:04:21,278 INFO     [param_server.py:410] Lock worker 2 with localStep 445 , while globalStep is 445

2021-08-18:17:04:21,279 INFO     [param_server.py:441] ====Epoch 446 completes 13 clients with loss 3.6318347221870293, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:21,279 INFO     [param_server.py:450] ====Start to sample for epoch 446, global virtualClock: 21961.40513499943, round_duration: 80.35344175505469
2021-08-18:17:04:21,280 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:21,555 INFO     [param_server.py:553] For epoch: 446, median_reward: 419.7400327656902, dev: 839.4800655313804
2021-08-18:17:04:22,193 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7774, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:04:22,193 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5713.6106, eval_time 0.5813, test_loss 3.7774, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:04:22,236 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5144, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:04:22,236 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5713.6506, eval_time 0.6241, test_loss 3.5144, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:04:22,260 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:04:22,268 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:22,323 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:04:22,335 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:22,354 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6012, Top-1 Accuracy: 716.0/1033 (0.6931), Top-5 Accuracy: 1.0
2021-08-18:17:04:22,355 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5713.7748, eval_time 0.7447, test_loss 3.6012, test_accuracy 0.6931, test_5_accuracy 1.0 

2021-08-18:17:04:22,446 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:04:22,474 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:23,761 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:23,775 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:24,324 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:24,342 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:24,625 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:24,638 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:26,493 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:26,507 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:27,336 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:27,369 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:27,428 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:27,440 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:27,984 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:28,2 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:28,303 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:28,337 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:29,41 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:29,56 INFO     [learner.py:606] ====Pushing takes 0.013717174530029297 s
2021-08-18:17:04:29,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:29,87 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:29,87 INFO     [param_server.py:410] Lock worker 1 with localStep 446 , while globalStep is 445

2021-08-18:17:04:29,133 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:29,147 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:29,808 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:29,820 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:30,849 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:30,870 INFO     [learner.py:606] ====Pushing takes 0.02026081085205078 s
2021-08-18:17:04:30,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:30,901 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:30,901 INFO     [param_server.py:410] Lock worker 3 with localStep 446 , while globalStep is 445

2021-08-18:17:04:31,413 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:31,430 INFO     [learner.py:606] ====Pushing takes 0.014976263046264648 s
2021-08-18:17:04:31,444 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:31,449 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:31,450 INFO     [param_server.py:381] ====After aggregation in epoch: 445, virtual_clock: 22041.758576754484, top_1: : 66.4731 % (2060.0), top_5: : 100.0 % (3099.0), test loss: 3.6309737298223705, test len: 3099.0
2021-08-18:17:04:31,452 INFO     [param_server.py:410] Lock worker 2 with localStep 446 , while globalStep is 446

2021-08-18:17:04:31,453 INFO     [param_server.py:441] ====Epoch 447 completes 13 clients with loss 3.5382565968220465, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:31,453 INFO     [param_server.py:450] ====Start to sample for epoch 447, global virtualClock: 22041.758576754484, round_duration: 80.35344175505469
2021-08-18:17:04:31,454 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:31,767 INFO     [param_server.py:553] For epoch: 447, median_reward: 420.5337802035662, dev: 841.0675604071324
2021-08-18:17:04:32,508 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2904, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:17:04:32,510 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5723.9238, eval_time 0.7035, test_loss 4.2904, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:17:04:32,517 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.8042, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:17:04:32,518 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5723.9349, eval_time 0.7118, test_loss 4.8042, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:17:04:32,580 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:04:32,586 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:04:32,589 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:32,674 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:32,687 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.6253, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:04:32,689 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5724.1083, eval_time 0.8826, test_loss 5.6253, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:04:32,759 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:04:32,793 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:33,721 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:33,739 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:34,952 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:34,972 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:35,155 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:35,182 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:36,727 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:36,741 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:37,744 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:37,764 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:37,771 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:37,783 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:37,903 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:37,915 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:38,648 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:38,682 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:39,443 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:39,453 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:39,456 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:39,471 INFO     [learner.py:606] ====Pushing takes 0.01470041275024414 s
2021-08-18:17:04:39,496 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:39,502 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:39,502 INFO     [param_server.py:410] Lock worker 1 with localStep 447 , while globalStep is 446

2021-08-18:17:04:39,621 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:39,633 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:40,865 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:40,886 INFO     [learner.py:606] ====Pushing takes 0.019001007080078125 s
2021-08-18:17:04:40,910 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:40,916 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:40,917 INFO     [param_server.py:410] Lock worker 3 with localStep 447 , while globalStep is 446

2021-08-18:17:04:42,65 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:42,86 INFO     [learner.py:606] ====Pushing takes 0.01884746551513672 s
2021-08-18:17:04:42,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:42,106 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:42,107 INFO     [param_server.py:381] ====After aggregation in epoch: 446, virtual_clock: 22122.11201850954, top_1: : 62.4718 % (1936.0), top_5: : 100.0 % (3099.0), test loss: 4.906624917630796, test len: 3099.0
2021-08-18:17:04:42,111 INFO     [param_server.py:410] Lock worker 2 with localStep 447 , while globalStep is 447

2021-08-18:17:04:42,111 INFO     [param_server.py:441] ====Epoch 448 completes 13 clients with loss 4.612558080075898, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:42,112 INFO     [param_server.py:450] ====Start to sample for epoch 448, global virtualClock: 22122.11201850954, round_duration: 80.35344175505469
2021-08-18:17:04:42,112 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:42,432 INFO     [param_server.py:553] For epoch: 448, median_reward: 415.16352645753886, dev: 830.3270529150777
2021-08-18:17:04:43,33 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3422, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:04:43,34 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5734.4477, eval_time 0.5782, test_loss 3.3422, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:04:43,75 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8741, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:04:43,76 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5734.4957, eval_time 0.6207, test_loss 3.8741, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:04:43,80 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.738, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:04:43,80 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5734.4976, eval_time 0.6252, test_loss 3.738, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:04:43,99 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:43,111 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:43,145 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:43,160 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:43,165 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:43,176 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:44,236 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:44,245 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:45,283 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:45,323 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:45,557 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:45,571 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:47,262 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:47,276 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:48,132 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:48,145 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:48,594 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:48,605 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:48,618 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:48,627 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:48,803 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:48,824 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:49,478 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:49,494 INFO     [learner.py:606] ====Pushing takes 0.015142679214477539 s
2021-08-18:17:04:49,515 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:49,522 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:49,523 INFO     [param_server.py:410] Lock worker 1 with localStep 448 , while globalStep is 447

2021-08-18:17:04:50,243 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:50,252 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:50,332 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:50,343 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:51,407 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:51,427 INFO     [learner.py:606] ====Pushing takes 0.019253015518188477 s
2021-08-18:17:04:51,450 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:51,456 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:51,456 INFO     [param_server.py:410] Lock worker 3 with localStep 448 , while globalStep is 447

2021-08-18:17:04:52,706 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:52,728 INFO     [learner.py:606] ====Pushing takes 0.02080988883972168 s
2021-08-18:17:04:52,744 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:52,750 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:52,751 INFO     [param_server.py:381] ====After aggregation in epoch: 447, virtual_clock: 22202.465460264593, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 3.651428304336689, test len: 3099.0
2021-08-18:17:04:52,754 INFO     [param_server.py:410] Lock worker 2 with localStep 448 , while globalStep is 448

2021-08-18:17:04:52,754 INFO     [param_server.py:441] ====Epoch 449 completes 13 clients with loss 4.315472312740119, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:52,755 INFO     [param_server.py:450] ====Start to sample for epoch 449, global virtualClock: 22202.465460264593, round_duration: 80.35344175505469
2021-08-18:17:04:52,756 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:53,33 INFO     [param_server.py:553] For epoch: 449, median_reward: 402.21395556639055, dev: 804.4279111327811
2021-08-18:17:04:53,795 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8619, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:04:53,797 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5745.2136, eval_time 0.7272, test_loss 3.8619, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:04:53,840 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3966, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:04:53,841 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5745.2556, eval_time 0.772, test_loss 4.3966, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:04:53,880 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1719, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:04:53,881 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5745.3007, eval_time 0.812, test_loss 4.1719, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:04:53,890 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:04:53,906 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:53,907 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:04:53,920 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:53,952 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:04:53,976 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:55,60 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:55,70 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:56,197 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:56,230 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:56,359 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:56,378 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:57,739 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:57,754 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:59,91 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:59,102 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:59,105 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:59,121 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:59,172 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:59,193 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:00,37 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:00,58 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:00,629 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:00,644 INFO     [learner.py:606] ====Pushing takes 0.013512372970581055 s
2021-08-18:17:05:00,660 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:00,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:00,667 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:00,668 INFO     [param_server.py:410] Lock worker 1 with localStep 449 , while globalStep is 448

2021-08-18:17:05:00,671 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:00,719 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:00,729 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:01,777 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:01,795 INFO     [learner.py:606] ====Pushing takes 0.01764392852783203 s
2021-08-18:17:05:01,818 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:01,824 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:01,825 INFO     [param_server.py:410] Lock worker 3 with localStep 449 , while globalStep is 448

2021-08-18:17:05:02,815 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:02,841 INFO     [learner.py:606] ====Pushing takes 0.024269819259643555 s
2021-08-18:17:05:02,857 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:02,863 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:02,864 INFO     [param_server.py:381] ====After aggregation in epoch: 448, virtual_clock: 22282.818902019648, top_1: : 64.3111 % (1993.0), top_5: : 100.0 % (3099.0), test loss: 4.143483559290568, test len: 3099.0
2021-08-18:17:05:02,867 INFO     [param_server.py:410] Lock worker 2 with localStep 449 , while globalStep is 449

2021-08-18:17:05:02,867 INFO     [param_server.py:441] ====Epoch 450 completes 13 clients with loss 3.6783507055599007, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:02,868 INFO     [param_server.py:450] ====Start to sample for epoch 450, global virtualClock: 22282.818902019648, round_duration: 80.35344175505469
2021-08-18:17:05:02,869 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:03,202 INFO     [param_server.py:553] For epoch: 450, median_reward: 404.70963858730204, dev: 809.4192771746041
2021-08-18:17:05:03,933 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5814, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:05:03,934 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5755.3507, eval_time 0.6748, test_loss 3.5814, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:05:03,936 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1609, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:17:05:03,937 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5755.3517, eval_time 0.6787, test_loss 3.1609, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:17:05:04,4 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:05:04,26 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:04,49 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.657, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:17:05:04,50 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5755.4698, eval_time 0.7915, test_loss 3.657, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:17:05:04,57 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:05:04,81 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:04,118 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:05:04,144 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:05,47 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:05,61 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:06,325 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:06,339 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:06,709 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:06,721 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:07,774 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:07,784 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:09,115 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:09,117 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:09,127 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:09,149 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:09,440 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:09,456 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:10,152 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:10,179 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:10,796 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:10,811 INFO     [learner.py:606] ====Pushing takes 0.013507366180419922 s
2021-08-18:17:05:10,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:10,844 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:10,845 INFO     [param_server.py:410] Lock worker 1 with localStep 450 , while globalStep is 449

2021-08-18:17:05:10,967 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:10,982 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:11,177 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:11,187 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:12,108 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:12,128 INFO     [learner.py:606] ====Pushing takes 0.019034624099731445 s
2021-08-18:17:05:12,153 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:12,159 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:12,160 INFO     [param_server.py:410] Lock worker 3 with localStep 450 , while globalStep is 449

2021-08-18:17:05:13,593 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:13,611 INFO     [learner.py:606] ====Pushing takes 0.01605391502380371 s
2021-08-18:17:05:13,626 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:13,631 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:13,632 INFO     [param_server.py:381] ====After aggregation in epoch: 449, virtual_clock: 22363.172343774702, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 3.466415705504241, test len: 3099.0
2021-08-18:17:05:13,636 INFO     [param_server.py:410] Lock worker 2 with localStep 450 , while globalStep is 450

2021-08-18:17:05:13,636 INFO     [param_server.py:441] ====Epoch 451 completes 13 clients with loss 4.080815950395986, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:13,637 INFO     [param_server.py:450] ====Start to sample for epoch 451, global virtualClock: 22363.172343774702, round_duration: 80.35344175505469
2021-08-18:17:05:13,638 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:13,986 INFO     [param_server.py:553] For epoch: 451, median_reward: 417.7050730878558, dev: 835.4101461757116
2021-08-18:17:05:14,623 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8268, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:05:14,624 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5766.0382, eval_time 0.5808, test_loss 3.8268, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:05:14,673 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1877, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:05:14,674 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5766.0916, eval_time 0.6321, test_loss 4.1877, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:05:14,691 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:05:14,700 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:14,762 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:05:14,778 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:14,782 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.8264, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:17:05:14,782 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5766.2021, eval_time 0.7404, test_loss 4.8264, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:17:05:14,840 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:05:14,874 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:15,829 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:15,844 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:17,120 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:17,140 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:17,306 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:17,324 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:18,713 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:18,727 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:19,840 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:19,867 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:20,26 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:20,37 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:20,66 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:20,80 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:20,805 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:20,845 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:21,623 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:21,638 INFO     [learner.py:606] ====Pushing takes 0.013819217681884766 s
2021-08-18:17:05:21,660 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:21,665 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:21,666 INFO     [param_server.py:410] Lock worker 1 with localStep 451 , while globalStep is 450

2021-08-18:17:05:21,702 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:21,716 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:21,823 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:21,837 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:22,880 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:22,900 INFO     [learner.py:606] ====Pushing takes 0.018527746200561523 s
2021-08-18:17:05:22,923 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:22,929 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:22,930 INFO     [param_server.py:410] Lock worker 3 with localStep 451 , while globalStep is 450

2021-08-18:17:05:24,87 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:24,113 INFO     [learner.py:606] ====Pushing takes 0.02407217025756836 s
2021-08-18:17:05:24,128 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:24,133 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:24,134 INFO     [param_server.py:381] ====After aggregation in epoch: 450, virtual_clock: 22443.525785529757, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 4.280279512758608, test len: 3099.0
2021-08-18:17:05:24,136 INFO     [param_server.py:410] Lock worker 2 with localStep 451 , while globalStep is 451

2021-08-18:17:05:24,136 INFO     [param_server.py:441] ====Epoch 452 completes 13 clients with loss 4.725797660002812, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:24,137 INFO     [param_server.py:450] ====Start to sample for epoch 452, global virtualClock: 22443.525785529757, round_duration: 80.35344175505469
2021-08-18:17:05:24,138 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:24,486 INFO     [param_server.py:553] For epoch: 452, median_reward: 425.47341324517544, dev: 850.9468264903509
2021-08-18:17:05:25,143 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.8578, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:05:25,144 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5776.5582, eval_time 0.6135, test_loss 4.8578, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:05:25,180 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6527, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:05:25,182 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5776.5986, eval_time 0.651, test_loss 3.6527, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:05:25,216 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:05:25,224 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:25,234 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7723, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:17:05:25,235 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5776.6549, eval_time 0.7048, test_loss 3.7723, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:17:05:25,263 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:05:25,279 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:25,305 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:05:25,340 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:26,256 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:26,265 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:27,490 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:27,518 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:27,607 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:27,627 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:29,18 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:29,28 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:30,98 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:30,118 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:30,260 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:30,271 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:30,425 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:30,437 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:30,964 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:31,4 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:31,744 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:31,758 INFO     [learner.py:606] ====Pushing takes 0.011892557144165039 s
2021-08-18:17:05:31,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:31,785 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:31,786 INFO     [param_server.py:410] Lock worker 1 with localStep 452 , while globalStep is 451

2021-08-18:17:05:32,313 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:32,314 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:32,327 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:32,335 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:33,501 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:33,524 INFO     [learner.py:606] ====Pushing takes 0.017443418502807617 s
2021-08-18:17:05:33,546 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:33,554 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:33,555 INFO     [param_server.py:410] Lock worker 3 with localStep 452 , while globalStep is 451

2021-08-18:17:05:34,887 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:34,910 INFO     [learner.py:606] ====Pushing takes 0.021190881729125977 s
2021-08-18:17:05:34,925 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:34,930 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:34,931 INFO     [param_server.py:381] ====After aggregation in epoch: 451, virtual_clock: 22523.87922728481, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 4.094269390459414, test len: 3099.0
2021-08-18:17:05:34,934 INFO     [param_server.py:410] Lock worker 2 with localStep 452 , while globalStep is 452

2021-08-18:17:05:34,934 INFO     [param_server.py:441] ====Epoch 453 completes 13 clients with loss 5.868152159203026, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:34,935 INFO     [param_server.py:450] ====Start to sample for epoch 453, global virtualClock: 22523.87922728481, round_duration: 80.35344175505469
2021-08-18:17:05:34,936 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:35,309 INFO     [param_server.py:553] For epoch: 453, median_reward: 426.6520128858566, dev: 853.3040257717132
2021-08-18:17:05:35,967 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.866, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:05:35,968 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3775, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:05:35,968 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5787.3856, eval_time 0.6215, test_loss 3.866, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:05:35,969 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5787.3828, eval_time 0.6204, test_loss 3.3775, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:05:36,28 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0015, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:05:36,29 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5787.4488, eval_time 0.6821, test_loss 4.0015, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:05:36,37 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:05:36,47 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:36,58 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:05:36,68 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:36,86 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:05:36,109 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:37,73 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:37,83 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:38,180 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:38,194 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:38,472 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:38,499 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:39,985 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:39,994 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:41,3 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:41,13 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:41,19 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:41,47 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:41,487 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:41,496 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:41,987 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:42,15 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:42,689 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:42,703 INFO     [learner.py:606] ====Pushing takes 0.012964010238647461 s
2021-08-18:17:05:42,713 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:42,720 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:42,725 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:42,725 INFO     [param_server.py:410] Lock worker 1 with localStep 453 , while globalStep is 452

2021-08-18:17:05:42,727 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:43,297 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:43,310 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:44,517 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:44,535 INFO     [learner.py:606] ====Pushing takes 0.016495466232299805 s
2021-08-18:17:05:44,560 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:44,565 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:44,566 INFO     [param_server.py:410] Lock worker 3 with localStep 453 , while globalStep is 452

2021-08-18:17:05:45,549 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:45,564 INFO     [learner.py:606] ====Pushing takes 0.013882637023925781 s
2021-08-18:17:05:45,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:45,585 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:45,586 INFO     [param_server.py:381] ====After aggregation in epoch: 452, virtual_clock: 22604.232669039866, top_1: : 64.7628 % (2007.0), top_5: : 100.0 % (3099.0), test loss: 3.7483645633414944, test len: 3099.0
2021-08-18:17:05:45,588 INFO     [param_server.py:410] Lock worker 2 with localStep 453 , while globalStep is 453

2021-08-18:17:05:45,588 INFO     [param_server.py:441] ====Epoch 454 completes 13 clients with loss 3.380105815678295, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:45,588 INFO     [param_server.py:450] ====Start to sample for epoch 454, global virtualClock: 22604.232669039866, round_duration: 80.35344175505469
2021-08-18:17:05:45,589 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:45,884 INFO     [param_server.py:553] For epoch: 454, median_reward: 419.39270132875083, dev: 838.7854026575017
2021-08-18:17:05:46,556 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1003, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:05:46,556 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5797.9706, eval_time 0.6479, test_loss 3.1003, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:05:46,558 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2245, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:05:46,558 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5797.9752, eval_time 0.6496, test_loss 3.2245, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:05:46,595 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4685, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:17:05:46,596 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5798.016, eval_time 0.6903, test_loss 3.4685, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:17:05:46,626 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:46,629 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:46,633 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:46,638 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:46,666 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:46,681 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:47,825 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:47,835 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:48,692 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:48,726 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:49,69 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:49,81 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:50,603 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:50,615 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:51,318 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:51,332 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:51,958 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:51,967 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:51,986 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:51,995 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:52,242 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:52,270 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:52,768 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:52,789 INFO     [learner.py:606] ====Pushing takes 0.018610715866088867 s
2021-08-18:17:05:52,815 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:52,827 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:52,828 INFO     [param_server.py:410] Lock worker 1 with localStep 454 , while globalStep is 453

2021-08-18:17:05:53,756 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:53,777 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:53,825 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:53,839 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:55,3 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:55,23 INFO     [learner.py:606] ====Pushing takes 0.018647193908691406 s
2021-08-18:17:05:55,56 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:55,62 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:55,63 INFO     [param_server.py:410] Lock worker 3 with localStep 454 , while globalStep is 453

2021-08-18:17:05:56,418 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:56,434 INFO     [learner.py:606] ====Pushing takes 0.014733314514160156 s
2021-08-18:17:05:56,449 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:56,453 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:56,454 INFO     [param_server.py:381] ====After aggregation in epoch: 453, virtual_clock: 22684.58611079492, top_1: : 66.6344 % (2065.0), top_5: : 100.0 % (3099.0), test loss: 3.264441585099256, test len: 3099.0
2021-08-18:17:05:56,457 INFO     [param_server.py:410] Lock worker 2 with localStep 454 , while globalStep is 454

2021-08-18:17:05:56,457 INFO     [param_server.py:441] ====Epoch 455 completes 13 clients with loss 4.040504485349139, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:56,457 INFO     [param_server.py:450] ====Start to sample for epoch 455, global virtualClock: 22684.58611079492, round_duration: 80.35344175505469
2021-08-18:17:05:56,467 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:05:56,820 INFO     [param_server.py:553] For epoch: 455, median_reward: 433.5774024518942, dev: 867.1548049037884
2021-08-18:17:05:57,453 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.6335, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:05:57,454 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5808.8684, eval_time 0.6008, test_loss 4.6335, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:05:57,454 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3637, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:05:57,455 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5808.8722, eval_time 0.6017, test_loss 4.3637, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:05:57,519 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3182, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:17:05:57,523 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5808.9423, eval_time 0.6692, test_loss 4.3182, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:17:05:57,525 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:05:57,527 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:05:57,533 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:57,537 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:57,593 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:05:57,610 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:58,704 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:58,714 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:59,736 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:59,756 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:59,974 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:59,984 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:01,448 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:01,457 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:02,420 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:02,453 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:02,757 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:02,772 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:02,831 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:02,843 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:03,456 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:03,489 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:04,89 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:04,103 INFO     [learner.py:606] ====Pushing takes 0.013647794723510742 s
2021-08-18:17:06:04,125 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:04,132 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:04,132 INFO     [param_server.py:410] Lock worker 1 with localStep 455 , while globalStep is 454

2021-08-18:17:06:04,528 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:04,540 INFO     [learner.py:606] ====Pushing takes 0.010706663131713867 s
2021-08-18:17:06:04,552 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:04,556 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:04,557 INFO     [param_server.py:410] Lock worker 2 with localStep 455 , while globalStep is 454

2021-08-18:17:06:04,640 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:04,655 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:05,941 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:05,962 INFO     [learner.py:606] ====Pushing takes 0.018969297409057617 s
2021-08-18:17:06:05,987 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:05,993 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:05,993 INFO     [param_server.py:381] ====After aggregation in epoch: 454, virtual_clock: 22768.183445956434, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 4.4384492812333285, test len: 3099.0
2021-08-18:17:06:05,996 INFO     [param_server.py:410] Lock worker 3 with localStep 455 , while globalStep is 455

2021-08-18:17:06:05,996 INFO     [param_server.py:441] ====Epoch 456 completes 12 clients with loss 6.218053292691266, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:05,997 INFO     [param_server.py:450] ====Start to sample for epoch 456, global virtualClock: 22768.183445956434, round_duration: 83.5973351615153
2021-08-18:17:06:05,997 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:06,283 INFO     [param_server.py:553] For epoch: 456, median_reward: 417.34198830445, dev: 834.6839766089
2021-08-18:17:06:06,913 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3739, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:06:06,914 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5818.3277, eval_time 0.5965, test_loss 3.3739, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:06:06,926 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0299, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:06:06,927 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5818.344, eval_time 0.6101, test_loss 4.0299, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:06:06,957 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.7664, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:17:06:06,958 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5818.3775, eval_time 0.6412, test_loss 4.7664, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:17:06:06,985 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:06:06,992 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:07,0 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:06:07,9 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:07,18 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:06:07,40 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:08,100 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:08,109 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:08,948 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:08,969 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:09,272 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:09,286 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:10,885 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:10,904 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:11,738 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:11,759 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:12,256 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:12,274 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:12,308 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:12,320 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:12,648 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:12,681 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:13,378 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:13,396 INFO     [learner.py:606] ====Pushing takes 0.014631986618041992 s
2021-08-18:17:06:13,416 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:13,423 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:13,424 INFO     [param_server.py:410] Lock worker 1 with localStep 456 , while globalStep is 455

2021-08-18:17:06:14,90 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:14,102 INFO     [learner.py:606] ====Pushing takes 0.010852813720703125 s
2021-08-18:17:06:14,114 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:14,118 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:14,119 INFO     [param_server.py:410] Lock worker 2 with localStep 456 , while globalStep is 455

2021-08-18:17:06:14,157 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:14,177 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:15,442 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:15,462 INFO     [learner.py:606] ====Pushing takes 0.01846027374267578 s
2021-08-18:17:06:15,487 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:15,493 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:15,493 INFO     [param_server.py:381] ====After aggregation in epoch: 455, virtual_clock: 22851.78078111795, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 4.05675028430091, test len: 3099.0
2021-08-18:17:06:15,495 INFO     [param_server.py:410] Lock worker 3 with localStep 456 , while globalStep is 456

2021-08-18:17:06:15,496 INFO     [param_server.py:441] ====Epoch 457 completes 12 clients with loss 3.361841547488117, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:15,496 INFO     [param_server.py:450] ====Start to sample for epoch 457, global virtualClock: 22851.78078111795, round_duration: 83.5973351615153
2021-08-18:17:06:15,497 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:15,782 INFO     [param_server.py:553] For epoch: 457, median_reward: 414.7003912305745, dev: 829.400782461149
2021-08-18:17:06:16,469 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5149, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:06:16,470 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5827.8868, eval_time 0.6389, test_loss 3.5149, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:06:16,503 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5116, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:06:16,503 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5827.9177, eval_time 0.6708, test_loss 3.5116, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:06:16,528 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9938, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:17:06:16,529 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5827.9489, eval_time 0.7029, test_loss 3.9938, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:17:06:16,541 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:06:16,549 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:16,572 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:06:16,586 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:16,601 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:06:16,617 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:17,881 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:17,891 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:18,768 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:18,789 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:18,877 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:18,888 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:20,539 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:20,548 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:21,593 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:21,626 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:21,631 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:21,652 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:21,772 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:21,788 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:22,575 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:22,603 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:23,300 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:23,334 INFO     [learner.py:606] ====Pushing takes 0.015036821365356445 s
2021-08-18:17:06:23,356 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:23,362 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:23,363 INFO     [param_server.py:410] Lock worker 1 with localStep 457 , while globalStep is 456

2021-08-18:17:06:23,517 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:23,535 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:23,557 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:23,569 INFO     [learner.py:606] ====Pushing takes 0.01077890396118164 s
2021-08-18:17:06:23,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:23,585 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:23,586 INFO     [param_server.py:410] Lock worker 2 with localStep 457 , while globalStep is 456

2021-08-18:17:06:24,751 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:24,771 INFO     [learner.py:606] ====Pushing takes 0.019077539443969727 s
2021-08-18:17:06:24,795 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:24,801 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:24,802 INFO     [param_server.py:381] ====After aggregation in epoch: 456, virtual_clock: 22935.378116279462, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 3.6734239017521895, test len: 3099.0
2021-08-18:17:06:24,805 INFO     [param_server.py:410] Lock worker 3 with localStep 457 , while globalStep is 457

2021-08-18:17:06:24,805 INFO     [param_server.py:441] ====Epoch 458 completes 12 clients with loss 4.269416634738555, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:24,805 INFO     [param_server.py:450] ====Start to sample for epoch 458, global virtualClock: 22935.378116279462, round_duration: 83.5973351615153
2021-08-18:17:06:24,806 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:25,95 INFO     [param_server.py:553] For epoch: 458, median_reward: 397.5298025255815, dev: 795.059605051163
2021-08-18:17:06:25,884 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1563, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:17:06:25,885 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5837.3017, eval_time 0.7321, test_loss 4.1563, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:17:06:25,920 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0491, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:06:25,921 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5837.3353, eval_time 0.7651, test_loss 4.0491, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:06:25,953 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:06:25,961 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:26,1 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2922, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:06:26,1 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5837.4211, eval_time 0.8509, test_loss 4.2922, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:06:26,14 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:06:26,30 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:26,71 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:06:26,101 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:27,78 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:27,92 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:28,274 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:28,283 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:28,293 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:28,296 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:29,805 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:29,816 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:31,11 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:31,23 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:31,49 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:31,79 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:31,79 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:31,90 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:31,970 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:32,4 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:32,762 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:32,775 INFO     [learner.py:606] ====Pushing takes 0.011589288711547852 s
2021-08-18:17:06:32,791 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:32,792 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:32,801 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:32,801 INFO     [param_server.py:410] Lock worker 1 with localStep 458 , while globalStep is 457

2021-08-18:17:06:32,803 INFO     [learner.py:606] ====Pushing takes 0.01033926010131836 s
2021-08-18:17:06:32,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:32,817 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:32,818 INFO     [param_server.py:410] Lock worker 2 with localStep 458 , while globalStep is 457

2021-08-18:17:06:33,18 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:33,37 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:34,362 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:34,381 INFO     [learner.py:606] ====Pushing takes 0.017208337783813477 s
2021-08-18:17:06:34,404 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:34,409 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:34,410 INFO     [param_server.py:381] ====After aggregation in epoch: 457, virtual_clock: 23018.975451440976, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 4.165855019180863, test len: 3099.0
2021-08-18:17:06:34,412 INFO     [param_server.py:410] Lock worker 3 with localStep 458 , while globalStep is 458

2021-08-18:17:06:34,412 INFO     [param_server.py:441] ====Epoch 459 completes 12 clients with loss 4.457764894456497, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:34,413 INFO     [param_server.py:450] ====Start to sample for epoch 459, global virtualClock: 23018.975451440976, round_duration: 83.5973351615153
2021-08-18:17:06:34,414 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:34,721 INFO     [param_server.py:553] For epoch: 459, median_reward: 408.3409056129502, dev: 816.6818112259004
2021-08-18:17:06:35,356 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4073, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:06:35,357 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5846.7711, eval_time 0.5902, test_loss 3.4073, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:06:35,434 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:06:35,446 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8317, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:06:35,447 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5846.8665, eval_time 0.6815, test_loss 3.8317, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:06:35,448 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:35,463 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6098, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:06:35,465 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5846.8817, eval_time 0.6993, test_loss 3.6098, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:06:35,503 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:06:35,527 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:35,534 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:06:35,550 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:36,557 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:36,567 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:37,769 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:37,796 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:37,820 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:37,841 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:39,347 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:39,360 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:40,184 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:40,205 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:40,512 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:40,521 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:40,650 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:40,660 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:41,183 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:41,211 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:41,835 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:41,849 INFO     [learner.py:606] ====Pushing takes 0.012867212295532227 s
2021-08-18:17:06:41,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:41,878 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:41,878 INFO     [param_server.py:410] Lock worker 1 with localStep 459 , while globalStep is 458

2021-08-18:17:06:42,164 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:42,178 INFO     [learner.py:606] ====Pushing takes 0.011846780776977539 s
2021-08-18:17:06:42,189 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:42,193 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:42,194 INFO     [param_server.py:410] Lock worker 2 with localStep 459 , while globalStep is 458

2021-08-18:17:06:42,542 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:42,559 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:43,827 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:43,848 INFO     [learner.py:606] ====Pushing takes 0.019153118133544922 s
2021-08-18:17:06:43,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:43,888 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:43,889 INFO     [param_server.py:381] ====After aggregation in epoch: 458, virtual_clock: 23102.57278660249, top_1: : 65.021 % (2015.0), top_5: : 100.0 % (3099.0), test loss: 3.616245216793484, test len: 3099.0
2021-08-18:17:06:43,891 INFO     [param_server.py:410] Lock worker 3 with localStep 459 , while globalStep is 459

2021-08-18:17:06:43,892 INFO     [param_server.py:441] ====Epoch 460 completes 12 clients with loss 4.691135751547404, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:43,892 INFO     [param_server.py:450] ====Start to sample for epoch 460, global virtualClock: 23102.57278660249, round_duration: 83.5973351615153
2021-08-18:17:06:43,893 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:44,175 INFO     [param_server.py:553] For epoch: 460, median_reward: 413.7991364595972, dev: 827.5982729191944
2021-08-18:17:06:44,864 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0733, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:06:44,865 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5856.2788, eval_time 0.65, test_loss 4.0733, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:06:44,893 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1521, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:17:06:44,896 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5856.3127, eval_time 0.6828, test_loss 4.1521, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:17:06:44,929 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0769, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:06:44,932 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5856.3513, eval_time 0.7232, test_loss 4.0769, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:06:44,948 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:44,961 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:44,965 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:44,978 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:44,988 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:45,9 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:46,124 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:46,133 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:47,43 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:47,77 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:47,185 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:47,196 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:48,905 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:48,928 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:49,810 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:49,824 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:50,175 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:50,184 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:50,371 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:50,381 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:50,640 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:50,661 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:51,294 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:51,310 INFO     [learner.py:606] ====Pushing takes 0.014733552932739258 s
2021-08-18:17:06:51,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:51,344 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:51,346 INFO     [param_server.py:410] Lock worker 1 with localStep 460 , while globalStep is 459

2021-08-18:17:06:52,53 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:52,57 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:52,66 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:52,66 INFO     [learner.py:606] ====Pushing takes 0.011381387710571289 s
2021-08-18:17:06:52,78 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:52,82 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:52,83 INFO     [param_server.py:410] Lock worker 2 with localStep 460 , while globalStep is 459

2021-08-18:17:06:53,355 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:53,376 INFO     [learner.py:606] ====Pushing takes 0.01906871795654297 s
2021-08-18:17:06:53,400 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:53,406 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:53,406 INFO     [param_server.py:381] ====After aggregation in epoch: 459, virtual_clock: 23186.170121764004, top_1: : 64.0852 % (1986.0), top_5: : 100.0 % (3099.0), test loss: 4.100789564627188, test len: 3099.0
2021-08-18:17:06:53,409 INFO     [param_server.py:410] Lock worker 3 with localStep 460 , while globalStep is 460

2021-08-18:17:06:53,409 INFO     [param_server.py:441] ====Epoch 461 completes 12 clients with loss 7.737787002944554, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:53,409 INFO     [param_server.py:450] ====Start to sample for epoch 461, global virtualClock: 23186.170121764004, round_duration: 83.5973351615153
2021-08-18:17:06:53,410 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:53,752 INFO     [param_server.py:541] Handle Wight 0.027371883392333984 | Send 0.3427870273590088
2021-08-18:17:06:53,753 INFO     [param_server.py:553] For epoch: 461, median_reward: 457.2654254045738, dev: 914.5308508091476
2021-08-18:17:06:54,486 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7784, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:17:06:54,487 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5865.901, eval_time 0.6594, test_loss 3.7784, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:17:06:54,525 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8853, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:06:54,526 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5865.9435, eval_time 0.7023, test_loss 3.8853, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:06:54,555 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:06:54,567 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:54,591 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3328, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:06:54,592 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5866.0115, eval_time 0.7735, test_loss 4.3328, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:06:54,593 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:06:54,607 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:54,662 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:06:54,689 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:55,745 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:55,755 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:56,528 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:56,542 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:56,781 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:56,790 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:58,371 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:58,383 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:59,508 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:59,512 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:59,524 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:59,542 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:59,654 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:59,663 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:00,437 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:00,465 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:01,75 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:01,93 INFO     [learner.py:606] ====Pushing takes 0.016607046127319336 s
2021-08-18:17:07:01,117 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:01,123 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:01,123 INFO     [param_server.py:410] Lock worker 1 with localStep 461 , while globalStep is 460

2021-08-18:17:07:01,328 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:01,339 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:01,355 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:01,367 INFO     [learner.py:606] ====Pushing takes 0.011160612106323242 s
2021-08-18:17:07:01,380 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:01,384 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:01,385 INFO     [param_server.py:410] Lock worker 2 with localStep 461 , while globalStep is 460

2021-08-18:17:07:02,661 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:02,681 INFO     [learner.py:606] ====Pushing takes 0.018486499786376953 s
2021-08-18:17:07:02,706 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:02,712 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:02,713 INFO     [param_server.py:381] ====After aggregation in epoch: 460, virtual_clock: 23269.767456925518, top_1: : 64.3433 % (1994.0), top_5: : 100.0 % (3099.0), test loss: 3.9988228215111623, test len: 3099.0
2021-08-18:17:07:02,716 INFO     [param_server.py:410] Lock worker 3 with localStep 461 , while globalStep is 461

2021-08-18:17:07:02,716 INFO     [param_server.py:441] ====Epoch 462 completes 12 clients with loss 4.270471534961743, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:02,717 INFO     [param_server.py:450] ====Start to sample for epoch 462, global virtualClock: 23269.767456925518, round_duration: 83.5973351615153
2021-08-18:17:07:02,717 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:03,61 INFO     [param_server.py:553] For epoch: 462, median_reward: 399.95058880991473, dev: 799.9011776198295
2021-08-18:17:07:03,780 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6135, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:07:03,781 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5875.195, eval_time 0.6696, test_loss 3.6135, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:07:03,783 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1195, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:07:03,786 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5875.2036, eval_time 0.6761, test_loss 4.1195, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:07:03,848 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:07:03,855 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:03,857 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:07:03,865 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:03,924 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7114, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:17:07:03,927 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5875.3465, eval_time 0.8207, test_loss 3.7114, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:17:07:03,997 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:07:04,32 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:05,3 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:05,12 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:06,357 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:06,378 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:06,455 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:06,474 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:07,891 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:07,900 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:08,939 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:08,973 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:09,153 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:09,162 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:09,166 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:09,175 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:09,969 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:10,3 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:10,546 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:10,563 INFO     [learner.py:606] ====Pushing takes 0.015424013137817383 s
2021-08-18:17:07:10,584 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:10,592 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:10,593 INFO     [param_server.py:410] Lock worker 1 with localStep 462 , while globalStep is 461

2021-08-18:17:07:11,21 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:11,29 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:11,35 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:11,41 INFO     [learner.py:606] ====Pushing takes 0.010924816131591797 s
2021-08-18:17:07:11,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:11,57 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:11,58 INFO     [param_server.py:410] Lock worker 2 with localStep 462 , while globalStep is 461

2021-08-18:17:07:12,265 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:12,285 INFO     [learner.py:606] ====Pushing takes 0.01821589469909668 s
2021-08-18:17:07:12,311 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:12,317 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:12,318 INFO     [param_server.py:381] ====After aggregation in epoch: 461, virtual_clock: 23353.36479208703, top_1: : 64.666 % (2004.0), top_5: : 100.0 % (3099.0), test loss: 3.814794766130271, test len: 3099.0
2021-08-18:17:07:12,321 INFO     [param_server.py:410] Lock worker 3 with localStep 462 , while globalStep is 462

2021-08-18:17:07:12,321 INFO     [param_server.py:441] ====Epoch 463 completes 12 clients with loss 4.745166716869938, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:12,322 INFO     [param_server.py:450] ====Start to sample for epoch 463, global virtualClock: 23353.36479208703, round_duration: 83.5973351615153
2021-08-18:17:07:12,323 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:12,670 INFO     [param_server.py:553] For epoch: 463, median_reward: 385.8028768444268, dev: 771.6057536888536
2021-08-18:17:07:13,239 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9794, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:17:07:13,243 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5884.6603, eval_time 0.5377, test_loss 3.9794, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:17:07:13,251 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6333, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:07:13,252 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5884.6663, eval_time 0.5465, test_loss 3.6333, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:07:13,315 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:07:13,321 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:07:13,323 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:13,330 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:13,331 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1033, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:17:07:13,332 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5884.7514, eval_time 0.6261, test_loss 4.1033, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:17:07:13,404 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:07:13,420 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:14,444 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:14,453 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:15,503 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:15,530 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:15,567 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:15,577 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:17,197 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:17,207 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:18,206 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:18,220 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:18,287 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:18,321 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:18,556 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:18,568 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:19,292 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:19,320 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:20,59 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:20,74 INFO     [learner.py:606] ====Pushing takes 0.013269662857055664 s
2021-08-18:17:07:20,90 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:20,95 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:20,96 INFO     [param_server.py:410] Lock worker 1 with localStep 463 , while globalStep is 462

2021-08-18:17:07:20,326 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:20,339 INFO     [learner.py:606] ====Pushing takes 0.011511564254760742 s
2021-08-18:17:07:20,355 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:20,373 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:20,374 INFO     [param_server.py:410] Lock worker 2 with localStep 463 , while globalStep is 462

2021-08-18:17:07:20,434 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:20,446 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:21,622 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:21,643 INFO     [learner.py:606] ====Pushing takes 0.019216060638427734 s
2021-08-18:17:07:21,668 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:21,675 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:21,675 INFO     [param_server.py:381] ====After aggregation in epoch: 462, virtual_clock: 23436.962127248546, top_1: : 62.5363 % (1938.0), top_5: : 100.0 % (3099.0), test loss: 3.905324211827031, test len: 3099.0
2021-08-18:17:07:21,678 INFO     [param_server.py:410] Lock worker 3 with localStep 463 , while globalStep is 463

2021-08-18:17:07:21,678 INFO     [param_server.py:441] ====Epoch 464 completes 12 clients with loss 6.023578563172752, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:21,678 INFO     [param_server.py:450] ====Start to sample for epoch 464, global virtualClock: 23436.962127248546, round_duration: 83.5973351615153
2021-08-18:17:07:21,679 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:22,26 INFO     [param_server.py:553] For epoch: 464, median_reward: 396.60893620864437, dev: 793.2178724172887
2021-08-18:17:07:22,770 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7003, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:07:22,771 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5894.1883, eval_time 0.688, test_loss 3.7003, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:07:22,771 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5013, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:07:22,772 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5894.1862, eval_time 0.6885, test_loss 3.5013, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:07:22,838 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:07:22,838 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:07:22,847 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:22,847 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:22,862 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7445, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:17:07:22,862 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5894.2821, eval_time 0.7804, test_loss 3.7445, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:17:07:22,938 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:07:22,955 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:24,63 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:24,78 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:24,844 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:24,865 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:25,96 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:25,114 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:26,757 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:26,767 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:27,657 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:27,684 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:27,819 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:27,829 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:28,87 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:28,97 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:28,485 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:28,512 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:29,125 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:29,141 INFO     [learner.py:606] ====Pushing takes 0.014869928359985352 s
2021-08-18:17:07:29,159 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:29,168 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:29,169 INFO     [param_server.py:410] Lock worker 1 with localStep 464 , while globalStep is 463

2021-08-18:17:07:29,675 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:29,687 INFO     [learner.py:606] ====Pushing takes 0.01057887077331543 s
2021-08-18:17:07:29,699 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:29,703 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:29,704 INFO     [param_server.py:410] Lock worker 2 with localStep 464 , while globalStep is 463

2021-08-18:17:07:30,188 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:30,200 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:31,271 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:31,290 INFO     [learner.py:606] ====Pushing takes 0.017159223556518555 s
2021-08-18:17:07:31,313 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:31,319 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:31,320 INFO     [param_server.py:381] ====After aggregation in epoch: 463, virtual_clock: 23520.55946241006, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 3.648710396554735, test len: 3099.0
2021-08-18:17:07:31,322 INFO     [param_server.py:410] Lock worker 3 with localStep 464 , while globalStep is 464

2021-08-18:17:07:31,323 INFO     [param_server.py:441] ====Epoch 465 completes 12 clients with loss 5.154129361842777, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:31,323 INFO     [param_server.py:450] ====Start to sample for epoch 465, global virtualClock: 23520.55946241006, round_duration: 83.5973351615153
2021-08-18:17:07:31,324 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:31,670 INFO     [param_server.py:553] For epoch: 465, median_reward: 432.5590048670344, dev: 865.1180097340688
2021-08-18:17:07:32,388 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0366, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:07:32,389 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5903.8089, eval_time 0.6749, test_loss 4.0366, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:07:32,399 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.842, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:07:32,400 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5903.8141, eval_time 0.6832, test_loss 3.842, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:07:32,407 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8814, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:07:32,408 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5903.825, eval_time 0.6913, test_loss 3.8814, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:07:32,462 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:07:32,470 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:07:32,479 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:32,479 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:32,482 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:07:32,492 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:33,812 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:33,821 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:34,452 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:34,479 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:34,804 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:34,813 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:36,498 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:36,508 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:37,246 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:37,266 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:37,768 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:37,781 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:37,814 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:37,823 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:38,128 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:38,156 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:38,952 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:38,967 INFO     [learner.py:606] ====Pushing takes 0.013726234436035156 s
2021-08-18:17:07:38,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:38,988 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:38,989 INFO     [param_server.py:410] Lock worker 1 with localStep 465 , while globalStep is 464

2021-08-18:17:07:39,616 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:39,627 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:39,672 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:39,683 INFO     [learner.py:606] ====Pushing takes 0.009901762008666992 s
2021-08-18:17:07:39,695 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:39,699 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:39,699 INFO     [param_server.py:410] Lock worker 2 with localStep 465 , while globalStep is 464

2021-08-18:17:07:40,756 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:40,777 INFO     [learner.py:606] ====Pushing takes 0.019460201263427734 s
2021-08-18:17:07:40,806 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:40,812 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:40,812 INFO     [param_server.py:381] ====After aggregation in epoch: 464, virtual_clock: 23604.156797571573, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 3.9199835459391275, test len: 3099.0
2021-08-18:17:07:40,815 INFO     [param_server.py:410] Lock worker 3 with localStep 465 , while globalStep is 465

2021-08-18:17:07:40,815 INFO     [param_server.py:441] ====Epoch 466 completes 12 clients with loss 5.671674150085498, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:40,816 INFO     [param_server.py:450] ====Start to sample for epoch 466, global virtualClock: 23604.156797571573, round_duration: 83.5973351615153
2021-08-18:17:07:40,816 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:41,131 INFO     [param_server.py:553] For epoch: 466, median_reward: 397.547419761776, dev: 795.094839523552
2021-08-18:17:07:41,882 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7642, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:07:41,883 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5913.2968, eval_time 0.683, test_loss 3.7642, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:07:41,887 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.4851, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:07:41,887 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5913.3046, eval_time 0.6944, test_loss 4.4851, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:07:41,899 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.373, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:17:07:41,900 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5913.32, eval_time 0.7128, test_loss 4.373, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:17:07:41,952 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:41,960 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:41,966 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:41,972 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:41,975 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:41,989 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:42,981 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:42,990 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:43,859 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:43,886 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:44,134 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:44,152 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:45,683 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:45,693 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:46,746 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:46,774 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:46,895 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:46,904 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:47,335 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:47,349 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:47,604 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:47,631 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:48,370 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:48,387 INFO     [learner.py:606] ====Pushing takes 0.01488804817199707 s
2021-08-18:17:07:48,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:48,418 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:48,418 INFO     [param_server.py:410] Lock worker 1 with localStep 466 , while globalStep is 465

2021-08-18:17:07:48,954 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:48,967 INFO     [learner.py:606] ====Pushing takes 0.011113882064819336 s
2021-08-18:17:07:48,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:48,987 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:48,988 INFO     [param_server.py:410] Lock worker 2 with localStep 466 , while globalStep is 465

2021-08-18:17:07:49,296 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:49,309 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:50,494 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:50,519 INFO     [learner.py:606] ====Pushing takes 0.022469520568847656 s
2021-08-18:17:07:50,545 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:50,551 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:50,551 INFO     [param_server.py:381] ====After aggregation in epoch: 465, virtual_clock: 23687.754132733087, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 4.207429594463772, test len: 3099.0
2021-08-18:17:07:50,554 INFO     [param_server.py:410] Lock worker 3 with localStep 466 , while globalStep is 466

2021-08-18:17:07:50,554 INFO     [param_server.py:441] ====Epoch 467 completes 12 clients with loss 3.3395956770492243, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:50,554 INFO     [param_server.py:450] ====Start to sample for epoch 467, global virtualClock: 23687.754132733087, round_duration: 83.5973351615153
2021-08-18:17:07:50,555 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:50,877 INFO     [param_server.py:553] For epoch: 467, median_reward: 430.41176022944984, dev: 860.8235204588997
2021-08-18:17:07:51,611 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6442, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:07:51,612 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5923.0264, eval_time 0.6727, test_loss 3.6442, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:07:51,635 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6382, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:07:51,636 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5923.053, eval_time 0.6991, test_loss 3.6382, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:07:51,679 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:07:51,694 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:51,712 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7748, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:17:07:51,712 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5923.1321, eval_time 0.779, test_loss 3.7748, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:17:07:51,728 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:07:51,744 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:51,785 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:07:51,807 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:52,775 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:52,789 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:53,899 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:53,919 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:54,8 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:54,19 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:55,498 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:55,507 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:56,634 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:56,648 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:56,680 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:56,714 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:56,868 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:56,882 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:57,620 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:57,648 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:58,196 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:58,214 INFO     [learner.py:606] ====Pushing takes 0.016448259353637695 s
2021-08-18:17:07:58,248 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:58,253 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:58,254 INFO     [param_server.py:410] Lock worker 1 with localStep 467 , while globalStep is 466

2021-08-18:17:07:58,604 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:58,617 INFO     [learner.py:606] ====Pushing takes 0.010875225067138672 s
2021-08-18:17:07:58,628 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:58,632 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:58,633 INFO     [param_server.py:410] Lock worker 2 with localStep 467 , while globalStep is 466

2021-08-18:17:07:58,641 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:58,659 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:59,794 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:59,815 INFO     [learner.py:606] ====Pushing takes 0.019824504852294922 s
2021-08-18:17:07:59,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:59,850 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:59,851 INFO     [param_server.py:381] ====After aggregation in epoch: 466, virtual_clock: 23771.3514678946, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 3.6857107127154314, test len: 3099.0
2021-08-18:17:07:59,854 INFO     [param_server.py:410] Lock worker 3 with localStep 467 , while globalStep is 467

2021-08-18:17:07:59,854 INFO     [param_server.py:441] ====Epoch 468 completes 12 clients with loss 4.80664239216726, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:59,855 INFO     [param_server.py:450] ====Start to sample for epoch 468, global virtualClock: 23771.3514678946, round_duration: 83.5973351615153
2021-08-18:17:07:59,856 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:00,231 INFO     [param_server.py:553] For epoch: 468, median_reward: 398.93395809906, dev: 797.86791619812
2021-08-18:17:08:00,930 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6469, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:08:00,931 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5932.345, eval_time 0.6537, test_loss 3.6469, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:08:00,969 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9049, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:08:00,970 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5932.3871, eval_time 0.6929, test_loss 3.9049, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:08:01,17 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:08:01,33 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:01,49 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:08:01,56 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3347, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:17:08:01,57 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5932.4763, eval_time 0.7795, test_loss 4.3347, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:17:08:01,62 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:01,148 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:08:01,168 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:02,164 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:02,178 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:03,11 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:03,31 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:03,402 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:03,417 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:04,959 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:04,977 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:06,47 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:06,81 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:06,207 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:06,228 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:06,265 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:06,277 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:07,85 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:07,112 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:07,706 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:07,722 INFO     [learner.py:606] ====Pushing takes 0.015040159225463867 s
2021-08-18:17:08:07,746 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:07,754 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:07,755 INFO     [param_server.py:410] Lock worker 1 with localStep 468 , while globalStep is 467

2021-08-18:17:08:08,69 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:08,82 INFO     [learner.py:606] ====Pushing takes 0.010818958282470703 s
2021-08-18:17:08:08,94 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:08,98 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:08,98 INFO     [param_server.py:410] Lock worker 2 with localStep 468 , while globalStep is 467

2021-08-18:17:08:08,105 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:08,114 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:09,551 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:09,575 INFO     [learner.py:606] ====Pushing takes 0.01959681510925293 s
2021-08-18:17:08:09,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:09,606 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:09,606 INFO     [param_server.py:381] ====After aggregation in epoch: 467, virtual_clock: 23854.948803056115, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.962169894465694, test len: 3099.0
2021-08-18:17:08:09,609 INFO     [param_server.py:410] Lock worker 3 with localStep 468 , while globalStep is 468

2021-08-18:17:08:09,609 INFO     [param_server.py:441] ====Epoch 469 completes 12 clients with loss 4.688716410571315, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:09,609 INFO     [param_server.py:450] ====Start to sample for epoch 469, global virtualClock: 23854.948803056115, round_duration: 83.5973351615153
2021-08-18:17:08:09,610 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:09,955 INFO     [param_server.py:553] For epoch: 469, median_reward: 420.09996377102044, dev: 840.1999275420409
2021-08-18:17:08:10,629 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3967, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:08:10,629 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 5.3872, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:08:10,630 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5942.0468, eval_time 0.6293, test_loss 4.3967, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:08:10,630 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5942.044, eval_time 0.6293, test_loss 5.3872, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:08:10,699 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:08:10,700 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.7671, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:08:10,701 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5942.1206, eval_time 0.7011, test_loss 4.7671, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:08:10,707 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:08:10,710 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:10,717 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:10,780 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:08:10,804 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:11,855 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:11,864 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:12,839 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:12,860 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:13,157 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:13,168 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:14,768 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:14,780 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:15,562 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:15,596 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:15,771 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:15,785 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:16,73 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:16,92 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:16,552 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:16,585 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:17,151 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:17,167 INFO     [learner.py:606] ====Pushing takes 0.01458120346069336 s
2021-08-18:17:08:17,191 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:17,197 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:17,198 INFO     [param_server.py:410] Lock worker 1 with localStep 469 , while globalStep is 468

2021-08-18:17:08:17,559 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:17,571 INFO     [learner.py:606] ====Pushing takes 0.010723352432250977 s
2021-08-18:17:08:17,585 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:17,589 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:17,589 INFO     [param_server.py:410] Lock worker 2 with localStep 469 , while globalStep is 468

2021-08-18:17:08:17,733 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:17,751 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:18,758 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:18,808 INFO     [learner.py:606] ====Pushing takes 0.020084619522094727 s
2021-08-18:17:08:18,833 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:18,839 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:18,840 INFO     [param_server.py:381] ====After aggregation in epoch: 468, virtual_clock: 23938.54613821763, top_1: : 63.827 % (1978.0), top_5: : 100.0 % (3099.0), test loss: 4.850322599764223, test len: 3099.0
2021-08-18:17:08:18,842 INFO     [param_server.py:410] Lock worker 3 with localStep 469 , while globalStep is 469

2021-08-18:17:08:18,842 INFO     [param_server.py:441] ====Epoch 470 completes 12 clients with loss 4.896766268712379, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:18,842 INFO     [param_server.py:450] ====Start to sample for epoch 470, global virtualClock: 23938.54613821763, round_duration: 83.5973351615153
2021-08-18:17:08:18,844 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:19,190 INFO     [param_server.py:553] For epoch: 470, median_reward: 404.4174233151975, dev: 808.834846630395
2021-08-18:17:08:19,805 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6426, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:17:08:19,806 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5951.2197, eval_time 0.5903, test_loss 3.6426, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:17:08:19,803 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8793, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:17:08:19,806 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5951.2233, eval_time 0.591, test_loss 3.8793, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:17:08:19,861 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1105, Top-1 Accuracy: 723.0/1033 (0.6999), Top-5 Accuracy: 1.0
2021-08-18:17:08:19,861 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5951.2811, eval_time 0.6485, test_loss 4.1105, test_accuracy 0.6999, test_5_accuracy 1.0 

2021-08-18:17:08:19,877 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:08:19,885 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:19,893 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:08:19,902 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:19,934 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:08:19,957 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:21,12 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:21,21 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:21,848 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:21,882 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:22,175 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:22,185 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:23,761 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:23,773 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:24,637 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:24,663 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:25,98 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:25,110 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:25,226 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:25,239 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:25,609 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:25,636 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:26,242 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:26,257 INFO     [learner.py:606] ====Pushing takes 0.013812780380249023 s
2021-08-18:17:08:26,277 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:26,285 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:26,285 INFO     [param_server.py:410] Lock worker 1 with localStep 470 , while globalStep is 469

2021-08-18:17:08:26,799 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:26,813 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:27,4 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:27,32 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:27,16 INFO     [learner.py:606] ====Pushing takes 0.010218143463134766 s
2021-08-18:17:08:27,36 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:27,37 INFO     [param_server.py:410] Lock worker 2 with localStep 470 , while globalStep is 469

2021-08-18:17:08:28,143 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:28,165 INFO     [learner.py:606] ====Pushing takes 0.02031683921813965 s
2021-08-18:17:08:28,193 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:28,199 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:28,199 INFO     [param_server.py:381] ====After aggregation in epoch: 469, virtual_clock: 24022.143473379143, top_1: : 67.1184 % (2080.0), top_5: : 100.0 % (3099.0), test loss: 3.877446201112535, test len: 3099.0
2021-08-18:17:08:28,202 INFO     [param_server.py:410] Lock worker 3 with localStep 470 , while globalStep is 470

2021-08-18:17:08:28,202 INFO     [param_server.py:441] ====Epoch 471 completes 12 clients with loss 3.8631870823786008, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:28,202 INFO     [param_server.py:450] ====Start to sample for epoch 471, global virtualClock: 24022.143473379143, round_duration: 83.5973351615153
2021-08-18:17:08:28,203 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:28,538 INFO     [param_server.py:553] For epoch: 471, median_reward: 414.74060554374114, dev: 829.4812110874823
2021-08-18:17:08:29,232 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8431, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:08:29,234 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5960.6478, eval_time 0.6371, test_loss 3.8431, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:08:29,247 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1446, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:17:08:29,248 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5960.6654, eval_time 0.6529, test_loss 4.1446, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:17:08:29,299 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3662, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:08:29,301 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5960.7202, eval_time 0.7065, test_loss 4.3662, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:08:29,318 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:08:29,319 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:08:29,325 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:29,327 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:29,369 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:08:29,391 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:30,379 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:30,388 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:31,453 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:31,473 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:31,624 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:31,634 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:33,203 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:33,218 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:34,358 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:34,392 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:34,523 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:34,543 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:34,580 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:34,598 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:35,300 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:35,327 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:35,986 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:36,5 INFO     [learner.py:606] ====Pushing takes 0.014993906021118164 s
2021-08-18:17:08:36,27 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:36,32 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:36,32 INFO     [param_server.py:410] Lock worker 1 with localStep 471 , while globalStep is 470

2021-08-18:17:08:36,360 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:36,369 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:36,383 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:36,399 INFO     [learner.py:606] ====Pushing takes 0.011532068252563477 s
2021-08-18:17:08:36,411 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:36,415 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:36,415 INFO     [param_server.py:410] Lock worker 2 with localStep 471 , while globalStep is 470

2021-08-18:17:08:37,618 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:37,640 INFO     [learner.py:606] ====Pushing takes 0.020150184631347656 s
2021-08-18:17:08:37,668 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:37,674 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:37,675 INFO     [param_server.py:381] ====After aggregation in epoch: 470, virtual_clock: 24105.740808540657, top_1: : 63.4398 % (1966.0), top_5: : 100.0 % (3099.0), test loss: 4.117976996633741, test len: 3099.0
2021-08-18:17:08:37,677 INFO     [param_server.py:410] Lock worker 3 with localStep 471 , while globalStep is 471

2021-08-18:17:08:37,678 INFO     [param_server.py:441] ====Epoch 472 completes 12 clients with loss 5.053986341047443, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:37,678 INFO     [param_server.py:450] ====Start to sample for epoch 472, global virtualClock: 24105.740808540657, round_duration: 83.5973351615153
2021-08-18:17:08:37,679 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:37,961 INFO     [param_server.py:553] For epoch: 472, median_reward: 400.7062730631147, dev: 801.4125461262294
2021-08-18:17:08:38,685 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.9322, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:08:38,685 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5970.1025, eval_time 0.6618, test_loss 4.9322, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:08:38,689 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8544, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:08:38,690 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5970.1044, eval_time 0.6649, test_loss 3.8544, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:08:38,760 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:08:38,769 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:38,782 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:08:38,796 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:38,808 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1792, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:17:08:38,809 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5970.2285, eval_time 0.7855, test_loss 4.1792, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:17:08:38,879 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:08:38,901 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:40,157 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:40,166 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:41,23 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:41,26 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:41,38 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:41,44 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:42,827 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:42,841 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:43,904 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:43,938 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:44,22 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:44,40 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:44,174 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:44,187 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:44,882 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:44,916 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:45,555 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:45,569 INFO     [learner.py:606] ====Pushing takes 0.01303410530090332 s
2021-08-18:17:08:45,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:45,607 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:45,608 INFO     [param_server.py:410] Lock worker 1 with localStep 472 , while globalStep is 471

2021-08-18:17:08:45,959 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:45,960 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:45,970 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:45,973 INFO     [learner.py:606] ====Pushing takes 0.012474298477172852 s
2021-08-18:17:08:45,991 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:45,994 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:45,995 INFO     [param_server.py:410] Lock worker 2 with localStep 472 , while globalStep is 471

2021-08-18:17:08:46,932 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:46,951 INFO     [learner.py:606] ====Pushing takes 0.018747568130493164 s
2021-08-18:17:08:46,982 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:46,988 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:46,989 INFO     [param_server.py:381] ====After aggregation in epoch: 471, virtual_clock: 24189.33814370217, top_1: : 64.6015 % (2002.0), top_5: : 100.0 % (3099.0), test loss: 4.321930417308102, test len: 3099.0
2021-08-18:17:08:46,991 INFO     [param_server.py:410] Lock worker 3 with localStep 472 , while globalStep is 472

2021-08-18:17:08:46,991 INFO     [param_server.py:441] ====Epoch 473 completes 12 clients with loss 3.7082463548932796, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:46,991 INFO     [param_server.py:450] ====Start to sample for epoch 473, global virtualClock: 24189.33814370217, round_duration: 83.5973351615153
2021-08-18:17:08:46,992 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:47,321 INFO     [param_server.py:553] For epoch: 473, median_reward: 386.8703711513783, dev: 773.7407423027566
2021-08-18:17:08:48,1 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5584, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:08:48,3 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5979.4167, eval_time 0.6357, test_loss 3.5584, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:08:48,31 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1201, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:08:48,33 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5979.4498, eval_time 0.666, test_loss 4.1201, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:08:48,67 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.98, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:17:08:48,68 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5979.4873, eval_time 0.701, test_loss 3.98, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:17:08:48,81 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:48,89 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:48,110 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:48,126 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:48,127 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:48,148 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:49,407 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:49,416 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:50,304 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:50,332 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:50,481 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:50,494 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:52,285 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:52,294 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:53,54 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:53,82 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:53,208 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:53,219 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:53,556 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:53,571 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:53,999 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:54,33 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:54,672 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:54,688 INFO     [learner.py:606] ====Pushing takes 0.014314889907836914 s
2021-08-18:17:08:54,710 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:54,716 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:54,716 INFO     [param_server.py:410] Lock worker 1 with localStep 473 , while globalStep is 472

2021-08-18:17:08:55,270 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:55,285 INFO     [learner.py:606] ====Pushing takes 0.011114120483398438 s
2021-08-18:17:08:55,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:55,301 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:55,302 INFO     [param_server.py:410] Lock worker 2 with localStep 473 , while globalStep is 472

2021-08-18:17:08:55,324 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:55,333 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:56,409 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:56,429 INFO     [learner.py:606] ====Pushing takes 0.019049644470214844 s
2021-08-18:17:08:56,457 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:56,463 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:56,464 INFO     [param_server.py:381] ====After aggregation in epoch: 472, virtual_clock: 24272.935478863685, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 3.8861458654756897, test len: 3099.0
2021-08-18:17:08:56,467 INFO     [param_server.py:410] Lock worker 3 with localStep 473 , while globalStep is 473

2021-08-18:17:08:56,467 INFO     [param_server.py:441] ====Epoch 474 completes 12 clients with loss 4.661944867554542, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:56,467 INFO     [param_server.py:450] ====Start to sample for epoch 474, global virtualClock: 24272.935478863685, round_duration: 83.5973351615153
2021-08-18:17:08:56,468 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:56,764 INFO     [param_server.py:553] For epoch: 474, median_reward: 396.41118228262826, dev: 792.8223645652565
2021-08-18:17:08:57,565 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2178, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:17:08:57,566 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5988.9798, eval_time 0.7452, test_loss 4.2178, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:17:08:57,568 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8336, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:17:08:57,569 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5988.9864, eval_time 0.7489, test_loss 3.8336, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:17:08:57,596 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.0136, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:08:57,597 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5989.0165, eval_time 0.7773, test_loss 5.0136, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:08:57,634 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:08:57,642 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:08:57,644 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:57,650 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:57,667 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:08:57,680 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:58,736 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:58,747 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:59,655 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:59,683 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:59,967 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:59,984 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:01,553 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:01,568 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:02,514 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:02,548 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:02,945 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:02,965 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:02,982 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:02,996 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:03,417 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:03,444 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:04,61 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:04,77 INFO     [learner.py:606] ====Pushing takes 0.014948606491088867 s
2021-08-18:17:09:04,99 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:04,107 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:04,107 INFO     [param_server.py:410] Lock worker 1 with localStep 474 , while globalStep is 473

2021-08-18:17:09:04,675 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:04,687 INFO     [learner.py:606] ====Pushing takes 0.011050224304199219 s
2021-08-18:17:09:04,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:04,705 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:04,707 INFO     [param_server.py:410] Lock worker 2 with localStep 474 , while globalStep is 473

2021-08-18:17:09:04,746 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:04,765 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:05,833 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:05,853 INFO     [learner.py:606] ====Pushing takes 0.0187380313873291 s
2021-08-18:17:09:05,878 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:05,884 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:05,885 INFO     [param_server.py:381] ====After aggregation in epoch: 473, virtual_clock: 24356.5328140252, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 4.35501433301855, test len: 3099.0
2021-08-18:17:09:05,887 INFO     [param_server.py:410] Lock worker 3 with localStep 474 , while globalStep is 474

2021-08-18:17:09:05,887 INFO     [param_server.py:441] ====Epoch 475 completes 12 clients with loss 3.1998214677930132, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:05,888 INFO     [param_server.py:450] ====Start to sample for epoch 475, global virtualClock: 24356.5328140252, round_duration: 83.5973351615153
2021-08-18:17:09:05,888 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:06,164 INFO     [param_server.py:553] For epoch: 475, median_reward: 417.48771445077426, dev: 834.9754289015485
2021-08-18:17:09:07,51 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.6855, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:09:07,52 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5998.466, eval_time 0.8299, test_loss 4.6855, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:09:07,88 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9378, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:09:07,89 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5998.5064, eval_time 0.8691, test_loss 3.9378, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:09:07,121 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:09:07,132 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:07,166 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5328, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:17:09:07,166 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5998.5862, eval_time 0.9471, test_loss 4.5328, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:17:09:07,173 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:09:07,188 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:07,236 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:09:07,265 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:08,418 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:08,438 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:09,279 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:09,300 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:09,546 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:09,557 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:11,86 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:11,96 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:11,988 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:12,15 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:12,273 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:12,287 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:12,316 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:12,325 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:12,932 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:12,966 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:13,595 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:13,613 INFO     [learner.py:606] ====Pushing takes 0.01643204689025879 s
2021-08-18:17:09:13,638 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:13,643 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:13,644 INFO     [param_server.py:410] Lock worker 1 with localStep 475 , while globalStep is 474

2021-08-18:17:09:14,87 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:14,89 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:14,106 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:14,107 INFO     [learner.py:606] ====Pushing takes 0.011746406555175781 s
2021-08-18:17:09:14,118 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:14,122 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:14,123 INFO     [param_server.py:410] Lock worker 2 with localStep 475 , while globalStep is 474

2021-08-18:17:09:15,524 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:15,545 INFO     [learner.py:606] ====Pushing takes 0.01979541778564453 s
2021-08-18:17:09:15,573 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:15,578 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:15,579 INFO     [param_server.py:381] ====After aggregation in epoch: 474, virtual_clock: 24440.130149186713, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 4.3853870497809515, test len: 3099.0
2021-08-18:17:09:15,581 INFO     [param_server.py:410] Lock worker 3 with localStep 475 , while globalStep is 475

2021-08-18:17:09:15,610 INFO     [param_server.py:441] ====Epoch 476 completes 12 clients with loss 4.60987876213004, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:15,610 INFO     [param_server.py:450] ====Start to sample for epoch 476, global virtualClock: 24440.130149186713, round_duration: 83.5973351615153
2021-08-18:17:09:15,611 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:15,901 INFO     [param_server.py:553] For epoch: 476, median_reward: 412.529554578676, dev: 825.059109157352
2021-08-18:17:09:16,535 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0092, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:09:16,536 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 6007.9504, eval_time 0.5873, test_loss 4.0092, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:09:16,541 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.4629, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:17:09:16,542 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 6007.9588, eval_time 0.594, test_loss 4.4629, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:17:09:16,605 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:09:16,611 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:09:16,614 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:16,626 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:16,660 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.6334, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:09:16,660 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 6008.08, eval_time 0.7146, test_loss 5.6334, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:09:16,729 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:09:16,751 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:17,787 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:17,801 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:18,967 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:18,980 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:18,989 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:19,16 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:20,777 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:20,787 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:21,786 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:21,807 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:21,836 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:21,845 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:22,19 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:22,28 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:22,720 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:22,754 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:23,474 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:23,493 INFO     [learner.py:606] ====Pushing takes 0.014806032180786133 s
2021-08-18:17:09:23,514 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:23,522 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:23,522 INFO     [param_server.py:410] Lock worker 1 with localStep 476 , while globalStep is 475

2021-08-18:17:09:23,611 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:23,624 INFO     [learner.py:606] ====Pushing takes 0.011870622634887695 s
2021-08-18:17:09:23,636 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:23,640 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:23,641 INFO     [param_server.py:410] Lock worker 2 with localStep 476 , while globalStep is 475

2021-08-18:17:09:23,759 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:23,778 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:24,895 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:24,915 INFO     [learner.py:606] ====Pushing takes 0.01924872398376465 s
2021-08-18:17:09:24,937 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:24,943 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:24,944 INFO     [param_server.py:381] ====After aggregation in epoch: 475, virtual_clock: 24523.727484348226, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 4.701824214723374, test len: 3099.0
2021-08-18:17:09:24,946 INFO     [param_server.py:410] Lock worker 3 with localStep 476 , while globalStep is 476

2021-08-18:17:09:24,946 INFO     [param_server.py:441] ====Epoch 477 completes 12 clients with loss 3.776731032152936, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:24,947 INFO     [param_server.py:450] ====Start to sample for epoch 477, global virtualClock: 24523.727484348226, round_duration: 83.5973351615153
2021-08-18:17:09:24,947 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:25,239 INFO     [param_server.py:553] For epoch: 477, median_reward: 404.7142260647965, dev: 809.428452129593
2021-08-18:17:09:26,18 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6596, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:09:26,19 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 6017.4333, eval_time 0.7165, test_loss 3.6596, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:09:26,35 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6448, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:09:26,36 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 6017.4534, eval_time 0.7361, test_loss 3.6448, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:09:26,76 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.8657, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:17:09:26,77 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 6017.4971, eval_time 0.7825, test_loss 4.8657, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:17:09:26,86 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:09:26,101 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:26,106 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:09:26,125 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:26,144 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:09:26,172 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:27,325 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:27,334 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:28,192 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:28,213 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:28,519 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:28,528 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:30,117 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:30,153 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:31,232 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:31,260 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:31,306 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:31,321 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:31,535 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:31,551 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:32,72 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:32,86 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:32,708 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:32,723 INFO     [learner.py:606] ====Pushing takes 0.013562202453613281 s
2021-08-18:17:09:32,740 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:32,745 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:32,745 INFO     [param_server.py:410] Lock worker 1 with localStep 477 , while globalStep is 476

2021-08-18:17:09:33,129 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:33,143 INFO     [learner.py:606] ====Pushing takes 0.011029481887817383 s
2021-08-18:17:09:33,154 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:33,158 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:33,158 INFO     [param_server.py:410] Lock worker 2 with localStep 477 , while globalStep is 476

2021-08-18:17:09:33,242 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:33,252 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:34,555 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:34,573 INFO     [learner.py:606] ====Pushing takes 0.01754450798034668 s
2021-08-18:17:09:34,594 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:34,599 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:34,600 INFO     [param_server.py:381] ====After aggregation in epoch: 476, virtual_clock: 24607.32481950974, top_1: : 66.0536 % (2047.0), top_5: : 100.0 % (3099.0), test loss: 4.056693434163376, test len: 3099.0
2021-08-18:17:09:34,602 INFO     [param_server.py:410] Lock worker 3 with localStep 477 , while globalStep is 477

2021-08-18:17:09:34,602 INFO     [param_server.py:441] ====Epoch 478 completes 12 clients with loss 3.781691421055409, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:34,603 INFO     [param_server.py:450] ====Start to sample for epoch 478, global virtualClock: 24607.32481950974, round_duration: 83.5973351615153
2021-08-18:17:09:34,603 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:34,891 INFO     [param_server.py:553] For epoch: 478, median_reward: 441.4557548232082, dev: 882.9115096464164
2021-08-18:17:09:35,530 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3556, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:09:35,530 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 6026.9446, eval_time 0.5832, test_loss 4.3556, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:09:35,534 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3016, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:17:09:35,535 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 6026.9517, eval_time 0.5875, test_loss 4.3016, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:17:09:35,600 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:09:35,612 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:09:35,623 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:35,631 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:35,646 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2931, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:17:09:35,649 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 6027.069, eval_time 0.7031, test_loss 4.2931, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:17:09:35,719 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:09:35,747 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:36,919 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:36,933 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:37,831 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:37,852 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:38,145 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:38,156 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:39,696 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:39,708 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:40,738 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:40,765 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:40,818 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:40,827 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:41,11 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:41,26 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:41,619 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:41,650 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:42,174 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:42,191 INFO     [learner.py:606] ====Pushing takes 0.015386581420898438 s
2021-08-18:17:09:42,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:42,220 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:42,220 INFO     [param_server.py:410] Lock worker 1 with localStep 478 , while globalStep is 477

2021-08-18:17:09:42,662 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:42,674 INFO     [learner.py:606] ====Pushing takes 0.010687589645385742 s
2021-08-18:17:09:42,686 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:42,689 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:42,690 INFO     [param_server.py:410] Lock worker 2 with localStep 478 , while globalStep is 477

2021-08-18:17:09:42,790 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:42,811 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:44,133 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:44,153 INFO     [learner.py:606] ====Pushing takes 0.018512964248657227 s
2021-08-18:17:09:44,177 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:44,183 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:44,184 INFO     [param_server.py:381] ====After aggregation in epoch: 477, virtual_clock: 24690.922154671254, top_1: : 62.6654 % (1942.0), top_5: : 100.0 % (3099.0), test loss: 4.3167722931614625, test len: 3099.0
2021-08-18:17:09:44,186 INFO     [param_server.py:410] Lock worker 3 with localStep 478 , while globalStep is 478

2021-08-18:17:09:44,187 INFO     [param_server.py:441] ====Epoch 479 completes 12 clients with loss 4.905981229185085, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:44,188 INFO     [param_server.py:450] ====Start to sample for epoch 479, global virtualClock: 24690.922154671254, round_duration: 83.5973351615153
2021-08-18:17:09:44,188 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:44,459 INFO     [param_server.py:553] For epoch: 479, median_reward: 422.315365511372, dev: 844.630731022744
2021-08-18:17:09:45,126 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 5.209, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:09:45,127 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6036.541, eval_time 0.6194, test_loss 5.209, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:09:45,167 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1913, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:17:09:45,168 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6036.5852, eval_time 0.6607, test_loss 4.1913, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:17:09:45,198 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:45,205 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:45,243 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2478, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:09:45,244 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6036.6637, eval_time 0.7408, test_loss 4.2478, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:09:45,255 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:45,269 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:45,316 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:45,343 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:46,293 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:46,302 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:47,448 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:47,458 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:47,512 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:47,536 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:49,331 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:49,345 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:50,190 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:50,195 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:50,209 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:50,211 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:50,674 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:50,685 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:50,947 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:50,974 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:51,761 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:51,777 INFO     [learner.py:606] ====Pushing takes 0.014770030975341797 s
2021-08-18:17:09:51,799 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:51,804 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:51,805 INFO     [param_server.py:410] Lock worker 1 with localStep 479 , while globalStep is 478

2021-08-18:17:09:51,889 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:51,901 INFO     [learner.py:606] ====Pushing takes 0.01069951057434082 s
2021-08-18:17:09:51,914 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:51,918 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:51,918 INFO     [param_server.py:410] Lock worker 2 with localStep 479 , while globalStep is 478

2021-08-18:17:09:52,453 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:52,472 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:53,630 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:53,653 INFO     [learner.py:606] ====Pushing takes 0.019555091857910156 s
2021-08-18:17:09:53,676 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:53,682 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:53,683 INFO     [param_server.py:381] ====After aggregation in epoch: 478, virtual_clock: 24774.519489832768, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 4.549344579378764, test len: 3099.0
2021-08-18:17:09:53,685 INFO     [param_server.py:410] Lock worker 3 with localStep 479 , while globalStep is 479

2021-08-18:17:09:53,686 INFO     [param_server.py:441] ====Epoch 480 completes 12 clients with loss 4.119347750219693, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:53,686 INFO     [param_server.py:450] ====Start to sample for epoch 480, global virtualClock: 24774.519489832768, round_duration: 83.5973351615153
2021-08-18:17:09:53,687 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:53,962 INFO     [param_server.py:553] For epoch: 480, median_reward: 421.2154255665501, dev: 842.4308511331002
2021-08-18:17:09:54,698 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9421, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:17:09:54,699 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6046.1163, eval_time 0.6818, test_loss 3.9421, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:17:09:54,716 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7587, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:09:54,717 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6046.1313, eval_time 0.6979, test_loss 3.7587, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:09:54,769 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:09:54,785 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:09:54,788 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1001, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:09:54,791 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6046.2111, eval_time 0.7742, test_loss 4.1001, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:09:54,795 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:54,807 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:54,861 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:09:54,884 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:56,62 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:56,71 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:56,854 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:56,876 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:57,205 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:57,215 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:58,721 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:58,740 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:59,894 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:59,921 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:00,67 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:00,77 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:00,238 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:00,256 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:00,702 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:00,723 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:01,331 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:01,346 INFO     [learner.py:606] ====Pushing takes 0.013664960861206055 s
2021-08-18:17:10:01,363 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:01,370 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:01,371 INFO     [param_server.py:410] Lock worker 1 with localStep 480 , while globalStep is 479

2021-08-18:17:10:01,822 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:01,835 INFO     [learner.py:606] ====Pushing takes 0.010812997817993164 s
2021-08-18:17:10:01,846 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:01,850 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:01,851 INFO     [param_server.py:410] Lock worker 2 with localStep 480 , while globalStep is 479

2021-08-18:17:10:01,992 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:02,1 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:03,73 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:03,95 INFO     [learner.py:606] ====Pushing takes 0.020056962966918945 s
2021-08-18:17:10:03,120 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:03,126 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:03,127 INFO     [param_server.py:381] ====After aggregation in epoch: 479, virtual_clock: 24858.116824994282, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 3.9336170819070606, test len: 3099.0
2021-08-18:17:10:03,130 INFO     [param_server.py:410] Lock worker 3 with localStep 480 , while globalStep is 480

2021-08-18:17:10:03,130 INFO     [param_server.py:441] ====Epoch 481 completes 12 clients with loss 4.485687650668444, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:03,131 INFO     [param_server.py:450] ====Start to sample for epoch 481, global virtualClock: 24858.116824994282, round_duration: 83.5973351615153
2021-08-18:17:10:03,133 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:03,444 INFO     [param_server.py:541] Handle Wight 0.027911901473999023 | Send 0.3121960163116455
2021-08-18:17:10:03,445 INFO     [param_server.py:553] For epoch: 481, median_reward: 420.8779327785232, dev: 841.7558655570464
2021-08-18:17:10:04,189 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9187, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:17:10:04,190 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6055.6037, eval_time 0.6865, test_loss 3.9187, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:17:10:04,221 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8598, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:10:04,221 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6055.6386, eval_time 0.7192, test_loss 3.8598, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:10:04,257 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:10:04,271 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:04,306 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:10:04,320 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:04,351 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2751, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:10:04,371 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6055.7909, eval_time 0.8722, test_loss 4.2751, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:10:04,440 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:10:04,473 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:05,662 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:05,676 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:06,582 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:06,596 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:06,626 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:06,635 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:08,300 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:08,315 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:09,200 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:09,227 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:09,239 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:09,252 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:09,699 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:09,711 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:10,211 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:10,245 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:10,914 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:10,929 INFO     [learner.py:606] ====Pushing takes 0.01364588737487793 s
2021-08-18:17:10:10,946 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:10,951 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:10,951 INFO     [param_server.py:410] Lock worker 1 with localStep 481 , while globalStep is 480

2021-08-18:17:10:11,213 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:11,224 INFO     [learner.py:606] ====Pushing takes 0.00943446159362793 s
2021-08-18:17:10:11,235 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:11,239 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:11,240 INFO     [param_server.py:410] Lock worker 2 with localStep 481 , while globalStep is 480

2021-08-18:17:10:11,588 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:11,602 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:13,9 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:13,31 INFO     [learner.py:606] ====Pushing takes 0.01967144012451172 s
2021-08-18:17:10:13,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:13,60 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:13,61 INFO     [param_server.py:381] ====After aggregation in epoch: 480, virtual_clock: 24941.714160155796, top_1: : 66.0858 % (2048.0), top_5: : 100.0 % (3099.0), test loss: 4.017849727913185, test len: 3099.0
2021-08-18:17:10:13,63 INFO     [param_server.py:410] Lock worker 3 with localStep 481 , while globalStep is 481

2021-08-18:17:10:13,64 INFO     [param_server.py:441] ====Epoch 482 completes 12 clients with loss 3.1815667358424284, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:13,64 INFO     [param_server.py:450] ====Start to sample for epoch 482, global virtualClock: 24941.714160155796, round_duration: 83.5973351615153
2021-08-18:17:10:13,65 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:13,393 INFO     [param_server.py:553] For epoch: 482, median_reward: 417.7656929993651, dev: 835.5313859987302
2021-08-18:17:10:14,175 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2758, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:10:14,176 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6065.5929, eval_time 0.7331, test_loss 4.2758, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:10:14,185 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7141, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:10:14,188 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6065.6021, eval_time 0.7431, test_loss 3.7141, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:10:14,256 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:10:14,257 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:10:14,266 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:14,266 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:14,284 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.92, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:17:10:14,288 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6065.7077, eval_time 0.8471, test_loss 3.92, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:17:10:14,359 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:10:14,388 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:15,308 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:15,318 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:16,385 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:16,394 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:16,568 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:16,595 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:18,104 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:18,115 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:19,17 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:19,28 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:19,270 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:19,297 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:19,442 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:19,455 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:20,362 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:20,396 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:20,749 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:20,761 INFO     [learner.py:606] ====Pushing takes 0.010405778884887695 s
2021-08-18:17:10:20,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:20,782 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:10:20,783 INFO     [param_server.py:410] Lock worker 2 with localStep 482 , while globalStep is 481

2021-08-18:17:10:21,49 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:21,66 INFO     [learner.py:606] ====Pushing takes 0.014822721481323242 s
2021-08-18:17:10:21,84 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:21,88 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:21,89 INFO     [param_server.py:410] Lock worker 1 with localStep 482 , while globalStep is 481

2021-08-18:17:10:21,347 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:21,361 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:22,592 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:22,613 INFO     [learner.py:606] ====Pushing takes 0.01991724967956543 s
2021-08-18:17:10:22,635 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:22,641 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:22,642 INFO     [param_server.py:381] ====After aggregation in epoch: 481, virtual_clock: 25025.31149531731, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 3.9699853923585677, test len: 3099.0
2021-08-18:17:10:22,644 INFO     [param_server.py:410] Lock worker 3 with localStep 482 , while globalStep is 482

2021-08-18:17:10:22,645 INFO     [param_server.py:441] ====Epoch 483 completes 12 clients with loss 3.326155331245443, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:22,645 INFO     [param_server.py:450] ====Start to sample for epoch 483, global virtualClock: 25025.31149531731, round_duration: 83.5973351615153
2021-08-18:17:10:22,646 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:22,928 INFO     [param_server.py:553] For epoch: 483, median_reward: 429.7154436911718, dev: 859.4308873823436
2021-08-18:17:10:23,639 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2604, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:10:23,643 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6075.0574, eval_time 0.6669, test_loss 4.2604, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:10:23,678 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.5721, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:17:10:23,679 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6075.096, eval_time 0.7041, test_loss 4.5721, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:17:10:23,714 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:10:23,717 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.5815, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:10:23,718 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6075.1376, eval_time 0.7451, test_loss 5.5815, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:10:23,733 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:23,751 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:10:23,778 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:23,788 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:10:23,807 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:24,808 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:24,818 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:25,846 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:25,874 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:26,55 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:26,65 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:27,670 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:27,682 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:28,836 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:28,857 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:28,996 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:29,9 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:29,25 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:29,39 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:29,751 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:29,778 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:30,360 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:30,376 INFO     [learner.py:606] ====Pushing takes 0.013903617858886719 s
2021-08-18:17:10:30,393 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:30,398 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:30,399 INFO     [param_server.py:410] Lock worker 1 with localStep 483 , while globalStep is 482

2021-08-18:17:10:30,771 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:30,771 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:30,780 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:30,784 INFO     [learner.py:606] ====Pushing takes 0.011386394500732422 s
2021-08-18:17:10:30,796 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:30,800 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:30,801 INFO     [param_server.py:410] Lock worker 2 with localStep 483 , while globalStep is 482

2021-08-18:17:10:32,7 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:32,27 INFO     [learner.py:606] ====Pushing takes 0.018052101135253906 s
2021-08-18:17:10:32,48 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:32,54 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:32,54 INFO     [param_server.py:381] ====After aggregation in epoch: 482, virtual_clock: 25108.908830478824, top_1: : 63.6012 % (1971.0), top_5: : 100.0 % (3099.0), test loss: 4.804646050488508, test len: 3099.0
2021-08-18:17:10:32,57 INFO     [param_server.py:410] Lock worker 3 with localStep 483 , while globalStep is 483

2021-08-18:17:10:32,57 INFO     [param_server.py:441] ====Epoch 484 completes 12 clients with loss 4.6943703799757595, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:32,57 INFO     [param_server.py:450] ====Start to sample for epoch 484, global virtualClock: 25108.908830478824, round_duration: 83.5973351615153
2021-08-18:17:10:32,58 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:32,352 INFO     [param_server.py:553] For epoch: 484, median_reward: 429.9770667286241, dev: 859.9541334572482
2021-08-18:17:10:33,64 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3159, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:17:10:33,65 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6084.479, eval_time 0.6517, test_loss 4.3159, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:17:10:33,102 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.768, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:10:33,103 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6084.5203, eval_time 0.6943, test_loss 3.768, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:10:33,134 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:10:33,144 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:33,169 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0086, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:17:10:33,172 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6084.5919, eval_time 0.7639, test_loss 4.0086, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:17:10:33,175 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:10:33,191 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:33,242 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:10:33,266 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:34,492 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:34,510 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:35,353 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:35,374 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:35,456 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:35,470 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:37,323 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:37,332 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:38,318 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:38,345 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:38,354 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:38,369 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:38,577 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:38,586 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:39,232 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:39,259 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:39,833 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:39,850 INFO     [learner.py:606] ====Pushing takes 0.015003681182861328 s
2021-08-18:17:10:39,870 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:39,878 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:39,879 INFO     [param_server.py:410] Lock worker 1 with localStep 484 , while globalStep is 483

2021-08-18:17:10:40,249 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:40,262 INFO     [learner.py:606] ====Pushing takes 0.010929584503173828 s
2021-08-18:17:10:40,273 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:40,278 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:40,278 INFO     [param_server.py:410] Lock worker 2 with localStep 484 , while globalStep is 483

2021-08-18:17:10:40,458 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:40,476 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:41,771 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:41,792 INFO     [learner.py:606] ====Pushing takes 0.019382953643798828 s
2021-08-18:17:10:41,818 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:41,824 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:41,825 INFO     [param_server.py:381] ====After aggregation in epoch: 483, virtual_clock: 25192.506165640338, top_1: : 66.7635 % (2069.0), top_5: : 100.0 % (3099.0), test loss: 4.030810908034996, test len: 3099.0
2021-08-18:17:10:41,827 INFO     [param_server.py:410] Lock worker 3 with localStep 484 , while globalStep is 484

2021-08-18:17:10:41,827 INFO     [param_server.py:441] ====Epoch 485 completes 12 clients with loss 4.622375068148639, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:41,828 INFO     [param_server.py:450] ====Start to sample for epoch 485, global virtualClock: 25192.506165640338, round_duration: 83.5973351615153
2021-08-18:17:10:41,828 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:42,108 INFO     [param_server.py:553] For epoch: 485, median_reward: 417.45815222860773, dev: 834.9163044572155
2021-08-18:17:10:42,713 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0152, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:10:42,714 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6094.1285, eval_time 0.5596, test_loss 4.0152, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:10:42,749 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0993, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:17:10:42,750 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6094.1671, eval_time 0.5955, test_loss 4.0993, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:17:10:42,783 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:42,797 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:42,823 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:42,834 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0412, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:10:42,836 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6094.2552, eval_time 0.6834, test_loss 4.0412, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:10:42,837 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:42,905 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:42,929 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:44,128 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:44,137 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:45,108 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:45,110 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:45,119 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:45,135 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:46,989 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:47,1 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:47,807 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:47,828 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:47,935 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:47,945 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:48,216 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:48,227 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:48,622 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:48,642 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:49,293 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:49,306 INFO     [learner.py:606] ====Pushing takes 0.012120962142944336 s
2021-08-18:17:10:49,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:49,329 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:49,330 INFO     [param_server.py:410] Lock worker 1 with localStep 485 , while globalStep is 484

2021-08-18:17:10:49,889 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:49,905 INFO     [learner.py:606] ====Pushing takes 0.01122593879699707 s
2021-08-18:17:10:49,917 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:49,921 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:49,921 INFO     [param_server.py:410] Lock worker 2 with localStep 485 , while globalStep is 484

2021-08-18:17:10:49,947 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:49,957 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:51,69 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:51,90 INFO     [learner.py:606] ====Pushing takes 0.019519567489624023 s
2021-08-18:17:10:51,113 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:51,119 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:51,120 INFO     [param_server.py:381] ====After aggregation in epoch: 484, virtual_clock: 25276.10350080185, top_1: : 63.5366 % (1969.0), top_5: : 100.0 % (3099.0), test loss: 4.051917262651302, test len: 3099.0
2021-08-18:17:10:51,122 INFO     [param_server.py:410] Lock worker 3 with localStep 485 , while globalStep is 485

2021-08-18:17:10:51,123 INFO     [param_server.py:441] ====Epoch 486 completes 12 clients with loss 6.705235742748345, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:51,123 INFO     [param_server.py:450] ====Start to sample for epoch 486, global virtualClock: 25276.10350080185, round_duration: 83.5973351615153
2021-08-18:17:10:51,123 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:51,401 INFO     [param_server.py:553] For epoch: 486, median_reward: 379.54291141860443, dev: 759.0858228372089
2021-08-18:17:10:52,106 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8441, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:10:52,107 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6103.5208, eval_time 0.6553, test_loss 3.8441, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:10:52,135 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8082, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:10:52,136 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6103.5532, eval_time 0.6871, test_loss 3.8082, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:10:52,174 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:10:52,180 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9262, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:17:10:52,181 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6103.6011, eval_time 0.7325, test_loss 3.9262, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:17:10:52,188 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:52,206 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:10:52,222 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:52,250 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:10:52,275 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:53,454 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:53,469 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:54,405 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:54,425 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:54,568 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:54,580 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:56,152 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:56,167 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:57,187 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:57,220 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:57,354 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:57,365 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:57,506 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:57,524 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:58,76 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:58,103 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:58,688 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:58,705 INFO     [learner.py:606] ====Pushing takes 0.015072107315063477 s
2021-08-18:17:10:58,722 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:58,730 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:58,731 INFO     [param_server.py:410] Lock worker 1 with localStep 486 , while globalStep is 485

2021-08-18:17:10:58,988 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:59,0 INFO     [learner.py:606] ====Pushing takes 0.009906291961669922 s
2021-08-18:17:10:59,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:59,17 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:59,17 INFO     [param_server.py:410] Lock worker 2 with localStep 486 , while globalStep is 485

2021-08-18:17:10:59,148 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:59,157 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:00,520 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:00,543 INFO     [learner.py:606] ====Pushing takes 0.02117300033569336 s
2021-08-18:17:11:00,571 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:00,578 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:00,578 INFO     [param_server.py:381] ====After aggregation in epoch: 485, virtual_clock: 25359.700835963366, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 3.859522766537136, test len: 3099.0
2021-08-18:17:11:00,581 INFO     [param_server.py:410] Lock worker 3 with localStep 486 , while globalStep is 486

2021-08-18:17:11:00,581 INFO     [param_server.py:441] ====Epoch 487 completes 12 clients with loss 4.0940606958291115, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:00,582 INFO     [param_server.py:450] ====Start to sample for epoch 487, global virtualClock: 25359.700835963366, round_duration: 83.5973351615153
2021-08-18:17:11:00,583 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:00,927 INFO     [param_server.py:553] For epoch: 487, median_reward: 409.64989689490693, dev: 819.2997937898139
2021-08-18:17:11:01,494 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3344, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:11:01,496 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6112.9103, eval_time 0.5198, test_loss 4.3344, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:11:01,541 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0358, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:11:01,542 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6112.9596, eval_time 0.5685, test_loss 4.0358, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:11:01,590 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:11:01,598 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:01,624 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9884, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:11:01,625 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6113.0444, eval_time 0.6525, test_loss 3.9884, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:11:01,639 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:11:01,654 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:01,697 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:11:01,722 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:02,743 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:02,763 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:03,811 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:03,838 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:04,32 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:04,44 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:05,716 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:05,728 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:06,423 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:06,444 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:06,788 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:06,797 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:06,907 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:06,916 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:07,272 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:07,293 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:08,73 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:08,89 INFO     [learner.py:606] ====Pushing takes 0.014463186264038086 s
2021-08-18:17:11:08,113 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:08,118 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:08,119 INFO     [param_server.py:410] Lock worker 1 with localStep 487 , while globalStep is 486

2021-08-18:17:11:08,569 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:08,588 INFO     [learner.py:606] ====Pushing takes 0.011459827423095703 s
2021-08-18:17:11:08,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:08,604 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:08,604 INFO     [param_server.py:410] Lock worker 2 with localStep 487 , while globalStep is 486

2021-08-18:17:11:08,775 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:08,790 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:09,956 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:09,977 INFO     [learner.py:606] ====Pushing takes 0.019896268844604492 s
2021-08-18:17:11:10,8 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:10,14 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:10,14 INFO     [param_server.py:381] ====After aggregation in epoch: 486, virtual_clock: 25443.29817112488, top_1: : 64.7951 % (2008.0), top_5: : 100.0 % (3099.0), test loss: 4.119548974213777, test len: 3099.0
2021-08-18:17:11:10,16 INFO     [param_server.py:410] Lock worker 3 with localStep 487 , while globalStep is 487

2021-08-18:17:11:10,17 INFO     [param_server.py:441] ====Epoch 488 completes 12 clients with loss 3.853361464940722, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:10,17 INFO     [param_server.py:450] ====Start to sample for epoch 488, global virtualClock: 25443.29817112488, round_duration: 83.5973351615153
2021-08-18:17:11:10,18 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:10,370 INFO     [param_server.py:553] For epoch: 488, median_reward: 401.1416873318686, dev: 802.2833746637372
2021-08-18:17:11:11,107 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.5323, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:11:11,109 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6122.5228, eval_time 0.6923, test_loss 4.5323, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:11:11,154 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0685, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:11:11,155 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6122.5724, eval_time 0.7417, test_loss 4.0685, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:11:11,165 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0697, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:11:11,185 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6122.6049, eval_time 0.7715, test_loss 4.0697, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:11:11,190 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:11:11,198 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:11,258 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:11:11,270 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:11:11,280 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:11,285 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:12,230 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:12,241 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:13,336 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:13,356 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:13,662 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:13,671 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:15,53 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:15,72 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:16,256 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:16,284 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:16,462 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:16,476 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:16,656 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:16,666 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:17,95 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:17,109 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:17,724 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:17,741 INFO     [learner.py:606] ====Pushing takes 0.014853954315185547 s
2021-08-18:17:11:17,766 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:17,773 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:17,774 INFO     [param_server.py:410] Lock worker 1 with localStep 488 , while globalStep is 487

2021-08-18:17:11:18,103 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:18,116 INFO     [learner.py:606] ====Pushing takes 0.011273860931396484 s
2021-08-18:17:11:18,127 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:18,131 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:18,132 INFO     [param_server.py:410] Lock worker 2 with localStep 488 , while globalStep is 487

2021-08-18:17:11:18,435 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:18,453 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:19,471 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:19,492 INFO     [learner.py:606] ====Pushing takes 0.019139528274536133 s
2021-08-18:17:11:19,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:19,528 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:19,529 INFO     [param_server.py:381] ====After aggregation in epoch: 487, virtual_clock: 25526.895506286393, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 4.2235126186300205, test len: 3099.0
2021-08-18:17:11:19,531 INFO     [param_server.py:410] Lock worker 3 with localStep 488 , while globalStep is 488

2021-08-18:17:11:19,532 INFO     [param_server.py:441] ====Epoch 489 completes 12 clients with loss 2.5873828759065223, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:19,532 INFO     [param_server.py:450] ====Start to sample for epoch 489, global virtualClock: 25526.895506286393, round_duration: 83.5973351615153
2021-08-18:17:11:19,533 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:19,881 INFO     [param_server.py:553] For epoch: 489, median_reward: 400.13993521359026, dev: 800.2798704271805
2021-08-18:17:11:20,495 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1661, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:11:20,497 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6131.9109, eval_time 0.5645, test_loss 4.1661, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:11:20,605 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:11:20,621 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:20,632 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3033, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:17:11:20,633 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6132.05, eval_time 0.7008, test_loss 4.3033, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:17:11:20,637 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.6799, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:11:20,638 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6132.0575, eval_time 0.7082, test_loss 4.6799, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:11:20,710 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:11:20,710 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:11:20,727 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:20,739 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:21,901 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:21,929 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:22,805 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:22,819 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:22,941 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:22,953 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:24,674 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:24,697 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:25,467 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:25,494 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:25,785 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:25,799 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:26,126 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:26,138 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:26,375 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:26,402 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:26,967 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:26,983 INFO     [learner.py:606] ====Pushing takes 0.014298200607299805 s
2021-08-18:17:11:27,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:27,12 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:27,28 INFO     [param_server.py:410] Lock worker 1 with localStep 489 , while globalStep is 488

2021-08-18:17:11:27,415 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:27,430 INFO     [learner.py:606] ====Pushing takes 0.013613224029541016 s
2021-08-18:17:11:27,442 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:27,446 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:27,447 INFO     [param_server.py:410] Lock worker 2 with localStep 489 , while globalStep is 488

2021-08-18:17:11:28,146 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:28,156 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:29,233 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:29,260 INFO     [learner.py:606] ====Pushing takes 0.02482461929321289 s
2021-08-18:17:11:29,284 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:29,290 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:29,290 INFO     [param_server.py:381] ====After aggregation in epoch: 488, virtual_clock: 25610.492841447907, top_1: : 63.2785 % (1961.0), top_5: : 100.0 % (3099.0), test loss: 4.383114231957329, test len: 3099.0
2021-08-18:17:11:29,293 INFO     [param_server.py:410] Lock worker 3 with localStep 489 , while globalStep is 489

2021-08-18:17:11:29,293 INFO     [param_server.py:441] ====Epoch 490 completes 12 clients with loss 4.383042145535931, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:29,293 INFO     [param_server.py:450] ====Start to sample for epoch 490, global virtualClock: 25610.492841447907, round_duration: 83.5973351615153
2021-08-18:17:11:29,294 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:29,649 INFO     [param_server.py:553] For epoch: 490, median_reward: 427.5214726214837, dev: 855.0429452429674
2021-08-18:17:11:30,504 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.5592, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:11:30,505 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6141.9222, eval_time 0.8005, test_loss 4.5592, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:11:30,514 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1111, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:11:30,515 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6141.9296, eval_time 0.81, test_loss 4.1111, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:11:30,576 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:11:30,590 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:30,592 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3792, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:11:30,593 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6142.0124, eval_time 0.8884, test_loss 4.3792, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:11:30,620 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:11:30,636 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:30,682 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:11:30,707 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:31,805 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:31,815 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:32,779 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:32,807 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:32,955 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:32,966 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:34,673 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:34,685 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:35,361 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:35,383 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:35,681 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:35,691 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:35,930 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:35,943 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:36,170 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:36,191 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:36,807 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:36,824 INFO     [learner.py:606] ====Pushing takes 0.015394210815429688 s
2021-08-18:17:11:36,847 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:36,855 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:36,855 INFO     [param_server.py:410] Lock worker 1 with localStep 490 , while globalStep is 489

2021-08-18:17:11:37,476 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:37,490 INFO     [learner.py:606] ====Pushing takes 0.011293172836303711 s
2021-08-18:17:11:37,508 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:37,512 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:37,512 INFO     [param_server.py:410] Lock worker 2 with localStep 490 , while globalStep is 489

2021-08-18:17:11:37,806 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:37,816 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:39,64 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:39,85 INFO     [learner.py:606] ====Pushing takes 0.018550395965576172 s
2021-08-18:17:11:39,111 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:39,117 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:39,117 INFO     [param_server.py:381] ====After aggregation in epoch: 489, virtual_clock: 25694.09017660942, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 4.349844749327059, test len: 3099.0
2021-08-18:17:11:39,120 INFO     [param_server.py:410] Lock worker 3 with localStep 490 , while globalStep is 490

2021-08-18:17:11:39,120 INFO     [param_server.py:441] ====Epoch 491 completes 12 clients with loss 5.019707175223126, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:39,121 INFO     [param_server.py:450] ====Start to sample for epoch 491, global virtualClock: 25694.09017660942, round_duration: 83.5973351615153
2021-08-18:17:11:39,121 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:39,478 INFO     [param_server.py:553] For epoch: 491, median_reward: 423.0988994517172, dev: 846.1977989034344
2021-08-18:17:11:40,172 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.18, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:11:40,173 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6151.5902, eval_time 0.659, test_loss 4.18, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:11:40,184 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6043, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:11:40,186 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6151.5998, eval_time 0.6715, test_loss 3.6043, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:11:40,208 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1848, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:11:40,209 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6151.6291, eval_time 0.6968, test_loss 4.1848, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:11:40,239 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:40,257 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:40,269 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:40,277 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:40,281 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:40,298 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:41,278 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:41,288 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:42,243 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:42,271 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:42,553 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:42,564 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:44,316 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:44,338 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:44,994 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:45,13 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:45,368 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:45,381 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:45,617 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:45,628 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:45,897 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:45,911 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:46,429 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:46,448 INFO     [learner.py:606] ====Pushing takes 0.015720844268798828 s
2021-08-18:17:11:46,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:46,475 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:46,475 INFO     [param_server.py:410] Lock worker 1 with localStep 491 , while globalStep is 490

2021-08-18:17:11:47,36 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:47,48 INFO     [learner.py:606] ====Pushing takes 0.010970354080200195 s
2021-08-18:17:11:47,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:47,64 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:47,65 INFO     [param_server.py:410] Lock worker 2 with localStep 491 , while globalStep is 490

2021-08-18:17:11:47,593 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:47,607 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:48,873 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:48,894 INFO     [learner.py:606] ====Pushing takes 0.01992201805114746 s
2021-08-18:17:11:48,922 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:48,928 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:48,928 INFO     [param_server.py:381] ====After aggregation in epoch: 490, virtual_clock: 25777.687511770935, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 3.989693937478242, test len: 3099.0
2021-08-18:17:11:48,931 INFO     [param_server.py:410] Lock worker 3 with localStep 491 , while globalStep is 491

2021-08-18:17:11:48,931 INFO     [param_server.py:441] ====Epoch 492 completes 12 clients with loss 2.6997535362009772, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:48,932 INFO     [param_server.py:450] ====Start to sample for epoch 492, global virtualClock: 25777.687511770935, round_duration: 83.5973351615153
2021-08-18:17:11:48,933 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:49,215 INFO     [param_server.py:553] For epoch: 492, median_reward: 426.78713828034506, dev: 853.5742765606901
2021-08-18:17:11:50,55 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.5708, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:17:11:50,56 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6161.4755, eval_time 0.7846, test_loss 5.5708, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:17:11:50,61 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7879, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:11:50,62 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6161.4759, eval_time 0.7891, test_loss 3.7879, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:11:50,67 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.9281, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:11:50,68 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6161.4847, eval_time 0.7953, test_loss 4.9281, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:11:50,127 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:11:50,130 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:11:50,139 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:50,148 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:11:50,148 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:50,162 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:51,146 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:51,155 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:52,16 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:52,31 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:52,455 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:52,465 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:53,970 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:53,997 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:54,985 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:55,5 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:55,331 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:55,390 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:55,628 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:55,640 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:55,776 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:55,791 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:56,439 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:56,456 INFO     [learner.py:606] ====Pushing takes 0.015467405319213867 s
2021-08-18:17:11:56,475 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:56,482 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:56,482 INFO     [param_server.py:410] Lock worker 1 with localStep 492 , while globalStep is 491

2021-08-18:17:11:57,75 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:57,88 INFO     [learner.py:606] ====Pushing takes 0.01088714599609375 s
2021-08-18:17:11:57,99 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:57,103 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:57,105 INFO     [param_server.py:410] Lock worker 2 with localStep 492 , while globalStep is 491

2021-08-18:17:11:57,288 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:57,299 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:58,420 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:58,439 INFO     [learner.py:606] ====Pushing takes 0.0177915096282959 s
2021-08-18:17:11:58,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:58,471 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:58,471 INFO     [param_server.py:381] ====After aggregation in epoch: 491, virtual_clock: 25861.28484693245, top_1: : 64.666 % (2004.0), top_5: : 100.0 % (3099.0), test loss: 4.762260973453522, test len: 3099.0
2021-08-18:17:11:58,474 INFO     [param_server.py:410] Lock worker 3 with localStep 492 , while globalStep is 492

2021-08-18:17:11:58,475 INFO     [param_server.py:441] ====Epoch 493 completes 12 clients with loss 4.67725527656724, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:58,475 INFO     [param_server.py:450] ====Start to sample for epoch 493, global virtualClock: 25861.28484693245, round_duration: 83.5973351615153
2021-08-18:17:11:58,476 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:58,821 INFO     [param_server.py:553] For epoch: 493, median_reward: 411.8237791056544, dev: 823.6475582113088
2021-08-18:17:11:59,558 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 5.0293, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:11:59,559 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6170.9728, eval_time 0.664, test_loss 5.0293, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:11:59,579 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.2101, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:17:11:59,580 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6170.9967, eval_time 0.688, test_loss 5.2101, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:17:11:59,627 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:11:59,647 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:11:59,651 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:59,665 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:59,687 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5454, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:17:11:59,688 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6171.1077, eval_time 0.801, test_loss 4.5454, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:17:11:59,756 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:11:59,798 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:01,59 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:01,69 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:01,751 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:01,764 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:01,998 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:02,9 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:03,648 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:03,662 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:04,454 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:04,488 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:04,769 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:04,783 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:05,208 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:05,229 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:05,375 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:05,403 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:06,101 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:06,118 INFO     [learner.py:606] ====Pushing takes 0.014961957931518555 s
2021-08-18:17:12:06,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:06,146 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:06,147 INFO     [param_server.py:410] Lock worker 1 with localStep 493 , while globalStep is 492

2021-08-18:17:12:06,640 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:06,652 INFO     [learner.py:606] ====Pushing takes 0.011093854904174805 s
2021-08-18:17:12:06,664 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:06,668 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:06,669 INFO     [param_server.py:410] Lock worker 2 with localStep 493 , while globalStep is 492

2021-08-18:17:12:07,0 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:07,9 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:08,263 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:08,284 INFO     [learner.py:606] ====Pushing takes 0.01883101463317871 s
2021-08-18:17:12:08,310 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:08,317 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:08,317 INFO     [param_server.py:381] ====After aggregation in epoch: 492, virtual_clock: 25944.882182093963, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 4.928267425960965, test len: 3099.0
2021-08-18:17:12:08,320 INFO     [param_server.py:410] Lock worker 3 with localStep 493 , while globalStep is 493

2021-08-18:17:12:08,321 INFO     [param_server.py:441] ====Epoch 494 completes 12 clients with loss 5.553981660129235, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:08,321 INFO     [param_server.py:450] ====Start to sample for epoch 494, global virtualClock: 25944.882182093963, round_duration: 83.5973351615153
2021-08-18:17:12:08,322 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:08,674 INFO     [param_server.py:553] For epoch: 494, median_reward: 444.716695557584, dev: 889.433391115168
2021-08-18:17:12:09,327 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3359, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:12:09,328 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6180.7422, eval_time 0.5933, test_loss 4.3359, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:12:09,358 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.6941, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:12:09,359 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6180.7766, eval_time 0.6255, test_loss 4.6941, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:12:09,409 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:12:09,421 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:09,430 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:12:09,439 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.587, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:17:12:09,440 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6180.8602, eval_time 0.7106, test_loss 5.587, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:17:12:09,449 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:09,531 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:12:09,561 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:10,716 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:10,737 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:11,743 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:11,763 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:11,835 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:11,849 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:13,683 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:13,693 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:14,320 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:14,341 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:14,564 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:14,574 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:15,107 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:15,128 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:15,161 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:15,171 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:15,710 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:15,726 INFO     [learner.py:606] ====Pushing takes 0.014895915985107422 s
2021-08-18:17:12:15,745 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:15,753 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:15,753 INFO     [param_server.py:410] Lock worker 1 with localStep 494 , while globalStep is 493

2021-08-18:17:12:16,246 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:16,258 INFO     [learner.py:606] ====Pushing takes 0.010777711868286133 s
2021-08-18:17:12:16,271 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:16,274 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:16,275 INFO     [param_server.py:410] Lock worker 2 with localStep 494 , while globalStep is 493

2021-08-18:17:12:17,210 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:17,225 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:18,408 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:18,432 INFO     [learner.py:606] ====Pushing takes 0.017560243606567383 s
2021-08-18:17:12:18,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:18,460 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:18,461 INFO     [param_server.py:381] ====After aggregation in epoch: 493, virtual_clock: 26028.479517255477, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 4.872319804297553, test len: 3099.0
2021-08-18:17:12:18,463 INFO     [param_server.py:410] Lock worker 3 with localStep 494 , while globalStep is 494

2021-08-18:17:12:18,463 INFO     [param_server.py:441] ====Epoch 495 completes 12 clients with loss 4.750463826136108, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:18,464 INFO     [param_server.py:450] ====Start to sample for epoch 495, global virtualClock: 26028.479517255477, round_duration: 83.5973351615153
2021-08-18:17:12:18,465 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:18,809 INFO     [param_server.py:553] For epoch: 495, median_reward: 372.9358592062135, dev: 745.871718412427
2021-08-18:17:12:19,458 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8401, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:12:19,460 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6190.8737, eval_time 0.5889, test_loss 3.8401, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:12:19,502 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0064, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:17:12:19,503 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6190.92, eval_time 0.6334, test_loss 4.0064, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:17:12:19,527 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:12:19,540 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:19,569 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1539, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:12:19,570 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6190.9901, eval_time 0.7058, test_loss 4.1539, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:12:19,571 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:12:19,590 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:19,655 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:12:19,685 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:20,827 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:20,836 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:21,649 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:21,677 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:21,870 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:21,879 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:23,755 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:23,765 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:24,458 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:24,479 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:24,731 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:24,746 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:25,141 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:25,160 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:25,235 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:25,255 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:25,840 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:25,855 INFO     [learner.py:606] ====Pushing takes 0.01347041130065918 s
2021-08-18:17:12:25,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:25,879 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:25,879 INFO     [param_server.py:410] Lock worker 1 with localStep 495 , while globalStep is 494

2021-08-18:17:12:26,543 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:26,556 INFO     [learner.py:606] ====Pushing takes 0.011289119720458984 s
2021-08-18:17:12:26,569 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:26,573 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:26,574 INFO     [param_server.py:410] Lock worker 2 with localStep 495 , while globalStep is 494

2021-08-18:17:12:27,29 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:27,48 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:28,374 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:28,395 INFO     [learner.py:606] ====Pushing takes 0.018734216690063477 s
2021-08-18:17:12:28,419 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:28,425 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:28,426 INFO     [param_server.py:381] ====After aggregation in epoch: 494, virtual_clock: 26112.07685241699, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 4.000135253976892, test len: 3099.0
2021-08-18:17:12:28,429 INFO     [param_server.py:410] Lock worker 3 with localStep 495 , while globalStep is 495

2021-08-18:17:12:28,429 INFO     [param_server.py:441] ====Epoch 496 completes 12 clients with loss 3.577221366698684, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:28,430 INFO     [param_server.py:450] ====Start to sample for epoch 496, global virtualClock: 26112.07685241699, round_duration: 83.5973351615153
2021-08-18:17:12:28,430 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:28,743 INFO     [param_server.py:553] For epoch: 496, median_reward: 419.14902587332136, dev: 838.2980517466427
2021-08-18:17:12:29,404 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.4681, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:12:29,405 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6200.8196, eval_time 0.599, test_loss 4.4681, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:12:29,446 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2487, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:12:29,447 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6200.864, eval_time 0.6437, test_loss 4.2487, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:12:29,475 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:12:29,496 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:29,516 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:12:29,536 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:29,566 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.4914, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:17:12:29,567 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6200.9868, eval_time 0.7684, test_loss 4.4914, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:17:12:29,634 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:12:29,666 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:30,669 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:30,683 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:31,602 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:31,622 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:31,654 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:31,665 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:33,419 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:33,442 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:34,476 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:34,504 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:34,566 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:34,585 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:35,16 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:35,30 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:35,232 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:35,253 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:35,931 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:35,947 INFO     [learner.py:606] ====Pushing takes 0.014696121215820312 s
2021-08-18:17:12:35,968 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:35,975 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:35,976 INFO     [param_server.py:410] Lock worker 1 with localStep 496 , while globalStep is 495

2021-08-18:17:12:36,246 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:36,258 INFO     [learner.py:606] ====Pushing takes 0.010290861129760742 s
2021-08-18:17:12:36,269 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:36,273 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:36,274 INFO     [param_server.py:410] Lock worker 2 with localStep 496 , while globalStep is 495

2021-08-18:17:12:36,712 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:36,724 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:37,845 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:37,865 INFO     [learner.py:606] ====Pushing takes 0.018327951431274414 s
2021-08-18:17:12:37,888 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:37,893 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:37,894 INFO     [param_server.py:381] ====After aggregation in epoch: 495, virtual_clock: 26195.674187578505, top_1: : 65.3114 % (2024.0), top_5: : 100.0 % (3099.0), test loss: 4.402718323248404, test len: 3099.0
2021-08-18:17:12:37,896 INFO     [param_server.py:410] Lock worker 3 with localStep 496 , while globalStep is 496

2021-08-18:17:12:37,897 INFO     [param_server.py:441] ====Epoch 497 completes 12 clients with loss 5.692662112425215, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:37,897 INFO     [param_server.py:450] ====Start to sample for epoch 497, global virtualClock: 26195.674187578505, round_duration: 83.5973351615153
2021-08-18:17:12:37,898 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:38,206 INFO     [param_server.py:553] For epoch: 497, median_reward: 429.10698651510654, dev: 858.2139730302131
2021-08-18:17:12:38,831 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.316, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:12:38,832 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.4601, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:12:38,832 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6210.2494, eval_time 0.5699, test_loss 4.316, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:12:38,833 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6210.2469, eval_time 0.5696, test_loss 4.4601, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:12:38,900 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:38,909 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:38,918 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:38,925 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:38,961 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.4814, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:12:38,962 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6210.3821, eval_time 0.7001, test_loss 5.4814, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:12:39,30 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:39,57 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:40,220 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:40,233 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:41,52 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:41,73 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:41,352 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:41,364 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:42,873 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:42,882 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:43,918 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:43,945 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:44,25 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:44,48 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:44,214 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:44,232 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:44,715 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:44,736 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:45,325 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:45,341 INFO     [learner.py:606] ====Pushing takes 0.014448404312133789 s
2021-08-18:17:12:45,363 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:45,368 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:45,369 INFO     [param_server.py:410] Lock worker 1 with localStep 497 , while globalStep is 496

2021-08-18:17:12:45,675 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:45,687 INFO     [learner.py:606] ====Pushing takes 0.010910987854003906 s
2021-08-18:17:12:45,699 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:45,702 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:45,703 INFO     [param_server.py:410] Lock worker 2 with localStep 497 , while globalStep is 496

2021-08-18:17:12:45,916 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:45,930 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:47,71 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:47,91 INFO     [learner.py:606] ====Pushing takes 0.019469022750854492 s
2021-08-18:17:12:47,115 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:47,121 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:47,122 INFO     [param_server.py:381] ====After aggregation in epoch: 496, virtual_clock: 26279.27152274002, top_1: : 64.0529 % (1985.0), top_5: : 100.0 % (3099.0), test loss: 4.752498149871826, test len: 3099.0
2021-08-18:17:12:47,124 INFO     [param_server.py:410] Lock worker 3 with localStep 497 , while globalStep is 497

2021-08-18:17:12:47,124 INFO     [param_server.py:441] ====Epoch 498 completes 12 clients with loss 5.047256836327526, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:47,125 INFO     [param_server.py:450] ====Start to sample for epoch 498, global virtualClock: 26279.27152274002, round_duration: 83.5973351615153
2021-08-18:17:12:47,125 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:47,408 INFO     [param_server.py:553] For epoch: 498, median_reward: 409.19903268198414, dev: 818.3980653639683
2021-08-18:17:12:48,30 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.4308, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:17:12:48,30 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6219.4445, eval_time 0.5869, test_loss 4.4308, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:17:12:48,75 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.7799, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:12:48,76 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6219.493, eval_time 0.6331, test_loss 4.7799, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:12:48,112 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:48,121 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:48,142 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:48,148 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2117, Top-1 Accuracy: 719.0/1033 (0.696), Top-5 Accuracy: 1.0
2021-08-18:17:12:48,149 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6219.5684, eval_time 0.7072, test_loss 4.2117, test_accuracy 0.696, test_5_accuracy 1.0 

2021-08-18:17:12:48,154 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:48,215 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:48,248 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:49,387 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:49,405 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:50,293 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:50,307 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:50,580 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:50,590 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:52,264 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:52,282 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:53,9 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:53,29 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:53,258 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:53,272 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:53,677 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:53,689 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:53,871 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:53,891 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:54,487 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:54,506 INFO     [learner.py:606] ====Pushing takes 0.017000913619995117 s
2021-08-18:17:12:54,526 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:54,535 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:54,536 INFO     [param_server.py:410] Lock worker 1 with localStep 498 , while globalStep is 497

2021-08-18:17:12:55,28 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:55,41 INFO     [learner.py:606] ====Pushing takes 0.010797500610351562 s
2021-08-18:17:12:55,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:55,59 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:55,60 INFO     [param_server.py:410] Lock worker 2 with localStep 498 , while globalStep is 497

2021-08-18:17:12:55,573 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:55,582 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:56,939 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:56,963 INFO     [learner.py:606] ====Pushing takes 0.02169013023376465 s
2021-08-18:17:12:56,985 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:56,990 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:56,991 INFO     [param_server.py:381] ====After aggregation in epoch: 497, virtual_clock: 26362.868857901532, top_1: : 66.9248 % (2074.0), top_5: : 100.0 % (3099.0), test loss: 4.4741247715773405, test len: 3099.0
2021-08-18:17:12:56,995 INFO     [param_server.py:410] Lock worker 3 with localStep 498 , while globalStep is 498

2021-08-18:17:12:56,995 INFO     [param_server.py:441] ====Epoch 499 completes 12 clients with loss 5.710834896332735, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:56,995 INFO     [param_server.py:450] ====Start to sample for epoch 499, global virtualClock: 26362.868857901532, round_duration: 83.5973351615153
2021-08-18:17:12:56,996 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:57,338 INFO     [param_server.py:553] For epoch: 499, median_reward: 447.99949661586624, dev: 895.9989932317325
2021-08-18:17:12:58,138 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.299, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:12:58,139 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6229.5533, eval_time 0.7449, test_loss 4.299, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:12:58,171 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.5658, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:17:12:58,172 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6229.5892, eval_time 0.7783, test_loss 4.5658, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:17:12:58,208 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3788, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:17:12:58,209 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6229.6283, eval_time 0.8157, test_loss 4.3788, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:17:12:58,231 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:12:58,241 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:12:58,244 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:58,264 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:58,285 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:12:58,314 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:59,248 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:59,262 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:13:00,426 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:13:00,447 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:13:00,680 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:13:00,699 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:13:02,53 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:13:02,66 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:13:03,169 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:13:03,189 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:13:03,409 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:13:03,428 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:13:03,636 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:13:03,649 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:13:04,4 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:13:04,25 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:13:04,585 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:13:04,601 INFO     [learner.py:606] ====Pushing takes 0.014491081237792969 s
2021-08-18:17:13:04,620 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:04,625 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:13:04,625 INFO     [param_server.py:410] Lock worker 1 with localStep 499 , while globalStep is 498

2021-08-18:17:13:05,229 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:13:05,247 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:13:05,497 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:13:05,509 INFO     [learner.py:606] ====Pushing takes 0.010605335235595703 s
2021-08-18:17:13:05,520 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:05,524 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:13:05,524 INFO     [param_server.py:410] Lock worker 2 with localStep 499 , while globalStep is 498

2021-08-18:17:13:06,477 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:13:06,509 INFO     [learner.py:606] ====Pushing takes 0.029361248016357422 s
2021-08-18:17:13:06,531 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:06,537 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:13:06,538 INFO     [param_server.py:381] ====After aggregation in epoch: 498, virtual_clock: 26446.466193063046, top_1: : 62.859 % (1948.0), top_5: : 100.0 % (3099.0), test loss: 4.414508336120182, test len: 3099.0
2021-08-18:17:13:06,540 INFO     [param_server.py:410] Lock worker 3 with localStep 499 , while globalStep is 499

2021-08-18:17:13:06,540 INFO     [param_server.py:441] ====Epoch 500 completes 12 clients with loss 5.18135022331484, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:13:06,540 INFO     [param_server.py:450] ====Start to sample for epoch 500, global virtualClock: 26446.466193063046, round_duration: 83.5973351615153
2021-08-18:17:13:06,541 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:13:06,822 INFO     [param_server.py:553] For epoch: 500, median_reward: 405.4406007534102, dev: 810.8812015068204
2021-08-18:17:13:06,982 INFO     [param_server.py:560] Epoch is done: 500
====Error: argument of type 'NoneType' is not iterable

2021-08-18:17:13:07,375 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 5.6333, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:13:07,376 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6238.7902, eval_time 0.4999, test_loss 5.6333, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:13:07,421 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9871, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:13:07,423 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6238.8401, eval_time 0.5497, test_loss 3.9871, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:13:07,469 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:13:07,478 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:13:07,504 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:13:07,517 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:13:10,311 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3232, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:17:13:10,315 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6241.7348, eval_time 3.4483, test_loss 4.3232, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:17:13:10,354 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:13:10,369 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:13:10,415 INFO     [learner.py:667] ====Dump model successfully
2021-08-18:17:13:10,458 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:13:10,482 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:13:13,606 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:13:13,615 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:13:15,822 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:13:15,856 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:13:19,864 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:13:19,875 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:13:21,108 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:13:21,119 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:13:22,380 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:13:22,399 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:13:23,828 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:13:23,841 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:13:23,947 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:13:23,960 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:13:25,381 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:13:25,389 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
2021-08-18:17:13:25,443 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:13:25,453 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
2021-08-18:17:13:25,787 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:13:25,798 INFO     [learner.py:165] Start to run client 105 on rank 3...
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
2021-08-18:17:13:28,498 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:13:28,517 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
