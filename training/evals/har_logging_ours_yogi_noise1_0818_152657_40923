2021-08-18:15:27:03,685 INFO     [param_server.py:13] End up with cuda device tensor([0.3190], device='cuda:0')
2021-08-18:15:27:04,91 INFO     [param_server.py:608] ====Start to initialize dataset
2021-08-18:15:27:04,93 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:27:34,817 INFO     [learner.py:14] End up with cuda device tensor([0.1649], device='cuda:2')
2021-08-18:15:27:34,821 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:27:35,231 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:27:35,232 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:27:36,50 INFO     [learner.py:14] End up with cuda device tensor([0.7031], device='cuda:3')
2021-08-18:15:27:36,52 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:27:36,458 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:27:36,458 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:27:36,570 INFO     [learner.py:14] End up with cuda device tensor([0.9777], device='cuda:1')
2021-08-18:15:27:36,573 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:27:36,979 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:27:36,979 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:28:54,522 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:28:54,526 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:28:54,526 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0003407001495361328 s

2021-08-18:15:28:54,527 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:28:54,628 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:28:54,631 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:28:54,631 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0004107952117919922 s

2021-08-18:15:28:54,631 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:28:54,840 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:28:54,843 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:28:54,844 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.000396728515625 s

2021-08-18:15:28:54,844 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:28:56,175 INFO     [param_server.py:91] ====Info of all feasible clients {'total_feasible_clients': 120, 'total_length': 30423}
2021-08-18:15:28:56,455 INFO     [param_server.py:189] ====PS: get in run()
2021-08-18:15:28:56,486 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:28:56,486 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:28:56,487 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:28:56,488 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:28:56,488 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0005712509155273438 s

2021-08-18:15:28:56,488 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.000640869140625 s

2021-08-18:15:28:56,489 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:28:56,489 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:28:56,489 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:28:56,489 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:28:56,489 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:28:56,490 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:28:56,492 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0018703937530517578 s

2021-08-18:15:28:56,492 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:28:56,492 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:28:56,493 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:28:56,494 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:28:56,495 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:28:56,495 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:28:56,495 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:28:56,495 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:28:56,499 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:28:56,499 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:28:56,500 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:28:56,509 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=2, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=3184, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=1.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='36528', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=2, threads=4, time_stamp='0818_152657_40923', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:28:56,510 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=3, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=3184, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=1.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='36528', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=3, threads=4, time_stamp='0818_152657_40923', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:28:56,521 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=1, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=3184, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=1.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='36528', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=1, threads=4, time_stamp='0818_152657_40923', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:28:56,530 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:28:56,531 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:28:56,533 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:28:56,540 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:28:56,540 INFO     [learner.py:165] Start to run client 2 on rank 2...
====Worker: init_myprocesses
Begin!
====Worker: init_myprocesses
Begin!
2021-08-18:15:28:56,547 INFO     [learner.py:165] Start to run client 1 on rank 1...
====Worker: init_myprocesses
Begin!
2021-08-18:15:28:57,41 INFO     [learner.py:439] Completed to run client 2
2021-08-18:15:28:57,46 INFO     [learner.py:606] ====Pushing takes 0.003351926803588867 s
2021-08-18:15:28:57,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:28:57,58 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.3333333333333333, now collected 1 clients
2021-08-18:15:28:57,58 INFO     [param_server.py:410] Lock worker 2 with localStep 1 , while globalStep is 0

2021-08-18:15:28:57,69 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:28:57,74 INFO     [learner.py:606] ====Pushing takes 0.0030164718627929688 s
2021-08-18:15:28:57,77 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:28:57,79 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.3333333333333333, now collected 2 clients
2021-08-18:15:28:57,80 INFO     [param_server.py:410] Lock worker 3 with localStep 1 , while globalStep is 0

2021-08-18:15:28:57,97 INFO     [learner.py:439] Completed to run client 1
2021-08-18:15:28:57,101 INFO     [learner.py:606] ====Pushing takes 0.0031266212463378906 s
2021-08-18:15:28:57,105 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:28:57,107 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.3333333333333333, now collected 3 clients
2021-08-18:15:28:57,108 INFO     [param_server.py:381] ====After aggregation in epoch: 0, virtual_clock: 0.0, top_1: : 0.0 % (0.0), top_5: : 0.0 % (0.0), test loss: 0.0, test len: 3.0
2021-08-18:15:28:57,109 INFO     [param_server.py:410] Lock worker 1 with localStep 1 , while globalStep is 1

2021-08-18:15:28:57,110 INFO     [param_server.py:441] ====Epoch 2 completes 3 clients with loss 49.30390782795176, sampled rewards are: 
 {1: 0, 2: 0, 3: 0} 
==========
2021-08-18:15:28:57,110 INFO     [param_server.py:450] ====Start to sample for epoch 2, global virtualClock: 0.0, round_duration: 0.0
2021-08-18:15:28:57,111 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 55, 6, 51, 84, 98, 37, 112, 118, 93, 11, 85, 27, 31, 57, 79, 119, 107, 70]
2021-08-18:15:28:57,419 INFO     [param_server.py:567] ====Error: argument of type 'NoneType' is not iterable, <class 'TypeError'>, param_server.py, 551
2021-08-18:15:28:57,997 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2447, Top-1 Accuracy: 257.0/1033 (0.2488), Top-5 Accuracy: 1.0
2021-08-18:15:28:57,998 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.497, eval_time 0.5457, test_loss 3.2447, test_accuracy 0.2488, test_5_accuracy 1.0 

2021-08-18:15:28:58,63 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:28:58,72 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2835, Top-1 Accuracy: 226.0/1033 (0.2188), Top-5 Accuracy: 1.0
2021-08-18:15:28:58,73 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.5732, eval_time 0.6193, test_loss 3.2835, test_accuracy 0.2188, test_5_accuracy 1.0 

2021-08-18:15:28:58,74 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2641, Top-1 Accuracy: 252.0/1033 (0.2439), Top-5 Accuracy: 1.0
2021-08-18:15:28:58,74 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.5747, eval_time 0.6211, test_loss 4.2641, test_accuracy 0.2439, test_5_accuracy 1.0 

2021-08-18:15:28:58,84 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:28:58,137 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:28:58,143 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:28:58,151 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:28:58,152 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:28:59,817 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:28:59,826 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:29:00,867 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:00,878 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:29:01,37 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:29:01,55 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:02,413 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:29:02,422 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:29:02,690 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:02,710 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:29:02,965 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:29:02,979 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:29:02,984 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:29:02,993 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:29:04,12 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:29:04,28 INFO     [learner.py:606] ====Pushing takes 0.015390634536743164 s
2021-08-18:15:29:04,65 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:04,70 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 4 clients
2021-08-18:15:29:04,71 INFO     [param_server.py:410] Lock worker 2 with localStep 2 , while globalStep is 1

2021-08-18:15:29:04,91 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:29:04,101 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:29:05,734 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:29:05,755 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:29:06,814 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:29:06,828 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:29:06,945 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:29:06,965 INFO     [learner.py:165] Start to run client 112 on rank 1...
2021-08-18:15:29:07,924 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:29:07,938 INFO     [learner.py:165] Start to run client 57 on rank 3...
2021-08-18:15:29:08,712 INFO     [learner.py:439] Completed to run client 112
2021-08-18:15:29:08,733 INFO     [learner.py:165] Start to run client 118 on rank 1...
2021-08-18:15:29:09,90 INFO     [learner.py:439] Completed to run client 57
2021-08-18:15:29:09,119 INFO     [learner.py:606] ====Pushing takes 0.027043819427490234 s
2021-08-18:15:29:09,156 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:09,163 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 10 clients
2021-08-18:15:29:09,163 INFO     [param_server.py:410] Lock worker 3 with localStep 2 , while globalStep is 1

2021-08-18:15:29:10,164 INFO     [learner.py:439] Completed to run client 118
2021-08-18:15:29:10,184 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:29:11,252 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:29:11,266 INFO     [learner.py:165] Start to run client 31 on rank 1...
2021-08-18:15:29:13,804 INFO     [learner.py:439] Completed to run client 31
2021-08-18:15:29:13,826 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:29:14,523 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:29:14,536 INFO     [learner.py:165] Start to run client 70 on rank 1...
2021-08-18:15:29:15,94 INFO     [learner.py:439] Completed to run client 70
2021-08-18:15:29:15,138 INFO     [learner.py:606] ====Pushing takes 0.04204678535461426 s
2021-08-18:15:29:15,200 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:15,212 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:15,213 INFO     [param_server.py:381] ====After aggregation in epoch: 1, virtual_clock: 57.1231349992849, top_1: : 23.7173 % (735.0), top_5: : 100.0 % (3099.0), test loss: 3.597442750577573, test len: 3099.0
2021-08-18:15:29:15,219 INFO     [param_server.py:410] Lock worker 1 with localStep 2 , while globalStep is 2

2021-08-18:15:29:15,220 INFO     [param_server.py:441] ====Epoch 3 completes 20 clients with loss 8.808181687438411, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 31: 0, 37: 0, 51: 0, 55: 0, 57: 0, 70: 0, 79: 0, 82: 0, 84: 0, 85: 0, 93: 0, 98: 0, 107: 0, 112: 0, 118: 0, 119: 0} 
==========
2021-08-18:15:29:15,220 INFO     [param_server.py:450] ====Start to sample for epoch 3, global virtualClock: 57.1231349992849, round_duration: 57.1231349992849
2021-08-18:15:29:15,222 INFO     [oort.py:208] Training selector: Pacer 1: lastExploitationUtil 0.0, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:29:15,223 INFO     [oort.py:321] scores are 3,{6: 0.22787096860831396, 7: 0.36972600222248947, 11: 0.073496029055852, 27: 0.08430493309894253, 31: 0.03042379113359514, 37: 0.09470212708865906, 51: 0.17219132346520408, 55: 0.4025403432549088, 57: 0.02293315913893373, 58: 0.003863689439053836, 59: 0.003998212369561641, 60: 0.0017241217318098093, 67: 0.0021102989751465738, 70: 0.0018288490022806117, 76: 0.0018647538586204705, 82: 0.9745170547459115, 84: 0.14452857338112826, 85: 0.058578591366641, 98: 0.15850797788204604, 104: 0.0035825909938209635, 107: 0.0086743160411214, 112: 0.1299531690476023, 118: 0.15079890798788959, 119: 0.028266813389633234},[82, 55, 7, 6, 51, 98, 118, 84, 112, 37, 27, 11, 85, 31, 119, 57, 107, 59, 58, 104, 67, 76, 70, 60]
2021-08-18:15:29:15,224 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:29:15,225 INFO     [oort.py:365] exploration poss is [211.         194.         127.31276875 102.62196006  93.54348818
  63.22281215  48.9297034   43.80212094  40.07746457  38.76346588
  35.52193436  20.51602366  19.67074705  17.89651406  17.81815999
  16.97776986  10.82015629  10.17914992   9.55281742   9.51833915
   9.20736151   4.08207853   3.2544298    2.43794015   2.21488525
   1.67907336   1.37027356   0.86146108   0.70455354]
2021-08-18:15:29:15,225 INFO     [oort.py:398] At round 1, UCB exploited 24, augment_factor 1.6666666666666667, exploreLen 23, un-explored 91, exploration 0.855, round_threshold 10, sampled score is [({'reward': 1104.3192063711986, 'duration': 6.342067858842259, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 83.08739610115947}, [0.9745170547459115, -0.0001500750375187595]), ({'reward': 551.7317542532899, 'duration': 8.010998429338052, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.493968292123032}, [0.4025403432549088, -0.0001500750375187595]), ({'reward': 553.5437047190242, 'duration': 11.90395711384456, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.28996491366406}, [0.4044158716709144, -0.0001500750375187595])]
2021-08-18:15:29:15,226 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [82, 16, 55, 53, 6, 83, 97, 81, 99, 38, 87, 110, 71, 5, 73, 65, 106, 49, 50, 105]
2021-08-18:15:29:15,553 INFO     [param_server.py:553] For epoch: 3, median_reward: 334.6579718956274, dev: 334.6579718956274
2021-08-18:15:29:16,212 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.5084, Top-1 Accuracy: 341.0/1033 (0.3301), Top-5 Accuracy: 1.0
2021-08-18:15:29:16,216 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 19.7163, eval_time 0.6394, test_loss 5.5084, test_accuracy 0.3301, test_5_accuracy 1.0 

2021-08-18:15:29:16,214 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 5.4795, Top-1 Accuracy: 355.0/1033 (0.3437), Top-5 Accuracy: 1.0
2021-08-18:15:29:16,219 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 19.7195, eval_time 0.6414, test_loss 5.4795, test_accuracy 0.3437, test_5_accuracy 1.0 

2021-08-18:15:29:16,222 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.5646, Top-1 Accuracy: 353.0/1033 (0.3417), Top-5 Accuracy: 1.0
2021-08-18:15:29:16,236 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 19.7346, eval_time 0.6605, test_loss 5.5646, test_accuracy 0.3417, test_5_accuracy 1.0 

2021-08-18:15:29:16,285 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:16,294 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:29:16,296 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:16,299 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:16,307 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:16,312 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:29:17,578 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:29:17,592 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:29:17,833 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:17,847 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:29:18,780 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:18,789 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:29:19,268 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:29:19,278 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:29:19,789 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:29:19,810 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:29:20,446 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:29:20,460 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:29:21,62 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:29:21,76 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:29:21,989 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:29:22,10 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:29:22,674 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:29:22,701 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:29:22,889 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:29:22,910 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:29:23,337 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:29:23,362 INFO     [learner.py:606] ====Pushing takes 0.022601842880249023 s
2021-08-18:15:29:23,426 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:23,433 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:29:23,434 INFO     [param_server.py:410] Lock worker 3 with localStep 3 , while globalStep is 2

2021-08-18:15:29:23,983 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:29:24,3 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:29:24,150 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:29:24,177 INFO     [learner.py:165] Start to run client 73 on rank 1...
2021-08-18:15:29:24,771 INFO     [learner.py:439] Completed to run client 73
2021-08-18:15:29:24,792 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:29:25,362 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:29:25,383 INFO     [learner.py:165] Start to run client 49 on rank 1...
2021-08-18:15:29:25,913 INFO     [learner.py:439] Completed to run client 49
2021-08-18:15:29:25,943 INFO     [learner.py:606] ====Pushing takes 0.028216123580932617 s
2021-08-18:15:29:25,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:25,996 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:29:25,997 INFO     [param_server.py:410] Lock worker 1 with localStep 3 , while globalStep is 2

2021-08-18:15:29:26,452 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:29:26,472 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:29:27,107 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:29:27,121 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:29:27,715 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:29:27,728 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:29:28,228 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:29:28,265 INFO     [learner.py:606] ====Pushing takes 0.03561973571777344 s
2021-08-18:15:29:28,311 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:28,319 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:28,320 INFO     [param_server.py:381] ====After aggregation in epoch: 2, virtual_clock: 94.09040263304013, top_1: : 33.8496 % (1049.0), top_5: : 100.0 % (3099.0), test loss: 5.517517513699001, test len: 3099.0
2021-08-18:15:29:28,321 INFO     [param_server.py:410] Lock worker 2 with localStep 3 , while globalStep is 3

2021-08-18:15:29:28,321 INFO     [param_server.py:441] ====Epoch 4 completes 20 clients with loss 52.19295701503463, sampled rewards are: 
 {5: 0, 6: 0, 16: 0, 38: 0, 49: 0, 50: 0, 53: 0, 55: 0, 65: 0, 71: 0, 73: 0, 81: 0, 82: 0, 83: 0, 87: 0, 97: 0, 99: 0, 105: 0, 106: 0, 110: 0} 
==========
2021-08-18:15:29:28,322 INFO     [param_server.py:450] ====Start to sample for epoch 4, global virtualClock: 94.09040263304013, round_duration: 36.96726763375522
2021-08-18:15:29:28,323 INFO     [oort.py:208] Training selector: Pacer 2: lastExploitationUtil 826.1166539859379, lastExplorationUtil 1028.6166451821211, last_util_record 0
2021-08-18:15:29:28,323 INFO     [oort.py:321] scores are 4,{5: 0.03506018984543571, 6: 0.24083810583969661, 7: 0.3393693877742314, 11: 0.06059360900698601, 14: 0.009192753012392476, 16: 0.8411089634913184, 17: 0.010986797648239005, 27: 0.04571189651997363, 31: 0.02782696964479408, 37: 0.1250845766025628, 38: 0.08151385650259371, 49: 0.01310461409923104, 50: 0.006367675136776324, 51: 0.1777127266151852, 53: 0.24366751562997255, 55: 0.17586054198956824, 57: 0.01823367764178721, 58: 0.003068315760169722, 59: 0.003175145989227261, 60: 0.0013691964547385147, 65: 0.03111009243907412, 67: 0.0016758757933965569, 70: 0.004619815064253627, 71: 0.0271957131762714, 73: 0.03570298635217421, 76: 0.0014808782495323034, 81: 0.08027793833043585, 82: 0.5974298974972325, 83: 0.2605732652973818, 84: 0.14650242500140984, 85: 0.04252742186750419, 86: 0.001669276870918846, 87: 0.050149932621861945, 97: 0.26325383168122984, 98: 0.14896556440829792, 99: 0.08686207585205102, 104: 0.002845083845888733, 105: 0.02014082986099083, 106: 0.011510221098302397, 107: 0.00813908186097514, 110: 0.048026255387293396, 112: 0.10737918815529196, 118: 0.1108392592461746, 119: 0.01611336317129939},[16, 82, 7, 97, 83, 53, 6, 51, 55, 98, 84, 37, 118, 112, 99, 38, 81, 11, 87, 110, 27, 85, 73, 5, 65, 31, 71, 105, 57, 119, 49, 106, 17, 14, 107, 50, 70, 59, 58, 104, 67, 86, 76, 60]
2021-08-18:15:29:28,324 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:29:28,325 INFO     [oort.py:365] exploration poss is [102.23853772  18.16687676   3.2544298    2.43794015   2.21488525
   1.67907336   1.37027356   0.86146108]
2021-08-18:15:29:28,326 INFO     [oort.py:398] At round 2, UCB exploited 44, augment_factor 1.75, exploreLen 8, un-explored 71, exploration 0.8122499999999999, round_threshold 10, sampled score is [({'reward': 1461.3239176271156, 'duration': 6.342067858842259, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 83.05965649139578}, [0.4454269172018948, -0.00010003334444814946]), ({'reward': 3247.6907184492047, 'duration': 7.864087706209871, 'time_stamp': 3, 'count': 1, 'status': True, 'gradient': 21.302627228948477}, [1.0, -0.00010003334444814946]), ({'reward': 1403.251686856354, 'duration': 13.324368782156236, 'time_stamp': 3, 'count': 1, 'status': True, 'gradient': 21.003045806997406}, [0.4273985391394032, -0.00010003334444814946])]
2021-08-18:15:29:28,327 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [82, 16, 53, 51, 83, 97, 38, 85, 110, 5, 106, 50, 105, 119, 17, 14, 111, 96, 25, 35]
2021-08-18:15:29:28,707 INFO     [param_server.py:553] For epoch: 4, median_reward: 467.80191917551616, dev: 467.80191917551616
2021-08-18:15:29:29,255 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.54, Top-1 Accuracy: 423.0/1033 (0.4095), Top-5 Accuracy: 1.0
2021-08-18:15:29:29,256 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 32.7568, eval_time 0.5352, test_loss 2.54, test_accuracy 0.4095, test_5_accuracy 1.0 

2021-08-18:15:29:29,306 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.433, Top-1 Accuracy: 425.0/1033 (0.4114), Top-5 Accuracy: 1.0
2021-08-18:15:29:29,307 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 32.8077, eval_time 0.5864, test_loss 2.433, test_accuracy 0.4114, test_5_accuracy 1.0 

2021-08-18:15:29:29,323 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:29,331 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:29:29,347 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5042, Top-1 Accuracy: 408.0/1033 (0.395), Top-5 Accuracy: 1.0
2021-08-18:15:29:29,348 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 32.8469, eval_time 0.6273, test_loss 2.5042, test_accuracy 0.395, test_5_accuracy 1.0 

2021-08-18:15:29:29,377 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:29,384 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:29:29,415 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:29,428 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:30,993 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:29:31,3 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:29:31,307 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:31,328 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:29:31,593 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:29:31,602 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:29:32,866 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:29:32,884 INFO     [learner.py:165] Start to run client 111 on rank 3...
2021-08-18:15:29:33,540 INFO     [learner.py:439] Completed to run client 111
2021-08-18:15:29:33,549 INFO     [learner.py:165] Start to run client 96 on rank 3...
2021-08-18:15:29:33,650 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:29:33,669 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:29:34,481 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:29:34,502 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:29:34,888 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:29:34,907 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:29:35,799 INFO     [learner.py:439] Completed to run client 96
2021-08-18:15:29:35,815 INFO     [learner.py:606] ====Pushing takes 0.014594316482543945 s
2021-08-18:15:29:35,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:35,851 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 4 clients
2021-08-18:15:29:35,852 INFO     [param_server.py:410] Lock worker 3 with localStep 4 , while globalStep is 3

2021-08-18:15:29:36,988 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:29:37,2 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:29:37,726 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:29:37,740 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:29:38,318 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:29:38,338 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:29:39,379 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:29:39,399 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:29:40,74 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:29:40,92 INFO     [learner.py:165] Start to run client 25 on rank 1...
2021-08-18:15:29:40,690 INFO     [learner.py:439] Completed to run client 25
2021-08-18:15:29:40,715 INFO     [learner.py:606] ====Pushing takes 0.02428412437438965 s
2021-08-18:15:29:40,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:40,773 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:15:29:40,774 INFO     [param_server.py:410] Lock worker 1 with localStep 4 , while globalStep is 3

2021-08-18:15:29:41,852 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:29:41,866 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:29:43,395 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:29:43,408 INFO     [learner.py:165] Start to run client 17 on rank 2...
2021-08-18:15:29:45,429 INFO     [learner.py:439] Completed to run client 17
2021-08-18:15:29:45,438 INFO     [learner.py:165] Start to run client 14 on rank 2...
2021-08-18:15:29:46,488 INFO     [learner.py:439] Completed to run client 14
2021-08-18:15:29:46,498 INFO     [learner.py:165] Start to run client 35 on rank 2...
2021-08-18:15:29:46,981 INFO     [learner.py:439] Completed to run client 35
2021-08-18:15:29:47,26 INFO     [learner.py:606] ====Pushing takes 0.04338479042053223 s
2021-08-18:15:29:47,79 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:47,89 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:47,90 INFO     [param_server.py:381] ====After aggregation in epoch: 3, virtual_clock: 178.02657935498743, top_1: : 40.5292 % (1256.0), top_5: : 100.0 % (3099.0), test loss: 2.4923938821863243, test len: 3099.0
2021-08-18:15:29:47,94 INFO     [param_server.py:410] Lock worker 2 with localStep 4 , while globalStep is 4

2021-08-18:15:29:47,94 INFO     [param_server.py:441] ====Epoch 5 completes 20 clients with loss 7.411938001403403, sampled rewards are: 
 {5: 0, 14: 0, 16: 0, 17: 0, 25: 0, 35: 0, 38: 0, 50: 0, 51: 0, 53: 0, 82: 0, 83: 0, 85: 0, 96: 0, 97: 0, 105: 0, 106: 0, 110: 0, 111: 0, 119: 0} 
==========
2021-08-18:15:29:47,95 INFO     [param_server.py:450] ====Start to sample for epoch 5, global virtualClock: 178.02657935498743, round_duration: 83.9361767219473
2021-08-18:15:29:47,95 INFO     [oort.py:208] Training selector: Pacer 3: lastExploitationUtil 744.4083763846675, lastExplorationUtil 247.34257853792462, last_util_record 0
2021-08-18:15:29:47,96 INFO     [oort.py:321] scores are 5,{5: 0.046112065992291604, 6: 0.47044471073783906, 7: 0.6006404140653409, 11: 0.10890590543552413, 14: 0.009069503692434183, 16: 0.7947166158550654, 17: 0.026101891099069876, 25: 0.0018632762749742184, 27: 0.08906280827907914, 31: 0.04927411346614357, 35: 0.0028340618690485663, 37: 0.21214436696066782, 38: 0.04326691280387255, 49: 0.023676351256316456, 50: 0.019715944071779935, 51: 0.12581999939104585, 53: 0.5265169225805238, 55: 0.264173696360456, 57: 0.032953255623743, 58: 0.005546300832812323, 59: 0.005739407616697755, 60: 0.002474965430800332, 65: 0.06340662687332871, 67: 0.0030293203291734206, 70: 0.007464337096205699, 71: 0.04837478506098576, 73: 0.07086630891740495, 76: 0.0021304495834894898, 81: 0.14745845250929454, 82: 0.41944086829685095, 83: 0.33260836962560836, 84: 0.2559393146709354, 85: 0.01810338056521537, 86: 0.003292500831272861, 87: 0.09803169509886192, 88: 0.0022750184422495384, 96: 0.004555362073013906, 97: 0.3022068129635457, 98: 0.2628093112953631, 99: 0.16892955467438, 104: 0.004093049307990466, 105: 0.026106024215766764, 106: 0.0366986621161989, 107: 0.014362282009103496, 110: 0.09824870801574989, 111: 0.006925007970077022, 112: 0.19292980714279154, 118: 0.20284891765062024, 119: 0.0055383517369295325},[16, 7, 53, 6, 82, 83, 97, 55, 98, 84, 37, 118, 112, 99, 81, 51, 11, 110, 87, 27, 73, 65, 31, 71, 5, 38, 106, 57, 105, 17, 49, 50, 85, 107, 14, 70, 111, 59, 58, 119, 96, 104, 86, 67, 35, 60, 88, 76, 25]
2021-08-18:15:29:47,97 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:29:47,98 INFO     [oort.py:398] At round 3, UCB exploited 49, augment_factor 2.0, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 103.3829639782392, 'duration': 8.010998429338052, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 20.486925875342866}, [0.0728090976953154, 0.1499249624812406]), ({'reward': 913.7256920178575, 'duration': 11.90395711384456, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 20.292275860250673}, [0.6435610126488794, 0.1499249624812406]), ({'reward': 507.8023305842829, 'duration': 13.411352670399307, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 17.55660768489444}, [0.3576553978442837, 0.3])]
2021-08-18:15:29:47,99 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 6, 84, 83, 98, 37, 118, 81, 99, 85, 71, 73, 57, 49, 17, 111, 25]
2021-08-18:15:29:47,543 INFO     [param_server.py:553] For epoch: 5, median_reward: 396.6694227513064, dev: 396.6694227513064
2021-08-18:15:29:48,217 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5671, Top-1 Accuracy: 380.0/1033 (0.3679), Top-5 Accuracy: 1.0
2021-08-18:15:29:48,218 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 51.7181, eval_time 0.6294, test_loss 2.5671, test_accuracy 0.3679, test_5_accuracy 1.0 

2021-08-18:15:29:48,267 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6527, Top-1 Accuracy: 377.0/1033 (0.365), Top-5 Accuracy: 1.0
2021-08-18:15:29:48,268 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 51.7682, eval_time 0.6793, test_loss 2.6527, test_accuracy 0.365, test_5_accuracy 1.0 

2021-08-18:15:29:48,288 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:29:48,297 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:29:48,338 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:29:48,346 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6312, Top-1 Accuracy: 386.0/1033 (0.3737), Top-5 Accuracy: 1.0
2021-08-18:15:29:48,347 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 51.8453, eval_time 0.7581, test_loss 2.6312, test_accuracy 0.3737, test_5_accuracy 1.0 

2021-08-18:15:29:48,351 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:29:48,416 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:29:48,440 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:29:50,926 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:29:50,936 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:29:51,245 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:51,266 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:29:51,530 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:29:51,550 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:52,470 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:29:52,488 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:29:52,596 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:29:52,623 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:29:53,519 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:29:53,552 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:29:53,576 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:53,595 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:29:55,210 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:29:55,225 INFO     [learner.py:165] Start to run client 17 on rank 2...
2021-08-18:15:29:55,714 INFO     [learner.py:439] Completed to run client 17
2021-08-18:15:29:55,730 INFO     [learner.py:606] ====Pushing takes 0.014142990112304688 s
2021-08-18:15:29:55,760 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:55,768 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 4 clients
2021-08-18:15:29:55,769 INFO     [param_server.py:410] Lock worker 2 with localStep 5 , while globalStep is 4

2021-08-18:15:29:56,104 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:29:56,125 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:29:56,753 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:29:56,774 INFO     [learner.py:165] Start to run client 57 on rank 3...
2021-08-18:15:29:57,514 INFO     [learner.py:439] Completed to run client 57
2021-08-18:15:29:57,527 INFO     [learner.py:165] Start to run client 111 on rank 3...
2021-08-18:15:29:58,39 INFO     [learner.py:439] Completed to run client 111
2021-08-18:15:29:58,66 INFO     [learner.py:606] ====Pushing takes 0.02539539337158203 s
2021-08-18:15:29:58,97 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:58,104 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 10 clients
2021-08-18:15:29:58,105 INFO     [param_server.py:410] Lock worker 3 with localStep 5 , while globalStep is 4

2021-08-18:15:29:59,288 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:29:59,309 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:00,670 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:00,691 INFO     [learner.py:165] Start to run client 118 on rank 1...
2021-08-18:15:30:01,945 INFO     [learner.py:439] Completed to run client 118
2021-08-18:15:30:01,963 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:02,587 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:02,601 INFO     [learner.py:165] Start to run client 73 on rank 1...
2021-08-18:15:30:03,284 INFO     [learner.py:439] Completed to run client 73
2021-08-18:15:30:03,298 INFO     [learner.py:165] Start to run client 49 on rank 1...
2021-08-18:15:30:04,267 INFO     [learner.py:439] Completed to run client 49
2021-08-18:15:30:04,288 INFO     [learner.py:165] Start to run client 25 on rank 1...
2021-08-18:15:30:04,806 INFO     [learner.py:439] Completed to run client 25
2021-08-18:15:30:04,847 INFO     [learner.py:606] ====Pushing takes 0.04004025459289551 s
2021-08-18:15:30:04,905 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:04,916 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:04,917 INFO     [param_server.py:381] ====After aggregation in epoch: 4, virtual_clock: 228.4925667060778, top_1: : 36.8829 % (1143.0), top_5: : 100.0 % (3099.0), test loss: 2.6169920762379966, test len: 3099.0
2021-08-18:15:30:04,920 INFO     [param_server.py:410] Lock worker 1 with localStep 5 , while globalStep is 5

2021-08-18:15:30:04,921 INFO     [param_server.py:441] ====Epoch 6 completes 20 clients with loss 6.6593066887164305, sampled rewards are: 
 {6: 0, 7: 0, 16: 0, 17: 0, 25: 0, 37: 0, 49: 0, 55: 0, 57: 0, 71: 0, 73: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 98: 0, 99: 0, 111: 0, 118: 0} 
==========
2021-08-18:15:30:04,921 INFO     [param_server.py:450] ====Start to sample for epoch 6, global virtualClock: 228.4925667060778, round_duration: 50.46598735109039
2021-08-18:15:30:04,922 INFO     [oort.py:208] Training selector: Pacer 4: lastExploitationUtil 402.2762903171616, lastExplorationUtil 236.39184584302865, last_util_record 0
2021-08-18:15:30:04,922 INFO     [oort.py:321] scores are 26,{5: 0.04797825848088375, 6: 0.2468361424875337, 7: 0.4959711292908512, 11: 0.11378276480006508, 14: 0.009482526513191588, 16: 0.3181023630586697, 17: 0.012643898394127372, 25: 0.0023351669130390416, 27: 0.09156328378368632, 35: 0.0029988031428835405, 37: 0.11854841066338365, 38: 0.04709424640217796, 49: 0.03331235479930845, 50: 0.02057209296495763, 51: 0.1370972371034789, 53: 0.5398607806574534, 55: 0.1665109292748793, 57: 0.018836332330874464, 58: 0.003759521608177368, 59: 0.0038904177042578245, 60: 0.001677638176699441, 65: 0.0646626666411593, 67: 0.003161259435845313, 70: 0.00797938113272075, 71: 0.08532770688098021, 73: 0.0806646545380444, 76: 0.0022128892199312134, 81: 0.11095484243493167, 82: 0.24424692152973257, 83: 0.31613994875316553, 84: 0.07517695356251312, 85: 0.05009500588821884, 86: 0.0016507171129808015, 87: 0.1007883176394764, 88: 0.0023630522989203334, 96: 0.004872099712611481, 97: 0.3086036679033184, 98: 0.1521940613840047, 99: 0.11242306271923694, 104: 0.0034860017780906, 105: 0.02695553667989846, 106: 0.03763733053189129, 107: 0.015062802732881204, 110: 0.1003771951410503, 111: 0.00881091115179829, 112: 0.20158321896553985, 118: 0.04781588564233037, 119: 0.006221370048922065},[53, 7, 16, 83, 97, 6, 82, 112, 55, 98, 51, 37, 11, 99, 81, 87, 110, 27, 71, 73, 84, 65, 85, 5, 118, 38, 106, 49, 105, 50, 57, 107, 17, 14, 111, 70, 119, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:30:04,923 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:30:04,924 INFO     [oort.py:398] At round 4, UCB exploited 48, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 909.6904025814919, 'duration': 11.058674649423494, 'time_stamp': 4, 'count': 2, 'status': True, 'gradient': 19.679868571515033}, [0.6407188211988872, 0.09993331110370123]), ({'reward': 250.36748872855853, 'duration': 13.411352670399307, 'time_stamp': 5, 'count': 2, 'status': True, 'gradient': 17.563097894762258}, [0.17633529231266595, -0.00010003334444814946]), ({'reward': 385.5707565848008, 'duration': 11.90395711384456, 'time_stamp': 5, 'count': 3, 'status': True, 'gradient': 20.288439271394147}, [0.27156354742839167, -0.00010003334444814946])]
2021-08-18:15:30:04,925 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 11, 87, 85, 110, 71, 5, 27]
2021-08-18:15:30:05,261 INFO     [param_server.py:553] For epoch: 6, median_reward: 359.2310180743354, dev: 359.2310180743354
2021-08-18:15:30:05,985 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.919, Top-1 Accuracy: 447.0/1033 (0.4327), Top-5 Accuracy: 1.0
2021-08-18:15:30:05,986 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 69.4865, eval_time 0.6889, test_loss 2.919, test_accuracy 0.4327, test_5_accuracy 1.0 

2021-08-18:15:30:06,56 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:06,59 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1478, Top-1 Accuracy: 438.0/1033 (0.424), Top-5 Accuracy: 1.0
2021-08-18:15:30:06,60 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 69.5586, eval_time 0.7634, test_loss 3.1478, test_accuracy 0.424, test_5_accuracy 1.0 

2021-08-18:15:30:06,64 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:06,67 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7278, Top-1 Accuracy: 448.0/1033 (0.4337), Top-5 Accuracy: 1.0
2021-08-18:15:30:06,68 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 69.5688, eval_time 0.7665, test_loss 2.7278, test_accuracy 0.4337, test_5_accuracy 1.0 

2021-08-18:15:30:06,128 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:06,142 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:06,147 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:06,159 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:06,645 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:06,654 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:08,442 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:08,465 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:08,512 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:08,539 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:09,9 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:09,18 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:09,94 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:09,108 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:10,250 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:10,261 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:10,264 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:10,271 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:10,506 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:10,526 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:11,187 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:11,208 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:11,724 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:11,744 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:11,769 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:11,790 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:12,29 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:12,43 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:12,478 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:12,505 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:30:13,172 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:30:13,198 INFO     [learner.py:606] ====Pushing takes 0.023569107055664062 s
2021-08-18:15:30:13,232 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:13,241 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:30:13,241 INFO     [param_server.py:410] Lock worker 3 with localStep 6 , while globalStep is 5

2021-08-18:15:30:13,468 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:13,482 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:30:14,81 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:30:14,107 INFO     [learner.py:606] ====Pushing takes 0.02460932731628418 s
2021-08-18:15:30:14,134 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:14,142 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:30:14,143 INFO     [param_server.py:410] Lock worker 2 with localStep 6 , while globalStep is 5

2021-08-18:15:30:14,750 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:14,767 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:15,381 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:15,396 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:16,75 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:16,93 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:16,603 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:16,629 INFO     [learner.py:606] ====Pushing takes 0.02492380142211914 s
2021-08-18:15:30:16,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:16,669 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:16,671 INFO     [param_server.py:381] ====After aggregation in epoch: 5, virtual_clock: 254.3850128987072, top_1: : 43.0139 % (1333.0), top_5: : 100.0 % (3099.0), test loss: 2.9315422552603265, test len: 3099.0
2021-08-18:15:30:16,672 INFO     [param_server.py:410] Lock worker 1 with localStep 6 , while globalStep is 6

2021-08-18:15:30:16,672 INFO     [param_server.py:441] ====Epoch 7 completes 20 clients with loss 9.580012788319154, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 110: 0} 
==========
2021-08-18:15:30:16,685 INFO     [param_server.py:450] ====Start to sample for epoch 7, global virtualClock: 254.3850128987072, round_duration: 25.8924461926294
2021-08-18:15:30:16,686 INFO     [oort.py:208] Training selector: Pacer 5: lastExploitationUtil 467.6786147043069, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:16,686 INFO     [oort.py:321] scores are 26,{5: 0.02566495163715949, 6: 0.29421370639462613, 7: 0.8524758912426269, 11: 0.10640162278064975, 14: 0.010717132164633448, 16: 0.6646673343933135, 17: 0.014377034206756241, 25: 0.0025565633551976694, 27: 0.03392858671499573, 35: 0.0033620785055720435, 37: 0.1887326163074529, 38: 0.05181208942357503, 49: 0.024589645592464734, 50: 0.02328229191457985, 51: 0.18199495112904082, 53: 0.36715214326166834, 55: 0.25201451107862227, 57: 0.021218653304822758, 58: 0.004257737290712728, 59: 0.004405979872502455, 60: 0.0018999605188383128, 65: 0.029138077516007523, 67: 0.0035774285315815207, 70: 0.008884959421234418, 71: 0.06720873718667114, 73: 0.041160955079663206, 76: 0.0025121031755418626, 81: 0.042123933644992034, 82: 0.16378024268734212, 83: 0.40327065725255495, 84: 0.2868006836290388, 85: 0.04118405266184106, 86: 0.0018694718479789173, 87: 0.019130458659895086, 88: 0.002682570429022106, 96: 0.005423235261625926, 97: 0.3642448472915777, 98: 0.4451924406856903, 99: 0.127920692548078, 104: 0.003947970330529081, 105: 0.03072344293981076, 106: 0.025144272672307892, 107: 0.016988573773837463, 110: 0.08012399136649642, 111: 0.009983816576099114, 119: 0.006703404410646511},[7, 16, 98, 83, 53, 97, 6, 84, 55, 37, 51, 82, 99, 11, 110, 71, 38, 81, 85, 73, 27, 105, 65, 5, 106, 49, 50, 57, 87, 107, 17, 14, 111, 70, 119, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:30:16,687 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:30:16,688 INFO     [oort.py:398] At round 5, UCB exploited 46, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 485.80370038722265, 'duration': 11.058674649423494, 'time_stamp': 6, 'count': 3, 'status': True, 'gradient': 16.155450208077653}, [0.3985723766572379, -7.501875468867222e-05]), ({'reward': 839.4159248288624, 'duration': 5.8943907365129, 'time_stamp': 6, 'count': 3, 'status': True, 'gradient': 20.601629325476612}, [0.688695656759845, -7.501875468867222e-05]), ({'reward': 610.5084013334287, 'duration': 7.864087706209871, 'time_stamp': 6, 'count': 4, 'status': True, 'gradient': 21.30619202204655}, [0.5008870999105316, -7.501875468867222e-05])]
2021-08-18:15:30:16,689 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:30:17,20 INFO     [param_server.py:553] For epoch: 7, median_reward: 328.5418732353906, dev: 328.5418732353906
2021-08-18:15:30:17,765 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1942, Top-1 Accuracy: 444.0/1033 (0.4298), Top-5 Accuracy: 1.0
2021-08-18:15:30:17,765 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 81.2656, eval_time 0.7082, test_loss 4.1942, test_accuracy 0.4298, test_5_accuracy 1.0 

2021-08-18:15:30:17,771 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0905, Top-1 Accuracy: 415.0/1033 (0.4017), Top-5 Accuracy: 1.0
2021-08-18:15:30:17,771 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 81.2718, eval_time 0.7154, test_loss 3.0905, test_accuracy 0.4017, test_5_accuracy 1.0 

2021-08-18:15:30:17,827 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:17,835 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:17,843 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:17,851 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.198, Top-1 Accuracy: 423.0/1033 (0.4095), Top-5 Accuracy: 1.0
2021-08-18:15:30:17,851 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:17,852 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 81.351, eval_time 0.7965, test_loss 3.198, test_accuracy 0.4095, test_5_accuracy 1.0 

2021-08-18:15:30:17,934 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:17,953 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:18,330 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:18,340 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:19,344 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:19,354 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:19,453 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:19,463 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:19,941 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:19,951 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:20,411 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:20,437 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:20,515 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:20,524 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:20,639 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:20,652 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:21,111 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:21,120 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:21,153 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:21,162 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:21,607 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:21,617 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:21,643 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:21,664 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:21,680 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:21,693 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:22,238 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:22,258 INFO     [learner.py:606] ====Pushing takes 0.018675565719604492 s
2021-08-18:15:30:22,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:22,299 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:30:22,299 INFO     [param_server.py:410] Lock worker 2 with localStep 7 , while globalStep is 6

2021-08-18:15:30:22,944 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:22,958 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:23,325 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:23,337 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:23,956 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:23,982 INFO     [learner.py:606] ====Pushing takes 0.024590015411376953 s
2021-08-18:15:30:24,8 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:24,14 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:30:24,15 INFO     [param_server.py:410] Lock worker 3 with localStep 7 , while globalStep is 6

2021-08-18:15:30:24,626 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:24,640 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:25,254 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:25,272 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:25,913 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:25,933 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:26,557 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:26,585 INFO     [learner.py:606] ====Pushing takes 0.02574634552001953 s
2021-08-18:15:30:26,615 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:26,622 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:26,623 INFO     [param_server.py:381] ====After aggregation in epoch: 6, virtual_clock: 274.1040837655081, top_1: : 41.3682 % (1282.0), top_5: : 100.0 % (3099.0), test loss: 3.4942278464635215, test len: 3099.0
2021-08-18:15:30:26,624 INFO     [param_server.py:410] Lock worker 1 with localStep 7 , while globalStep is 7

2021-08-18:15:30:26,625 INFO     [param_server.py:441] ====Epoch 8 completes 20 clients with loss 12.549566399147908, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:26,625 INFO     [param_server.py:450] ====Start to sample for epoch 8, global virtualClock: 274.1040837655081, round_duration: 19.719070866800898
2021-08-18:15:30:26,626 INFO     [oort.py:208] Training selector: Pacer 6: lastExploitationUtil 497.47102032946253, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:26,626 INFO     [oort.py:321] scores are 26,{5: 0.025296797506586786, 6: 0.3828917354759066, 7: 0.15998926894983345, 11: 0.07435358935398545, 14: 0.010198659277386765, 16: 1.1599892616587597, 17: 0.01349761851013553, 25: 0.0026076944934418623, 27: 0.04521790222917099, 35: 0.003256888344811169, 37: 0.06769941682912041, 38: 0.029960089702870143, 49: 0.023076352584835577, 50: 0.02208876889033155, 51: 0.25377749197685795, 53: 0.45951181526594265, 55: 0.15998926894983345, 58: 0.0040332814809715236, 59: 0.004173709135145514, 60: 0.001799799999855051, 65: 0.027818699645681833, 67: 0.003394672233767097, 70: 0.008737151907961744, 71: 0.052958447401443134, 73: 0.039297178952918295, 76: 0.002367091101120268, 81: 0.04114890318009296, 82: 1.0101887593365588, 83: 0.12628957419256115, 84: 0.07223253088983021, 85: 0.024708147696504024, 86: 0.001770918605076452, 87: 0.091012945659595, 88: 0.002527718070057744, 96: 0.005336876585081426, 97: 0.2820351303142606, 98: 0.27101940930544693, 99: 0.17571287173939004, 104: 0.003739844554590279, 105: 0.02172563901282545, 106: 0.023596846871726827, 107: 0.012668021557869552, 110: 0.09002174032219376, 111: 0.009446363523923484, 119: 0.0070729104320570975},[16, 82, 53, 6, 97, 98, 51, 99, 7, 55, 83, 87, 110, 11, 84, 37, 71, 27, 81, 73, 38, 65, 5, 85, 106, 49, 50, 105, 17, 107, 14, 111, 70, 119, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:30:26,627 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:30:26,628 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:30:26,628 INFO     [oort.py:398] At round 6, UCB exploited 45, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 712.5950009459411, 'duration': 11.90395711384456, 'time_stamp': 7, 'count': 5, 'status': True, 'gradient': 20.299812409907275}, [0.5195509882633108, -4.286326618088302e-05]), ({'reward': 142.97750093003935, 'duration': 29.570969934622333, 'time_stamp': 6, 'count': 3, 'status': True, 'gradient': 11.30809993890393}, [0.10423866689904689, 0.0428204029147021]), ({'reward': 1166.0926884163605, 'duration': 6.342067858842259, 'time_stamp': 7, 'count': 6, 'status': True, 'gradient': 51.71222344735942}, [0.8501994976777992, -4.286326618088302e-05])]
2021-08-18:15:30:26,629 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 110, 71, 5]
2021-08-18:15:30:26,986 INFO     [param_server.py:553] For epoch: 8, median_reward: 332.747999027422, dev: 332.747999027422
2021-08-18:15:30:27,534 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3224, Top-1 Accuracy: 505.0/1033 (0.4889), Top-5 Accuracy: 1.0
2021-08-18:15:30:27,538 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 91.037, eval_time 0.53, test_loss 2.3224, test_accuracy 0.4889, test_5_accuracy 1.0 

2021-08-18:15:30:27,577 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0645, Top-1 Accuracy: 492.0/1033 (0.4763), Top-5 Accuracy: 1.0
2021-08-18:15:30:27,581 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 91.081, eval_time 0.5609, test_loss 2.0645, test_accuracy 0.4763, test_5_accuracy 1.0 

2021-08-18:15:30:27,584 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1864, Top-1 Accuracy: 501.0/1033 (0.485), Top-5 Accuracy: 1.0
2021-08-18:15:30:27,588 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 91.0883, eval_time 0.5645, test_loss 2.1864, test_accuracy 0.485, test_5_accuracy 1.0 

2021-08-18:15:30:27,606 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:30:27,622 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:27,641 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:30:27,657 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:30:27,662 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:27,678 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:28,202 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:28,222 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:29,276 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:29,291 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:29,426 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:29,440 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:29,918 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:29,929 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:29,937 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:29,957 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:30,544 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:30,554 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:30,574 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:30,583 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:31,98 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:31,107 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:31,134 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:31,143 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:31,144 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:31,164 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:31,603 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:31,613 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:31,745 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:31,759 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:32,525 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:32,551 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:32,900 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:32,911 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:32,921 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:32,935 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:30:33,455 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:33,478 INFO     [learner.py:606] ====Pushing takes 0.021710634231567383 s
2021-08-18:15:30:33,514 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:33,522 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:30:33,533 INFO     [param_server.py:410] Lock worker 3 with localStep 8 , while globalStep is 7

2021-08-18:15:30:33,538 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:30:33,570 INFO     [learner.py:606] ====Pushing takes 0.03026580810546875 s
2021-08-18:15:30:33,607 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:33,615 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:30:33,615 INFO     [param_server.py:410] Lock worker 2 with localStep 8 , while globalStep is 7

2021-08-18:15:30:34,681 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:34,702 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:35,286 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:35,306 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:35,908 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:35,931 INFO     [learner.py:606] ====Pushing takes 0.021709203720092773 s
2021-08-18:15:30:35,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:35,965 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:35,965 INFO     [param_server.py:381] ====After aggregation in epoch: 7, virtual_clock: 293.55987746394345, top_1: : 48.3382 % (1498.0), top_5: : 100.0 % (3099.0), test loss: 2.191108202492749, test len: 3099.0
2021-08-18:15:30:35,966 INFO     [param_server.py:410] Lock worker 1 with localStep 8 , while globalStep is 8

2021-08-18:15:30:35,966 INFO     [param_server.py:441] ====Epoch 9 completes 20 clients with loss 5.230288182188774, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:35,967 INFO     [param_server.py:450] ====Start to sample for epoch 9, global virtualClock: 293.55987746394345, round_duration: 19.455793698435347
2021-08-18:15:30:35,967 INFO     [oort.py:208] Training selector: Pacer 7: lastExploitationUtil 347.3534416032957, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:35,968 INFO     [oort.py:321] scores are 26,{5: 0.019451579569248156, 6: 0.5504615234077176, 7: 0.21907711788370735, 11: 0.06643974939769748, 14: 0.012277190076745662, 16: 1.1559611389519562, 17: 0.01655156627212719, 25: 0.002851031076876629, 27: 0.042424179014606475, 35: 0.0038259511750036094, 37: 0.1455954877113409, 38: 0.029205771313924524, 49: 0.022025776941869375, 50: 0.020542587222976808, 51: 0.39434532821943524, 53: 0.4776749612587375, 55: 0.1559611485803786, 58: 0.004885732177437557, 59: 0.0050558397962181525, 60: 0.0021801951621104863, 65: 0.02609996119989428, 67: 0.004102488090248364, 70: 0.010052986537122919, 71: 0.059093668517019214, 73: 0.0368692591314446, 76: 0.002888216572290084, 81: 0.18484728740771655, 82: 0.6544620648191455, 83: 0.08312274259540275, 84: 0.22042974260229678, 85: 0.0277626727920476, 86: 0.002145209565279519, 87: 0.01821714424469636, 88: 0.0030842062718087807, 96: 0.006134464504592883, 97: 0.22281622220661781, 98: 0.26183558694691955, 99: 0.04228069777909207, 104: 0.004530276144915898, 105: 0.026838718518917233, 106: 0.022522575169424526, 107: 0.015649411489463003, 110: 0.046091126098275634, 111: 0.01146132740783037, 119: 0.007370886093199707},[16, 82, 6, 53, 51, 98, 97, 84, 7, 81, 55, 37, 83, 11, 71, 110, 27, 99, 73, 38, 85, 105, 65, 106, 49, 50, 5, 87, 17, 107, 14, 111, 70, 119, 96, 59, 58, 104, 67, 35, 88, 76, 25, 60, 86]
2021-08-18:15:30:35,969 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:30:35,969 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:30:35,970 INFO     [oort.py:398] At round 7, UCB exploited 45, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 20.64883858350112, 'time_stamp': 8, 'count': 4, 'status': True, 'gradient': 8.081090943831969}, [9.628422301594054e-09, -3.750468808601078e-05]), ({'reward': 247.00025617063437, 'duration': 21.753601635627824, 'time_stamp': 8, 'count': 4, 'status': True, 'gradient': 19.394598325698894}, [0.23781265870740845, -3.750468808601078e-05]), ({'reward': 48.40207113360668, 'duration': 19.55790138125729, 'time_stamp': 8, 'count': 4, 'status': True, 'gradient': 19.395340192116915}, [0.04659393932073864, -3.750468808601078e-05])]
2021-08-18:15:30:35,970 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 110, 71, 5]
2021-08-18:15:30:36,245 INFO     [param_server.py:553] For epoch: 9, median_reward: 300.82180275280894, dev: 300.82180275280894
2021-08-18:15:30:36,972 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.7802, Top-1 Accuracy: 492.0/1033 (0.4763), Top-5 Accuracy: 1.0
2021-08-18:15:30:36,973 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 100.472, eval_time 0.6934, test_loss 1.7802, test_accuracy 0.4763, test_5_accuracy 1.0 

2021-08-18:15:30:36,983 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.872, Top-1 Accuracy: 509.0/1033 (0.4927), Top-5 Accuracy: 1.0
2021-08-18:15:30:36,983 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 100.484, eval_time 0.7033, test_loss 1.872, test_accuracy 0.4927, test_5_accuracy 1.0 

2021-08-18:15:30:36,987 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9, Top-1 Accuracy: 497.0/1033 (0.4811), Top-5 Accuracy: 1.0
2021-08-18:15:30:36,988 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 100.4888, eval_time 0.7082, test_loss 1.9, test_accuracy 0.4811, test_5_accuracy 1.0 

2021-08-18:15:30:37,40 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:30:37,40 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:30:37,54 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:37,59 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:37,73 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:30:37,89 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:37,655 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:37,675 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:46,153 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:46,181 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:48,212 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:48,239 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:48,330 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:48,350 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:48,399 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:48,426 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:48,956 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:48,974 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:48,984 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:48,998 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:49,414 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:49,433 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:49,444 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:49,453 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:49,508 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:49,518 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:50,557 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:50,568 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:50,619 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:50,633 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:51,36 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:51,47 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:51,124 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:51,133 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:51,597 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:51,601 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:51,607 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:30:51,622 INFO     [learner.py:606] ====Pushing takes 0.019420623779296875 s
2021-08-18:15:30:51,658 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:51,668 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:30:51,668 INFO     [param_server.py:410] Lock worker 3 with localStep 9 , while globalStep is 8

2021-08-18:15:30:52,192 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:30:52,225 INFO     [learner.py:606] ====Pushing takes 0.0306851863861084 s
2021-08-18:15:30:52,258 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:52,266 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:30:52,267 INFO     [param_server.py:410] Lock worker 2 with localStep 9 , while globalStep is 8

2021-08-18:15:30:52,957 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:52,984 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:53,685 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:53,706 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:54,421 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:54,444 INFO     [learner.py:606] ====Pushing takes 0.021748065948486328 s
2021-08-18:15:30:54,469 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:54,475 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:54,476 INFO     [param_server.py:381] ====After aggregation in epoch: 8, virtual_clock: 314.58810886897663, top_1: : 48.3382 % (1498.0), top_5: : 100.0 % (3099.0), test loss: 1.850731434645476, test len: 3099.0
2021-08-18:15:30:54,520 INFO     [param_server.py:410] Lock worker 1 with localStep 9 , while globalStep is 9

2021-08-18:15:30:54,520 INFO     [param_server.py:441] ====Epoch 10 completes 20 clients with loss 4.120586918452288, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:54,521 INFO     [param_server.py:450] ====Start to sample for epoch 10, global virtualClock: 314.58810886897663, round_duration: 21.0282314050332
2021-08-18:15:30:54,522 INFO     [oort.py:208] Training selector: Pacer 8: lastExploitationUtil 354.42492484560995, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:54,522 INFO     [oort.py:321] scores are 26,{5: 0.0472959629855784, 6: 0.32325005617195857, 7: 0.5012437432749945, 11: 0.09810898629268867, 14: 0.01334437055543112, 16: 0.9111978025992679, 17: 0.018094187060311684, 25: 0.0030000841158167356, 27: 0.046131726534487855, 35: 0.0041260522972981235, 37: 0.38151755584530844, 38: 0.02846455438500233, 49: 0.024023131436825634, 50: 0.022337851623597787, 51: 0.3019832920292992, 53: 0.5415332904593754, 55: 0.15200299105256113, 58: 0.005320857313222969, 59: 0.005506114780180232, 60: 0.0023743641589975754, 65: 0.02846677327460007, 67: 0.004464565642709419, 70: 0.010767483737024715, 71: 0.02472800863212508, 73: 0.04009134930331541, 76: 0.003152538652746269, 81: 0.04001210096285357, 82: 0.4147437078406182, 83: 0.2355116210377928, 84: 0.19839267721160697, 85: 0.029496782024978636, 86: 0.0023362627318225075, 87: 0.017754809058761773, 88: 0.003366464820610789, 96: 0.006568251623399947, 97: 0.36055875259267073, 98: 0.3937314292728612, 99: 0.04572554228152852, 104: 0.004933744233446245, 105: 0.022164700004152296, 106: 0.024490875314537336, 107: 0.012924034009335977, 110: 0.0836878486843729, 111: 0.012488358033287315, 119: 0.007619591131659212},[16, 53, 7, 82, 98, 37, 97, 6, 51, 83, 84, 55, 11, 110, 5, 27, 99, 73, 81, 85, 65, 38, 71, 106, 49, 50, 105, 17, 87, 14, 107, 111, 70, 119, 96, 59, 58, 104, 67, 35, 88, 76, 25, 60, 86]
2021-08-18:15:30:54,524 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:30:54,524 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:30:54,525 INFO     [oort.py:398] At round 8, UCB exploited 45, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 629.7658354247098, 'duration': 11.058674649423494, 'time_stamp': 9, 'count': 6, 'status': True, 'gradient': 14.549061669468188}, [0.6774424294568719, -3.3337037448605424e-05]), ({'reward': 0.01, 'duration': 8.010998429338052, 'time_stamp': 9, 'count': 7, 'status': True, 'gradient': 20.50844231818488}, [1.0757223364873645e-08, -3.3337037448605424e-05]), ({'reward': 696.8539553856543, 'duration': 13.73645665746006, 'time_stamp': 9, 'count': 6, 'status': True, 'gradient': 11.315664988192948}, [0.7496106186118067, -3.3337037448605424e-05])]
2021-08-18:15:30:54,526 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 38, 11, 85, 110, 71, 5, 27]
2021-08-18:15:30:54,890 INFO     [param_server.py:553] For epoch: 10, median_reward: 299.8519928042883, dev: 299.8519928042883
2021-08-18:15:30:55,521 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0181, Top-1 Accuracy: 516.0/1033 (0.4995), Top-5 Accuracy: 1.0
2021-08-18:15:30:55,522 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 119.0222, eval_time 0.5846, test_loss 2.0181, test_accuracy 0.4995, test_5_accuracy 1.0 

2021-08-18:15:30:55,576 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1372, Top-1 Accuracy: 520.0/1033 (0.5034), Top-5 Accuracy: 1.0
2021-08-18:15:30:55,576 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 119.0766, eval_time 0.639, test_loss 2.1372, test_accuracy 0.5034, test_5_accuracy 1.0 

2021-08-18:15:30:55,643 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0222, Top-1 Accuracy: 518.0/1033 (0.5015), Top-5 Accuracy: 1.0
2021-08-18:15:30:55,644 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 119.1425, eval_time 0.7093, test_loss 2.0222, test_accuracy 0.5015, test_5_accuracy 1.0 

2021-08-18:15:30:55,668 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:30:55,681 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:55,686 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:30:55,706 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:55,746 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:30:55,768 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:56,409 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:56,430 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:57,599 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:57,626 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:58,338 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:58,365 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:58,927 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:58,940 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:58,952 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:58,966 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:59,221 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:59,255 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:59,418 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:59,431 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:59,968 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:59,983 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:00,44 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:00,57 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:00,548 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:00,557 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:00,567 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:00,581 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:31:01,106 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:31:01,130 INFO     [learner.py:606] ====Pushing takes 0.0220794677734375 s
2021-08-18:15:31:01,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:01,171 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:31:01,171 INFO     [param_server.py:410] Lock worker 3 with localStep 10 , while globalStep is 9

2021-08-18:15:31:01,197 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:01,215 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:01,676 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:01,685 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:03,317 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:03,331 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:03,355 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:03,369 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:03,911 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:03,939 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:03,943 INFO     [learner.py:606] ====Pushing takes 0.030396699905395508 s
2021-08-18:15:31:03,957 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:03,986 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:03,994 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:03,995 INFO     [param_server.py:410] Lock worker 2 with localStep 10 , while globalStep is 9

2021-08-18:15:31:04,571 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:04,589 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:05,156 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:05,184 INFO     [learner.py:606] ====Pushing takes 0.026576519012451172 s
2021-08-18:15:31:05,214 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:05,221 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:05,222 INFO     [param_server.py:381] ====After aggregation in epoch: 9, virtual_clock: 338.4860178249694, top_1: : 50.1452 % (1554.0), top_5: : 100.0 % (3099.0), test loss: 2.0591374414938466, test len: 3099.0
2021-08-18:15:31:05,223 INFO     [param_server.py:410] Lock worker 1 with localStep 10 , while globalStep is 10

2021-08-18:15:31:05,224 INFO     [param_server.py:441] ====Epoch 11 completes 20 clients with loss 5.4782011276523415, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 97: 0, 98: 0, 110: 0} 
==========
2021-08-18:15:31:05,224 INFO     [param_server.py:450] ====Start to sample for epoch 11, global virtualClock: 338.4860178249694, round_duration: 23.89790895599279
2021-08-18:15:31:05,225 INFO     [oort.py:208] Training selector: Pacer 9: lastExploitationUtil 352.88717935809655, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:05,226 INFO     [oort.py:321] scores are 26,{5: 0.015586898261074828, 6: 0.11935569245622102, 7: 0.5466337307276824, 11: 0.15225380728182183, 14: 0.011945535873368272, 16: 0.8928995205560019, 17: 0.015929349365212085, 25: 0.0029404708571561414, 27: 0.09933277715229358, 35: 0.00377731143220882, 37: 0.06272365014876898, 38: 0.027758085268176722, 49: 0.020726045482568792, 50: 0.019330378139973944, 51: 0.19821573227609626, 53: 0.1904193701214679, 55: 0.33088000210643886, 58: 0.004736157561085393, 59: 0.004901057407336993, 60: 0.002113449412834366, 65: 0.024559813910309133, 67: 0.003982439472974102, 70: 0.01004996543786535, 71: 0.014652273866844224, 76: 0.002787835371524901, 81: 0.07029612497997735, 82: 0.4819832118943391, 83: 0.2264492904686879, 84: 0.06692358973090912, 85: 0.101641918635655, 86: 0.0020795348851970824, 87: 0.01825071428558548, 88: 0.002977013365313478, 96: 0.00613634293102901, 97: 0.2129720376114025, 98: 0.295386057319898, 99: 0.04416454259330746, 104: 0.004391583664088889, 105: 0.01918053891927224, 106: 0.021193527864104875, 107: 0.011411405991425722, 110: 0.025690471720763827, 111: 0.011099859124942595, 119: 0.00783241210332114},[16, 7, 82, 55, 98, 83, 97, 51, 53, 11, 6, 85, 27, 81, 84, 37, 99, 38, 110, 65, 106, 49, 50, 105, 87, 17, 5, 71, 14, 107, 111, 70, 119, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:31:05,227 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:31:05,227 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:05,228 INFO     [oort.py:398] At round 9, UCB exploited 44, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 838.9372536280325, 'duration': 7.864087706209871, 'time_stamp': 10, 'count': 8, 'status': True, 'gradient': 21.32333769761533}, [0.7446691398192508, -3.0003000300030024e-05]), ({'reward': 352.8885909068138, 'duration': 38.73261129255839, 'time_stamp': 10, 'count': 5, 'status': True, 'gradient': 18.918719330290873}, [0.313230735953778, -3.0003000300030024e-05]), ({'reward': 448.8421147060934, 'duration': 5.8943907365129, 'time_stamp': 10, 'count': 7, 'status': True, 'gradient': 20.615828231523086}, [0.39840334999093124, -3.0003000300030024e-05])]
2021-08-18:15:31:05,229 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:05,498 INFO     [param_server.py:553] For epoch: 11, median_reward: 296.45885130924336, dev: 296.45885130924336
2021-08-18:15:31:06,75 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0118, Top-1 Accuracy: 500.0/1033 (0.484), Top-5 Accuracy: 1.0
2021-08-18:15:31:06,76 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 129.5766, eval_time 0.5416, test_loss 2.0118, test_accuracy 0.484, test_5_accuracy 1.0 

2021-08-18:15:31:06,88 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0006, Top-1 Accuracy: 499.0/1033 (0.4831), Top-5 Accuracy: 1.0
2021-08-18:15:31:06,91 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 129.5916, eval_time 0.5555, test_loss 2.0006, test_accuracy 0.4831, test_5_accuracy 1.0 

2021-08-18:15:31:06,145 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:06,158 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:06,161 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:06,162 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8326, Top-1 Accuracy: 508.0/1033 (0.4918), Top-5 Accuracy: 1.0
2021-08-18:15:31:06,163 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 129.6613, eval_time 0.6289, test_loss 1.8326, test_accuracy 0.4918, test_5_accuracy 1.0 

2021-08-18:15:31:06,175 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:06,230 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:06,251 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:06,758 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:06,778 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:07,991 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:08,12 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:08,173 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:08,200 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:08,717 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:08,732 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:08,820 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:08,847 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:09,207 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:09,226 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:09,249 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:09,263 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:09,735 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:09,744 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:09,758 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:09,772 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:10,208 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:10,217 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:10,277 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:10,291 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:10,369 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:10,395 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:10,692 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:10,719 INFO     [learner.py:606] ====Pushing takes 0.02482461929321289 s
2021-08-18:15:31:10,758 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:10,768 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:10,769 INFO     [param_server.py:410] Lock worker 2 with localStep 11 , while globalStep is 10

2021-08-18:15:31:11,724 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:11,745 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:11,897 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:11,918 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:12,508 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:12,533 INFO     [learner.py:606] ====Pushing takes 0.022655725479125977 s
2021-08-18:15:31:12,569 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:12,577 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:12,577 INFO     [param_server.py:410] Lock worker 3 with localStep 11 , while globalStep is 10

2021-08-18:15:31:13,661 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:13,675 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:14,233 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:14,242 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:14,849 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:14,859 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:15,428 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:15,457 INFO     [learner.py:606] ====Pushing takes 0.027378082275390625 s
2021-08-18:15:31:15,497 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:15,504 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:15,505 INFO     [param_server.py:381] ====After aggregation in epoch: 10, virtual_clock: 358.8421882001208, top_1: : 48.6286 % (1507.0), top_5: : 100.0 % (3099.0), test loss: 1.948346146830806, test len: 3099.0
2021-08-18:15:31:15,505 INFO     [param_server.py:410] Lock worker 1 with localStep 11 , while globalStep is 11

2021-08-18:15:31:15,506 INFO     [param_server.py:441] ====Epoch 12 completes 20 clients with loss 3.7029615040531523, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:15,506 INFO     [param_server.py:450] ====Start to sample for epoch 12, global virtualClock: 358.8421882001208, round_duration: 20.356170375151418
2021-08-18:15:31:15,507 INFO     [oort.py:208] Training selector: Pacer 10: lastExploitationUtil 258.1197336257172, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:15,507 INFO     [oort.py:321] scores are 26,{5: 0.016854035865970837, 6: 0.0815215348087001, 7: 0.1446810129476422, 11: 0.04360261032972377, 14: 0.00968895726789852, 16: 0.9911354071258689, 17: 0.021060725252962764, 25: 0.003265461772842048, 27: 0.04147731153962834, 35: 0.004692870000229721, 37: 0.1832910433191574, 38: 0.02709341791900218, 49: 0.027371960307117745, 50: 0.020084096142061813, 51: 0.3459449684135229, 53: 0.309625815090003, 55: 0.1446810129476422, 58: 0.006153938834857957, 59: 0.006368201885573961, 60: 0.0027461160760387663, 65: 0.025517434797913404, 67: 0.005157164104522804, 70: 0.012100963104978988, 71: 0.1131493990241151, 76: 0.0036599574392236944, 81: 0.17119860897282602, 82: 1.064953031217832, 83: 0.09403564004468912, 84: 0.19091485630654667, 85: 0.02690496247540704, 86: 0.0027020491449873604, 87: 0.016899560604207896, 88: 0.003908316224242336, 96: 0.0073773088445606575, 97: 0.14313076746892134, 98: 0.40258906995822696, 99: 0.1313783664413671, 104: 0.005706215831799931, 105: 0.025330878985525464, 106: 0.02201989263375693, 107: 0.011620076360099567, 110: 0.034847070536305445, 111: 0.014455887124663221, 119: 0.008018001942246679},[82, 16, 98, 51, 53, 84, 37, 81, 7, 55, 97, 99, 71, 83, 6, 11, 27, 110, 49, 38, 85, 65, 105, 106, 17, 50, 87, 5, 111, 70, 107, 14, 119, 96, 59, 58, 104, 67, 35, 88, 76, 25, 60, 86]
2021-08-18:15:31:15,508 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:31:15,509 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:15,509 INFO     [oort.py:398] At round 10, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 222.42696483453875, 'duration': 13.73645665746006, 'time_stamp': 11, 'count': 8, 'status': True, 'gradient': 11.321806858228838}, [0.2884778276635384, -2.72752068369852e-05]), ({'reward': 709.5415435030976, 'duration': 6.342067858842259, 'time_stamp': 11, 'count': 10, 'status': True, 'gradient': 54.9869711019081}, [0.9202720312403251, -2.72752068369852e-05]), ({'reward': 214.4874052850009, 'duration': 13.298442137908651, 'time_stamp': 11, 'count': 8, 'status': True, 'gradient': 12.939850459023319}, [0.2781801114341011, -2.72752068369852e-05])]
2021-08-18:15:31:15,510 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 87, 110, 71, 5, 27]
2021-08-18:15:31:15,789 INFO     [param_server.py:553] For epoch: 12, median_reward: 278.13665487626093, dev: 278.13665487626093
2021-08-18:15:31:16,544 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0856, Top-1 Accuracy: 540.0/1033 (0.5227), Top-5 Accuracy: 1.0
2021-08-18:15:31:16,545 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 140.0456, eval_time 0.7276, test_loss 2.0856, test_accuracy 0.5227, test_5_accuracy 1.0 

2021-08-18:15:31:16,546 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3586, Top-1 Accuracy: 537.0/1033 (0.5198), Top-5 Accuracy: 1.0
2021-08-18:15:31:16,547 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 140.0455, eval_time 0.7336, test_loss 2.3586, test_accuracy 0.5198, test_5_accuracy 1.0 

2021-08-18:15:31:16,574 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1044, Top-1 Accuracy: 536.0/1033 (0.5189), Top-5 Accuracy: 1.0
2021-08-18:15:31:16,575 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 140.0752, eval_time 0.7614, test_loss 2.1044, test_accuracy 0.5189, test_5_accuracy 1.0 

2021-08-18:15:31:16,611 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:16,612 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:16,625 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:16,627 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:16,641 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:16,660 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:17,349 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:17,370 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:18,662 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:18,676 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:19,253 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:19,267 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:19,709 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:19,736 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:19,915 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:19,925 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:19,990 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:19,999 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:20,371 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:20,380 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:20,507 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:20,516 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:20,990 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:20,999 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:21,399 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:21,425 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:21,846 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:21,856 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:22,645 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:22,660 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:22,866 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:22,893 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:23,246 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:23,255 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:31:23,516 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:23,525 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:23,877 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:31:23,908 INFO     [learner.py:606] ====Pushing takes 0.029264450073242188 s
2021-08-18:15:31:23,950 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:23,957 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:23,958 INFO     [param_server.py:410] Lock worker 3 with localStep 12 , while globalStep is 11

2021-08-18:15:31:24,48 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:24,77 INFO     [learner.py:606] ====Pushing takes 0.02709484100341797 s
2021-08-18:15:31:24,106 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:24,114 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:31:24,114 INFO     [param_server.py:410] Lock worker 2 with localStep 12 , while globalStep is 11

2021-08-18:15:31:25,635 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:25,653 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:26,164 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:26,177 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:26,791 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:26,815 INFO     [learner.py:606] ====Pushing takes 0.022974491119384766 s
2021-08-18:15:31:26,851 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:26,857 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:26,858 INFO     [param_server.py:381] ====After aggregation in epoch: 11, virtual_clock: 383.23873146527274, top_1: : 52.049 % (1613.0), top_5: : 100.0 % (3099.0), test loss: 2.1828593810399375, test len: 3099.0
2021-08-18:15:31:26,860 INFO     [param_server.py:410] Lock worker 1 with localStep 12 , while globalStep is 12

2021-08-18:15:31:26,860 INFO     [param_server.py:441] ====Epoch 13 completes 20 clients with loss 4.7354708216970955, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:26,860 INFO     [param_server.py:450] ====Start to sample for epoch 13, global virtualClock: 383.23873146527274, round_duration: 24.39654326515194
2021-08-18:15:31:26,861 INFO     [oort.py:208] Training selector: Pacer 11: lastExploitationUtil 344.3396566539146, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:26,862 INFO     [oort.py:321] scores are 26,{5: 0.08640421596352144, 6: 0.22916013245764075, 7: 0.14135934313063328, 11: 0.042097036712612355, 14: 0.009041822439907594, 16: 0.7823356206456915, 17: 0.013073232169756185, 25: 0.0032257703619054507, 27: 0.05046385988218432, 35: 0.0044441495025019356, 37: 0.1586768822570524, 38: 0.053485457921818226, 49: 0.024311333902271182, 50: 0.01874265993351247, 51: 0.21232756707214234, 53: 0.46890420906306995, 55: 0.14135934313063328, 58: 0.005734967946665708, 59: 0.005934643595219576, 60: 0.002559155704424424, 65: 0.023813100644905112, 67: 0.004811788019278778, 70: 0.009645233739758395, 71: 0.05223638051010508, 76: 0.0033984219231915007, 81: 0.20318071901311374, 82: 0.7498804421014396, 83: 0.06357329828160878, 84: 0.06382142493851432, 85: 0.026068621238417893, 86: 0.002518088926890622, 87: 0.06501331601571844, 88: 0.0036290333316136656, 96: 0.007071068239416817, 97: 0.35722745849660403, 98: 0.28419025772363743, 99: 0.15318821662033538, 104: 0.005317726706473571, 105: 0.02249847837514931, 106: 0.02485968357565731, 107: 0.01084396021998107, 110: 0.06640955469801882, 111: 0.010405810567680241, 119: 0.00818226263958511},[16, 82, 53, 97, 98, 6, 51, 81, 37, 99, 7, 55, 5, 110, 87, 84, 83, 38, 71, 27, 11, 85, 106, 49, 65, 105, 50, 17, 107, 111, 70, 14, 119, 96, 59, 58, 104, 67, 35, 88, 76, 25, 60, 86]
2021-08-18:15:31:26,863 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:31:26,863 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:26,864 INFO     [oort.py:398] At round 11, UCB exploited 44, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 228.46723504258054, 'duration': 11.90395711384456, 'time_stamp': 12, 'count': 10, 'status': True, 'gradient': 20.323606717252133}, [0.2653444942766442, -2.5002083506958932e-05]), ({'reward': 427.33494192456874, 'duration': 27.689063957948644, 'time_stamp': 12, 'count': 9, 'status': True, 'gradient': 19.921415842708633}, [0.49632185330380885, -2.5002083506958932e-05]), ({'reward': 551.8800318163269, 'duration': 7.864087706209871, 'time_stamp': 12, 'count': 10, 'status': True, 'gradient': 21.33510986894394}, [0.640976289129682, -2.5002083506958932e-05])]
2021-08-18:15:31:26,865 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:27,266 INFO     [param_server.py:553] For epoch: 13, median_reward: 290.85317775866093, dev: 290.85317775866093
2021-08-18:15:31:27,937 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9368, Top-1 Accuracy: 497.0/1033 (0.4811), Top-5 Accuracy: 1.0
2021-08-18:15:31:27,938 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 151.4385, eval_time 0.644, test_loss 1.9368, test_accuracy 0.4811, test_5_accuracy 1.0 

2021-08-18:15:31:27,948 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8882, Top-1 Accuracy: 521.0/1033 (0.5044), Top-5 Accuracy: 1.0
2021-08-18:15:31:27,952 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 151.451, eval_time 0.6727, test_loss 1.8882, test_accuracy 0.5044, test_5_accuracy 1.0 

2021-08-18:15:31:27,978 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2035, Top-1 Accuracy: 506.0/1033 (0.4898), Top-5 Accuracy: 1.0
2021-08-18:15:31:27,981 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 151.4816, eval_time 0.6892, test_loss 2.2035, test_accuracy 0.4898, test_5_accuracy 1.0 

2021-08-18:15:31:28,6 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:28,24 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:28,40 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:28,53 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:28,55 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:28,74 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:28,721 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:28,742 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:29,701 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:29,715 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:30,321 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:30,334 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:30,366 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:30,379 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:30,881 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:30,892 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:30,932 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:30,942 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:31,280 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:31,301 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:31,337 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:31,346 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:31,423 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:31,432 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:31,942 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:31,951 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:32,446 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:32,455 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:32,489 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:32,516 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:32,989 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:32,998 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:33,446 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:33,456 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:33,534 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:33,559 INFO     [learner.py:606] ====Pushing takes 0.024303436279296875 s
2021-08-18:15:31:33,601 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:33,611 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:33,612 INFO     [param_server.py:410] Lock worker 2 with localStep 13 , while globalStep is 12

2021-08-18:15:31:34,5 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:34,30 INFO     [learner.py:606] ====Pushing takes 0.023703575134277344 s
2021-08-18:15:31:34,57 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:34,63 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:34,64 INFO     [param_server.py:410] Lock worker 3 with localStep 13 , while globalStep is 12

2021-08-18:15:31:35,97 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:35,124 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:35,717 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:35,737 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:36,331 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:36,351 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:36,936 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:36,964 INFO     [learner.py:606] ====Pushing takes 0.026779890060424805 s
2021-08-18:15:31:37,5 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:37,12 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:37,13 INFO     [param_server.py:381] ====After aggregation in epoch: 12, virtual_clock: 404.2669628703059, top_1: : 49.1772 % (1524.0), top_5: : 100.0 % (3099.0), test loss: 2.0094923973083496, test len: 3099.0
2021-08-18:15:31:37,14 INFO     [param_server.py:410] Lock worker 1 with localStep 13 , while globalStep is 13

2021-08-18:15:31:37,14 INFO     [param_server.py:441] ====Epoch 14 completes 20 clients with loss 3.139272641761777, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:37,15 INFO     [param_server.py:450] ====Start to sample for epoch 14, global virtualClock: 404.2669628703059, round_duration: 21.0282314050332
2021-08-18:15:31:37,15 INFO     [oort.py:208] Training selector: Pacer 12: lastExploitationUtil 391.0004922861788, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:37,16 INFO     [oort.py:321] scores are 26,{5: 0.04600081746472033, 6: 0.21084831065131154, 7: 0.3765762560811673, 11: 0.10923695959209073, 14: 0.00791372800507602, 16: 0.4325672134171231, 17: 0.011250456304831813, 25: 0.003121087755887211, 27: 0.043582959631495, 35: 0.003997701375176884, 37: 0.2669416434002839, 38: 0.02589021445049885, 49: 0.0226273924353209, 50: 0.02110369064200895, 51: 0.24682408559521146, 53: 0.24193489609317026, 55: 0.13825581044548446, 58: 0.005006192260793057, 59: 0.005180493964962193, 60: 0.0022339489253994163, 65: 0.026812859595160034, 67: 0.0042099074577830135, 70: 0.008300417167689995, 71: 0.06657251803381371, 76: 0.002945908025489729, 81: 0.09822437711063166, 82: 1.0065923089961952, 83: 0.19377029773509724, 84: 0.2848906652477454, 85: 0.037949005198556866, 86: 0.0021981007418040814, 87: 0.01683683624843823, 88: 0.0031458125735990316, 96: 0.006500124988498311, 97: 0.35625610245340145, 98: 0.34329535945226775, 99: 0.1338638501121903, 104: 0.004641972288343517, 105: 0.019361558381131495, 106: 0.02313776028684915, 107: 0.009491023767512903, 110: 0.03661321122597924, 111: 0.008954948216927982, 119: 0.008329392829991551},[82, 16, 7, 97, 98, 84, 37, 51, 53, 6, 83, 55, 99, 11, 81, 71, 5, 27, 85, 110, 65, 38, 106, 49, 50, 105, 87, 17, 107, 111, 119, 70, 14, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:31:37,31 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:31:37,31 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:37,32 INFO     [oort.py:398] At round 12, UCB exploited 44, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 254.92545075128152, 'duration': 5.8943907365129, 'time_stamp': 13, 'count': 10, 'status': True, 'gradient': 20.631814095777873}, [0.23832045498468246, -2.3078698361412436e-05]), ({'reward': 928.8115106778638, 'duration': 6.342067858842259, 'time_stamp': 13, 'count': 12, 'status': True, 'gradient': 56.63560160956608}, [0.8683365078997103, -2.3078698361412436e-05]), ({'reward': 679.3154133510998, 'duration': 13.411352670399307, 'time_stamp': 13, 'count': 10, 'status': True, 'gradient': 12.946905142257117}, [0.6350826155834981, -2.3078698361412436e-05])]
2021-08-18:15:31:37,33 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 11, 87, 85, 110, 71, 5]
2021-08-18:15:31:37,306 INFO     [param_server.py:553] For epoch: 14, median_reward: 306.75521790610674, dev: 306.75521790610674
2021-08-18:15:31:38,18 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8458, Top-1 Accuracy: 524.0/1033 (0.5073), Top-5 Accuracy: 1.0
2021-08-18:15:31:38,21 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 161.5199, eval_time 0.6804, test_loss 2.8458, test_accuracy 0.5073, test_5_accuracy 1.0 

2021-08-18:15:31:38,58 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8366, Top-1 Accuracy: 478.0/1033 (0.4627), Top-5 Accuracy: 1.0
2021-08-18:15:31:38,60 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 161.5599, eval_time 0.7093, test_loss 2.8366, test_accuracy 0.4627, test_5_accuracy 1.0 

2021-08-18:15:31:38,84 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:31:38,96 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6584, Top-1 Accuracy: 507.0/1033 (0.4908), Top-5 Accuracy: 1.0
2021-08-18:15:31:38,99 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 161.6, eval_time 0.7485, test_loss 2.6584, test_accuracy 0.4908, test_5_accuracy 1.0 

2021-08-18:15:31:38,100 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:38,125 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:31:38,145 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:38,153 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:31:38,176 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:38,782 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:38,802 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:40,300 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:40,320 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:40,588 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:40,608 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:40,784 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:40,798 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:41,220 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:41,230 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:41,669 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:41,679 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:42,70 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:42,90 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:42,317 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:42,327 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:42,383 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:42,392 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:42,934 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:42,943 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:43,541 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:43,562 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:43,622 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:43,632 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:44,685 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:44,695 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:45,303 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:45,312 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:45,353 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:45,379 INFO     [learner.py:606] ====Pushing takes 0.02511310577392578 s
2021-08-18:15:31:45,415 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:45,421 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:31:45,421 INFO     [param_server.py:410] Lock worker 3 with localStep 14 , while globalStep is 13

2021-08-18:15:31:45,940 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:45,966 INFO     [learner.py:606] ====Pushing takes 0.024464130401611328 s
2021-08-18:15:31:45,995 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:46,2 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:46,2 INFO     [param_server.py:410] Lock worker 2 with localStep 14 , while globalStep is 13

2021-08-18:15:31:46,79 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:46,99 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:46,647 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:46,673 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:47,304 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:47,331 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:47,912 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:47,947 INFO     [learner.py:606] ====Pushing takes 0.031584978103637695 s
2021-08-18:15:31:47,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:47,995 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:47,996 INFO     [param_server.py:381] ====After aggregation in epoch: 13, virtual_clock: 426.9170227485898, top_1: : 48.6931 % (1509.0), top_5: : 100.0 % (3099.0), test loss: 2.780253065956963, test len: 3099.0
2021-08-18:15:31:47,997 INFO     [param_server.py:410] Lock worker 1 with localStep 14 , while globalStep is 14

2021-08-18:15:31:47,997 INFO     [param_server.py:441] ====Epoch 15 completes 20 clients with loss 7.833001270513469, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:47,997 INFO     [param_server.py:450] ====Start to sample for epoch 15, global virtualClock: 426.9170227485898, round_duration: 22.65005987828387
2021-08-18:15:31:47,998 INFO     [oort.py:208] Training selector: Pacer 13: lastExploitationUtil 373.084279765282, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:47,999 INFO     [oort.py:321] scores are 26,{5: 0.017698928101161183, 6: 0.0762669200911361, 7: 0.13536723975335188, 11: 0.03088575556357092, 14: 0.006678337939105001, 16: 1.1353553354656216, 17: 0.009258913765859906, 25: 0.0029993007427357057, 27: 0.033938586777119015, 35: 0.0035061976069160838, 37: 0.05727557730690493, 38: 0.026303891104280528, 49: 0.017620228827945762, 50: 0.016433703498504853, 51: 0.15345893868531013, 53: 0.14157026616449894, 55: 0.13535534235310853, 58: 0.004208419298318484, 59: 0.0043549447646494535, 60: 0.0018779529988765193, 65: 0.020879503590560355, 67: 0.0035508176881152154, 70: 0.006831087086067633, 71: 0.04335997206634963, 76: 0.002451038921760575, 81: 0.15780236161112746, 82: 0.5462528106622135, 83: 0.07935857731419184, 84: 0.21451118289183235, 85: 0.04978007012980521, 86: 0.001847817482741074, 87: 0.07601928676179309, 88: 0.002617362453864537, 96: 0.00586740630318364, 97: 0.23420356539295226, 98: 0.20382261235960447, 99: 0.06696475976281822, 104: 0.0039022404140407053, 105: 0.016306317820499582, 106: 0.018017658551943355, 107: 0.00800940644748882, 110: 0.04298631732272288, 111: 0.00736975381902224, 119: 0.008462480841834328},[16, 82, 97, 84, 98, 81, 51, 53, 7, 55, 83, 6, 87, 99, 37, 85, 71, 110, 27, 11, 38, 65, 106, 5, 49, 50, 105, 17, 119, 107, 111, 70, 14, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:31:48,0 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:31:48,0 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:48,1 INFO     [oort.py:398] At round 13, UCB exploited 44, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 84.91865574181833, 'duration': 29.570969934622333, 'time_stamp': 14, 'count': 9, 'status': True, 'gradient': 8.093666696616857}, [0.058480732073165516, -2.14301021501536e-05]), ({'reward': 493.3245401974526, 'duration': 13.298442137908651, 'time_stamp': 14, 'count': 11, 'status': True, 'gradient': 14.568568199658262}, [0.3397697488924594, -2.14301021501536e-05]), ({'reward': 889.9377780517794, 'duration': 15.972045438625893, 'time_stamp': 14, 'count': 11, 'status': True, 'gradient': 16.18814170670114}, [0.6129365958448804, -2.14301021501536e-05])]
2021-08-18:15:31:48,1 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:48,264 INFO     [param_server.py:553] For epoch: 15, median_reward: 300.0039320877585, dev: 300.0039320877585
2021-08-18:15:31:48,890 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6551, Top-1 Accuracy: 473.0/1033 (0.4579), Top-5 Accuracy: 1.0
2021-08-18:15:31:48,893 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 172.3939, eval_time 0.5825, test_loss 2.6551, test_accuracy 0.4579, test_5_accuracy 1.0 

2021-08-18:15:31:48,927 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5512, Top-1 Accuracy: 486.0/1033 (0.4705), Top-5 Accuracy: 1.0
2021-08-18:15:31:48,928 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 172.4267, eval_time 0.6182, test_loss 2.5512, test_accuracy 0.4705, test_5_accuracy 1.0 

2021-08-18:15:31:48,941 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6805, Top-1 Accuracy: 459.0/1033 (0.4443), Top-5 Accuracy: 1.0
2021-08-18:15:31:48,942 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 172.4422, eval_time 0.6247, test_loss 2.6805, test_accuracy 0.4443, test_5_accuracy 1.0 

2021-08-18:15:31:48,959 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:31:48,976 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:48,990 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:31:48,994 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:31:49,14 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:49,27 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:49,662 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:49,682 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:50,992 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:51,25 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:51,50 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:51,71 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:51,503 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:51,525 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:51,583 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:51,597 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:52,135 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:52,145 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:52,337 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:52,357 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:52,704 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:52,718 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:52,729 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:52,739 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:52,990 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:53,3 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:53,384 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:53,393 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:53,585 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:53,599 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:53,941 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:53,966 INFO     [learner.py:606] ====Pushing takes 0.02385234832763672 s
2021-08-18:15:31:54,21 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:54,31 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:54,31 INFO     [param_server.py:410] Lock worker 2 with localStep 15 , while globalStep is 14

2021-08-18:15:31:54,32 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:54,46 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:55,223 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:55,232 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:55,738 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:55,751 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:55,759 INFO     [learner.py:606] ====Pushing takes 0.01959061622619629 s
2021-08-18:15:31:55,761 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:55,787 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:55,794 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:55,794 INFO     [param_server.py:410] Lock worker 3 with localStep 15 , while globalStep is 14

2021-08-18:15:31:56,310 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:56,329 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:56,916 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:56,930 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:57,438 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:57,467 INFO     [learner.py:606] ====Pushing takes 0.02509140968322754 s
2021-08-18:15:31:57,511 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:57,518 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:57,518 INFO     [param_server.py:381] ====After aggregation in epoch: 14, virtual_clock: 447.2731931237412, top_1: : 45.7567 % (1418.0), top_5: : 100.0 % (3099.0), test loss: 2.6289433903164334, test len: 3099.0
2021-08-18:15:31:57,520 INFO     [param_server.py:410] Lock worker 1 with localStep 15 , while globalStep is 15

2021-08-18:15:31:57,520 INFO     [param_server.py:441] ====Epoch 16 completes 20 clients with loss 5.842459737465828, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:57,520 INFO     [param_server.py:450] ====Start to sample for epoch 16, global virtualClock: 447.2731931237412, round_duration: 20.356170375151418
2021-08-18:15:31:57,521 INFO     [oort.py:208] Training selector: Pacer 14: lastExploitationUtil 341.9118009957985, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:57,522 INFO     [oort.py:321] scores are 26,{5: 0.0388123190590713, 6: 0.07473768091102129, 7: 0.5495554095717937, 11: 0.0989627279222833, 14: 0.007591263670849379, 16: 0.6424000398803379, 17: 0.010694554014713824, 25: 0.003145318886093483, 27: 0.03677229727609782, 35: 0.003889729883134044, 37: 0.1124893608805955, 38: 0.045024671912678775, 49: 0.019091434089144845, 50: 0.017805839540781482, 51: 0.07318759621453824, 53: 0.28758715450533456, 55: 0.13264131256775885, 58: 0.00479546157504518, 59: 0.004962426222278999, 60: 0.002139913066516806, 65: 0.02262284278516483, 67: 0.004037580178356699, 70: 0.00789028083300001, 71: 0.04490274823482956, 76: 0.002811372074164363, 81: 0.11798689456324696, 82: 0.37249665701162626, 83: 0.2480967951423052, 84: 0.3759739537540761, 85: 0.06048885138887439, 86: 0.0021055738765674054, 87: 0.03628587228859253, 88: 0.003002147230479541, 96: 0.006393530223472518, 97: 0.13084213055821553, 98: 0.07126361272546301, 99: 0.027687122423804948, 104: 0.004446573080205573, 105: 0.017667817764828068, 106: 0.02096034469686654, 107: 0.00910428863353342, 110: 0.11795581620220637, 111: 0.008512470499865048, 119: 0.008583861784819872},[16, 7, 84, 82, 53, 83, 55, 97, 81, 110, 37, 11, 6, 51, 98, 85, 38, 71, 5, 27, 87, 99, 65, 106, 49, 50, 105, 17, 107, 119, 111, 70, 14, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:31:57,537 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:31:57,537 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:57,538 INFO     [oort.py:398] At round 14, UCB exploited 44, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 280.4482114542763, 'duration': 6.342067858842259, 'time_stamp': 15, 'count': 14, 'status': True, 'gradient': 55.05242508316338}, [0.23985535299674415, -2.0001333422228165e-05]), ({'reward': 596.0185070950057, 'duration': 7.864087706209871, 'time_stamp': 15, 'count': 13, 'status': True, 'gradient': 21.354762742271358}, [0.5097587358654557, -2.0001333422228165e-05]), ({'reward': 818.5777148257748, 'duration': 13.298442137908651, 'time_stamp': 15, 'count': 12, 'status': True, 'gradient': 12.955286274363608}, [0.7001108820747518, -2.0001333422228165e-05])]
2021-08-18:15:31:57,538 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:57,814 INFO     [param_server.py:553] For epoch: 16, median_reward: 296.3588333331784, dev: 296.3588333331784
2021-08-18:15:31:58,479 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3573, Top-1 Accuracy: 503.0/1033 (0.4869), Top-5 Accuracy: 1.0
2021-08-18:15:31:58,480 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 181.9782, eval_time 0.6425, test_loss 3.3573, test_accuracy 0.4869, test_5_accuracy 1.0 

2021-08-18:15:31:58,477 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1634, Top-1 Accuracy: 499.0/1033 (0.4831), Top-5 Accuracy: 1.0
2021-08-18:15:31:58,481 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 181.9812, eval_time 0.6431, test_loss 3.1634, test_accuracy 0.4831, test_5_accuracy 1.0 

2021-08-18:15:31:58,512 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4508, Top-1 Accuracy: 471.0/1033 (0.456), Top-5 Accuracy: 1.0
2021-08-18:15:31:58,521 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 182.0215, eval_time 0.6838, test_loss 3.4508, test_accuracy 0.456, test_5_accuracy 1.0 

2021-08-18:15:31:58,547 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:31:58,564 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:58,565 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:31:58,582 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:58,607 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:31:58,621 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:59,234 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:59,254 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:59,923 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:59,945 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:00,579 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:00,592 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:00,933 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:00,953 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:01,170 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:01,181 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:01,257 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:01,267 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:01,681 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:01,691 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:01,739 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:01,748 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:02,212 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:02,221 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:02,227 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:02,241 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:02,295 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:02,323 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:02,913 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:02,922 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:03,621 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:03,648 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:03,687 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:03,714 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:04,109 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:04,136 INFO     [learner.py:606] ====Pushing takes 0.025468111038208008 s
2021-08-18:15:32:04,195 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:04,202 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:04,202 INFO     [param_server.py:410] Lock worker 2 with localStep 16 , while globalStep is 15

2021-08-18:15:32:04,220 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:04,241 INFO     [learner.py:606] ====Pushing takes 0.019791603088378906 s
2021-08-18:15:32:04,266 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:04,272 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:04,273 INFO     [param_server.py:410] Lock worker 3 with localStep 16 , while globalStep is 15

2021-08-18:15:32:05,688 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:05,715 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:06,270 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:06,291 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:06,877 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:06,891 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:07,492 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:07,527 INFO     [learner.py:606] ====Pushing takes 0.03184676170349121 s
2021-08-18:15:32:07,566 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:07,573 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:07,574 INFO     [param_server.py:381] ====After aggregation in epoch: 15, virtual_clock: 465.4813914509042, top_1: : 47.5315 % (1473.0), top_5: : 100.0 % (3099.0), test loss: 3.3238618197264493, test len: 3099.0
2021-08-18:15:32:07,576 INFO     [param_server.py:410] Lock worker 1 with localStep 16 , while globalStep is 16

2021-08-18:15:32:07,576 INFO     [param_server.py:441] ====Epoch 17 completes 20 clients with loss 13.683469299643777, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:07,576 INFO     [param_server.py:450] ====Start to sample for epoch 17, global virtualClock: 465.4813914509042, round_duration: 18.208198327163032
2021-08-18:15:32:07,577 INFO     [oort.py:208] Training selector: Pacer 15: lastExploitationUtil 398.9074428227518, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:07,578 INFO     [oort.py:321] scores are 26,{5: 0.025788121686789997, 6: 0.14651232091700261, 7: 0.13009732799144155, 11: 0.021950759345695806, 14: 0.005162614168759321, 16: 1.1300973241726702, 17: 0.006804032748785142, 25: 0.0028676154775841454, 27: 0.024432667252259718, 35: 0.0029095966928298295, 37: 0.1742223876192766, 38: 0.03076682205613843, 49: 0.012684947393039867, 50: 0.011097741889033725, 51: 0.07178389994266661, 53: 0.20323926469496065, 55: 0.15296677361094654, 58: 0.0032288266251200514, 59: 0.003341245396494995, 60: 0.0014408223643303123, 65: 0.015031326052870735, 67: 0.0027420759326108133, 70: 0.005019912855737759, 71: 0.017656412019956352, 76: 0.0018421761069776631, 81: 0.09404471995899236, 82: 0.34572229512030705, 83: 0.058508451262376436, 84: 0.10873503574464599, 85: 0.014211365493744259, 86: 0.0014177014845028818, 87: 0.031102906216365918, 88: 0.0019671831944416056, 96: 0.005109652976727944, 97: 0.1420300790061337, 98: 0.1192430732839462, 99: 0.0581034796308068, 104: 0.0029939169206615037, 105: 0.011739052071739779, 106: 0.012971060314192408, 107: 0.006191581735784324, 110: 0.01768117198471701, 111: 0.005415759083965791, 119: 0.008695341660384957},[16, 82, 53, 37, 55, 6, 97, 7, 98, 84, 81, 51, 83, 99, 87, 38, 5, 27, 11, 110, 71, 65, 85, 106, 49, 105, 50, 119, 17, 107, 111, 14, 96, 70, 59, 58, 104, 35, 25, 67, 88, 76, 60, 86]
2021-08-18:15:32:07,579 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:32:07,579 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:07,580 INFO     [oort.py:398] At round 15, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 398.9089770821473, 'duration': 29.570969934622333, 'time_stamp': 16, 'count': 11, 'status': True, 'gradient': 16.76215696453046}, [0.1523304063886591, -1.875117194824678e-05]), ({'reward': 398.9089770821473, 'duration': 41.695355953560366, 'time_stamp': 16, 'count': 11, 'status': True, 'gradient': 16.76215696453046}, [0.1523304063886591, -1.875117194824678e-05]), ({'reward': 2618.6532178293, 'duration': 7.864087706209871, 'time_stamp': 16, 'count': 14, 'status': True, 'gradient': 21.364196840100103}, [1.0, -1.875117194824678e-05])]
2021-08-18:15:32:07,580 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 11, 87, 85, 110, 71, 5]
2021-08-18:15:32:07,858 INFO     [param_server.py:553] For epoch: 17, median_reward: 308.44816490318937, dev: 308.44816490318937
2021-08-18:15:32:08,471 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1603, Top-1 Accuracy: 537.0/1033 (0.5198), Top-5 Accuracy: 1.0
2021-08-18:15:32:08,472 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 191.9701, eval_time 0.5909, test_loss 2.1603, test_accuracy 0.5198, test_5_accuracy 1.0 

2021-08-18:15:32:08,482 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1972, Top-1 Accuracy: 541.0/1033 (0.5237), Top-5 Accuracy: 1.0
2021-08-18:15:32:08,482 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 191.9829, eval_time 0.5965, test_loss 2.1972, test_accuracy 0.5237, test_5_accuracy 1.0 

2021-08-18:15:32:08,525 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2672, Top-1 Accuracy: 551.0/1033 (0.5334), Top-5 Accuracy: 1.0
2021-08-18:15:32:08,528 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 192.0285, eval_time 0.6475, test_loss 2.2672, test_accuracy 0.5334, test_5_accuracy 1.0 

2021-08-18:15:32:08,539 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:08,548 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:08,556 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:08,561 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:08,605 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:08,630 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:09,334 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:09,354 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:10,307 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:10,328 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:11,104 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:11,114 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:11,342 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:11,356 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:11,773 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:11,787 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:11,945 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:12,7 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:12,57 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:12,66 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:12,408 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:12,418 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:13,87 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:13,100 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:13,202 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:13,212 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:13,466 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:13,486 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:14,327 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:14,337 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:14,772 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:14,782 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:14,930 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:14,939 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:32:15,328 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:15,349 INFO     [learner.py:606] ====Pushing takes 0.01978778839111328 s
2021-08-18:15:32:15,383 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:15,391 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:32:15,408 INFO     [param_server.py:410] Lock worker 3 with localStep 17 , while globalStep is 16

2021-08-18:15:32:15,450 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:32:15,474 INFO     [learner.py:606] ====Pushing takes 0.023336172103881836 s
2021-08-18:15:32:15,504 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:15,511 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:15,511 INFO     [param_server.py:410] Lock worker 2 with localStep 17 , while globalStep is 16

2021-08-18:15:32:16,14 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:16,41 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:16,615 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:16,641 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:17,390 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:17,417 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:18,20 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:18,45 INFO     [learner.py:606] ====Pushing takes 0.02390432357788086 s
2021-08-18:15:32:18,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:18,87 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:18,87 INFO     [param_server.py:381] ====After aggregation in epoch: 16, virtual_clock: 488.13145132918805, top_1: : 52.5653 % (1629.0), top_5: : 100.0 % (3099.0), test loss: 2.2082376877466836, test len: 3099.0
2021-08-18:15:32:18,88 INFO     [param_server.py:410] Lock worker 1 with localStep 17 , while globalStep is 17

2021-08-18:15:32:18,89 INFO     [param_server.py:441] ====Epoch 18 completes 20 clients with loss 3.6913209653005716, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:18,89 INFO     [param_server.py:450] ====Start to sample for epoch 18, global virtualClock: 488.13145132918805, round_duration: 22.65005987828387
2021-08-18:15:32:18,90 INFO     [oort.py:208] Training selector: Pacer 16: lastExploitationUtil 268.32188845547137, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:18,91 INFO     [oort.py:321] scores are 26,{5: 0.011660862789808796, 6: 0.22717817460439518, 7: 0.5931660752425134, 11: 0.10728192255967686, 14: 0.010123780837605048, 16: 0.32097166549079204, 17: 0.014697179227811647, 25: 0.0035192192313930285, 27: 0.057140187339652995, 35: 0.004942369133376393, 37: 0.1500121794461923, 38: 0.046886165180894654, 49: 0.021713366173855775, 50: 0.020251213825876937, 51: 0.27492665203768973, 53: 0.16529614413904728, 55: 0.46372559962882676, 58: 0.006425343687580011, 59: 0.006649056301134366, 60: 0.0028672270017686885, 65: 0.025729762729933197, 67: 0.0053880533670216755, 70: 0.010843357413578994, 71: 0.042548226710695046, 76: 0.003813944403563693, 81: 0.0804387439851253, 82: 0.6946110404792519, 83: 0.058299233261176836, 84: 0.057658094897615184, 85: 0.08442590843566677, 86: 0.002821216603410755, 87: 0.1317226780916537, 88: 0.004072752494621342, 93: 0.22123501803640538, 96: 0.007820457228972443, 97: 0.2505545463343118, 98: 0.36284627012374376, 99: 0.02665737127731096, 104: 0.00595787492510414, 105: 0.02009423675714293, 106: 0.022203117879681957, 107: 0.012141565199760517, 110: 0.07050200290216158, 111: 0.011698412522471497, 119: 0.016156009770463373},[82, 7, 55, 98, 16, 51, 97, 6, 93, 53, 37, 87, 11, 85, 81, 110, 83, 84, 27, 38, 71, 99, 65, 106, 49, 50, 105, 119, 17, 107, 111, 5, 70, 14, 96, 59, 58, 104, 67, 35, 88, 76, 25, 60, 86]
2021-08-18:15:32:18,91 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:32:18,92 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:18,92 INFO     [oort.py:398] At round 16, UCB exploited 45, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 427.5955911177401, 'duration': 6.342067858842259, 'time_stamp': 17, 'count': 16, 'status': True, 'gradient': 61.57123643312607}, [0.5669029928669739, -1.7648096946879243e-05]), ({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 17, 'count': 14, 'status': True, 'gradient': 14.58375811627624}, [1.3258233939239882e-08, -1.7648096946879243e-05]), ({'reward': 520.194303833197, 'duration': 13.411352670399307, 'time_stamp': 17, 'count': 14, 'status': True, 'gradient': 14.58454287207722}, [0.6896725324323782, -1.7648096946879243e-05])]
2021-08-18:15:32:18,93 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 38, 11, 87, 85, 110, 71, 27]
2021-08-18:15:32:18,364 INFO     [param_server.py:553] For epoch: 18, median_reward: 281.37579717246507, dev: 281.37579717246507
2021-08-18:15:32:19,7 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5909, Top-1 Accuracy: 500.0/1033 (0.484), Top-5 Accuracy: 1.0
2021-08-18:15:32:19,8 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 202.5068, eval_time 0.5987, test_loss 2.5909, test_accuracy 0.484, test_5_accuracy 1.0 

2021-08-18:15:32:19,11 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.683, Top-1 Accuracy: 457.0/1033 (0.4424), Top-5 Accuracy: 1.0
2021-08-18:15:32:19,12 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 202.5123, eval_time 0.6008, test_loss 2.683, test_accuracy 0.4424, test_5_accuracy 1.0 

2021-08-18:15:32:19,20 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7305, Top-1 Accuracy: 483.0/1033 (0.4676), Top-5 Accuracy: 1.0
2021-08-18:15:32:19,35 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 202.5357, eval_time 0.6199, test_loss 2.7305, test_accuracy 0.4676, test_5_accuracy 1.0 

2021-08-18:15:32:19,80 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:19,80 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:19,97 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:19,99 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:19,102 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:19,123 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:19,665 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:19,685 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:21,227 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:21,248 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:21,499 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:21,514 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:21,869 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:21,882 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:22,197 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:22,211 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:22,829 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:22,839 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:22,860 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:22,875 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:23,53 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:23,67 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:23,517 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:23,532 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:24,7 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:24,16 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:24,156 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:24,170 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:24,391 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:24,405 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:24,708 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:24,717 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:32:25,124 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:25,135 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:25,177 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:32:25,203 INFO     [learner.py:606] ====Pushing takes 0.025237560272216797 s
2021-08-18:15:32:25,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:25,246 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:32:25,247 INFO     [param_server.py:410] Lock worker 3 with localStep 18 , while globalStep is 17

2021-08-18:15:32:26,227 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:26,253 INFO     [learner.py:606] ====Pushing takes 0.024255037307739258 s
2021-08-18:15:32:26,284 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:26,291 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:26,292 INFO     [param_server.py:410] Lock worker 2 with localStep 18 , while globalStep is 17

2021-08-18:15:32:26,746 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:26,767 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:27,476 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:27,503 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:28,237 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:28,263 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:28,806 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:28,832 INFO     [learner.py:606] ====Pushing takes 0.024951696395874023 s
2021-08-18:15:32:28,874 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:28,881 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:28,882 INFO     [param_server.py:381] ====After aggregation in epoch: 17, virtual_clock: 511.5307259760217, top_1: : 46.4666 % (1440.0), top_5: : 100.0 % (3099.0), test loss: 2.668149594907407, test len: 3099.0
2021-08-18:15:32:28,883 INFO     [param_server.py:410] Lock worker 1 with localStep 18 , while globalStep is 18

2021-08-18:15:32:28,884 INFO     [param_server.py:441] ====Epoch 19 completes 20 clients with loss 4.648348620866531, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 110: 0} 
==========
2021-08-18:15:32:28,884 INFO     [param_server.py:450] ====Start to sample for epoch 19, global virtualClock: 511.5307259760217, round_duration: 23.399274646833632
2021-08-18:15:32:28,885 INFO     [oort.py:208] Training selector: Pacer 17: lastExploitationUtil 431.39574670536547, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:28,886 INFO     [oort.py:321] scores are 26,{5: 0.011787659528173348, 6: 0.07069101616765103, 7: 0.3896046721097171, 11: 0.06409941973084679, 14: 0.007913627937229101, 16: 0.6641308471745274, 17: 0.012359304691360104, 25: 0.0032650262333158986, 27: 0.05761663726358807, 35: 0.0040498803553331904, 37: 0.053088137774223956, 38: 0.049326524081426966, 49: 0.022983695175755908, 50: 0.01547173122867455, 51: 0.20799008601767469, 53: 0.7347967126410223, 55: 0.12545946110355116, 58: 0.004999718688067141, 59: 0.005173795000421619, 60: 0.0022310601768094325, 65: 0.027235068887722695, 67: 0.004209108473002102, 70: 0.008231925712457356, 71: 0.08421329119800723, 76: 0.0029320845034077146, 81: 0.172720258592302, 82: 0.6560572814230472, 83: 0.2788408740166148, 84: 0.1729129873329019, 85: 0.08325246473349832, 86: 0.0021952583489694318, 87: 0.07836940720248128, 88: 0.00313105100969386, 96: 0.006650545350836472, 97: 0.24442500374873524, 98: 0.2089303284730355, 99: 0.026947235568852923, 104: 0.004635969693230337, 105: 0.02126983944901765, 106: 0.023502099546058874, 107: 0.009490903755008955, 110: 0.013065630824429032, 111: 0.008881055854349174, 119: 0.012343034992650633},[53, 16, 82, 7, 83, 97, 98, 51, 84, 81, 55, 71, 85, 87, 6, 11, 27, 37, 38, 65, 99, 106, 49, 105, 50, 110, 17, 119, 5, 107, 111, 70, 14, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:32:28,887 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:32:28,887 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:28,888 INFO     [oort.py:398] At round 17, UCB exploited 44, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 811.3587524728385, 'duration': 28.420902733732795, 'time_stamp': 18, 'count': 15, 'status': True, 'gradient': 20.159361884014878}, [0.726488107548897, -1.6667592644035793e-05]), ({'reward': 1116.8194106115134, 'duration': 11.058674649423494, 'time_stamp': 18, 'count': 15, 'status': True, 'gradient': 14.588153064816497}, [1.0, -1.6667592644035793e-05]), ({'reward': 552.3406838198516, 'duration': 13.324368782156236, 'time_stamp': 18, 'count': 16, 'status': True, 'gradient': 21.067495173548455}, [0.4945612775341927, -1.6667592644035793e-05])]
2021-08-18:15:32:28,888 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:32:29,219 INFO     [param_server.py:553] For epoch: 19, median_reward: 310.64570779418995, dev: 310.64570779418995
2021-08-18:15:32:29,914 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1223, Top-1 Accuracy: 512.0/1033 (0.4956), Top-5 Accuracy: 1.0
2021-08-18:15:32:29,915 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 213.4158, eval_time 0.6622, test_loss 2.1223, test_accuracy 0.4956, test_5_accuracy 1.0 

2021-08-18:15:32:29,920 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3719, Top-1 Accuracy: 530.0/1033 (0.5131), Top-5 Accuracy: 1.0
2021-08-18:15:32:29,921 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 213.4212, eval_time 0.668, test_loss 2.3719, test_accuracy 0.5131, test_5_accuracy 1.0 

2021-08-18:15:32:29,949 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5034, Top-1 Accuracy: 523.0/1033 (0.5063), Top-5 Accuracy: 1.0
2021-08-18:15:32:29,950 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 213.4489, eval_time 0.6974, test_loss 2.5034, test_accuracy 0.5063, test_5_accuracy 1.0 

2021-08-18:15:32:29,986 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:29,989 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:29,998 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:30,4 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:30,52 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:30,69 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:30,527 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:30,540 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:31,622 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:31,636 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:31,775 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:31,789 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:32,304 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:32,318 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:32,460 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:32,487 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:32,806 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:32,820 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:32,880 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:32,894 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:33,441 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:33,456 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:33,503 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:33,530 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:33,664 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:33,691 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:34,49 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:34,59 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:34,92 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:34,113 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:34,524 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:34,545 INFO     [learner.py:606] ====Pushing takes 0.01979541778564453 s
2021-08-18:15:32:34,577 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:34,587 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:34,588 INFO     [param_server.py:410] Lock worker 2 with localStep 19 , while globalStep is 18

2021-08-18:15:32:35,115 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:35,142 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:35,722 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:35,743 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:36,325 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:36,350 INFO     [learner.py:606] ====Pushing takes 0.023956298828125 s
2021-08-18:15:32:36,376 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:36,382 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:36,383 INFO     [param_server.py:410] Lock worker 3 with localStep 19 , while globalStep is 18

2021-08-18:15:32:37,134 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:37,153 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:37,769 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:37,784 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:38,361 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:38,379 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:38,914 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:38,942 INFO     [learner.py:606] ====Pushing takes 0.02571392059326172 s
2021-08-18:15:32:38,986 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:38,993 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:38,994 INFO     [param_server.py:381] ====After aggregation in epoch: 18, virtual_clock: 531.8868963511732, top_1: : 50.5002 % (1565.0), top_5: : 100.0 % (3099.0), test loss: 2.33251361935227, test len: 3099.0
2021-08-18:15:32:38,995 INFO     [param_server.py:410] Lock worker 1 with localStep 19 , while globalStep is 19

2021-08-18:15:32:38,995 INFO     [param_server.py:441] ====Epoch 20 completes 20 clients with loss 5.412911245726706, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:38,996 INFO     [param_server.py:450] ====Start to sample for epoch 20, global virtualClock: 531.8868963511732, round_duration: 20.356170375151418
2021-08-18:15:32:38,996 INFO     [oort.py:208] Training selector: Pacer 18: lastExploitationUtil 263.0758581821625, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:38,997 INFO     [oort.py:321] scores are 26,{5: 0.011905970312351055, 6: 0.06949617297220005, 7: 0.1778083752357797, 11: 0.07004622275137733, 14: 0.007800595130572569, 16: 0.15142534703846844, 17: 0.012098912778220706, 25: 0.0032735375850318623, 27: 0.030412271523940704, 35: 0.004012039720964834, 37: 0.05219082431605751, 38: 0.040454445437903955, 49: 0.015789437166273877, 50: 0.015212300726508888, 51: 0.06805479891730266, 53: 0.08052624245078013, 55: 0.123338903336366, 58: 0.004925850877355545, 59: 0.005097355317792296, 60: 0.002198097616091751, 65: 0.018710064053383657, 67: 0.004148702829692157, 70: 0.008088153018959219, 71: 0.040967670024719724, 76: 0.0028849241825786892, 81: 0.16897103871895516, 82: 0.28881879839331714, 83: 0.1379996857846577, 84: 0.16764776611038357, 85: 0.03944274940588335, 86: 0.002162824738540159, 87: 0.04558942850900107, 88: 0.003080690465863151, 96: 0.006613199351874541, 97: 0.3515873461491449, 98: 0.39545893468545684, 99: 0.03616129152658147, 104: 0.00456747605326184, 105: 0.014612045232450407, 106: 0.01614557281674381, 107: 0.009355342227774543, 110: 0.04963885273465862, 111: 0.006758242586894282, 119: 0.01213606657269405},[98, 97, 82, 7, 81, 84, 16, 83, 55, 53, 11, 6, 51, 37, 110, 87, 71, 38, 85, 99, 27, 65, 106, 49, 50, 105, 119, 17, 5, 107, 70, 14, 111, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:32:38,998 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:32:38,998 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:38,999 INFO     [oort.py:398] At round 18, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 407.28046668480863, 'duration': 27.689063957948644, 'time_stamp': 19, 'count': 16, 'status': True, 'gradient': 12.971862312503676}, [0.3533058075786829, -1.5790304752881743e-05]), ({'reward': 884.7487074426107, 'duration': 13.411352670399307, 'time_stamp': 19, 'count': 16, 'status': True, 'gradient': 12.971885396616424}, [0.767507946086899, -1.5790304752881743e-05]), ({'reward': 0.01, 'duration': 13.73645665746006, 'time_stamp': 19, 'count': 16, 'status': True, 'gradient': 11.350570362102498}, [8.674967320356393e-09, -1.5790304752881743e-05])]
2021-08-18:15:32:38,999 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:32:39,278 INFO     [param_server.py:553] For epoch: 20, median_reward: 278.49661033055975, dev: 278.49661033055975
2021-08-18:15:32:39,979 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2615, Top-1 Accuracy: 521.0/1033 (0.5044), Top-5 Accuracy: 1.0
2021-08-18:15:32:39,981 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 223.4809, eval_time 0.6746, test_loss 2.2615, test_accuracy 0.5044, test_5_accuracy 1.0 

2021-08-18:15:32:39,983 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.012, Top-1 Accuracy: 529.0/1033 (0.5121), Top-5 Accuracy: 1.0
2021-08-18:15:32:39,984 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 223.4821, eval_time 0.6803, test_loss 2.012, test_accuracy 0.5121, test_5_accuracy 1.0 

2021-08-18:15:32:40,21 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1661, Top-1 Accuracy: 523.0/1033 (0.5063), Top-5 Accuracy: 1.0
2021-08-18:15:32:40,24 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 223.5241, eval_time 0.7177, test_loss 2.1661, test_accuracy 0.5063, test_5_accuracy 1.0 

2021-08-18:15:32:40,55 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:32:40,65 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:32:40,70 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:40,80 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:40,91 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:32:40,113 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:40,663 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:40,684 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:41,540 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:41,560 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:42,55 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:42,75 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:42,199 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:42,219 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:42,758 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:42,776 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:42,899 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:42,912 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:43,203 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:43,224 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:43,373 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:43,387 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:43,472 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:43,486 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:43,977 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:43,986 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:44,49 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:44,58 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:44,570 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:44,591 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:44,621 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:44,630 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:45,155 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:45,169 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:45,740 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:45,767 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:45,770 INFO     [learner.py:606] ====Pushing takes 0.02830362319946289 s
2021-08-18:15:32:45,800 INFO     [learner.py:606] ====Pushing takes 0.031905412673950195 s
2021-08-18:15:32:45,805 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:45,812 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:45,813 INFO     [param_server.py:410] Lock worker 2 with localStep 20 , while globalStep is 19

2021-08-18:15:32:45,835 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:45,841 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:45,841 INFO     [param_server.py:410] Lock worker 3 with localStep 20 , while globalStep is 19

2021-08-18:15:32:46,645 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:46,666 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:47,326 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:47,346 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:48,29 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:48,56 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:48,559 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:48,588 INFO     [learner.py:606] ====Pushing takes 0.026699542999267578 s
2021-08-18:15:32:48,628 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:48,634 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:48,635 INFO     [param_server.py:381] ====After aggregation in epoch: 19, virtual_clock: 550.4561390654818, top_1: : 50.7583 % (1573.0), top_5: : 100.0 % (3099.0), test loss: 2.146520632284659, test len: 3099.0
2021-08-18:15:32:48,636 INFO     [param_server.py:410] Lock worker 1 with localStep 20 , while globalStep is 20

2021-08-18:15:32:48,636 INFO     [param_server.py:441] ====Epoch 21 completes 20 clients with loss 3.871589588780082, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:48,637 INFO     [param_server.py:450] ====Start to sample for epoch 21, global virtualClock: 550.4561390654818, round_duration: 18.569242714308594
2021-08-18:15:32:48,637 INFO     [oort.py:208] Training selector: Pacer 19: lastExploitationUtil 232.05673877431954, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:48,638 INFO     [oort.py:321] scores are 26,{5: 0.01201681083384507, 6: 0.118171182636362, 7: 0.12133506178256277, 11: 0.020472340074189528, 14: 0.008297064083719137, 16: 1.1213350522142393, 17: 0.013058186496918634, 25: 0.003357438094262583, 27: 0.03254468454313511, 35: 0.004222242707785494, 37: 0.05134289929270501, 38: 0.07481806003650607, 49: 0.015421914584933366, 50: 0.014383421131631777, 51: 0.11603545460347209, 53: 0.23894312181789937, 55: 0.4251445057576913, 58: 0.005244897265132665, 59: 0.005427510014280226, 60: 0.002340467964252202, 65: 0.018274559547077778, 67: 0.004413391633563084, 70: 0.00866203179753888, 71: 0.0119937251701746, 76: 0.0030804510377505276, 81: 0.031207122467737675, 82: 0.2826474641066027, 83: 0.0748506321174021, 84: 0.0680574126997276, 85: 0.056161340152603115, 86: 0.002302910469392954, 87: 0.05987901380529191, 88: 0.0032894854567975997, 96: 0.006904013277364622, 97: 0.04648380552516127, 98: 0.2802731899970421, 99: 0.08777592540809412, 104: 0.004863310574511905, 105: 0.014271928195602173, 106: 0.01576976064963848, 107: 0.008321830899773461, 110: 0.07307015107074044, 111: 0.0072321093438651556, 119: 0.012977674181829265},[16, 55, 82, 98, 53, 7, 6, 51, 99, 83, 38, 110, 84, 87, 85, 37, 97, 27, 81, 11, 65, 106, 49, 50, 105, 17, 119, 5, 71, 70, 107, 14, 111, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:32:48,638 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:48,639 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:48,639 INFO     [oort.py:398] At round 19, UCB exploited 44, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1045.12517001669, 'duration': 7.864087706209871, 'time_stamp': 20, 'count': 18, 'status': True, 'gradient': 21.38777278987969}, [1.0, -1.5000750037501888e-05]), ({'reward': 168.60004039381369, 'duration': 6.342067858842259, 'time_stamp': 20, 'count': 19, 'status': True, 'gradient': 48.6569223139184}, [0.16131241189236328, -1.5000750037501888e-05]), ({'reward': 263.07687001238634, 'duration': 30.380154975061778, 'time_stamp': 19, 'count': 14, 'status': True, 'gradient': 17.065783250133272}, [0.25171089755694226, 0.014985749287464373])]
2021-08-18:15:32:48,640 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 99, 38, 87, 85, 110, 71, 5, 27]
2021-08-18:15:32:48,906 INFO     [param_server.py:541] Handle Wight 0.03796672821044922 | Send 0.26978564262390137
2021-08-18:15:32:48,907 INFO     [param_server.py:553] For epoch: 21, median_reward: 271.77335938599515, dev: 271.77335938599515
2021-08-18:15:32:49,550 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2814, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:32:49,552 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 233.0528, eval_time 0.599, test_loss 2.2814, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:32:49,553 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2595, Top-1 Accuracy: 572.0/1033 (0.5537), Top-5 Accuracy: 1.0
2021-08-18:15:32:49,570 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 233.0704, eval_time 0.6165, test_loss 2.2595, test_accuracy 0.5537, test_5_accuracy 1.0 

2021-08-18:15:32:49,589 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1989, Top-1 Accuracy: 574.0/1033 (0.5557), Top-5 Accuracy: 1.0
2021-08-18:15:32:49,589 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 233.0881, eval_time 0.6372, test_loss 2.1989, test_accuracy 0.5557, test_5_accuracy 1.0 

2021-08-18:15:32:49,623 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:32:49,641 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:49,661 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:32:49,672 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:32:49,678 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:49,694 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:50,317 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:50,337 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:51,550 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:51,571 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:52,94 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:52,114 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:52,763 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:52,777 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:52,816 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:52,837 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:53,46 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:53,73 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:53,362 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:53,376 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:53,777 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:53,804 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:54,163 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:54,183 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:54,722 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:54,736 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:55,437 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:55,450 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:32:55,484 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:55,500 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:55,672 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:55,693 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:56,48 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:32:56,74 INFO     [learner.py:606] ====Pushing takes 0.023934364318847656 s
2021-08-18:15:32:56,108 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:56,117 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:56,118 INFO     [param_server.py:410] Lock worker 2 with localStep 21 , while globalStep is 20

2021-08-18:15:32:56,276 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:56,290 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:32:56,750 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:32:56,777 INFO     [learner.py:606] ====Pushing takes 0.025689363479614258 s
2021-08-18:15:32:56,803 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:56,809 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:56,810 INFO     [param_server.py:410] Lock worker 3 with localStep 21 , while globalStep is 20

2021-08-18:15:32:57,934 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:57,955 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:58,497 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:58,516 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:59,151 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:59,172 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:59,671 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:59,694 INFO     [learner.py:606] ====Pushing takes 0.022042274475097656 s
2021-08-18:15:32:59,726 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:59,734 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:59,735 INFO     [param_server.py:381] ====After aggregation in epoch: 20, virtual_clock: 574.3540480214746, top_1: : 55.7922 % (1729.0), top_5: : 100.0 % (3099.0), test loss: 2.2466091888922226, test len: 3099.0
2021-08-18:15:32:59,736 INFO     [param_server.py:410] Lock worker 1 with localStep 21 , while globalStep is 21

2021-08-18:15:32:59,737 INFO     [param_server.py:441] ====Epoch 22 completes 20 clients with loss 4.5035764887562415, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:59,737 INFO     [param_server.py:450] ====Start to sample for epoch 22, global virtualClock: 574.3540480214746, round_duration: 23.89790895599279
2021-08-18:15:32:59,738 INFO     [oort.py:208] Training selector: Pacer 20: lastExploitationUtil 312.3647717794028, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:59,738 INFO     [oort.py:321] scores are 26,{5: 0.05315135468845666, 6: 0.18737521221531916, 7: 0.11943782433222815, 11: 0.020649888169436813, 14: 0.007925597556183989, 16: 0.11943782433222815, 17: 0.009524344982676158, 25: 0.0033306633337653285, 27: 0.04940475880628971, 35: 0.004078025008954596, 37: 0.13544446781081051, 38: 0.022366299654955242, 49: 0.017711727908415145, 50: 0.016519041139321122, 51: 0.06590229763826108, 53: 0.2779855177178531, 55: 0.11943782433222815, 58: 0.005004578464297378, 59: 0.005178823980556677, 60: 0.002233228789463853, 65: 0.020987927572896126, 67: 0.004215160490144898, 70: 0.008215546187375999, 71: 0.02075688447245887, 76: 0.0029307073196515343, 81: 0.03147776886830627, 82: 0.14436224727715846, 83: 0.08379082179718499, 84: 0.22065775271608376, 85: 0.044965217681007974, 86: 0.0021973921618915495, 87: 0.046799855691999, 88: 0.0031295803724781484, 96: 0.006724053823908251, 97: 0.3503663699459027, 98: 0.2584373952903756, 99: 0.17454340886420772, 104: 0.004640475901824239, 105: 0.016390993967500062, 106: 0.015000525704295506, 107: 0.007915899365391712, 110: 0.07067666437803183, 111: 0.0068649008619582185, 119: 0.013178557707219393},[97, 53, 98, 84, 6, 99, 82, 37, 7, 16, 55, 83, 110, 51, 5, 27, 87, 85, 81, 38, 65, 71, 11, 49, 50, 105, 106, 119, 17, 70, 14, 107, 111, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:32:59,739 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:59,740 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:59,740 INFO     [oort.py:398] At round 20, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 419.6144078280347, 'duration': 13.298442137908651, 'time_stamp': 21, 'count': 18, 'status': True, 'gradient': 14.601758099233217}, [0.3693014285500393, -1.4286394590218595e-05]), ({'reward': 0.01, 'duration': 7.864087706209871, 'time_stamp': 21, 'count': 19, 'status': True, 'gradient': 21.393747622248792}, [8.801180656333652e-09, -1.4286394590218595e-05]), ({'reward': 635.3988628179602, 'duration': 27.689063957948644, 'time_stamp': 21, 'count': 18, 'status': True, 'gradient': 19.976644228944334}, [0.5592172256695302, -1.4286394590218595e-05])]
2021-08-18:15:32:59,741 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:32:59,999 INFO     [param_server.py:553] For epoch: 22, median_reward: 285.0179001257658, dev: 285.0179001257658
2021-08-18:15:33:00,660 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6376, Top-1 Accuracy: 502.0/1033 (0.486), Top-5 Accuracy: 1.0
2021-08-18:15:33:00,663 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 244.1635, eval_time 0.6294, test_loss 2.6376, test_accuracy 0.486, test_5_accuracy 1.0 

2021-08-18:15:33:00,660 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2504, Top-1 Accuracy: 489.0/1033 (0.4734), Top-5 Accuracy: 1.0
2021-08-18:15:33:00,664 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 244.1641, eval_time 0.6256, test_loss 2.2504, test_accuracy 0.4734, test_5_accuracy 1.0 

2021-08-18:15:33:00,715 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0764, Top-1 Accuracy: 522.0/1033 (0.5053), Top-5 Accuracy: 1.0
2021-08-18:15:33:00,716 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 244.215, eval_time 0.6827, test_loss 2.0764, test_accuracy 0.5053, test_5_accuracy 1.0 

2021-08-18:15:33:00,733 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:00,746 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:00,746 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:00,763 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:00,786 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:00,807 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:01,296 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:01,316 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:02,299 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:02,309 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:02,549 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:02,563 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:03,77 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:03,91 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:03,168 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:03,195 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:03,652 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:03,666 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:03,678 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:03,692 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:04,485 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:04,490 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:04,511 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:04,513 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:05,66 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:05,86 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:05,106 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:05,120 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:05,626 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:05,646 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:05,862 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:05,883 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:06,243 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:06,261 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:06,268 INFO     [learner.py:606] ====Pushing takes 0.0239713191986084 s
2021-08-18:15:33:06,270 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:06,308 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:06,315 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:33:06,316 INFO     [param_server.py:410] Lock worker 2 with localStep 22 , while globalStep is 21

2021-08-18:15:33:06,819 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:06,842 INFO     [learner.py:606] ====Pushing takes 0.021091222763061523 s
2021-08-18:15:33:06,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:06,879 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:06,880 INFO     [param_server.py:410] Lock worker 3 with localStep 22 , while globalStep is 21

2021-08-18:15:33:07,708 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:07,726 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:08,225 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:08,243 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:08,771 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:08,789 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:09,267 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:09,295 INFO     [learner.py:606] ====Pushing takes 0.02637195587158203 s
2021-08-18:15:33:09,340 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:09,347 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:09,347 INFO     [param_server.py:381] ====After aggregation in epoch: 21, virtual_clock: 594.7705883029045, top_1: : 48.8222 % (1513.0), top_5: : 100.0 % (3099.0), test loss: 2.321460979956168, test len: 3099.0
2021-08-18:15:33:09,349 INFO     [param_server.py:410] Lock worker 1 with localStep 22 , while globalStep is 22

2021-08-18:15:33:09,349 INFO     [param_server.py:441] ====Epoch 23 completes 20 clients with loss 3.651170690313702, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:09,349 INFO     [param_server.py:450] ====Start to sample for epoch 23, global virtualClock: 594.7705883029045, round_duration: 20.416540281429864
2021-08-18:15:33:09,350 INFO     [oort.py:208] Training selector: Pacer 21: lastExploitationUtil 314.91410150121067, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:09,351 INFO     [oort.py:321] scores are 26,{5: 0.0344270386755262, 6: 0.1462508403777967, 7: 0.48513937325080525, 11: 0.08813512359204811, 14: 0.007658604685486136, 16: 0.5068013833197772, 17: 0.009122459602791358, 25: 0.0033159202208644743, 27: 0.032617512460036406, 35: 0.003976000940685675, 37: 0.051209052359083206, 38: 0.04791712290226953, 49: 0.016934353723051555, 50: 0.0157940144104176, 51: 0.06490930395420456, 53: 0.31091645977300825, 55: 0.11763817531467252, 58: 0.004831648071256993, 59: 0.004999872631740055, 60: 0.0021560608251555333, 65: 0.020066759791648854, 67: 0.004072657844687569, 70: 0.007892495045670953, 71: 0.05599618021392521, 76: 0.002822647481279628, 81: 0.10268359174583983, 82: 0.6927278766347246, 83: 0.052905217603286966, 84: 0.15828107902475072, 85: 0.022142146267679977, 86: 0.002121462512085746, 87: 0.06579170227835071, 88: 0.003014187768462648, 96: 0.006599412661292528, 97: 0.3498031083808584, 98: 0.13959374267090466, 99: 0.04929861914503031, 104: 0.004480126867970183, 105: 0.01567158727557979, 106: 0.014445332276678062, 107: 0.007622919280027899, 110: 0.01225110450819134, 111: 0.006599386387880618, 119: 0.012622480656237616},[82, 16, 7, 97, 53, 84, 6, 98, 55, 81, 11, 87, 51, 71, 83, 37, 99, 38, 5, 27, 85, 65, 49, 50, 105, 106, 119, 110, 17, 70, 14, 107, 96, 111, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:33:09,352 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:33:09,352 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:09,353 INFO     [oort.py:398] At round 21, UCB exploited 44, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 435.3150884574839, 'duration': 11.058674649423494, 'time_stamp': 22, 'count': 19, 'status': True, 'gradient': 12.98482201863708}, [0.358580442043496, -1.3636983499249978e-05]), ({'reward': 472.4415905554701, 'duration': 7.864087706209871, 'time_stamp': 22, 'count': 20, 'status': True, 'gradient': 21.40298359761086}, [0.3891632162425557, -1.3636983499249978e-05]), ({'reward': 167.83264719217635, 'duration': 20.64883858350112, 'time_stamp': 22, 'count': 16, 'status': True, 'gradient': 8.115536806826713}, [0.13824309160202095, -1.3636983499249978e-05])]
2021-08-18:15:33:09,353 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:33:09,665 INFO     [param_server.py:553] For epoch: 23, median_reward: 290.77618990963845, dev: 290.77618990963845
2021-08-18:15:33:10,358 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0669, Top-1 Accuracy: 550.0/1033 (0.5324), Top-5 Accuracy: 1.0
2021-08-18:15:33:10,358 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 253.8571, eval_time 0.6577, test_loss 2.0669, test_accuracy 0.5324, test_5_accuracy 1.0 

2021-08-18:15:33:10,398 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.11, Top-1 Accuracy: 563.0/1033 (0.545), Top-5 Accuracy: 1.0
2021-08-18:15:33:10,398 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1951, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:33:10,398 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 253.8988, eval_time 0.6934, test_loss 2.11, test_accuracy 0.545, test_5_accuracy 1.0 

2021-08-18:15:33:10,399 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 253.8991, eval_time 0.6979, test_loss 2.1951, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:33:10,424 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:10,439 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:10,457 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:10,471 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:10,472 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:10,486 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:11,60 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:11,74 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:11,792 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:11,807 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:12,276 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:12,294 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:12,904 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:12,907 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:12,917 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:12,925 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:13,106 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:13,115 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:13,461 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:13,470 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:13,744 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:13,758 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:13,944 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:13,954 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:14,7 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:14,28 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:14,325 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:14,340 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:15,85 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:15,99 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:15,343 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:15,364 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:15,511 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:15,521 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:15,733 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:15,757 INFO     [learner.py:606] ====Pushing takes 0.022990703582763672 s
2021-08-18:15:33:15,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:15,809 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:33:15,809 INFO     [param_server.py:410] Lock worker 2 with localStep 23 , while globalStep is 22

2021-08-18:15:33:16,95 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:16,121 INFO     [learner.py:606] ====Pushing takes 0.024020671844482422 s
2021-08-18:15:33:16,147 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:16,154 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:16,154 INFO     [param_server.py:410] Lock worker 3 with localStep 23 , while globalStep is 22

2021-08-18:15:33:17,290 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:17,318 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:17,871 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:17,892 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:18,476 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:18,497 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:19,100 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:19,128 INFO     [learner.py:606] ====Pushing takes 0.025668621063232422 s
2021-08-18:15:33:19,168 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:19,175 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:19,176 INFO     [param_server.py:381] ====After aggregation in epoch: 22, virtual_clock: 613.095007594655, top_1: : 54.7273 % (1696.0), top_5: : 100.0 % (3099.0), test loss: 2.1239887475967407, test len: 3099.0
2021-08-18:15:33:19,177 INFO     [param_server.py:410] Lock worker 1 with localStep 23 , while globalStep is 23

2021-08-18:15:33:19,177 INFO     [param_server.py:441] ====Epoch 24 completes 20 clients with loss 3.925246774552686, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:19,178 INFO     [param_server.py:450] ====Start to sample for epoch 24, global virtualClock: 613.095007594655, round_duration: 18.324419291750562
2021-08-18:15:33:19,178 INFO     [oort.py:208] Training selector: Pacer 22: lastExploitationUtil 290.3217126381204, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:19,179 INFO     [oort.py:321] scores are 26,{5: 0.037840116327555066, 6: 0.11246090251856267, 7: 0.42179117028100543, 11: 0.019560041730343026, 14: 0.008750476255792351, 16: 0.8536121202964634, 17: 0.010009113366531623, 25: 0.0034714381202005495, 27: 0.03585119467974077, 35: 0.0044277741203314815, 37: 0.3823094529573228, 38: 0.14682434249060736, 49: 0.01986589966264942, 50: 0.017359824299792128, 51: 0.3538358717992094, 53: 0.36167822079538464, 55: 0.2964777603778448, 58: 0.0055346099559126965, 59: 0.005727309695949094, 60: 0.002469748527308343, 65: 0.023540563938542123, 67: 0.004654931435560949, 70: 0.009168387593064493, 71: 0.03773006856644999, 76: 0.0032554417855559735, 81: 0.060891054475239376, 82: 0.11592806993338467, 83: 0.14951982586732473, 84: 0.1637500176987954, 85: 0.016471090383529334, 86: 0.002430116466953415, 87: 0.01354105423824386, 88: 0.0034763507933752258, 96: 0.007208675693654113, 97: 0.04545792046187833, 98: 0.49537552525277, 99: 0.07393886737060305, 104: 0.005131945539396233, 105: 0.01838453273521324, 106: 0.01903304308635244, 107: 0.008795354862982285, 110: 0.021512949605597013, 111: 0.00765174299835032, 119: 0.013849317547701322},[16, 98, 7, 37, 53, 51, 55, 84, 83, 38, 82, 6, 99, 81, 97, 5, 71, 27, 65, 110, 49, 11, 106, 105, 50, 85, 119, 87, 17, 70, 107, 14, 111, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:33:19,180 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:33:19,180 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:19,180 INFO     [oort.py:398] At round 22, UCB exploited 44, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 240.0138620060464, 'duration': 13.298442137908651, 'time_stamp': 23, 'count': 20, 'status': True, 'gradient': 11.366007776902363}, [0.2467651105781026, -1.304404539327798e-05]), ({'reward': 175.61272071950174, 'duration': 8.010998429338052, 'time_stamp': 23, 'count': 21, 'status': True, 'gradient': 20.598088437868725}, [0.18054970072617388, -1.304404539327798e-05]), ({'reward': 117.51940157911177, 'duration': 17.619275735353515, 'time_stamp': 23, 'count': 19, 'status': True, 'gradient': 8.118568275104954}, [0.12081981303016961, -1.304404539327798e-05])]
2021-08-18:15:33:19,181 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 85, 110, 71, 5]
2021-08-18:15:33:19,467 INFO     [param_server.py:553] For epoch: 24, median_reward: 286.18078816616895, dev: 286.18078816616895
2021-08-18:15:33:20,90 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4146, Top-1 Accuracy: 471.0/1033 (0.456), Top-5 Accuracy: 1.0
2021-08-18:15:33:20,93 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 263.5935, eval_time 0.6014, test_loss 3.4146, test_accuracy 0.456, test_5_accuracy 1.0 

2021-08-18:15:33:20,93 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2064, Top-1 Accuracy: 455.0/1033 (0.4405), Top-5 Accuracy: 1.0
2021-08-18:15:33:20,96 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 263.5961, eval_time 0.604, test_loss 3.2064, test_accuracy 0.4405, test_5_accuracy 1.0 

2021-08-18:15:33:20,134 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9967, Top-1 Accuracy: 492.0/1033 (0.4763), Top-5 Accuracy: 1.0
2021-08-18:15:33:20,136 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 263.6342, eval_time 0.6439, test_loss 2.9967, test_accuracy 0.4763, test_5_accuracy 1.0 

2021-08-18:15:33:20,161 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:20,169 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:20,184 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:20,192 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:20,202 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:20,219 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:20,865 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:20,885 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:21,968 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:21,982 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:22,674 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:22,695 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:23,201 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:23,222 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:23,312 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:23,333 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:23,514 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:23,541 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:23,900 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:23,921 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:24,140 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:24,167 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:24,578 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:24,605 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:24,731 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:24,758 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:25,720 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:25,729 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:25,931 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:25,952 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:26,357 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:26,366 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:26,451 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:26,472 INFO     [learner.py:606] ====Pushing takes 0.01941204071044922 s
2021-08-18:15:33:26,512 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:26,518 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:33:26,518 INFO     [param_server.py:410] Lock worker 3 with localStep 24 , while globalStep is 23

2021-08-18:15:33:27,512 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:27,522 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:28,82 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:28,112 INFO     [learner.py:606] ====Pushing takes 0.028707027435302734 s
2021-08-18:15:33:28,153 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:28,162 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:28,162 INFO     [param_server.py:410] Lock worker 2 with localStep 24 , while globalStep is 23

2021-08-18:15:33:28,476 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:28,497 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:29,32 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:29,53 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:29,699 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:29,719 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:30,195 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:30,221 INFO     [learner.py:606] ====Pushing takes 0.02457141876220703 s
2021-08-18:15:33:30,261 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:30,269 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:30,269 INFO     [param_server.py:381] ====After aggregation in epoch: 23, virtual_clock: 635.7450674729389, top_1: : 45.7567 % (1418.0), top_5: : 100.0 % (3099.0), test loss: 3.2059198441328824, test len: 3099.0
2021-08-18:15:33:30,298 INFO     [param_server.py:410] Lock worker 1 with localStep 24 , while globalStep is 24

2021-08-18:15:33:30,298 INFO     [param_server.py:441] ====Epoch 25 completes 20 clients with loss 5.048628889152171, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:30,298 INFO     [param_server.py:450] ====Start to sample for epoch 25, global virtualClock: 635.7450674729389, round_duration: 22.65005987828387
2021-08-18:15:33:30,299 INFO     [oort.py:208] Training selector: Pacer 23: lastExploitationUtil 346.9189300395797, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:30,300 INFO     [oort.py:321] scores are 26,{5: 0.04999844784090476, 6: 0.3679792322044415, 7: 0.1143003143515923, 11: 0.07181869898369402, 14: 0.009407756194388469, 16: 0.4315933434966611, 17: 0.010880107421308854, 25: 0.0035712560744574386, 27: 0.044386646490507296, 35: 0.004701979619509275, 37: 0.18189416854216298, 38: 0.12600984477087085, 50: 0.02149285096955556, 51: 0.06306756991480872, 53: 0.2370003614002896, 55: 0.1879668613598896, 58: 0.005957499751051958, 59: 0.0061649233387012, 60: 0.0026584576607574205, 65: 0.027307299236051227, 67: 0.005005413760173887, 70: 0.009933498787802857, 71: 0.08123046996626085, 76: 0.0035153796894964906, 81: 0.1898610240650933, 82: 0.18174470194344944, 83: 0.28852764686321974, 84: 0.44049122680043384, 85: 0.012485756382384727, 86: 0.0026157973844996647, 87: 0.013638072629454198, 88: 0.0037539276625427956, 96: 0.007581918066271455, 97: 0.25201689569414365, 98: 0.49465294204453836, 99: 0.16366385372534212, 104: 0.005524068455935748, 105: 0.021326249363698903, 106: 0.023564429655949983, 107: 0.009499458355567028, 110: 0.015065643900443985, 111: 0.008283056785591108, 119: 0.01505448655768625},[98, 84, 16, 6, 83, 97, 53, 81, 55, 37, 82, 99, 38, 7, 71, 11, 51, 5, 27, 65, 106, 50, 105, 110, 119, 87, 85, 17, 70, 107, 14, 111, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:33:30,300 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:33:30,301 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:30,301 INFO     [oort.py:398] At round 23, UCB exploited 43, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 276.0295783909948, 'duration': 7.864087706209871, 'time_stamp': 24, 'count': 22, 'status': True, 'gradient': 21.419503376323632}, [0.3172930406403776, -1.2500520855035638e-05]), ({'reward': 582.6544135681897, 'duration': 19.55790138125729, 'time_stamp': 24, 'count': 18, 'status': True, 'gradient': 19.491829505725672}, [0.6697677575847817, -1.2500520855035638e-05]), ({'reward': 542.7445395575363, 'duration': 17.619275735353515, 'time_stamp': 24, 'count': 20, 'status': True, 'gradient': 11.369400810212717}, [0.6238901249492431, -1.2500520855035638e-05])]
2021-08-18:15:33:30,302 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 87, 85, 71, 5, 27]
2021-08-18:15:33:30,583 INFO     [param_server.py:553] For epoch: 25, median_reward: 295.4094801041021, dev: 295.4094801041021
2021-08-18:15:33:31,226 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3762, Top-1 Accuracy: 560.0/1033 (0.5421), Top-5 Accuracy: 1.0
2021-08-18:15:33:31,227 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 274.7278, eval_time 0.6049, test_loss 2.3762, test_accuracy 0.5421, test_5_accuracy 1.0 

2021-08-18:15:33:31,270 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4738, Top-1 Accuracy: 577.0/1033 (0.5586), Top-5 Accuracy: 1.0
2021-08-18:15:33:31,271 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 274.771, eval_time 0.6486, test_loss 2.4738, test_accuracy 0.5586, test_5_accuracy 1.0 

2021-08-18:15:33:31,273 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4894, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:33:31,273 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 274.7721, eval_time 0.6562, test_loss 2.4894, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:33:31,287 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:31,300 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:31,338 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:31,357 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:31,358 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:31,376 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:32,10 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:32,37 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:33,94 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:33,115 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:34,41 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:34,69 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:34,338 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:34,356 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:34,721 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:34,730 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:34,741 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:34,751 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:35,378 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:35,388 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:35,415 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:35,424 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:35,765 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:35,785 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:36,14 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:36,25 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:36,40 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:36,51 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:36,674 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:36,696 INFO     [learner.py:606] ====Pushing takes 0.020186901092529297 s
2021-08-18:15:33:36,734 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:36,744 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:36,745 INFO     [param_server.py:410] Lock worker 2 with localStep 25 , while globalStep is 24

2021-08-18:15:33:37,165 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:37,179 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:37,866 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:37,880 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:38,437 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:38,446 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:33:38,996 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:33:39,25 INFO     [learner.py:606] ====Pushing takes 0.027424335479736328 s
2021-08-18:15:33:39,64 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:39,71 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:39,72 INFO     [param_server.py:410] Lock worker 3 with localStep 25 , while globalStep is 24

2021-08-18:15:33:39,549 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:39,567 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:40,122 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:40,140 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:40,840 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:40,860 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:41,381 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:41,411 INFO     [learner.py:606] ====Pushing takes 0.02817368507385254 s
2021-08-18:15:33:41,440 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:41,447 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:41,448 INFO     [param_server.py:381] ====After aggregation in epoch: 24, virtual_clock: 659.6429764289317, top_1: : 54.9209 % (1702.0), top_5: : 100.0 % (3099.0), test loss: 2.446461209544429, test len: 3099.0
2021-08-18:15:33:41,449 INFO     [param_server.py:410] Lock worker 1 with localStep 25 , while globalStep is 25

2021-08-18:15:33:41,450 INFO     [param_server.py:441] ====Epoch 26 completes 20 clients with loss 7.35443842841229, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:33:41,450 INFO     [param_server.py:450] ====Start to sample for epoch 26, global virtualClock: 659.6429764289317, round_duration: 23.89790895599279
2021-08-18:15:33:41,450 INFO     [oort.py:208] Training selector: Pacer 24: lastExploitationUtil 346.20430989918043, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:41,451 INFO     [oort.py:321] scores are 26,{5: 0.06057703875823189, 6: 0.06352891927482314, 7: 0.5213262957829946, 11: 0.06725902395516015, 14: 0.009602612100172143, 16: 0.8499314844484642, 17: 0.01017958067904583, 25: 0.003522825063365754, 27: 0.09626325578672613, 35: 0.004498935375600114, 37: 0.04770948561710895, 38: 0.06536115372851502, 50: 0.019905112521629853, 51: 0.19245004600364046, 53: 0.1998778492191822, 55: 0.4588783361649939, 58: 0.005626624792089771, 59: 0.00582252823304675, 60: 0.0025108089648006133, 65: 0.02529003084445881, 67: 0.004732122705199223, 70: 0.009323284819914252, 71: 0.021871080838836186, 76: 0.0033099928234617366, 81: 0.06020636933663371, 82: 0.9392176447785254, 83: 0.21224155638690345, 84: 0.2847110357997266, 85: 0.012316238565726303, 86: 0.0024705180075098635, 87: 0.04434178443287938, 88: 0.003534603576375231, 96: 0.007321731553981197, 97: 0.19453214988640513, 98: 0.2757588367256184, 99: 0.09093277621030622, 104: 0.005217265938094381, 105: 0.01975081825347723, 106: 0.021823657758299485, 107: 0.008942807114525856, 110: 0.014863843850234574, 111: 0.007780740369529631, 119: 0.015879897133410426},[82, 16, 7, 55, 84, 98, 83, 53, 97, 51, 27, 99, 11, 38, 6, 5, 81, 37, 87, 65, 71, 106, 50, 105, 119, 110, 85, 17, 14, 70, 107, 111, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:33:41,452 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:33:41,452 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:41,453 INFO     [oort.py:398] At round 24, UCB exploited 43, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 343.1026504385188, 'duration': 13.324368782156236, 'time_stamp': 25, 'count': 23, 'status': True, 'gradient': 21.124127103604977}, [0.3591843762967494, -1.2000480019200778e-05]), ({'reward': 955.2092778305598, 'duration': 30.380154975061778, 'time_stamp': 25, 'count': 19, 'status': True, 'gradient': 8.126144207459555}, [1.0, -1.2000480019200778e-05]), ({'reward': 390.2832473861806, 'duration': 5.8943907365129, 'time_stamp': 25, 'count': 22, 'status': True, 'gradient': 20.720296460983676}, [0.40857783538822123, -1.2000480019200778e-05])]
2021-08-18:15:33:41,454 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 71, 5]
2021-08-18:15:33:41,720 INFO     [param_server.py:553] For epoch: 26, median_reward: 296.05258918511987, dev: 296.05258918511987
2021-08-18:15:33:42,399 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0665, Top-1 Accuracy: 496.0/1033 (0.4802), Top-5 Accuracy: 1.0
2021-08-18:15:33:42,401 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 285.8995, eval_time 0.6474, test_loss 3.0665, test_accuracy 0.4802, test_5_accuracy 1.0 

2021-08-18:15:33:42,401 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9396, Top-1 Accuracy: 484.0/1033 (0.4685), Top-5 Accuracy: 1.0
2021-08-18:15:33:42,405 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 285.905, eval_time 0.6511, test_loss 2.9396, test_accuracy 0.4685, test_5_accuracy 1.0 

2021-08-18:15:33:42,445 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2083, Top-1 Accuracy: 489.0/1033 (0.4734), Top-5 Accuracy: 1.0
2021-08-18:15:33:42,445 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 285.9459, eval_time 0.6746, test_loss 3.2083, test_accuracy 0.4734, test_5_accuracy 1.0 

2021-08-18:15:33:42,471 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:33:42,470 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:33:42,491 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:42,492 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:42,516 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:33:42,538 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:43,42 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:43,62 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:44,324 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:44,352 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:44,393 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:44,414 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:44,986 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:45,13 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:45,23 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:45,33 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:45,507 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:45,521 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:45,738 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:45,752 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:46,103 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:46,123 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:46,266 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:46,293 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:46,356 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:46,371 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:46,707 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:46,720 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:46,888 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:46,898 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:47,293 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:47,320 INFO     [learner.py:606] ====Pushing takes 0.025678157806396484 s
2021-08-18:15:33:47,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:47,367 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:33:47,367 INFO     [param_server.py:410] Lock worker 2 with localStep 26 , while globalStep is 25

2021-08-18:15:33:47,687 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:47,708 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:48,136 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:48,158 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:48,753 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:48,777 INFO     [learner.py:606] ====Pushing takes 0.0231630802154541 s
2021-08-18:15:33:48,802 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:48,808 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:48,809 INFO     [param_server.py:410] Lock worker 3 with localStep 26 , while globalStep is 25

2021-08-18:15:33:49,562 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:49,576 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:50,196 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:50,209 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:50,819 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:50,837 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:51,386 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:51,413 INFO     [learner.py:606] ====Pushing takes 0.025284290313720703 s
2021-08-18:15:33:51,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:51,461 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:51,462 INFO     [param_server.py:381] ====After aggregation in epoch: 25, virtual_clock: 679.0987701273671, top_1: : 47.4024 % (1469.0), top_5: : 100.0 % (3099.0), test loss: 3.071462269182559, test len: 3099.0
2021-08-18:15:33:51,463 INFO     [param_server.py:410] Lock worker 1 with localStep 26 , while globalStep is 26

2021-08-18:15:33:51,463 INFO     [param_server.py:441] ====Epoch 27 completes 20 clients with loss 7.059728258254244, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:33:51,463 INFO     [param_server.py:450] ====Start to sample for epoch 27, global virtualClock: 679.0987701273671, round_duration: 19.455793698435347
2021-08-18:15:33:51,464 INFO     [oort.py:208] Training selector: Pacer 25: lastExploitationUtil 405.7900987061788, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:51,465 INFO     [oort.py:321] scores are 26,{5: 0.031760537135726116, 6: 0.33031484938121125, 7: 0.37602604948000073, 11: 0.02034304856968887, 14: 0.007007489703942894, 16: 1.1112667588910023, 17: 0.009291634893879018, 25: 0.003295720607486266, 27: 0.03328129068728503, 35: 0.0037199907731332387, 37: 0.047082502439325845, 38: 0.06298333780915936, 50: 0.016115428341027152, 51: 0.06139374646830213, 53: 0.5053011309553979, 55: 0.525130089676898, 58: 0.004386024243204354, 59: 0.004538733420217975, 60: 0.00195720692183923, 65: 0.020475125642890408, 67: 0.0037060016761744957, 70: 0.007053080887259361, 71: 0.011874760255173176, 76: 0.0025429843369243264, 81: 0.037167230524227, 82: 0.4820987851071668, 83: 0.09074270104799056, 84: 0.09424212983411487, 85: 0.013004380867180473, 86: 0.0019257996178178955, 87: 0.04663290089209341, 88: 0.002715547136008111, 96: 0.006297321808471446, 97: 0.2670753922447161, 98: 0.18413945924518207, 99: 0.07320766643329274, 104: 0.0040669239078988464, 105: 0.015990509769522324, 106: 0.017668706587858022, 107: 0.00686449105130218, 110: 0.013914434526312117, 111: 0.005910164876857793, 119: 0.011588327686385558},[16, 55, 53, 82, 7, 6, 97, 98, 84, 83, 99, 38, 51, 37, 87, 81, 27, 5, 65, 11, 106, 50, 105, 110, 85, 71, 119, 17, 70, 14, 107, 96, 111, 59, 58, 104, 35, 67, 25, 88, 76, 60, 86]
2021-08-18:15:33:51,465 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:33:51,466 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:51,467 INFO     [oort.py:398] At round 25, UCB exploited 43, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 704.8326988768428, 'duration': 11.90395711384456, 'time_stamp': 26, 'count': 24, 'status': True, 'gradient': 20.422392828305583}, [0.47496223093686396, -1.1538905342513184e-05]), ({'reward': 614.1646635914735, 'duration': 8.010998429338052, 'time_stamp': 26, 'count': 24, 'status': True, 'gradient': 20.62526583507365}, [0.4138633307858956, -1.1538905342513184e-05]), ({'reward': 450.4535893269904, 'duration': 13.411352670399307, 'time_stamp': 26, 'count': 23, 'status': True, 'gradient': 11.38039534255572}, [0.3035425705685679, -1.1538905342513184e-05])]
2021-08-18:15:33:51,467 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 110, 71, 5]
2021-08-18:15:33:51,779 INFO     [param_server.py:553] For epoch: 27, median_reward: 310.0564425301849, dev: 310.0564425301849
2021-08-18:15:33:52,473 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1874, Top-1 Accuracy: 572.0/1033 (0.5537), Top-5 Accuracy: 1.0
2021-08-18:15:33:52,474 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3805, Top-1 Accuracy: 544.0/1033 (0.5266), Top-5 Accuracy: 1.0
2021-08-18:15:33:52,475 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 295.9731, eval_time 0.6718, test_loss 2.1874, test_accuracy 0.5537, test_5_accuracy 1.0 

2021-08-18:15:33:52,475 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 295.9756, eval_time 0.6719, test_loss 2.3805, test_accuracy 0.5266, test_5_accuracy 1.0 

2021-08-18:15:33:52,518 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1587, Top-1 Accuracy: 573.0/1033 (0.5547), Top-5 Accuracy: 1.0
2021-08-18:15:33:52,520 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 296.0201, eval_time 0.7165, test_loss 2.1587, test_accuracy 0.5547, test_5_accuracy 1.0 

2021-08-18:15:33:52,546 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:33:52,550 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:33:52,563 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:52,563 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:52,614 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:33:52,635 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:53,224 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:53,245 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:54,256 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:54,277 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:54,438 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:54,459 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:54,820 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:54,840 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:55,50 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:55,64 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:55,481 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:55,494 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:55,626 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:55,635 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:55,974 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:55,995 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:56,4 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:56,18 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:56,574 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:56,575 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:56,584 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:56,587 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:57,95 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:57,104 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:57,305 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:57,325 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:57,864 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:57,883 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:58,339 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:58,350 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:58,413 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:58,437 INFO     [learner.py:606] ====Pushing takes 0.022754669189453125 s
2021-08-18:15:33:58,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:58,472 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:58,473 INFO     [param_server.py:410] Lock worker 3 with localStep 27 , while globalStep is 26

2021-08-18:15:33:58,919 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:58,950 INFO     [learner.py:606] ====Pushing takes 0.02897357940673828 s
2021-08-18:15:33:58,985 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:58,993 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:33:58,994 INFO     [param_server.py:410] Lock worker 2 with localStep 27 , while globalStep is 26

2021-08-18:15:33:59,462 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:59,489 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:00,133 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:00,159 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:00,843 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:00,867 INFO     [learner.py:606] ====Pushing takes 0.02274489402770996 s
2021-08-18:15:34:00,903 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:00,909 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:00,910 INFO     [param_server.py:381] ====After aggregation in epoch: 26, virtual_clock: 698.8541718927497, top_1: : 54.5015 % (1689.0), top_5: : 100.0 % (3099.0), test loss: 2.242213213885272, test len: 3099.0
2021-08-18:15:34:00,912 INFO     [param_server.py:410] Lock worker 1 with localStep 27 , while globalStep is 27

2021-08-18:15:34:00,912 INFO     [param_server.py:441] ====Epoch 28 completes 20 clients with loss 4.430318547403239, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:00,912 INFO     [param_server.py:450] ====Start to sample for epoch 28, global virtualClock: 698.8541718927497, round_duration: 19.755401765382704
2021-08-18:15:34:00,913 INFO     [oort.py:208] Training selector: Pacer 26: lastExploitationUtil 351.08185915020744, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:00,914 INFO     [oort.py:321] scores are 26,{5: 0.050482998284701944, 6: 0.06189576399881782, 7: 0.10985001513442386, 11: 0.07479994884171344, 14: 0.0074342236614061905, 16: 0.29596384312889074, 17: 0.009886243400428278, 25: 0.0033518413881424717, 27: 0.0317614896895141, 35: 0.003859393959375615, 37: 0.15460280903761298, 38: 0.06387628172159544, 50: 0.01537951204792629, 51: 0.277636066645408, 53: 0.2347086525026906, 55: 0.10985001513442386, 58: 0.00459727703605181, 59: 0.004757341448319213, 60: 0.0020514757643016325, 65: 0.019540122350081256, 67: 0.003881280037295858, 70: 0.007432846600287148, 71: 0.02670882311794739, 76: 0.0026724117569056245, 81: 0.13447833062407397, 82: 0.71463391752019, 83: 0.07109437868984855, 84: 0.04959548014394404, 85: 0.013152632422408059, 86: 0.0020185557279463182, 87: 0.04436559373544716, 88: 0.0028537572911191025, 96: 0.006490489444243929, 97: 0.20877334973827477, 98: 0.49267739601432087, 99: 0.022929740051614213, 104: 0.004262807237812691, 105: 0.015260297923745848, 106: 0.016861859336834567, 107: 0.0072150100893651455, 110: 0.011440027967437991, 111: 0.006223770214975003, 119: 0.012269464391006535},[82, 98, 16, 51, 53, 97, 37, 81, 7, 55, 11, 83, 38, 6, 5, 84, 87, 27, 71, 99, 65, 106, 50, 105, 85, 119, 110, 17, 14, 70, 107, 96, 111, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:34:00,915 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:34:00,915 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:00,916 INFO     [oort.py:398] At round 26, UCB exploited 43, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 604.5183011283152, 'duration': 29.570969934622333, 'time_stamp': 27, 'count': 19, 'status': True, 'gradient': 8.131430091575199}, [0.4430323932722169, -1.1111522648987009e-05]), ({'reward': 340.64404168822966, 'duration': 11.058674649423494, 'time_stamp': 27, 'count': 24, 'status': True, 'gradient': 13.010579618814724}, [0.2496440766343993, -1.1111522648987009e-05]), ({'reward': 825.2248172022581, 'duration': 6.342067858842259, 'time_stamp': 27, 'count': 26, 'status': True, 'gradient': 52.04125847903787}, [0.6047839097145719, -1.1111522648987009e-05])]
2021-08-18:15:34:00,917 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:34:01,189 INFO     [param_server.py:553] For epoch: 28, median_reward: 298.5756035720662, dev: 298.5756035720662
2021-08-18:15:34:01,776 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3549, Top-1 Accuracy: 524.0/1033 (0.5073), Top-5 Accuracy: 1.0
2021-08-18:15:34:01,776 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 305.2768, eval_time 0.5407, test_loss 2.3549, test_accuracy 0.5073, test_5_accuracy 1.0 

2021-08-18:15:34:01,820 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3855, Top-1 Accuracy: 522.0/1033 (0.5053), Top-5 Accuracy: 1.0
2021-08-18:15:34:01,821 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 305.3216, eval_time 0.588, test_loss 2.3855, test_accuracy 0.5053, test_5_accuracy 1.0 

2021-08-18:15:34:01,832 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:01,851 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:01,880 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4454, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:34:01,881 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 305.3798, eval_time 0.648, test_loss 2.4454, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:34:01,898 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:01,920 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:01,949 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:01,972 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:02,681 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:02,708 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:03,747 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:03,774 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:04,35 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:04,55 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:04,507 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:04,521 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:04,624 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:04,645 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:05,108 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:05,122 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:05,183 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:05,201 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:05,315 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:05,330 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:05,779 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:05,788 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:05,824 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:05,834 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:06,424 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:06,433 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:06,541 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:06,551 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:06,912 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:06,921 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:07,555 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:07,581 INFO     [learner.py:606] ====Pushing takes 0.024684667587280273 s
2021-08-18:15:34:07,616 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:07,623 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:07,624 INFO     [param_server.py:410] Lock worker 2 with localStep 28 , while globalStep is 27

2021-08-18:15:34:08,154 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:08,163 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:08,285 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:08,296 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:08,678 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:08,704 INFO     [learner.py:606] ====Pushing takes 0.02483224868774414 s
2021-08-18:15:34:08,732 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:08,738 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:08,739 INFO     [param_server.py:410] Lock worker 3 with localStep 28 , while globalStep is 27

2021-08-18:15:34:08,904 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:08,918 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:09,566 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:09,587 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:10,154 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:10,177 INFO     [learner.py:606] ====Pushing takes 0.02187061309814453 s
2021-08-18:15:34:10,205 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:10,212 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:10,213 INFO     [param_server.py:381] ====After aggregation in epoch: 27, virtual_clock: 719.2103422679012, top_1: : 51.7909 % (1605.0), top_5: : 100.0 % (3099.0), test loss: 2.3952537819191257, test len: 3099.0
2021-08-18:15:34:10,214 INFO     [param_server.py:410] Lock worker 1 with localStep 28 , while globalStep is 28

2021-08-18:15:34:10,214 INFO     [param_server.py:441] ====Epoch 29 completes 20 clients with loss 3.355153547184717, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:10,215 INFO     [param_server.py:450] ====Start to sample for epoch 29, global virtualClock: 719.2103422679012, round_duration: 20.356170375151418
2021-08-18:15:34:10,215 INFO     [oort.py:208] Training selector: Pacer 27: lastExploitationUtil 310.9554563335375, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:10,216 INFO     [oort.py:321] scores are 26,{5: 0.041387487861569074, 6: 0.3897548907856213, 7: 0.4810213515090229, 11: 0.018305645761132153, 14: 0.010077456447736336, 16: 1.1084935295306382, 17: 0.013586006414469946, 25: 0.003615565393591334, 27: 0.03921211213481467, 35: 0.004672311260026323, 37: 0.16657534076229638, 38: 0.07480164307741394, 50: 0.018987243888661718, 51: 0.48256136996435167, 53: 0.20157668447510985, 55: 0.5977870223422284, 58: 0.005873394646540705, 59: 0.006077889928147759, 60: 0.002620926839315546, 65: 0.024123851752845985, 67: 0.004937723204102197, 70: 0.0097562883123366, 71: 0.08497363260226758, 76: 0.0034593406588169415, 81: 0.027904310257081826, 82: 0.6021749134030374, 83: 0.04879261650925717, 84: 0.09373709193465937, 85: 0.035438848284554916, 86: 0.0025788688202366514, 87: 0.012672659165805483, 88: 0.0036940859139889784, 96: 0.0075765533527411754, 97: 0.16662752212935714, 98: 0.2638646957667276, 99: 0.08096131644750705, 104: 0.0054460823251378816, 105: 0.020772121386860187, 106: 0.02081732077370782, 107: 0.009346988211481758, 110: 0.027854825573976665, 111: 0.008139403829866445, 119: 0.015147640058366042},[16, 82, 55, 51, 7, 6, 98, 53, 97, 37, 84, 71, 99, 38, 83, 5, 27, 85, 81, 110, 65, 106, 105, 50, 11, 119, 17, 87, 14, 70, 107, 111, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:34:10,217 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:34:10,217 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:10,218 INFO     [oort.py:398] At round 27, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 441.29390106099345, 'duration': 8.010998429338052, 'time_stamp': 28, 'count': 26, 'status': True, 'gradient': 20.63838911969487}, [0.4892934928115902, -1.0714668381013617e-05]), ({'reward': 445.25125131614794, 'duration': 6.342067858842259, 'time_stamp': 28, 'count': 27, 'status': True, 'gradient': 55.298383950542345}, [0.4936813838723992, -1.0714668381013617e-05]), ({'reward': 438.24432221099624, 'duration': 13.411352670399307, 'time_stamp': 28, 'count': 25, 'status': True, 'gradient': 13.013343413767922}, [0.4859121343488901, -1.0714668381013617e-05])]
2021-08-18:15:34:10,218 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 71, 5]
2021-08-18:15:34:10,530 INFO     [param_server.py:553] For epoch: 29, median_reward: 292.71090074644525, dev: 292.71090074644525
2021-08-18:15:34:11,117 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3761, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:34:11,118 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 314.6186, eval_time 0.5405, test_loss 2.3761, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:34:11,119 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2059, Top-1 Accuracy: 556.0/1033 (0.5382), Top-5 Accuracy: 1.0
2021-08-18:15:34:11,120 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 314.6205, eval_time 0.5423, test_loss 2.2059, test_accuracy 0.5382, test_5_accuracy 1.0 

2021-08-18:15:34:11,188 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:11,197 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:11,205 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:11,213 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:11,236 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0681, Top-1 Accuracy: 568.0/1033 (0.5499), Top-5 Accuracy: 1.0
2021-08-18:15:34:11,238 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 314.7364, eval_time 0.6622, test_loss 2.0681, test_accuracy 0.5499, test_5_accuracy 1.0 

2021-08-18:15:34:11,315 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:11,339 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:11,849 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:11,858 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:12,876 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:12,891 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:13,756 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:13,790 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:14,454 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:14,481 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:14,613 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:14,638 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:14,640 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:14,665 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:15,63 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:15,83 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:15,261 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:15,281 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:15,896 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:15,923 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:15,970 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:15,990 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:16,377 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:16,391 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:17,256 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:17,270 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:17,731 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:17,746 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:18,123 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:18,136 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:18,387 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:18,414 INFO     [learner.py:606] ====Pushing takes 0.02515125274658203 s
2021-08-18:15:34:18,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:18,461 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:34:18,462 INFO     [param_server.py:410] Lock worker 3 with localStep 29 , while globalStep is 28

2021-08-18:15:34:18,687 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:18,708 INFO     [learner.py:606] ====Pushing takes 0.019499540328979492 s
2021-08-18:15:34:18,740 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:18,746 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:18,747 INFO     [param_server.py:410] Lock worker 2 with localStep 29 , while globalStep is 28

2021-08-18:15:34:19,577 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:19,596 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:20,91 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:20,105 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:20,726 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:20,744 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:21,228 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:21,254 INFO     [learner.py:606] ====Pushing takes 0.024527311325073242 s
2021-08-18:15:34:21,288 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:21,295 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:21,296 INFO     [param_server.py:381] ====After aggregation in epoch: 28, virtual_clock: 742.3927798428265, top_1: : 54.8564 % (1700.0), top_5: : 100.0 % (3099.0), test loss: 2.2167181350566723, test len: 3099.0
2021-08-18:15:34:21,297 INFO     [param_server.py:410] Lock worker 1 with localStep 29 , while globalStep is 29

2021-08-18:15:34:21,297 INFO     [param_server.py:441] ====Epoch 30 completes 20 clients with loss 3.8883199119084093, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:34:21,297 INFO     [param_server.py:450] ====Start to sample for epoch 30, global virtualClock: 742.3927798428265, round_duration: 23.182437574925288
2021-08-18:15:34:21,298 INFO     [oort.py:208] Training selector: Pacer 28: lastExploitationUtil 383.5154945895247, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:21,298 INFO     [oort.py:321] scores are 26,{5: 0.009787668426989206, 6: 0.060398712469152946, 7: 0.5090516956354231, 11: 0.060216076225643685, 14: 0.011529087477588913, 16: 0.5071071947334779, 17: 0.013779087833030937, 25: 0.003696744054368993, 27: 0.04935469729647193, 35: 0.00489630310255162, 37: 0.4487998434497781, 38: 0.08938641533228987, 50: 0.02389847482322097, 51: 0.17505529905236722, 53: 0.5744416993763657, 55: 0.45180735719115445, 58: 0.006219093760046943, 59: 0.006435625324216655, 60: 0.002775190623624631, 65: 0.03036371508867473, 67: 0.005224218322400837, 70: 0.01038190635589797, 71: 0.10102768538710637, 76: 0.0036718601052090566, 81: 0.21709757317624498, 82: 0.44642110512569105, 83: 0.15723645930203872, 84: 0.1318010109245755, 85: 0.04007843546024947, 86: 0.002730657133240575, 87: 0.0478938893500953, 88: 0.0039210265858667034, 96: 0.007881217125931846, 97: 0.2506635906401807, 98: 0.44250599409654845, 99: 0.23111193845503142, 104: 0.005766630482580534, 105: 0.022246637230681987, 106: 0.02226305443241494, 107: 0.009922651972917316, 110: 0.029399938250230805, 111: 0.00865560128683077, 119: 0.019065721001363802},[53, 7, 16, 55, 37, 82, 98, 97, 99, 81, 51, 83, 84, 71, 38, 6, 11, 27, 87, 85, 65, 110, 50, 106, 105, 119, 17, 14, 70, 107, 5, 111, 96, 59, 58, 104, 67, 35, 88, 25, 76, 60, 86]
2021-08-18:15:34:21,299 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:34:21,299 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:21,300 INFO     [oort.py:398] At round 28, UCB exploited 43, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 757.2730287038783, 'duration': 28.420902733732795, 'time_stamp': 29, 'count': 26, 'status': True, 'gradient': 20.240215793767945}, [0.9148580385312393, -1.0345184316700584e-05]), ({'reward': 789.1955497704795, 'duration': 13.73645665746006, 'time_stamp': 29, 'count': 26, 'status': True, 'gradient': 11.391607654653555}, [0.9534239971418023, -1.0345184316700584e-05]), ({'reward': 332.64374248422877, 'duration': 5.8943907365129, 'time_stamp': 29, 'count': 26, 'status': True, 'gradient': 20.748163922960433}, [0.4018585970706624, -1.0345184316700584e-05])]
2021-08-18:15:34:21,300 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:34:21,588 INFO     [param_server.py:553] For epoch: 30, median_reward: 305.95185382111987, dev: 305.95185382111987
2021-08-18:15:34:22,266 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3991, Top-1 Accuracy: 526.0/1033 (0.5092), Top-5 Accuracy: 1.0
2021-08-18:15:34:22,268 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 325.768, eval_time 0.6523, test_loss 2.3991, test_accuracy 0.5092, test_5_accuracy 1.0 

2021-08-18:15:34:22,308 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4483, Top-1 Accuracy: 525.0/1033 (0.5082), Top-5 Accuracy: 1.0
2021-08-18:15:34:22,309 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 325.8095, eval_time 0.6964, test_loss 2.4483, test_accuracy 0.5082, test_5_accuracy 1.0 

2021-08-18:15:34:22,310 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5187, Top-1 Accuracy: 544.0/1033 (0.5266), Top-5 Accuracy: 1.0
2021-08-18:15:34:22,311 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 325.8092, eval_time 0.6989, test_loss 2.5187, test_accuracy 0.5266, test_5_accuracy 1.0 

2021-08-18:15:34:22,338 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:22,346 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:22,379 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:22,392 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:22,419 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:22,434 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:23,16 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:23,29 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:24,185 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:24,212 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:24,308 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:24,328 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:24,896 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:24,916 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:24,953 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:24,984 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:25,490 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:25,505 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:25,785 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:25,806 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:26,122 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:26,136 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:26,380 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:26,407 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:26,453 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:26,467 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:26,636 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:26,646 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:27,46 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:27,60 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:27,210 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:27,238 INFO     [learner.py:606] ====Pushing takes 0.026604175567626953 s
2021-08-18:15:34:27,269 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:27,276 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:27,277 INFO     [param_server.py:410] Lock worker 2 with localStep 30 , while globalStep is 29

2021-08-18:15:34:27,803 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:27,831 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:28,710 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:28,731 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:29,303 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:29,328 INFO     [learner.py:606] ====Pushing takes 0.02367711067199707 s
2021-08-18:15:34:29,376 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:29,382 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:29,383 INFO     [param_server.py:410] Lock worker 3 with localStep 30 , while globalStep is 29

2021-08-18:15:34:29,763 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:29,783 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:30,387 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:30,401 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:31,4 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:31,14 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:31,577 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:31,604 INFO     [learner.py:606] ====Pushing takes 0.025736331939697266 s
2021-08-18:15:34:31,635 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:31,642 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:31,643 INFO     [param_server.py:381] ====After aggregation in epoch: 29, virtual_clock: 762.748950217978, top_1: : 51.4682 % (1595.0), top_5: : 100.0 % (3099.0), test loss: 2.455369547561363, test len: 3099.0
2021-08-18:15:34:31,644 INFO     [param_server.py:410] Lock worker 1 with localStep 30 , while globalStep is 30

2021-08-18:15:34:31,644 INFO     [param_server.py:441] ====Epoch 31 completes 20 clients with loss 2.6897574485613958, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:31,645 INFO     [param_server.py:450] ====Start to sample for epoch 31, global virtualClock: 762.748950217978, round_duration: 20.356170375151418
2021-08-18:15:34:31,645 INFO     [oort.py:208] Training selector: Pacer 29: lastExploitationUtil 352.39644368329107, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:31,646 INFO     [oort.py:321] scores are 26,{5: 0.009839069988863592, 6: 0.6231524296147191, 7: 0.30924403478194995, 11: 0.0399226764820642, 14: 0.009483529825308786, 16: 0.9296060483256816, 17: 0.010582049673297702, 25: 0.003537490058505817, 27: 0.0379033695648455, 35: 0.004343950658043519, 37: 0.34302663867147404, 38: 0.019839572185675804, 50: 0.01835352606499428, 51: 0.058457295635243926, 53: 0.06916994005170383, 55: 0.27809271432783256, 58: 0.005338136152067913, 59: 0.005523995220182272, 60: 0.00238207461865613, 65: 0.023318694620987655, 67: 0.004495627084194846, 70: 0.007807276824840006, 71: 0.010472438651912868, 76: 0.003127066643604021, 81: 0.1188174497686231, 82: 0.35967627706121946, 84: 0.16565881576467673, 85: 0.06591877033082705, 86: 0.0023438494617170095, 87: 0.012374963303475794, 88: 0.0033392643221766293, 96: 0.007155939749375609, 97: 0.3292911769228821, 98: 0.3003174053805798, 99: 0.04274458809366588, 104: 0.0049497659695112274, 105: 0.01821125890276944, 106: 0.018499088117382375, 107: 0.00844643732329654, 110: 0.03766649663903106, 111: 0.00732672675301747, 119: 0.015682970062368084},[16, 6, 82, 37, 97, 7, 98, 55, 84, 81, 53, 85, 51, 99, 11, 27, 110, 65, 38, 106, 50, 105, 119, 87, 17, 71, 5, 14, 107, 70, 111, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:34:31,670 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:34:31,671 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:31,671 INFO     [oort.py:398] At round 29, UCB exploited 42, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 605.2678654290912, 'duration': 13.411352670399307, 'time_stamp': 30, 'count': 27, 'status': True, 'gradient': 13.023083910946138}, [0.5705774714116177, -1.0000333344444823e-05]), ({'reward': 269.1634858314145, 'duration': 6.342067858842259, 'time_stamp': 30, 'count': 29, 'status': True, 'gradient': 55.338909903219}, [0.25373138840070764, -1.0000333344444823e-05]), ({'reward': 1060.7912261249974, 'duration': 11.90395711384456, 'time_stamp': 30, 'count': 28, 'status': True, 'gradient': 20.448983919948596}, [1.0, -1.0000333344444823e-05])]
2021-08-18:15:34:31,672 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 27, 65]
2021-08-18:15:34:31,946 INFO     [param_server.py:553] For epoch: 31, median_reward: 298.6113083748855, dev: 298.6113083748855
2021-08-18:15:34:32,610 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1389, Top-1 Accuracy: 571.0/1033 (0.5528), Top-5 Accuracy: 1.0
2021-08-18:15:34:32,614 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 336.1122, eval_time 0.6557, test_loss 2.1389, test_accuracy 0.5528, test_5_accuracy 1.0 

2021-08-18:15:34:32,647 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2842, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:34:32,650 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 336.1509, eval_time 0.6774, test_loss 2.2842, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:34:32,651 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1114, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:34:32,652 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 336.1525, eval_time 0.6921, test_loss 2.1114, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:34:32,680 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:32,690 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:32,717 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:32,732 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:32,733 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:32,751 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:33,569 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:33,590 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:34,741 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:34,762 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:35,324 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:35,339 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:35,445 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:35,458 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:35,571 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:35,598 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:37,62 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:37,71 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:37,89 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:37,115 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:37,660 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:37,682 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:37,688 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:37,692 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:38,326 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:38,335 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:39,184 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:39,197 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:34:39,727 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:34:39,748 INFO     [learner.py:606] ====Pushing takes 0.01946735382080078 s
2021-08-18:15:34:39,776 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:39,784 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:34:39,785 INFO     [param_server.py:410] Lock worker 2 with localStep 31 , while globalStep is 30

2021-08-18:15:34:39,792 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:39,819 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:41,329 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:41,343 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:42,46 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:42,66 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:34:42,686 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:34:42,712 INFO     [learner.py:606] ====Pushing takes 0.024912118911743164 s
2021-08-18:15:34:42,743 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:42,753 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:42,754 INFO     [param_server.py:410] Lock worker 3 with localStep 31 , while globalStep is 30

2021-08-18:15:34:42,981 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:43,1 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:43,592 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:43,612 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:44,800 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:44,820 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:45,367 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:45,393 INFO     [learner.py:606] ====Pushing takes 0.025055885314941406 s
2021-08-18:15:34:45,431 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:45,438 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:45,439 INFO     [param_server.py:381] ====After aggregation in epoch: 30, virtual_clock: 792.4800934050828, top_1: : 55.9535 % (1734.0), top_5: : 100.0 % (3099.0), test loss: 2.1781947259549743, test len: 3099.0
2021-08-18:15:34:45,440 INFO     [param_server.py:410] Lock worker 1 with localStep 31 , while globalStep is 31

2021-08-18:15:34:45,440 INFO     [param_server.py:441] ====Epoch 32 completes 20 clients with loss 4.4541131409193415, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 81: 0, 82: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:45,441 INFO     [param_server.py:450] ====Start to sample for epoch 32, global virtualClock: 792.4800934050828, round_duration: 29.73114318710483
2021-08-18:15:34:45,441 INFO     [oort.py:208] Training selector: Pacer 30: lastExploitationUtil 369.7558119014514, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:45,442 INFO     [oort.py:321] scores are 26,{5: 0.00988847522270517, 6: 0.059019552900927016, 7: 0.4672454906780299, 11: 0.056365653894646, 14: 0.009148788821566053, 16: 0.35027105004985654, 17: 0.010550010114674546, 25: 0.0035228159809597855, 27: 0.07668196661032614, 35: 0.004260815797940866, 37: 0.09344632261746923, 38: 0.05335003435350406, 50: 0.017717408552680055, 51: 0.3395243580032145, 53: 0.375726591845113, 55: 0.5862793950940546, 58: 0.0051990743296885045, 59: 0.0053800916515488436, 60: 0.002320020068513992, 65: 0.02491653331654232, 67: 0.004380945238270752, 70: 0.007783638521180568, 71: 0.010525024239067945, 76: 0.003040361155912492, 81: 0.11226454934587206, 84: 0.1904889916137306, 85: 0.04039052731544465, 86: 0.002282790701085155, 87: 0.027889340757228136, 88: 0.003246675140498187, 96: 0.006769443525613463, 97: 0.34576788417186516, 98: 0.15009935200780514, 99: 0.09474670265172923, 104: 0.0048208214359767715, 105: 0.018156120180571878, 106: 0.020061596838885223, 107: 0.008211383956410526, 110: 0.010908425588303374, 111: 0.008397418887303464, 112: 0.27999551783204696, 119: 0.015129406859948},[55, 7, 53, 16, 97, 51, 112, 84, 98, 81, 99, 37, 27, 6, 11, 38, 85, 87, 65, 106, 105, 50, 119, 110, 17, 71, 5, 14, 111, 107, 70, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:34:45,469 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:34:45,470 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:45,470 INFO     [oort.py:398] At round 30, UCB exploited 42, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 582.1914296686437, 'duration': 16.330805291863395, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 19.37282713490919}, [0.5228561822594553, 0.28064453692054586]), ({'reward': 536.1806395267869, 'duration': 8.010998429338052, 'time_stamp': 31, 'count': 29, 'status': True, 'gradient': 20.65868915944674}, [0.48153396819161315, -9.677731539727095e-06]), ({'reward': 1113.4738055234618, 'duration': 15.972045438625893, 'time_stamp': 31, 'count': 28, 'status': True, 'gradient': 20.561439528264806}, [1.0, -9.677731539727095e-06])]
2021-08-18:15:34:45,471 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 27, 65, 106]
2021-08-18:15:34:45,739 INFO     [param_server.py:553] For epoch: 32, median_reward: 302.27852004592074, dev: 302.27852004592074
2021-08-18:15:34:46,317 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6461, Top-1 Accuracy: 500.0/1033 (0.484), Top-5 Accuracy: 1.0
2021-08-18:15:34:46,318 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 349.8188, eval_time 0.5569, test_loss 2.6461, test_accuracy 0.484, test_5_accuracy 1.0 

2021-08-18:15:34:46,321 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5672, Top-1 Accuracy: 518.0/1033 (0.5015), Top-5 Accuracy: 1.0
2021-08-18:15:34:46,322 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 349.8207, eval_time 0.5608, test_loss 2.5672, test_accuracy 0.5015, test_5_accuracy 1.0 

2021-08-18:15:34:46,330 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6079, Top-1 Accuracy: 516.0/1033 (0.4995), Top-5 Accuracy: 1.0
2021-08-18:15:34:46,330 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 349.831, eval_time 0.5679, test_loss 2.6079, test_accuracy 0.4995, test_5_accuracy 1.0 

2021-08-18:15:34:46,394 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:34:46,409 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:46,412 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:34:46,423 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:34:46,427 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:46,438 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:47,412 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:47,425 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:48,450 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:48,462 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:49,26 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:49,38 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:49,101 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:49,112 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:49,147 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:49,162 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:51,35 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:51,56 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:51,180 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:51,189 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:51,479 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:51,498 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:52,639 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:52,660 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:53,481 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:53,502 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:53,866 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:53,886 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:34:54,198 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:54,225 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:54,644 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:34:54,664 INFO     [learner.py:606] ====Pushing takes 0.019295692443847656 s
2021-08-18:15:34:54,711 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:54,717 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:34:54,718 INFO     [param_server.py:410] Lock worker 2 with localStep 32 , while globalStep is 31

2021-08-18:15:34:55,91 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:55,124 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:56,466 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:56,486 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:56,652 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:56,674 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:57,160 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:57,181 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:34:57,449 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:57,470 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:34:57,721 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:34:57,751 INFO     [learner.py:606] ====Pushing takes 0.026871442794799805 s
2021-08-18:15:34:57,791 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:57,800 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:57,801 INFO     [param_server.py:410] Lock worker 1 with localStep 32 , while globalStep is 31

2021-08-18:15:34:58,109 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:34:58,138 INFO     [learner.py:606] ====Pushing takes 0.027271270751953125 s
2021-08-18:15:34:58,172 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:58,180 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:58,181 INFO     [param_server.py:381] ====After aggregation in epoch: 31, virtual_clock: 829.4211459656092, top_1: : 49.4998 % (1534.0), top_5: : 100.0 % (3099.0), test loss: 2.607077020185965, test len: 3099.0
2021-08-18:15:34:58,182 INFO     [param_server.py:410] Lock worker 3 with localStep 32 , while globalStep is 32

2021-08-18:15:34:58,182 INFO     [param_server.py:441] ====Epoch 33 completes 20 clients with loss 4.879466547545144, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 106: 0, 110: 0} 
==========
2021-08-18:15:34:58,183 INFO     [param_server.py:450] ====Start to sample for epoch 33, global virtualClock: 829.4211459656092, round_duration: 36.941052560526316
2021-08-18:15:34:58,184 INFO     [oort.py:208] Training selector: Pacer 31: lastExploitationUtil 362.33310560000524, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:58,185 INFO     [oort.py:321] scores are 26,{5: 0.00993602637462986, 6: 0.1193090209864232, 7: 0.3054657149626316, 11: 0.0404705347863663, 14: 0.0064467839660708156, 16: 0.1035915597230349, 17: 0.007704929178631105, 25: 0.0033373544325805064, 27: 0.020564528179994185, 35: 0.0036264499372658594, 37: 0.09370951491808294, 38: 0.07684551777420513, 50: 0.01336344308284392, 51: 0.0718368402614399, 53: 0.31650536809364915, 55: 0.27901761049586293, 58: 0.0041890944192986114, 59: 0.004334947047038781, 60: 0.0018693295200984433, 65: 0.005513334357881833, 67: 0.003545556281395824, 70: 0.005792757167620105, 71: 0.01057563638752907, 76: 0.00241597409813146, 81: 0.08906798451008036, 84: 0.17594573505206965, 85: 0.011315970435518343, 86: 0.001839332384946982, 87: 0.06093269352776776, 88: 0.0025799181880866995, 96: 0.005037970660776425, 97: 0.34540674009348066, 98: 0.17447680510533467, 99: 0.056450832548933974, 104: 0.003884321495187272, 105: 0.013512189065047657, 106: 0.013805753783743525, 107: 0.0077317011409481036, 110: 0.023288323756748875, 111: 0.006132839410265187, 119: 0.01125662595233332},[97, 53, 7, 55, 84, 98, 6, 16, 37, 81, 38, 51, 87, 99, 11, 110, 27, 106, 105, 50, 85, 119, 71, 5, 107, 17, 14, 111, 70, 65, 96, 59, 58, 104, 35, 67, 25, 88, 76, 60, 86]
2021-08-18:15:34:58,185 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:34:58,186 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:58,186 INFO     [oort.py:398] At round 31, UCB exploited 41, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 515.9677948954952, 'duration': 20.64883858350112, 'time_stamp': 32, 'count': 26, 'status': True, 'gradient': 13.036230721415087}, [0.30676964115549427, -9.375292977905568e-06]), ({'reward': 481.2271989136033, 'duration': 13.298442137908651, 'time_stamp': 32, 'count': 29, 'status': True, 'gradient': 20.573019328538148}, [0.28611415331952367, -9.375292977905568e-06]), ({'reward': 1681.9163316838187, 'duration': 15.972045438625893, 'time_stamp': 32, 'count': 29, 'status': True, 'gradient': 20.572886161072756}, [1.0, -9.375292977905568e-06])]
2021-08-18:15:34:58,187 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 110, 5, 27, 50, 105]
2021-08-18:15:34:58,462 INFO     [param_server.py:553] For epoch: 33, median_reward: 301.3279011528757, dev: 301.3279011528757
2021-08-18:15:34:59,170 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1584, Top-1 Accuracy: 532.0/1033 (0.515), Top-5 Accuracy: 1.0
2021-08-18:15:34:59,171 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 362.6719, eval_time 0.6662, test_loss 2.1584, test_accuracy 0.515, test_5_accuracy 1.0 

2021-08-18:15:34:59,209 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3973, Top-1 Accuracy: 546.0/1033 (0.5286), Top-5 Accuracy: 1.0
2021-08-18:15:34:59,210 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 362.7091, eval_time 0.7147, test_loss 2.3973, test_accuracy 0.5286, test_5_accuracy 1.0 

2021-08-18:15:34:59,212 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.282, Top-1 Accuracy: 552.0/1033 (0.5344), Top-5 Accuracy: 1.0
2021-08-18:15:34:59,215 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 362.7158, eval_time 0.7146, test_loss 2.282, test_accuracy 0.5344, test_5_accuracy 1.0 

2021-08-18:15:34:59,245 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:34:59,261 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:59,288 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:34:59,303 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:34:59,303 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:59,318 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:00,422 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:00,434 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:01,471 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:01,481 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:01,928 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:01,938 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:01,942 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:01,957 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:02,142 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:02,170 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:03,918 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:03,932 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:04,483 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:04,497 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:04,536 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:04,554 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:05,600 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:05,611 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:06,272 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:06,282 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:06,994 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:07,21 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:07,58 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:07,67 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:07,859 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:07,886 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:08,159 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:08,174 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:35:09,287 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:09,295 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:09,307 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:09,317 INFO     [learner.py:606] ====Pushing takes 0.020611286163330078 s
2021-08-18:15:35:09,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:09,354 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:35:09,354 INFO     [param_server.py:410] Lock worker 1 with localStep 33 , while globalStep is 32

2021-08-18:15:35:10,57 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:10,62 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:35:10,75 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:10,88 INFO     [learner.py:606] ====Pushing takes 0.02486252784729004 s
2021-08-18:15:35:10,121 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:10,128 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:35:10,128 INFO     [param_server.py:410] Lock worker 2 with localStep 33 , while globalStep is 32

2021-08-18:15:35:10,676 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:10,687 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:35:11,155 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:35:11,194 INFO     [learner.py:606] ====Pushing takes 0.03726482391357422 s
2021-08-18:15:35:11,238 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:11,246 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:11,246 INFO     [param_server.py:381] ====After aggregation in epoch: 32, virtual_clock: 867.9131835542304, top_1: : 52.5976 % (1630.0), top_5: : 100.0 % (3099.0), test loss: 2.279232020731326, test len: 3099.0
2021-08-18:15:35:11,247 INFO     [param_server.py:410] Lock worker 3 with localStep 33 , while globalStep is 33

2021-08-18:15:35:11,248 INFO     [param_server.py:441] ====Epoch 34 completes 20 clients with loss 5.341001271300258, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 81: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:35:11,249 INFO     [param_server.py:450] ====Start to sample for epoch 34, global virtualClock: 867.9131835542304, round_duration: 38.49203758862115
2021-08-18:15:35:11,249 INFO     [oort.py:208] Training selector: Pacer 32: lastExploitationUtil 300.47301702858437, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:11,250 INFO     [oort.py:321] scores are 26,{5: 0.018388272434761762, 6: 0.2395511176481321, 7: 0.10248039752319947, 11: 0.07127591118036773, 14: 0.007604909988671588, 16: 0.561009706331501, 17: 0.009089073432732306, 25: 0.003559256846902459, 27: 0.028977372100934876, 35: 0.004311322629752525, 37: 0.04336455309957376, 38: 0.01919079900004783, 50: 0.02779165495944772, 51: 0.06474818917564726, 53: 0.5155798428581773, 55: 0.1854804575932132, 58: 0.005264403678740573, 59: 0.005447695587008874, 60: 0.002349172450505968, 65: 0.00553876246864705, 67: 0.004435748689813882, 70: 0.006705781447019637, 71: 0.01062441238765517, 76: 0.0030790946142081783, 81: 0.026357742511229614, 84: 0.04626821866420117, 85: 0.011368160948730903, 86: 0.002311475274735585, 87: 0.016131310276142136, 88: 0.003288036988550211, 96: 0.0068610374383891795, 97: 0.3450589628689731, 98: 0.3138252686464761, 99: 0.10721720645793276, 104: 0.004881397820605512, 105: 0.01938291685150138, 107: 0.010525593280144201, 110: 0.040166750853482085, 111: 0.007234567178845677, 119: 0.012576285188775389},[16, 53, 97, 98, 6, 55, 99, 7, 11, 51, 84, 37, 110, 27, 50, 81, 105, 38, 5, 87, 119, 85, 71, 107, 17, 14, 111, 96, 70, 65, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:35:11,250 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:11,251 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:11,251 INFO     [oort.py:398] At round 32, UCB exploited 40, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 91.0779536919861, 'duration': 8.010998429338052, 'time_stamp': 33, 'count': 31, 'status': True, 'gradient': 20.680128299032848}, [0.08300006918409357, -9.091184581350956e-06]), ({'reward': 503.1099474668921, 'duration': 7.864087706209871, 'time_stamp': 33, 'count': 31, 'status': True, 'gradient': 21.49671238155924}, [0.4585293179223814, -9.091184581350956e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 33, 'count': 30, 'status': True, 'gradient': 20.785410412612233}, [9.114079838747304e-09, -9.091184581350956e-06])]
2021-08-18:15:35:11,252 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 85, 110, 71, 5, 27, 65]
2021-08-18:15:35:11,529 INFO     [param_server.py:553] For epoch: 34, median_reward: 284.8626341552778, dev: 284.8626341552778
2021-08-18:15:35:12,170 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.334, Top-1 Accuracy: 512.0/1033 (0.4956), Top-5 Accuracy: 1.0
2021-08-18:15:35:12,171 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 375.6716, eval_time 0.6136, test_loss 3.334, test_accuracy 0.4956, test_5_accuracy 1.0 

2021-08-18:15:35:12,208 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9358, Top-1 Accuracy: 515.0/1033 (0.4985), Top-5 Accuracy: 1.0
2021-08-18:15:35:12,209 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 375.7073, eval_time 0.6558, test_loss 2.9358, test_accuracy 0.4985, test_5_accuracy 1.0 

2021-08-18:15:35:12,209 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3745, Top-1 Accuracy: 484.0/1033 (0.4685), Top-5 Accuracy: 1.0
2021-08-18:15:35:12,209 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 375.7098, eval_time 0.6518, test_loss 3.3745, test_accuracy 0.4685, test_5_accuracy 1.0 

2021-08-18:15:35:12,240 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:12,250 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:12,278 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:12,288 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:12,293 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:12,300 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:13,372 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:13,386 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:14,419 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:14,433 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:14,919 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:14,930 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:14,953 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:14,963 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:15,7 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:15,26 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:16,590 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:16,603 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:17,128 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:17,140 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:17,167 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:17,178 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:18,235 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:18,245 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:19,36 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:19,50 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:19,335 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:19,346 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:19,757 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:19,784 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:20,608 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:20,634 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:22,11 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:22,32 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:22,124 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:22,138 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:22,160 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:22,174 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:22,730 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:22,732 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:22,733 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:22,745 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:35:22,756 INFO     [learner.py:606] ====Pushing takes 0.023174047470092773 s
2021-08-18:15:35:22,773 INFO     [learner.py:606] ====Pushing takes 0.03891921043395996 s
2021-08-18:15:35:22,804 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:22,813 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:15:35:22,814 INFO     [param_server.py:410] Lock worker 1 with localStep 34 , while globalStep is 33

2021-08-18:15:35:22,835 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:22,841 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:35:22,842 INFO     [param_server.py:410] Lock worker 3 with localStep 34 , while globalStep is 33

2021-08-18:15:35:23,267 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:35:23,299 INFO     [learner.py:606] ====Pushing takes 0.031002283096313477 s
2021-08-18:15:35:23,345 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:23,355 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:23,355 INFO     [param_server.py:381] ====After aggregation in epoch: 33, virtual_clock: 902.554218435219, top_1: : 48.7577 % (1511.0), top_5: : 100.0 % (3099.0), test loss: 3.214778229042336, test len: 3099.0
2021-08-18:15:35:23,356 INFO     [param_server.py:410] Lock worker 2 with localStep 34 , while globalStep is 34

2021-08-18:15:35:23,357 INFO     [param_server.py:441] ====Epoch 35 completes 20 clients with loss 5.250986382095783, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:23,358 INFO     [param_server.py:450] ====Start to sample for epoch 35, global virtualClock: 902.554218435219, round_duration: 34.64103488098859
2021-08-18:15:35:23,358 INFO     [oort.py:208] Training selector: Pacer 33: lastExploitationUtil 437.9619128665867, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:23,359 INFO     [oort.py:321] scores are 26,{5: 0.04616875826244133, 6: 0.05713978725638819, 7: 0.35484445737514736, 11: 0.056677819766874374, 14: 0.009254420340451196, 16: 0.7262720705342083, 17: 0.011060499884552261, 25: 0.003508398245972376, 27: 0.04210231055485041, 35: 0.004114861291912567, 37: 0.08855342194520209, 38: 0.09875467093699075, 50: 0.01918335097549539, 51: 0.19576746953058358, 53: 0.34330092580691857, 55: 0.28993493272466847, 58: 0.004947037998621479, 59: 0.005119280115749558, 60: 0.002207552096526916, 65: 0.03251630577218668, 67: 0.0041734775512476075, 70: 0.008160270182600673, 71: 0.012846544379265773, 76: 0.002882391585036783, 81: 0.07708768478199185, 84: 0.247559736881328, 85: 0.036537697358158844, 86: 0.002172127502905818, 87: 0.015740116267833355, 88: 0.0030779860103532512, 93: 0.16817076294119931, 96: 0.007097000715609315, 97: 0.3447237285485722, 98: 0.36060468472493823, 99: 0.09660409128992763, 104: 0.004587121728989577, 105: 0.01903465143429648, 107: 0.009682351718904218, 110: 0.045936364881242475, 111: 0.006681276371776898, 119: 0.011614466352899306},[16, 98, 7, 97, 53, 55, 84, 51, 93, 38, 99, 37, 81, 6, 11, 5, 110, 27, 85, 65, 50, 105, 87, 71, 119, 17, 107, 14, 70, 96, 111, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:35:23,360 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:35:23,360 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:23,361 INFO     [oort.py:398] At round 33, UCB exploited 41, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 311.25736845635413, 'duration': 12.029357192292537, 'time_stamp': 34, 'count': 31, 'status': True, 'gradient': 26.60855325184088}, [0.25338926681563584, -8.823788934968683e-06]), ({'reward': 286.3027198641132, 'duration': 27.035726288496562, 'time_stamp': 34, 'count': 27, 'status': True, 'gradient': 14.68073092621646}, [0.23307346482626595, -8.823788934968683e-06]), ({'reward': 697.4281411405808, 'duration': 21.635252629006885, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.998479924414934}, [0.567774337113683, 0.28235242213006256])]
2021-08-18:15:35:23,361 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 93, 11, 87, 85, 110, 71, 5, 27]
2021-08-18:15:35:23,665 INFO     [param_server.py:553] For epoch: 35, median_reward: 319.40809609209987, dev: 319.40809609209987
2021-08-18:15:35:24,362 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2895, Top-1 Accuracy: 546.0/1033 (0.5286), Top-5 Accuracy: 1.0
2021-08-18:15:35:24,364 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 387.8622, eval_time 0.6642, test_loss 2.2895, test_accuracy 0.5286, test_5_accuracy 1.0 

2021-08-18:15:35:24,365 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5741, Top-1 Accuracy: 562.0/1033 (0.544), Top-5 Accuracy: 1.0
2021-08-18:15:35:24,365 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 387.8656, eval_time 0.6622, test_loss 2.5741, test_accuracy 0.544, test_5_accuracy 1.0 

2021-08-18:15:35:24,369 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3604, Top-1 Accuracy: 549.0/1033 (0.5315), Top-5 Accuracy: 1.0
2021-08-18:15:35:24,370 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 387.8704, eval_time 0.6657, test_loss 2.3604, test_accuracy 0.5315, test_5_accuracy 1.0 

2021-08-18:15:35:24,429 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:24,435 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:24,438 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:24,442 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:24,443 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:24,451 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:24,997 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:25,11 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:25,555 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:25,569 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:26,78 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:26,97 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:26,99 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:26,117 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:26,480 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:26,491 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:26,651 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:26,665 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:27,262 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:27,271 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:27,303 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:27,312 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:27,757 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:27,759 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:27,769 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:27,775 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:27,779 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:27,790 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:28,311 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:28,337 INFO     [learner.py:606] ====Pushing takes 0.024468660354614258 s
2021-08-18:15:35:28,355 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:28,364 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:28,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:28,385 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:28,386 INFO     [param_server.py:410] Lock worker 2 with localStep 35 , while globalStep is 34

2021-08-18:15:35:29,687 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:29,708 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:29,995 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:30,5 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:35:30,472 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:30,525 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:30,755 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:35:30,764 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:31,104 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:31,125 INFO     [learner.py:606] ====Pushing takes 0.019908666610717773 s
2021-08-18:15:35:31,156 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:31,162 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:35:31,163 INFO     [param_server.py:410] Lock worker 1 with localStep 35 , while globalStep is 34

2021-08-18:15:35:31,308 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:31,326 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:31,940 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:31,977 INFO     [learner.py:606] ====Pushing takes 0.035894155502319336 s
2021-08-18:15:35:32,17 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:32,25 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:32,25 INFO     [param_server.py:381] ====After aggregation in epoch: 34, virtual_clock: 922.9616872270977, top_1: : 53.4689 % (1657.0), top_5: : 100.0 % (3099.0), test loss: 2.4080124387034663, test len: 3099.0
2021-08-18:15:35:32,27 INFO     [param_server.py:410] Lock worker 3 with localStep 35 , while globalStep is 35

2021-08-18:15:35:32,27 INFO     [param_server.py:441] ====Epoch 36 completes 20 clients with loss 12.836338234026199, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:32,28 INFO     [param_server.py:450] ====Start to sample for epoch 36, global virtualClock: 922.9616872270977, round_duration: 20.407468791878713
2021-08-18:15:35:32,28 INFO     [oort.py:208] Training selector: Pacer 34: lastExploitationUtil 391.8903216980356, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:32,29 INFO     [oort.py:321] scores are 26,{3: 0.8748691446527684, 5: 0.07251515236820907, 6: 0.05655749591382224, 7: 0.45739089350213014, 11: 0.08473981722292229, 14: 0.008710968456761618, 16: 0.38059643211661465, 17: 0.01041098870225435, 25: 0.0034800436888209464, 27: 0.02983623090457253, 35: 0.003992296640984667, 38: 0.021495166996738833, 50: 0.016544696233524697, 51: 0.05538447438279839, 53: 0.3437702017429595, 55: 0.41679255729540843, 58: 0.0047466977824868715, 59: 0.004911964609960304, 60: 0.002118152851105747, 65: 0.021020523124567633, 67: 0.004008034033757601, 70: 0.007681070617527316, 71: 0.024278531160651217, 76: 0.0027579670477217797, 81: 0.0706660099914658, 84: 0.07790457518942924, 85: 0.03678169765679506, 86: 0.0020841628473835965, 87: 0.020437825018715484, 88: 0.002945118225424796, 96: 0.00612081388485524, 97: 0.34440028260864913, 98: 0.34426302965244865, 99: 0.09729345998817235, 104: 0.00440135704335797, 105: 0.01641645019651359, 107: 0.009145266018120815, 110: 0.0242410031622401, 111: 0.006329322253676762, 119: 0.013199024823718132},[3, 7, 55, 16, 97, 98, 53, 99, 11, 84, 5, 81, 6, 51, 85, 27, 71, 110, 38, 65, 87, 50, 105, 119, 17, 107, 14, 70, 111, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:35:32,29 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:32,30 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:32,30 INFO     [oort.py:398] At round 34, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 474.942338997269, 'duration': 5.8943907365129, 'time_stamp': 35, 'count': 32, 'status': True, 'gradient': 20.812879105221228}, [0.3570150209798073, -8.571673476385045e-06]), ({'reward': 420.93491060637854, 'duration': 8.010998429338052, 'time_stamp': 35, 'count': 33, 'status': True, 'gradient': 20.70820367862132}, [0.3164166847730856, -8.571673476385045e-06]), ({'reward': 1330.2967317002353, 'duration': 15.972045438625893, 'time_stamp': 35, 'count': 32, 'status': True, 'gradient': 13.059510595752807}, [1.0, -8.571673476385045e-06])]
2021-08-18:15:35:32,31 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 3, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27]
2021-08-18:15:35:32,293 INFO     [param_server.py:553] For epoch: 36, median_reward: 309.5717442058497, dev: 309.5717442058497
2021-08-18:15:35:32,899 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.853, Top-1 Accuracy: 514.0/1033 (0.4976), Top-5 Accuracy: 1.0
2021-08-18:15:35:32,900 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 396.4004, eval_time 0.5465, test_loss 2.853, test_accuracy 0.4976, test_5_accuracy 1.0 

2021-08-18:15:35:32,928 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8242, Top-1 Accuracy: 534.0/1033 (0.5169), Top-5 Accuracy: 1.0
2021-08-18:15:35:32,929 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 396.4298, eval_time 0.5757, test_loss 2.8242, test_accuracy 0.5169, test_5_accuracy 1.0 

2021-08-18:15:35:32,971 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4906, Top-1 Accuracy: 551.0/1033 (0.5334), Top-5 Accuracy: 1.0
2021-08-18:15:35:32,974 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 396.4727, eval_time 0.6254, test_loss 2.4906, test_accuracy 0.5334, test_5_accuracy 1.0 

2021-08-18:15:35:32,983 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:32,995 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:32,998 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:33,17 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:33,34 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:33,58 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:33,587 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:33,601 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:34,291 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:34,312 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:34,869 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:34,890 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:34,913 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:34,934 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:35,798 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:35,812 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:36,126 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:36,146 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:36,406 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:36,420 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:36,803 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:36,817 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:37,22 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:37,31 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:35:37,47 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:37,60 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:37,576 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:35:37,586 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:37,971 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:37,982 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:38,161 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:38,170 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:38,542 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:38,573 INFO     [learner.py:606] ====Pushing takes 0.027058839797973633 s
2021-08-18:15:35:38,612 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:38,619 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:38,620 INFO     [param_server.py:410] Lock worker 2 with localStep 36 , while globalStep is 35

2021-08-18:15:35:39,217 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:39,226 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:39,382 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:39,393 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:39,793 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:39,804 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:39,890 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:39,901 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:40,457 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:40,479 INFO     [learner.py:606] ====Pushing takes 0.020345449447631836 s
2021-08-18:15:35:40,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:40,515 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:35:40,515 INFO     [param_server.py:410] Lock worker 1 with localStep 36 , while globalStep is 35

2021-08-18:15:35:40,537 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:40,572 INFO     [learner.py:606] ====Pushing takes 0.03417348861694336 s
2021-08-18:15:35:40,609 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:40,617 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:40,617 INFO     [param_server.py:381] ====After aggregation in epoch: 35, virtual_clock: 944.3664246372948, top_1: : 51.5973 % (1599.0), top_5: : 100.0 % (3099.0), test loss: 2.7226043277316627, test len: 3099.0
2021-08-18:15:35:40,619 INFO     [param_server.py:410] Lock worker 3 with localStep 36 , while globalStep is 36

2021-08-18:15:35:40,619 INFO     [param_server.py:441] ====Epoch 37 completes 20 clients with loss 6.146313477783421, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:40,619 INFO     [param_server.py:450] ====Start to sample for epoch 37, global virtualClock: 944.3664246372948, round_duration: 21.404737410197022
2021-08-18:15:35:40,620 INFO     [oort.py:208] Training selector: Pacer 35: lastExploitationUtil 321.2282657459135, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:40,620 INFO     [oort.py:321] scores are 26,{5: 0.055544948575353366, 6: 0.1346612583929219, 7: 0.09937790852683621, 11: 0.07713526188205214, 14: 0.008257889748913685, 16: 0.6210310134328276, 17: 0.009869487796580036, 25: 0.003684972214233335, 27: 0.09694165413642056, 35: 0.0044847250853313585, 38: 0.048369914235564235, 50: 0.02000998882337204, 51: 0.2693785862761715, 53: 0.31428460219892257, 55: 0.5772799234032675, 58: 0.005488274599455218, 59: 0.005679361071128539, 60: 0.0024490719702817887, 65: 0.021748487211768506, 67: 0.004623575771524403, 70: 0.009324123729201682, 71: 0.06344324549159265, 76: 0.0032117697891568165, 81: 0.03318496822404975, 84: 0.16503903081725482, 85: 0.011065146399248368, 86: 0.0024097717066854972, 87: 0.06654923938388735, 88: 0.0034297152860213263, 96: 0.007402820559359465, 97: 0.03170386223479199, 98: 0.32040627599819077, 99: 0.021144077522314668, 104: 0.005088981260470985, 105: 0.01698497011923693, 107: 0.009903780850967986, 110: 0.03790655447417603, 111: 0.007560570766099192, 119: 0.013656121728528736},[16, 55, 98, 53, 51, 84, 6, 7, 27, 11, 87, 71, 5, 38, 110, 81, 97, 65, 99, 50, 105, 119, 85, 107, 17, 70, 14, 111, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:35:40,621 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:40,622 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:40,623 INFO     [oort.py:398] At round 35, UCB exploited 39, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 509.1268005203944, 'duration': 8.010998429338052, 'time_stamp': 36, 'count': 34, 'status': True, 'gradient': 20.712932019749672}, [0.4779020242633149, -8.33356482124504e-06]), ({'reward': 164.10254366733852, 'duration': 20.64883858350112, 'time_stamp': 36, 'count': 30, 'status': True, 'gradient': 8.164524104743952}, [0.15403177020220654, -8.33356482124504e-06]), ({'reward': 274.5634534533585, 'duration': 27.689063957948644, 'time_stamp': 36, 'count': 30, 'status': True, 'gradient': 8.164417332471807}, [0.2577201405287481, -8.33356482124504e-06])]
2021-08-18:15:35:40,623 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 50]
2021-08-18:15:35:40,895 INFO     [param_server.py:553] For epoch: 37, median_reward: 293.74289202352884, dev: 293.74289202352884
2021-08-18:15:35:41,439 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1897, Top-1 Accuracy: 579.0/1033 (0.5605), Top-5 Accuracy: 1.0
2021-08-18:15:35:41,440 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 404.9403, eval_time 0.5207, test_loss 2.1897, test_accuracy 0.5605, test_5_accuracy 1.0 

2021-08-18:15:35:41,482 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0117, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:35:41,483 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 404.9835, eval_time 0.5642, test_loss 2.0117, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:35:41,504 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9279, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:35:41,505 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 405.0035, eval_time 0.5984, test_loss 1.9279, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:35:41,509 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:41,525 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:41,553 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:41,565 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:41,575 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:41,594 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:42,154 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:42,172 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:43,231 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:43,249 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:43,657 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:43,678 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:43,818 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:43,832 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:44,638 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:44,665 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:45,458 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:45,468 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:45,748 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:45,769 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:46,527 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:46,547 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:46,595 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:46,622 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:47,133 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:47,146 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:47,967 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:47,980 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:49,67 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:49,81 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:49,359 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:49,374 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:49,413 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:49,428 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:49,704 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:49,718 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:35:50,17 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:50,28 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:50,339 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:35:50,368 INFO     [learner.py:606] ====Pushing takes 0.0282745361328125 s
2021-08-18:15:35:50,416 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:50,434 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:35:50,434 INFO     [param_server.py:410] Lock worker 2 with localStep 37 , while globalStep is 36

2021-08-18:15:35:50,617 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:50,638 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:50,646 INFO     [learner.py:606] ====Pushing takes 0.027386903762817383 s
2021-08-18:15:35:50,652 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:50,684 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:50,691 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:35:50,691 INFO     [param_server.py:410] Lock worker 3 with localStep 37 , while globalStep is 36

2021-08-18:15:35:51,191 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:51,211 INFO     [learner.py:606] ====Pushing takes 0.018282651901245117 s
2021-08-18:15:35:51,232 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:51,237 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:51,238 INFO     [param_server.py:381] ====After aggregation in epoch: 36, virtual_clock: 973.2899256245634, top_1: : 56.6634 % (1756.0), top_5: : 100.0 % (3099.0), test loss: 2.043122181185969, test len: 3099.0
2021-08-18:15:35:51,239 INFO     [param_server.py:410] Lock worker 1 with localStep 37 , while globalStep is 37

2021-08-18:15:35:51,240 INFO     [param_server.py:441] ====Epoch 38 completes 20 clients with loss 3.5982684514452954, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:51,240 INFO     [param_server.py:450] ====Start to sample for epoch 38, global virtualClock: 973.2899256245634, round_duration: 28.923500987268568
2021-08-18:15:35:51,241 INFO     [oort.py:208] Training selector: Pacer 36: lastExploitationUtil 282.9455331001827, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:51,241 INFO     [oort.py:321] scores are 26,{5: 0.03390930618732226, 6: 0.2843603166498832, 7: 0.0984133530836988, 11: 0.07447081686175061, 14: 0.007921202389801126, 16: 0.5164706335985009, 17: 0.008598114056752634, 25: 0.003662134498526584, 27: 0.09685660098979831, 35: 0.004381427245962384, 38: 0.04376624561294019, 50: 0.012017251995365607, 51: 0.19107398604361864, 53: 0.06549245352333903, 55: 0.14838268025088647, 58: 0.005318689946464863, 59: 0.005503871951733918, 60: 0.002373396999450361, 65: 0.02086176663948345, 67: 0.00448356712825048, 70: 0.008916967044883988, 71: 0.057831899860360296, 76: 0.003106367723030805, 79: 0.03519713316133639, 81: 0.09564129238836604, 84: 0.04528932905876281, 85: 0.04401064456478974, 86: 0.0023353110922867937, 87: 0.011717036452541364, 88: 0.0033171608063724232, 96: 0.0055170039555706854, 97: 0.23725466084747387, 98: 0.07305173029024234, 99: 0.07397575375701156, 104: 0.00493173455105578, 105: 0.014796989807955354, 107: 0.00862798952740109, 110: 0.01044674211349507, 111: 0.006843781625852146, 119: 0.01189695905348555},[16, 6, 97, 51, 55, 7, 27, 81, 11, 99, 98, 53, 71, 84, 85, 38, 79, 5, 65, 105, 50, 119, 87, 110, 70, 107, 17, 14, 111, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:35:51,242 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:35:51,243 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:51,243 INFO     [oort.py:398] At round 36, UCB exploited 40, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 377.4197766275476, 'duration': 21.753601635627824, 'time_stamp': 37, 'count': 30, 'status': True, 'gradient': 20.826075260772168}, [0.33460377487995796, -8.1083272520879e-06]), ({'reward': 1127.9404407635834, 'duration': 30.380154975061778, 'time_stamp': 37, 'count': 31, 'status': True, 'gradient': 11.43459921461892}, [1.0, -8.1083272520879e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 37, 'count': 34, 'status': True, 'gradient': 20.82270337060314}, [8.865794866367709e-09, -8.1083272520879e-06])]
2021-08-18:15:35:51,244 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:35:51,539 INFO     [param_server.py:553] For epoch: 38, median_reward: 281.7666930900032, dev: 281.7666930900032
2021-08-18:15:35:52,71 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2569, Top-1 Accuracy: 574.0/1033 (0.5557), Top-5 Accuracy: 1.0
2021-08-18:15:35:52,72 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 415.5727, eval_time 0.5067, test_loss 2.2569, test_accuracy 0.5557, test_5_accuracy 1.0 

2021-08-18:15:35:52,103 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0965, Top-1 Accuracy: 575.0/1033 (0.5566), Top-5 Accuracy: 1.0
2021-08-18:15:35:52,103 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 415.602, eval_time 0.5413, test_loss 2.0965, test_accuracy 0.5566, test_5_accuracy 1.0 

2021-08-18:15:35:52,142 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:35:52,147 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1817, Top-1 Accuracy: 569.0/1033 (0.5508), Top-5 Accuracy: 1.0
2021-08-18:15:35:52,148 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 415.6477, eval_time 0.5827, test_loss 2.1817, test_accuracy 0.5508, test_5_accuracy 1.0 

2021-08-18:15:35:52,151 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:52,172 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:35:52,181 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:52,217 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:35:52,232 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:52,917 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:52,931 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:53,545 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:53,559 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:53,893 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:53,903 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:54,71 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:54,85 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:55,351 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:55,371 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:55,387 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:55,397 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:55,572 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:55,581 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:56,252 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:56,262 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:56,600 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:56,610 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:56,877 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:56,897 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:56,961 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:56,975 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:57,525 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:57,536 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:58,21 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:58,31 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:35:58,658 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:35:58,688 INFO     [learner.py:606] ====Pushing takes 0.02776169776916504 s
2021-08-18:15:35:58,732 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:58,739 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:35:58,740 INFO     [param_server.py:410] Lock worker 2 with localStep 38 , while globalStep is 37

2021-08-18:15:35:59,441 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:59,461 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:59,644 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:59,672 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:00,113 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:00,134 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:00,429 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:00,456 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:00,731 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:00,760 INFO     [learner.py:606] ====Pushing takes 0.0275115966796875 s
2021-08-18:15:36:00,790 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:00,798 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:36:00,799 INFO     [param_server.py:410] Lock worker 3 with localStep 38 , while globalStep is 37

2021-08-18:15:36:01,77 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:01,98 INFO     [learner.py:606] ====Pushing takes 0.019465923309326172 s
2021-08-18:15:36:01,120 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:01,144 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:01,145 INFO     [param_server.py:381] ====After aggregation in epoch: 37, virtual_clock: 998.1111771177845, top_1: : 55.4372 % (1718.0), top_5: : 100.0 % (3099.0), test loss: 2.178366082685965, test len: 3099.0
2021-08-18:15:36:01,146 INFO     [param_server.py:410] Lock worker 1 with localStep 38 , while globalStep is 38

2021-08-18:15:36:01,146 INFO     [param_server.py:441] ====Epoch 39 completes 20 clients with loss 4.072332881700856, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:01,147 INFO     [param_server.py:450] ====Start to sample for epoch 39, global virtualClock: 998.1111771177845, round_duration: 24.821251493221073
2021-08-18:15:36:01,147 INFO     [oort.py:208] Training selector: Pacer 37: lastExploitationUtil 288.3038385676419, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:01,148 INFO     [oort.py:321] scores are 26,{5: 0.04732342199673213, 6: 0.2461743341772138, 7: 0.2320516749354854, 11: 0.06486197486971582, 14: 0.008456949523082062, 16: 0.09748034388337982, 17: 0.009163095099582646, 25: 0.0037273089555080385, 27: 0.015882199118252924, 35: 0.004563802140006948, 38: 0.09334256885573414, 50: 0.0160577110893411, 51: 0.12237702257049717, 53: 0.18719463682021154, 55: 0.09748034388337982, 58: 0.005600800535914829, 59: 0.005795804848027828, 60: 0.002499285222537844, 65: 0.009041754320631545, 67: 0.0047173301614696125, 70: 0.006830676307311968, 71: 0.030407286376336252, 76: 0.003279868506630696, 79: 0.016785237708776275, 81: 0.02555549761889889, 84: 0.3935574524713678, 85: 0.02486042802718734, 86: 0.0024591791867659544, 87: 0.011605952921006812, 88: 0.003502435072186302, 96: 0.005879525623408721, 97: 0.3501217306470061, 98: 0.2570281225591102, 99: 0.10326789828708931, 104: 0.005193320497071274, 105: 0.01593323991249927, 107: 0.009290526579176483, 110: 0.07637720631155347, 111: 0.007293485695180946, 119: 0.01281051790185415},[84, 97, 98, 6, 7, 53, 51, 99, 16, 55, 38, 110, 11, 5, 71, 81, 85, 79, 50, 105, 27, 119, 87, 107, 17, 65, 14, 111, 70, 96, 59, 58, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:36:01,148 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:36:01,149 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:01,149 INFO     [oort.py:398] At round 37, UCB exploited 40, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 85.51965918336487, 'duration': 30.380154975061778, 'time_stamp': 38, 'count': 32, 'status': True, 'gradient': 9.805026305183809}, [0.08263355857372456, -7.89494460380537e-06]), ({'reward': 342.685029627847, 'duration': 11.90395711384456, 'time_stamp': 38, 'count': 36, 'status': True, 'gradient': 20.52653246610097}, [0.3311491931762705, -7.89494460380537e-06]), ({'reward': 190.21851983316213, 'duration': 11.058674649423494, 'time_stamp': 38, 'count': 35, 'status': True, 'gradient': 16.341239310758393}, [0.18381088175521043, -7.89494460380537e-06])]
2021-08-18:15:36:01,150 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:36:01,425 INFO     [param_server.py:553] For epoch: 39, median_reward: 280.2409251237012, dev: 280.2409251237012
2021-08-18:15:36:02,124 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0963, Top-1 Accuracy: 562.0/1033 (0.544), Top-5 Accuracy: 1.0
2021-08-18:15:36:02,125 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 425.6255, eval_time 0.6453, test_loss 2.0963, test_accuracy 0.544, test_5_accuracy 1.0 

2021-08-18:15:36:02,125 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9405, Top-1 Accuracy: 571.0/1033 (0.5528), Top-5 Accuracy: 1.0
2021-08-18:15:36:02,126 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 425.6245, eval_time 0.6557, test_loss 1.9405, test_accuracy 0.5528, test_5_accuracy 1.0 

2021-08-18:15:36:02,148 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0947, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:36:02,149 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 425.6494, eval_time 0.6787, test_loss 2.0947, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:36:02,192 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:02,206 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:02,219 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:02,219 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:02,231 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:02,244 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:02,937 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:02,965 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:03,647 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:03,668 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:03,913 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:03,925 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:04,280 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:04,300 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:04,611 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:04,632 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:05,17 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:05,31 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:05,102 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:05,116 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:05,685 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:05,695 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:05,734 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:05,744 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:05,838 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:05,848 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:06,360 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:06,370 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:06,374 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:06,383 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:06,824 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:06,833 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:07,374 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:07,402 INFO     [learner.py:606] ====Pushing takes 0.026484966278076172 s
2021-08-18:15:36:07,442 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:07,450 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:07,450 INFO     [param_server.py:410] Lock worker 2 with localStep 39 , while globalStep is 38

2021-08-18:15:36:07,781 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:07,795 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:07,862 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:07,880 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:08,400 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:08,444 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:08,451 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:08,512 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:08,937 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:08,969 INFO     [learner.py:606] ====Pushing takes 0.0299530029296875 s
2021-08-18:15:36:09,5 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:09,14 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:36:09,15 INFO     [param_server.py:410] Lock worker 3 with localStep 39 , while globalStep is 38

2021-08-18:15:36:09,44 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:09,65 INFO     [learner.py:606] ====Pushing takes 0.01919388771057129 s
2021-08-18:15:36:09,87 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:09,93 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:09,94 INFO     [param_server.py:381] ====After aggregation in epoch: 38, virtual_clock: 1019.8114695526995, top_1: : 55.534 % (1721.0), top_5: : 100.0 % (3099.0), test loss: 2.0438549386130442, test len: 3099.0
2021-08-18:15:36:09,95 INFO     [param_server.py:410] Lock worker 1 with localStep 39 , while globalStep is 39

2021-08-18:15:36:09,95 INFO     [param_server.py:441] ====Epoch 40 completes 20 clients with loss 5.401307575464818, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:09,95 INFO     [param_server.py:450] ====Start to sample for epoch 40, global virtualClock: 1019.8114695526995, round_duration: 21.70029243491498
2021-08-18:15:36:09,96 INFO     [oort.py:208] Training selector: Pacer 38: lastExploitationUtil 245.14032467437298, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:09,97 INFO     [oort.py:321] scores are 26,{5: 0.022548708425449714, 6: 0.23751716091694416, 7: 0.09657715426593459, 11: 0.08084170412945763, 14: 0.01141130161620162, 16: 0.2821914217098247, 17: 0.010896857512444248, 25: 0.004037117370239906, 27: 0.011720701775442781, 35: 0.0055385338544763005, 38: 0.10091422004945355, 50: 0.02155523415700481, 51: 0.11051615098938122, 53: 0.6631826591427915, 55: 0.8624877133759212, 58: 0.0071353956319786796, 59: 0.007383830281265976, 60: 0.0031840785519158836, 65: 0.025735003696532435, 67: 0.005987525601025478, 70: 0.008039537305817397, 71: 0.056887243506116805, 76: 0.00422668602292686, 79: 0.019755810211979436, 81: 0.16547805414052985, 84: 0.04444431961777457, 85: 0.010753298863064547, 86: 0.0031329836359966935, 87: 0.011498419691627236, 88: 0.004513502091895151, 96: 0.007875748812318261, 97: 0.19983616094781279, 98: 0.49617789893717484, 99: 0.02549426203277704, 104: 0.006616267826830394, 105: 0.018753029848882607, 107: 0.010934720321035134, 110: 0.08791070832862374, 111: 0.008673496621579, 119: 0.017196330878705507},[55, 53, 98, 16, 6, 97, 81, 51, 38, 7, 110, 11, 71, 84, 65, 99, 5, 50, 79, 105, 119, 27, 87, 14, 107, 17, 85, 111, 70, 96, 59, 58, 104, 67, 35, 88, 76, 25, 60, 86]
2021-08-18:15:36:09,97 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:09,98 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:09,98 INFO     [oort.py:398] At round 38, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 245.14126752177566, 'duration': 42.701901101086094, 'time_stamp': 39, 'count': 3, 'status': True, 'gradient': 14.263831301075202}, [0.34605798309876235, -7.692504936024006e-06]), ({'reward': 224.54296471531507, 'duration': 11.90395711384456, 'time_stamp': 39, 'count': 37, 'status': True, 'gradient': 20.535853899805556}, [0.3169788415199073, -7.692504936024006e-06]), ({'reward': 131.49045913393653, 'duration': 7.864087706209871, 'time_stamp': 39, 'count': 37, 'status': True, 'gradient': 21.55674353757334}, [0.18561428156114138, -7.692504936024006e-06])]
2021-08-18:15:36:09,99 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 110, 71, 5, 27, 65, 79]
2021-08-18:15:36:09,370 INFO     [param_server.py:553] For epoch: 40, median_reward: 270.97809991183675, dev: 270.97809991183675
2021-08-18:15:36:09,996 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3008, Top-1 Accuracy: 579.0/1033 (0.5605), Top-5 Accuracy: 1.0
2021-08-18:15:36:09,997 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 433.4977, eval_time 0.5913, test_loss 2.3008, test_accuracy 0.5605, test_5_accuracy 1.0 

2021-08-18:15:36:10,42 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.331, Top-1 Accuracy: 560.0/1033 (0.5421), Top-5 Accuracy: 1.0
2021-08-18:15:36:10,43 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 433.5436, eval_time 0.6335, test_loss 2.331, test_accuracy 0.5421, test_5_accuracy 1.0 

2021-08-18:15:36:10,67 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:10,76 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:10,82 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9604, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:36:10,83 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 433.5814, eval_time 0.6781, test_loss 1.9604, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:36:10,124 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:10,140 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:10,150 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:10,170 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:11,146 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:11,155 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:12,174 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:12,183 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:12,786 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:12,804 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:13,170 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:13,190 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:13,386 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:13,407 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:15,67 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:15,81 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:15,451 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:15,471 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:15,678 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:15,692 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:16,680 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:16,689 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:17,310 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:17,319 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:17,649 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:17,659 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:18,252 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:18,266 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:19,550 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:19,571 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:36:19,990 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:20,0 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:20,1 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:36:20,30 INFO     [learner.py:606] ====Pushing takes 0.02748894691467285 s
2021-08-18:15:36:20,55 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:20,60 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:36:20,61 INFO     [param_server.py:410] Lock worker 1 with localStep 40 , while globalStep is 39

2021-08-18:15:36:20,395 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:20,405 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:20,562 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:20,571 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:20,964 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:20,973 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:21,122 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:21,150 INFO     [learner.py:606] ====Pushing takes 0.026493072509765625 s
2021-08-18:15:36:21,181 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:21,188 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:36:21,189 INFO     [param_server.py:410] Lock worker 3 with localStep 40 , while globalStep is 39

2021-08-18:15:36:21,616 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:21,647 INFO     [learner.py:606] ====Pushing takes 0.029345035552978516 s
2021-08-18:15:36:21,682 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:21,690 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:21,691 INFO     [param_server.py:381] ====After aggregation in epoch: 39, virtual_clock: 1053.8352527959325, top_1: : 55.7277 % (1727.0), top_5: : 100.0 % (3099.0), test loss: 2.1974271800782947, test len: 3099.0
2021-08-18:15:36:21,692 INFO     [param_server.py:410] Lock worker 2 with localStep 40 , while globalStep is 40

2021-08-18:15:36:21,692 INFO     [param_server.py:441] ====Epoch 41 completes 20 clients with loss 3.56587709123911, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:21,693 INFO     [param_server.py:450] ====Start to sample for epoch 41, global virtualClock: 1053.8352527959325, round_duration: 34.02378324323311
2021-08-18:15:36:21,693 INFO     [oort.py:208] Training selector: Pacer 39: lastExploitationUtil 337.64071674360036, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:21,694 INFO     [oort.py:321] scores are 26,{5: 0.07035442707744809, 6: 0.05496452860452702, 7: 0.09570217788155999, 11: 0.11174047096618453, 14: 0.011535683190240117, 16: 0.5658857539487836, 17: 0.014237074478309127, 25: 0.004059984490254186, 27: 0.09661753275386063, 35: 0.0055857051831936615, 38: 0.03690152928165163, 50: 0.024692807687934606, 51: 0.053824545752493964, 53: 0.2873559903544181, 55: 0.6292145845734866, 58: 0.0072041815899670505, 59: 0.007455011175180834, 60: 0.003214773401199668, 65: 0.058190737534979546, 67: 0.006044742129384942, 70: 0.01050389906111499, 71: 0.009642496239942904, 76: 0.00426851797192918, 79: 0.029205653928541315, 81: 0.05050641100989942, 84: 0.34559576731152575, 85: 0.010791624469819811, 86: 0.0031631859249627173, 87: 0.10029626072359778, 88: 0.004558172689215573, 96: 0.007960363621251148, 97: 0.3342385886366301, 98: 0.3907366974298605, 99: 0.21028253724256424, 104: 0.006680049338641248, 105: 0.024501401651585725, 107: 0.011050306893492111, 110: 0.04769351301319811, 111: 0.011332186114002342, 119: 0.01969942373314353},[55, 16, 98, 84, 97, 53, 99, 11, 87, 27, 7, 5, 65, 6, 51, 81, 110, 38, 79, 50, 105, 119, 17, 14, 111, 107, 85, 70, 71, 96, 59, 58, 104, 67, 35, 88, 76, 25, 60, 86]
2021-08-18:15:36:21,694 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:21,695 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:21,695 INFO     [oort.py:398] At round 39, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 458.4337154095709, 'duration': 13.298442137908651, 'time_stamp': 40, 'count': 37, 'status': True, 'gradient': 20.646057426303216}, [0.655274699605429, -7.500187504687623e-06]), ({'reward': 387.5987715188991, 'duration': 21.753601635627824, 'time_stamp': 40, 'count': 33, 'status': True, 'gradient': 20.847635939295497}, [0.5540226395423127, -7.500187504687623e-06]), ({'reward': 522.396012602104, 'duration': 26.145070720211294, 'time_stamp': 40, 'count': 33, 'status': True, 'gradient': 19.623696293129555}, [0.7467029411116117, -7.500187504687623e-06])]
2021-08-18:15:36:21,696 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:36:21,974 INFO     [param_server.py:541] Handle Wight 0.03717398643493652 | Send 0.28119659423828125
2021-08-18:15:36:21,975 INFO     [param_server.py:553] For epoch: 41, median_reward: 288.2577733827014, dev: 288.2577733827014
2021-08-18:15:36:22,565 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9511, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:36:22,569 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 446.0675, eval_time 0.5615, test_loss 1.9511, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:36:22,613 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4607, Top-1 Accuracy: 584.0/1033 (0.5653), Top-5 Accuracy: 1.0
2021-08-18:15:36:22,614 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 446.1145, eval_time 0.6066, test_loss 2.4607, test_accuracy 0.5653, test_5_accuracy 1.0 

2021-08-18:15:36:22,650 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:22,656 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2441, Top-1 Accuracy: 573.0/1033 (0.5547), Top-5 Accuracy: 1.0
2021-08-18:15:36:22,656 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 446.1569, eval_time 0.6486, test_loss 2.2441, test_accuracy 0.5547, test_5_accuracy 1.0 

2021-08-18:15:36:22,668 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:22,682 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:22,696 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:22,728 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:22,739 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:23,346 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:23,366 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:23,969 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:23,989 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:24,611 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:24,625 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:25,2 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:25,23 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:25,653 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:25,673 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:25,736 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:25,746 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:26,884 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:26,887 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:26,897 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:26,907 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:27,286 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:27,301 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:27,550 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:27,564 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:28,77 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:28,86 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:28,493 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:28,502 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:28,961 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:28,970 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:29,105 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:29,119 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:29,462 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:29,492 INFO     [learner.py:606] ====Pushing takes 0.028478145599365234 s
2021-08-18:15:36:29,539 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:29,549 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:29,550 INFO     [param_server.py:410] Lock worker 2 with localStep 41 , while globalStep is 40

2021-08-18:15:36:29,679 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:29,693 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:30,169 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:30,189 INFO     [learner.py:606] ====Pushing takes 0.0192110538482666 s
2021-08-18:15:36:30,211 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:30,217 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:30,218 INFO     [param_server.py:410] Lock worker 1 with localStep 41 , while globalStep is 40

2021-08-18:15:36:30,838 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:30,847 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:31,345 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:31,357 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:31,919 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:31,948 INFO     [learner.py:606] ====Pushing takes 0.027538061141967773 s
2021-08-18:15:36:31,978 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:31,990 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:31,990 INFO     [param_server.py:381] ====After aggregation in epoch: 40, virtual_clock: 1080.2931348537816, top_1: : 56.1471 % (1740.0), top_5: : 100.0 % (3099.0), test loss: 2.2186329298549228, test len: 3099.0
2021-08-18:15:36:31,991 INFO     [param_server.py:410] Lock worker 3 with localStep 41 , while globalStep is 41

2021-08-18:15:36:31,992 INFO     [param_server.py:441] ====Epoch 42 completes 20 clients with loss 4.976852529056873, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:31,992 INFO     [param_server.py:450] ====Start to sample for epoch 42, global virtualClock: 1080.2931348537816, round_duration: 26.45788205784899
2021-08-18:15:36:31,993 INFO     [oort.py:208] Training selector: Pacer 40: lastExploitationUtil 357.8674339396163, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:31,993 INFO     [oort.py:321] scores are 26,{5: 0.021873956068843913, 6: 0.054477358402618616, 7: 0.09485393537852517, 11: 0.05552414854806334, 14: 0.010096218529995413, 16: 0.4897064662209036, 17: 0.012066582214481982, 25: 0.003853024843285157, 27: 0.06822708676434586, 35: 0.004890060869456812, 38: 0.1636922834306714, 50: 0.0200246273343399, 51: 0.30709928461036984, 53: 0.6933651813216232, 55: 0.3363584084161048, 58: 0.006099132931274945, 59: 0.00631148779271347, 60: 0.0027216596462740373, 65: 0.005145708650339215, 67: 0.005130591718519229, 70: 0.008518134791092431, 71: 0.0763009486201626, 76: 0.0035856312238308047, 79: 0.02187650043733397, 81: 0.024866957000162802, 84: 0.30859829062326916, 85: 0.051257233154911735, 86: 0.002677985167607879, 87: 0.01129325425536462, 88: 0.003828946352234159, 96: 0.006514165691190895, 97: 0.34928384485855624, 98: 0.18814425827174128, 99: 0.206443544625417, 104: 0.005655397271022231, 105: 0.02076607647514509, 107: 0.012108509411585493, 110: 0.03782822108666006, 111: 0.009189834006894132, 119: 0.01669617704227428},[53, 16, 97, 55, 84, 51, 99, 98, 38, 7, 71, 27, 11, 6, 85, 110, 81, 79, 5, 105, 50, 119, 107, 17, 87, 14, 111, 70, 96, 59, 58, 104, 65, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:36:31,994 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:36:31,995 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:31,995 INFO     [oort.py:398] At round 40, UCB exploited 40, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 357.46741538281077, 'duration': 7.864087706209871, 'time_stamp': 41, 'count': 39, 'status': True, 'gradient': 21.574591725894333}, [0.39485254188852026, -7.3172516402839146e-06]), ({'reward': 218.64242094771356, 'duration': 8.010998429338052, 'time_stamp': 41, 'count': 39, 'status': True, 'gradient': 20.75409758830553}, [0.2415044840837215, -7.3172516402839146e-06]), ({'reward': 905.3034539173037, 'duration': 15.972045438625893, 'time_stamp': 41, 'count': 38, 'status': True, 'gradient': 19.63537822415934}, [1.0, -7.3172516402839146e-06])]
2021-08-18:15:36:31,996 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 50, 105]
2021-08-18:15:36:32,266 INFO     [param_server.py:553] For epoch: 42, median_reward: 296.36145627513764, dev: 296.36145627513764
2021-08-18:15:36:32,851 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9338, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:36:32,854 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 456.353, eval_time 0.5436, test_loss 1.9338, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:36:32,906 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3623, Top-1 Accuracy: 547.0/1033 (0.5295), Top-5 Accuracy: 1.0
2021-08-18:15:36:32,909 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 456.4098, eval_time 0.594, test_loss 2.3623, test_accuracy 0.5295, test_5_accuracy 1.0 

2021-08-18:15:36:32,915 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4052, Top-1 Accuracy: 550.0/1033 (0.5324), Top-5 Accuracy: 1.0
2021-08-18:15:36:32,916 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 456.416, eval_time 0.5991, test_loss 2.4052, test_accuracy 0.5324, test_5_accuracy 1.0 

2021-08-18:15:36:32,923 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:32,935 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:32,980 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:32,987 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:32,988 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:32,997 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:33,953 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:33,962 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:35,34 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:35,48 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:35,601 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:35,611 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:35,628 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:35,647 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:35,756 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:35,776 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:37,212 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:37,224 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:37,435 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:37,455 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:37,581 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:37,609 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:38,452 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:38,473 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:38,824 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:38,838 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:39,112 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:39,126 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:40,259 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:40,279 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:40,434 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:40,448 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:41,123 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:41,149 INFO     [learner.py:606] ====Pushing takes 0.02491307258605957 s
2021-08-18:15:36:41,182 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:41,189 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:36:41,190 INFO     [param_server.py:410] Lock worker 2 with localStep 42 , while globalStep is 41

2021-08-18:15:36:41,267 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:41,286 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:41,768 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:41,779 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:41,799 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:41,819 INFO     [learner.py:606] ====Pushing takes 0.018342256546020508 s
2021-08-18:15:36:41,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:41,846 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:36:41,847 INFO     [param_server.py:410] Lock worker 1 with localStep 42 , while globalStep is 41

2021-08-18:15:36:42,378 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:42,389 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:43,40 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:43,58 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:36:43,598 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:36:43,632 INFO     [learner.py:606] ====Pushing takes 0.03305196762084961 s
2021-08-18:15:36:43,679 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:43,687 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:43,687 INFO     [param_server.py:381] ====After aggregation in epoch: 41, virtual_clock: 1111.923707645506, top_1: : 53.4366 % (1656.0), top_5: : 100.0 % (3099.0), test loss: 2.2337816467991582, test len: 3099.0
2021-08-18:15:36:43,688 INFO     [param_server.py:410] Lock worker 3 with localStep 42 , while globalStep is 42

2021-08-18:15:36:43,688 INFO     [param_server.py:441] ====Epoch 43 completes 20 clients with loss 5.274240199633206, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:36:43,689 INFO     [param_server.py:450] ====Start to sample for epoch 43, global virtualClock: 1111.923707645506, round_duration: 31.630572791724475
2021-08-18:15:36:43,689 INFO     [oort.py:208] Training selector: Pacer 41: lastExploitationUtil 321.8693571569861, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:43,690 INFO     [oort.py:321] scores are 26,{5: 0.019868330788048352, 6: 0.17803464510864206, 7: 0.09403105873781846, 11: 0.03642579617793967, 14: 0.008117775975001856, 16: 0.40561267949634305, 17: 0.009702029617335454, 25: 0.00374794762109772, 27: 0.021729953686493497, 35: 0.0045247779313144, 38: 0.06779879030084694, 50: 0.024883239728263996, 51: 0.3734983397146456, 53: 0.06494454783035532, 55: 0.09403105873781846, 58: 0.00551636840654525, 59: 0.005708433026519175, 60: 0.0024616084704579154, 65: 0.005162901996704639, 67: 0.004648627977477431, 70: 0.007158011285513973, 71: 0.009474122223627764, 76: 0.003225225145061761, 79: 0.01913838541622553, 81: 0.02465123123233636, 84: 0.27984343120803623, 85: 0.08254290725936922, 86: 0.0024221070336141754, 87: 0.015394577870662882, 88: 0.003444083700588848, 96: 0.0057492889695634, 97: 0.33856267281434976, 98: 0.4950258468794001, 99: 0.09106052111406443, 104: 0.005115031133746396, 105: 0.020045152825360592, 107: 0.009735740812505691, 110: 0.010325205810048584, 111: 0.00772245769134067, 119: 0.013424414741566937},[98, 16, 51, 97, 84, 6, 7, 55, 99, 85, 38, 53, 11, 50, 81, 27, 105, 5, 79, 87, 119, 110, 107, 17, 71, 14, 111, 70, 96, 59, 58, 65, 104, 67, 35, 25, 88, 76, 60, 86]
2021-08-18:15:36:43,701 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:36:43,701 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:43,702 INFO     [oort.py:398] At round 41, UCB exploited 40, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 334.2185806130823, 'duration': 7.864087706209871, 'time_stamp': 42, 'count': 40, 'status': True, 'gradient': 21.580691357951792}, [0.3115816300814935, -7.1430272149336945e-06]), ({'reward': 1037.4655927120934, 'duration': 15.972045438625893, 'time_stamp': 42, 'count': 39, 'status': True, 'gradient': 20.665554810916095}, [0.9672166332924866, -7.1430272149336945e-06]), ({'reward': 321.8705951160521, 'duration': 48.8795967667807, 'time_stamp': 42, 'count': 17, 'status': True, 'gradient': 18.305679508962125}, [0.3000696415885301, -7.1430272149336945e-06])]
2021-08-18:15:36:43,703 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 79, 50]
2021-08-18:15:36:43,977 INFO     [param_server.py:553] For epoch: 43, median_reward: 284.16066974514416, dev: 284.16066974514416
2021-08-18:15:36:44,509 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4076, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:36:44,531 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 468.0297, eval_time 0.5306, test_loss 2.4076, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:36:44,597 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:44,618 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:44,671 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1309, Top-1 Accuracy: 586.0/1033 (0.5673), Top-5 Accuracy: 1.0
2021-08-18:15:36:44,672 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 468.1727, eval_time 0.6718, test_loss 2.1309, test_accuracy 0.5673, test_5_accuracy 1.0 

2021-08-18:15:36:44,694 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1047, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:36:44,695 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 468.1954, eval_time 0.6921, test_loss 2.1047, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:36:44,744 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:44,758 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:44,765 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:44,780 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:45,360 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:45,373 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:46,508 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:46,518 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:47,60 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:47,74 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:47,193 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:47,202 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:47,786 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:47,806 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:48,643 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:48,657 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:48,791 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:48,800 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:49,412 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:49,421 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:49,439 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:49,459 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:50,23 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:50,36 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:50,694 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:50,715 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:52,298 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:52,312 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:52,471 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:52,485 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:53,160 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:53,178 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:53,241 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:53,260 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:53,631 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:53,658 INFO     [learner.py:606] ====Pushing takes 0.024504423141479492 s
2021-08-18:15:36:53,697 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:53,706 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:36:53,706 INFO     [param_server.py:410] Lock worker 2 with localStep 43 , while globalStep is 42

2021-08-18:15:36:53,708 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:53,723 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:53,771 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:53,786 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:36:53,868 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:36:53,895 INFO     [learner.py:606] ====Pushing takes 0.025549888610839844 s
2021-08-18:15:36:53,921 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:53,927 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:53,928 INFO     [param_server.py:410] Lock worker 1 with localStep 43 , while globalStep is 42

2021-08-18:15:36:54,329 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:54,357 INFO     [learner.py:606] ====Pushing takes 0.026366710662841797 s
2021-08-18:15:36:54,388 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:54,395 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:54,396 INFO     [param_server.py:381] ====After aggregation in epoch: 42, virtual_clock: 1142.6097532511035, top_1: : 57.4379 % (1780.0), top_5: : 100.0 % (3099.0), test loss: 2.214403490225474, test len: 3099.0
2021-08-18:15:36:54,397 INFO     [param_server.py:410] Lock worker 3 with localStep 43 , while globalStep is 43

2021-08-18:15:36:54,398 INFO     [param_server.py:441] ====Epoch 44 completes 20 clients with loss 4.775423584418173, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:54,398 INFO     [param_server.py:450] ====Start to sample for epoch 44, global virtualClock: 1142.6097532511035, round_duration: 30.68604560559735
2021-08-18:15:36:54,399 INFO     [oort.py:208] Training selector: Pacer 42: lastExploitationUtil 411.56533872173753, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:54,400 INFO     [oort.py:321] scores are 26,{5: 0.02000525263166637, 6: 0.14317745979498717, 7: 0.5040217862934165, 11: 0.052441475224502605, 14: 0.008184805040778852, 16: 0.7290709748934451, 17: 0.011833870776594983, 25: 0.003764205660850365, 27: 0.09074161942323619, 35: 0.004552756443188118, 38: 0.02199920814172627, 50: 0.028666773689188206, 51: 0.05243542875624574, 53: 0.38182473913678866, 55: 0.09323227274785831, 58: 0.005555291729281396, 59: 0.004237479907105806, 60: 0.0024789775027422674, 65: 0.005179626075420443, 67: 0.004681108770657557, 70: 0.008730851575512368, 71: 0.06830246117516375, 76: 0.003248671659788086, 79: 0.021591779496059265, 81: 0.14994857307279136, 84: 0.3560171358141127, 85: 0.054938031986119504, 86: 0.002439197344997112, 87: 0.036232234030022174, 88: 0.003469121257836035, 96: 0.005795372286839621, 97: 0.18821252008409517, 98: 0.4946644131186938, 99: 0.030707669423417648, 104: 0.005151122633253212, 105: 0.020365589955440903, 107: 0.011874989381990329, 110: 0.012544628768026136, 111: 0.007786222585339587, 119: 0.016374181029015417},[16, 7, 98, 53, 84, 97, 81, 6, 55, 27, 71, 85, 11, 51, 87, 99, 50, 38, 79, 105, 5, 119, 110, 107, 17, 70, 14, 111, 96, 58, 65, 104, 67, 35, 59, 25, 88, 76, 60, 86]
2021-08-18:15:36:54,401 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:54,401 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:54,402 INFO     [oort.py:398] At round 42, UCB exploited 40, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 527.6290039284162, 'duration': 15.972045438625893, 'time_stamp': 43, 'count': 40, 'status': True, 'gradient': 20.677481194231905}, [0.49673265847985626, -6.976906439684649e-06]), ({'reward': 165.77679929632342, 'duration': 11.90395711384456, 'time_stamp': 43, 'count': 41, 'status': True, 'gradient': 20.5730552677045}, [0.15606296531356179, -6.976906439684649e-06]), ({'reward': 675.3845366174328, 'duration': 7.864087706209871, 'time_stamp': 43, 'count': 41, 'status': True, 'gradient': 21.595080985237455}, [0.6358387115601956, -6.976906439684649e-06])]
2021-08-18:15:36:54,403 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 38, 11, 87, 85, 110, 71, 5, 27, 79, 50]
2021-08-18:15:36:54,675 INFO     [param_server.py:553] For epoch: 44, median_reward: 302.624827834633, dev: 302.624827834633
2021-08-18:15:36:55,193 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1658, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:36:55,194 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 478.693, eval_time 0.4924, test_loss 2.1658, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:36:55,261 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:36:55,274 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:55,318 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1175, Top-1 Accuracy: 571.0/1033 (0.5528), Top-5 Accuracy: 1.0
2021-08-18:15:36:55,318 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 478.8188, eval_time 0.6138, test_loss 2.1175, test_accuracy 0.5528, test_5_accuracy 1.0 

2021-08-18:15:36:55,332 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2481, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:36:55,332 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 478.8326, eval_time 0.6277, test_loss 2.2481, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:36:55,388 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:36:55,398 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:55,404 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:36:55,420 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:56,527 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:56,538 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:57,565 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:57,577 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:57,964 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:57,974 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:58,124 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:58,144 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:58,152 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:58,171 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:59,946 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:59,967 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:00,254 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:00,273 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:00,554 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:00,564 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:01,500 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:01,518 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:02,347 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:02,361 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:02,942 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:02,969 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:03,6 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:03,24 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:03,285 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:03,307 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:03,715 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:03,740 INFO     [learner.py:606] ====Pushing takes 0.023859024047851562 s
2021-08-18:15:37:03,776 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:03,782 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:37:03,783 INFO     [param_server.py:410] Lock worker 3 with localStep 44 , while globalStep is 43

2021-08-18:15:37:04,149 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:04,170 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:04,750 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:04,777 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:05,113 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:05,138 INFO     [learner.py:606] ====Pushing takes 0.02311873435974121 s
2021-08-18:15:37:05,166 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:05,173 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:37:05,173 INFO     [param_server.py:410] Lock worker 1 with localStep 44 , while globalStep is 43

2021-08-18:15:37:05,658 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:05,672 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:06,653 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:06,663 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:37:07,239 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:37:07,272 INFO     [learner.py:606] ====Pushing takes 0.03094792366027832 s
2021-08-18:15:37:07,313 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:07,321 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:07,322 INFO     [param_server.py:381] ====After aggregation in epoch: 43, virtual_clock: 1181.005774809889, top_1: : 56.3408 % (1746.0), top_5: : 100.0 % (3099.0), test loss: 2.1771401387673834, test len: 3099.0
2021-08-18:15:37:07,323 INFO     [param_server.py:410] Lock worker 2 with localStep 44 , while globalStep is 44

2021-08-18:15:37:07,323 INFO     [param_server.py:441] ====Epoch 45 completes 20 clients with loss 3.7944242633714382, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 110: 0} 
==========
2021-08-18:15:37:07,324 INFO     [param_server.py:450] ====Start to sample for epoch 45, global virtualClock: 1181.005774809889, round_duration: 38.39602155878561
2021-08-18:15:37:07,324 INFO     [oort.py:208] Training selector: Pacer 43: lastExploitationUtil 179.63709684730932, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:07,325 INFO     [oort.py:321] scores are 26,{5: 0.08461054534308783, 6: 0.20485061018249423, 7: 0.6531209734026233, 11: 0.020597672520272284, 14: 0.007975396003733044, 16: 0.6147274107496116, 17: 0.009531862972872828, 25: 0.004242708516803921, 27: 0.0527055488604484, 35: 0.0060769464565327965, 38: 0.05633130468332663, 50: 0.022754485355565447, 51: 0.05199906222967789, 53: 0.06152819726068786, 55: 0.4994546104723572, 58: 0.007959078425927916, 59: 0.006777233030488184, 60: 0.0035516364075787, 65: 0.005195905039753259, 67: 0.006670527535957336, 70: 0.013963727729452752, 71: 0.009315466670835652, 76: 0.004732223591886454, 79: 0.02829221249233044, 81: 0.02423841676511125, 84: 0.3805730430865439, 85: 0.05326623710760724, 86: 0.0034946432898958543, 87: 0.011007804584778975, 88: 0.005053344621634484, 97: 0.18461916499269743, 98: 0.041834558196722146, 99: 0.038845286441810366, 104: 0.007380024491519898, 105: 0.032571800210767624, 107: 0.009564982897846087, 110: 0.009814401124270008, 111: 0.00758701131937825, 119: 0.013188960130465222},[7, 16, 55, 84, 6, 97, 5, 53, 38, 85, 27, 51, 98, 99, 105, 79, 81, 50, 11, 70, 119, 87, 110, 107, 17, 71, 14, 58, 111, 104, 59, 67, 35, 65, 88, 76, 25, 60, 86]
2021-08-18:15:37:07,326 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:07,326 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:07,327 INFO     [oort.py:398] At round 43, UCB exploited 39, augment_factor 1.2692307692307692, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 447.67514516803595, 'duration': 13.298442137908651, 'time_stamp': 44, 'count': 41, 'status': True, 'gradient': 20.68851423787758}, [0.7345258268813675, -6.818336780381378e-06]), ({'reward': 329.99648630661375, 'duration': 42.701901101086094, 'time_stamp': 44, 'count': 7, 'status': True, 'gradient': 11.470778628582536}, [0.5414395140231977, -6.818336780381378e-06]), ({'reward': 318.31403562806764, 'duration': 7.864087706209871, 'time_stamp': 44, 'count': 42, 'status': True, 'gradient': 21.60359595920669}, [0.5222710314071253, -6.818336780381378e-06])]
2021-08-18:15:37:07,331 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 79]
2021-08-18:15:37:07,617 INFO     [param_server.py:553] For epoch: 45, median_reward: 255.19599809224624, dev: 255.19599809224624
2021-08-18:15:37:08,274 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2087, Top-1 Accuracy: 564.0/1033 (0.546), Top-5 Accuracy: 1.0
2021-08-18:15:37:08,275 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 491.7753, eval_time 0.634, test_loss 2.2087, test_accuracy 0.546, test_5_accuracy 1.0 

2021-08-18:15:37:08,284 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2725, Top-1 Accuracy: 573.0/1033 (0.5547), Top-5 Accuracy: 1.0
2021-08-18:15:37:08,288 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 491.7884, eval_time 0.6474, test_loss 2.2725, test_accuracy 0.5547, test_5_accuracy 1.0 

2021-08-18:15:37:08,324 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.918, Top-1 Accuracy: 577.0/1033 (0.5586), Top-5 Accuracy: 1.0
2021-08-18:15:37:08,325 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 491.824, eval_time 0.6848, test_loss 1.918, test_accuracy 0.5586, test_5_accuracy 1.0 

2021-08-18:15:37:08,345 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:08,352 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:08,357 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:08,366 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:08,406 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:08,422 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:08,862 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:08,872 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:09,952 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:09,971 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:10,342 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:10,352 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:10,589 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:10,609 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:11,233 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:11,248 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:12,38 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:12,52 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:12,165 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:12,174 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:12,817 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:12,831 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:12,835 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:12,858 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:13,434 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:13,443 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:13,720 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:13,730 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:14,865 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:14,874 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:15,404 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:15,429 INFO     [learner.py:606] ====Pushing takes 0.023336410522460938 s
2021-08-18:15:37:15,466 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:15,475 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:37:15,476 INFO     [param_server.py:410] Lock worker 2 with localStep 45 , while globalStep is 44

2021-08-18:15:37:15,921 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:15,946 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:16,288 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:16,310 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:16,958 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:16,980 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:17,38 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:17,60 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:17,646 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:17,673 INFO     [learner.py:606] ====Pushing takes 0.025821924209594727 s
2021-08-18:15:37:17,701 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:17,708 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:37:17,709 INFO     [param_server.py:410] Lock worker 3 with localStep 45 , while globalStep is 44

2021-08-18:15:37:17,792 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:17,813 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:18,160 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:18,190 INFO     [learner.py:606] ====Pushing takes 0.029041528701782227 s
2021-08-18:15:37:18,215 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:18,221 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:18,222 INFO     [param_server.py:381] ====After aggregation in epoch: 44, virtual_clock: 1208.3540827778506, top_1: : 55.3082 % (1714.0), top_5: : 100.0 % (3099.0), test loss: 2.133093224631416, test len: 3099.0
2021-08-18:15:37:18,223 INFO     [param_server.py:410] Lock worker 1 with localStep 45 , while globalStep is 45

2021-08-18:15:37:18,224 INFO     [param_server.py:441] ====Epoch 46 completes 20 clients with loss 3.703074990768549, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:18,224 INFO     [param_server.py:450] ====Start to sample for epoch 46, global virtualClock: 1208.3540827778506, round_duration: 27.34830796796159
2021-08-18:15:37:18,225 INFO     [oort.py:208] Training selector: Pacer 44: lastExploitationUtil 333.1808988956247, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:18,225 INFO     [oort.py:321] scores are 26,{5: 0.008534783079648417, 6: 0.14805508580178525, 7: 0.09170230101813867, 11: 0.022916945884920818, 14: 0.0053689403126381445, 16: 0.3948745175467983, 17: 0.006416735086965693, 25: 0.003779165494362038, 27: 0.017885308127549848, 35: 0.004553846770324498, 38: 0.04765755707616563, 50: 0.017213357996943936, 51: 0.2617026417677569, 53: 0.3955817059337205, 55: 0.33932120604795274, 58: 0.005546839234003579, 59: 0.004218332083413298, 60: 0.002475205685409021, 65: 0.005211759883154003, 67: 0.0018757495157167058, 70: 0.007322268783192349, 71: 0.017598023323160013, 76: 0.003242328738475136, 79: 0.020506784341812166, 81: 0.12411718408282704, 84: 0.04220093672373945, 85: 0.029315575326259242, 86: 0.0024354860540253746, 87: 0.05896870229465291, 88: 0.0034623479161542932, 97: 0.34827840079948336, 98: 0.3891077323837929, 99: 0.19609562076315784, 105: 0.017079928835380457, 107: 0.00643903102064187, 110: 0.04361194060615961, 111: 0.007899667746719293, 119: 0.00887864874585382},[53, 16, 98, 97, 55, 51, 99, 6, 81, 7, 87, 38, 110, 84, 85, 11, 79, 27, 71, 50, 105, 119, 5, 111, 70, 107, 17, 58, 14, 65, 35, 59, 25, 88, 76, 60, 86, 67]
2021-08-18:15:37:18,226 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:18,226 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:18,227 INFO     [oort.py:398] At round 44, UCB exploited 38, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 821.8573978205006, 'duration': 13.411352670399307, 'time_stamp': 45, 'count': 42, 'status': True, 'gradient': 17.829309560983287}, [0.7682446049994254, -6.666814818107074e-06]), ({'reward': 264.90604209619624, 'duration': 8.010998429338052, 'time_stamp': 45, 'count': 43, 'status': True, 'gradient': 20.795998536936676}, [0.2476189143775908, -6.666814818107074e-06]), ({'reward': 1069.78308371553, 'duration': 15.972045438625893, 'time_stamp': 45, 'count': 42, 'status': True, 'gradient': 20.69865938331508}, [1.0, -6.666814818107074e-06])]
2021-08-18:15:37:18,244 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 79]
2021-08-18:15:37:18,520 INFO     [param_server.py:553] For epoch: 46, median_reward: 280.78161916469224, dev: 280.78161916469224
2021-08-18:15:37:19,102 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1443, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:37:19,103 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 502.6021, eval_time 0.5498, test_loss 2.1443, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:37:19,165 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5572, Top-1 Accuracy: 584.0/1033 (0.5653), Top-5 Accuracy: 1.0
2021-08-18:15:37:19,166 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 502.666, eval_time 0.6116, test_loss 2.5572, test_accuracy 0.5653, test_5_accuracy 1.0 

2021-08-18:15:37:19,182 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:19,203 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:19,211 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5474, Top-1 Accuracy: 572.0/1033 (0.5537), Top-5 Accuracy: 1.0
2021-08-18:15:37:19,212 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 502.7127, eval_time 0.6534, test_loss 2.5474, test_accuracy 0.5537, test_5_accuracy 1.0 

2021-08-18:15:37:19,246 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:19,259 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:19,280 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:19,292 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:19,837 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:19,846 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:20,889 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:20,909 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:21,462 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:21,462 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:21,471 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:21,482 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:21,793 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:21,808 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:22,807 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:22,828 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:23,6 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:23,27 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:23,256 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:23,274 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:23,915 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:23,930 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:24,476 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:24,485 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:24,550 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:24,564 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:25,649 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:25,667 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:25,715 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:25,724 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:26,216 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:26,243 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:26,335 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:26,360 INFO     [learner.py:606] ====Pushing takes 0.02362847328186035 s
2021-08-18:15:37:26,392 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:26,400 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:37:26,401 INFO     [param_server.py:410] Lock worker 2 with localStep 46 , while globalStep is 45

2021-08-18:15:37:26,666 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:26,676 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:26,726 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:26,739 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:26,821 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:26,839 INFO     [learner.py:606] ====Pushing takes 0.01724100112915039 s
2021-08-18:15:37:26,867 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:26,874 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:26,875 INFO     [param_server.py:410] Lock worker 1 with localStep 46 , while globalStep is 45

2021-08-18:15:37:27,272 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:27,283 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:27,909 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:27,937 INFO     [learner.py:606] ====Pushing takes 0.025949478149414062 s
2021-08-18:15:37:27,967 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:27,974 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:27,974 INFO     [param_server.py:381] ====After aggregation in epoch: 45, virtual_clock: 1235.7023907458122, top_1: : 56.2439 % (1743.0), top_5: : 100.0 % (3099.0), test loss: 2.416309314745444, test len: 3099.0
2021-08-18:15:37:27,976 INFO     [param_server.py:410] Lock worker 3 with localStep 46 , while globalStep is 46

2021-08-18:15:37:27,976 INFO     [param_server.py:441] ====Epoch 47 completes 20 clients with loss 5.445989673674877, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:27,976 INFO     [param_server.py:450] ====Start to sample for epoch 47, global virtualClock: 1235.7023907458122, round_duration: 27.34830796796159
2021-08-18:15:37:27,977 INFO     [oort.py:208] Training selector: Pacer 45: lastExploitationUtil 178.21423411372237, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:27,978 INFO     [oort.py:321] scores are 26,{5: 0.08329710298113835, 6: 0.05224611880442515, 7: 0.09096898458673208, 11: 0.05029702732067195, 14: 0.0077612590224920746, 16: 0.5347445535100583, 17: 0.009382450421802475, 25: 0.004236926233800673, 27: 0.038563205520733064, 38: 0.11275362463978783, 50: 0.016088198975511073, 51: 0.05116251668803366, 53: 0.486490620240621, 55: 1.0909689685476929, 58: 0.00784674533603185, 59: 0.00664836770810895, 60: 0.003501509210621954, 65: 0.005227212662062331, 67: 0.0029142831814987394, 70: 0.006843645333878868, 71: 0.009165602196791823, 76: 0.004661772678294124, 79: 0.016282587108291977, 81: 0.023848476281342373, 84: 0.11012799493888825, 85: 0.08895909022223437, 86: 0.0034453204841851186, 87: 0.01180957157961457, 88: 0.004978113023131524, 97: 0.029021220085325605, 98: 0.23326259640701302, 99: 0.03268092652835585, 105: 0.01596349147214363, 107: 0.009415051189870561, 110: 0.026156322175074274, 111: 0.012273423855794332, 119: 0.012834840522269795},[55, 16, 53, 98, 38, 84, 7, 85, 5, 6, 51, 11, 27, 99, 97, 110, 81, 79, 50, 105, 119, 111, 87, 107, 17, 71, 58, 14, 70, 59, 65, 88, 76, 25, 60, 86, 67]
2021-08-18:15:37:27,978 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:27,979 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:27,980 INFO     [oort.py:398] At round 45, UCB exploited 37, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 276.69463337101024, 'duration': 7.864087706209871, 'time_stamp': 46, 'count': 44, 'status': True, 'gradient': 21.624932055853492}, [0.44377558496236547, -6.52188091045458e-06]), ({'reward': 623.4887318385681, 'duration': 8.010998429338052, 'time_stamp': 46, 'count': 44, 'status': True, 'gradient': 20.80262663310874}, [1.0, -6.52188091045458e-06]), ({'reward': 399.0765774386721, 'duration': 11.058674649423494, 'time_stamp': 46, 'count': 43, 'status': True, 'gradient': 18.040816375280684}, [0.6400644651682429, -6.52188091045458e-06])]
2021-08-18:15:37:27,980 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 85, 110, 71, 5, 27, 79, 50]
2021-08-18:15:37:28,253 INFO     [param_server.py:553] For epoch: 47, median_reward: 250.3416943764417, dev: 250.3416943764417
2021-08-18:15:37:28,839 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9456, Top-1 Accuracy: 574.0/1033 (0.5557), Top-5 Accuracy: 1.0
2021-08-18:15:37:28,840 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 512.3387, eval_time 0.5526, test_loss 1.9456, test_accuracy 0.5557, test_5_accuracy 1.0 

2021-08-18:15:37:28,896 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:28,899 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2739, Top-1 Accuracy: 554.0/1033 (0.5363), Top-5 Accuracy: 1.0
2021-08-18:15:37:28,900 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 512.4001, eval_time 0.6121, test_loss 2.2739, test_accuracy 0.5363, test_5_accuracy 1.0 

2021-08-18:15:37:28,917 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:28,934 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1928, Top-1 Accuracy: 581.0/1033 (0.5624), Top-5 Accuracy: 1.0
2021-08-18:15:37:28,937 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 512.4375, eval_time 0.6495, test_loss 2.1928, test_accuracy 0.5624, test_5_accuracy 1.0 

2021-08-18:15:37:28,996 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:29,8 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:29,12 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:29,20 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:29,709 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:29,719 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:30,828 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:30,843 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:31,480 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:31,495 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:31,529 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:31,548 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:31,711 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:31,729 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:32,811 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:32,830 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:32,955 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:32,982 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:33,332 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:33,341 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:33,930 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:33,943 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:33,952 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:33,964 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:34,553 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:34,567 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:35,47 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:35,56 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:35,692 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:35,703 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:37:35,704 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:35,718 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:36,155 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:37:36,188 INFO     [learner.py:606] ====Pushing takes 0.03197336196899414 s
2021-08-18:15:37:36,237 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:36,247 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:37:36,247 INFO     [param_server.py:410] Lock worker 2 with localStep 47 , while globalStep is 46

2021-08-18:15:37:36,684 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:36,687 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:36,693 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:36,702 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:37,181 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:37,196 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:37,249 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:37,275 INFO     [learner.py:606] ====Pushing takes 0.024674177169799805 s
2021-08-18:15:37:37,279 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:37,301 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:37,305 INFO     [learner.py:606] ====Pushing takes 0.02530193328857422 s
2021-08-18:15:37:37,307 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:37:37,308 INFO     [param_server.py:410] Lock worker 3 with localStep 47 , while globalStep is 46

2021-08-18:15:37:37,331 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:37,337 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:37,338 INFO     [param_server.py:381] ====After aggregation in epoch: 46, virtual_clock: 1263.0506987137737, top_1: : 55.1468 % (1709.0), top_5: : 100.0 % (3099.0), test loss: 2.1374393392492226, test len: 3099.0
2021-08-18:15:37:37,339 INFO     [param_server.py:410] Lock worker 1 with localStep 47 , while globalStep is 47

2021-08-18:15:37:37,339 INFO     [param_server.py:441] ====Epoch 48 completes 20 clients with loss 4.552677703012669, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:37,340 INFO     [param_server.py:450] ====Start to sample for epoch 48, global virtualClock: 1263.0506987137737, round_duration: 27.34830796796159
2021-08-18:15:37:37,340 INFO     [oort.py:208] Training selector: Pacer 46: lastExploitationUtil 318.25201669247963, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:37,341 INFO     [oort.py:321] scores are 26,{5: 0.04648559726034437, 6: 0.13825874362905155, 7: 0.09025545938764783, 11: 0.10534529431821878, 14: 0.006810116236365195, 16: 0.9360798722129554, 25: 0.004071408860062145, 27: 0.04158774520407275, 38: 0.01722763318860333, 50: 0.014959072216104157, 51: 0.050761217881948, 53: 0.4679601744165586, 55: 0.22170599940073651, 58: 0.004410604309849666, 59: 0.00570534534879711, 60: 0.0031060503444129066, 65: 0.005242281237986023, 67: 0.0025115564502957797, 70: 0.009403958382504287, 71: 0.02127838392466416, 76: 0.004114092042094539, 79: 0.03882718217982233, 81: 0.2097710450289523, 84: 0.3067449646536393, 85: 0.04911506026251892, 86: 0.003056207547320776, 87: 0.011681757017125349, 88: 0.004393267665854303, 97: 0.34224466618096133, 98: 0.23824471395162902, 99: 0.07875361353086491, 105: 0.02193567932288145, 107: 0.008265320559810056, 110: 0.11573244000774477, 111: 0.010145509394066745, 119: 0.017636551900198326},[16, 53, 97, 84, 98, 55, 81, 6, 110, 11, 7, 99, 51, 85, 5, 27, 79, 105, 71, 119, 38, 50, 87, 111, 70, 107, 14, 59, 65, 58, 88, 76, 25, 60, 86, 67]
2021-08-18:15:37:37,342 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:37,343 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:37,343 INFO     [oort.py:398] At round 46, UCB exploited 36, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 528.4839860045395, 'duration': 17.619275735353515, 'time_stamp': 47, 'count': 43, 'status': True, 'gradient': 13.127135707440573}, [0.7099071613694188, -6.383114534351799e-06]), ({'reward': 731.4345145339405, 'duration': 15.972045438625893, 'time_stamp': 47, 'count': 44, 'status': True, 'gradient': 20.716335476860785}, [0.982533694928305, -6.383114534351799e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 47, 'count': 44, 'status': True, 'gradient': 20.91821479533586}, [1.3433152184148184e-08, -6.383114534351799e-06])]
2021-08-18:15:37:37,344 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 79]
2021-08-18:15:37:37,630 INFO     [param_server.py:553] For epoch: 48, median_reward: 276.0705629424943, dev: 276.0705629424943
2021-08-18:15:37:38,198 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6114, Top-1 Accuracy: 562.0/1033 (0.544), Top-5 Accuracy: 1.0
2021-08-18:15:37:38,199 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 521.6976, eval_time 0.5451, test_loss 2.6114, test_accuracy 0.544, test_5_accuracy 1.0 

2021-08-18:15:37:38,260 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:38,277 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:38,324 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0502, Top-1 Accuracy: 544.0/1033 (0.5266), Top-5 Accuracy: 1.0
2021-08-18:15:37:38,324 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 521.8246, eval_time 0.6704, test_loss 3.0502, test_accuracy 0.5266, test_5_accuracy 1.0 

2021-08-18:15:37:38,325 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.836, Top-1 Accuracy: 545.0/1033 (0.5276), Top-5 Accuracy: 1.0
2021-08-18:15:37:38,326 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 521.8262, eval_time 0.6693, test_loss 2.836, test_accuracy 0.5276, test_5_accuracy 1.0 

2021-08-18:15:37:38,398 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:38,407 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:38,444 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:38,460 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:38,917 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:38,931 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:39,965 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:39,979 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:40,503 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:40,513 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:40,540 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:40,554 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:41,238 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:41,265 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:41,785 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:41,804 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:42,275 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:42,293 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:42,533 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:42,554 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:42,874 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:42,892 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:43,340 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:43,349 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:43,507 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:43,525 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:44,534 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:44,543 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:45,171 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:45,197 INFO     [learner.py:606] ====Pushing takes 0.024391651153564453 s
2021-08-18:15:37:45,232 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:45,239 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:37:45,239 INFO     [param_server.py:410] Lock worker 2 with localStep 48 , while globalStep is 47

2021-08-18:15:37:45,299 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:45,319 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:45,884 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:45,887 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:45,898 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:45,904 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:46,393 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:46,407 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:46,493 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:46,513 INFO     [learner.py:606] ====Pushing takes 0.02011561393737793 s
2021-08-18:15:37:46,542 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:46,548 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:46,549 INFO     [param_server.py:410] Lock worker 1 with localStep 48 , while globalStep is 47

2021-08-18:15:37:46,565 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:46,576 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:47,122 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:47,149 INFO     [learner.py:606] ====Pushing takes 0.02600860595703125 s
2021-08-18:15:37:47,184 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:47,191 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:47,191 INFO     [param_server.py:381] ====After aggregation in epoch: 47, virtual_clock: 1290.3990066817353, top_1: : 53.2753 % (1651.0), top_5: : 100.0 % (3099.0), test loss: 2.832558940958094, test len: 3099.0
2021-08-18:15:37:47,192 INFO     [param_server.py:410] Lock worker 3 with localStep 48 , while globalStep is 48

2021-08-18:15:37:47,193 INFO     [param_server.py:441] ====Epoch 49 completes 20 clients with loss 6.984495264904927, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:47,193 INFO     [param_server.py:450] ====Start to sample for epoch 49, global virtualClock: 1290.3990066817353, round_duration: 27.34830796796159
2021-08-18:15:37:47,194 INFO     [oort.py:208] Training selector: Pacer 47: lastExploitationUtil 321.0429233131311, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:47,194 INFO     [oort.py:321] scores are 26,{5: 0.00908579522247623, 6: 0.05143737606840823, 7: 0.10697145073263414, 11: 0.015402782075673683, 14: 0.008482542283986932, 16: 0.8597715457114861, 25: 0.0038527660579884965, 27: 0.07959462104150865, 38: 0.04755769347322934, 50: 0.01758333637461167, 51: 0.21338466998735398, 53: 0.3544697460545238, 55: 0.08956083203548221, 58: 0.0034922828174819075, 59: 0.0036302154152845264, 60: 0.0025897998905532876, 65: 0.005256983877749246, 67: 0.0019864221108491314, 70: 0.007445982447846031, 71: 0.009023723443546553, 76: 0.0033992980240096227, 79: 0.014083055082241632, 81: 0.17391257544105554, 84: 0.1376907942507455, 85: 0.00997207259441862, 86: 0.002548241365693489, 87: 0.09863446281899424, 88: 0.003629968883214579, 97: 0.34759522220889044, 98: 0.3485490212703075, 99: 0.11126531896489059, 105: 0.017447039329585964, 107: 0.006765117608816606, 110: 0.018127111497087456, 111: 0.008069460663218458, 119: 0.014027630971066928},[16, 53, 98, 97, 51, 81, 84, 99, 7, 87, 55, 27, 6, 38, 110, 50, 105, 11, 79, 119, 85, 5, 71, 14, 111, 70, 107, 65, 25, 59, 88, 58, 76, 60, 86, 67]
2021-08-18:15:37:47,195 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:37:47,196 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:47,196 INFO     [oort.py:398] At round 47, UCB exploited 36, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 431.7669427818721, 'duration': 19.55790138125729, 'time_stamp': 48, 'count': 41, 'status': True, 'gradient': 19.697863935131362}, [0.4333900931525869, -6.2501302110460685e-06]), ({'reward': 321.04415809360535, 'duration': 62.85745079072042, 'time_stamp': 48, 'count': 14, 'status': True, 'gradient': 17.224702678270425}, [0.3222484944800466, -6.2501302110460685e-06]), ({'reward': 441.429492441784, 'duration': 11.058674649423494, 'time_stamp': 48, 'count': 45, 'status': True, 'gradient': 18.05648552141748}, [0.4430891918473944, -6.2501302110460685e-06])]
2021-08-18:15:37:47,214 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 79, 50]
2021-08-18:15:37:47,535 INFO     [param_server.py:553] For epoch: 49, median_reward: 279.6739441741095, dev: 279.6739441741095
2021-08-18:15:37:48,64 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4809, Top-1 Accuracy: 590.0/1033 (0.5712), Top-5 Accuracy: 1.0
2021-08-18:15:37:48,65 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 531.5638, eval_time 0.5067, test_loss 2.4809, test_accuracy 0.5712, test_5_accuracy 1.0 

2021-08-18:15:37:48,135 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:48,134 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2641, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:37:48,137 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 531.6377, eval_time 0.5762, test_loss 2.2641, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:37:48,139 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1936, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:37:48,140 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 531.6406, eval_time 0.5792, test_loss 2.1936, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:37:48,150 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:48,208 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:48,217 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:48,226 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:48,236 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:48,950 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:48,964 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:49,971 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:49,992 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:50,383 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:50,397 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:50,614 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:50,635 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:50,876 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:50,897 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:52,91 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:52,105 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:52,228 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:52,256 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:52,464 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:52,484 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:53,173 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:53,183 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:53,235 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:53,244 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:53,262 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:53,282 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:53,801 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:53,802 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:53,810 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:53,823 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:53,945 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:53,970 INFO     [learner.py:606] ====Pushing takes 0.02417922019958496 s
2021-08-18:15:37:54,3 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:54,11 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:37:54,12 INFO     [param_server.py:410] Lock worker 1 with localStep 49 , while globalStep is 48

2021-08-18:15:37:54,337 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:54,347 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:54,977 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:54,986 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:37:55,630 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:37:55,660 INFO     [learner.py:606] ====Pushing takes 0.028851985931396484 s
2021-08-18:15:37:55,703 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:55,710 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:55,711 INFO     [param_server.py:410] Lock worker 2 with localStep 49 , while globalStep is 48

2021-08-18:15:37:56,11 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:56,24 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:56,702 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:56,722 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:57,297 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:57,325 INFO     [learner.py:606] ====Pushing takes 0.027237415313720703 s
2021-08-18:15:37:57,357 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:57,363 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:57,364 INFO     [param_server.py:381] ====After aggregation in epoch: 48, virtual_clock: 1318.2700053832798, top_1: : 56.8571 % (1762.0), top_5: : 100.0 % (3099.0), test loss: 2.312879213580379, test len: 3099.0
2021-08-18:15:37:57,365 INFO     [param_server.py:410] Lock worker 3 with localStep 49 , while globalStep is 49

2021-08-18:15:37:57,366 INFO     [param_server.py:441] ====Epoch 50 completes 20 clients with loss 3.5733543216575705, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:57,366 INFO     [param_server.py:450] ====Start to sample for epoch 50, global virtualClock: 1318.2700053832798, round_duration: 27.87099870154445
2021-08-18:15:37:57,367 INFO     [oort.py:208] Training selector: Pacer 48: lastExploitationUtil 246.4712297018699, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:57,367 INFO     [oort.py:321] scores are 26,{5: 0.04472709176992525, 6: 0.26917898233575, 7: 0.08888426470058126, 11: 0.10561799479388956, 14: 0.00835638310131546, 16: 0.08888426470058126, 25: 0.004050167983975842, 27: 0.02335977429394392, 38: 0.016965904543497376, 50: 0.0075299203205385695, 51: 0.1458891660741314, 53: 0.3212197826875922, 58: 0.004257832249228831, 59: 0.004429324672554411, 60: 0.0030233050406740726, 65: 0.005271337575260113, 67: 0.0024241419036568714, 70: 0.007368407890226442, 71: 0.00895555573694614, 76: 0.003998589766919922, 79: 0.004451642200377133, 81: 0.09894556900273993, 84: 0.46540562017540105, 85: 0.03479314370332934, 86: 0.0029747900576632563, 87: 0.07214400935036043, 88: 0.004269927593326681, 97: 0.3473793806081066, 98: 0.3270302725881133, 99: 0.09083855549613294, 105: 0.017187552945885552, 107: 0.008021055795523754, 110: 0.03884308902295286, 111: 0.007949445162229674, 119: 0.013819000775203637},[84, 97, 98, 53, 6, 51, 11, 81, 99, 7, 16, 87, 5, 110, 85, 27, 105, 38, 119, 71, 14, 107, 111, 50, 70, 65, 79, 59, 88, 58, 25, 76, 60, 86, 67]
2021-08-18:15:37:57,368 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:57,368 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:57,369 INFO     [oort.py:398] At round 48, UCB exploited 35, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 777.9834362627736, 'duration': 15.972045438625893, 'time_stamp': 49, 'count': 46, 'status': True, 'gradient': 20.729756723291334}, [1.0, -6.12257393008021e-06]), ({'reward': 408.6334434218712, 'duration': 21.753601635627824, 'time_stamp': 49, 'count': 42, 'status': True, 'gradient': 20.933073926670303}, [0.5252408747172738, -6.12257393008021e-06]), ({'reward': 717.6426270368836, 'duration': 13.298442137908651, 'time_stamp': 49, 'count': 46, 'status': True, 'gradient': 18.061267150565104}, [0.9224384720124382, -6.12257393008021e-06])]
2021-08-18:15:37:57,369 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 53, 6, 51, 84, 98, 97, 81, 99, 11, 87, 85, 110, 71, 5, 27, 79, 105, 119]
2021-08-18:15:37:57,670 INFO     [param_server.py:553] For epoch: 50, median_reward: 261.486095812367, dev: 261.486095812367
2021-08-18:15:37:58,150 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.302, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:37:58,151 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 541.6494, eval_time 0.4697, test_loss 2.302, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:37:58,209 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2437, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:37:58,209 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2005, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:37:58,210 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 541.7102, eval_time 0.5152, test_loss 2.2437, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:37:58,210 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 541.7103, eval_time 0.5176, test_loss 2.2005, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:37:58,226 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:37:58,241 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:58,292 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:37:58,292 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:37:58,300 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:58,306 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:58,955 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:58,964 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:59,861 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:59,870 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:00,876 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:00,886 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:01,83 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:01,111 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:38:01,384 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:01,393 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:02,624 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:02,639 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:02,904 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:38:02,931 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:03,108 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:03,122 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:03,180 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:03,193 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:03,759 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:03,768 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:03,992 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:04,12 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:04,571 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:04,598 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:04,760 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:04,761 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:04,769 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:04,781 INFO     [learner.py:606] ====Pushing takes 0.019987821578979492 s
2021-08-18:15:38:04,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:04,819 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:38:04,819 INFO     [param_server.py:410] Lock worker 1 with localStep 50 , while globalStep is 49

2021-08-18:15:38:05,254 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:05,263 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:38:05,764 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:38:05,791 INFO     [learner.py:606] ====Pushing takes 0.025521039962768555 s
2021-08-18:15:38:05,827 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:05,834 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:05,835 INFO     [param_server.py:410] Lock worker 2 with localStep 50 , while globalStep is 49

2021-08-18:15:38:06,366 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:06,376 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:06,942 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:06,951 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:07,554 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:07,573 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:38:08,162 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:38:08,198 INFO     [learner.py:606] ====Pushing takes 0.03484034538269043 s
2021-08-18:15:38:08,245 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:08,253 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:08,254 INFO     [param_server.py:381] ====After aggregation in epoch: 49, virtual_clock: 1349.9005781750043, top_1: : 56.5344 % (1752.0), top_5: : 100.0 % (3099.0), test loss: 2.2487468189663358, test len: 3099.0
2021-08-18:15:38:08,255 INFO     [param_server.py:410] Lock worker 3 with localStep 50 , while globalStep is 50

2021-08-18:15:38:08,256 INFO     [param_server.py:441] ====Epoch 51 completes 20 clients with loss 6.251322454581045, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:38:08,256 INFO     [param_server.py:450] ====Start to sample for epoch 51, global virtualClock: 1349.9005781750043, round_duration: 31.630572791724475
2021-08-18:15:38:08,257 INFO     [oort.py:208] Training selector: Pacer 49: lastExploitationUtil 328.6115604306594, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:08,257 INFO     [oort.py:321] scores are 26,{5: 0.05474237813698575, 6: 0.3032293036219535, 7: 0.08822495499012738, 11: 0.11929290315682219, 14: 0.009822220543315757, 16: 0.5693853185296496, 25: 0.0054646795574284516, 27: 0.07970039426359135, 38: 0.017011027323812003, 50: 0.007241502270991289, 51: 0.049619227393703974, 53: 0.5250955063091312, 58: 0.004062116710504723, 59: 0.004203548327248651, 60: 0.0028690141377108428, 65: 0.005285357311009531, 67: 0.0022660259122379493, 70: 0.008660939364965084, 71: 0.008889126826499847, 76: 0.003784623712635096, 79: 0.025243066344575436, 81: 0.03464736092420581, 84: 0.41964864847959243, 85: 0.00982333053194852, 86: 0.002822975061178294, 87: 0.010504011714385652, 88: 0.004041442149087232, 97: 0.27575071907162924, 98: 0.4923987069407013, 99: 0.0187711264542283, 105: 0.02772331336675476, 107: 0.007571319026283189, 110: 0.02903745082853951, 111: 0.009343899463886815, 119: 0.015172054035474024},[16, 53, 98, 84, 6, 97, 11, 7, 27, 5, 51, 81, 110, 105, 79, 99, 38, 119, 87, 85, 14, 111, 71, 70, 107, 50, 25, 65, 59, 58, 88, 76, 60, 86, 67]
2021-08-18:15:38:08,258 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000004
2021-08-18:15:38:08,259 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:08,259 INFO     [oort.py:398] At round 49, UCB exploited 35, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 696.468497116394, 'duration': 13.298442137908651, 'time_stamp': 50, 'count': 47, 'status': True, 'gradient': 19.711447622927025}, [0.8236682438680188, -6.000120002400053e-06]), ({'reward': 845.5670602176926, 'duration': 13.411352670399307, 'time_stamp': 50, 'count': 47, 'status': True, 'gradient': 17.863580156266842}, [1.0, -6.000120002400053e-06]), ({'reward': 371.8408023906893, 'duration': 11.90395711384456, 'time_stamp': 50, 'count': 48, 'status': True, 'gradient': 20.631657365881907}, [0.4397465593835786, -6.000120002400053e-06])]
2021-08-18:15:38:08,260 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105]
2021-08-18:15:38:08,537 INFO     [param_server.py:553] For epoch: 51, median_reward: 276.08953518809307, dev: 276.08953518809307
2021-08-18:15:38:09,83 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2582, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:38:09,85 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 552.5833, eval_time 0.5249, test_loss 2.2582, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:38:09,153 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:09,164 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7416, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:38:09,168 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 552.668, eval_time 0.6077, test_loss 2.7416, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:38:09,176 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:09,238 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:09,243 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5466, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:38:09,244 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 552.7441, eval_time 0.6791, test_loss 2.5466, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:38:09,245 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:09,337 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:09,353 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:09,776 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:09,785 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:10,721 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:10,731 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:11,333 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:11,350 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:11,625 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:11,646 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:12,24 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:12,44 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:12,500 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:12,510 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:13,50 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:13,71 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:13,454 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:13,464 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:13,584 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:13,604 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:13,740 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:13,757 INFO     [learner.py:606] ====Pushing takes 0.015939950942993164 s
2021-08-18:15:38:13,781 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:13,787 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:13,788 INFO     [param_server.py:410] Lock worker 1 with localStep 51 , while globalStep is 50

2021-08-18:15:38:14,6 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:14,16 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:14,37 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:14,46 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:14,719 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:14,729 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:15,147 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:15,160 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:15,716 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:15,725 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:38:17,23 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:38:17,53 INFO     [learner.py:606] ====Pushing takes 0.02928900718688965 s
2021-08-18:15:38:17,104 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:17,112 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:17,112 INFO     [param_server.py:410] Lock worker 2 with localStep 51 , while globalStep is 50

2021-08-18:15:38:17,320 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:17,334 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:17,953 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:17,976 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:18,497 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:18,511 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:38:19,72 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:38:19,107 INFO     [learner.py:606] ====Pushing takes 0.03346586227416992 s
2021-08-18:15:38:19,142 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:19,157 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:19,158 INFO     [param_server.py:381] ====After aggregation in epoch: 50, virtual_clock: 1378.5839811980202, top_1: : 58.3414 % (1808.0), top_5: : 100.0 % (3099.0), test loss: 2.5154589900264033, test len: 3099.0
2021-08-18:15:38:19,159 INFO     [param_server.py:410] Lock worker 3 with localStep 51 , while globalStep is 51

2021-08-18:15:38:19,160 INFO     [param_server.py:441] ====Epoch 52 completes 20 clients with loss 6.980838030269988, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:38:19,160 INFO     [param_server.py:450] ====Start to sample for epoch 52, global virtualClock: 1378.5839811980202, round_duration: 28.683403023015895
2021-08-18:15:38:19,161 INFO     [oort.py:208] Training selector: Pacer 50: lastExploitationUtil 309.48536861277404, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:19,161 INFO     [oort.py:321] scores are 26,{5: 0.030185325343916356, 6: 0.050300968809957075, 7: 0.08758216229418962, 11: 0.015062488019307782, 14: 0.008384346207639426, 25: 0.004900949926008673, 27: 0.007722876448840043, 38: 0.14317356216430427, 50: 0.0037395623615473664, 51: 0.05776889185387801, 53: 0.2888214129372637, 58: 0.003643073739744597, 59: 0.003769915444611665, 60: 0.0026417871292257616, 65: 0.005299057797607862, 67: 0.002034009980432462, 70: 0.007393064918365843, 71: 0.020158638681987334, 76: 0.00346975506982572, 79: 0.026725328060962263, 81: 0.029347359296365068, 84: 0.3006632672840559, 85: 0.04973105784158755, 86: 0.00259939436502622, 87: 0.053365281957308615, 88: 0.003705207030064081, 93: 0.08554303154792092, 97: 0.34696398048883337, 98: 0.4152184654333864, 99: 0.10487257151795433, 105: 0.03578625829698011, 107: 0.010055441516402997, 110: 0.03078072042014182, 111: 0.007976046525234797, 119: 0.013865243531583148},[98, 97, 84, 53, 38, 99, 7, 93, 51, 87, 6, 85, 105, 110, 5, 81, 79, 71, 11, 119, 107, 14, 111, 27, 70, 65, 25, 59, 50, 88, 58, 76, 60, 86, 67]
2021-08-18:15:38:19,162 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:38:19,163 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:19,163 INFO     [oort.py:398] At round 50, UCB exploited 35, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 108.98768145334834, 'duration': 28.420902733732795, 'time_stamp': 51, 'count': 45, 'status': True, 'gradient': 20.43882363427912}, [0.11249317883351255, -5.8824682836918415e-06]), ({'reward': 347.84979954607667, 'duration': 27.035726288496562, 'time_stamp': 51, 'count': 43, 'status': True, 'gradient': 11.503942499095235}, [0.3590606974587319, -5.8824682836918415e-06]), ({'reward': 968.7593184782445, 'duration': 15.972045438625893, 'time_stamp': 51, 'count': 48, 'status': True, 'gradient': 20.747703811363504}, [1.0, -5.8824682836918415e-06])]
2021-08-18:15:38:19,165 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 38, 93, 87, 85, 110, 71, 5, 27, 65, 79, 105]
2021-08-18:15:38:19,463 INFO     [param_server.py:553] For epoch: 52, median_reward: 278.90805036311394, dev: 278.90805036311394
2021-08-18:15:38:20,104 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0487, Top-1 Accuracy: 574.0/1033 (0.5557), Top-5 Accuracy: 1.0
2021-08-18:15:38:20,105 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 563.6036, eval_time 0.5857, test_loss 2.0487, test_accuracy 0.5557, test_5_accuracy 1.0 

2021-08-18:15:38:20,124 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1933, Top-1 Accuracy: 568.0/1033 (0.5499), Top-5 Accuracy: 1.0
2021-08-18:15:38:20,125 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 563.6252, eval_time 0.6048, test_loss 2.1933, test_accuracy 0.5499, test_5_accuracy 1.0 

2021-08-18:15:38:20,169 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4483, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:38:20,170 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 563.6705, eval_time 0.6456, test_loss 2.4483, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:38:20,173 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:20,196 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:20,199 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:20,205 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:20,237 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:20,252 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:20,912 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:20,926 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:21,914 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:21,928 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:22,487 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:22,501 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:22,523 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:22,532 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:23,113 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:23,133 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:23,699 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:23,713 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:23,717 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:23,726 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:24,196 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:24,210 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:24,291 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:24,309 INFO     [learner.py:606] ====Pushing takes 0.017595767974853516 s
2021-08-18:15:38:24,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:24,338 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:24,338 INFO     [param_server.py:410] Lock worker 1 with localStep 52 , while globalStep is 51

2021-08-18:15:38:24,388 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:24,399 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:24,905 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:24,915 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:25,42 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:25,51 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:25,436 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:25,446 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:25,618 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:25,627 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:26,7 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:26,34 INFO     [learner.py:606] ====Pushing takes 0.025768518447875977 s
2021-08-18:15:38:26,72 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:26,79 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:38:26,79 INFO     [param_server.py:410] Lock worker 2 with localStep 52 , while globalStep is 51

2021-08-18:15:38:27,715 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:27,724 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:38:29,474 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:38:29,493 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:30,94 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:30,112 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:30,686 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:30,704 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:38:31,173 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:38:31,211 INFO     [learner.py:606] ====Pushing takes 0.03613734245300293 s
2021-08-18:15:38:31,251 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:31,260 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:31,261 INFO     [param_server.py:381] ====After aggregation in epoch: 51, virtual_clock: 1406.599836693509, top_1: : 55.0823 % (1707.0), top_5: : 100.0 % (3099.0), test loss: 2.2301096474682844, test len: 3099.0
2021-08-18:15:38:31,262 INFO     [param_server.py:410] Lock worker 3 with localStep 52 , while globalStep is 52

2021-08-18:15:38:31,262 INFO     [param_server.py:441] ====Epoch 53 completes 20 clients with loss 5.344502870098751, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 27: 0, 38: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:38:31,263 INFO     [param_server.py:450] ====Start to sample for epoch 53, global virtualClock: 1406.599836693509, round_duration: 28.015855495488744
2021-08-18:15:38:31,263 INFO     [oort.py:208] Training selector: Pacer 51: lastExploitationUtil 220.21187983579972, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:31,264 INFO     [oort.py:321] scores are 26,{5: 0.024596534505738267, 6: 0.1384884749220804, 7: 0.08695519012354502, 11: 0.01510056313784254, 14: 0.008954720293774174, 27: 0.062169331602471636, 38: 0.06601713605154667, 50: 0.0037490152673356745, 51: 0.10168082392468879, 53: 0.05786723619645357, 58: 0.0038934403280197457, 59: 0.002942599052369261, 60: 0.002780202958466608, 65: 0.021890332589678003, 67: 0.002172700441196608, 70: 0.006062894960138361, 71: 0.008761191358126445, 76: 0.0036607973492126696, 79: 0.0038810074998657657, 81: 0.09971625804156986, 84: 0.04001634021679144, 85: 0.009681949672262167, 86: 0.0027355890351336994, 87: 0.0426137696379432, 88: 0.003909213129163043, 93: 0.0679240599075654, 97: 0.11974967901638052, 98: 0.49182416554752, 99: 0.03825302006480745, 105: 0.03473484591380357, 107: 0.008246253260987386, 110: 0.04488740370242743, 111: 0.0065409857499755504, 119: 0.011370590689646996},[98, 6, 97, 51, 81, 7, 93, 38, 27, 53, 110, 87, 84, 99, 105, 5, 65, 11, 119, 85, 14, 71, 107, 111, 70, 88, 58, 79, 50, 76, 59, 60, 86, 67]
2021-08-18:15:38:31,264 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:38:31,265 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:31,265 INFO     [oort.py:398] At round 51, UCB exploited 34, augment_factor 1.2692307692307692, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 257.2834631906636, 'duration': 15.972045438625893, 'time_stamp': 52, 'count': 49, 'status': True, 'gradient': 19.727416447240277}, [0.28840831968108616, -5.7693417181099685e-06]), ({'reward': 892.0559388656548, 'duration': 13.411352670399307, 'time_stamp': 52, 'count': 49, 'status': True, 'gradient': 17.87976048480777}, [1.0, -5.7693417181099685e-06]), ({'reward': 137.54185653893376, 'duration': 11.90395711384456, 'time_stamp': 52, 'count': 50, 'status': True, 'gradient': 20.648456842426135}, [0.15417576495226767, -5.7693417181099685e-06])]
2021-08-18:15:38:31,267 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 87, 85, 110, 71, 5, 27, 65, 105, 119]
2021-08-18:15:38:31,544 INFO     [param_server.py:553] For epoch: 53, median_reward: 257.0315612858296, dev: 257.0315612858296
2021-08-18:15:38:32,182 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0716, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:38:32,183 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 575.682, eval_time 0.5948, test_loss 2.0716, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:38:32,255 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:32,260 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2557, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:38:32,264 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 575.7642, eval_time 0.6749, test_loss 2.2557, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:38:32,278 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:32,285 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1934, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:38:32,286 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 575.7865, eval_time 0.6971, test_loss 2.1934, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:38:32,334 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:32,348 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:32,360 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:32,380 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:32,962 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:32,971 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:34,16 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:34,30 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:34,594 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:34,603 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:35,0 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:35,18 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:35,757 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:35,771 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:35,964 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:35,984 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:36,289 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:36,299 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:36,522 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:36,533 INFO     [learner.py:606] ====Pushing takes 0.00962066650390625 s
2021-08-18:15:38:36,549 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:36,555 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:38:36,556 INFO     [param_server.py:410] Lock worker 1 with localStep 53 , while globalStep is 52

2021-08-18:15:38:36,908 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:36,918 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:37,464 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:37,476 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:37,491 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:37,500 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:38,576 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:38,710 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:39,382 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:39,397 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:39,988 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:40,2 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:38:40,95 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:40,108 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:38:40,604 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:38:40,636 INFO     [learner.py:606] ====Pushing takes 0.029705524444580078 s
2021-08-18:15:38:40,676 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:40,684 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:38:40,685 INFO     [param_server.py:410] Lock worker 2 with localStep 53 , while globalStep is 52

2021-08-18:15:38:41,673 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:38:41,685 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:42,403 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:42,414 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:42,929 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:42,941 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:38:43,617 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:38:43,653 INFO     [learner.py:606] ====Pushing takes 0.03504657745361328 s
2021-08-18:15:38:43,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:43,699 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:43,700 INFO     [param_server.py:381] ====After aggregation in epoch: 52, virtual_clock: 1437.4275947535773, top_1: : 58.4705 % (1812.0), top_5: : 100.0 % (3099.0), test loss: 2.173568341467116, test len: 3099.0
2021-08-18:15:38:43,701 INFO     [param_server.py:410] Lock worker 3 with localStep 53 , while globalStep is 53

2021-08-18:15:38:43,701 INFO     [param_server.py:441] ====Epoch 54 completes 20 clients with loss 5.570078454688904, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:38:43,701 INFO     [param_server.py:450] ====Start to sample for epoch 54, global virtualClock: 1437.4275947535773, round_duration: 30.82775806006842
2021-08-18:15:38:43,702 INFO     [oort.py:208] Training selector: Pacer 52: lastExploitationUtil 340.12213854912187, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:43,702 INFO     [oort.py:321] scores are 26,{5: 0.09727734382474669, 6: 0.3626319344557579, 7: 0.29865283134581505, 11: 0.07654486767090418, 14: 0.011029990606347595, 27: 0.06932511560292118, 50: 0.003758261570001618, 51: 0.6109781354281353, 53: 0.05746008608702124, 58: 0.004453863204869257, 59: 0.0033318228240628448, 60: 0.0030879581792700467, 65: 0.037551560145300075, 67: 0.0024830937565248003, 70: 0.009725914768093999, 71: 0.038840228700864864, 76: 0.004086146373818924, 79: 0.003890579339566312, 81: 0.07407268454647475, 84: 0.1437895523725454, 85: 0.0849885863150928, 86: 0.003038405707193992, 87: 0.05213549259161846, 93: 0.11043877900279203, 97: 0.33496549380547574, 98: 0.39563867387924356, 99: 0.018370794148319623, 105: 0.020472339469453954, 107: 0.013228392855193092, 110: 0.009165494173407675, 111: 0.010492853714577269, 119: 0.008212881554548135},[51, 98, 6, 97, 7, 84, 93, 5, 85, 11, 81, 27, 53, 87, 71, 65, 105, 99, 107, 14, 111, 70, 110, 119, 58, 76, 79, 50, 59, 60, 86, 67]
2021-08-18:15:38:43,715 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:43,715 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:43,716 INFO     [oort.py:398] At round 52, UCB exploited 32, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 596.7562767884758, 'duration': 13.411352670399307, 'time_stamp': 53, 'count': 50, 'status': True, 'gradient': 17.887390296328785}, [0.7880372272005356, -5.660484160078497e-06]), ({'reward': 757.2664573224745, 'duration': 12.029357192292537, 'time_stamp': 53, 'count': 50, 'status': True, 'gradient': 26.824827092221884}, [1.0, -5.660484160078497e-06]), ({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 53, 'count': 50, 'status': True, 'gradient': 19.735866592107094}, [1.3205565659092793e-08, -5.660484160078497e-06])]
2021-08-18:15:38:43,721 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50]
2021-08-18:15:38:44,1 INFO     [param_server.py:553] For epoch: 54, median_reward: 278.9053346803408, dev: 278.9053346803408
2021-08-18:15:38:44,640 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.297, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:38:44,641 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 588.1392, eval_time 0.5946, test_loss 2.297, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:38:44,685 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3379, Top-1 Accuracy: 562.0/1033 (0.544), Top-5 Accuracy: 1.0
2021-08-18:15:38:44,686 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 588.1861, eval_time 0.6396, test_loss 2.3379, test_accuracy 0.544, test_5_accuracy 1.0 

2021-08-18:15:38:44,708 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:44,733 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:44,762 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:44,773 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4342, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:38:44,774 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 588.2744, eval_time 0.7277, test_loss 2.4342, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:38:44,777 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:44,865 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:44,884 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:46,13 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:46,23 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:47,36 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:47,46 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:47,469 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:47,497 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:47,520 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:47,531 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:48,676 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:48,721 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:49,371 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:49,371 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:49,392 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:49,399 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:49,694 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:49,705 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:49,773 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:49,789 INFO     [learner.py:606] ====Pushing takes 0.014474630355834961 s
2021-08-18:15:38:49,811 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:49,816 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:49,816 INFO     [param_server.py:410] Lock worker 1 with localStep 54 , while globalStep is 53

2021-08-18:15:38:50,836 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:50,846 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:51,489 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:51,498 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:52,449 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:52,469 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:54,352 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:54,363 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:38:54,966 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:54,980 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:55,744 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:55,757 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:56,469 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:56,480 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:38:56,698 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:38:56,712 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:57,34 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:38:57,63 INFO     [learner.py:606] ====Pushing takes 0.027793407440185547 s
2021-08-18:15:38:57,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:57,111 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:57,112 INFO     [param_server.py:410] Lock worker 2 with localStep 54 , while globalStep is 53

2021-08-18:15:38:57,395 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:57,407 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:58,49 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:58,86 INFO     [learner.py:606] ====Pushing takes 0.0348203182220459 s
2021-08-18:15:38:58,119 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:58,127 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:58,127 INFO     [param_server.py:381] ====After aggregation in epoch: 53, virtual_clock: 1475.823616312363, top_1: : 54.566 % (1691.0), top_5: : 100.0 % (3099.0), test loss: 2.356346430601897, test len: 3099.0
2021-08-18:15:38:58,128 INFO     [param_server.py:410] Lock worker 3 with localStep 54 , while globalStep is 54

2021-08-18:15:38:58,129 INFO     [param_server.py:441] ====Epoch 55 completes 20 clients with loss 4.062190818567362, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:58,129 INFO     [param_server.py:450] ====Start to sample for epoch 55, global virtualClock: 1475.823616312363, round_duration: 38.39602155878561
2021-08-18:15:38:58,130 INFO     [oort.py:208] Training selector: Pacer 53: lastExploitationUtil 307.46579995521057, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:58,130 INFO     [oort.py:321] scores are 26,{5: 0.06137203632468105, 6: 0.3078079825072938, 7: 0.2286256340950257, 11: 0.03834633768285387, 14: 0.010641691963847219, 27: 0.048623348135486306, 50: 0.0036611668428496026, 51: 0.04822507991390165, 53: 0.43641096320327954, 58: 0.004298823973689496, 59: 0.0032248966030474515, 60: 0.0030048411758682608, 65: 0.01787549388128816, 67: 0.002397275749970283, 70: 0.008618867524302902, 71: 0.033295741731607514, 76: 0.0019509983772108492, 79: 0.04845931247077903, 81: 0.15980799725049194, 84: 0.38484038684404975, 85: 0.07617766907943516, 86: 0.0029566224825388746, 87: 0.01177212908372617, 93: 0.13629858250110755, 97: 0.17995886452144674, 98: 0.07685893776676958, 99: 0.14191067036532032, 105: 0.020104375886142372, 107: 0.01172267784541646, 110: 0.03243276965513553, 111: 0.00929851003984832, 119: 0.016164161753002386},[53, 84, 6, 7, 97, 81, 99, 93, 98, 85, 5, 27, 79, 51, 11, 71, 110, 105, 65, 119, 87, 107, 14, 111, 70, 58, 50, 59, 60, 86, 67, 76]
2021-08-18:15:38:58,131 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:58,132 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:58,132 INFO     [oort.py:398] At round 53, UCB exploited 32, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 450.8011892533101, 'duration': 11.058674649423494, 'time_stamp': 54, 'count': 51, 'status': True, 'gradient': 20.051639378473116}, [0.570034289518979, -5.555658438119229e-06]), ({'reward': 459.6620746965626, 'duration': 19.55790138125729, 'time_stamp': 54, 'count': 47, 'status': True, 'gradient': 19.73841454011721}, [0.5812390524924356, -5.555658438119229e-06]), ({'reward': 593.5231633359818, 'duration': 13.298442137908651, 'time_stamp': 54, 'count': 51, 'status': True, 'gradient': 20.771507824110714}, [0.7505090175742752, -5.555658438119229e-06])]
2021-08-18:15:38:58,133 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 105]
2021-08-18:15:38:58,409 INFO     [param_server.py:553] For epoch: 55, median_reward: 276.04426206367265, dev: 276.04426206367265
2021-08-18:15:38:59,10 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3728, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:38:59,11 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 602.5114, eval_time 0.5573, test_loss 2.3728, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:38:59,37 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0971, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:38:59,38 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 602.5381, eval_time 0.5838, test_loss 2.0971, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:38:59,113 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:38:59,115 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:38:59,123 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:59,124 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:59,125 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3055, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:38:59,128 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 602.6269, eval_time 0.6746, test_loss 2.3055, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:38:59,194 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:38:59,222 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:00,221 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:00,231 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:01,388 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:01,409 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:01,742 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:01,753 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:02,853 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:02,886 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:03,784 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:03,798 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:04,246 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:04,249 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:04,267 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:04,277 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:04,982 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:05,3 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:05,394 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:05,406 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:05,624 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:05,640 INFO     [learner.py:606] ====Pushing takes 0.014266729354858398 s
2021-08-18:15:39:05,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:05,667 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:05,668 INFO     [param_server.py:410] Lock worker 1 with localStep 55 , while globalStep is 54

2021-08-18:15:39:05,961 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:05,972 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:39:06,320 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:06,332 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:08,361 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:08,374 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:08,811 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:39:08,822 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:08,962 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:08,971 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:09,557 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:09,585 INFO     [learner.py:606] ====Pushing takes 0.025677204132080078 s
2021-08-18:15:39:09,616 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:09,623 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:39:09,623 INFO     [param_server.py:410] Lock worker 2 with localStep 55 , while globalStep is 54

2021-08-18:15:39:10,881 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:10,892 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:11,442 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:11,454 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:12,35 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:12,47 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:12,519 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:12,557 INFO     [learner.py:606] ====Pushing takes 0.03613162040710449 s
2021-08-18:15:39:12,599 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:12,610 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:12,611 INFO     [param_server.py:381] ====After aggregation in epoch: 54, virtual_clock: 1510.4646511933515, top_1: : 58.7932 % (1822.0), top_5: : 100.0 % (3099.0), test loss: 2.2584532598654428, test len: 3099.0
2021-08-18:15:39:12,611 INFO     [param_server.py:410] Lock worker 3 with localStep 55 , while globalStep is 55

2021-08-18:15:39:12,612 INFO     [param_server.py:441] ====Epoch 56 completes 20 clients with loss 5.7150011068578035, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:39:12,612 INFO     [param_server.py:450] ====Start to sample for epoch 56, global virtualClock: 1510.4646511933515, round_duration: 34.64103488098859
2021-08-18:15:39:12,613 INFO     [oort.py:208] Training selector: Pacer 54: lastExploitationUtil 369.67073185772796, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:12,613 INFO     [oort.py:321] scores are 26,{5: 0.04413570657957906, 6: 0.40735643741563904, 7: 0.085162784701746, 11: 0.014646400484520103, 14: 0.009048589590235504, 27: 0.09568818375364078, 50: 0.0036697749768019403, 51: 0.16887867328858638, 53: 0.3467100753218427, 58: 0.003442508210172243, 59: 0.0026316578920367187, 60: 0.0016698956049517552, 65: 0.019890001385495147, 67: 0.0019231021813558825, 70: 0.007978774802894852, 71: 0.09703847188788389, 76: 0.001564328290525433, 79: 0.02022983822309971, 81: 0.17923807519564655, 84: 0.19027859507868577, 85: 0.009482375856582027, 86: 0.0024978655745065284, 87: 0.030797432657204804, 93: 0.014807076022565343, 97: 0.2728016983179255, 98: 0.3796645142646337, 105: 0.006046788544409814, 107: 0.010852076140133912, 110: 0.009040172106417225, 111: 0.008607942679384339, 119: 0.014963706791073261},[6, 98, 53, 97, 84, 81, 51, 71, 27, 7, 5, 87, 79, 65, 119, 93, 11, 107, 85, 14, 110, 111, 70, 105, 50, 58, 59, 86, 67, 60, 76]
2021-08-18:15:39:12,614 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:39:12,614 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:12,615 INFO     [oort.py:398] At round 54, UCB exploited 31, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 55, 'count': 52, 'status': True, 'gradient': 20.986272513595168}, [9.579745083188927e-09, -5.4546446299023665e-06]), ({'reward': 384.25100181600027, 'duration': 42.701901101086094, 'time_stamp': 55, 'count': 17, 'status': True, 'gradient': 9.877062785871454}, [0.3680930943704017, -5.4546446299023665e-06]), ({'reward': 803.7397989624992, 'duration': 15.972045438625893, 'time_stamp': 55, 'count': 52, 'status': True, 'gradient': 20.782315388409593}, [0.7699526685621192, -5.4546446299023665e-06])]
2021-08-18:15:39:12,615 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 110, 71, 5, 27, 65, 79, 50, 105, 119]
2021-08-18:15:39:12,889 INFO     [param_server.py:553] For epoch: 56, median_reward: 285.8976790137944, dev: 285.8976790137944
2021-08-18:15:39:13,544 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1853, Top-1 Accuracy: 573.0/1033 (0.5547), Top-5 Accuracy: 1.0
2021-08-18:15:39:13,561 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 617.0616, eval_time 0.6089, test_loss 2.1853, test_accuracy 0.5547, test_5_accuracy 1.0 

2021-08-18:15:39:13,583 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.254, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:39:13,584 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 617.084, eval_time 0.6341, test_loss 2.254, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:39:13,629 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:13,645 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:13,665 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1515, Top-1 Accuracy: 584.0/1033 (0.5653), Top-5 Accuracy: 1.0
2021-08-18:15:39:13,665 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 617.1641, eval_time 0.721, test_loss 2.1515, test_accuracy 0.5653, test_5_accuracy 1.0 

2021-08-18:15:39:13,668 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:13,690 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:13,731 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:13,761 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:14,355 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:14,369 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:15,488 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:15,498 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:15,895 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:15,908 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:16,945 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:16,966 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:17,207 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:17,221 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:17,909 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:17,918 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:18,217 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:18,238 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:18,663 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:18,677 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:18,714 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:18,730 INFO     [learner.py:606] ====Pushing takes 0.013650894165039062 s
2021-08-18:15:39:18,747 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:18,751 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:39:18,751 INFO     [param_server.py:410] Lock worker 1 with localStep 56 , while globalStep is 55

2021-08-18:15:39:18,785 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:18,795 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:19,251 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:19,265 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:20,409 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:20,418 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:20,847 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:20,858 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:21,26 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:21,35 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:21,467 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:21,477 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:21,639 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:21,649 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:22,96 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:22,108 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:22,674 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:22,714 INFO     [learner.py:606] ====Pushing takes 0.03678321838378906 s
2021-08-18:15:39:22,762 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:22,769 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:39:22,770 INFO     [param_server.py:410] Lock worker 3 with localStep 56 , while globalStep is 55

2021-08-18:15:39:22,810 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:22,819 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:39:23,307 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:39:23,343 INFO     [learner.py:606] ====Pushing takes 0.03411436080932617 s
2021-08-18:15:39:23,379 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:23,387 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:23,388 INFO     [param_server.py:381] ====After aggregation in epoch: 55, virtual_clock: 1541.29240925342, top_1: : 55.7277 % (1727.0), top_5: : 100.0 % (3099.0), test loss: 2.1969261279812566, test len: 3099.0
2021-08-18:15:39:23,389 INFO     [param_server.py:410] Lock worker 2 with localStep 56 , while globalStep is 56

2021-08-18:15:39:23,390 INFO     [param_server.py:441] ====Epoch 57 completes 20 clients with loss 6.781970655326622, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:39:23,390 INFO     [param_server.py:450] ====Start to sample for epoch 57, global virtualClock: 1541.29240925342, round_duration: 30.82775806006842
2021-08-18:15:39:23,391 INFO     [oort.py:208] Training selector: Pacer 55: lastExploitationUtil 348.9208339827687, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:23,391 INFO     [oort.py:321] scores are 26,{5: 0.04183974069947585, 6: 0.11205792661262294, 7: 0.0845928700364913, 11: 0.09599210456953668, 14: 0.008303567856106132, 27: 0.08692435382873871, 50: 0.04630968834302346, 51: 0.047576480539960754, 53: 0.1650139250307308, 58: 0.003434056647002562, 59: 0.0025459669520195424, 60: 0.0016073228144547584, 65: 0.018515148785995805, 67: 0.0018756389034568603, 70: 0.0073218369916921945, 71: 0.008523175222431522, 76: 0.001508182717952587, 79: 0.007812260443425693, 81: 0.14299287513805872, 84: 0.2652614919188519, 85: 0.009504160022193639, 86: 0.002432497013665211, 87: 0.010071577796965048, 93: 0.06464163966310427, 97: 0.2410910318633856, 98: 0.3533925177131134, 105: 0.02063279519761271, 107: 0.009958563123083028, 110: 0.008979674711012445, 111: 0.00789920190621438, 119: 0.0028815218990305993},[98, 84, 97, 53, 81, 6, 11, 27, 7, 93, 51, 50, 5, 105, 65, 87, 107, 85, 110, 71, 14, 111, 79, 70, 58, 119, 59, 86, 67, 60, 76]
2021-08-18:15:39:23,392 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:39:23,392 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:23,393 INFO     [oort.py:398] At round 55, UCB exploited 31, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 762.8637903577526, 'duration': 13.411352670399307, 'time_stamp': 56, 'count': 53, 'status': True, 'gradient': 17.908783028994378}, [0.6964216849921784, -5.35723852211647e-06]), ({'reward': 178.96191159770464, 'duration': 11.058674649423494, 'time_stamp': 56, 'count': 53, 'status': True, 'gradient': 19.759243139591685}, [0.16336812992635852, -5.35723852211647e-06]), ({'reward': 987.1570913072139, 'duration': 30.380154975061778, 'time_stamp': 56, 'count': 50, 'status': True, 'gradient': 11.52684231615679}, [0.9011827001518694, -5.35723852211647e-06])]
2021-08-18:15:39:23,394 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 71, 5, 27, 65, 79, 50, 105, 119, 107]
2021-08-18:15:39:23,663 INFO     [param_server.py:553] For epoch: 57, median_reward: 280.78677490040224, dev: 280.78677490040224
2021-08-18:15:39:24,228 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1957, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:39:24,229 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 627.7293, eval_time 0.5079, test_loss 2.1957, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:39:24,296 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:24,305 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4092, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:39:24,306 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 627.8059, eval_time 0.5847, test_loss 2.4092, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:39:24,312 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:24,357 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1294, Top-1 Accuracy: 590.0/1033 (0.5712), Top-5 Accuracy: 1.0
2021-08-18:15:39:24,358 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 627.8566, eval_time 0.6397, test_loss 2.1294, test_accuracy 0.5712, test_5_accuracy 1.0 

2021-08-18:15:39:24,374 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:24,391 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:24,421 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:24,448 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:25,570 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:25,590 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:26,883 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:26,910 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:27,4 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:27,24 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:27,558 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:27,585 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:28,743 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:28,763 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:29,76 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:29,87 INFO     [learner.py:606] ====Pushing takes 0.010265588760375977 s
2021-08-18:15:39:29,104 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:29,110 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:39:29,111 INFO     [param_server.py:410] Lock worker 1 with localStep 57 , while globalStep is 56

2021-08-18:15:39:29,118 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:29,132 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:29,555 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:29,574 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:30,954 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:30,968 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:31,225 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:31,235 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:31,593 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:31,602 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:31,800 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:31,810 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:32,395 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:32,404 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:32,980 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:32,990 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:39:33,887 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:39:33,896 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:39:33,909 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:33,918 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:34,353 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:39:34,389 INFO     [learner.py:606] ====Pushing takes 0.03544354438781738 s
2021-08-18:15:39:34,440 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:34,449 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:34,450 INFO     [param_server.py:410] Lock worker 2 with localStep 57 , while globalStep is 56

2021-08-18:15:39:34,450 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:34,460 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:35,50 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:35,59 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:35,545 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:35,580 INFO     [learner.py:606] ====Pushing takes 0.0343320369720459 s
2021-08-18:15:39:35,615 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:35,625 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:35,626 INFO     [param_server.py:381] ====After aggregation in epoch: 56, virtual_clock: 1580.4989997338141, top_1: : 56.9539 % (1765.0), top_5: : 100.0 % (3099.0), test loss: 2.2447900109820895, test len: 3099.0
2021-08-18:15:39:35,627 INFO     [param_server.py:410] Lock worker 3 with localStep 57 , while globalStep is 57

2021-08-18:15:39:35,628 INFO     [param_server.py:441] ====Epoch 58 completes 20 clients with loss 6.6670956325223925, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 119: 0} 
==========
2021-08-18:15:39:35,628 INFO     [param_server.py:450] ====Start to sample for epoch 58, global virtualClock: 1580.4989997338141, round_duration: 39.20659048039421
2021-08-18:15:39:35,629 INFO     [oort.py:208] Training selector: Pacer 56: lastExploitationUtil 384.52860323723877, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:35,630 INFO     [oort.py:321] scores are 26,{5: 0.05611098804556796, 6: 0.32278602195580364, 7: 0.08403583776413287, 11: 0.061451700558073016, 14: 0.00888771496763926, 27: 0.00916076920394634, 50: 0.006190502213324706, 51: 0.3473358347172191, 53: 0.25899413795453, 58: 0.003675638856716493, 59: 0.002529577003544309, 60: 0.001594928609820448, 65: 0.04442083761119398, 67: 0.002007588092855944, 70: 0.00783692038764087, 71: 0.008467051300169373, 76: 0.0014971731974582126, 79: 0.04838297950289656, 81: 0.1886674126778748, 84: 0.0734975962298525, 85: 0.009525503217210171, 87: 0.036154603282871886, 93: 0.014611136105416382, 97: 0.23589409387256519, 98: 0.21188251538409844, 105: 0.016237111976196386, 107: 0.01225357260254003, 110: 0.008999840085655138, 111: 0.008454902305957478, 119: 0.014536328001917929},[51, 6, 53, 97, 98, 81, 7, 84, 11, 5, 79, 65, 87, 105, 93, 119, 107, 85, 27, 110, 14, 71, 111, 70, 50, 58, 59, 67, 60, 76]
2021-08-18:15:39:35,631 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:39:35,631 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:35,632 INFO     [oort.py:398] At round 56, UCB exploited 30, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 337.7188048659586, 'duration': 11.058674649423494, 'time_stamp': 57, 'count': 54, 'status': True, 'gradient': 20.076767782499015}, [0.3051461330688791, -5.263250232460223e-06]), ({'reward': 590.4861639863002, 'duration': 12.029357192292537, 'time_stamp': 57, 'count': 54, 'status': True, 'gradient': 26.86740424779457}, [0.5335410662370267, -5.263250232460223e-06]), ({'reward': 725.3380592855293, 'duration': 15.972045438625893, 'time_stamp': 57, 'count': 54, 'status': True, 'gradient': 20.796245206011733}, [0.655390223191671, -5.263250232460223e-06])]
2021-08-18:15:39:35,633 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:39:35,970 INFO     [param_server.py:553] For epoch: 58, median_reward: 285.14958875015907, dev: 285.14958875015907
2021-08-18:15:39:36,552 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3536, Top-1 Accuracy: 571.0/1033 (0.5528), Top-5 Accuracy: 1.0
2021-08-18:15:39:36,553 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 640.0533, eval_time 0.5378, test_loss 2.3536, test_accuracy 0.5528, test_5_accuracy 1.0 

2021-08-18:15:39:36,590 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5645, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:39:36,591 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 640.0917, eval_time 0.5767, test_loss 2.5645, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:39:36,621 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:36,629 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:36,659 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:36,668 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4513, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:39:36,669 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 640.1674, eval_time 0.6543, test_loss 2.4513, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:39:36,674 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:36,736 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:36,763 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:37,275 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:37,289 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:38,357 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:38,375 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:38,909 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:38,923 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:39,945 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:39,958 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:39,966 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:39,971 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:40,781 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:40,798 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:41,187 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:41,207 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:41,386 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:41,400 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:41,711 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:41,724 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:41,783 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:41,797 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:41,958 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:41,967 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:42,213 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:42,236 INFO     [learner.py:606] ====Pushing takes 0.021595239639282227 s
2021-08-18:15:39:42,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:42,265 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:42,266 INFO     [param_server.py:410] Lock worker 1 with localStep 58 , while globalStep is 57

2021-08-18:15:39:42,893 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:42,903 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:43,479 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:43,489 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:43,490 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:43,499 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:44,53 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:44,72 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:44,93 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:44,112 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:44,694 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:44,703 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:45,272 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:45,309 INFO     [learner.py:606] ====Pushing takes 0.03566598892211914 s
2021-08-18:15:39:45,316 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:45,348 INFO     [learner.py:606] ====Pushing takes 0.030607938766479492 s
2021-08-18:15:39:45,352 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:45,362 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:45,362 INFO     [param_server.py:410] Lock worker 3 with localStep 58 , while globalStep is 57

2021-08-18:15:39:45,391 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:45,398 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:45,399 INFO     [param_server.py:381] ====After aggregation in epoch: 57, virtual_clock: 1609.18240275683, top_1: : 56.4698 % (1750.0), top_5: : 100.0 % (3099.0), test loss: 2.4564614869930126, test len: 3099.0
2021-08-18:15:39:45,399 INFO     [param_server.py:410] Lock worker 2 with localStep 58 , while globalStep is 58

2021-08-18:15:39:45,400 INFO     [param_server.py:441] ====Epoch 59 completes 20 clients with loss 8.740764748488331, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:39:45,400 INFO     [param_server.py:450] ====Start to sample for epoch 59, global virtualClock: 1609.18240275683, round_duration: 28.683403023015895
2021-08-18:15:39:45,401 INFO     [oort.py:208] Training selector: Pacer 57: lastExploitationUtil 364.89583253480384, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:45,401 INFO     [oort.py:321] scores are 26,{5: 0.018879583502666466, 6: 0.04795140659975296, 7: 0.1685195943594873, 11: 0.07597274190889872, 14: 0.0070957055749985495, 27: 0.021468489879729342, 50: 0.0247297152209546, 51: 0.046956878262252026, 53: 0.3508238690422427, 58: 0.002934528303647003, 59: 0.003036700425214146, 60: 0.0013310192462384985, 65: 0.004529293911659661, 67: 0.0016715331362901476, 70: 0.00625678027343104, 71: 0.008412175444364844, 76: 0.0012599064477730767, 79: 0.01694676990514239, 81: 0.14592061472200246, 84: 0.20446589065730555, 85: 0.060818660474113016, 87: 0.027893052238315907, 93: 0.026786400088293173, 97: 0.3456588670999197, 98: 0.24867257031570988, 105: 0.010401409608336994, 107: 0.010137017050936151, 110: 0.02112132713431415, 111: 0.006750159928270735, 119: 0.011734210800613707},[53, 97, 98, 84, 7, 81, 11, 85, 6, 51, 87, 93, 50, 27, 110, 5, 79, 119, 105, 107, 71, 14, 111, 70, 65, 59, 58, 67, 60, 76]
2021-08-18:15:39:45,402 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:39:45,402 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:45,403 INFO     [oort.py:398] At round 57, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 58, 'count': 55, 'status': True, 'gradient': 26.876223380046422}, [7.1526251676431595e-09, -5.1725029741892145e-06]), ({'reward': 1398.098071734984, 'duration': 15.972045438625893, 'time_stamp': 58, 'count': 55, 'status': True, 'gradient': 20.803699421050297}, [1.0, -5.1725029741892145e-06]), ({'reward': 620.3141142570935, 'duration': 11.058674649423494, 'time_stamp': 58, 'count': 55, 'status': True, 'gradient': 19.77452590539973}, [0.4436802890754317, -5.1725029741892145e-06])]
2021-08-18:15:39:45,404 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:39:45,747 INFO     [param_server.py:553] For epoch: 59, median_reward: 289.26903301174724, dev: 289.26903301174724
2021-08-18:15:39:46,331 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1687, Top-1 Accuracy: 575.0/1033 (0.5566), Top-5 Accuracy: 1.0
2021-08-18:15:39:46,332 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 649.8305, eval_time 0.5507, test_loss 2.1687, test_accuracy 0.5566, test_5_accuracy 1.0 

2021-08-18:15:39:46,370 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6509, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:39:46,372 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 649.8719, eval_time 0.5901, test_loss 2.6509, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:39:46,377 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2805, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:39:46,378 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 649.8782, eval_time 0.5946, test_loss 2.2805, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:39:46,393 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:46,410 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:46,442 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:46,448 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:46,452 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:46,457 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:47,427 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:47,436 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:48,502 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:48,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:48,997 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:49,6 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:49,437 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:49,464 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:50,609 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:50,630 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:50,675 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:50,685 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:51,233 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:51,259 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:51,545 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:51,559 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:51,635 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:51,651 INFO     [learner.py:606] ====Pushing takes 0.014800071716308594 s
2021-08-18:15:39:51,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:51,675 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:51,675 INFO     [param_server.py:410] Lock worker 1 with localStep 59 , while globalStep is 58

2021-08-18:15:39:52,832 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:52,847 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:53,239 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:53,253 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:53,507 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:53,518 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:55,484 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:55,493 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:55,599 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:55,610 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:56,59 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:56,69 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:56,262 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:56,272 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:56,844 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:56,858 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:56,907 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:56,917 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:57,403 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:57,426 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:57,433 INFO     [learner.py:606] ====Pushing takes 0.028623104095458984 s
2021-08-18:15:39:57,477 INFO     [learner.py:606] ====Pushing takes 0.05006051063537598 s
2021-08-18:15:39:57,486 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:57,495 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:57,495 INFO     [param_server.py:410] Lock worker 2 with localStep 59 , while globalStep is 58

2021-08-18:15:39:57,523 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:57,531 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:57,532 INFO     [param_server.py:381] ====After aggregation in epoch: 58, virtual_clock: 1647.5784243156156, top_1: : 55.534 % (1721.0), top_5: : 100.0 % (3099.0), test loss: 2.3666850990719266, test len: 3099.0
2021-08-18:15:39:57,533 INFO     [param_server.py:410] Lock worker 3 with localStep 59 , while globalStep is 59

2021-08-18:15:39:57,533 INFO     [param_server.py:441] ====Epoch 60 completes 20 clients with loss 4.720556245565211, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:39:57,533 INFO     [param_server.py:450] ====Start to sample for epoch 60, global virtualClock: 1647.5784243156156, round_duration: 38.39602155878561
2021-08-18:15:39:57,534 INFO     [oort.py:208] Training selector: Pacer 58: lastExploitationUtil 302.5598935934031, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:57,535 INFO     [oort.py:321] scores are 26,{5: 0.06403485915587488, 6: 0.16147271038952174, 7: 0.2522447027471405, 11: 0.014267300822986563, 14: 0.00922628386213957, 27: 0.037325833575077946, 50: 0.03358264997311096, 51: 0.1581388366509976, 53: 0.05520748949937855, 58: 0.004462280577907956, 59: 0.00394850939503805, 60: 0.0020216897343798223, 65: 0.04194443180809252, 67: 0.0025508319572671613, 70: 0.00813546028024448, 71: 0.061979563377875774, 76: 0.0018813444611744798, 79: 0.019370188684837412, 81: 0.021748437279445823, 84: 0.30542883905189383, 85: 0.05330587880978617, 87: 0.009876987837797124, 93: 0.03244677438226024, 97: 0.3005898677036023, 98: 0.49001573694608125, 105: 0.027731178004710685, 107: 0.011065186896140519, 110: 0.008806181086618887, 111: 0.00877698362126281, 119: 0.01525756087260825},[98, 84, 97, 7, 6, 51, 5, 71, 53, 85, 65, 27, 50, 93, 105, 81, 79, 119, 11, 107, 87, 14, 110, 111, 70, 58, 59, 67, 60, 76]
2021-08-18:15:39:57,535 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:57,536 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:57,536 INFO     [oort.py:398] At round 58, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 140.34872392409432, 'duration': 5.8943907365129, 'time_stamp': 59, 'count': 56, 'status': True, 'gradient': 21.01175166657859}, [0.16928623845604898, -5.0848319463041785e-06]), ({'reward': 501.6117095089572, 'duration': 29.570969934622333, 'time_stamp': 59, 'count': 46, 'status': True, 'gradient': 19.780367540087383}, [0.6050665124618091, -5.0848319463041785e-06]), ({'reward': 481.44163632321636, 'duration': 13.298442137908651, 'time_stamp': 59, 'count': 56, 'status': True, 'gradient': 20.810367489768097}, [0.58073598215473, -5.0848319463041785e-06])]
2021-08-18:15:39:57,537 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:39:57,854 INFO     [param_server.py:553] For epoch: 60, median_reward: 275.00400535076847, dev: 275.00400535076847
2021-08-18:15:39:58,452 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0626, Top-1 Accuracy: 572.0/1033 (0.5537), Top-5 Accuracy: 1.0
2021-08-18:15:39:58,453 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 661.9533, eval_time 0.5631, test_loss 3.0626, test_accuracy 0.5537, test_5_accuracy 1.0 

2021-08-18:15:39:58,501 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4096, Top-1 Accuracy: 568.0/1033 (0.5499), Top-5 Accuracy: 1.0
2021-08-18:15:39:58,502 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 662.0024, eval_time 0.613, test_loss 2.4096, test_accuracy 0.5499, test_5_accuracy 1.0 

2021-08-18:15:39:58,526 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:39:58,530 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2034, Top-1 Accuracy: 577.0/1033 (0.5586), Top-5 Accuracy: 1.0
2021-08-18:15:39:58,533 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 662.032, eval_time 0.6446, test_loss 2.2034, test_accuracy 0.5586, test_5_accuracy 1.0 

2021-08-18:15:39:58,536 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:58,572 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:39:58,586 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:58,602 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:39:58,624 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:59,870 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:59,882 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:00,991 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:01,1 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:01,245 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:01,259 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:02,253 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:02,286 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:03,234 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:03,246 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:03,574 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:03,588 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:03,633 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:03,646 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:04,338 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:04,352 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:04,700 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:04,710 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:04,775 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:04,798 INFO     [learner.py:606] ====Pushing takes 0.021325349807739258 s
2021-08-18:15:40:04,822 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:04,829 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:04,830 INFO     [param_server.py:410] Lock worker 1 with localStep 60 , while globalStep is 59

2021-08-18:15:40:05,318 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:05,332 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:05,466 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:05,477 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:07,168 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:07,178 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:07,528 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:07,539 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:07,777 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:07,786 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:08,82 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:08,93 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:08,419 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:08,429 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:08,779 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:08,793 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:09,335 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:09,373 INFO     [learner.py:606] ====Pushing takes 0.03628826141357422 s
2021-08-18:15:40:09,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:09,422 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:09,423 INFO     [param_server.py:410] Lock worker 3 with localStep 60 , while globalStep is 59

2021-08-18:15:40:10,264 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:10,294 INFO     [learner.py:606] ====Pushing takes 0.027918577194213867 s
2021-08-18:15:40:10,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:10,341 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:10,341 INFO     [param_server.py:381] ====After aggregation in epoch: 59, virtual_clock: 1681.4011439142903, top_1: : 55.405 % (1717.0), top_5: : 100.0 % (3099.0), test loss: 2.558509711866026, test len: 3099.0
2021-08-18:15:40:10,343 INFO     [param_server.py:410] Lock worker 2 with localStep 60 , while globalStep is 60

2021-08-18:15:40:10,343 INFO     [param_server.py:441] ====Epoch 61 completes 20 clients with loss 5.529390035619925, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:10,343 INFO     [param_server.py:450] ====Start to sample for epoch 61, global virtualClock: 1681.4011439142903, round_duration: 33.82271959867463
2021-08-18:15:40:10,344 INFO     [oort.py:208] Training selector: Pacer 59: lastExploitationUtil 269.3033744510782, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:40:10,345 INFO     [oort.py:321] scores are 26,{5: 0.01143941479795958, 6: 0.17068325916312685, 7: 0.082437235177851, 11: 0.014177657124293403, 14: 0.00844000874532717, 27: 0.09544784826112213, 50: 0.014588822952713501, 51: 0.12682960620797507, 53: 0.6147108914030442, 58: 0.004492240196323709, 59: 0.0036120126286033737, 60: 0.0020352430230727568, 65: 0.025243260754813153, 67: 0.002568039076582806, 70: 0.007442146473976168, 71: 0.0523407744769885, 76: 0.0018936683844897773, 79: 0.02013903985104848, 81: 0.02161178842184379, 84: 0.16850652236492675, 85: 0.034195446438915755, 87: 0.014376131455162897, 93: 0.08502728495742164, 97: 0.25335227465579, 98: 0.2353129770687102, 105: 0.035521180678744865, 107: 0.01012219822927152, 110: 0.008750850463555667, 111: 0.008028998416690037, 119: 0.013957293003481539},[53, 97, 98, 6, 84, 51, 27, 93, 7, 71, 105, 85, 65, 81, 79, 50, 87, 11, 119, 5, 107, 110, 14, 111, 70, 58, 59, 67, 60, 76]
2021-08-18:15:40:10,346 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:40:10,347 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:10,347 INFO     [oort.py:398] At round 59, UCB exploited 30, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 585.5768982709126, 'duration': 15.972045438625893, 'time_stamp': 60, 'count': 57, 'status': True, 'gradient': 20.81740870300458}, [0.7117126817844934, -5.0000833347222494e-06]), ({'reward': 359.593786513788, 'duration': 28.420902733732795, 'time_stamp': 60, 'count': 54, 'status': True, 'gradient': 20.507837437677058}, [0.43704714957129387, -5.0000833347222494e-06]), ({'reward': 692.169986054133, 'duration': 11.058674649423494, 'time_stamp': 60, 'count': 57, 'status': True, 'gradient': 20.094952240874782}, [0.8412685895626485, -5.0000833347222494e-06])]
2021-08-18:15:40:10,348 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 27, 65, 79, 50, 105, 119]
2021-08-18:15:40:10,687 INFO     [param_server.py:541] Handle Wight 0.041214942932128906 | Send 0.3438997268676758
2021-08-18:15:40:10,689 INFO     [param_server.py:553] For epoch: 61, median_reward: 267.7983984894987, dev: 267.7983984894987
2021-08-18:15:40:11,367 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2298, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:40:11,368 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 674.8682, eval_time 0.6236, test_loss 2.2298, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:40:11,389 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2844, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:40:11,391 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 674.8893, eval_time 0.6482, test_loss 2.2844, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:40:11,420 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.437, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:40:11,421 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 674.9218, eval_time 0.6715, test_loss 2.437, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:40:11,435 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:11,452 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:11,466 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:11,490 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:11,493 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:11,511 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:12,698 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:12,716 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:13,857 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:13,870 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:14,335 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:14,345 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:14,528 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:14,549 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:15,644 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:15,664 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:15,988 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:16,0 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:16,239 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:16,259 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:16,569 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:16,584 INFO     [learner.py:606] ====Pushing takes 0.01311492919921875 s
2021-08-18:15:40:16,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:16,621 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:16,621 INFO     [param_server.py:410] Lock worker 1 with localStep 61 , while globalStep is 60

2021-08-18:15:40:16,839 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:16,848 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:17,808 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:17,818 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:18,458 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:18,467 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:18,726 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:18,740 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:20,719 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:20,730 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:20,938 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:20,952 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:21,355 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:21,365 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:21,563 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:21,584 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:22,8 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:22,17 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:22,147 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:22,174 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:40:22,617 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:22,657 INFO     [learner.py:606] ====Pushing takes 0.03499746322631836 s
2021-08-18:15:40:22,702 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:22,712 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:22,713 INFO     [param_server.py:410] Lock worker 3 with localStep 61 , while globalStep is 60

2021-08-18:15:40:22,884 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:40:22,916 INFO     [learner.py:606] ====Pushing takes 0.028147459030151367 s
2021-08-18:15:40:22,951 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:22,959 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:22,959 INFO     [param_server.py:381] ====After aggregation in epoch: 60, virtual_clock: 1719.797165473076, top_1: : 59.2126 % (1835.0), top_5: : 100.0 % (3099.0), test loss: 2.3170872176135027, test len: 3099.0
2021-08-18:15:40:22,961 INFO     [param_server.py:410] Lock worker 2 with localStep 61 , while globalStep is 61

2021-08-18:15:40:22,961 INFO     [param_server.py:441] ====Epoch 62 completes 20 clients with loss 5.362033344806035, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:40:22,961 INFO     [param_server.py:450] ====Start to sample for epoch 62, global virtualClock: 1719.797165473076, round_duration: 38.39602155878561
2021-08-18:15:40:22,962 INFO     [oort.py:208] Training selector: Pacer 60: lastExploitationUtil 318.10425722501316, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:40:22,963 INFO     [oort.py:321] scores are 26,{5: 0.011283505584877906, 6: 0.04705307652601224, 7: 0.2655768394787445, 11: 0.032681249861904745, 14: 0.009288260250744999, 27: 0.06861041265272308, 50: 0.0034981018881857485, 51: 0.046077179857071555, 53: 0.7200044944670858, 58: 0.0038412899618451516, 59: 0.0034819901029754623, 60: 0.0019580653564990414, 65: 0.04823592675293029, 67: 0.0020980646601109227, 70: 0.00819010920015052, 71: 0.0082545802720202, 76: 0.0018243713533328677, 79: 0.007961626060432214, 81: 0.11384542377285302, 84: 0.19374076400330228, 85: 0.009122096241536549, 87: 0.1025572859923822, 93: 0.014244486252865802, 97: 0.29670841526992475, 98: 0.36601795547275867, 105: 0.029081648893151988, 107: 0.011139515882037107, 110: 0.06037279361481526, 111: 0.008835941892634348, 119: 0.014749226862699015},[53, 98, 97, 7, 84, 81, 87, 27, 110, 65, 6, 51, 11, 105, 119, 93, 5, 107, 14, 85, 111, 71, 70, 79, 58, 50, 59, 67, 60, 76]
2021-08-18:15:40:22,964 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:40:22,965 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:22,965 INFO     [oort.py:398] At round 60, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 269.3044102332876, 'duration': 96.08455482729224, 'time_stamp': 60, 'count': 9, 'status': True, 'gradient': 17.940941830481048}, [0.3123877853251917, 0.004913195298283578]), ({'reward': 158.3256091462856, 'duration': 5.8943907365129, 'time_stamp': 61, 'count': 58, 'status': True, 'gradient': 21.02646368640582}, [0.18364979714266436, -4.918113411695278e-06]), ({'reward': 419.66866405264796, 'duration': 27.689063957948644, 'time_stamp': 61, 'count': 54, 'status': True, 'gradient': 20.309326688930497}, [0.48681381391506573, -4.918113411695278e-06])]
2021-08-18:15:40:22,966 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:23,307 INFO     [param_server.py:553] For epoch: 62, median_reward: 274.64852517523684, dev: 274.64852517523684
2021-08-18:15:40:23,864 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.194, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:40:23,865 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 687.3656, eval_time 0.5353, test_loss 2.194, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:40:23,892 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.175, Top-1 Accuracy: 591.0/1033 (0.5721), Top-5 Accuracy: 1.0
2021-08-18:15:40:23,893 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 687.3934, eval_time 0.5622, test_loss 2.175, test_accuracy 0.5721, test_5_accuracy 1.0 

2021-08-18:15:40:23,935 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:23,943 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:23,943 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0969, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:40:23,946 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 687.4443, eval_time 0.616, test_loss 2.0969, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:40:23,965 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:23,973 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:24,4 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:24,27 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:25,60 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:25,71 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:26,353 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:26,362 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:26,831 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:26,842 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:27,119 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:27,140 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:28,408 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:28,420 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:28,507 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:28,532 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:29,236 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:29,242 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:29,256 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:29,263 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:29,652 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:29,674 INFO     [learner.py:606] ====Pushing takes 0.020348548889160156 s
2021-08-18:15:40:29,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:29,696 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:29,697 INFO     [param_server.py:410] Lock worker 1 with localStep 62 , while globalStep is 61

2021-08-18:15:40:30,289 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:30,308 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:30,706 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:30,716 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:30,997 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:31,11 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:32,554 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:32,563 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:33,161 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:33,171 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:33,204 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:33,218 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:33,763 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:33,775 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:33,792 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:33,806 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:34,301 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:34,311 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:34,781 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:34,814 INFO     [learner.py:606] ====Pushing takes 0.03239321708679199 s
2021-08-18:15:40:34,859 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:34,867 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:34,868 INFO     [param_server.py:410] Lock worker 3 with localStep 62 , while globalStep is 61

2021-08-18:15:40:35,561 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:35,590 INFO     [learner.py:606] ====Pushing takes 0.027492046356201172 s
2021-08-18:15:40:35,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:35,632 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:35,633 INFO     [param_server.py:381] ====After aggregation in epoch: 61, virtual_clock: 1753.6198850717506, top_1: : 57.567 % (1784.0), top_5: : 100.0 % (3099.0), test loss: 2.15530072538941, test len: 3099.0
2021-08-18:15:40:35,634 INFO     [param_server.py:410] Lock worker 2 with localStep 62 , while globalStep is 62

2021-08-18:15:40:35,635 INFO     [param_server.py:441] ====Epoch 63 completes 20 clients with loss 6.333322398206454, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:35,635 INFO     [param_server.py:450] ====Start to sample for epoch 63, global virtualClock: 1753.6198850717506, round_duration: 33.82271959867463
2021-08-18:15:40:35,636 INFO     [oort.py:208] Training selector: Pacer 61: lastExploitationUtil 300.9669035103093, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:40:35,637 INFO     [oort.py:321] scores are 26,{5: 0.03635325875908587, 6: 0.04676618659282107, 7: 0.08142753193338156, 11: 0.054076299522697054, 14: 0.006398763042829091, 27: 0.03145719396126978, 50: 0.010473368503132132, 51: 0.04579624011780658, 53: 0.2532891784661426, 58: 0.002646297969813414, 59: 0.002738434712041675, 60: 0.0013988982086335028, 65: 0.029190966518320653, 67: 0.0015091978691646384, 70: 0.005642237259927575, 71: 0.0326211420500356, 76: 0.0013214906457476151, 79: 0.013655322347121995, 81: 0.021347084094469823, 84: 0.16490137138411398, 85: 0.02234797015428044, 87: 0.009694714487499189, 93: 0.07236589878206234, 97: 0.3450005112414128, 98: 0.15275886796171936, 105: 0.01770050767771391, 107: 0.007674109102968938, 110: 0.01467280542907641, 111: 0.0060871570030177685, 119: 0.010647878171426668},[97, 53, 84, 98, 7, 93, 11, 6, 51, 5, 71, 27, 65, 85, 81, 105, 110, 79, 119, 50, 87, 107, 14, 111, 70, 59, 58, 67, 60, 76]
2021-08-18:15:40:35,637 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:40:35,638 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:35,638 INFO     [oort.py:398] At round 61, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 62, 'count': 58, 'status': True, 'gradient': 16.50159096799811}, [7.616302109541982e-09, -4.838787722382623e-06]), ({'reward': 439.57289762636566, 'duration': 21.635252629006885, 'time_stamp': 62, 'count': 13, 'status': True, 'gradient': 21.44869151934372}, [0.33478439006312327, -4.838787722382623e-06]), ({'reward': 361.4929933591973, 'duration': 30.380154975061778, 'time_stamp': 62, 'count': 56, 'status': True, 'gradient': 13.201260829011217}, [0.27531637610483384, -4.838787722382623e-06])]
2021-08-18:15:40:35,639 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:35,970 INFO     [param_server.py:553] For epoch: 63, median_reward: 273.58656735669865, dev: 273.58656735669865
2021-08-18:15:40:36,585 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0121, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:40:36,587 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 700.0853, eval_time 0.5823, test_loss 2.0121, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:40:36,601 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3815, Top-1 Accuracy: 590.0/1033 (0.5712), Top-5 Accuracy: 1.0
2021-08-18:15:40:36,602 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 700.102, eval_time 0.5922, test_loss 2.3815, test_accuracy 0.5712, test_5_accuracy 1.0 

2021-08-18:15:40:36,663 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:36,669 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:36,670 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4031, Top-1 Accuracy: 586.0/1033 (0.5673), Top-5 Accuracy: 1.0
2021-08-18:15:40:36,671 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 700.1718, eval_time 0.6619, test_loss 2.4031, test_accuracy 0.5673, test_5_accuracy 1.0 

2021-08-18:15:40:36,684 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:36,685 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:36,741 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:36,756 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:37,774 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:37,784 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:38,842 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:38,853 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:39,267 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:39,280 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:39,692 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:39,719 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:40,889 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:40,916 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:41,100 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:41,110 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:41,479 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:41,500 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:41,690 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:41,705 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:41,820 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:41,837 INFO     [learner.py:606] ====Pushing takes 0.015498161315917969 s
2021-08-18:15:40:41,861 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:41,881 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:41,881 INFO     [param_server.py:410] Lock worker 1 with localStep 63 , while globalStep is 62

2021-08-18:15:40:42,940 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:42,951 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:43,601 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:43,610 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:43,674 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:43,687 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:46,44 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:46,54 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:46,322 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:46,336 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:46,733 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:46,745 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:47,6 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:47,20 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:47,369 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:47,381 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:47,651 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:47,663 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:47,909 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:47,947 INFO     [learner.py:606] ====Pushing takes 0.03615689277648926 s
2021-08-18:15:40:47,985 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:47,993 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:47,994 INFO     [param_server.py:410] Lock worker 3 with localStep 63 , while globalStep is 62

2021-08-18:15:40:48,227 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:48,257 INFO     [learner.py:606] ====Pushing takes 0.028659582138061523 s
2021-08-18:15:40:48,290 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:48,298 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:48,299 INFO     [param_server.py:381] ====After aggregation in epoch: 62, virtual_clock: 1792.0159066305362, top_1: : 57.3088 % (1776.0), top_5: : 100.0 % (3099.0), test loss: 2.2655873784312495, test len: 3099.0
2021-08-18:15:40:48,300 INFO     [param_server.py:410] Lock worker 2 with localStep 63 , while globalStep is 63

2021-08-18:15:40:48,301 INFO     [param_server.py:441] ====Epoch 64 completes 20 clients with loss 5.113640907930435, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:48,302 INFO     [param_server.py:450] ====Start to sample for epoch 64, global virtualClock: 1792.0159066305362, round_duration: 38.39602155878561
2021-08-18:15:40:48,302 INFO     [oort.py:208] Training selector: Pacer 62: lastExploitationUtil 312.64130054488066, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:40:48,303 INFO     [oort.py:321] scores are 26,{5: 0.02942316835390565, 6: 0.046485206240714935, 7: 0.08093829947162495, 11: 0.013919868317471032, 14: 0.006892525867974859, 27: 0.036011749407413154, 50: 0.01036128981620723, 51: 0.0455210873929228, 53: 0.3379797980386633, 58: 0.0029285751993796197, 59: 0.0030305400503976413, 60: 0.0015107210193813427, 65: 0.023870483732473493, 67: 0.001627045228936738, 70: 0.006244087512792286, 71: 0.008154958075127504, 76: 0.0014222072799731848, 79: 0.0055590321621795625, 81: 0.021218826658012002, 84: 0.21653671891612905, 85: 0.009012004239532662, 87: 0.07034487003503542, 93: 0.014072573573195291, 97: 0.3339736493065154, 98: 0.38592900230183597, 105: 0.045795886888521105, 107: 0.008492696534046325, 110: 0.01554151620974285, 111: 0.006736466277463358, 119: 0.011710406300140941},[98, 53, 97, 84, 7, 87, 6, 105, 51, 27, 5, 65, 81, 110, 93, 11, 119, 50, 85, 107, 71, 14, 111, 70, 79, 59, 58, 67, 60, 76]
2021-08-18:15:40:48,304 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:40:48,305 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:48,305 INFO     [oort.py:398] At round 62, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 507.81294998812547, 'duration': 11.058674649423494, 'time_stamp': 63, 'count': 60, 'status': True, 'gradient': 20.12042811593629}, [0.4269328209515475, -4.761980348894431e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 63, 'count': 60, 'status': True, 'gradient': 21.04292411852875}, [8.407450420562999e-09, -4.761980348894431e-06]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 63, 'count': 59, 'status': True, 'gradient': 19.809778563938597}, [8.407450420562999e-09, -4.761980348894431e-06])]
2021-08-18:15:40:48,306 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:48,633 INFO     [param_server.py:553] For epoch: 64, median_reward: 276.10203712146546, dev: 276.10203712146546
2021-08-18:15:40:49,263 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.24, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:40:49,264 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 712.7645, eval_time 0.6052, test_loss 2.24, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:40:49,302 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5076, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:40:49,302 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.217, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:40:49,304 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 712.8028, eval_time 0.6465, test_loss 2.217, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:40:49,304 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 712.8041, eval_time 0.6459, test_loss 2.5076, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:40:49,332 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:40:49,343 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:49,373 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:40:49,377 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:40:49,387 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:49,392 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:50,610 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:50,621 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:51,825 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:51,835 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:51,951 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:51,961 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:52,470 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:52,497 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:53,836 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:53,869 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:53,913 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:53,923 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:54,228 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:54,242 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:54,776 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:54,853 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:55,216 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:55,226 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:55,411 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:55,426 INFO     [learner.py:606] ====Pushing takes 0.013478517532348633 s
2021-08-18:15:40:55,441 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:55,446 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:55,447 INFO     [param_server.py:410] Lock worker 1 with localStep 64 , while globalStep is 63

2021-08-18:15:40:55,759 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:55,768 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:56,921 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:56,938 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:57,798 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:57,817 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:58,375 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:58,389 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:58,959 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:58,972 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:59,167 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:59,194 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:59,520 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:59,552 INFO     [learner.py:606] ====Pushing takes 0.030841827392578125 s
2021-08-18:15:40:59,589 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:59,602 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:59,603 INFO     [param_server.py:410] Lock worker 3 with localStep 64 , while globalStep is 63

2021-08-18:15:40:59,858 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:59,879 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:00,423 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:00,433 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:02,176 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:02,205 INFO     [learner.py:606] ====Pushing takes 0.027541160583496094 s
2021-08-18:15:41:02,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:02,248 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:02,249 INFO     [param_server.py:381] ====After aggregation in epoch: 63, virtual_clock: 1826.6569415115248, top_1: : 59.2772 % (1837.0), top_5: : 100.0 % (3099.0), test loss: 2.321530055116724, test len: 3099.0
2021-08-18:15:41:02,250 INFO     [param_server.py:410] Lock worker 2 with localStep 64 , while globalStep is 64

2021-08-18:15:41:02,250 INFO     [param_server.py:441] ====Epoch 65 completes 20 clients with loss 5.961732218037366, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:02,250 INFO     [param_server.py:450] ====Start to sample for epoch 65, global virtualClock: 1826.6569415115248, round_duration: 34.64103488098859
2021-08-18:15:41:02,251 INFO     [oort.py:208] Training selector: Pacer 63: lastExploitationUtil 385.5737315769738, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:41:02,252 INFO     [oort.py:321] scores are 26,{5: 0.07777001617334987, 6: 0.04620992805935438, 7: 0.2846453561585346, 11: 0.15077738471219573, 14: 0.009131882574020873, 27: 0.024833288555220448, 50: 0.04327040805393454, 51: 0.0452515185738411, 53: 0.48281997272768695, 58: 0.004631587957710773, 59: 0.004792846980933015, 60: 0.002018231622633879, 65: 0.01005047668929833, 67: 0.0021616467104495956, 70: 0.009875123075981554, 71: 0.05719849182962526, 76: 0.0018788689072281417, 79: 0.01645288817824785, 81: 0.19960065260958093, 84: 0.0916804189760655, 85: 0.008958636548215434, 87: 0.017796504673827596, 93: 0.14095182230163358, 97: 0.32756165111873203, 98: 0.4638083441929089, 105: 0.045775580160846936, 107: 0.013431333777569898, 110: 0.04675516095423116, 111: 0.010653827873306251, 119: 0.018520192621696283},[53, 98, 97, 7, 81, 11, 93, 84, 5, 71, 110, 6, 105, 51, 50, 27, 119, 87, 79, 107, 111, 65, 70, 14, 85, 59, 58, 67, 60, 76]
2021-08-18:15:41:02,252 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:41:02,253 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:02,253 INFO     [oort.py:398] At round 63, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 787.6439723659827, 'duration': 15.972045438625893, 'time_stamp': 64, 'count': 61, 'status': True, 'gradient': 20.848817949683447}, [0.9463052499497537, -4.6875732433319305e-06]), ({'reward': 299.6448367175975, 'duration': 27.689063957948644, 'time_stamp': 64, 'count': 57, 'status': True, 'gradient': 20.33071272635344}, [0.3599972003048994, -4.6875732433319305e-06]), ({'reward': 786.2078997547897, 'duration': 13.411352670399307, 'time_stamp': 64, 'count': 61, 'status': True, 'gradient': 17.962118050397233}, [0.9445798761318304, -4.6875732433319305e-06])]
2021-08-18:15:41:02,254 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:02,543 INFO     [param_server.py:553] For epoch: 65, median_reward: 291.90412462211157, dev: 291.90412462211157
2021-08-18:15:41:03,156 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1827, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:41:03,157 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4943, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:41:03,161 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 726.6611, eval_time 0.5928, test_loss 2.4943, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:41:03,157 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 726.6578, eval_time 0.5894, test_loss 2.1827, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:41:03,206 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6227, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:41:03,218 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 726.7168, eval_time 0.6528, test_loss 2.6227, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:41:03,232 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:03,241 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:03,241 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:03,249 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:03,291 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:03,305 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:04,364 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:04,373 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:05,651 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:05,661 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:05,995 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:06,8 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:06,387 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:06,420 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:07,968 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:07,986 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:07,990 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:08,29 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:08,460 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:08,482 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:08,776 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:08,803 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:09,540 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:09,557 INFO     [learner.py:606] ====Pushing takes 0.015298128128051758 s
2021-08-18:15:41:09,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:09,584 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:09,585 INFO     [param_server.py:410] Lock worker 1 with localStep 65 , while globalStep is 64

2021-08-18:15:41:09,602 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:09,617 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:10,208 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:10,218 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:10,678 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:10,687 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:12,427 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:12,436 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:13,43 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:13,56 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:13,114 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:13,126 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:13,657 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:13,661 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:13,666 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:13,671 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:14,187 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:14,222 INFO     [learner.py:606] ====Pushing takes 0.03449749946594238 s
2021-08-18:15:41:14,245 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:14,254 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:14,264 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:14,272 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:14,272 INFO     [param_server.py:410] Lock worker 3 with localStep 65 , while globalStep is 64

2021-08-18:15:41:14,731 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:14,761 INFO     [learner.py:606] ====Pushing takes 0.02847123146057129 s
2021-08-18:15:41:14,797 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:14,805 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:14,805 INFO     [param_server.py:381] ====After aggregation in epoch: 64, virtual_clock: 1865.0529630703104, top_1: : 56.5666 % (1753.0), top_5: : 100.0 % (3099.0), test loss: 2.4332260290781655, test len: 3099.0
2021-08-18:15:41:14,806 INFO     [param_server.py:410] Lock worker 2 with localStep 65 , while globalStep is 65

2021-08-18:15:41:14,807 INFO     [param_server.py:441] ====Epoch 66 completes 20 clients with loss 4.848245714803242, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:14,807 INFO     [param_server.py:450] ====Start to sample for epoch 66, global virtualClock: 1865.0529630703104, round_duration: 38.39602155878561
2021-08-18:15:41:14,808 INFO     [oort.py:208] Training selector: Pacer 64: lastExploitationUtil 362.0725225480991, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:41:14,808 INFO     [oort.py:321] scores are 26,{5: 0.03561311108216394, 6: 0.15890148338288262, 7: 0.31417998007095027, 11: 0.051719025684529345, 14: 0.009351070367435937, 27: 0.01492951111163787, 50: 0.021315499857232516, 51: 0.49728960220175955, 53: 0.19450528061373962, 58: 0.003867265964264751, 59: 0.004001913419442563, 60: 0.0017862812041116425, 65: 0.05858808128217207, 67: 0.0018829167794098749, 70: 0.008760368366703238, 71: 0.010310124130372252, 76: 0.001633561450649934, 79: 0.012863899755706251, 81: 0.13030390921019516, 84: 0.20684387959717151, 85: 0.024904785777543938, 87: 0.061674370806065484, 93: 0.013916818659628905, 97: 0.29469558171632676, 98: 0.3613512577608962, 105: 0.0364626888994328, 107: 0.011214844767484217, 110: 0.014701362484155534, 111: 0.00889569329132133, 119: 0.015463921063676318},[51, 98, 7, 97, 84, 53, 6, 81, 87, 65, 11, 105, 5, 85, 50, 119, 27, 110, 93, 79, 107, 71, 14, 111, 70, 59, 58, 67, 60, 76]
2021-08-18:15:41:14,809 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:41:14,809 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:14,810 INFO     [oort.py:398] At round 64, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 243.57663128610793, 'duration': 5.8943907365129, 'time_stamp': 65, 'count': 62, 'status': True, 'gradient': 21.06144357654152}, [0.23419072037499367, -4.615455622394195e-06]), ({'reward': 358.2557545383755, 'duration': 13.298442137908651, 'time_stamp': 65, 'count': 62, 'status': True, 'gradient': 20.858517349661682}, [0.36948085123428914, -4.615455622394195e-06]), ({'reward': 654.200025751254, 'duration': 13.411352670399307, 'time_stamp': 65, 'count': 62, 'status': True, 'gradient': 17.96722639200033}, [0.7186144864067001, -4.615455622394195e-06])]
2021-08-18:15:41:14,810 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:15,99 INFO     [param_server.py:553] For epoch: 66, median_reward: 287.5172360271606, dev: 287.5172360271606
2021-08-18:15:41:15,721 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4243, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:41:15,722 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 739.2223, eval_time 0.6004, test_loss 2.4243, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:41:15,728 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1073, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:41:15,729 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 739.2293, eval_time 0.6048, test_loss 2.1073, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:41:15,787 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1487, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:41:15,787 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 739.286, eval_time 0.666, test_loss 2.1487, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:41:15,793 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:15,801 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:15,804 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:15,814 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:15,857 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:15,876 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:16,990 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:16,999 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:18,30 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:18,49 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:18,559 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:18,577 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:19,149 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:19,176 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:20,158 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:20,168 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:20,363 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:20,397 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:20,898 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:20,908 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:20,969 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:20,985 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:21,701 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:21,716 INFO     [learner.py:606] ====Pushing takes 0.013989686965942383 s
2021-08-18:15:41:21,734 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:21,740 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:21,741 INFO     [param_server.py:410] Lock worker 1 with localStep 66 , while globalStep is 65

2021-08-18:15:41:21,812 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:21,823 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:22,448 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:22,457 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:22,782 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:22,800 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:24,545 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:24,559 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:25,116 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:25,137 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:25,182 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:25,196 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:25,715 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:25,730 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:25,783 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:25,792 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:26,318 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:26,319 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:26,338 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:26,351 INFO     [learner.py:606] ====Pushing takes 0.031180858612060547 s
2021-08-18:15:41:26,386 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:26,394 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:26,395 INFO     [param_server.py:410] Lock worker 3 with localStep 66 , while globalStep is 65

2021-08-18:15:41:28,160 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:28,189 INFO     [learner.py:606] ====Pushing takes 0.02663898468017578 s
2021-08-18:15:41:28,220 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:28,228 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:28,229 INFO     [param_server.py:381] ====After aggregation in epoch: 65, virtual_clock: 1899.693997951299, top_1: : 58.3091 % (1807.0), top_5: : 100.0 % (3099.0), test loss: 2.2267595617859453, test len: 3099.0
2021-08-18:15:41:28,231 INFO     [param_server.py:410] Lock worker 2 with localStep 66 , while globalStep is 66

2021-08-18:15:41:28,232 INFO     [param_server.py:441] ====Epoch 67 completes 20 clients with loss 5.274382659596211, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:28,232 INFO     [param_server.py:450] ====Start to sample for epoch 67, global virtualClock: 1899.693997951299, round_duration: 34.64103488098859
2021-08-18:15:41:28,233 INFO     [oort.py:208] Training selector: Pacer 65: lastExploitationUtil 276.707399961542, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:41:28,233 INFO     [oort.py:321] scores are 26,{5: 0.07172076124294731, 6: 0.3694233594654179, 7: 0.10329700474103036, 11: 0.11421288327023653, 14: 0.009731543549124248, 27: 0.09519138699650764, 50: 0.03535856484979912, 51: 0.3106097526228522, 53: 0.23645759657608695, 58: 0.004024615971059982, 59: 0.005238707046880714, 60: 0.002326605031117413, 65: 0.030626388173244257, 67: 0.0024865742046055895, 70: 0.008580983112198555, 71: 0.07045260021306479, 76: 0.002156509527919504, 79: 0.0035495512529115565, 81: 0.1377525275589515, 84: 0.03659875703882561, 85: 0.012292292092332105, 87: 0.009468653637708338, 93: 0.05004914021255732, 97: 0.3300058149846909, 98: 0.2991719337455995, 105: 0.010643188045351862, 107: 0.011671150570259952, 110: 0.008442116154182612, 111: 0.009257638244880743, 119: 0.01609311184262317},[6, 97, 51, 98, 53, 81, 11, 7, 27, 5, 71, 93, 84, 50, 65, 119, 85, 107, 105, 14, 87, 111, 70, 110, 59, 58, 79, 67, 60, 76]
2021-08-18:15:41:28,234 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:41:28,235 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:28,235 INFO     [oort.py:398] At round 65, UCB exploited 30, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 672.4639369678592, 'duration': 15.972045438625893, 'time_stamp': 66, 'count': 63, 'status': True, 'gradient': 20.862409870385548}, [0.954896836156249, -4.5455234170214745e-06]), ({'reward': 409.6213908391595, 'duration': 13.411352670399307, 'time_stamp': 66, 'count': 63, 'status': True, 'gradient': 17.973454859827076}, [0.5816556397334037, -4.5455234170214745e-06]), ({'reward': 194.22457863357806, 'duration': 11.058674649423494, 'time_stamp': 66, 'count': 63, 'status': True, 'gradient': 20.141044821483842}, [0.27578824848574374, -4.5455234170214745e-06])]
2021-08-18:15:41:28,236 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:28,570 INFO     [param_server.py:553] For epoch: 67, median_reward: 268.82554416732, dev: 268.82554416732
2021-08-18:15:41:29,169 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3519, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:41:29,170 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 752.6702, eval_time 0.5638, test_loss 2.3519, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:41:29,206 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2305, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:41:29,207 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 752.7079, eval_time 0.5993, test_loss 2.2305, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:41:29,252 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:29,260 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:29,277 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:29,286 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:29,287 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0976, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:41:29,291 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 752.7893, eval_time 0.6853, test_loss 2.0976, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:41:29,347 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:29,370 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:30,429 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:30,438 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:31,548 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:31,557 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:32,7 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:32,21 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:32,548 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:32,569 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:33,758 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:33,773 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:33,970 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:34,2 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:34,282 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:34,293 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:34,792 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:34,819 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:35,425 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:35,441 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:35,442 INFO     [learner.py:606] ====Pushing takes 0.015330076217651367 s
2021-08-18:15:41:35,450 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:35,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:35,469 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:35,469 INFO     [param_server.py:410] Lock worker 1 with localStep 67 , while globalStep is 66

2021-08-18:15:41:36,73 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:36,84 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:36,413 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:36,434 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:38,514 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:38,529 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:38,926 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:38,938 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:39,172 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:39,184 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:39,554 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:39,564 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:39,768 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:39,780 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:40,260 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:40,269 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:40,374 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:40,415 INFO     [learner.py:606] ====Pushing takes 0.03902268409729004 s
2021-08-18:15:41:40,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:40,473 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:40,474 INFO     [param_server.py:410] Lock worker 3 with localStep 67 , while globalStep is 66

2021-08-18:15:41:40,863 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:40,894 INFO     [learner.py:606] ====Pushing takes 0.02969646453857422 s
2021-08-18:15:41:40,933 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:40,941 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:40,942 INFO     [param_server.py:381] ====After aggregation in epoch: 66, virtual_clock: 1938.0900195100846, top_1: : 57.3733 % (1778.0), top_5: : 100.0 % (3099.0), test loss: 2.2266576687494912, test len: 3099.0
2021-08-18:15:41:40,944 INFO     [param_server.py:410] Lock worker 2 with localStep 67 , while globalStep is 67

2021-08-18:15:41:40,945 INFO     [param_server.py:441] ====Epoch 68 completes 20 clients with loss 4.558111064994244, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:40,945 INFO     [param_server.py:450] ====Start to sample for epoch 68, global virtualClock: 1938.0900195100846, round_duration: 38.39602155878561
2021-08-18:15:41:40,946 INFO     [oort.py:208] Training selector: Pacer 66: lastExploitationUtil 215.6431882523291, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:41:40,947 INFO     [oort.py:321] scores are 26,{5: 0.019925249360090068, 6: 0.14629431750089764, 7: 0.07907729196694684, 11: 0.028655532673871477, 14: 0.007447803993338155, 27: 0.062246948970411296, 50: 0.003376423428544474, 51: 0.0444744248634112, 53: 0.2975069309615058, 58: 0.003080143530119689, 59: 0.004889106655683182, 60: 0.0021727223087353587, 65: 0.019972659918234662, 67: 0.00168233597380117, 70: 0.006567250094210485, 71: 0.017539276586381644, 76: 0.0020181980395004655, 79: 0.01525327013145914, 81: 0.020730943963307397, 84: 0.43718930861337063, 85: 0.06140119233558608, 87: 0.009414896287061339, 93: 0.05803182016681575, 97: 0.20656134133603532, 98: 0.23657516439219942, 105: 0.04571704177328806, 107: 0.008932235814929418, 110: 0.008394186869231714, 111: 0.00866440353057099, 119: 0.012316478063494106},[84, 53, 98, 97, 6, 7, 27, 85, 93, 105, 51, 11, 81, 65, 5, 71, 79, 119, 87, 107, 111, 110, 14, 70, 59, 50, 58, 60, 76, 67]
2021-08-18:15:41:40,948 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:41:40,948 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:40,949 INFO     [oort.py:398] At round 66, UCB exploited 30, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 134.08194190997, 'duration': 11.90395711384456, 'time_stamp': 67, 'count': 65, 'status': True, 'gradient': 20.766366347694184}, [0.17564490564066026, -4.4776787713249495e-06]), ({'reward': 433.879309742853, 'duration': 15.972045438625893, 'time_stamp': 67, 'count': 64, 'status': True, 'gradient': 20.87235953229404}, [0.5684032688491342, -4.4776787713249495e-06]), ({'reward': 338.7415670718041, 'duration': 13.411352670399307, 'time_stamp': 67, 'count': 64, 'status': True, 'gradient': 17.980757215948824}, [0.4437652696534265, -4.4776787713249495e-06])]
2021-08-18:15:41:40,950 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:41,258 INFO     [param_server.py:553] For epoch: 68, median_reward: 255.24993893946285, dev: 255.24993893946285
2021-08-18:15:41:41,914 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4861, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:41:41,915 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 765.4159, eval_time 0.6204, test_loss 2.4861, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:41:41,954 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4535, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:41:41,955 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 765.4559, eval_time 0.6557, test_loss 2.4535, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:41:41,993 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1176, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:41:41,995 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 765.4931, eval_time 0.701, test_loss 2.1176, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:41:42,26 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:42,40 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:42,41 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:42,50 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:42,64 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:42,84 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:43,184 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:43,193 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:44,275 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:44,284 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:44,710 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:44,721 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:45,8 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:45,41 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:46,492 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:46,513 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:46,528 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:46,549 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:47,186 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:47,197 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:47,227 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:47,248 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:47,807 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:47,823 INFO     [learner.py:606] ====Pushing takes 0.012493610382080078 s
2021-08-18:15:41:47,847 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:47,852 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:47,853 INFO     [param_server.py:410] Lock worker 1 with localStep 68 , while globalStep is 67

2021-08-18:15:41:48,162 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:48,173 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:48,771 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:48,781 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:49,307 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:49,326 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:50,779 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:50,801 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:51,386 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:51,405 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:51,791 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:51,802 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:52,59 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:52,77 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:52,433 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:52,442 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:52,681 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:52,718 INFO     [learner.py:606] ====Pushing takes 0.03509354591369629 s
2021-08-18:15:41:52,767 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:52,776 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:52,776 INFO     [param_server.py:410] Lock worker 3 with localStep 68 , while globalStep is 67

2021-08-18:15:41:53,26 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:53,37 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:54,802 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:54,834 INFO     [learner.py:606] ====Pushing takes 0.02942800521850586 s
2021-08-18:15:41:54,896 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:54,906 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:54,907 INFO     [param_server.py:381] ====After aggregation in epoch: 67, virtual_clock: 1972.7310543910733, top_1: : 58.7932 % (1822.0), top_5: : 100.0 % (3099.0), test loss: 2.3523896778071367, test len: 3099.0
2021-08-18:15:41:54,910 INFO     [param_server.py:410] Lock worker 2 with localStep 68 , while globalStep is 68

2021-08-18:15:41:54,910 INFO     [param_server.py:441] ====Epoch 69 completes 20 clients with loss 5.2226668443302495, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:54,911 INFO     [param_server.py:450] ====Start to sample for epoch 69, global virtualClock: 1972.7310543910733, round_duration: 34.64103488098859
2021-08-18:15:41:54,912 INFO     [oort.py:208] Training selector: Pacer 67: lastExploitationUtil 290.6078720302825, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:41:54,912 INFO     [oort.py:321] scores are 26,{5: 0.05596534670918023, 6: 0.10131224716919941, 7: 0.42558278710230274, 11: 0.04801680073347252, 14: 0.008796006254653845, 27: 0.04129916070711255, 50: 0.02168607837592232, 51: 0.2818641960044098, 53: 0.41614497807305445, 58: 0.0028770844347925863, 60: 0.0020170558660226007, 65: 0.02441691528381741, 67: 0.001571427628934841, 70: 0.007756054396198009, 71: 0.05468518882311623, 76: 0.001878280023727269, 79: 0.026695343851921113, 81: 0.046162965660342614, 84: 0.16286889310077624, 85: 0.0087554817667139, 87: 0.011045571975564527, 93: 0.045271753925156324, 97: 0.2200935739760112, 98: 0.48805919714547397, 105: 0.02352958057923123, 107: 0.01054915008053905, 110: 0.008347176197487496, 111: 0.008367659610650528, 119: 0.014546008216476199},[98, 7, 53, 51, 97, 84, 6, 5, 71, 11, 81, 93, 27, 79, 65, 105, 50, 119, 87, 107, 14, 85, 111, 110, 70, 58, 60, 76, 67]
2021-08-18:15:41:54,927 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:41:54,928 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:54,929 INFO     [oort.py:398] At round 67, UCB exploited 29, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 509.8730074448109, 'duration': 15.972045438625893, 'time_stamp': 68, 'count': 65, 'status': True, 'gradient': 20.8803878390777}, [0.6112638328591237, -4.4118295857292055e-06]), ({'reward': 325.0833119485104, 'duration': 30.380154975061778, 'time_stamp': 68, 'count': 62, 'status': True, 'gradient': 14.886502860184219}, [0.38972343146265326, -4.4118295857292055e-06]), ({'reward': 834.1228395366381, 'duration': 13.411352670399307, 'time_stamp': 68, 'count': 65, 'status': True, 'gradient': 17.98878001610478}, [1.0, -4.4118295857292055e-06])]
2021-08-18:15:41:54,929 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:55,289 INFO     [param_server.py:553] For epoch: 69, median_reward: 269.76323002811347, dev: 269.76323002811347
2021-08-18:15:41:55,926 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1572, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:41:55,928 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 779.428, eval_time 0.593, test_loss 2.1572, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:41:55,969 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2712, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:41:55,971 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 779.471, eval_time 0.636, test_loss 2.2712, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:41:56,3 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:41:56,4 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4309, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:41:56,5 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 779.504, eval_time 0.6716, test_loss 2.4309, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:41:56,12 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:56,53 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:41:56,65 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:41:56,66 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:56,82 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:57,173 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:57,201 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:58,338 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:58,361 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:58,836 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:58,864 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:59,33 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:59,54 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:00,377 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:00,404 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:00,700 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:00,719 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:01,61 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:01,73 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:01,164 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:01,192 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:01,907 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:01,924 INFO     [learner.py:606] ====Pushing takes 0.01581740379333496 s
2021-08-18:15:42:01,953 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:01,961 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:01,962 INFO     [param_server.py:410] Lock worker 1 with localStep 69 , while globalStep is 68

2021-08-18:15:42:02,328 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:02,340 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:02,902 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:02,913 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:03,445 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:03,456 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:05,62 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:05,73 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:05,664 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:05,673 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:05,782 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:05,803 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:06,250 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:06,263 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:42:06,429 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:06,448 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:06,872 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:42:06,881 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:07,51 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:07,89 INFO     [learner.py:606] ====Pushing takes 0.03628253936767578 s
2021-08-18:15:42:07,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:07,146 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:07,146 INFO     [param_server.py:410] Lock worker 3 with localStep 69 , while globalStep is 68

2021-08-18:15:42:07,470 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:07,513 INFO     [learner.py:606] ====Pushing takes 0.041022539138793945 s
2021-08-18:15:42:07,558 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:07,567 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:07,568 INFO     [param_server.py:381] ====After aggregation in epoch: 68, virtual_clock: 2011.1270759498589, top_1: : 57.8251 % (1792.0), top_5: : 100.0 % (3099.0), test loss: 2.2864232372354576, test len: 3099.0
2021-08-18:15:42:07,571 INFO     [param_server.py:410] Lock worker 2 with localStep 69 , while globalStep is 69

2021-08-18:15:42:07,571 INFO     [param_server.py:441] ====Epoch 70 completes 20 clients with loss 4.6622094372104845, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:42:07,572 INFO     [param_server.py:450] ====Start to sample for epoch 70, global virtualClock: 2011.1270759498589, round_duration: 38.39602155878561
2021-08-18:15:42:07,573 INFO     [oort.py:208] Training selector: Pacer 68: lastExploitationUtil 223.68897143608166, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:42:07,574 INFO     [oort.py:321] scores are 26,{5: 0.00727811103948213, 6: 0.04491248751133587, 7: 0.0781999405441857, 11: 0.1314446414226593, 14: 0.007923547404241485, 27: 0.0659918309371089, 50: 0.003338962485899704, 51: 0.05061443350746534, 53: 0.3476806814345418, 58: 0.0031928547933508717, 60: 0.0022582920826244054, 67: 0.001743897459794332, 70: 0.006986746359535075, 71: 0.052152631703082104, 76: 0.0015815454607000972, 79: 0.018042458846227252, 81: 0.02050093705830373, 84: 0.03598721848923516, 85: 0.008707104057238912, 87: 0.05273840884964527, 93: 0.05288132597715456, 97: 0.2520788287880287, 98: 0.29034499946002246, 105: 0.045679871183298804, 107: 0.009502800284320451, 110: 0.05507400434776248, 111: 0.007537687635506975, 112: 0.3835827374625352, 119: 0.013103217791000881},[112, 53, 98, 97, 11, 7, 27, 110, 93, 87, 71, 51, 105, 6, 84, 81, 79, 119, 107, 85, 14, 111, 5, 70, 50, 58, 60, 67, 76]
2021-08-18:15:42:07,576 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:42:07,576 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:07,577 INFO     [oort.py:398] At round 68, UCB exploited 29, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 320.72101856825554, 'duration': 28.420902733732795, 'time_stamp': 69, 'count': 63, 'status': True, 'gradient': 20.57449275120254}, [0.43941712086361145, -4.34788909984203e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 69, 'count': 66, 'status': True, 'gradient': 21.088608117739124}, [1.3701341136451574e-08, -4.34788909984203e-06]), ({'reward': 411.26648716329163, 'duration': 13.411352670399307, 'time_stamp': 69, 'count': 66, 'status': True, 'gradient': 17.992424264488253}, [0.5634765562216617, -4.34788909984203e-06])]
2021-08-18:15:42:07,578 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 27, 79, 50, 105, 119, 107]
2021-08-18:15:42:07,947 INFO     [param_server.py:553] For epoch: 70, median_reward: 255.12359586059355, dev: 255.12359586059355
2021-08-18:15:42:08,529 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7474, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:42:08,530 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 792.0301, eval_time 0.5488, test_loss 2.7474, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:42:08,532 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4861, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:42:08,533 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 792.0335, eval_time 0.55, test_loss 2.4861, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:42:08,603 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4032, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:42:08,606 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 792.1048, eval_time 0.6267, test_loss 2.4032, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:42:08,630 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:08,635 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:08,639 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:08,645 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:08,695 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:08,714 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:09,645 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:09,654 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:10,732 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:10,746 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:11,591 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:11,604 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:12,176 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:12,209 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:13,179 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:13,198 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:13,803 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:13,831 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:13,834 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:13,852 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:14,464 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:14,485 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:14,847 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:14,857 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:15,45 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:15,61 INFO     [learner.py:606] ====Pushing takes 0.014394521713256836 s
2021-08-18:15:42:15,87 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:15,92 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:15,93 INFO     [param_server.py:410] Lock worker 1 with localStep 70 , while globalStep is 69

2021-08-18:15:42:15,430 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:15,441 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:15,902 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:15,917 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:17,712 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:17,727 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:18,78 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:18,89 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:18,364 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:18,383 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:19,17 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:19,36 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:19,738 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:19,775 INFO     [learner.py:606] ====Pushing takes 0.03496384620666504 s
2021-08-18:15:42:19,827 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:19,838 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:19,838 INFO     [param_server.py:410] Lock worker 3 with localStep 70 , while globalStep is 69

2021-08-18:15:42:20,330 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:20,344 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:21,109 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:21,123 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:42:21,674 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:42:21,717 INFO     [learner.py:606] ====Pushing takes 0.04167461395263672 s
2021-08-18:15:42:21,762 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:21,771 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:21,772 INFO     [param_server.py:381] ====After aggregation in epoch: 69, virtual_clock: 2049.1209583665927, top_1: : 58.9868 % (1828.0), top_5: : 100.0 % (3099.0), test loss: 2.545586965702198, test len: 3099.0
2021-08-18:15:42:21,797 INFO     [param_server.py:410] Lock worker 2 with localStep 70 , while globalStep is 70

2021-08-18:15:42:21,797 INFO     [param_server.py:441] ====Epoch 71 completes 20 clients with loss 4.977991442992084, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:21,798 INFO     [param_server.py:450] ====Start to sample for epoch 71, global virtualClock: 2049.1209583665927, round_duration: 37.993882416733996
2021-08-18:15:42:21,799 INFO     [oort.py:208] Training selector: Pacer 69: lastExploitationUtil 310.1527435816318, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:42:21,800 INFO     [oort.py:321] scores are 26,{5: 0.007290690496933644, 6: 0.338932766033702, 7: 0.07777355190271519, 11: 0.0459176419397973, 14: 0.00898472283587966, 27: 0.07439416489187543, 50: 0.011775010423430937, 51: 0.043741179097328, 53: 0.36088612143263715, 58: 0.002800019591573359, 60: 0.0016581091479202145, 67: 0.0020295005688862697, 70: 0.006117791547410746, 71: 0.048836737006325535, 76: 0.0017933567999009485, 79: 0.008517875188087047, 81: 0.12927018443246874, 84: 0.03579099658554641, 85: 0.06619733710917411, 87: 0.02654998303147827, 93: 0.013522325504051129, 97: 0.343834805440845, 98: 0.2805454826730414, 105: 0.029117235185274665, 107: 0.014502135534381394, 110: 0.01633996384280994, 111: 0.008547186099021064, 119: 0.026624273683449114},[53, 97, 6, 98, 81, 7, 27, 85, 71, 11, 51, 84, 105, 119, 87, 110, 107, 93, 50, 14, 111, 79, 5, 70, 58, 67, 76, 60]
2021-08-18:15:42:21,802 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:42:21,803 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:21,803 INFO     [oort.py:398] At round 69, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 70, 'count': 67, 'status': True, 'gradient': 21.104380731597466}, [1.1556424641830936e-08, -4.285775511078734e-06]), ({'reward': 469.2256460100412, 'duration': 13.411352670399307, 'time_stamp': 70, 'count': 67, 'status': True, 'gradient': 18.002779001018475}, [0.5422455369447529, -4.285775511078734e-06]), ({'reward': 443.36812986649306, 'duration': 11.90395711384456, 'time_stamp': 70, 'count': 68, 'status': True, 'gradient': 20.79473494330628}, [0.5123634932709675, -4.285775511078734e-06])]
2021-08-18:15:42:21,804 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:42:22,163 INFO     [param_server.py:553] For epoch: 71, median_reward: 269.74883577229673, dev: 269.74883577229673
2021-08-18:15:42:22,848 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2513, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:42:22,850 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 806.3502, eval_time 0.6414, test_loss 2.2513, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:42:22,889 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3472, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:42:22,890 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 806.3906, eval_time 0.6819, test_loss 2.3472, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:42:22,945 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:22,953 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:22,965 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:22,968 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0672, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:42:22,970 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 806.4681, eval_time 0.7625, test_loss 2.0672, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:42:22,977 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:23,40 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:23,62 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:24,198 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:24,210 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:25,365 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:25,379 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:25,942 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:25,957 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:26,146 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:26,160 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:27,300 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:27,320 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:27,605 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:27,615 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:27,982 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:28,2 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:28,499 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:28,519 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:28,625 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:28,642 INFO     [learner.py:606] ====Pushing takes 0.01589655876159668 s
2021-08-18:15:42:28,666 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:28,672 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:28,673 INFO     [param_server.py:410] Lock worker 1 with localStep 71 , while globalStep is 70

2021-08-18:15:42:29,580 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:29,598 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:30,257 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:30,266 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:30,369 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:30,382 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:32,479 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:32,489 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:32,523 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:32,532 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:33,110 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:33,124 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:33,311 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:33,325 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:33,738 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:33,751 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:33,928 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:33,942 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:34,333 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:34,370 INFO     [learner.py:606] ====Pushing takes 0.03555035591125488 s
2021-08-18:15:42:34,419 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:34,428 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:34,428 INFO     [param_server.py:410] Lock worker 3 with localStep 71 , while globalStep is 70

2021-08-18:15:42:34,629 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:34,659 INFO     [learner.py:606] ====Pushing takes 0.02921581268310547 s
2021-08-18:15:42:34,696 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:34,705 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:34,706 INFO     [param_server.py:381] ====After aggregation in epoch: 70, virtual_clock: 2087.5169799253786, top_1: : 58.4059 % (1810.0), top_5: : 100.0 % (3099.0), test loss: 2.221881956965835, test len: 3099.0
2021-08-18:15:42:34,708 INFO     [param_server.py:410] Lock worker 2 with localStep 71 , while globalStep is 71

2021-08-18:15:42:34,709 INFO     [param_server.py:441] ====Epoch 72 completes 20 clients with loss 5.466901094958991, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:34,710 INFO     [param_server.py:450] ====Start to sample for epoch 72, global virtualClock: 2087.5169799253786, round_duration: 38.39602155878561
2021-08-18:15:42:34,711 INFO     [oort.py:208] Training selector: Pacer 70: lastExploitationUtil 291.41200245350984, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:42:34,711 INFO     [oort.py:321] scores are 26,{5: 0.04131305692478666, 6: 0.22234048306550455, 7: 0.07735501270226201, 11: 0.18528483841663532, 14: 0.008866405413804566, 27: 0.07809060966400269, 50: 0.006100657598760392, 51: 0.21532311422727388, 53: 0.13611702888126423, 58: 0.0036668259926249595, 60: 0.0017246884094784395, 67: 0.0020027746164226453, 70: 0.007818130262450457, 71: 0.021823790856804543, 76: 0.0018653667587131243, 79: 0.029413349513516707, 81: 0.0202794303361049, 84: 0.18028896462679792, 85: 0.008613026304886516, 87: 0.04069540517866769, 93: 0.06654060070651126, 97: 0.15044070616020824, 98: 0.4652519026523302, 105: 0.021891287052016824, 107: 0.010633580590696062, 110: 0.03530598939420894, 111: 0.008434630481702099, 119: 0.017426508844382276},[98, 6, 51, 11, 84, 97, 53, 27, 7, 93, 5, 87, 110, 79, 105, 71, 81, 119, 107, 14, 85, 111, 70, 50, 58, 67, 76, 60]
2021-08-18:15:42:34,712 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:42:34,713 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:34,713 INFO     [oort.py:398] At round 70, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 784.760843742129, 'duration': 13.411352670399307, 'time_stamp': 71, 'count': 68, 'status': True, 'gradient': 18.009741006763036}, [0.9508741929197299, -4.225411625515856e-06]), ({'reward': 667.0460798266731, 'duration': 30.380154975061778, 'time_stamp': 71, 'count': 65, 'status': True, 'gradient': 16.559161739844242}, [0.8082404759902204, -4.225411625515856e-06]), ({'reward': 310.15398419260606, 'duration': 140.6940574361062, 'time_stamp': 70, 'count': 5, 'status': True, 'gradient': 18.920817855156407}, [0.37579815142667317, 0.004221186213890336])]
2021-08-18:15:42:34,714 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:42:35,68 INFO     [param_server.py:553] For epoch: 72, median_reward: 269.7809667650807, dev: 269.7809667650807
2021-08-18:15:42:35,775 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2385, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:42:35,778 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 819.2781, eval_time 0.6475, test_loss 2.2385, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:42:35,850 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:35,857 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:35,858 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.308, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:42:35,859 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 819.3594, eval_time 0.7307, test_loss 2.308, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:42:35,928 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:35,947 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:35,961 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6586, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:42:35,962 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 819.4611, eval_time 0.8399, test_loss 2.6586, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:42:36,32 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:36,65 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:36,605 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:36,623 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:37,771 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:37,784 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:38,114 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:38,123 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:39,202 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:39,223 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:39,226 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:39,238 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:39,858 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:39,869 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:40,463 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:40,466 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:40,474 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:40,486 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:40,914 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:40,923 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:41,67 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:41,87 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:41,111 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:41,131 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:41,548 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:41,569 INFO     [learner.py:606] ====Pushing takes 0.019051551818847656 s
2021-08-18:15:42:41,593 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:41,602 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:41,603 INFO     [param_server.py:410] Lock worker 1 with localStep 72 , while globalStep is 71

2021-08-18:15:42:42,606 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:42,615 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:42,981 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:42,999 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:43,232 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:43,241 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:43,578 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:43,591 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:44,109 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:44,120 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:44,404 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:44,424 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:44,588 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:44,640 INFO     [learner.py:606] ====Pushing takes 0.05079245567321777 s
2021-08-18:15:42:44,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:44,700 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:44,701 INFO     [param_server.py:410] Lock worker 3 with localStep 72 , while globalStep is 71

2021-08-18:15:42:45,21 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:45,61 INFO     [learner.py:606] ====Pushing takes 0.03950667381286621 s
2021-08-18:15:42:45,115 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:45,123 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:45,135 INFO     [param_server.py:381] ====After aggregation in epoch: 71, virtual_clock: 2117.2164980662774, top_1: : 58.5673 % (1815.0), top_5: : 100.0 % (3099.0), test loss: 2.4016687163600214, test len: 3099.0
2021-08-18:15:42:45,137 INFO     [param_server.py:410] Lock worker 2 with localStep 72 , while globalStep is 72

2021-08-18:15:42:45,138 INFO     [param_server.py:441] ====Epoch 73 completes 20 clients with loss 5.036445077273813, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:45,138 INFO     [param_server.py:450] ====Start to sample for epoch 73, global virtualClock: 2117.2164980662774, round_duration: 29.6995181408989
2021-08-18:15:42:45,139 INFO     [oort.py:208] Training selector: Pacer 71: lastExploitationUtil 202.9273391669122, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:42:45,139 INFO     [oort.py:321] scores are 26,{5: 0.02887039191672602, 6: 0.22431297830437258, 7: 0.25377353335858865, 11: 0.013232936064293824, 14: 0.005413263391612275, 27: 0.05721252820015801, 50: 0.0032853396846100925, 51: 0.043274665054957875, 53: 0.07962411159576645, 58: 0.0022387308027201564, 60: 0.001376489113864487, 67: 0.0012227668380526858, 70: 0.004773253236840089, 71: 0.007752518655633716, 76: 0.0010804910613641963, 79: 0.0034341885498775197, 81: 0.040274411816294035, 84: 0.09612154661254711, 85: 0.008567270407522571, 87: 0.009160916292926204, 93: 0.018736385972949337, 97: 0.34357018265747535, 98: 0.40734452538009586, 105: 0.004953695204435498, 107: 0.006492188192043642, 110: 0.019219129910134122, 111: 0.006748334582211017, 119: 0.008481662179142443},[98, 97, 7, 6, 84, 53, 27, 51, 81, 5, 110, 93, 11, 87, 85, 119, 71, 111, 107, 14, 105, 70, 79, 50, 58, 60, 67, 76]
2021-08-18:15:42:45,140 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:42:45,141 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:45,141 INFO     [oort.py:398] At round 71, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 254.6752693418511, 'duration': 29.570969934622333, 'time_stamp': 72, 'count': 57, 'status': True, 'gradient': 11.597295092314148}, [0.2332549604093034, -4.166724537840807e-06]), ({'reward': 1091.799330278029, 'duration': 15.972045438625893, 'time_stamp': 72, 'count': 69, 'status': True, 'gradient': 20.914767171043177}, [1.0, -4.166724537840807e-06]), ({'reward': 898.8878274130018, 'duration': 13.411352670399307, 'time_stamp': 72, 'count': 69, 'status': True, 'gradient': 18.018839419934583}, [0.8233070284273875, -4.166724537840807e-06])]
2021-08-18:15:42:45,142 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 105, 119, 107]
2021-08-18:15:42:45,505 INFO     [param_server.py:553] For epoch: 73, median_reward: 250.45304214140097, dev: 250.45304214140097
2021-08-18:15:42:46,96 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9336, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:42:46,97 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 829.5953, eval_time 0.5463, test_loss 1.9336, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:42:46,140 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2619, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:42:46,141 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 829.6418, eval_time 0.58, test_loss 2.2619, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:42:46,162 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:46,184 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:46,211 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3657, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:42:46,212 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 829.7124, eval_time 0.6546, test_loss 2.3657, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:42:46,212 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:46,220 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:46,281 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:46,294 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:47,419 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:47,433 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:48,613 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:48,627 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:49,5 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:49,23 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:49,53 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:49,74 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:50,223 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:50,250 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:50,694 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:50,703 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:50,836 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:50,857 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:51,180 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:51,196 INFO     [learner.py:606] ====Pushing takes 0.015269279479980469 s
2021-08-18:15:42:51,220 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:51,226 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:51,227 INFO     [param_server.py:410] Lock worker 1 with localStep 73 , while globalStep is 72

2021-08-18:15:42:51,330 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:51,341 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:52,478 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:52,497 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:53,186 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:53,200 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:53,329 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:53,343 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:55,549 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:55,568 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:55,778 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:55,792 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:56,296 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:56,317 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:56,913 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:56,924 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:57,62 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:57,76 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:57,678 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:57,709 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:57,724 INFO     [learner.py:606] ====Pushing takes 0.044405221939086914 s
2021-08-18:15:42:57,727 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:42:57,782 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:57,801 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:57,803 INFO     [param_server.py:410] Lock worker 3 with localStep 73 , while globalStep is 72

2021-08-18:15:42:58,202 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:42:58,234 INFO     [learner.py:606] ====Pushing takes 0.03069758415222168 s
2021-08-18:15:42:58,269 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:58,278 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:58,278 INFO     [param_server.py:381] ====After aggregation in epoch: 72, virtual_clock: 2156.423088546672, top_1: : 59.4063 % (1841.0), top_5: : 100.0 % (3099.0), test loss: 2.187050391126562, test len: 3099.0
2021-08-18:15:42:58,283 INFO     [param_server.py:410] Lock worker 2 with localStep 73 , while globalStep is 73

2021-08-18:15:42:58,283 INFO     [param_server.py:441] ====Epoch 74 completes 20 clients with loss 5.144116187611901, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:58,284 INFO     [param_server.py:450] ====Start to sample for epoch 74, global virtualClock: 2156.423088546672, round_duration: 39.20659048039421
2021-08-18:15:42:58,285 INFO     [oort.py:208] Training selector: Pacer 72: lastExploitationUtil 345.24847418585136, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:42:58,285 INFO     [oort.py:321] scores are 26,{5: 0.07403760621798723, 6: 0.04395942517593849, 7: 0.6450846938588313, 11: 0.04523030934477221, 14: 0.011014290023436535, 27: 0.030209535667753633, 50: 0.003290725195490984, 51: 0.4389098670489722, 53: 0.3695114018028877, 58: 0.004555113720083845, 60: 0.0018617751150483543, 67: 0.002487946292475061, 70: 0.009712070465170069, 71: 0.050847378076324445, 76: 0.002198459793409664, 79: 0.040513684244304966, 81: 0.22613747236089027, 84: 0.20311114972509017, 85: 0.008522335557715352, 87: 0.09133365934257871, 93: 0.017953608400444087, 97: 0.2379735146846322, 98: 0.16765982179061029, 105: 0.045609566204736635, 107: 0.004938242981313212, 110: 0.027155680393649264, 119: 0.03147584031357321},[7, 51, 53, 97, 81, 84, 98, 87, 5, 71, 105, 11, 6, 79, 119, 27, 110, 93, 14, 70, 85, 107, 58, 50, 67, 76, 60]
2021-08-18:15:42:58,286 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:42:58,287 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:58,287 INFO     [oort.py:398] At round 72, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 592.3018516723536, 'duration': 17.619275735353515, 'time_stamp': 73, 'count': 69, 'status': True, 'gradient': 19.887941832405186}, [0.7860511479272851, -4.109645337607368e-06]), ({'reward': 360.7209891776864, 'duration': 11.058674649423494, 'time_stamp': 73, 'count': 70, 'status': True, 'gradient': 20.198527040736497}, [0.4787121237375143, -4.109645337607368e-06]), ({'reward': 92.96100018553625, 'duration': 57.39721143529741, 'time_stamp': 73, 'count': 36, 'status': True, 'gradient': 8.287024869233976}, [0.12335852133953434, -4.109645337607368e-06])]
2021-08-18:15:42:58,288 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:42:58,655 INFO     [param_server.py:553] For epoch: 74, median_reward: 278.8610473025428, dev: 278.8610473025428
2021-08-18:15:42:59,333 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4664, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:42:59,335 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 842.835, eval_time 0.6441, test_loss 2.4664, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:42:59,364 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3319, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:42:59,366 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 842.8659, eval_time 0.6765, test_loss 2.3319, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:42:59,402 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1927, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:42:59,403 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 842.9019, eval_time 0.7145, test_loss 2.1927, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:42:59,417 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:42:59,425 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:59,440 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:42:59,455 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:59,476 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:42:59,498 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:00,564 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:00,577 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:01,816 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:01,827 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:02,92 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:02,104 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:02,468 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:02,489 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:03,860 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:03,880 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:04,453 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:04,464 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:04,748 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:04,769 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:04,777 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:04,795 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:05,359 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:05,372 INFO     [learner.py:606] ====Pushing takes 0.012248992919921875 s
2021-08-18:15:43:05,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:05,411 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:05,412 INFO     [param_server.py:410] Lock worker 1 with localStep 74 , while globalStep is 73

2021-08-18:15:43:06,72 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:06,90 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:06,796 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:06,810 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:07,315 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:07,329 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:09,466 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:09,483 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:10,33 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:10,51 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:10,153 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:10,164 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:10,827 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:10,849 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:11,276 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:11,292 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:11,419 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:11,467 INFO     [learner.py:606] ====Pushing takes 0.04617142677307129 s
2021-08-18:15:43:11,518 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:11,528 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:11,529 INFO     [param_server.py:410] Lock worker 3 with localStep 74 , while globalStep is 73

2021-08-18:15:43:12,412 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:12,423 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:12,949 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:12,987 INFO     [learner.py:606] ====Pushing takes 0.034012794494628906 s
2021-08-18:15:43:13,29 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:13,39 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:13,39 INFO     [param_server.py:381] ====After aggregation in epoch: 73, virtual_clock: 2200.7897256367746, top_1: : 59.9871 % (1859.0), top_5: : 100.0 % (3099.0), test loss: 2.3303366115799657, test len: 3099.0
2021-08-18:15:43:13,41 INFO     [param_server.py:410] Lock worker 2 with localStep 74 , while globalStep is 74

2021-08-18:15:43:13,42 INFO     [param_server.py:441] ====Epoch 75 completes 20 clients with loss 5.2842349381907505, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:13,42 INFO     [param_server.py:450] ====Start to sample for epoch 75, global virtualClock: 2200.7897256367746, round_duration: 44.36663709010263
2021-08-18:15:43:13,43 INFO     [oort.py:208] Training selector: Pacer 73: lastExploitationUtil 352.2562196498076, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:43:13,44 INFO     [oort.py:321] scores are 26,{5: 0.0070867702708548586, 6: 0.04373174296996196, 7: 0.07614407238702771, 11: 0.11379491150258528, 14: 0.009172320501722595, 27: 0.03602754796059847, 50: 0.03076801163620415, 51: 0.09793882903447262, 53: 0.3127773967616818, 58: 0.0037933414567348552, 60: 0.0016927298492534232, 67: 0.0020718757847392913, 70: 0.00808787700816867, 71: 0.020358201873062975, 76: 0.0018027437487908753, 79: 0.010012014472007077, 81: 0.05326887814302961, 84: 0.23107471449206243, 85: 0.025683786047736037, 87: 0.04255785043240577, 93: 0.02446944159354094, 97: 0.34331496395176453, 98: 0.4131176256441899, 105: 0.033362401389223126, 107: 0.011000468025847797, 110: 0.07574710137094748, 119: 0.03037674067083283},[98, 97, 53, 84, 11, 51, 7, 110, 81, 6, 87, 27, 105, 50, 119, 85, 93, 71, 107, 79, 14, 70, 5, 58, 67, 76, 60]
2021-08-18:15:43:13,45 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:43:13,45 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:13,45 INFO     [oort.py:398] At round 73, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 798.5525059574074, 'duration': 13.411352670399307, 'time_stamp': 74, 'count': 71, 'status': True, 'gradient': 18.034008159317253}, [0.8368658594220932, -4.054108839308643e-06]), ({'reward': 375.83001257003497, 'duration': 11.058674649423494, 'time_stamp': 74, 'count': 71, 'status': True, 'gradient': 20.20861554507172}, [0.3938562316860761, -4.054108839308643e-06]), ({'reward': 406.4821944290321, 'duration': 13.298442137908651, 'time_stamp': 74, 'count': 71, 'status': True, 'gradient': 20.934031699148658}, [0.4259794611973275, -4.054108839308643e-06])]
2021-08-18:15:43:13,46 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 27, 79, 50, 105, 119, 107]
2021-08-18:15:43:13,464 INFO     [param_server.py:553] For epoch: 75, median_reward: 283.54886149232607, dev: 283.54886149232607
2021-08-18:15:43:14,26 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3745, Top-1 Accuracy: 579.0/1033 (0.5605), Top-5 Accuracy: 1.0
2021-08-18:15:43:14,27 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 857.5274, eval_time 0.53, test_loss 2.3745, test_accuracy 0.5605, test_5_accuracy 1.0 

2021-08-18:15:43:14,29 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4382, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:43:14,31 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 857.5313, eval_time 0.5337, test_loss 2.4382, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:43:14,97 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:14,99 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4679, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:43:14,102 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 857.6003, eval_time 0.6052, test_loss 2.4679, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:43:14,106 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:14,126 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:14,138 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:14,181 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:14,204 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:15,250 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:15,271 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:16,572 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:16,586 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:17,151 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:17,165 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:17,377 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:17,391 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:18,744 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:18,765 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:18,808 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:18,818 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:19,496 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:19,517 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:19,521 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:19,531 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:20,195 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:20,212 INFO     [learner.py:606] ====Pushing takes 0.015424489974975586 s
2021-08-18:15:43:20,237 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:20,245 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:20,245 INFO     [param_server.py:410] Lock worker 1 with localStep 75 , while globalStep is 74

2021-08-18:15:43:20,676 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:20,685 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:21,356 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:21,366 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:21,658 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:21,673 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:23,552 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:23,563 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:24,119 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:24,133 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:24,155 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:24,169 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:24,601 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:24,615 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:24,908 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:24,935 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:25,348 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:25,357 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:43:25,564 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:25,600 INFO     [learner.py:606] ====Pushing takes 0.03519749641418457 s
2021-08-18:15:43:25,643 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:25,652 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:25,653 INFO     [param_server.py:410] Lock worker 3 with localStep 75 , while globalStep is 74

2021-08-18:15:43:25,819 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:43:25,854 INFO     [learner.py:606] ====Pushing takes 0.03368735313415527 s
2021-08-18:15:43:25,899 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:25,908 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:25,909 INFO     [param_server.py:381] ====After aggregation in epoch: 74, virtual_clock: 2239.1857471955605, top_1: : 56.6312 % (1755.0), top_5: : 100.0 % (3099.0), test loss: 2.426834305127462, test len: 3099.0
2021-08-18:15:43:25,911 INFO     [param_server.py:410] Lock worker 2 with localStep 75 , while globalStep is 75

2021-08-18:15:43:25,911 INFO     [param_server.py:441] ====Epoch 76 completes 20 clients with loss 4.991938708119309, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:25,912 INFO     [param_server.py:450] ====Start to sample for epoch 76, global virtualClock: 2239.1857471955605, round_duration: 38.39602155878561
2021-08-18:15:43:25,913 INFO     [oort.py:208] Training selector: Pacer 74: lastExploitationUtil 332.4030746064084, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:43:25,913 INFO     [oort.py:321] scores are 26,{5: 0.007097998079385263, 6: 0.46175502307328353, 7: 0.07575457251688984, 11: 0.11095051359752982, 14: 0.009692896776905926, 27: 0.05852946876104985, 50: 0.006061194440638357, 51: 0.3678473861742386, 53: 0.2650054905585974, 58: 0.004008633057772421, 60: 0.00178880095793857, 67: 0.002189465371633858, 70: 0.008546905548030817, 71: 0.08927906565611701, 76: 0.0019347088010534435, 79: 0.0033810985137224885, 81: 0.0470730755047105, 84: 0.0610130650946982, 85: 0.017817078162215543, 87: 0.009019295246166261, 93: 0.053133881453768135, 97: 0.34319070399572366, 98: 0.1455350670759055, 105: 0.04492189272609245, 107: 0.011281552838786336, 110: 0.05086019725563169, 119: 0.027920569860278726},[6, 51, 97, 53, 98, 11, 71, 7, 84, 27, 93, 110, 81, 105, 119, 85, 107, 14, 87, 70, 5, 50, 58, 79, 67, 76, 60]
2021-08-18:15:43:25,915 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:43:25,915 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:25,916 INFO     [oort.py:398] At round 74, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 828.9057124496508, 'duration': 43.8287324306519, 'time_stamp': 75, 'count': 63, 'status': True, 'gradient': 11.612073076213571}, [0.9845545032058238, -4.000053334044458e-06]), ({'reward': 271.4892198045151, 'duration': 11.058674649423494, 'time_stamp': 75, 'count': 72, 'status': True, 'gradient': 20.216490277920574}, [0.3224604627479178, -4.000053334044458e-06]), ({'reward': 613.1113379911019, 'duration': 11.90395711384456, 'time_stamp': 75, 'count': 73, 'status': True, 'gradient': 20.835498140077252}, [0.7282359852241442, -4.000053334044458e-06])]
2021-08-18:15:43:25,917 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119, 107]
2021-08-18:15:43:26,413 INFO     [param_server.py:553] For epoch: 76, median_reward: 276.370331838097, dev: 276.370331838097
2021-08-18:15:43:27,4 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5415, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:43:27,7 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 870.5076, eval_time 0.5486, test_loss 2.5415, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:43:27,10 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6458, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:43:27,11 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 870.5115, eval_time 0.5479, test_loss 2.6458, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:43:27,79 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:27,87 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:27,125 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:27,131 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4297, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:43:27,132 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 870.6306, eval_time 0.6739, test_loss 2.4297, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:43:27,144 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:27,201 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:27,226 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:28,283 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:28,302 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:29,515 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:29,524 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:30,92 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:30,110 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:30,205 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:30,219 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:31,650 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:31,664 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:32,151 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:32,170 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:32,283 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:32,304 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:32,656 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:32,666 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:32,884 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:32,903 INFO     [learner.py:606] ====Pushing takes 0.013613462448120117 s
2021-08-18:15:43:32,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:32,933 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:32,934 INFO     [param_server.py:410] Lock worker 1 with localStep 76 , while globalStep is 75

2021-08-18:15:43:33,890 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:33,900 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:34,461 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:34,478 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:35,5 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:35,26 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:36,284 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:36,305 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:37,277 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:37,288 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:37,996 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:38,6 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:38,608 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:38,622 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:38,630 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:38,644 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:39,203 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:39,212 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:43:39,234 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:39,280 INFO     [learner.py:606] ====Pushing takes 0.044265031814575195 s
2021-08-18:15:43:39,332 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:39,345 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:39,345 INFO     [param_server.py:410] Lock worker 3 with localStep 76 , while globalStep is 75

2021-08-18:15:43:39,801 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:43:39,838 INFO     [learner.py:606] ====Pushing takes 0.03549075126647949 s
2021-08-18:15:43:39,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:39,882 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:39,883 INFO     [param_server.py:381] ====After aggregation in epoch: 75, virtual_clock: 2283.5523842856633, top_1: : 58.2769 % (1806.0), top_5: : 100.0 % (3099.0), test loss: 2.5390087034967213, test len: 3099.0
2021-08-18:15:43:39,886 INFO     [param_server.py:410] Lock worker 2 with localStep 76 , while globalStep is 76

2021-08-18:15:43:39,886 INFO     [param_server.py:441] ====Epoch 77 completes 20 clients with loss 5.84401989272917, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:39,887 INFO     [param_server.py:450] ====Start to sample for epoch 77, global virtualClock: 2283.5523842856633, round_duration: 44.36663709010263
2021-08-18:15:43:39,888 INFO     [oort.py:208] Training selector: Pacer 75: lastExploitationUtil 388.22372986427854, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:43:39,888 INFO     [oort.py:321] scores are 25,{5: 0.08861851247824223, 6: 0.13009180200059436, 7: 0.48592485759847953, 11: 0.07822822395583415, 14: 0.008260969223445228, 27: 0.05550274435022375, 50: 0.015904079267434076, 51: 0.04239038683362921, 53: 0.05015867539179965, 58: 0.0030217827898849177, 60: 0.0015245421467406685, 67: 0.001866016575556679, 70: 0.00728427479555951, 76: 0.0016488950857199694, 79: 0.020207917218337, 81: 0.07567793420564313, 84: 0.27849862775181305, 85: 0.04818124324473728, 87: 0.008973721342833309, 93: 0.013104736105341826, 97: 0.24125274793481394, 98: 0.24974451780323864, 105: 0.04556005173050891, 107: 0.0028127536674207023, 110: 0.025669030608693178, 119: 0.002712444362282858},[7, 84, 98, 97, 6, 5, 11, 81, 27, 53, 85, 105, 51, 110, 79, 50, 93, 87, 14, 70, 58, 107, 119, 67, 76, 60]
2021-08-18:15:43:39,890 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:43:39,890 INFO     [oort.py:365] exploration poss is [202.          16.91829855   9.05547074   1.91505738   0.90032832]
2021-08-18:15:43:39,891 INFO     [oort.py:398] At round 75, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 66, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 811.5930907224625, 'duration': 15.972045438625893, 'time_stamp': 76, 'count': 73, 'status': True, 'gradient': 20.952304173985713}, [0.6808513355983515, -3.9474203607942245e-06]), ({'reward': 425.97784803678667, 'duration': 27.035726288496562, 'time_stamp': 76, 'count': 66, 'status': True, 'gradient': 19.914893842524826}, [0.35735192712630637, -3.9474203607942245e-06]), ({'reward': 489.3942671139341, 'duration': 5.8943907365129, 'time_stamp': 76, 'count': 73, 'status': True, 'gradient': 21.15420592456384}, [0.4105530763236033, -3.9474203607942245e-06])]
2021-08-18:15:43:39,892 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:40,265 INFO     [param_server.py:553] For epoch: 77, median_reward: 293.6849249157854, dev: 293.6849249157854
2021-08-18:15:43:40,818 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5822, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:43:40,819 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 884.3191, eval_time 0.5193, test_loss 2.5822, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:43:40,888 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:40,894 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5287, Top-1 Accuracy: 544.0/1033 (0.5266), Top-5 Accuracy: 1.0
2021-08-18:15:43:40,895 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 884.3954, eval_time 0.5948, test_loss 2.5287, test_accuracy 0.5266, test_5_accuracy 1.0 

2021-08-18:15:43:40,897 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4507, Top-1 Accuracy: 569.0/1033 (0.5508), Top-5 Accuracy: 1.0
2021-08-18:15:43:40,897 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 884.3959, eval_time 0.5989, test_loss 2.4507, test_accuracy 0.5508, test_5_accuracy 1.0 

2021-08-18:15:43:40,903 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:43:40,967 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:40,968 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:40,982 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:40,987 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:42,31 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:43:42,45 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:43,39 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:43,53 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:43,580 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:43,590 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:43,673 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:43,687 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:44,251 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:44,271 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:44,873 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:44,899 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:45,613 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:45,639 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:45,811 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:45,825 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:46,351 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:46,368 INFO     [learner.py:606] ====Pushing takes 0.015328168869018555 s
2021-08-18:15:43:46,390 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:46,395 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:46,396 INFO     [param_server.py:410] Lock worker 1 with localStep 77 , while globalStep is 76

2021-08-18:15:43:46,790 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:46,805 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:46,905 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:46,914 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:47,527 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:47,542 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:49,604 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:49,622 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:49,645 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:49,659 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:50,372 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:50,386 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:50,417 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:50,438 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:50,852 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:50,862 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:51,36 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:51,56 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:51,518 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:51,554 INFO     [learner.py:606] ====Pushing takes 0.034276485443115234 s
2021-08-18:15:43:51,605 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:51,614 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:51,615 INFO     [param_server.py:410] Lock worker 2 with localStep 77 , while globalStep is 76

2021-08-18:15:43:51,704 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:51,741 INFO     [learner.py:606] ====Pushing takes 0.03480195999145508 s
2021-08-18:15:43:51,774 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:51,783 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:51,784 INFO     [param_server.py:381] ====After aggregation in epoch: 76, virtual_clock: 2319.843401273001, top_1: : 53.9529 % (1672.0), top_5: : 100.0 % (3099.0), test loss: 2.520549301747923, test len: 3099.0
2021-08-18:15:43:51,786 INFO     [param_server.py:410] Lock worker 3 with localStep 77 , while globalStep is 77

2021-08-18:15:43:51,786 INFO     [param_server.py:441] ====Epoch 78 completes 20 clients with loss 7.84277065480102, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:43:51,787 INFO     [param_server.py:450] ====Start to sample for epoch 78, global virtualClock: 2319.843401273001, round_duration: 36.29101698733738
2021-08-18:15:43:51,788 INFO     [oort.py:208] Training selector: Pacer 76: lastExploitationUtil 244.85729457271015, lastExplorationUtil 135.7746047952286, last_util_record 40
2021-08-18:15:43:51,788 INFO     [oort.py:321] scores are 26,{5: 0.0735671180543018, 6: 0.04307210637483607, 7: 0.23174647888086436, 11: 0.012897824864734892, 14: 0.007116232240072659, 27: 0.006613004953859028, 50: 0.008213627107701127, 51: 0.04217877636883266, 53: 0.11953749435106312, 58: 0.002943017393139624, 60: 0.0013132836695717608, 67: 0.0016074393883225755, 70: 0.0062748800708025, 76: 0.0014204048038571676, 79: 0.04797949030087495, 81: 0.07835175610866887, 84: 0.08069891758863335, 85: 0.008350312640231807, 87: 0.022825104360769306, 93: 0.013039317988041525, 97: 0.2668132824826541, 98: 0.38409262181148823, 105: 0.039182086536230704, 107: 0.00313865134034055, 110: 0.007960901840617074, 113: 0.22760348217115875, 119: 0.014028327931605642},[98, 97, 7, 113, 53, 84, 81, 5, 79, 6, 51, 105, 87, 119, 93, 11, 85, 50, 110, 14, 27, 70, 107, 58, 67, 76, 60]
2021-08-18:15:43:51,790 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:43:51,791 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:51,791 INFO     [oort.py:398] At round 76, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 688.5347886614529, 'duration': 13.411352670399307, 'time_stamp': 77, 'count': 74, 'status': True, 'gradient': 18.056484797467686}, [0.7738677332698387, -3.8961544955129325e-06]), ({'reward': 135.78818225570814, 'duration': 8.009219946401625, 'time_stamp': 77, 'count': 1, 'status': True, 'gradient': 20.962763960988987}, [0.15260795554884032, -3.8961544955129325e-06]), ({'reward': 677.3964750628031, 'duration': 15.972045438625893, 'time_stamp': 77, 'count': 74, 'status': True, 'gradient': 20.96228631421935}, [0.7613488210769984, -3.8961544955129325e-06])]
2021-08-18:15:43:51,792 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:52,149 INFO     [param_server.py:553] For epoch: 78, median_reward: 260.87739678620505, dev: 260.87739678620505
2021-08-18:15:43:52,793 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3806, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:43:52,796 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3128, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:43:52,796 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 896.2969, eval_time 0.6141, test_loss 2.3806, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:43:52,797 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 896.2971, eval_time 0.6125, test_loss 2.3128, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:43:52,830 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8293, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:43:52,833 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 896.3319, eval_time 0.6511, test_loss 2.8293, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:43:52,865 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:43:52,866 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:43:52,874 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:43:52,875 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:52,902 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:43:52,918 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:54,203 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:43:54,213 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:55,441 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:55,463 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:55,882 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:55,892 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:56,127 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:56,141 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:56,752 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:56,767 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:57,654 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:57,681 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:58,136 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:58,150 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:58,499 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:58,519 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:59,126 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:59,142 INFO     [learner.py:606] ====Pushing takes 0.014972925186157227 s
2021-08-18:15:43:59,165 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:59,165 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:59,172 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:59,172 INFO     [param_server.py:410] Lock worker 1 with localStep 78 , while globalStep is 77

2021-08-18:15:43:59,175 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:59,756 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:59,766 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:59,768 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:59,791 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:02,627 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:02,641 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:02,771 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:02,789 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:03,520 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:03,538 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:03,772 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:03,786 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:04,131 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:04,143 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:04,778 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:04,815 INFO     [learner.py:606] ====Pushing takes 0.035784006118774414 s
2021-08-18:15:44:04,866 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:04,876 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:04,877 INFO     [param_server.py:410] Lock worker 3 with localStep 78 , while globalStep is 77

2021-08-18:15:44:06,275 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:06,289 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:06,926 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:06,961 INFO     [learner.py:606] ====Pushing takes 0.032973527908325195 s
2021-08-18:15:44:06,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:07,7 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:07,8 INFO     [param_server.py:381] ====After aggregation in epoch: 77, virtual_clock: 2363.081798443934, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.5075901437688755, test len: 3099.0
2021-08-18:15:44:07,10 INFO     [param_server.py:410] Lock worker 2 with localStep 78 , while globalStep is 78

2021-08-18:15:44:07,11 INFO     [param_server.py:441] ====Epoch 79 completes 20 clients with loss 4.477466010579766, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:44:07,11 INFO     [param_server.py:450] ====Start to sample for epoch 79, global virtualClock: 2363.081798443934, round_duration: 43.23839717093311
2021-08-18:15:44:07,12 INFO     [oort.py:208] Training selector: Pacer 77: lastExploitationUtil 286.8050884727163, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:44:07,13 INFO     [oort.py:321] scores are 26,{5: 0.06814357293923405, 6: 0.04285964980137968, 7: 0.07462561643610956, 11: 0.023152247133413514, 14: 0.006755499527069386, 27: 0.09475903059344457, 50: 0.0031863468441707984, 51: 0.09904557821237184, 53: 0.21061589723362353, 58: 0.002793831333322072, 60: 0.0012467113086530456, 67: 0.0015259558234281274, 70: 0.005956796788055724, 76: 0.0013484023085517242, 79: 0.009336746078025353, 81: 0.01956389039233801, 84: 0.034342332550274676, 85: 0.03981152293647486, 87: 0.058573424218886894, 93: 0.01720472072197846, 97: 0.2166472707784306, 98: 0.23870329098193147, 105: 0.01584925001335532, 107: 0.002868769890425238, 110: 0.007921634062255802, 113: 0.7850573232937176, 119: 0.0052483384428462085},[113, 98, 97, 53, 51, 27, 7, 5, 87, 6, 85, 84, 11, 81, 93, 105, 79, 110, 14, 70, 119, 50, 107, 58, 67, 76, 60]
2021-08-18:15:44:07,36 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:44:07,37 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:07,38 INFO     [oort.py:398] At round 77, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 512.744123898766, 'duration': 13.411352670399307, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 18.063040185735208}, [0.4529202035463766, -3.846203156450727e-06]), ({'reward': 684.3079843390858, 'duration': 15.972045438625893, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 20.965117118447743}, [0.6044699706761261, -3.846203156450727e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 21.170910299158322}, [8.833431862677246e-09, -3.846203156450727e-06])]
2021-08-18:15:44:07,39 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:44:07,442 INFO     [param_server.py:553] For epoch: 79, median_reward: 270.87502969034296, dev: 270.87502969034296
2021-08-18:15:44:08,38 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4004, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:44:08,39 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 911.5396, eval_time 0.5514, test_loss 2.4004, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:44:08,49 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8588, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:44:08,50 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 911.5508, eval_time 0.5642, test_loss 3.8588, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:44:08,127 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:08,131 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2861, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:44:08,132 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 911.6303, eval_time 0.6457, test_loss 2.2861, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:44:08,136 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:08,144 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:08,154 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:08,207 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:08,232 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:09,321 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:09,330 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:10,334 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:10,343 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:10,966 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:10,978 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:11,438 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:11,459 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:11,636 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:11,663 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:12,974 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:12,992 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:13,284 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:13,295 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:13,623 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:13,637 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:13,698 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:13,712 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:14,160 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:14,178 INFO     [learner.py:606] ====Pushing takes 0.01618337631225586 s
2021-08-18:15:44:14,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:14,208 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:14,208 INFO     [param_server.py:410] Lock worker 1 with localStep 79 , while globalStep is 78

2021-08-18:15:44:14,471 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:14,480 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:15,109 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:15,119 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:16,488 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:16,507 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:17,180 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:17,198 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:17,474 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:17,486 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:17,790 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:17,804 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:18,98 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:18,109 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:18,523 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:18,566 INFO     [learner.py:606] ====Pushing takes 0.04171299934387207 s
2021-08-18:15:44:18,642 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:18,670 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:18,672 INFO     [param_server.py:410] Lock worker 2 with localStep 79 , while globalStep is 78

2021-08-18:15:44:18,753 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:18,764 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:19,415 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:19,462 INFO     [learner.py:606] ====Pushing takes 0.04512286186218262 s
2021-08-18:15:44:19,514 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:19,528 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:19,529 INFO     [param_server.py:381] ====After aggregation in epoch: 78, virtual_clock: 2400.425317716996, top_1: : 56.2439 % (1743.0), top_5: : 100.0 % (3099.0), test loss: 2.848458961204246, test len: 3099.0
2021-08-18:15:44:19,531 INFO     [param_server.py:410] Lock worker 3 with localStep 79 , while globalStep is 79

2021-08-18:15:44:19,532 INFO     [param_server.py:441] ====Epoch 80 completes 20 clients with loss 6.016571260654006, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:44:19,533 INFO     [param_server.py:450] ====Start to sample for epoch 80, global virtualClock: 2400.425317716996, round_duration: 37.343519273061496
2021-08-18:15:44:19,534 INFO     [oort.py:208] Training selector: Pacer 78: lastExploitationUtil 345.381519460769, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:44:19,535 INFO     [oort.py:321] scores are 26,{5: 0.026105793001092528, 6: 0.04583485677075251, 7: 0.41243544327216464, 11: 0.012771645012842862, 14: 0.009485680553087232, 27: 0.03692365943113091, 50: 0.008591318473654972, 51: 0.0417661399893639, 53: 0.05500452769837386, 58: 0.003922935889627033, 60: 0.0015033398862017743, 67: 0.0021426586473971237, 70: 0.008364188499272217, 76: 0.0018933483015897256, 79: 0.029224300677239134, 81: 0.1730531944892255, 84: 0.19734922709518232, 85: 0.00826862125247871, 87: 0.0785716586566659, 93: 0.12543110641343722, 97: 0.32840059107748026, 98: 0.24725681307150732, 105: 0.04551302719990189, 107: 0.011376284290114549, 110: 0.007883020071736604, 113: 0.9557165623043539, 119: 0.02407970290297164},[113, 7, 97, 98, 84, 81, 93, 87, 53, 6, 105, 51, 27, 79, 5, 119, 11, 107, 14, 50, 70, 85, 110, 58, 67, 76, 60]
2021-08-18:15:44:19,536 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:44:19,537 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:19,537 INFO     [oort.py:398] At round 78, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 422.2281823972593, 'duration': 13.411352670399307, 'time_stamp': 79, 'count': 76, 'status': True, 'gradient': 18.069983709100377}, [0.47218766559030617, -3.797516424258538e-06]), ({'reward': 302.39621628827746, 'duration': 5.8943907365129, 'time_stamp': 79, 'count': 76, 'status': True, 'gradient': 21.177613561456255}, [0.338173600448228, -3.797516424258538e-06]), ({'reward': 523.8550908444226, 'duration': 17.619275735353515, 'time_stamp': 79, 'count': 75, 'status': True, 'gradient': 18.27540964606558}, [0.5858421066468762, -3.797516424258538e-06])]
2021-08-18:15:44:19,538 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:44:20,38 INFO     [param_server.py:553] For epoch: 80, median_reward: 285.57429002946395, dev: 285.57429002946395
2021-08-18:15:44:20,722 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5889, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:44:20,724 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 924.2245, eval_time 0.6516, test_loss 2.5889, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:44:20,756 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1514, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:44:20,761 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 924.2614, eval_time 0.6861, test_loss 2.1514, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:44:20,791 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5287, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:44:20,792 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 924.2908, eval_time 0.7199, test_loss 2.5287, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:44:20,832 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:20,843 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:20,856 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:20,865 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:20,868 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:20,894 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:23,777 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:24,986 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:26,296 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:26,313 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:26,401 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:26,420 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:26,472 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:26,492 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:28,794 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:29,634 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:30,310 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:30,356 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:30,634 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:30,646 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:31,132 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:31,152 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:31,755 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:31,715 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:32,683 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:32,691 INFO     [learner.py:606] ====Pushing takes 0.016564369201660156 s
2021-08-18:15:44:32,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:32,762 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:32,764 INFO     [param_server.py:410] Lock worker 1 with localStep 80 , while globalStep is 79

2021-08-18:15:44:33,335 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:33,345 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:33,787 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:34,621 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:38,311 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:38,388 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:39,303 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:39,415 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:40,148 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:40,167 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:40,347 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:40,366 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:40,830 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:40,849 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:42,765 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:42,823 INFO     [learner.py:606] ====Pushing takes 0.057558536529541016 s
2021-08-18:15:44:42,910 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:44,285 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:44,286 INFO     [param_server.py:410] Lock worker 3 with localStep 80 , while globalStep is 79

2021-08-18:15:44:45,627 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:47,10 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:47,629 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:47,682 INFO     [learner.py:606] ====Pushing takes 0.05085587501525879 s
2021-08-18:15:44:47,781 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:47,795 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:47,795 INFO     [param_server.py:381] ====After aggregation in epoch: 79, virtual_clock: 2444.7919548070986, top_1: : 59.4063 % (1841.0), top_5: : 100.0 % (3099.0), test loss: 2.422974434163835, test len: 3099.0
2021-08-18:15:44:47,802 INFO     [param_server.py:410] Lock worker 2 with localStep 80 , while globalStep is 80

2021-08-18:15:44:47,802 INFO     [param_server.py:441] ====Epoch 81 completes 20 clients with loss 4.631976361216761, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:44:47,804 INFO     [param_server.py:450] ====Start to sample for epoch 81, global virtualClock: 2444.7919548070986, round_duration: 44.36663709010263
2021-08-18:15:44:47,805 INFO     [oort.py:208] Training selector: Pacer 79: lastExploitationUtil 362.9894908887105, lastExplorationUtil 0.0, last_util_record 40
2021-08-18:15:44:47,806 INFO     [oort.py:321] scores are 26,{5: 0.03864925660710213, 6: 0.04244524380851746, 7: 0.09231543013478345, 11: 0.057852917042900825, 14: 0.009049075697642435, 27: 0.09469540534269366, 50: 0.01402212589988417, 51: 0.041564915143457525, 53: 0.27887519056023324, 58: 0.0037423718439136906, 60: 0.0016699853149131005, 67: 0.001963731537573031, 70: 0.007979203437820909, 76: 0.0018062016749564695, 79: 0.02009332094546729, 81: 0.090720143662184, 84: 0.18819524957236689, 85: 0.03292351432065013, 87: 0.08638016071245798, 93: 0.03068964784127272, 97: 0.2246459971091968, 98: 0.3954142590329833, 105: 0.042411897676742825, 107: 0.010852659134261308, 110: 0.02720023130168888, 113: 0.6609413136830328, 119: 0.0025174248254160635},[113, 98, 53, 97, 84, 27, 7, 81, 87, 11, 6, 105, 51, 5, 85, 93, 110, 79, 50, 107, 14, 70, 58, 119, 67, 76, 60]
2021-08-18:15:44:47,810 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:44:47,810 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:47,811 INFO     [oort.py:398] At round 79, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.3, sampled score is [({'reward': 794.674238729038, 'duration': 13.411352670399307, 'time_stamp': 80, 'count': 77, 'status': True, 'gradient': 18.08056781666347}, [0.7999805672191029, -3.750046875585948e-06]), ({'reward': 18.299008085504546, 'duration': 5.8943907365129, 'time_stamp': 80, 'count': 77, 'status': True, 'gradient': 21.193753551319915}, [0.018411371954032807, -3.750046875585948e-06]), ({'reward': 583.1460544688142, 'duration': 8.009219946401625, 'time_stamp': 80, 'count': 4, 'status': True, 'gradient': 20.987878789314653}, [0.5870372555022821, -3.750046875585948e-06])]
2021-08-18:15:44:47,816 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:44:49,443 INFO     [param_server.py:541] Handle Wight 0.06516265869140625 | Send 1.6394908428192139
2021-08-18:15:44:49,444 INFO     [param_server.py:553] For epoch: 81, median_reward: 289.87750398117754, dev: 289.87750398117754
2021-08-18:15:44:50,90 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5369, Top-1 Accuracy: 572.0/1033 (0.5537), Top-5 Accuracy: 1.0
2021-08-18:15:44:50,68 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3584, Top-1 Accuracy: 577.0/1033 (0.5586), Top-5 Accuracy: 1.0
2021-08-18:15:44:51,337 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 954.8376, eval_time 1.8606, test_loss 2.5369, test_accuracy 0.5537, test_5_accuracy 1.0 

2021-08-18:15:44:51,338 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 954.8381, eval_time 1.8586, test_loss 2.3584, test_accuracy 0.5586, test_5_accuracy 1.0 

2021-08-18:15:44:50,91 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.534, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:44:51,340 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 954.8381, eval_time 1.8632, test_loss 2.534, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:44:51,443 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:44:51,450 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:44:51,459 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:44:51,463 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:51,465 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:51,481 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:52,896 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:52,909 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:56,460 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:56,470 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:56,544 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:56,555 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:57,119 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:57,142 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:57,678 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:58,687 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:59,301 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:59,738 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:00,501 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:00,505 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:00,872 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:01,167 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:01,559 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:02,41 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:45:02,43 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:02,60 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:02,615 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:02,663 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:02,683 INFO     [learner.py:606] ====Pushing takes 0.018225669860839844 s
2021-08-18:15:45:02,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:02,721 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:02,721 INFO     [param_server.py:410] Lock worker 1 with localStep 81 , while globalStep is 80

2021-08-18:15:45:03,47 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:05,156 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:45:05,179 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:05,617 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:05,634 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:05,953 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:05,973 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:06,309 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:06,321 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:45:06,576 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:45:06,596 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:45:06,928 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:45:06,939 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:45:07,461 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:45:07,496 INFO     [learner.py:606] ====Pushing takes 0.03376340866088867 s
2021-08-18:15:45:07,536 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:45:07,574 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:07,588 INFO     [learner.py:606] ====Pushing takes 0.0462799072265625 s
2021-08-18:15:45:07,588 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:45:07,589 INFO     [param_server.py:410] Lock worker 2 with localStep 81 , while globalStep is 80

2021-08-18:15:45:07,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:07,641 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:45:07,672 INFO     [param_server.py:381] ====After aggregation in epoch: 80, virtual_clock: 2482.1354740801603, top_1: : 55.9535 % (1734.0), top_5: : 100.0 % (3099.0), test loss: 2.476411684795662, test len: 3099.0
2021-08-18:15:45:07,836 INFO     [param_server.py:410] Lock worker 3 with localStep 81 , while globalStep is 81

2021-08-18:15:45:07,838 INFO     [param_server.py:441] ====Epoch 82 completes 20 clients with loss 5.519144825062823, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:45:07,839 INFO     [param_server.py:450] ====Start to sample for epoch 82, global virtualClock: 2482.1354740801603, round_duration: 37.343519273061496
2021-08-18:15:45:07,840 INFO     [oort.py:208] Training selector: Pacer 80: lastExploitationUtil 371.7198496094251, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:45:07,850 INFO     [oort.py:321] scores are 26,{5: 0.0262406787871795, 6: 0.0938122861475104, 7: 0.07355209603704346, 11: 0.0797320202333877, 14: 0.008832681042764216, 27: 0.05865272672321052, 50: 0.016971687288621116, 51: 0.04136695993728773, 53: 0.04894769947685223, 58: 0.003585703631113141, 60: 0.0016300501980075733, 67: 0.001995156837726301, 70: 0.007788393123947614, 76: 0.0017630091543994256, 79: 0.026060688970249324, 81: 0.11207699693053678, 84: 0.16140330693380636, 85: 0.056443337984958146, 87: 0.06121064345566841, 93: 0.02685635923532658, 97: 0.3199494718385989, 98: 0.2555958691488414, 105: 0.045482957101057306, 107: 0.010593134569947928, 110: 0.012390593002253631, 113: 1.0147018410234723, 119: 0.0025054354505162895},[113, 97, 98, 84, 81, 6, 11, 7, 87, 27, 85, 53, 105, 51, 93, 5, 79, 50, 110, 107, 14, 70, 58, 119, 67, 76, 60]
2021-08-18:15:45:07,851 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:45:07,852 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:45:07,853 INFO     [oort.py:398] At round 80, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 93.95946207985588, 'duration': 11.90395711384456, 'time_stamp': 81, 'count': 79, 'status': True, 'gradient': 20.888628401353348}, [0.08979035134888778, -3.7037494290052997e-06]), ({'reward': 984.7541329859683, 'duration': 8.009219946401625, 'time_stamp': 81, 'count': 5, 'status': True, 'gradient': 20.99637647074543}, [0.9411497545437312, -3.7037494290052997e-06]), ({'reward': 1046.330342560015, 'duration': 43.8287324306519, 'time_stamp': 81, 'count': 69, 'status': True, 'gradient': 11.641505392970956}, [1.0, -3.7037494290052997e-06])]
2021-08-18:15:45:07,854 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:45:08,461 INFO     [param_server.py:553] For epoch: 82, median_reward: 291.91582263888887, dev: 291.91582263888887
2021-08-18:15:45:09,86 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7087, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:45:09,823 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 973.323, eval_time 1.3383, test_loss 2.7087, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:45:09,86 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5778, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:45:09,828 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 973.3263, eval_time 1.3438, test_loss 2.5778, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:45:09,78 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4265, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:45:09,836 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 973.3364, eval_time 1.3488, test_loss 2.4265, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:45:09,926 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:09,936 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:45:09,938 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:09,947 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:45:09,997 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:10,7 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:45:12,448 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:45:13,486 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:45:14,674 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:45:14,690 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:45:14,786 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:45:14,787 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:45:14,801 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:45:14,803 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:45:15,944 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:45:16,75 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:45:17,400 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:45:17,412 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:17,916 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:18,132 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:20,355 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:22,72 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:22,79 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:22,81 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:45:22,717 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:22,735 INFO     [learner.py:606] ====Pushing takes 0.01679539680480957 s
2021-08-18:15:45:22,770 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:22,832 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:22,832 INFO     [param_server.py:410] Lock worker 1 with localStep 82 , while globalStep is 81

2021-08-18:15:45:23,182 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:23,765 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:24,528 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:25,247 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:45:25,628 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:25,643 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:26,919 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:28,689 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:29,664 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:29,673 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:30,421 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:31,52 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:45:31,731 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:45:31,740 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:45:32,431 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:45:37,519 INFO     [learner.py:606] ====Pushing takes 0.07242107391357422 s
2021-08-18:15:45:37,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:37,600 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:45:37,601 INFO     [param_server.py:410] Lock worker 3 with localStep 82 , while globalStep is 81

2021-08-18:15:45:38,67 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:45:41,503 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:45:42,140 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:45:43,140 INFO     [learner.py:606] ====Pushing takes 0.06396293640136719 s
2021-08-18:15:45:43,197 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:43,273 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:45:43,347 INFO     [param_server.py:381] ====After aggregation in epoch: 81, virtual_clock: 2526.502111170263, top_1: : 58.9545 % (1827.0), top_5: : 100.0 % (3099.0), test loss: 2.570976641443041, test len: 3099.0
2021-08-18:15:45:43,420 INFO     [param_server.py:410] Lock worker 2 with localStep 82 , while globalStep is 82

2021-08-18:15:45:43,421 INFO     [param_server.py:441] ====Epoch 83 completes 20 clients with loss 4.80530723168371, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:45:43,421 INFO     [param_server.py:450] ====Start to sample for epoch 83, global virtualClock: 2526.502111170263, round_duration: 44.36663709010263
2021-08-18:15:45:43,423 INFO     [oort.py:208] Training selector: Pacer 81: lastExploitationUtil 365.6420060388704, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:45:43,424 INFO     [oort.py:321] scores are 26,{5: 0.060269480740511736, 6: 0.046771514920188495, 7: 0.5491864721982079, 11: 0.012590019378988222, 14: 0.008049437455768893, 27: 0.036986207814406424, 50: 0.01968707320773526, 51: 0.041172183483244154, 53: 0.35128329656988544, 58: 0.003328957464867046, 60: 0.001485504464057881, 67: 0.0018182350412034706, 70: 0.0070977524297126775, 76: 0.0016302297391555139, 79: 0.047899609270597825, 81: 0.019191664226339323, 84: 0.033688929033883735, 85: 0.015205699045457264, 87: 0.07472909772473725, 93: 0.0448323375417597, 97: 0.25870898011875015, 98: 0.17694086108366627, 105: 0.035124358631059775, 107: 0.009653781651177345, 110: 0.014527762446493418, 113: 0.49986525491220757, 119: 0.0024936386002370704},[7, 113, 53, 97, 98, 87, 5, 79, 6, 93, 51, 27, 105, 84, 50, 81, 85, 110, 11, 107, 14, 70, 58, 119, 67, 76, 60]
2021-08-18:15:45:43,426 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:45:43,426 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:45:43,427 INFO     [oort.py:398] At round 81, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 491.23212955669936, 'duration': 8.009219946401625, 'time_stamp': 82, 'count': 6, 'status': True, 'gradient': 21.007241542632674}, [0.42665948782404445, -3.658581202209786e-06]), ({'reward': 0.01, 'duration': 21.753601635627824, 'time_stamp': 82, 'count': 74, 'status': True, 'gradient': 21.214511549216958}, [8.685673007512721e-09, -3.658581202209786e-06]), ({'reward': 548.016695638496, 'duration': 5.8943907365129, 'time_stamp': 82, 'count': 79, 'status': True, 'gradient': 21.213401385471002}, [0.4759807051100448, -3.658581202209786e-06])]
2021-08-18:15:45:43,428 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:45:44,157 INFO     [param_server.py:553] For epoch: 83, median_reward: 290.6717047362243, dev: 290.6717047362243
2021-08-18:15:45:44,873 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3277, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:45:44,903 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 1008.4015, eval_time 0.7247, test_loss 2.3277, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:45:44,870 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3301, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:45:44,945 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 1008.445, eval_time 0.7541, test_loss 2.3301, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:45:44,878 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2734, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:45:44,955 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 1008.4549, eval_time 0.7661, test_loss 2.2734, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:45:45,45 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:45:45,53 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:45:45,76 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:45:45,85 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:45:45,97 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:45:45,131 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:45:46,978 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:45:46,993 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:45:48,167 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:45:48,178 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:45:48,669 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:45:48,679 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:45:48,863 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:45:48,882 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:45:49,295 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:45:49,306 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:45:50,306 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:45:50,333 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:51,115 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:51,130 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:51,139 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:51,149 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:51,777 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:51,798 INFO     [learner.py:606] ====Pushing takes 0.019634246826171875 s
2021-08-18:15:45:51,829 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:51,834 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:51,835 INFO     [param_server.py:410] Lock worker 1 with localStep 83 , while globalStep is 82

2021-08-18:15:45:51,950 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:51,971 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:45:52,286 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:52,306 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:53,28 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:53,47 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:55,75 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:45:55,94 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:55,677 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:55,695 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:55,753 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:55,767 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:56,292 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:56,350 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:00,71 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:00,77 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:00,715 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:00,726 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:00,809 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:00,849 INFO     [learner.py:606] ====Pushing takes 0.038503170013427734 s
2021-08-18:15:46:00,922 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:00,936 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:00,937 INFO     [param_server.py:410] Lock worker 2 with localStep 83 , while globalStep is 82

2021-08-18:15:46:01,256 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:01,300 INFO     [learner.py:606] ====Pushing takes 0.0433046817779541 s
2021-08-18:15:46:01,346 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:01,431 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:01,432 INFO     [param_server.py:381] ====After aggregation in epoch: 82, virtual_clock: 2563.845630443325, top_1: : 58.5027 % (1813.0), top_5: : 100.0 % (3099.0), test loss: 2.3103960487577653, test len: 3099.0
2021-08-18:15:46:01,535 INFO     [param_server.py:410] Lock worker 3 with localStep 83 , while globalStep is 83

2021-08-18:15:46:01,535 INFO     [param_server.py:441] ====Epoch 84 completes 20 clients with loss 5.118291354172425, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:01,536 INFO     [param_server.py:450] ====Start to sample for epoch 84, global virtualClock: 2563.845630443325, round_duration: 37.343519273061496
2021-08-18:15:46:01,537 INFO     [oort.py:208] Training selector: Pacer 82: lastExploitationUtil 333.65593296547945, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:46:01,538 INFO     [oort.py:321] scores are 26,{5: 0.0813116118760177, 6: 0.12392911027563881, 7: 0.07286495531642334, 11: 0.0743833088620473, 14: 0.008175627826125978, 27: 0.09431545838943178, 50: 0.0226521770585413, 51: 0.040980500214279215, 53: 0.12026426118719528, 58: 0.003381145257828092, 60: 0.0015087925956219347, 67: 0.0018467393627174243, 70: 0.007209023312023396, 76: 0.001787529953205819, 79: 0.024752521223181178, 81: 0.03485912194243504, 84: 0.20132304090779038, 85: 0.00811308478818701, 87: 0.008675259106650101, 93: 0.01266887803786185, 97: 0.21102766785927116, 98: 0.4854486338107319, 105: 0.02559832110350594, 107: 0.0098051231938134, 110: 0.026926327186214332, 113: 0.4809732163124612, 119: 0.0024820290921160077},[98, 113, 97, 84, 6, 53, 27, 5, 11, 7, 51, 81, 110, 105, 79, 50, 93, 107, 87, 14, 85, 70, 58, 119, 67, 76, 60]
2021-08-18:15:46:01,539 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:46:01,539 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:01,540 INFO     [oort.py:398] At round 82, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 375.42341103082106, 'duration': 13.298442137908651, 'time_stamp': 83, 'count': 80, 'status': True, 'gradient': 21.014341881437677}, [0.36460842661187703, -3.6145013795346962e-06]), ({'reward': 1026.2778906733229, 'duration': 30.380154975061778, 'time_stamp': 83, 'count': 77, 'status': True, 'gradient': 14.980676087547742}, [0.9967302807644005, -3.6145013795346962e-06]), ({'reward': 606.0689346713342, 'duration': 15.972045438625893, 'time_stamp': 83, 'count': 80, 'status': True, 'gradient': 21.011795843936987}, [0.5886156058137518, -3.6145013795346962e-06])]
2021-08-18:15:46:01,541 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:46:02,145 INFO     [param_server.py:553] For epoch: 84, median_reward: 283.74136224859524, dev: 283.74136224859524
2021-08-18:15:46:03,821 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3097, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:46:03,885 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 1027.3849, eval_time 1.7175, test_loss 2.3097, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:46:03,936 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5331, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:46:03,967 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 1027.4656, eval_time 1.8003, test_loss 2.5331, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:46:04,10 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:04,19 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:03,930 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3438, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:46:04,39 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 1027.539, eval_time 1.8698, test_loss 2.3438, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:46:04,143 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:04,143 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:04,161 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:04,162 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:05,604 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:05,625 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:10,146 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:10,173 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:12,1 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:12,15 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:12,111 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:12,133 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:12,776 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:12,794 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:13,581 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:13,602 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:14,363 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:14,391 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:14,730 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:14,739 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:15,109 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:15,133 INFO     [learner.py:606] ====Pushing takes 0.02246403694152832 s
2021-08-18:15:46:15,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:15,172 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:15,173 INFO     [param_server.py:410] Lock worker 1 with localStep 84 , while globalStep is 83

2021-08-18:15:46:15,819 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:15,830 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:15,940 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:15,952 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:16,635 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:16,647 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:18,867 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:18,885 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:19,786 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:19,808 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:20,76 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:20,113 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:20,545 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:24,40 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:24,754 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:25,684 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:26,273 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:26,313 INFO     [learner.py:606] ====Pushing takes 0.03890562057495117 s
2021-08-18:15:46:26,382 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:26,476 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:26,477 INFO     [param_server.py:410] Lock worker 3 with localStep 84 , while globalStep is 83

2021-08-18:15:46:26,983 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:27,3 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:27,572 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:27,609 INFO     [learner.py:606] ====Pushing takes 0.0359652042388916 s
2021-08-18:15:46:27,645 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:27,654 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:27,654 INFO     [param_server.py:381] ====After aggregation in epoch: 83, virtual_clock: 2608.2122675334276, top_1: : 59.8258 % (1854.0), top_5: : 100.0 % (3099.0), test loss: 2.395546195683656, test len: 3099.0
2021-08-18:15:46:27,727 INFO     [param_server.py:410] Lock worker 2 with localStep 84 , while globalStep is 84

2021-08-18:15:46:27,728 INFO     [param_server.py:441] ====Epoch 85 completes 20 clients with loss 4.715792135760801, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:27,730 INFO     [param_server.py:450] ====Start to sample for epoch 85, global virtualClock: 2608.2122675334276, round_duration: 44.36663709010263
2021-08-18:15:46:27,731 INFO     [oort.py:208] Training selector: Pacer 83: lastExploitationUtil 297.6204489191467, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:46:27,732 INFO     [oort.py:321] scores are 26,{5: 0.06669599608361446, 6: 0.23841820422481413, 7: 0.07252948559484303, 11: 0.0139103591975657, 14: 0.008879269444065111, 27: 0.08993371678619698, 50: 0.02559006781690341, 51: 0.0533327314681452, 53: 0.3318401792470267, 58: 0.00367214609229645, 60: 0.0018053321230221068, 67: 0.002005680388499185, 70: 0.007829473378356308, 76: 0.0017723082310427058, 79: 0.003237155564320627, 81: 0.14609063690300972, 84: 0.10502714960053514, 85: 0.008075732205134823, 87: 0.07216811855608393, 93: 0.012610550615994367, 97: 0.34216182626669567, 98: 0.1913476083437457, 105: 0.03643250755098038, 107: 0.010649008568113346, 110: 0.029836727928939093, 113: 0.8053556788440442, 119: 0.002470601848321367},[113, 97, 53, 6, 98, 81, 84, 27, 7, 87, 5, 51, 105, 110, 50, 11, 93, 107, 14, 85, 70, 58, 79, 119, 67, 60, 76]
2021-08-18:15:46:27,733 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:46:27,734 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:27,734 INFO     [oort.py:398] At round 83, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 608.3034066689802, 'duration': 8.009219946401625, 'time_stamp': 84, 'count': 8, 'status': True, 'gradient': 21.022401521765506}, [0.7328262052964499, -3.5714710889415383e-06]), ({'reward': 402.36489763549423, 'duration': 17.619275735353515, 'time_stamp': 84, 'count': 80, 'status': True, 'gradient': 23.31123012711349}, [0.48472696245762115, -3.5714710889415383e-06]), ({'reward': 0.01, 'duration': 27.035726288496562, 'time_stamp': 84, 'count': 74, 'status': True, 'gradient': 19.98179430246323}, [1.204724866675991e-08, -3.5714710889415383e-06])]
2021-08-18:15:46:27,736 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:46:28,420 INFO     [param_server.py:553] For epoch: 85, median_reward: 275.61644348362296, dev: 275.61644348362296
2021-08-18:15:46:29,170 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2654, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:46:29,188 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1052.6862, eval_time 0.725, test_loss 2.2654, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:46:29,203 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.251, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:46:29,204 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1052.7049, eval_time 0.7411, test_loss 2.251, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:46:29,207 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2117, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:46:29,208 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1052.7079, eval_time 0.7442, test_loss 2.2117, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:46:29,328 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:29,328 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:29,333 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:29,342 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:29,343 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:29,349 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:30,576 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:30,586 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:31,789 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:31,798 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:32,152 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:32,164 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:32,165 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:32,174 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:32,994 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:33,13 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:33,387 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:33,401 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:34,65 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:34,79 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:34,561 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:34,593 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:34,722 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:34,745 INFO     [learner.py:606] ====Pushing takes 0.02181220054626465 s
2021-08-18:15:46:34,785 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:34,791 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:34,791 INFO     [param_server.py:410] Lock worker 1 with localStep 85 , while globalStep is 84

2021-08-18:15:46:35,598 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:35,618 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:35,706 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:35,723 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:36,324 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:36,333 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:42,683 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:43,616 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:44,97 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:44,140 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:44,190 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:44,202 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:44,769 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:44,772 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:44,781 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:44,784 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:45,418 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:45,428 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:45,441 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:45,482 INFO     [learner.py:606] ====Pushing takes 0.03911876678466797 s
2021-08-18:15:46:45,563 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:45,596 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:45,596 INFO     [param_server.py:410] Lock worker 3 with localStep 85 , while globalStep is 84

2021-08-18:15:46:46,207 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:46,247 INFO     [learner.py:606] ====Pushing takes 0.039046287536621094 s
2021-08-18:15:46:46,288 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:46,297 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:46,298 INFO     [param_server.py:381] ====After aggregation in epoch: 84, virtual_clock: 2645.5557868064893, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.2427256813755743, test len: 3099.0
2021-08-18:15:46:46,394 INFO     [param_server.py:410] Lock worker 2 with localStep 85 , while globalStep is 85

2021-08-18:15:46:46,395 INFO     [param_server.py:441] ====Epoch 86 completes 20 clients with loss 4.992724573802842, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:46,395 INFO     [param_server.py:450] ====Start to sample for epoch 86, global virtualClock: 2645.5557868064893, round_duration: 37.343519273061496
2021-08-18:15:46:46,396 INFO     [oort.py:208] Training selector: Pacer 84: lastExploitationUtil 317.1572134568891, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:46:46,396 INFO     [oort.py:321] scores are 26,{5: 0.04851168563263406, 6: 0.12790033463353864, 7: 0.072199218911489, 11: 0.012416910491485205, 14: 0.008570663801237532, 27: 0.06930450280250351, 50: 0.0030827450990261176, 51: 0.040606078645411305, 53: 0.3902425392668985, 58: 0.0035445179115650514, 60: 0.001652988180204599, 67: 0.0019359714682441328, 70: 0.007557354182047421, 76: 0.0017107103344617975, 79: 0.035118944428244474, 81: 0.018927784756137902, 84: 0.17761664752194986, 85: 0.01605556526112093, 87: 0.008595996918339484, 93: 0.04667150760151876, 97: 0.2699641584034349, 98: 0.48514740169517595, 105: 0.03331204348844193, 107: 0.010278894319937715, 110: 0.05013337080460113, 113: 0.36257724370382716, 119: 0.022048151635636483},[98, 53, 113, 97, 84, 6, 7, 27, 110, 5, 93, 51, 79, 105, 119, 81, 85, 11, 107, 87, 14, 70, 58, 50, 67, 76, 60]
2021-08-18:15:46:46,398 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:46:46,398 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:46,399 INFO     [oort.py:398] At round 84, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 180.9831857580904, 'duration': 21.635252629006885, 'time_stamp': 85, 'count': 36, 'status': True, 'gradient': 21.650999106928516}, [0.19623161159629518, -3.5294532876857404e-06]), ({'reward': 0.01, 'duration': 21.753601635627824, 'time_stamp': 85, 'count': 77, 'status': True, 'gradient': 21.23533898734399}, [1.0843131258984503e-08, -3.5294532876857404e-06]), ({'reward': 922.2528146189217, 'duration': 13.411352670399307, 'time_stamp': 85, 'count': 82, 'status': True, 'gradient': 18.11751383063193}, [1.0, -3.5294532876857404e-06])]
2021-08-18:15:46:46,400 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 105, 119, 107]
2021-08-18:15:46:46,919 INFO     [param_server.py:553] For epoch: 86, median_reward: 279.8494254141043, dev: 279.8494254141043
2021-08-18:15:46:47,643 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3318, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:46:47,644 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1071.1439, eval_time 0.7017, test_loss 2.3318, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:46:47,657 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2647, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:46:47,671 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1706, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:46:47,672 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1071.1706, eval_time 0.7304, test_loss 2.2647, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:46:47,672 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1071.1729, eval_time 0.7306, test_loss 2.1706, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:46:47,722 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:46:47,730 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:47,761 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:46:47,775 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:47,955 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:46:48,0 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:49,524 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:49,534 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:50,811 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:50,826 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:50,949 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:50,964 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:51,420 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:51,447 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:52,166 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:52,188 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:53,85 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:53,113 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:53,415 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:53,424 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:54,15 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:54,49 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:54,709 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:54,727 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:54,779 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:54,797 INFO     [learner.py:606] ====Pushing takes 0.01606297492980957 s
2021-08-18:15:46:54,822 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:54,828 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:54,829 INFO     [param_server.py:410] Lock worker 1 with localStep 86 , while globalStep is 85

2021-08-18:15:46:55,301 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:55,311 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:55,656 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:55,675 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:58,295 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:58,386 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:58,709 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:58,728 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:59,24 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:59,37 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:59,722 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:59,732 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:59,865 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:59,876 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:47:00,395 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:47:00,335 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:47:03,997 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:47:04,60 INFO     [learner.py:606] ====Pushing takes 0.0706942081451416 s
2021-08-18:15:47:04,145 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:04,171 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:47:04,172 INFO     [param_server.py:410] Lock worker 3 with localStep 86 , while globalStep is 85

2021-08-18:15:47:04,646 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:47:04,714 INFO     [learner.py:606] ====Pushing takes 0.03763008117675781 s
2021-08-18:15:47:04,792 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:04,820 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:47:04,822 INFO     [param_server.py:381] ====After aggregation in epoch: 85, virtual_clock: 2689.922423896592, top_1: : 59.7612 % (1852.0), top_5: : 100.0 % (3099.0), test loss: 2.2556808083145707, test len: 3099.0
2021-08-18:15:47:04,828 INFO     [param_server.py:410] Lock worker 2 with localStep 86 , while globalStep is 86

2021-08-18:15:47:04,829 INFO     [param_server.py:441] ====Epoch 87 completes 20 clients with loss 4.502822864872871, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:47:04,830 INFO     [param_server.py:450] ====Start to sample for epoch 87, global virtualClock: 2689.922423896592, round_duration: 44.36663709010263
2021-08-18:15:47:04,831 INFO     [oort.py:208] Training selector: Pacer 85: lastExploitationUtil 294.8777902852639, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:47:04,832 INFO     [oort.py:321] scores are 26,{5: 0.05343444559565554, 6: 0.0412793307801686, 7: 0.07187402416528821, 11: 0.06098719346552722, 14: 0.009067643639643429, 27: 0.04050102147548606, 50: 0.0030868593411612117, 51: 0.04042318354435083, 53: 0.13780102270242275, 58: 0.003750050876078494, 60: 0.0016734119842775634, 67: 0.0020482310096004825, 70: 0.007995576091956865, 76: 0.0018099078488313797, 79: 0.0339424000544796, 81: 0.018842531532450517, 84: 0.38808076508493455, 85: 0.035836163908591415, 87: 0.0739809054620374, 93: 0.012496586902251706, 97: 0.3419527186968047, 98: 0.29263405726008934, 105: 0.028249548277504567, 107: 0.012808263593663738, 110: 0.025421600708519242, 113: 0.9392503584846948, 119: 0.007500278234496095},[113, 84, 97, 98, 53, 87, 7, 11, 5, 6, 27, 51, 85, 79, 105, 110, 81, 107, 93, 14, 70, 119, 58, 50, 67, 76, 60]
2021-08-18:15:47:04,833 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:47:04,834 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:47:04,835 INFO     [oort.py:398] At round 85, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 800.5430653238486, 'duration': 15.972045438625893, 'time_stamp': 86, 'count': 83, 'status': True, 'gradient': 21.04295128626376}, [1.0, -3.4884126559611187e-06]), ({'reward': 134.1871284994366, 'duration': 27.689063957948644, 'time_stamp': 86, 'count': 79, 'status': True, 'gradient': 20.518622212499118}, [0.16760973735551954, -3.4884126559611187e-06]), ({'reward': 617.5591482111997, 'duration': 13.298442137908651, 'time_stamp': 86, 'count': 83, 'status': True, 'gradient': 21.042833375599958}, [0.7714224149469098, -3.4884126559611187e-06])]
2021-08-18:15:47:04,839 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 105, 119, 107]
2021-08-18:15:47:05,306 INFO     [param_server.py:553] For epoch: 87, median_reward: 272.24180502525337, dev: 272.24180502525337
2021-08-18:15:47:06,92 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6529, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:47:06,93 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1089.5933, eval_time 0.7415, test_loss 2.6529, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:47:06,125 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4328, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:47:06,125 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1089.6257, eval_time 0.7733, test_loss 2.4328, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:47:06,160 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:47:06,180 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:47:06,186 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5211, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:47:13,433 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1096.9319, eval_time 8.0827, test_loss 2.5211, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:47:13,467 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:47:13,492 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:47:13,630 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:47:13,677 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:47:14,794 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:47:22,70 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:47:22,860 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:47:22,871 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:47:28,775 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:47:28,662 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:47:28,834 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:47:28,886 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:47:29,232 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:47:29,251 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:47:30,10 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:47:30,29 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:47:30,662 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:47:37,353 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:47:37,448 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:47:37,613 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:47:37,615 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:47:37,616 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:47:37,949 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:47:37,976 INFO     [learner.py:606] ====Pushing takes 0.0220034122467041 s
2021-08-18:15:47:38,155 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:47:38,165 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:47:38,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:38,189 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:47:38,190 INFO     [param_server.py:410] Lock worker 1 with localStep 87 , while globalStep is 86

2021-08-18:15:47:38,825 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:47:38,834 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:47:40,66 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:47:40,87 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:47:40,696 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:47:40,715 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:47:40,732 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:47:40,746 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:47:49,109 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:47:49,210 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:47:49,224 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:47:49,206 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:47:49,831 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:47:49,869 INFO     [learner.py:606] ====Pushing takes 0.03710174560546875 s
2021-08-18:15:47:49,891 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:47:49,902 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:47:49,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:49,946 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:47:49,948 INFO     [param_server.py:410] Lock worker 2 with localStep 87 , while globalStep is 86

2021-08-18:15:47:50,526 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:47:50,568 INFO     [learner.py:606] ====Pushing takes 0.04044628143310547 s
2021-08-18:15:47:50,608 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:50,618 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:47:50,618 INFO     [param_server.py:381] ====After aggregation in epoch: 86, virtual_clock: 2720.640057931365, top_1: : 57.9219 % (1795.0), top_5: : 100.0 % (3099.0), test loss: 2.535591995274579, test len: 3099.0
2021-08-18:15:47:50,666 INFO     [param_server.py:410] Lock worker 3 with localStep 87 , while globalStep is 87

2021-08-18:15:47:50,666 INFO     [param_server.py:441] ====Epoch 88 completes 20 clients with loss 6.25714565057525, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:47:50,667 INFO     [param_server.py:450] ====Start to sample for epoch 88, global virtualClock: 2720.640057931365, round_duration: 30.717634034772722
2021-08-18:15:47:50,668 INFO     [oort.py:208] Training selector: Pacer 86: lastExploitationUtil 292.8952928809232, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:47:50,669 INFO     [oort.py:321] scores are 26,{5: 0.05565900201077925, 6: 0.10093415443435465, 7: 0.07155376137711333, 11: 0.05939923715389178, 14: 0.007149150613281406, 27: 0.03291902545001871, 50: 0.0030909198806655033, 51: 0.16003053301172457, 53: 0.2551446995331257, 58: 0.0029566312468811678, 60: 0.0013193586767532963, 67: 0.001614875105414167, 70: 0.0063039065046009415, 76: 0.001426975333579001, 79: 0.032878788604646374, 81: 0.10438150381843352, 84: 0.13919408938547778, 85: 0.050855781494134354, 87: 0.008519149120536931, 93: 0.012440903478226623, 97: 0.3418505484089218, 98: 0.2518843367552703, 105: 0.022331527094434114, 107: 0.004442719386501057, 110: 0.007595551507339946, 112: 0.31114015242777554, 113: 0.07155376137711333, 119: 0.006612911169664911},[97, 112, 53, 98, 51, 84, 81, 6, 7, 113, 11, 5, 85, 27, 79, 105, 93, 87, 110, 14, 119, 70, 107, 50, 58, 67, 76, 60]
2021-08-18:15:47:50,692 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:47:50,693 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:47:50,694 INFO     [oort.py:398] At round 86, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1063.0327904795745, 'duration': 15.972045438625893, 'time_stamp': 87, 'count': 84, 'status': True, 'gradient': 21.051830711217026}, [1.0, -3.448315497879289e-06]), ({'reward': 0.01, 'duration': 43.65853298740619, 'time_stamp': 85, 'count': 67, 'status': True, 'gradient': 8.329608304297176}, [9.407135948060729e-09, 0.0068931826802606936]), ({'reward': 110.7652896618508, 'duration': 11.90395711384456, 'time_stamp': 87, 'count': 85, 'status': True, 'gradient': 20.944299285746286}, [0.10418901608872774, -3.448315497879289e-06])]
2021-08-18:15:47:50,694 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:47:51,351 INFO     [param_server.py:553] For epoch: 88, median_reward: 271.8122622688983, dev: 271.8122622688983
2021-08-18:15:47:52,4 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4152, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:47:52,5 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1135.5056, eval_time 0.61, test_loss 2.4152, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:47:52,43 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5128, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:47:52,44 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1135.5446, eval_time 0.6491, test_loss 2.5128, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:47:52,79 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:47:52,95 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:47:52,102 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7693, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:47:52,106 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1135.605, eval_time 0.7115, test_loss 2.7693, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:47:52,149 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:47:52,165 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:47:52,312 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:47:52,342 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:47:53,334 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:47:53,348 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:48:06,981 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:48:07,33 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:48:07,592 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:48:07,727 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:48:08,322 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:48:08,362 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:48:08,375 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:48:08,381 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:48:14,489 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:48:14,517 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:48:15,75 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:48:15,90 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:48:15,101 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:48:15,114 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:48:15,118 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:48:15,128 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:48:15,171 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:48:15,187 INFO     [learner.py:606] ====Pushing takes 0.015242576599121094 s
2021-08-18:15:48:15,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:48:15,408 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:48:15,408 INFO     [param_server.py:410] Lock worker 1 with localStep 88 , while globalStep is 87

2021-08-18:15:48:15,852 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:48:15,861 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:48:16,408 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:48:24,367 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:48:25,427 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:48:25,449 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:48:25,960 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:48:25,997 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:48:26,117 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:48:26,138 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:48:26,606 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:48:26,615 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:48:27,241 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:48:27,267 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:48:27,940 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:48:27,988 INFO     [learner.py:606] ====Pushing takes 0.04603838920593262 s
2021-08-18:15:48:28,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:48:28,44 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:48:28,56 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:48:28,54 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:48:28,61 INFO     [param_server.py:410] Lock worker 3 with localStep 88 , while globalStep is 87

2021-08-18:15:48:28,640 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:48:28,676 INFO     [learner.py:606] ====Pushing takes 0.03461885452270508 s
2021-08-18:15:48:28,710 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:48:28,719 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:48:28,720 INFO     [param_server.py:381] ====After aggregation in epoch: 87, virtual_clock: 2753.7242958297725, top_1: : 60.3098 % (1869.0), top_5: : 100.0 % (3099.0), test loss: 2.565781509434735, test len: 3099.0
2021-08-18:15:48:28,802 INFO     [param_server.py:410] Lock worker 2 with localStep 88 , while globalStep is 88

2021-08-18:15:48:28,803 INFO     [param_server.py:441] ====Epoch 89 completes 20 clients with loss 5.528309427393375, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:48:28,803 INFO     [param_server.py:450] ====Start to sample for epoch 89, global virtualClock: 2753.7242958297725, round_duration: 33.08423789840745
2021-08-18:15:48:28,804 INFO     [oort.py:208] Training selector: Pacer 87: lastExploitationUtil 373.4640326358296, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:48:28,806 INFO     [oort.py:321] scores are 26,{5: 0.029288247939847408, 6: 0.26551468541833806, 7: 0.07123830912985006, 11: 0.015328163246655084, 14: 0.007397265793299421, 27: 0.031151162598706945, 50: 0.018179700509822712, 51: 0.04869645252750296, 53: 0.25793315943255546, 58: 0.003059242750505666, 60: 0.0011306060330473814, 67: 0.0016709202286966573, 70: 0.006522687025786226, 76: 0.0012228266274978189, 79: 0.018758618445031402, 81: 0.11780443658756613, 84: 0.2592933094703366, 85: 0.03770619430777792, 87: 0.04697462435125804, 93: 0.03103249185938453, 97: 0.34174991235320246, 98: 0.33077152385560094, 105: 0.020296031362419073, 107: 0.008871624778332345, 110: 0.007562065723419149, 113: 0.22328680053232963, 119: 0.0024266199706786625},[97, 98, 6, 84, 53, 113, 81, 7, 51, 87, 85, 27, 93, 5, 105, 79, 50, 11, 107, 110, 14, 70, 58, 119, 67, 76, 60]
2021-08-18:15:48:28,807 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:48:28,807 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:48:28,808 INFO     [oort.py:398] At round 87, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 365.8790407436936, 'duration': 30.380154975061778, 'time_stamp': 88, 'count': 82, 'status': True, 'gradient': 13.345451487696526}, [0.28203501538581555, -3.409129649200562e-06]), ({'reward': 373.4655264919601, 'duration': 66.93898235209988, 'time_stamp': 88, 'count': 52, 'status': True, 'gradient': 18.19758762286316}, [0.2878831586501539, -3.409129649200562e-06]), ({'reward': 855.9111262638631, 'duration': 13.411352670399307, 'time_stamp': 88, 'count': 85, 'status': True, 'gradient': 18.14155439684881}, [0.659782754633767, -3.409129649200562e-06])]
2021-08-18:15:48:28,809 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:48:29,174 INFO     [param_server.py:553] For epoch: 89, median_reward: 291.03821307446736, dev: 291.03821307446736
2021-08-18:15:48:29,758 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3649, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:48:29,762 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1173.2607, eval_time 0.5538, test_loss 2.3649, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:48:29,845 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:48:29,851 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3234, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:48:29,851 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2574, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:48:29,852 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1173.3526, eval_time 0.6412, test_loss 2.3234, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:48:29,852 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1173.3527, eval_time 0.6421, test_loss 2.2574, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:48:29,866 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:48:29,931 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:48:29,936 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:48:29,940 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:48:29,945 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:48:53,726 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:48:53,749 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:48:54,816 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:48:54,827 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:48:55,162 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:48:55,242 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:49:18,485 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:49:18,493 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:49:19,422 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:49:19,450 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:49:19,694 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:49:19,714 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:49:20,334 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:49:20,355 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:49:20,675 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:49:20,692 INFO     [learner.py:606] ====Pushing takes 0.015658855438232422 s
2021-08-18:15:49:20,717 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:49:20,731 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:49:20,732 INFO     [param_server.py:410] Lock worker 1 with localStep 89 , while globalStep is 88

2021-08-18:15:49:20,811 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:49:20,821 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:49:21,770 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:49:21,789 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:49:22,24 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:49:22,38 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:49:22,675 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:49:22,685 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:49:24,722 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:49:24,736 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:49:24,809 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:49:24,821 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:49:25,415 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:49:25,416 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:49:25,426 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:49:25,426 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:49:26,435 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:49:26,454 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:50:06,285 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:50:06,285 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:50:06,830 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:50:06,881 INFO     [learner.py:606] ====Pushing takes 0.038083553314208984 s
2021-08-18:15:50:06,899 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:50:06,937 INFO     [learner.py:606] ====Pushing takes 0.03323841094970703 s
2021-08-18:15:50:06,945 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:06,958 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:50:06,959 INFO     [param_server.py:410] Lock worker 3 with localStep 89 , while globalStep is 88

2021-08-18:15:50:06,997 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:07,6 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:50:07,6 INFO     [param_server.py:381] ====After aggregation in epoch: 88, virtual_clock: 2792.1203173885583, top_1: : 59.8258 % (1854.0), top_5: : 100.0 % (3099.0), test loss: 2.3152068632620355, test len: 3099.0
2021-08-18:15:50:07,19 INFO     [param_server.py:410] Lock worker 2 with localStep 89 , while globalStep is 89

2021-08-18:15:50:07,19 INFO     [param_server.py:441] ====Epoch 90 completes 20 clients with loss 5.455969026371704, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:50:07,41 INFO     [param_server.py:450] ====Start to sample for epoch 90, global virtualClock: 2792.1203173885583, round_duration: 38.39602155878561
2021-08-18:15:50:07,43 INFO     [oort.py:208] Training selector: Pacer 88: lastExploitationUtil 351.6839389209916, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:50:07,44 INFO     [oort.py:321] scores are 26,{5: 0.02589225804529306, 6: 0.04073574181460137, 7: 0.1693877656097018, 11: 0.04805408292203094, 14: 0.008925768387011564, 27: 0.06879812691985902, 50: 0.0030284475719569047, 51: 0.07971444591382981, 53: 0.047201105924022026, 58: 0.003691376380634063, 60: 0.0016472292451380811, 67: 0.0021224828555678095, 70: 0.007870474751072202, 76: 0.0017815894517374856, 79: 0.02903752802139402, 81: 0.25140560076707025, 84: 0.34187738741525686, 85: 0.06205198537759284, 87: 0.06557944962514389, 93: 0.1159868709146152, 97: 0.3416507713192991, 98: 0.10454482792532682, 105: 0.04120658127949564, 107: 0.01070477527785949, 110: 0.007529077848401284, 113: 0.11070855303405605, 119: 0.0075246432870897904},[84, 97, 81, 7, 93, 113, 98, 51, 27, 87, 85, 11, 53, 105, 6, 79, 5, 107, 14, 70, 110, 119, 58, 50, 67, 76, 60]
2021-08-18:15:50:07,45 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:50:07,47 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:50:07,47 INFO     [oort.py:398] At round 88, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 652.0943271179297, 'duration': 13.298442137908651, 'time_stamp': 89, 'count': 86, 'status': True, 'gradient': 21.06809089414277}, [0.6719693160301738, -3.370824391285298e-06]), ({'reward': 95.55657419017966, 'duration': 5.8943907365129, 'time_stamp': 89, 'count': 86, 'status': True, 'gradient': 21.272994663911263}, [0.09846022848986644, -3.370824391285298e-06]), ({'reward': 970.4178963762619, 'duration': 15.972045438625893, 'time_stamp': 89, 'count': 86, 'status': True, 'gradient': 21.065624753311535}, [1.0, -3.370824391285298e-06])]
2021-08-18:15:50:07,48 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:50:07,452 INFO     [param_server.py:553] For epoch: 90, median_reward: 287.6619806222179, dev: 287.6619806222179
2021-08-18:15:50:08,55 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4165, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:50:08,56 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1271.5569, eval_time 0.58, test_loss 2.4165, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:50:08,139 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:50:08,147 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5626, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:50:08,148 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1271.6486, eval_time 0.6721, test_loss 2.5626, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:50:08,149 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:50:08,213 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4532, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:50:08,216 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1271.715, eval_time 0.7406, test_loss 2.4532, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:50:08,249 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:50:08,269 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:50:08,292 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:50:08,323 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:50:10,100 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:50:10,112 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:50:10,816 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:50:10,827 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:50:11,304 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:50:11,316 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:50:11,651 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:50:11,673 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:50:12,462 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:50:12,472 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:50:13,292 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:50:13,313 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:50:13,394 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:50:13,421 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:50:14,253 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:50:14,280 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:50:14,585 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:50:14,604 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:50:14,940 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:50:14,956 INFO     [learner.py:606] ====Pushing takes 0.013842582702636719 s
2021-08-18:15:50:14,979 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:14,985 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:50:14,986 INFO     [param_server.py:410] Lock worker 1 with localStep 90 , while globalStep is 89

2021-08-18:15:50:15,105 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:50:15,121 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:50:15,332 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:50:15,345 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:50:17,959 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:50:17,969 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:50:18,526 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:50:18,553 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:50:18,665 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:50:18,679 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:50:19,387 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:50:19,404 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:50:19,713 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:50:19,728 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:50:19,958 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:50:20,7 INFO     [learner.py:606] ====Pushing takes 0.04705929756164551 s
2021-08-18:15:50:20,72 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:20,82 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:50:20,83 INFO     [param_server.py:410] Lock worker 3 with localStep 90 , while globalStep is 89

2021-08-18:15:50:22,76 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:50:22,86 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:50:22,703 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:50:22,759 INFO     [learner.py:606] ====Pushing takes 0.04352259635925293 s
2021-08-18:15:50:22,802 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:22,830 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:50:22,831 INFO     [param_server.py:381] ====After aggregation in epoch: 89, virtual_clock: 2836.486954478661, top_1: : 59.019 % (1829.0), top_5: : 100.0 % (3099.0), test loss: 2.4774320037276656, test len: 3099.0
2021-08-18:15:50:22,841 INFO     [param_server.py:410] Lock worker 2 with localStep 90 , while globalStep is 90

2021-08-18:15:50:22,842 INFO     [param_server.py:441] ====Epoch 91 completes 20 clients with loss 5.195484682665524, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:50:22,842 INFO     [param_server.py:450] ====Start to sample for epoch 91, global virtualClock: 2836.486954478661, round_duration: 44.36663709010263
2021-08-18:15:50:22,843 INFO     [oort.py:208] Training selector: Pacer 89: lastExploitationUtil 357.1747685853509, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:50:22,844 INFO     [oort.py:321] scores are 26,{5: 0.023875679536355655, 6: 0.10104517476821497, 7: 0.18578529987170944, 11: 0.012145546313183559, 14: 0.006929200357671317, 27: 0.0433580307002785, 50: 0.01740972298351064, 51: 0.03971865699787505, 53: 0.12001451013669025, 58: 0.0028656677417497798, 60: 0.0012787673822218638, 67: 0.0015651919736090608, 70: 0.006109960968686059, 76: 0.0013679009733408112, 79: 0.01984939398239128, 81: 0.01851412930126916, 84: 0.13894040539361796, 85: 0.046591904478655743, 87: 0.03665228375074805, 93: 0.07944956274743936, 97: 0.20394482944601866, 98: 0.0804055770385442, 105: 0.04535879080108231, 107: 0.008310268591785604, 110: 0.007496574268448196, 113: 0.7845596317813455, 119: 0.0049516538882549465},[113, 97, 7, 84, 53, 6, 98, 93, 85, 105, 27, 51, 87, 5, 79, 81, 50, 11, 107, 110, 14, 70, 119, 58, 67, 76, 60]
2021-08-18:15:50:22,845 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:50:22,845 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:50:22,846 INFO     [oort.py:398] At round 89, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 959.4422655923563, 'duration': 8.009219946401625, 'time_stamp': 90, 'count': 14, 'status': True, 'gradient': 21.077225780780807}, [0.7139382912096258, -3.3333703707819004e-06]), ({'reward': 154.77409342161084, 'duration': 5.8943907365129, 'time_stamp': 90, 'count': 87, 'status': True, 'gradient': 21.286538446988754}, [0.11516395929998974, -3.3333703707819004e-06]), ({'reward': 141.53812227100906, 'duration': 11.90395711384456, 'time_stamp': 90, 'count': 88, 'status': True, 'gradient': 20.973398768977667}, [0.10531473193276751, -3.3333703707819004e-06])]
2021-08-18:15:50:22,847 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:50:23,242 INFO     [param_server.py:553] For epoch: 91, median_reward: 288.6701630006836, dev: 288.6701630006836
2021-08-18:15:50:23,923 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5314, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:50:23,924 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1287.4248, eval_time 0.6596, test_loss 2.5314, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:50:23,931 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9091, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:50:23,938 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1287.4387, eval_time 0.6711, test_loss 2.9091, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:50:24,16 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7491, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:50:24,26 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1287.5241, eval_time 0.7609, test_loss 2.7491, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:50:24,58 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:50:24,66 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:50:24,67 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:50:24,74 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:50:24,139 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:50:24,161 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:50:25,312 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:50:55,865 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:50:57,1 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:50:57,21 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:50:57,318 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:50:57,332 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:50:57,920 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:50:57,954 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:50:58,333 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:50:58,360 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:50:59,273 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:50:59,317 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:50:59,591 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:50:59,611 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:50:59,993 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:51:00,27 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:51:00,681 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:51:00,691 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:51:00,718 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:51:00,732 INFO     [learner.py:606] ====Pushing takes 0.01332998275756836 s
2021-08-18:15:51:00,756 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:00,775 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:51:00,775 INFO     [param_server.py:410] Lock worker 1 with localStep 91 , while globalStep is 90

2021-08-18:15:51:01,29 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:51:01,50 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:51:01,248 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:51:01,266 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:51:03,583 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:51:03,594 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:51:03,672 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:51:03,681 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:51:04,333 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:51:04,342 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:51:04,347 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:51:04,356 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:51:04,902 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:51:04,915 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:51:04,948 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:51:04,959 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:51:05,492 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:51:05,532 INFO     [learner.py:606] ====Pushing takes 0.039014577865600586 s
2021-08-18:15:51:05,571 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:05,580 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:51:05,581 INFO     [param_server.py:410] Lock worker 3 with localStep 91 , while globalStep is 90

2021-08-18:15:51:05,652 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:51:05,682 INFO     [learner.py:606] ====Pushing takes 0.028791189193725586 s
2021-08-18:15:51:05,721 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:05,731 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:51:05,732 INFO     [param_server.py:381] ====After aggregation in epoch: 90, virtual_clock: 2874.882976037447, top_1: : 58.9545 % (1827.0), top_5: : 100.0 % (3099.0), test loss: 2.7299041438985756, test len: 3099.0
2021-08-18:15:51:05,738 INFO     [param_server.py:410] Lock worker 2 with localStep 91 , while globalStep is 91

2021-08-18:15:51:05,739 INFO     [param_server.py:441] ====Epoch 92 completes 20 clients with loss 5.90259759646495, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:51:05,739 INFO     [param_server.py:450] ====Start to sample for epoch 92, global virtualClock: 2874.882976037447, round_duration: 38.39602155878561
2021-08-18:15:51:05,740 INFO     [oort.py:208] Training selector: Pacer 90: lastExploitationUtil 469.3223139541648, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:51:05,741 INFO     [oort.py:321] scores are 26,{5: 0.07929066574638405, 6: 0.056807481258442, 7: 0.2204842915945256, 11: 0.03252677421316537, 14: 0.00906741512393376, 27: 0.060409766789582625, 50: 0.0030024898066962464, 51: 0.31834578767195115, 53: 0.22347640433388496, 58: 0.0030003253710979543, 60: 0.0016733698122489362, 67: 0.0020481793916740042, 70: 0.007995374593660563, 76: 0.001809862236940028, 79: 0.030180584061344246, 81: 0.018435024294288293, 84: 0.17008755869119227, 85: 0.07803172188820022, 87: 0.07570710679074301, 93: 0.032492370633305574, 97: 0.3414568244505907, 98: 0.2904627100534706, 105: 0.022151042974117546, 107: 0.010874653816249602, 110: 0.007464543782423798, 113: 0.18881924123902594, 119: 0.022223983696854344},[97, 51, 98, 53, 7, 113, 84, 5, 85, 87, 27, 6, 11, 93, 79, 119, 105, 81, 107, 14, 70, 110, 50, 58, 67, 76, 60]
2021-08-18:15:51:05,742 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:51:05,742 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:51:05,743 INFO     [oort.py:398] At round 90, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1268.8241856389232, 'duration': 15.972045438625893, 'time_stamp': 91, 'count': 88, 'status': True, 'gradient': 21.086122945899543}, [1.0, -3.2967395246101635e-06]), ({'reward': 780.0316118020332, 'duration': 30.380154975061778, 'time_stamp': 91, 'count': 85, 'status': True, 'gradient': 16.703758242801413}, [0.6147642613733889, -3.2967395246101635e-06]), ({'reward': 336.8687848830099, 'duration': 11.058674649423494, 'time_stamp': 91, 'count': 88, 'status': True, 'gradient': 20.35688211319336}, [0.2654910356779083, -3.2967395246101635e-06])]
2021-08-18:15:51:05,744 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:51:06,178 INFO     [param_server.py:553] For epoch: 92, median_reward: 313.014648376739, dev: 313.014648376739
2021-08-18:15:51:06,776 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5251, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:51:06,777 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1330.2774, eval_time 0.5644, test_loss 2.5251, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:51:06,831 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4292, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:51:06,832 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1330.3321, eval_time 0.6192, test_loss 2.4292, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:51:06,866 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:51:06,887 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:51:06,900 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9724, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:51:06,900 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1330.3991, eval_time 0.6887, test_loss 2.9724, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:51:06,927 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:51:06,940 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:51:06,980 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:51:07,2 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:51:08,629 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:51:08,639 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:51:09,764 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:51:09,773 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:51:09,896 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:51:09,906 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:51:10,370 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:51:10,396 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:51:11,45 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:51:11,57 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:51:11,978 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:51:12,12 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:51:12,290 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:51:12,308 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:51:12,909 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:51:12,996 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:51:13,468 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:51:13,482 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:51:13,622 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:51:13,637 INFO     [learner.py:606] ====Pushing takes 0.013265371322631836 s
2021-08-18:15:51:13,658 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:13,663 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:51:13,663 INFO     [param_server.py:410] Lock worker 1 with localStep 92 , while globalStep is 91

2021-08-18:15:51:13,942 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:51:13,962 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:51:14,207 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:51:14,221 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:51:16,880 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:51:16,891 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:51:17,17 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:51:17,31 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:51:17,536 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:51:17,546 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:51:18,111 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:51:18,131 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:51:18,252 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:51:18,272 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:51:18,677 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:51:18,732 INFO     [learner.py:606] ====Pushing takes 0.0541386604309082 s
2021-08-18:15:51:18,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:18,791 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:51:18,791 INFO     [param_server.py:410] Lock worker 3 with localStep 92 , while globalStep is 91

2021-08-18:15:51:20,846 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:51:20,860 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:51:21,400 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:51:21,432 INFO     [learner.py:606] ====Pushing takes 0.030300617218017578 s
2021-08-18:15:51:21,487 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:21,497 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:51:21,498 INFO     [param_server.py:381] ====After aggregation in epoch: 91, virtual_clock: 2919.2496131275498, top_1: : 60.0516 % (1861.0), top_5: : 100.0 % (3099.0), test loss: 2.6422281221107204, test len: 3099.0
2021-08-18:15:51:21,501 INFO     [param_server.py:410] Lock worker 2 with localStep 92 , while globalStep is 92

2021-08-18:15:51:21,501 INFO     [param_server.py:441] ====Epoch 93 completes 20 clients with loss 4.291855044982606, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:51:21,502 INFO     [param_server.py:450] ====Start to sample for epoch 93, global virtualClock: 2919.2496131275498, round_duration: 44.36663709010263
2021-08-18:15:51:21,503 INFO     [oort.py:208] Training selector: Pacer 91: lastExploitationUtil 300.6825072003476, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:51:21,503 INFO     [oort.py:321] scores are 26,{5: 0.07645162869763329, 6: 0.08051307115434982, 7: 0.09434576822237009, 11: 0.07725582438564793, 14: 0.007703524717951264, 27: 0.03178138296416257, 50: 0.01367919416826384, 51: 0.03938169022848796, 53: 0.36148883662806314, 58: 0.003185900413106825, 60: 0.0014216670941763002, 67: 0.0017400990640554174, 70: 0.0067927369564196914, 76: 0.002240153581436716, 79: 0.0031252500622648296, 81: 0.1111312577892359, 84: 0.10041271447918697, 85: 0.03127977905777886, 87: 0.03268373221579493, 93: 0.012174615434677537, 97: 0.07386397421535819, 98: 0.2976660073692365, 105: 0.04533340703665802, 107: 0.009238924580779328, 110: 0.007432974524558452, 113: 0.7526400848934846, 119: 0.019107441102826063},[113, 53, 98, 81, 84, 7, 6, 11, 5, 97, 105, 51, 87, 27, 85, 119, 50, 93, 107, 14, 110, 70, 58, 79, 76, 67, 60]
2021-08-18:15:51:21,504 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:51:21,505 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:51:21,505 INFO     [oort.py:398] At round 91, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 159.76931032257403, 'duration': 15.972045438625893, 'time_stamp': 92, 'count': 89, 'status': True, 'gradient': 21.09557888252273}, [0.1615094441308808, -3.260905009837066e-06]), ({'reward': 468.0578144173088, 'duration': 11.058674649423494, 'time_stamp': 92, 'count': 89, 'status': True, 'gradient': 20.36745533789144}, [0.47317517247615737, -3.260905009837066e-06]), ({'reward': 675.2309982698678, 'duration': 8.009219946401625, 'time_stamp': 92, 'count': 16, 'status': True, 'gradient': 21.097436639394502}, [0.6826178872754617, -3.260905009837066e-06])]
2021-08-18:15:51:21,506 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:51:21,863 INFO     [param_server.py:553] For epoch: 93, median_reward: 277.41044951945224, dev: 277.41044951945224
2021-08-18:15:51:22,471 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1824, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:51:22,472 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1345.9728, eval_time 0.5737, test_loss 2.1824, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:51:22,475 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4911, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:51:22,476 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1345.9766, eval_time 0.5776, test_loss 2.4911, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:51:22,580 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:51:22,587 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4582, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:51:22,589 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:51:22,589 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1346.0876, eval_time 0.6925, test_loss 2.4582, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:51:22,591 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:51:22,600 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:51:22,657 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:51:22,682 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:51:23,843 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:51:23,857 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:51:25,29 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:51:25,47 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:51:25,371 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:51:25,385 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:51:26,140 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:51:26,154 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:51:26,296 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:51:26,316 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:51:27,548 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:51:27,557 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:51:27,733 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:02,209 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:02,800 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:02,824 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:03,257 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:03,284 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:03,441 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:03,456 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:03,550 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:03,567 INFO     [learner.py:606] ====Pushing takes 0.015115499496459961 s
2021-08-18:15:52:03,594 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:03,603 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:03,603 INFO     [param_server.py:410] Lock worker 1 with localStep 93 , while globalStep is 92

2021-08-18:15:52:04,91 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:04,103 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:06,101 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:06,110 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:06,379 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:06,390 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:06,622 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:06,631 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:07,9 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:07,19 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:07,236 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:52:07,246 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:52:07,698 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:07,709 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:07,904 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:52:07,938 INFO     [learner.py:606] ====Pushing takes 0.03252148628234863 s
2021-08-18:15:52:07,984 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:07,993 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:07,998 INFO     [param_server.py:410] Lock worker 2 with localStep 93 , while globalStep is 92

2021-08-18:15:52:08,296 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:08,346 INFO     [learner.py:606] ====Pushing takes 0.04752516746520996 s
2021-08-18:15:52:08,382 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:08,390 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:52:08,391 INFO     [param_server.py:381] ====After aggregation in epoch: 92, virtual_clock: 2956.5931324006115, top_1: : 58.3737 % (1809.0), top_5: : 100.0 % (3099.0), test loss: 2.3772023022174835, test len: 3099.0
2021-08-18:15:52:08,395 INFO     [param_server.py:410] Lock worker 3 with localStep 93 , while globalStep is 93

2021-08-18:15:52:08,395 INFO     [param_server.py:441] ====Epoch 94 completes 20 clients with loss 5.641451272240976, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:52:08,396 INFO     [param_server.py:450] ====Start to sample for epoch 94, global virtualClock: 2956.5931324006115, round_duration: 37.343519273061496
2021-08-18:15:52:08,397 INFO     [oort.py:208] Training selector: Pacer 92: lastExploitationUtil 354.55001112296605, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:52:08,397 INFO     [oort.py:321] scores are 26,{5: 0.03679849295511182, 6: 0.17949654535348505, 7: 0.06972904541494063, 11: 0.09259688328505539, 14: 0.008192579771055003, 27: 0.04206485177943393, 50: 0.018352686741750487, 51: 0.09347911311040026, 53: 0.1041298361604157, 58: 0.003884951525332878, 60: 0.001733609664418153, 67: 0.0021219120614445067, 70: 0.008283201098019645, 76: 0.0018750156972223008, 79: 0.015457098067088625, 81: 0.037499483834107825, 84: 0.17359928920799345, 85: 0.011626534654001342, 87: 0.03239211987248276, 93: 0.012123643913898101, 97: 0.28134806877082746, 98: 0.48402970055307537, 105: 0.032407127759333014, 107: 0.01126613185863276, 110: 0.057458589072667605, 113: 0.9697871999213095, 119: 0.035254607412320206},[113, 98, 97, 6, 84, 53, 51, 11, 7, 110, 27, 81, 5, 119, 105, 87, 50, 79, 93, 85, 107, 70, 14, 58, 67, 76, 60]
2021-08-18:15:52:08,399 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:52:08,399 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:52:08,400 INFO     [oort.py:398] At round 92, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 917.746468634347, 'duration': 13.411352670399307, 'time_stamp': 93, 'count': 90, 'status': True, 'gradient': 18.181335058995348}, [1.0, -3.2258411380767565e-06]), ({'reward': 354.5513747768551, 'duration': 66.93898235209988, 'time_stamp': 93, 'count': 57, 'status': True, 'gradient': 19.02673328874767}, [0.38632155638450405, -3.2258411380767565e-06]), ({'reward': 373.8152731744992, 'duration': 30.380154975061778, 'time_stamp': 93, 'count': 87, 'status': True, 'gradient': 15.046751323533929}, [0.4073122207485381, -3.2258411380767565e-06])]
2021-08-18:15:52:08,401 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:52:08,761 INFO     [param_server.py:553] For epoch: 94, median_reward: 287.6764497975358, dev: 287.6764497975358
2021-08-18:15:52:09,397 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4092, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:52:09,398 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1392.8984, eval_time 0.5881, test_loss 2.4092, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:52:09,428 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7123, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:52:09,429 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1392.9294, eval_time 0.6201, test_loss 2.7123, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:52:09,489 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:09,498 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:09,511 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:09,525 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:09,573 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.477, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:52:09,575 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1393.0732, eval_time 0.7667, test_loss 2.477, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:52:09,651 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:09,681 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:11,55 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:11,65 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:12,25 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:12,36 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:12,270 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:12,284 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:13,346 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:13,379 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:13,462 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:13,482 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:14,738 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:14,766 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:14,947 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:14,981 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:16,167 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:15,810 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:29,982 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:29,997 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:30,474 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:30,497 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:30,641 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:30,654 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:30,685 INFO     [learner.py:606] ====Pushing takes 0.012416601181030273 s
2021-08-18:15:52:30,699 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:30,706 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:30,723 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:30,724 INFO     [param_server.py:410] Lock worker 1 with localStep 94 , while globalStep is 93

2021-08-18:15:52:33,367 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:33,386 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:33,417 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:33,437 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:34,84 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:34,93 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:34,620 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:38,254 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:34,682 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:38,269 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:38,810 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:38,865 INFO     [learner.py:606] ====Pushing takes 0.05348682403564453 s
2021-08-18:15:52:38,918 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:38,927 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:38,928 INFO     [param_server.py:410] Lock worker 3 with localStep 94 , while globalStep is 93

2021-08-18:15:52:40,345 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:52:40,355 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:52:40,968 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:52:41,10 INFO     [learner.py:606] ====Pushing takes 0.04011178016662598 s
2021-08-18:15:52:41,50 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:41,59 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:52:41,60 INFO     [param_server.py:381] ====After aggregation in epoch: 93, virtual_clock: 3000.9597694907143, top_1: : 59.5676 % (1846.0), top_5: : 100.0 % (3099.0), test loss: 2.5328287725095397, test len: 3099.0
2021-08-18:15:52:41,64 INFO     [param_server.py:410] Lock worker 2 with localStep 94 , while globalStep is 94

2021-08-18:15:52:41,64 INFO     [param_server.py:441] ====Epoch 95 completes 20 clients with loss 5.435810571702948, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:52:41,65 INFO     [param_server.py:450] ====Start to sample for epoch 95, global virtualClock: 3000.9597694907143, round_duration: 44.36663709010263
2021-08-18:15:52:41,66 INFO     [oort.py:208] Training selector: Pacer 93: lastExploitationUtil 301.02067947691285, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:52:41,67 INFO     [oort.py:321] scores are 26,{5: 0.04300013287034638, 6: 0.5165315395057379, 7: 0.06944001718260936, 11: 0.011942379583644623, 14: 0.008715985034110444, 27: 0.05124995407873324, 50: 0.00963824455613074, 51: 0.03905425628374844, 53: 0.5773804906823912, 58: 0.0036046175403446072, 60: 0.0018490332950338478, 67: 0.001968797135788273, 70: 0.007685494084913966, 76: 0.0017397165515597689, 79: 0.046710294082413194, 81: 0.019852481350281656, 84: 0.2449634760298292, 85: 0.01810322605691856, 87: 0.04424489153331329, 93: 0.018766789926130123, 97: 0.3080374709353806, 98: 0.3070250214102102, 105: 0.0453087414218754, 107: 0.010453179723003933, 110: 0.007371174023980547, 113: 0.06944001718260936, 119: 0.0023653640087448833},[53, 6, 97, 98, 84, 7, 113, 27, 79, 105, 87, 5, 51, 81, 93, 85, 11, 107, 50, 14, 70, 110, 58, 119, 67, 60, 76]
2021-08-18:15:52:41,68 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:52:41,68 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:52:41,69 INFO     [oort.py:398] At round 93, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 94, 'count': 91, 'status': True, 'gradient': 21.31796731083266}, [1.1750449736914255e-08, -3.191523314077812e-06]), ({'reward': 679.278155255476, 'duration': 11.058674649423494, 'time_stamp': 94, 'count': 91, 'status': True, 'gradient': 20.38178363842842}, [0.7981706433720761, -3.191523314077812e-06]), ({'reward': 393.9214544762002, 'duration': 13.298442137908651, 'time_stamp': 94, 'count': 91, 'status': True, 'gradient': 21.1135122605255}, [0.4628636864122064, -3.191523314077812e-06])]
2021-08-18:15:52:41,70 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:52:41,429 INFO     [param_server.py:553] For epoch: 95, median_reward: 276.52728092565883, dev: 276.52728092565883
2021-08-18:15:52:42,32 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3194, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:52:42,33 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1425.5336, eval_time 0.559, test_loss 2.3194, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:52:42,89 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2269, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:52:42,90 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1425.5904, eval_time 0.6158, test_loss 2.2269, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:52:42,112 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:52:42,122 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:42,159 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:52:42,173 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:42,241 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4569, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:52:42,242 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1425.7408, eval_time 0.7685, test_loss 2.4569, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:52:42,329 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:52:42,377 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:43,384 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:43,410 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:44,665 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:44,677 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:44,810 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:44,821 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:45,765 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:45,784 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:46,104 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:46,124 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:47,201 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:47,212 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:47,380 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:47,395 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:48,79 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:48,104 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:48,145 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:48,165 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:48,257 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:48,271 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:48,808 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:48,813 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:48,817 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:48,830 INFO     [learner.py:606] ====Pushing takes 0.01478433609008789 s
2021-08-18:15:52:48,852 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:48,860 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:48,860 INFO     [param_server.py:410] Lock worker 1 with localStep 95 , while globalStep is 94

2021-08-18:15:52:50,882 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:50,891 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:51,56 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:51,65 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:51,458 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:51,468 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:51,598 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:51,607 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:52,1 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:52:52,11 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:52:52,199 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:52,209 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:52,634 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:52:52,664 INFO     [learner.py:606] ====Pushing takes 0.02885603904724121 s
2021-08-18:15:52:52,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:52,709 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:52,710 INFO     [param_server.py:410] Lock worker 2 with localStep 95 , while globalStep is 94

2021-08-18:15:52:52,892 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:52,928 INFO     [learner.py:606] ====Pushing takes 0.034078121185302734 s
2021-08-18:15:52:52,977 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:52,987 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:52:52,987 INFO     [param_server.py:381] ====After aggregation in epoch: 94, virtual_clock: 3038.303288763776, top_1: : 59.7612 % (1852.0), top_5: : 100.0 % (3099.0), test loss: 2.3344011019777366, test len: 3099.0
2021-08-18:15:52:52,996 INFO     [param_server.py:410] Lock worker 3 with localStep 95 , while globalStep is 95

2021-08-18:15:52:52,996 INFO     [param_server.py:441] ====Epoch 96 completes 20 clients with loss 5.922719626068224, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:52:52,997 INFO     [param_server.py:450] ====Start to sample for epoch 96, global virtualClock: 3038.303288763776, round_duration: 37.343519273061496
2021-08-18:15:52:52,998 INFO     [oort.py:208] Training selector: Pacer 94: lastExploitationUtil 245.7489717835068, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:52:53,11 INFO     [oort.py:321] scores are 26,{5: 0.020852040276982023, 6: 0.26404885606952605, 7: 0.18307268204838845, 11: 0.056977287961475, 14: 0.007527603131339771, 27: 0.05869522931583983, 50: 0.007767758734319869, 51: 0.11114967029627408, 53: 0.046021520435322996, 58: 0.003113145579964806, 60: 0.0013892011853880747, 67: 0.0020121428117602642, 70: 0.006637614579772645, 76: 0.001502514714047064, 79: 0.011412250467471715, 81: 0.09903781791691839, 84: 0.07002787050732591, 85: 0.007700005633292879, 87: 0.11443299790605456, 93: 0.012023839859417493, 97: 0.34108529432784696, 98: 0.20046362353261424, 105: 0.044999074943738976, 107: 0.009027939826352933, 110: 0.007340921431313193, 113: 0.09599689086950161, 119: 0.012668156655967443},[97, 6, 98, 7, 87, 51, 81, 113, 84, 27, 11, 53, 105, 5, 119, 93, 79, 107, 50, 85, 14, 110, 70, 58, 67, 76, 60]
2021-08-18:15:52:53,12 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:52:53,14 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:52:53,14 INFO     [oort.py:398] At round 94, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 94.49086225020588, 'duration': 5.8943907365129, 'time_stamp': 95, 'count': 92, 'status': True, 'gradient': 21.32900324773158}, [0.1139176709480769, -3.157927978189247e-06]), ({'reward': 22.27206920441199, 'duration': 8.009219946401625, 'time_stamp': 95, 'count': 19, 'status': True, 'gradient': 21.123159200263213}, [0.02684187976919005, -3.157927978189247e-06]), ({'reward': 106.56316506451785, 'duration': 12.029357192292537, 'time_stamp': 95, 'count': 92, 'status': True, 'gradient': 27.286987089125613}, [0.12847351264209064, -3.157927978189247e-06])]
2021-08-18:15:52:53,15 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:52:53,351 INFO     [param_server.py:553] For epoch: 96, median_reward: 264.1056187195969, dev: 264.1056187195969
2021-08-18:15:52:54,15 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2557, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:52:54,16 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1437.5169, eval_time 0.6208, test_loss 2.2557, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:52:54,60 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.668, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:15:52:54,60 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1437.5609, eval_time 0.6649, test_loss 2.668, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:15:52:54,126 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:52:54,130 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:52:54,134 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:54,147 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:54,195 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3874, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:52:54,197 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1437.6952, eval_time 0.8012, test_loss 2.3874, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:52:54,277 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:52:54,308 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:55,843 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:55,862 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:56,746 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:56,756 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:57,28 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:57,42 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:58,45 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:58,72 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:58,132 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:58,146 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:59,390 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:59,411 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:59,453 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:59,474 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:00,197 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:00,224 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:00,725 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:00,746 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:00,752 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:00,764 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:00,863 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:00,877 INFO     [learner.py:606] ====Pushing takes 0.013365507125854492 s
2021-08-18:15:53:00,909 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:00,916 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:00,917 INFO     [param_server.py:410] Lock worker 1 with localStep 96 , while globalStep is 95

2021-08-18:15:53:01,498 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:01,514 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:06,267 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:06,333 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:07,291 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:07,312 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:07,575 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:07,584 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:08,95 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:08,113 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:08,716 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:08,727 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:09,247 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:09,293 INFO     [learner.py:606] ====Pushing takes 0.0448451042175293 s
2021-08-18:15:53:09,344 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:09,357 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:09,358 INFO     [param_server.py:410] Lock worker 3 with localStep 96 , while globalStep is 95

2021-08-18:15:53:09,949 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:09,963 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:10,503 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:10,536 INFO     [learner.py:606] ====Pushing takes 0.031079769134521484 s
2021-08-18:15:53:10,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:10,590 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:10,590 INFO     [param_server.py:381] ====After aggregation in epoch: 95, virtual_clock: 3082.669925853879, top_1: : 60.8261 % (1885.0), top_5: : 100.0 % (3099.0), test loss: 2.4369934797286987, test len: 3099.0
2021-08-18:15:53:10,593 INFO     [param_server.py:410] Lock worker 2 with localStep 96 , while globalStep is 96

2021-08-18:15:53:10,593 INFO     [param_server.py:441] ====Epoch 97 completes 20 clients with loss 4.863583131129696, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:10,594 INFO     [param_server.py:450] ====Start to sample for epoch 97, global virtualClock: 3082.669925853879, round_duration: 44.36663709010263
2021-08-18:15:53:10,595 INFO     [oort.py:208] Training selector: Pacer 95: lastExploitationUtil 279.62772316179047, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:10,596 INFO     [oort.py:321] scores are 26,{5: 0.03063690549535477, 6: 0.4359334446649632, 7: 0.06887397029771754, 11: 0.06235607844130879, 14: 0.00987530334062277, 27: 0.07629785512045137, 31: 0.1037474149520173, 50: 0.04320960779077409, 51: 0.2019007849261673, 53: 0.5726129911326675, 58: 0.004084069843915873, 60: 0.0018224636537684047, 67: 0.0022306680032112714, 70: 0.00870774618291132, 76: 0.0017680904126123483, 79: 0.0030740016195835596, 81: 0.018056035851218698, 84: 0.03169545398726445, 85: 0.05292471693722878, 87: 0.008200094756686822, 93: 0.08473735414512248, 97: 0.3294224933788941, 98: 0.48364279548441536, 105: 0.02084020393042463, 107: 0.011843563318973325, 110: 0.05369378039740276, 113: 0.5658984286462233, 119: 0.002346082519725889},[53, 113, 98, 6, 97, 51, 31, 93, 27, 7, 11, 110, 85, 50, 84, 5, 105, 81, 107, 14, 70, 87, 58, 79, 119, 67, 60, 76]
2021-08-18:15:53:10,597 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:53:10,598 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:10,599 INFO     [oort.py:398] At round 95, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 96, 'count': 93, 'status': True, 'gradient': 21.134440582873758}, [1.4682522195159319e-08, -3.125032552422424e-06]), ({'reward': 681.0918822716488, 'duration': 13.411352670399307, 'time_stamp': 96, 'count': 93, 'status': True, 'gradient': 18.20494133411381}, [1.0, -3.125032552422424e-06]), ({'reward': 285.0375106639128, 'duration': 21.635252629006885, 'time_stamp': 96, 'count': 47, 'status': True, 'gradient': 21.75588699472189}, [0.4184922898379302, -3.125032552422424e-06])]
2021-08-18:15:53:10,599 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:10,980 INFO     [param_server.py:553] For epoch: 97, median_reward: 270.9854437482103, dev: 270.9854437482103
2021-08-18:15:53:11,702 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2723, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:53:11,703 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1455.2039, eval_time 0.684, test_loss 2.2723, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:53:11,782 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5604, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:53:11,783 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1455.2838, eval_time 0.764, test_loss 2.5604, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:53:11,796 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:11,804 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:11,859 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5346, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:53:11,863 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1455.3614, eval_time 0.8492, test_loss 2.5346, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:53:11,867 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:11,890 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:11,934 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:11,965 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:13,123 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:13,137 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:14,258 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:14,268 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:14,417 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:14,428 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:15,302 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:15,304 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:15,317 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:15,332 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:16,699 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:16,720 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:16,788 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:16,822 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:17,645 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:17,665 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:17,741 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:17,750 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:17,896 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:17,910 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:18,295 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:18,314 INFO     [learner.py:606] ====Pushing takes 0.01800370216369629 s
2021-08-18:15:53:18,337 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:18,346 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:18,351 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:18,356 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:18,357 INFO     [param_server.py:410] Lock worker 1 with localStep 97 , while globalStep is 96

2021-08-18:15:53:20,463 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:20,473 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:20,615 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:20,624 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:21,44 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:21,55 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:21,224 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:21,238 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:21,650 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:21,668 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:21,818 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:21,832 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:22,247 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:22,285 INFO     [learner.py:606] ====Pushing takes 0.03714871406555176 s
2021-08-18:15:53:22,345 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:22,355 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:22,356 INFO     [param_server.py:410] Lock worker 3 with localStep 97 , while globalStep is 96

2021-08-18:15:53:22,519 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:22,547 INFO     [learner.py:606] ====Pushing takes 0.026644468307495117 s
2021-08-18:15:53:22,583 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:22,591 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:22,592 INFO     [param_server.py:381] ====After aggregation in epoch: 96, virtual_clock: 3120.0134451269405, top_1: : 60.6002 % (1878.0), top_5: : 100.0 % (3099.0), test loss: 2.4557692209879556, test len: 3099.0
2021-08-18:15:53:22,594 INFO     [param_server.py:410] Lock worker 2 with localStep 97 , while globalStep is 97

2021-08-18:15:53:22,595 INFO     [param_server.py:441] ====Epoch 98 completes 20 clients with loss 5.948203604026963, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:22,595 INFO     [param_server.py:450] ====Start to sample for epoch 98, global virtualClock: 3120.0134451269405, round_duration: 37.343519273061496
2021-08-18:15:53:22,596 INFO     [oort.py:208] Training selector: Pacer 96: lastExploitationUtil 305.5756439671695, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:22,597 INFO     [oort.py:321] scores are 26,{5: 0.042746217650803456, 6: 0.32649801027171677, 7: 0.06859675668172548, 11: 0.011797354605281401, 14: 0.007963406047165661, 27: 0.03824956889747564, 50: 0.0029289280224612767, 51: 0.03857999211948597, 53: 0.05566601008152751, 58: 0.003293377972330273, 60: 0.001368327847326184, 67: 0.0017988019662058656, 70: 0.007021892514929743, 76: 0.0013364647139881194, 79: 0.021349917311692307, 81: 0.2022162603436205, 84: 0.23611074715990407, 85: 0.025633810009821477, 87: 0.008167089865155922, 93: 0.04878567723598746, 97: 0.32366695128600426, 98: 0.16469641506858526, 105: 0.023366216334926467, 107: 0.009550603206924252, 110: 0.008928638537254525, 113: 1.0685967462745236, 119: 0.016609268936883213},[113, 6, 97, 84, 81, 98, 7, 53, 93, 5, 51, 27, 85, 105, 79, 119, 11, 107, 110, 87, 14, 70, 58, 50, 67, 60, 76]
2021-08-18:15:53:22,599 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000004
2021-08-18:15:53:22,600 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:22,600 INFO     [oort.py:398] At round 96, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 480.34021355305583, 'duration': 11.90395711384456, 'time_stamp': 97, 'count': 95, 'status': True, 'gradient': 21.037206858164485}, [0.49988935649586735, -3.0928153898493827e-06]), ({'reward': 675.262064854908, 'duration': 17.619275735353515, 'time_stamp': 97, 'count': 93, 'status': True, 'gradient': 18.423223322095673}, [0.7027484605795045, -3.0928153898493827e-06]), ({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 97, 'count': 94, 'status': True, 'gradient': 27.312760441153674}, [1.040720179542545e-08, -3.0928153898493827e-06])]
2021-08-18:15:53:22,601 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:22,945 INFO     [param_server.py:553] For epoch: 98, median_reward: 276.3912911683587, dev: 276.3912911683587
2021-08-18:15:53:23,517 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.332, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:53:23,523 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1467.0238, eval_time 0.5528, test_loss 2.332, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:53:23,566 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5357, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:53:23,567 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1467.0652, eval_time 0.5985, test_loss 2.5357, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:53:23,594 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:23,602 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:23,569 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4504, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:53:23,603 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1467.1032, eval_time 0.6324, test_loss 2.4504, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:53:23,624 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:23,641 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:23,661 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:23,679 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:25,424 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:25,437 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:26,139 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:26,153 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:26,698 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:26,712 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:27,165 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:27,193 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:27,898 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:27,908 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:28,368 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:28,378 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:28,823 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:28,850 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:29,496 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:29,516 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:29,649 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:29,677 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:30,378 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:30,399 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:30,415 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:30,432 INFO     [learner.py:606] ====Pushing takes 0.014501333236694336 s
2021-08-18:15:53:30,434 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:30,443 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:30,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:30,474 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:30,474 INFO     [param_server.py:410] Lock worker 1 with localStep 98 , while globalStep is 97

2021-08-18:15:53:33,320 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:33,334 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:33,353 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:33,372 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:34,87 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:34,98 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:34,442 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:34,456 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:34,661 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:34,671 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:35,260 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:35,297 INFO     [learner.py:606] ====Pushing takes 0.03618311882019043 s
2021-08-18:15:53:35,342 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:35,351 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:35,352 INFO     [param_server.py:410] Lock worker 3 with localStep 98 , while globalStep is 97

2021-08-18:15:53:37,70 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:37,90 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:37,738 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:37,769 INFO     [learner.py:606] ====Pushing takes 0.029256343841552734 s
2021-08-18:15:53:37,811 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:37,820 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:37,821 INFO     [param_server.py:381] ====After aggregation in epoch: 97, virtual_clock: 3164.3800822170433, top_1: : 59.4063 % (1841.0), top_5: : 100.0 % (3099.0), test loss: 2.4393500531161276, test len: 3099.0
2021-08-18:15:53:37,825 INFO     [param_server.py:410] Lock worker 2 with localStep 98 , while globalStep is 98

2021-08-18:15:53:37,826 INFO     [param_server.py:441] ====Epoch 99 completes 20 clients with loss 6.38034784827182, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:37,826 INFO     [param_server.py:450] ====Start to sample for epoch 99, global virtualClock: 3164.3800822170433, round_duration: 44.36663709010263
2021-08-18:15:53:37,827 INFO     [oort.py:208] Training selector: Pacer 97: lastExploitationUtil 396.7458988440581, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:37,828 INFO     [oort.py:321] scores are 26,{5: 0.05503593636404215, 6: 0.06822077872969276, 7: 0.06832330267791004, 11: 0.01175032564928844, 14: 0.008953315710061608, 27: 0.052753780300036746, 50: 0.023522598975348582, 51: 0.2424481900670465, 53: 0.29838725942390343, 58: 0.0037027689614458847, 60: 0.0016523130378364589, 67: 0.0020224062176325756, 70: 0.007894765153996, 76: 0.001218238761226496, 79: 0.01961889399137004, 81: 0.18550219255813202, 84: 0.2800985994494253, 85: 0.022603106235661252, 87: 0.039669069425247824, 93: 0.04323957593968675, 97: 0.3408199570674571, 98: 0.41761066070470987, 105: 0.03932596302041424, 107: 0.010737813094882217, 110: 0.016211758783536742, 113: 0.13666637378475888, 119: 0.002327324900970574},[98, 97, 53, 84, 51, 81, 113, 7, 6, 5, 27, 93, 87, 105, 50, 85, 79, 110, 11, 107, 14, 70, 58, 119, 67, 60, 76]
2021-08-18:15:53:37,829 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:53:37,830 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:37,830 INFO     [oort.py:398] At round 97, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 392.86836774860035, 'duration': 12.029357192292537, 'time_stamp': 98, 'count': 95, 'status': True, 'gradient': 27.32640210485058}, [0.3627592078287574, -3.061255727099259e-06]), ({'reward': 925.5364160670174, 'duration': 13.411352670399307, 'time_stamp': 98, 'count': 95, 'status': True, 'gradient': 18.22231588949326}, [0.8546164525464252, -3.061255727099259e-06]), ({'reward': 1082.9828526324804, 'duration': 15.972045438625893, 'time_stamp': 98, 'count': 95, 'status': True, 'gradient': 21.15154742539853}, [1.0, -3.061255727099259e-06])]
2021-08-18:15:53:37,831 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 107]
2021-08-18:15:53:38,173 INFO     [param_server.py:553] For epoch: 99, median_reward: 296.3611460778483, dev: 296.3611460778483
2021-08-18:15:53:38,835 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5312, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:53:38,836 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1482.3363, eval_time 0.6266, test_loss 2.5312, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:53:38,841 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3391, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:53:38,842 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1482.3425, eval_time 0.6327, test_loss 2.3391, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:53:38,874 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4537, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:53:38,875 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1482.3732, eval_time 0.6674, test_loss 2.4537, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:53:38,919 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:38,928 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:38,945 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:38,952 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:38,953 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:38,967 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:40,43 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:40,73 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:41,95 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:41,105 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:41,452 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:41,463 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:42,314 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:42,316 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:42,328 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:42,350 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:43,726 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:43,745 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:43,984 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:44,17 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:44,704 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:44,712 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:44,719 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:44,765 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:44,936 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:44,945 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:45,462 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:45,478 INFO     [learner.py:606] ====Pushing takes 0.013497352600097656 s
2021-08-18:15:53:45,500 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:45,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:45,506 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:45,507 INFO     [param_server.py:410] Lock worker 1 with localStep 99 , while globalStep is 98

2021-08-18:15:53:45,509 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:47,497 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:47,511 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:47,601 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:47,619 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:48,157 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:48,169 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:48,189 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:48,202 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:48,658 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:48,670 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:48,706 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:48,724 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:53:49,299 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:49,318 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:53:49,334 INFO     [learner.py:606] ====Pushing takes 0.03398895263671875 s
2021-08-18:15:53:49,357 INFO     [learner.py:606] ====Pushing takes 0.03829693794250488 s
2021-08-18:15:53:49,391 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:49,405 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:49,406 INFO     [param_server.py:410] Lock worker 3 with localStep 99 , while globalStep is 98

2021-08-18:15:53:49,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:49,441 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:49,441 INFO     [param_server.py:381] ====After aggregation in epoch: 98, virtual_clock: 3201.723601490105, top_1: : 58.5995 % (1816.0), top_5: : 100.0 % (3099.0), test loss: 2.4413387687117964, test len: 3099.0
2021-08-18:15:53:49,444 INFO     [param_server.py:410] Lock worker 2 with localStep 99 , while globalStep is 99

2021-08-18:15:53:49,445 INFO     [param_server.py:441] ====Epoch 100 completes 20 clients with loss 5.527355206146159, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:53:49,446 INFO     [param_server.py:450] ====Start to sample for epoch 100, global virtualClock: 3201.723601490105, round_duration: 37.343519273061496
2021-08-18:15:53:49,446 INFO     [oort.py:208] Training selector: Pacer 98: lastExploitationUtil 334.3521839900696, lastExplorationUtil 0.0, last_util_record 60
2021-08-18:15:53:49,447 INFO     [oort.py:321] scores are 25,{5: 0.08291888676121954, 6: 0.039085104927245, 7: 0.11230578216768573, 11: 0.011703928147472946, 14: 0.008214725882178175, 27: 0.09417951196584619, 50: 0.009094623226963526, 51: 0.05272181096196926, 53: 0.45088552503832885, 58: 0.0033973148058582432, 60: 0.0015160080485179504, 67: 0.0018555709681491919, 70: 0.007243498804735329, 79: 0.02562825915472986, 81: 0.16231121795606507, 84: 0.0634397949924753, 85: 0.027611348193871885, 87: 0.01738038761326782, 93: 0.08830992356938175, 97: 0.12515468952738742, 98: 0.254088997012078, 105: 0.031365511076260275, 107: 0.001681172985327987, 110: 0.019748894228739846, 113: 0.6031301212521195, 119: 0.0023299323931347637},[113, 53, 98, 81, 97, 7, 27, 93, 5, 84, 51, 6, 105, 85, 79, 110, 87, 11, 50, 14, 70, 58, 119, 67, 107, 60]
2021-08-18:15:53:49,448 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:53:49,449 INFO     [oort.py:365] exploration poss is [16.91829855  9.05547074  1.91505738  0.90032832]
2021-08-18:15:53:49,450 INFO     [oort.py:398] At round 98, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 65, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 540.8937352645476, 'duration': 8.009219946401625, 'time_stamp': 99, 'count': 23, 'status': True, 'gradient': 21.164598942814642}, [0.5350766108247695, -3.0303336397337374e-06]), ({'reward': 327.78142990293713, 'duration': 15.972045438625893, 'time_stamp': 99, 'count': 96, 'status': True, 'gradient': 21.166068731538033}, [0.32425236055603424, -3.0303336397337374e-06]), ({'reward': 616.1019073863929, 'duration': 11.058674649423494, 'time_stamp': 99, 'count': 96, 'status': True, 'gradient': 20.43262560375048}, [0.6094773192905054, -3.0303336397337374e-06])]
2021-08-18:15:53:49,451 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:53:49,793 INFO     [param_server.py:553] For epoch: 100, median_reward: 280.05627099813773, dev: 280.05627099813773
2021-08-18:15:53:50,434 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.313, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:53:50,435 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1493.9357, eval_time 0.6085, test_loss 2.313, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:53:50,463 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5437, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:53:50,464 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1493.9639, eval_time 0.6369, test_loss 2.5437, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:53:50,499 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5724, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:53:50,502 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1494.0001, eval_time 0.6753, test_loss 2.5724, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:53:50,508 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:53:50,515 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:50,545 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:53:50,558 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:50,574 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:53:50,594 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:51,565 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:51,579 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:52,558 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:52,572 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:53,52 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:53,67 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:53,592 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:53,603 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:53,959 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:53,986 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:55,269 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:55,280 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:55,315 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:55,332 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:55,416 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:55,443 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:55,886 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:55,897 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:56,217 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:56,250 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:53:56,746 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:56,766 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:56,768 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:53:56,802 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:57,178 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:57,210 INFO     [learner.py:606] ====Pushing takes 0.03081202507019043 s
2021-08-18:15:53:57,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:57,247 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:53:57,247 INFO     [param_server.py:410] Lock worker 1 with localStep 100 , while globalStep is 99

2021-08-18:15:53:57,784 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:57,797 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:58,450 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:58,463 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:58,613 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:58,633 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:59,180 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:59,191 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:59,676 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:59,689 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:00,330 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:00,351 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:00,365 INFO     [learner.py:606] ====Pushing takes 0.03369498252868652 s
2021-08-18:15:54:00,386 INFO     [learner.py:606] ====Pushing takes 0.03395485877990723 s
2021-08-18:15:54:00,418 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:00,428 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:54:00,436 INFO     [param_server.py:410] Lock worker 3 with localStep 100 , while globalStep is 99

2021-08-18:15:54:00,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:00,469 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:00,470 INFO     [param_server.py:381] ====After aggregation in epoch: 99, virtual_clock: 3234.813718866164, top_1: : 59.6321 % (1848.0), top_5: : 100.0 % (3099.0), test loss: 2.4763800281065484, test len: 3099.0
2021-08-18:15:54:00,472 INFO     [param_server.py:410] Lock worker 2 with localStep 100 , while globalStep is 100

2021-08-18:15:54:00,473 INFO     [param_server.py:441] ====Epoch 101 completes 20 clients with loss 8.207599293757095, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:54:00,473 INFO     [param_server.py:450] ====Start to sample for epoch 101, global virtualClock: 3234.813718866164, round_duration: 33.09011737605898
2021-08-18:15:54:00,474 INFO     [oort.py:208] Training selector: Pacer 99: lastExploitationUtil 321.32052226754706, lastExplorationUtil 359.0339798104593, last_util_record 60
2021-08-18:15:54:00,475 INFO     [oort.py:321] scores are 26,{5: 0.080246486011593, 6: 0.038932219021034234, 7: 0.06778732110818099, 11: 0.011658146879535125, 14: 0.006559495278765611, 27: 0.06536650933056616, 50: 0.010421772945121498, 51: 0.03812475167432222, 53: 0.0851981519688535, 58: 0.002712771034497229, 60: 0.0012460231708593505, 67: 0.0014816816993730036, 70: 0.0057839661228972425, 79: 0.004811013250632561, 81: 0.1296118224474559, 84: 0.03436123772460942, 85: 0.03583452317233576, 87: 0.008070718937593497, 93: 0.011786040352368913, 97: 0.34064896695942837, 98: 0.3713128728274615, 103: 0.022469417882826533, 105: 0.020100930072444054, 107: 0.00786687709682727, 110: 0.007195737570079265, 113: 0.21067603374465804, 119: 0.010847476622743296},[98, 97, 113, 81, 53, 5, 7, 27, 6, 51, 85, 84, 103, 105, 93, 11, 119, 50, 87, 107, 110, 14, 70, 79, 58, 67, 60]
2021-08-18:15:54:00,476 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:54:00,476 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:00,477 INFO     [oort.py:398] At round 99, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.600000000000001, sampled score is [({'reward': 1287.6540632674462, 'duration': 15.972045438625893, 'time_stamp': 100, 'count': 97, 'status': True, 'gradient': 21.17231433870405}, [1.0, -3.0000300003000056e-06]), ({'reward': 183.99980396317488, 'duration': 8.009219946401625, 'time_stamp': 100, 'count': 24, 'status': True, 'gradient': 21.17389396476959}, [0.14288872040259828, -3.0000300003000056e-06]), ({'reward': 969.3897605708914, 'duration': 13.411352670399307, 'time_stamp': 100, 'count': 97, 'status': True, 'gradient': 18.240883905317606}, [0.7528320835672028, -3.0000300003000056e-06])]
2021-08-18:15:54:00,477 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:54:00,832 INFO     [param_server.py:541] Handle Wight 0.03597688674926758 | Send 0.3584320545196533
2021-08-18:15:54:00,832 INFO     [param_server.py:553] For epoch: 101, median_reward: 280.9447756512878, dev: 280.9447756512878
2021-08-18:15:54:01,415 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7128, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:54:01,417 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1504.9151, eval_time 0.5493, test_loss 2.7128, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:54:01,497 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:01,518 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:01,534 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7078, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:54:01,535 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1505.035, eval_time 0.6671, test_loss 2.7078, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:54:01,598 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4335, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:54:01,599 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1505.0997, eval_time 0.732, test_loss 2.4335, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:54:01,605 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:01,613 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:01,687 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:01,707 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:02,987 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:03,2 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:04,88 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:04,101 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:04,116 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:04,128 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:04,256 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:04,267 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:05,130 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:05,144 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:05,183 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:05,195 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:05,706 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:05,746 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:54:06,422 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:06,432 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:06,444 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:54:06,484 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:06,958 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:06,977 INFO     [learner.py:606] ====Pushing takes 0.018369436264038086 s
2021-08-18:15:54:07,14 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:07,21 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:54:07,22 INFO     [param_server.py:410] Lock worker 1 with localStep 101 , while globalStep is 100

2021-08-18:15:54:07,437 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:07,447 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:07,566 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:07,575 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:08,166 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:12,15 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:37,861 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:37,878 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:54:37,876 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:37,895 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:38,480 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:54:38,491 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:54:38,515 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:54:38,529 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:54:39,3 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:39,7 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:54:39,21 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:39,30 INFO     [learner.py:606] ====Pushing takes 0.0258636474609375 s
2021-08-18:15:54:39,69 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:39,82 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:54:39,83 INFO     [param_server.py:410] Lock worker 2 with localStep 101 , while globalStep is 100

2021-08-18:15:54:39,547 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:39,582 INFO     [learner.py:606] ====Pushing takes 0.034204721450805664 s
2021-08-18:15:54:39,618 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:39,628 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:39,628 INFO     [param_server.py:381] ====After aggregation in epoch: 100, virtual_clock: 3273.20974042495, top_1: : 58.9222 % (1826.0), top_5: : 100.0 % (3099.0), test loss: 2.6180645183280657, test len: 3099.0
2021-08-18:15:54:39,635 INFO     [param_server.py:410] Lock worker 3 with localStep 101 , while globalStep is 101

2021-08-18:15:54:39,636 INFO     [param_server.py:441] ====Epoch 102 completes 20 clients with loss 5.808049705548191, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:54:39,636 INFO     [param_server.py:450] ====Start to sample for epoch 102, global virtualClock: 3273.20974042495, round_duration: 38.39602155878561
2021-08-18:15:54:39,637 INFO     [oort.py:208] Training selector: Pacer 100: lastExploitationUtil 309.63225761006356, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:54:39,638 INFO     [oort.py:321] scores are 26,{5: 0.008640026051350424, 6: 0.05331672737937557, 7: 0.3696890027094087, 11: 0.015965548703737363, 14: 0.010519529469312287, 27: 0.08627580798792439, 50: 0.02203634056211053, 51: 0.25205507890474305, 53: 0.1606954112714327, 58: 0.004350498571631047, 60: 0.0019413540476983732, 67: 0.0024608551735717773, 70: 0.009275805453551823, 79: 0.06413750948918553, 81: 0.12985388699987951, 84: 0.39217545916148006, 85: 0.010336419089824174, 87: 0.044952446762947906, 93: 0.016140695705273454, 97: 0.029615912433577918, 98: 0.3503653370214815, 103: 0.09513375885719685, 105: 0.036188834883408606, 107: 0.012616191023024205, 110: 0.02161535703279882, 113: 0.3656823624705459, 119: 0.01739620887753698},[84, 7, 113, 98, 51, 53, 81, 103, 27, 79, 6, 87, 105, 97, 50, 110, 119, 93, 11, 107, 14, 85, 70, 5, 58, 67, 60]
2021-08-18:15:54:39,639 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:54:39,640 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:39,640 INFO     [oort.py:398] At round 100, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 307.81734019378655, 'duration': 5.8943907365129, 'time_stamp': 101, 'count': 98, 'status': True, 'gradient': 21.388661644576008}, [0.3021643817066043, -2.970326438875635e-06]), ({'reward': 656.1955266947592, 'duration': 30.380154975061778, 'time_stamp': 101, 'count': 95, 'status': True, 'gradient': 16.777641579130524}, [0.6441558229696578, -2.970326438875635e-06]), ({'reward': 562.6666672892893, 'duration': 13.298442137908651, 'time_stamp': 101, 'count': 98, 'status': True, 'gradient': 21.181313178901142}, [0.552341608799056, -2.970326438875635e-06])]
2021-08-18:15:54:39,641 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:54:39,980 INFO     [param_server.py:553] For epoch: 102, median_reward: 278.00123168756016, dev: 278.00123168756016
2021-08-18:15:54:40,680 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4653, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:15:54:40,681 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1544.1818, eval_time 0.6553, test_loss 2.4653, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:15:54:40,717 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.614, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:54:40,718 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1544.2187, eval_time 0.6942, test_loss 2.614, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:54:40,718 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3944, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:54:40,755 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1544.2536, eval_time 0.7412, test_loss 2.3944, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:54:40,761 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:40,775 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:40,823 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:40,839 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:40,902 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:40,924 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:42,105 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:42,118 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:42,780 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:42,794 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:43,10 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:43,19 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:43,927 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:43,941 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:43,999 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:44,8 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:44,823 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:44,832 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:45,154 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:45,174 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:45,431 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:45,441 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:45,614 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:45,624 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:45,868 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:45,901 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:54:46,80 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:46,90 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:46,694 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:54:46,728 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:47,212 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:47,242 INFO     [learner.py:606] ====Pushing takes 0.028475284576416016 s
2021-08-18:15:54:47,265 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:47,271 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:54:47,272 INFO     [param_server.py:410] Lock worker 1 with localStep 102 , while globalStep is 101

2021-08-18:15:54:47,438 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:47,452 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:54:47,726 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:47,736 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:48,37 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:54:48,57 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:54:48,392 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:54:48,406 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:54:48,957 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:54:48,966 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:49,415 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:49,456 INFO     [learner.py:606] ====Pushing takes 0.039914846420288086 s
2021-08-18:15:54:49,492 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:49,500 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:54:49,501 INFO     [param_server.py:410] Lock worker 2 with localStep 102 , while globalStep is 101

2021-08-18:15:54:49,559 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:49,597 INFO     [learner.py:606] ====Pushing takes 0.03632760047912598 s
2021-08-18:15:54:49,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:49,640 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:49,641 INFO     [param_server.py:381] ====After aggregation in epoch: 101, virtual_clock: 3301.8931434479655, top_1: : 60.6325 % (1879.0), top_5: : 100.0 % (3099.0), test loss: 2.4912525415420532, test len: 3099.0
2021-08-18:15:54:49,643 INFO     [param_server.py:410] Lock worker 3 with localStep 102 , while globalStep is 102

2021-08-18:15:54:49,644 INFO     [param_server.py:441] ====Epoch 103 completes 20 clients with loss 8.95724607964718, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:54:49,644 INFO     [param_server.py:450] ====Start to sample for epoch 103, global virtualClock: 3301.8931434479655, round_duration: 28.683403023015895
2021-08-18:15:54:49,645 INFO     [oort.py:208] Training selector: Pacer 101: lastExploitationUtil 339.9738166106026, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:54:49,646 INFO     [oort.py:321] scores are 26,{5: 0.03087776382214194, 6: 0.05311201325910503, 7: 0.0672653642426582, 11: 0.015904247618352546, 14: 0.010986162597723639, 27: 0.07756042180529989, 50: 0.014636912773189176, 51: 0.6903290744669963, 53: 0.1259954570384237, 58: 0.004543481229700641, 60: 0.002027470077438509, 67: 0.002382082191812139, 70: 0.00968726854512382, 79: 0.03253709879784622, 81: 0.0824967515850251, 84: 0.21597911453894386, 85: 0.010296731527501294, 87: 0.011010215754524148, 93: 0.09425677748039857, 97: 0.43992122169328013, 98: 0.6639130703561147, 103: 0.05453480737967812, 105: 0.03336859105210646, 107: 0.013175829427278218, 110: 0.04549528525789238, 113: 0.1999698353283298, 119: 0.018167882876331632},[51, 98, 97, 84, 113, 53, 93, 81, 27, 7, 103, 6, 110, 105, 79, 5, 119, 11, 50, 107, 87, 14, 85, 70, 58, 67, 60]
2021-08-18:15:54:49,646 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:54:49,647 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:49,647 INFO     [oort.py:398] At round 101, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1060.13341191745, 'duration': 13.411352670399307, 'time_stamp': 102, 'count': 99, 'status': True, 'gradient': 18.255317855787137}, [1.0, -2.9412053059343743e-06]), ({'reward': 171.35326888913553, 'duration': 17.619275735353515, 'time_stamp': 102, 'count': 98, 'status': True, 'gradient': 15.107845449727126}, [0.16162578370283168, -2.9412053059343743e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 102, 'count': 99, 'status': True, 'gradient': 21.396493747493896}, [9.432863941363117e-09, -2.9412053059343743e-06])]
2021-08-18:15:54:49,662 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:54:49,990 INFO     [param_server.py:553] For epoch: 103, median_reward: 284.57526142230955, dev: 284.57526142230955
2021-08-18:15:54:50,576 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3352, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:54:50,577 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1554.0755, eval_time 0.5537, test_loss 2.3352, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:54:50,600 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.39, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:54:50,600 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1554.101, eval_time 0.5754, test_loss 2.39, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:54:50,601 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3301, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:54:50,601 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1554.1018, eval_time 0.5764, test_loss 2.3301, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:54:50,657 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:54:50,676 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:50,686 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:54:50,687 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:54:50,695 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:50,702 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:51,957 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:51,966 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:53,391 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:53,405 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:53,622 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:53,636 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:53,682 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:53,715 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:54,674 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:54,693 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:54,907 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:54,935 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:55,559 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:55,586 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:54:55,792 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:55,802 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:56,183 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:54:56,210 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:56,586 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:56,608 INFO     [learner.py:606] ====Pushing takes 0.01902174949645996 s
2021-08-18:15:54:56,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:56,637 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:54:56,637 INFO     [param_server.py:410] Lock worker 1 with localStep 103 , while globalStep is 102

2021-08-18:15:54:56,794 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:56,807 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:56,863 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:56,875 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:57,463 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:57,475 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:59,684 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:59,700 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:59,816 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:59,835 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:00,318 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:00,336 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:00,619 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:00,631 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:01,37 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:01,50 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:01,165 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:01,196 INFO     [learner.py:606] ====Pushing takes 0.029050827026367188 s
2021-08-18:15:55:01,226 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:01,239 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:55:01,239 INFO     [param_server.py:410] Lock worker 2 with localStep 103 , while globalStep is 102

2021-08-18:15:55:01,658 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:01,711 INFO     [learner.py:606] ====Pushing takes 0.05166888236999512 s
2021-08-18:15:55:01,745 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:01,755 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:01,756 INFO     [param_server.py:381] ====After aggregation in epoch: 102, virtual_clock: 3340.2891650067513, top_1: : 59.9871 % (1859.0), top_5: : 100.0 % (3099.0), test loss: 2.35176349790008, test len: 3099.0
2021-08-18:15:55:01,758 INFO     [param_server.py:410] Lock worker 3 with localStep 103 , while globalStep is 103

2021-08-18:15:55:01,758 INFO     [param_server.py:441] ====Epoch 104 completes 20 clients with loss 5.894800382441297, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:01,759 INFO     [param_server.py:450] ====Start to sample for epoch 104, global virtualClock: 3340.2891650067513, round_duration: 38.39602155878561
2021-08-18:15:55:01,760 INFO     [oort.py:208] Training selector: Pacer 102: lastExploitationUtil 335.48431084392564, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:55:01,760 INFO     [oort.py:321] scores are 26,{5: 0.011197226570431082, 6: 0.2184068844656133, 7: 0.19028917970468132, 11: 0.015843738590138566, 14: 0.01039674226060401, 27: 0.021173313739830387, 50: 0.027414259267274275, 51: 0.051812574123786925, 53: 0.49730086141326474, 58: 0.004299718203777308, 60: 0.001918693961491401, 67: 0.0022820883217646594, 70: 0.009167535377073096, 79: 0.026073314503305692, 81: 0.05927097902200319, 84: 0.24251225176715732, 85: 0.010257556759007974, 87: 0.08375733912135824, 93: 0.016017549297097533, 97: 0.4679841669203345, 98: 0.47838480618260387, 103: 0.07316377341382771, 105: 0.05225147641828567, 107: 0.01246893093075804, 110: 0.00977920300727253, 113: 0.22954838520757914, 119: 0.017193154935209027},[53, 98, 97, 84, 113, 6, 7, 87, 103, 81, 105, 51, 50, 79, 27, 119, 93, 11, 107, 5, 14, 85, 110, 70, 58, 67, 60]
2021-08-18:15:55:01,761 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:55:01,762 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:01,762 INFO     [oort.py:398] At round 102, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1117.7909054923196, 'duration': 15.972045438625893, 'time_stamp': 103, 'count': 100, 'status': True, 'gradient': 21.199334611457438}, [1.0, -2.9126496373751228e-06]), ({'reward': 234.2954906318475, 'duration': 11.90395711384456, 'time_stamp': 103, 'count': 101, 'status': True, 'gradient': 21.093974682856842}, [0.20959876607721287, -2.9126496373751228e-06]), ({'reward': 181.69292249397654, 'duration': 8.009219946401625, 'time_stamp': 103, 'count': 27, 'status': True, 'gradient': 21.200844628789284}, [0.16253894656445753, -2.9126496373751228e-06])]
2021-08-18:15:55:01,780 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:55:02,64 INFO     [param_server.py:553] For epoch: 104, median_reward: 283.60253143160804, dev: 283.60253143160804
2021-08-18:15:55:02,693 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3211, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:55:02,692 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7138, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:55:02,694 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1566.1941, eval_time 0.5847, test_loss 2.3211, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:55:02,694 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1566.1947, eval_time 0.5855, test_loss 2.7138, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:55:02,762 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:02,770 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:02,772 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:02,778 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:02,815 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4369, Top-1 Accuracy: 605.0/1033 (0.5857), Top-5 Accuracy: 1.0
2021-08-18:15:55:02,819 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1566.3174, eval_time 0.71, test_loss 2.4369, test_accuracy 0.5857, test_5_accuracy 1.0 

2021-08-18:15:55:02,898 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:02,920 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:04,4 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:04,14 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:04,553 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:04,563 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:04,897 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:04,909 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:05,665 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:05,687 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:06,421 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:06,454 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:06,555 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:06,564 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:07,70 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:07,79 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:07,156 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:07,177 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:07,680 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:07,690 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:07,721 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:07,754 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:08,407 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:08,440 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:55:08,876 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:08,909 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:09,34 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:55:09,61 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:09,187 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:09,203 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:09,394 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:09,423 INFO     [learner.py:606] ====Pushing takes 0.027522563934326172 s
2021-08-18:15:55:09,456 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:09,463 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:55:09,464 INFO     [param_server.py:410] Lock worker 1 with localStep 104 , while globalStep is 103

2021-08-18:15:55:09,568 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:09,578 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:09,679 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:09,690 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:10,221 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:10,261 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:10,818 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:10,855 INFO     [learner.py:606] ====Pushing takes 0.03511786460876465 s
2021-08-18:15:55:10,867 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:10,894 INFO     [learner.py:606] ====Pushing takes 0.02472662925720215 s
2021-08-18:15:55:10,896 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:10,904 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:55:10,905 INFO     [param_server.py:410] Lock worker 3 with localStep 104 , while globalStep is 103

2021-08-18:15:55:10,932 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:10,940 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:10,941 INFO     [param_server.py:381] ====After aggregation in epoch: 103, virtual_clock: 3368.30502050224, top_1: : 59.2449 % (1836.0), top_5: : 100.0 % (3099.0), test loss: 2.490617310559308, test len: 3099.0
2021-08-18:15:55:10,943 INFO     [param_server.py:410] Lock worker 2 with localStep 104 , while globalStep is 104

2021-08-18:15:55:10,944 INFO     [param_server.py:441] ====Epoch 105 completes 20 clients with loss 7.119373123189921, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:10,944 INFO     [param_server.py:450] ====Start to sample for epoch 105, global virtualClock: 3368.30502050224, round_duration: 28.015855495488744
2021-08-18:15:55:10,945 INFO     [oort.py:208] Training selector: Pacer 103: lastExploitationUtil 247.20257878093975, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:55:10,946 INFO     [oort.py:321] scores are 26,{5: 0.00854178089849058, 6: 0.052710466472262366, 7: 0.06675681280165609, 11: 0.12182544175342892, 14: 0.011718218951974255, 27: 0.1293211096627944, 50: 0.04562171575298364, 51: 0.11799405397474984, 53: 0.13808987951624563, 58: 0.0048462333758694884, 60: 0.0021625693297970517, 67: 0.003334069031506527, 70: 0.010332773873368227, 79: 0.00612414386985084, 81: 0.02406043430992179, 84: 0.42393865191782815, 85: 0.010218884366263418, 87: 0.07168612754647255, 93: 0.015957160944220162, 97: 0.3128021452611595, 98: 0.45511221394737017, 103: 0.08181125521738705, 105: 0.040842113766152495, 107: 0.014053792917165018, 110: 0.07154957786469243, 113: 0.45060491313380807, 119: 0.019378488853131513},[98, 113, 84, 97, 53, 27, 11, 51, 103, 87, 110, 7, 6, 50, 105, 81, 119, 93, 107, 14, 70, 85, 5, 79, 58, 67, 60]
2021-08-18:15:55:10,947 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:55:10,947 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:10,948 INFO     [oort.py:398] At round 103, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 712.2932995772767, 'duration': 30.380154975061778, 'time_stamp': 104, 'count': 98, 'status': True, 'gradient': 11.761681327485114}, [1.0, -2.8846431215684793e-06]), ({'reward': 61.156285675995576, 'duration': 12.029357192292537, 'time_stamp': 104, 'count': 101, 'status': True, 'gradient': 27.403680495323197}, [0.08584547026980663, -2.8846431215684793e-06]), ({'reward': 473.5738898138368, 'duration': 13.411352670399307, 'time_stamp': 104, 'count': 101, 'status': True, 'gradient': 18.27421203355319}, [0.664853287233258, -2.8846431215684793e-06])]
2021-08-18:15:55:10,949 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:55:11,295 INFO     [param_server.py:553] For epoch: 105, median_reward: 264.47474924985096, dev: 264.47474924985096
2021-08-18:15:55:11,791 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.514, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:55:11,792 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1575.291, eval_time 0.4863, test_loss 2.514, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:55:11,848 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.593, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:55:11,849 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1575.3498, eval_time 0.5432, test_loss 2.593, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:55:11,853 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4147, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:55:11,854 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1575.3545, eval_time 0.5441, test_loss 2.4147, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:55:11,880 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:11,891 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:11,919 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:11,928 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:11,948 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:11,956 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:13,108 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:13,117 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:14,161 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:14,170 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:14,561 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:14,571 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:15,13 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:15,54 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:15,237 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:15,248 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:16,476 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:16,516 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:16,674 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:16,686 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:17,267 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:17,306 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:55:17,384 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:17,425 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:17,844 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:17,872 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:18,31 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:55:18,71 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:18,508 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:18,528 INFO     [learner.py:606] ====Pushing takes 0.018156766891479492 s
2021-08-18:15:55:18,558 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:18,569 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:55:18,570 INFO     [param_server.py:410] Lock worker 1 with localStep 105 , while globalStep is 104

2021-08-18:15:55:18,621 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:18,634 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:20,388 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:20,407 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:21,73 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:21,89 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:21,139 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:21,154 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:21,716 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:21,744 INFO     [learner.py:606] ====Pushing takes 0.02731180191040039 s
2021-08-18:15:55:21,756 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:21,767 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:21,783 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:21,791 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:55:21,792 INFO     [param_server.py:410] Lock worker 2 with localStep 105 , while globalStep is 104

2021-08-18:15:55:22,395 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:22,404 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:23,25 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:23,61 INFO     [learner.py:606] ====Pushing takes 0.03464317321777344 s
2021-08-18:15:55:23,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:23,110 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:23,111 INFO     [param_server.py:381] ====After aggregation in epoch: 104, virtual_clock: 3406.701042061026, top_1: : 59.2126 % (1835.0), top_5: : 100.0 % (3099.0), test loss: 2.5072670689335577, test len: 3099.0
2021-08-18:15:55:23,113 INFO     [param_server.py:410] Lock worker 3 with localStep 105 , while globalStep is 105

2021-08-18:15:55:23,114 INFO     [param_server.py:441] ====Epoch 106 completes 20 clients with loss 7.161970045267282, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:23,114 INFO     [param_server.py:450] ====Start to sample for epoch 106, global virtualClock: 3406.701042061026, round_duration: 38.39602155878561
2021-08-18:15:55:23,115 INFO     [oort.py:208] Training selector: Pacer 104: lastExploitationUtil 326.5189431829497, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:55:23,116 INFO     [oort.py:321] scores are 26,{5: 0.013272347937543347, 6: 0.05251351293830728, 7: 0.3712168996305039, 11: 0.07199578093311138, 14: 0.012193422009228943, 27: 0.08470846167851513, 50: 0.024233971742105544, 51: 0.05142436497743938, 53: 0.459257326722548, 58: 0.005042760247898527, 60: 0.0017897273325125323, 67: 0.0027542927429633577, 70: 0.010751793671058446, 79: 0.06544152490378587, 81: 0.04871148071671594, 84: 0.3191637184471535, 85: 0.010180701335003903, 87: 0.05324808393164471, 93: 0.10475964045450127, 97: 0.3777323964483935, 98: 0.3915895245676246, 103: 0.06650952115436928, 105: 0.05058430546037924, 107: 0.014623709334295621, 110: 0.04058574016369818, 113: 0.16578689175121344, 119: 0.020164334994573728},[53, 98, 97, 7, 84, 113, 93, 27, 11, 103, 79, 87, 6, 51, 105, 81, 110, 50, 119, 107, 5, 14, 70, 85, 58, 67, 60]
2021-08-18:15:55:23,117 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:55:23,118 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:23,118 INFO     [oort.py:398] At round 104, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 504.9107323093044, 'duration': 13.411352670399307, 'time_stamp': 105, 'count': 102, 'status': True, 'gradient': 18.28285545740019}, [0.5629875981120285, -2.8571700682863672e-06]), ({'reward': 273.2807891979504, 'duration': 5.8943907365129, 'time_stamp': 105, 'count': 102, 'status': True, 'gradient': 21.43046352635101}, [0.30470953591975614, -2.8571700682863672e-06]), ({'reward': 712.7401434655111, 'duration': 15.972045438625893, 'time_stamp': 105, 'count': 102, 'status': True, 'gradient': 21.219941485973123}, [0.7947269702284433, -2.8571700682863672e-06])]
2021-08-18:15:55:23,119 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:55:23,458 INFO     [param_server.py:553] For epoch: 106, median_reward: 281.03027657514576, dev: 281.03027657514576
2021-08-18:15:55:24,96 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8797, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:55:24,96 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1587.5967, eval_time 0.6134, test_loss 2.8797, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:55:24,103 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4466, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:55:24,103 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1587.6039, eval_time 0.6206, test_loss 2.4466, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:55:24,165 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:24,173 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:24,172 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5353, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:55:24,175 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1587.6738, eval_time 0.6948, test_loss 2.5353, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:55:24,216 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:24,224 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:24,267 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:24,286 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:25,499 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:25,508 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:26,92 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:26,102 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:26,515 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:26,524 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:27,71 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:27,81 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:27,797 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:27,824 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:28,269 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:28,284 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:28,882 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:28,896 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:28,956 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:28,965 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:29,61 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:29,94 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:29,550 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:29,564 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:29,741 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:29,768 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:55:30,319 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:55:30,399 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:30,690 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:30,710 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:30,777 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:30,786 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:30,932 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:30,960 INFO     [learner.py:606] ====Pushing takes 0.026854991912841797 s
2021-08-18:15:55:30,992 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:30,998 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:55:30,998 INFO     [param_server.py:410] Lock worker 1 with localStep 106 , while globalStep is 105

2021-08-18:15:55:31,248 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:31,262 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:31,351 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:31,362 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:31,844 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:31,856 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:32,323 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:32,360 INFO     [learner.py:606] ====Pushing takes 0.03549337387084961 s
2021-08-18:15:55:32,398 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:32,407 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:55:32,407 INFO     [param_server.py:410] Lock worker 3 with localStep 106 , while globalStep is 105

2021-08-18:15:55:32,475 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:32,501 INFO     [learner.py:606] ====Pushing takes 0.02459096908569336 s
2021-08-18:15:55:32,532 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:32,539 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:32,540 INFO     [param_server.py:381] ====After aggregation in epoch: 105, virtual_clock: 3434.7168975565146, top_1: : 57.7928 % (1791.0), top_5: : 100.0 % (3099.0), test loss: 2.6205253998438516, test len: 3099.0
2021-08-18:15:55:32,542 INFO     [param_server.py:410] Lock worker 2 with localStep 106 , while globalStep is 106

2021-08-18:15:55:32,542 INFO     [param_server.py:441] ====Epoch 107 completes 20 clients with loss 8.407988736448429, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:32,543 INFO     [param_server.py:450] ====Start to sample for epoch 107, global virtualClock: 3434.7168975565146, round_duration: 28.015855495488744
2021-08-18:15:55:32,564 INFO     [oort.py:208] Training selector: Pacer 105: lastExploitationUtil 320.7013727032888, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:55:32,564 INFO     [oort.py:321] scores are 26,{5: 0.02352716777001348, 6: 0.1766341084454712, 7: 0.23186793573272663, 11: 0.018094666399815138, 14: 0.00962590090714944, 27: 0.06868153043572, 50: 0.0405835477560619, 51: 0.051233920996350026, 53: 0.060622839380798745, 58: 0.0039809259786173085, 60: 0.0017764370301307484, 67: 0.0022081006403915516, 70: 0.008487830600252447, 79: 0.005775576907568926, 81: 0.08318671510940102, 84: 0.19626663418603538, 85: 0.03997213262861906, 87: 0.0884552637474262, 93: 0.0238178668275539, 97: 0.20102296210853848, 98: 0.6632883319602667, 103: 0.013272713548484513, 105: 0.03848374535737454, 107: 0.011544452151360206, 110: 0.04469015170419495, 112: 0.4107994369331711, 113: 0.5151163310258788, 119: 0.015918409972969224},[98, 113, 112, 7, 97, 84, 6, 87, 81, 27, 53, 51, 110, 50, 85, 105, 93, 5, 11, 119, 103, 107, 14, 70, 79, 58, 67, 60]
2021-08-18:15:55:32,565 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:55:32,565 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:32,566 INFO     [oort.py:398] At round 105, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 459.4768345758742, 'duration': 15.972045438625893, 'time_stamp': 106, 'count': 103, 'status': True, 'gradient': 21.23195948429153}, [0.3920736682625246, -2.830215379390374e-06]), ({'reward': 228.3695930325169, 'duration': 27.035726288496562, 'time_stamp': 106, 'count': 96, 'status': True, 'gradient': 11.772229717048615}, [0.1948645224370431, -2.830215379390374e-06]), ({'reward': 194.08287183609295, 'duration': 5.8943907365129, 'time_stamp': 106, 'count': 103, 'status': True, 'gradient': 21.441532869271555}, [0.1656068715077681, -2.830215379390374e-06])]
2021-08-18:15:55:32,568 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:55:32,870 INFO     [param_server.py:553] For epoch: 107, median_reward: 280.430770368785, dev: 280.430770368785
2021-08-18:15:55:33,511 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9129, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:55:33,512 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1597.011, eval_time 0.6002, test_loss 2.9129, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:55:33,560 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4415, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:55:33,561 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1597.0616, eval_time 0.6488, test_loss 2.4415, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:55:33,591 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7236, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:55:33,592 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1597.0929, eval_time 0.6802, test_loss 2.7236, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:55:33,595 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:33,618 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:33,651 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:33,662 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:33,663 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:33,674 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:34,915 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:34,924 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:35,885 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:35,894 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:36,407 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:36,416 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:36,535 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:36,555 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:37,97 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:37,107 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:37,695 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:37,722 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:38,397 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:38,430 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:55:38,834 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:38,852 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:39,78 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:55:39,105 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:39,471 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:39,491 INFO     [learner.py:606] ====Pushing takes 0.01819467544555664 s
2021-08-18:15:55:39,521 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:39,529 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:55:39,530 INFO     [param_server.py:410] Lock worker 1 with localStep 107 , while globalStep is 106

2021-08-18:15:55:39,631 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:39,643 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:40,52 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:40,62 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:40,653 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:40,662 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:42,248 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:42,262 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:42,792 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:42,801 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:42,994 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:43,21 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:43,452 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:43,472 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:43,530 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:43,555 INFO     [learner.py:606] ====Pushing takes 0.024766206741333008 s
2021-08-18:15:55:43,595 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:43,602 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:55:43,603 INFO     [param_server.py:410] Lock worker 2 with localStep 107 , while globalStep is 106

2021-08-18:15:55:44,19 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:44,28 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:44,634 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:44,670 INFO     [learner.py:606] ====Pushing takes 0.03460073471069336 s
2021-08-18:15:55:44,703 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:44,711 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:44,712 INFO     [param_server.py:381] ====After aggregation in epoch: 106, virtual_clock: 3473.1129191153004, top_1: : 58.7286 % (1820.0), top_5: : 100.0 % (3099.0), test loss: 2.6926666630638967, test len: 3099.0
2021-08-18:15:55:44,714 INFO     [param_server.py:410] Lock worker 3 with localStep 107 , while globalStep is 107

2021-08-18:15:55:44,715 INFO     [param_server.py:441] ====Epoch 108 completes 20 clients with loss 7.079780473362678, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:44,715 INFO     [param_server.py:450] ====Start to sample for epoch 108, global virtualClock: 3473.1129191153004, round_duration: 38.39602155878561
2021-08-18:15:55:44,716 INFO     [oort.py:208] Training selector: Pacer 106: lastExploitationUtil 315.47565530955853, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:55:44,716 INFO     [oort.py:321] scores are 26,{5: 0.10252505715957047, 6: 0.05212698420612245, 7: 0.06601784350351327, 11: 0.02788533174243472, 14: 0.011120643559487085, 27: 0.060778999770171295, 50: 0.03500289527792862, 51: 0.051045852981460534, 53: 0.060400306792279444, 58: 0.004666112433485644, 60: 0.0020821926753022487, 67: 0.002511969800585484, 70: 0.009805849822182196, 79: 0.04366568038357913, 81: 0.09750980417876633, 84: 0.041768008715552946, 85: 0.03199985063298255, 87: 0.12535502407894167, 93: 0.015780522013623854, 97: 0.30112415843831597, 98: 0.6631370253612525, 103: 0.051356528125194825, 105: 0.04833022451327746, 107: 0.013337113970233976, 110: 0.037842782983330374, 113: 0.06601784350351327, 119: 0.01839027484811266},[98, 97, 87, 5, 81, 7, 113, 27, 53, 6, 103, 51, 105, 79, 84, 110, 50, 85, 11, 119, 93, 107, 14, 70, 58, 67, 60]
2021-08-18:15:55:44,717 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:55:44,717 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:44,718 INFO     [oort.py:398] At round 106, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 965.6830622391867, 'duration': 13.411352670399307, 'time_stamp': 107, 'count': 104, 'status': True, 'gradient': 18.29613250824622}, [1.0, -2.8037645211637515e-06]), ({'reward': 599.2572673297406, 'duration': 15.972045438625893, 'time_stamp': 107, 'count': 104, 'status': True, 'gradient': 21.236720242363802}, [0.6205488115560848, -2.8037645211637515e-06]), ({'reward': 710.0201866758156, 'duration': 29.570969934622333, 'time_stamp': 107, 'count': 91, 'status': True, 'gradient': 20.188857872543498}, [0.735249037264191, -2.8037645211637515e-06])]
2021-08-18:15:55:44,718 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:55:45,10 INFO     [param_server.py:553] For epoch: 108, median_reward: 279.293605228759, dev: 279.293605228759
2021-08-18:15:55:45,680 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4772, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:15:55:45,681 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1609.1818, eval_time 0.6367, test_loss 2.4772, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:15:55:45,682 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6037, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:15:55:45,682 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1609.1828, eval_time 0.638, test_loss 2.6037, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:15:55:45,718 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3969, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:55:45,720 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1609.2191, eval_time 0.6762, test_loss 2.3969, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:55:45,752 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:55:45,753 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:55:45,760 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:45,762 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:45,791 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:55:45,810 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:46,854 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:46,863 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:47,476 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:47,490 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:47,906 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:47,916 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:48,667 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:48,676 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:48,834 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:48,855 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:49,762 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:49,771 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:50,111 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:50,137 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:50,343 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:50,356 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:50,405 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:50,414 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:50,913 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:50,918 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:50,927 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:50,940 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:55:51,580 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:55:51,608 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:51,958 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:51,967 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:52,175 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:52,204 INFO     [learner.py:606] ====Pushing takes 0.028069734573364258 s
2021-08-18:15:55:52,237 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:52,243 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:55:52,244 INFO     [param_server.py:410] Lock worker 1 with localStep 108 , while globalStep is 107

2021-08-18:15:55:52,507 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:52,518 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:52,581 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:52,591 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:53,161 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:53,173 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:53,728 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:53,747 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:54,4 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:54,30 INFO     [learner.py:606] ====Pushing takes 0.023888111114501953 s
2021-08-18:15:55:54,64 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:54,75 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:55:54,75 INFO     [param_server.py:410] Lock worker 2 with localStep 108 , while globalStep is 107

2021-08-18:15:55:54,224 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:54,264 INFO     [learner.py:606] ====Pushing takes 0.0387420654296875 s
2021-08-18:15:55:54,302 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:54,310 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:54,311 INFO     [param_server.py:381] ====After aggregation in epoch: 107, virtual_clock: 3501.796322138316, top_1: : 61.8909 % (1918.0), top_5: : 100.0 % (3099.0), test loss: 2.4925846656163535, test len: 3099.0
2021-08-18:15:55:54,314 INFO     [param_server.py:410] Lock worker 3 with localStep 108 , while globalStep is 108

2021-08-18:15:55:54,314 INFO     [param_server.py:441] ====Epoch 109 completes 20 clients with loss 7.389592661144947, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:54,315 INFO     [param_server.py:450] ====Start to sample for epoch 109, global virtualClock: 3501.796322138316, round_duration: 28.683403023015895
2021-08-18:15:55:54,315 INFO     [oort.py:208] Training selector: Pacer 107: lastExploitationUtil 285.9878106916919, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:55:54,316 INFO     [oort.py:321] scores are 26,{5: 0.00841648919048054, 6: 0.051937304007338606, 7: 0.06577761710504158, 11: 0.12881601575480572, 14: 0.01138462153787744, 27: 0.10655123797350569, 50: 0.009987907296489575, 51: 0.10388680545307157, 53: 0.4742061082309678, 58: 0.004708269498515298, 60: 0.002317536483529316, 67: 0.002571598068157326, 70: 0.010038617683017982, 79: 0.0111627471256679, 81: 0.14854038974177713, 84: 0.2692530528783096, 85: 0.052545743926481515, 87: 0.05955538996877623, 93: 0.13150337207064716, 97: 0.4674438919632533, 98: 0.579510845646048, 103: 0.0058618525893986044, 105: 0.050526580550006736, 107: 0.013653705754206819, 110: 0.046127468984800774, 113: 0.07294542450110875, 119: 0.018826816811757047},[98, 53, 97, 84, 81, 93, 11, 27, 51, 113, 7, 87, 85, 6, 105, 110, 119, 107, 14, 79, 70, 50, 5, 103, 58, 67, 60]
2021-08-18:15:55:54,317 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:55:54,318 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:54,318 INFO     [oort.py:398] At round 107, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 108, 'count': 106, 'status': True, 'gradient': 21.140043920925287}, [1.1757609648836604e-08, -2.777803498180541e-06]), ({'reward': 294.5891950885645, 'duration': 17.619275735353515, 'time_stamp': 108, 'count': 104, 'status': True, 'gradient': 15.146624865837282}, [0.34635473040960635, -2.777803498180541e-06]), ({'reward': 6.106313460088472, 'duration': 8.009219946401625, 'time_stamp': 108, 'count': 32, 'status': True, 'gradient': 21.24596308748444}, [0.007167819153676809, -2.777803498180541e-06])]
2021-08-18:15:55:54,319 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:55:54,659 INFO     [param_server.py:553] For epoch: 109, median_reward: 272.86098973117953, dev: 272.86098973117953
2021-08-18:15:55:55,250 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4396, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:55:55,251 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1618.7515, eval_time 0.5364, test_loss 2.4396, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:55:55,318 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:55:55,327 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:55,335 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9155, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:55:55,335 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1618.8358, eval_time 0.6209, test_loss 2.9155, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:55:55,364 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6221, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:55:55,366 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1618.8644, eval_time 0.6514, test_loss 2.6221, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:55:55,392 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:55:55,410 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:55,454 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:55:55,487 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:56,739 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:56,753 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:57,985 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:57,988 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:57,999 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:58,6 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:58,681 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:58,704 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:59,191 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:59,206 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:59,719 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:59,728 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:00,221 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:00,236 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:56:00,316 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:00,327 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:00,752 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:56:00,770 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:01,42 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:01,62 INFO     [learner.py:606] ====Pushing takes 0.019338369369506836 s
2021-08-18:15:56:01,96 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:01,105 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:56:01,106 INFO     [param_server.py:410] Lock worker 1 with localStep 109 , while globalStep is 108

2021-08-18:15:56:01,321 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:01,330 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:01,349 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:01,358 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:01,920 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:01,931 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:03,869 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:03,879 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:04,95 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:04,105 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:04,536 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:04,546 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:04,700 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:04,710 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:05,49 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:05,76 INFO     [learner.py:606] ====Pushing takes 0.025690317153930664 s
2021-08-18:15:56:05,112 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:05,121 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:56:05,122 INFO     [param_server.py:410] Lock worker 2 with localStep 109 , while globalStep is 108

2021-08-18:15:56:05,293 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:05,307 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:05,855 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:05,891 INFO     [learner.py:606] ====Pushing takes 0.03456401824951172 s
2021-08-18:15:56:05,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:05,935 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:05,935 INFO     [param_server.py:381] ====After aggregation in epoch: 108, virtual_clock: 3540.192343697102, top_1: : 59.9226 % (1857.0), top_5: : 100.0 % (3099.0), test loss: 2.6590739621056447, test len: 3099.0
2021-08-18:15:56:05,938 INFO     [param_server.py:410] Lock worker 3 with localStep 109 , while globalStep is 109

2021-08-18:15:56:05,938 INFO     [param_server.py:441] ====Epoch 110 completes 20 clients with loss 6.09388690596063, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:05,938 INFO     [param_server.py:450] ====Start to sample for epoch 110, global virtualClock: 3540.192343697102, round_duration: 38.39602155878561
2021-08-18:15:56:05,939 INFO     [oort.py:208] Training selector: Pacer 108: lastExploitationUtil 321.06466124787994, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:56:05,940 INFO     [oort.py:321] scores are 26,{5: 0.05991911708354423, 6: 0.09049689943823058, 7: 0.0655403271907378, 11: 0.04996275423081148, 14: 0.010542547724129539, 27: 0.03930309370954509, 50: 0.02110242642095888, 51: 0.05067663117407314, 53: 0.07732070911786602, 58: 0.004360018092917244, 60: 0.0019456020116677489, 67: 0.002168949470967875, 70: 0.009296102260000055, 79: 0.026085337980728332, 81: 0.10328943457483972, 84: 0.47329705773175873, 85: 0.010032669277952778, 87: 0.02417259600050985, 93: 0.1366296281038916, 97: 0.2993474759304578, 98: 0.24337933525351788, 103: 0.0949569252420884, 105: 0.056762353537545, 107: 0.012643797077138912, 110: 0.019079816813686423, 113: 0.2630336369919618, 119: 0.017434274303368566},[84, 97, 113, 98, 93, 81, 103, 6, 53, 7, 5, 105, 51, 11, 27, 79, 87, 50, 110, 119, 107, 14, 85, 70, 58, 67, 60]
2021-08-18:15:56:05,941 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:56:05,941 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:05,942 INFO     [oort.py:398] At round 108, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 645.7712872800848, 'duration': 15.972045438625893, 'time_stamp': 109, 'count': 106, 'status': True, 'gradient': 21.251987386899174}, [0.6169754699246729, -2.7523188286131087e-06]), ({'reward': 529.6704268948039, 'duration': 21.635252629006885, 'time_stamp': 109, 'count': 60, 'status': True, 'gradient': 21.87900299704189}, [0.5060499883317445, -2.7523188286131087e-06]), ({'reward': 714.4004792389226, 'duration': 13.298442137908651, 'time_stamp': 109, 'count': 106, 'status': True, 'gradient': 21.25439995792847}, [0.6825454075126007, -2.7523188286131087e-06])]
2021-08-18:15:56:05,943 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:56:06,273 INFO     [param_server.py:553] For epoch: 110, median_reward: 280.1717224530183, dev: 280.1717224530183
2021-08-18:15:56:06,870 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1836, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:56:06,871 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1630.3719, eval_time 0.5428, test_loss 2.1836, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:56:06,892 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.296, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:15:56:06,893 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1630.3937, eval_time 0.5649, test_loss 2.296, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:15:56:06,966 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:06,967 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:06,965 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4008, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:56:06,968 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1630.4667, eval_time 0.6408, test_loss 2.4008, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:56:06,979 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:06,980 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:07,60 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:07,84 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:08,154 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:08,168 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:08,759 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:08,779 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:09,169 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:09,178 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:10,102 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:10,117 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:10,234 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:10,247 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:10,863 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:10,877 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:11,433 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:11,447 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:11,478 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:11,488 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:11,807 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:11,826 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:12,81 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:12,90 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:12,121 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:12,142 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:56:12,646 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:56:12,673 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:13,64 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:13,95 INFO     [learner.py:606] ====Pushing takes 0.03040909767150879 s
2021-08-18:15:56:13,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:13,137 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:56:13,138 INFO     [param_server.py:410] Lock worker 1 with localStep 110 , while globalStep is 109

2021-08-18:15:56:13,512 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:13,521 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:13,535 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:13,545 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:14,44 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:14,53 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:14,61 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:14,91 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:14,660 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:14,671 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:15,225 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:15,229 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:15,255 INFO     [learner.py:606] ====Pushing takes 0.02509784698486328 s
2021-08-18:15:56:15,275 INFO     [learner.py:606] ====Pushing takes 0.048400163650512695 s
2021-08-18:15:56:15,304 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:15,312 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:56:15,313 INFO     [param_server.py:410] Lock worker 2 with localStep 110 , while globalStep is 109

2021-08-18:15:56:15,339 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:15,348 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:15,348 INFO     [param_server.py:381] ====After aggregation in epoch: 109, virtual_clock: 3568.8757467201176, top_1: : 61.0197 % (1891.0), top_5: : 100.0 % (3099.0), test loss: 2.2934689168576843, test len: 3099.0
2021-08-18:15:56:15,351 INFO     [param_server.py:410] Lock worker 3 with localStep 110 , while globalStep is 110

2021-08-18:15:56:15,352 INFO     [param_server.py:441] ====Epoch 111 completes 20 clients with loss 5.597839144806201, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:15,352 INFO     [param_server.py:450] ====Start to sample for epoch 111, global virtualClock: 3568.8757467201176, round_duration: 28.683403023015895
2021-08-18:15:56:15,353 INFO     [oort.py:208] Training selector: Pacer 109: lastExploitationUtil 301.2983292465899, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:56:15,353 INFO     [oort.py:321] scores are 26,{5: 0.053356821676876214, 6: 0.05156485716644843, 7: 0.26305403473381367, 11: 0.022008923107139658, 14: 0.011659120091068774, 27: 0.057498727028300806, 50: 0.06253455041291464, 51: 0.23503059735584333, 53: 0.5022188007578955, 58: 0.004821792215197393, 60: 0.002271995750381038, 67: 0.002633602759903138, 70: 0.01028066227104942, 79: 0.008403004725517124, 81: 0.07855907652068501, 84: 0.24927834191205664, 85: 0.08355288345678057, 87: 0.13628432252922532, 93: 0.04261722329723499, 97: 0.4172555007250454, 98: 0.22598941228694355, 103: 0.07490908076642377, 105: 0.018130424287178665, 107: 0.013982914982880814, 110: 0.00953059417979528, 113: 0.16589705186720533, 119: 0.019280756712950205},[53, 97, 7, 84, 51, 98, 113, 87, 85, 81, 103, 50, 27, 5, 6, 93, 11, 119, 105, 107, 14, 70, 110, 79, 58, 67, 60]
2021-08-18:15:56:15,354 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:56:15,355 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:15,355 INFO     [oort.py:398] At round 109, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 420.64188427515484, 'duration': 11.058674649423494, 'time_stamp': 110, 'count': 107, 'status': True, 'gradient': 20.21353914778026}, [0.48362180299172236, -2.727297520886556e-06]), ({'reward': 417.94342868160516, 'duration': 27.035726288496562, 'time_stamp': 110, 'count': 100, 'status': True, 'gradient': 11.79093332239266}, [0.48051925186041916, -2.727297520886556e-06]), ({'reward': 172.00217134596417, 'duration': 5.8943907365129, 'time_stamp': 110, 'count': 107, 'status': True, 'gradient': 21.47420579235978}, [0.19774812603393105, -2.727297520886556e-06])]
2021-08-18:15:56:15,356 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:56:15,690 INFO     [param_server.py:553] For epoch: 111, median_reward: 276.181308926355, dev: 276.181308926355
2021-08-18:15:56:16,321 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3791, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:15:56:16,321 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1639.8219, eval_time 0.5658, test_loss 2.3791, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:15:56:16,354 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6527, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:56:16,355 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1639.8558, eval_time 0.5998, test_loss 2.6527, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:56:16,398 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:16,407 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:16,427 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:16,452 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:16,460 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3329, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:56:16,461 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1639.9594, eval_time 0.7052, test_loss 2.3329, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:56:16,543 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:16,584 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:17,751 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:17,771 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:19,95 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:19,101 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:19,107 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:19,112 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:19,758 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:19,778 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:20,323 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:20,337 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:20,815 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:20,828 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:21,362 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:21,368 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:21,373 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:21,386 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:56:21,905 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:56:21,919 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:22,198 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:22,220 INFO     [learner.py:606] ====Pushing takes 0.020490646362304688 s
2021-08-18:15:56:22,255 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:22,263 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:56:22,264 INFO     [param_server.py:410] Lock worker 1 with localStep 111 , while globalStep is 110

2021-08-18:15:56:22,479 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:22,490 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:22,744 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:22,757 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:23,140 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:23,149 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:25,287 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:25,298 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:25,452 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:25,461 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:25,954 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:25,966 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:26,55 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:26,69 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:26,569 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:26,595 INFO     [learner.py:606] ====Pushing takes 0.0248870849609375 s
2021-08-18:15:56:26,608 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:26,619 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:26,633 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:26,641 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:56:26,642 INFO     [param_server.py:410] Lock worker 2 with localStep 111 , while globalStep is 110

2021-08-18:15:56:27,206 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:27,243 INFO     [learner.py:606] ====Pushing takes 0.03566598892211914 s
2021-08-18:15:56:27,277 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:27,285 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:27,286 INFO     [param_server.py:381] ====After aggregation in epoch: 110, virtual_clock: 3607.2717682789034, top_1: : 61.3101 % (1900.0), top_5: : 100.0 % (3099.0), test loss: 2.4548692673582724, test len: 3099.0
2021-08-18:15:56:27,288 INFO     [param_server.py:410] Lock worker 3 with localStep 111 , while globalStep is 111

2021-08-18:15:56:27,289 INFO     [param_server.py:441] ====Epoch 112 completes 20 clients with loss 7.3052899735712025, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:27,289 INFO     [param_server.py:450] ====Start to sample for epoch 112, global virtualClock: 3607.2717682789034, round_duration: 38.39602155878561
2021-08-18:15:56:27,290 INFO     [oort.py:208] Training selector: Pacer 110: lastExploitationUtil 367.08450652221734, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:56:27,291 INFO     [oort.py:321] scores are 26,{3: 0.042502275084564195, 5: 0.09314011053192857, 6: 0.051381993906790116, 7: 0.07692618121447935, 11: 0.05524077812089959, 14: 0.010472410779240264, 27: 0.08507230820907544, 50: 0.0038199298148916187, 51: 0.05031631403207574, 53: 0.4119569473913289, 58: 0.0043310119781999, 60: 0.0019326584059436334, 67: 0.0020180865730886474, 70: 0.00923425760641576, 79: 0.008548791681982214, 81: 0.1562622105373047, 84: 0.3435243698070675, 85: 0.011473836581705272, 87: 0.02505754757451781, 93: 0.083629020307606, 97: 0.3121401636196196, 98: 0.6625500941380505, 103: 0.07001003656213788, 105: 0.03221779813742396, 107: 0.012559681043520133, 110: 0.009496796054211953, 113: 0.136111861422143, 119: 0.01731828841760386},[98, 53, 84, 97, 81, 113, 5, 27, 93, 7, 103, 11, 6, 51, 3, 105, 87, 119, 107, 85, 14, 110, 70, 79, 58, 50, 67, 60]
2021-08-18:15:56:27,292 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:56:27,293 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:27,293 INFO     [oort.py:398] At round 110, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1204.5896970970255, 'duration': 13.411352670399307, 'time_stamp': 111, 'count': 108, 'status': True, 'gradient': 18.327351216962676}, [1.0, -2.7027270515950618e-06]), ({'reward': 778.9020070161976, 'duration': 15.972045438625893, 'time_stamp': 111, 'count': 108, 'status': True, 'gradient': 21.27136325055304}, [0.6466089478572463, -2.7027270515950618e-06]), ({'reward': 766.9400832923492, 'duration': 30.380154975061778, 'time_stamp': 111, 'count': 105, 'status': True, 'gradient': 15.166173159340111}, [0.6366785765805493, -2.7027270515950618e-06])]
2021-08-18:15:56:27,294 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 105]
2021-08-18:15:56:27,628 INFO     [param_server.py:553] For epoch: 112, median_reward: 290.2703154243417, dev: 290.2703154243417
2021-08-18:15:56:28,354 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5363, Top-1 Accuracy: 591.0/1033 (0.5721), Top-5 Accuracy: 1.0
2021-08-18:15:56:28,355 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1651.8555, eval_time 0.6771, test_loss 2.5363, test_accuracy 0.5721, test_5_accuracy 1.0 

2021-08-18:15:56:28,423 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:28,431 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:28,436 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6289, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:56:28,436 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1651.9366, eval_time 0.7608, test_loss 2.6289, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:56:28,504 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:28,514 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6989, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:56:28,517 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1652.0159, eval_time 0.8447, test_loss 2.6989, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:56:28,521 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:28,587 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:28,623 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:29,763 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:29,776 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:30,446 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:30,460 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:30,609 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:30,618 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:31,682 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:31,692 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:31,818 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:31,839 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:32,372 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:32,382 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:32,975 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:32,985 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:56:33,11 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:33,32 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:33,495 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:33,513 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:33,611 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:56:33,622 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:33,702 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:33,729 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:56:34,139 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:34,150 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:34,425 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:56:34,445 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:34,928 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:34,967 INFO     [learner.py:606] ====Pushing takes 0.03669929504394531 s
2021-08-18:15:56:34,997 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:35,3 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:56:35,4 INFO     [param_server.py:410] Lock worker 1 with localStep 112 , while globalStep is 111

2021-08-18:15:56:35,217 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:35,227 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:35,713 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:35,723 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:35,724 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:35,748 INFO     [learner.py:606] ====Pushing takes 0.02387094497680664 s
2021-08-18:15:56:35,775 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:35,782 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:35,797 INFO     [param_server.py:410] Lock worker 2 with localStep 112 , while globalStep is 111

2021-08-18:15:56:36,242 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:36,252 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:36,865 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:36,877 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:37,456 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:37,498 INFO     [learner.py:606] ====Pushing takes 0.040250539779663086 s
2021-08-18:15:56:37,538 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:37,549 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:37,550 INFO     [param_server.py:381] ====After aggregation in epoch: 111, virtual_clock: 3635.955171301919, top_1: : 57.9219 % (1795.0), top_5: : 100.0 % (3099.0), test loss: 2.6213848988215127, test len: 3099.0
2021-08-18:15:56:37,552 INFO     [param_server.py:410] Lock worker 3 with localStep 112 , while globalStep is 112

2021-08-18:15:56:37,553 INFO     [param_server.py:441] ====Epoch 113 completes 20 clients with loss 8.75957243134165, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:37,553 INFO     [param_server.py:450] ====Start to sample for epoch 113, global virtualClock: 3635.955171301919, round_duration: 28.683403023015895
2021-08-18:15:56:37,554 INFO     [oort.py:208] Training selector: Pacer 111: lastExploitationUtil 289.07491276546733, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:56:37,555 INFO     [oort.py:321] scores are 26,{3: 0.024119712695803337, 5: 0.05716721205047883, 6: 0.25765959862526316, 7: 0.2700414795776647, 11: 0.03921696863758834, 14: 0.010804264795860073, 27: 0.054624571203463555, 50: 0.0038236054576515793, 51: 0.05013938314992139, 53: 0.26536891153295816, 58: 0.004468254849138773, 60: 0.0024420602494475033, 67: 0.002440505060660461, 70: 0.009526876521180429, 79: 0.018215791623808292, 81: 0.06780047367671514, 84: 0.5357711541396638, 85: 0.014817538932493301, 87: 0.050792345175218495, 93: 0.015500292253598396, 97: 0.46703507192418636, 98: 0.4323172792201818, 103: 0.07007681260603572, 105: 0.048229171157036586, 107: 0.012957677330107567, 110: 0.009463401785656422, 113: 0.30839098165204454, 119: 0.01786707739213061},[84, 97, 98, 113, 7, 53, 6, 103, 81, 5, 27, 87, 51, 105, 11, 3, 79, 119, 93, 85, 107, 14, 70, 110, 58, 50, 60, 67]
2021-08-18:15:56:37,556 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:56:37,556 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:37,557 INFO     [oort.py:398] At round 111, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 912.8085890568951, 'duration': 15.972045438625893, 'time_stamp': 112, 'count': 109, 'status': True, 'gradient': 21.285642859563985}, [1.0, -2.6785953446012936e-06]), ({'reward': 713.8055211856108, 'duration': 13.298442137908651, 'time_stamp': 112, 'count': 109, 'status': True, 'gradient': 18.545840374494954}, [0.7819857873610953, -2.6785953446012936e-06]), ({'reward': 112.53079165391341, 'duration': 17.619275735353515, 'time_stamp': 112, 'count': 108, 'status': True, 'gradient': 15.173886085783922}, [0.12327012965419762, -2.6785953446012936e-06])]
2021-08-18:15:56:37,558 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 105, 119]
2021-08-18:15:56:37,838 INFO     [param_server.py:553] For epoch: 113, median_reward: 273.91639202154596, dev: 273.91639202154596
2021-08-18:15:56:38,427 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4552, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:56:38,430 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1661.9309, eval_time 0.5463, test_loss 2.4552, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:56:38,479 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9131, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:56:38,480 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1661.9784, eval_time 0.5968, test_loss 2.9131, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:56:38,499 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:56:38,506 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:38,514 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7676, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:56:38,515 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1662.0153, eval_time 0.6318, test_loss 2.7676, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:56:38,577 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:56:38,592 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:56:38,601 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:38,603 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:39,893 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:39,908 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:40,925 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:40,939 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:41,207 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:41,217 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:41,741 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:41,762 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:42,782 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:42,795 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:42,829 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:42,849 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:43,409 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:43,430 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:56:43,605 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:43,615 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:43,962 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:56:43,989 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:44,149 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:44,170 INFO     [learner.py:606] ====Pushing takes 0.020140647888183594 s
2021-08-18:15:56:44,204 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:44,210 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:56:44,211 INFO     [param_server.py:410] Lock worker 1 with localStep 113 , while globalStep is 112

2021-08-18:15:56:44,227 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:44,236 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:56:44,815 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:56:44,824 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:44,960 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:44,969 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:45,469 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:45,479 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:45,559 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:45,572 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:56:46,140 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:56:46,164 INFO     [learner.py:606] ====Pushing takes 0.022661209106445312 s
2021-08-18:15:56:46,199 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:46,206 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:46,206 INFO     [param_server.py:410] Lock worker 2 with localStep 113 , while globalStep is 112

2021-08-18:15:56:47,47 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:47,58 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:47,667 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:47,679 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:48,210 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:48,222 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:48,899 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:48,937 INFO     [learner.py:606] ====Pushing takes 0.036733388900756836 s
2021-08-18:15:56:48,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:48,997 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:48,998 INFO     [param_server.py:381] ====After aggregation in epoch: 112, virtual_clock: 3669.0394092003266, top_1: : 60.5357 % (1876.0), top_5: : 100.0 % (3099.0), test loss: 2.7119496486805104, test len: 3099.0
2021-08-18:15:56:49,0 INFO     [param_server.py:410] Lock worker 3 with localStep 113 , while globalStep is 113

2021-08-18:15:56:49,1 INFO     [param_server.py:441] ====Epoch 114 completes 20 clients with loss 6.467433779752749, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:56:49,1 INFO     [param_server.py:450] ====Start to sample for epoch 114, global virtualClock: 3669.0394092003266, round_duration: 33.08423789840745
2021-08-18:15:56:49,2 INFO     [oort.py:208] Training selector: Pacer 112: lastExploitationUtil 348.75651672883214, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:56:49,2 INFO     [oort.py:321] scores are 26,{3: 0.21559333044191625, 5: 0.10003213481744377, 6: 0.32058739406858006, 7: 0.06461937719722281, 11: 0.015278629461974981, 14: 0.010934207077172381, 27: 0.022621240629141663, 31: 0.11090250924964426, 50: 0.003827244395834983, 51: 0.049964540692508996, 53: 0.974029641539126, 58: 0.004521994297361511, 60: 0.002017881810166983, 67: 0.00246985687692268, 70: 0.008274816415290877, 79: 0.04306592668777574, 81: 0.12102702803629889, 84: 0.3302420425642602, 85: 0.009891693681667162, 87: 0.10787477323933706, 93: 0.10435704422121043, 97: 0.3140372254241733, 103: 0.010770596950151756, 105: 0.041257225159149, 107: 0.013113518582112803, 110: 0.009430401690327413, 113: 0.11550598125304384, 119: 0.0030261573900898916},[53, 84, 6, 97, 3, 81, 113, 31, 87, 93, 5, 7, 51, 79, 105, 27, 11, 107, 14, 103, 85, 110, 70, 58, 50, 119, 67, 60]
2021-08-18:15:56:49,3 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:56:49,4 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:49,4 INFO     [oort.py:398] At round 112, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 644.8239293020874, 'duration': 26.145070720211294, 'time_stamp': 113, 'count': 105, 'status': True, 'gradient': 18.553570453274858}, [0.594426383377906, -2.6548907512455885e-06]), ({'reward': 706.6153193944507, 'duration': 15.972045438625893, 'time_stamp': 113, 'count': 110, 'status': True, 'gradient': 21.291571024796017}, [0.6513892222648133, -2.6548907512455885e-06]), ({'reward': 0.01, 'duration': 27.035726288496562, 'time_stamp': 113, 'count': 103, 'status': True, 'gradient': 15.179674732473819}, [9.218572167054227e-09, -2.6548907512455885e-06])]
2021-08-18:15:56:49,5 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 5, 27, 103, 79, 50, 105, 107]
2021-08-18:15:56:49,348 INFO     [param_server.py:553] For epoch: 114, median_reward: 288.08426455108594, dev: 288.08426455108594
2021-08-18:15:56:49,979 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2748, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:56:49,982 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1673.481, eval_time 0.6, test_loss 2.2748, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:56:50,26 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6159, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:15:56:50,27 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1673.5277, eval_time 0.6449, test_loss 2.6159, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:15:56:50,36 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3059, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:56:50,37 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1673.5371, eval_time 0.6542, test_loss 2.3059, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:56:50,94 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:56:50,96 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:56:50,104 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:50,105 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:56:50,113 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:50,116 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:51,337 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:51,358 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:52,592 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:52,610 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:52,801 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:52,810 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:53,246 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:53,267 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:54,393 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:54,414 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:55,9 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:55,30 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:56:55,111 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:55,136 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:55,179 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:55,192 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:55,611 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:56:55,638 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:55,876 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:55,890 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:56,21 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:56,42 INFO     [learner.py:606] ====Pushing takes 0.02017378807067871 s
2021-08-18:15:56:56,72 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:56,79 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:56:56,80 INFO     [param_server.py:410] Lock worker 1 with localStep 114 , while globalStep is 113

2021-08-18:15:56:56,288 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:56,297 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:56:56,960 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:56:56,970 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:57,638 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:57,649 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:58,234 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:58,248 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:56:58,710 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:56:58,736 INFO     [learner.py:606] ====Pushing takes 0.02431464195251465 s
2021-08-18:15:56:58,764 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:58,777 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:58,777 INFO     [param_server.py:410] Lock worker 2 with localStep 114 , while globalStep is 113

2021-08-18:15:57:00,154 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:00,172 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:00,889 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:00,899 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:01,537 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:01,546 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:02,56 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:02,94 INFO     [learner.py:606] ====Pushing takes 0.03630423545837402 s
2021-08-18:15:57:02,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:02,151 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:02,152 INFO     [param_server.py:381] ====After aggregation in epoch: 113, virtual_clock: 3709.458707744381, top_1: : 61.4714 % (1905.0), top_5: : 100.0 % (3099.0), test loss: 2.398863448037042, test len: 3099.0
2021-08-18:15:57:02,155 INFO     [param_server.py:410] Lock worker 3 with localStep 114 , while globalStep is 114

2021-08-18:15:57:02,155 INFO     [param_server.py:441] ====Epoch 115 completes 20 clients with loss 7.212511575639876, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 107: 0, 113: 0} 
==========
2021-08-18:15:57:02,156 INFO     [param_server.py:450] ====Start to sample for epoch 115, global virtualClock: 3709.458707744381, round_duration: 40.41929854405443
2021-08-18:15:57:02,156 INFO     [oort.py:208] Training selector: Pacer 113: lastExploitationUtil 364.121316580382, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:57:02,157 INFO     [oort.py:321] scores are 26,{3: 0.22203875949760882, 5: 0.08250384719228031, 6: 0.05084631895116426, 7: 0.22259235649486675, 11: 0.03533783382192555, 14: 0.011203899097140764, 27: 0.12903490144072594, 50: 0.01881928641412764, 51: 0.44668153389968807, 53: 0.3085993948760125, 58: 0.004633529204989794, 60: 0.0020676528285499753, 67: 0.0025307758521596426, 70: 0.00987926205725024, 79: 0.03591786222083176, 81: 0.02320951793643481, 84: 0.261840734458671, 85: 0.06513172922390534, 87: 0.014646727028716274, 93: 0.015392823270722528, 97: 0.1802330704048131, 103: 0.036674923249570855, 105: 0.05492226433658747, 107: 0.012400290563361775, 110: 0.009439280226284336, 113: 0.16109489106040062, 119: 0.0030290064571902647},[51, 53, 84, 7, 3, 97, 113, 27, 5, 85, 105, 6, 103, 79, 11, 81, 50, 93, 87, 107, 14, 70, 110, 58, 119, 67, 60]
2021-08-18:15:57:02,158 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:57:02,159 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:02,159 INFO     [oort.py:398] At round 113, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 106.30465341547531, 'duration': 8.009219946401625, 'time_stamp': 114, 'count': 38, 'status': True, 'gradient': 21.302484263742294}, [0.09669899507375325, -2.6316020315967705e-06]), ({'reward': 564.2453475914893, 'duration': 12.029357192292537, 'time_stamp': 114, 'count': 111, 'status': True, 'gradient': 27.527076550196192}, [0.5132994480721349, -2.6316020315967705e-06]), ({'reward': 380.93537086068926, 'duration': 15.972045438625893, 'time_stamp': 114, 'count': 111, 'status': True, 'gradient': 21.304519288259062}, [0.3465376373914233, -2.6316020315967705e-06])]
2021-08-18:15:57:02,160 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:57:02,493 INFO     [param_server.py:553] For epoch: 115, median_reward: 288.87639378589154, dev: 288.87639378589154
2021-08-18:15:57:03,66 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0955, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:57:03,67 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1686.5672, eval_time 0.5379, test_loss 3.0955, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:57:03,76 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.697, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:57:03,76 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1686.5768, eval_time 0.5477, test_loss 2.697, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:57:03,140 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:03,147 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:03,149 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:03,154 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7048, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:57:03,155 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1686.6535, eval_time 0.6272, test_loss 2.7048, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:57:03,156 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:03,245 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:03,271 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:04,343 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:04,359 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:05,694 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:05,708 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:05,828 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:05,841 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:06,536 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:06,556 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:07,843 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:07,871 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:07,883 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:07,892 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:08,62 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:08,72 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:08,653 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:08,679 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:57:09,30 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:09,40 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:09,359 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:57:09,393 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:09,582 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:09,594 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:10,133 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:10,154 INFO     [learner.py:606] ====Pushing takes 0.020061731338500977 s
2021-08-18:15:57:10,187 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:10,194 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:57:10,195 INFO     [param_server.py:410] Lock worker 1 with localStep 115 , while globalStep is 114

2021-08-18:15:57:10,213 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:10,222 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:10,703 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:10,717 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:11,512 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:11,533 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:12,77 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:12,100 INFO     [learner.py:606] ====Pushing takes 0.02160334587097168 s
2021-08-18:15:57:12,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:12,144 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:12,144 INFO     [param_server.py:410] Lock worker 2 with localStep 115 , while globalStep is 114

2021-08-18:15:57:12,420 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:12,431 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:13,58 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:13,72 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:13,733 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:13,746 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:14,278 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:14,316 INFO     [learner.py:606] ====Pushing takes 0.03578758239746094 s
2021-08-18:15:57:14,366 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:14,377 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:14,377 INFO     [param_server.py:381] ====After aggregation in epoch: 114, virtual_clock: 3747.854729303167, top_1: : 59.9548 % (1858.0), top_5: : 100.0 % (3099.0), test loss: 2.8324169406184443, test len: 3099.0
2021-08-18:15:57:14,380 INFO     [param_server.py:410] Lock worker 3 with localStep 115 , while globalStep is 115

2021-08-18:15:57:14,380 INFO     [param_server.py:441] ====Epoch 116 completes 20 clients with loss 7.5964677226616075, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:14,381 INFO     [param_server.py:450] ====Start to sample for epoch 116, global virtualClock: 3747.854729303167, round_duration: 38.39602155878561
2021-08-18:15:57:14,382 INFO     [oort.py:208] Training selector: Pacer 114: lastExploitationUtil 360.62697783792606, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:57:14,383 INFO     [oort.py:321] scores are 26,{3: 0.17643991880051593, 5: 0.011922386144172833, 6: 0.0506719176998168, 7: 0.14733387225431932, 11: 0.015173567653387942, 14: 0.00927615475263961, 27: 0.02639746942798827, 50: 0.009459722071397288, 51: 0.04962096504500474, 53: 0.38494361591776993, 58: 0.00383628356375767, 60: 0.0017118922123510816, 67: 0.002113452776585228, 70: 0.008179434935139762, 79: 0.0190172322109343, 81: 0.2272410894470128, 84: 0.258049141206857, 85: 0.07329524455507781, 87: 0.031921424172836464, 93: 0.015340026378134045, 97: 0.46674100812601277, 103: 0.05115150514275948, 105: 0.04104129788929635, 107: 0.011124997620838071, 110: 0.00936555457431129, 113: 0.35101052672605193, 119: 0.015340032662870194},[97, 53, 113, 84, 81, 3, 7, 85, 103, 6, 51, 105, 87, 27, 79, 119, 93, 11, 5, 107, 50, 110, 14, 70, 58, 67, 60]
2021-08-18:15:57:14,384 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:14,384 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:14,385 INFO     [oort.py:398] At round 114, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 1369.152153455403, 'duration': 15.972045438625893, 'time_stamp': 115, 'count': 112, 'status': True, 'gradient': 21.30933515513354}, [1.0, -2.608718336681191e-06]), ({'reward': 336.477767786595, 'duration': 42.701901101086094, 'time_stamp': 115, 'count': 77, 'status': True, 'gradient': 11.816720763064609}, [0.2457507969350874, -2.608718336681191e-06]), ({'reward': 561.6063247440196, 'duration': 17.343863580585587, 'time_stamp': 115, 'count': 6, 'status': True, 'gradient': 20.25724499970952}, [0.41018117017642514, -2.608718336681191e-06])]
2021-08-18:15:57:14,385 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:57:14,713 INFO     [param_server.py:553] For epoch: 116, median_reward: 294.187818226794, dev: 294.187818226794
2021-08-18:15:57:15,384 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5709, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:57:15,385 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1698.8851, eval_time 0.638, test_loss 2.5709, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:57:15,442 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4858, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:57:15,445 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1698.9452, eval_time 0.699, test_loss 2.4858, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:57:15,452 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:15,461 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:15,506 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6957, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:57:15,506 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1699.0051, eval_time 0.7607, test_loss 2.6957, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:57:15,536 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:15,553 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:15,598 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:15,617 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:16,616 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:16,626 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:17,193 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:17,202 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:17,612 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:17,622 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:18,385 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:18,397 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:18,693 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:18,714 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:19,343 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:19,354 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:19,889 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:19,916 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:19,916 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:19,925 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:20,159 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:20,169 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:20,512 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:20,521 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:20,602 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:20,636 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:57:20,696 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:20,710 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:21,99 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:21,109 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:21,340 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:57:21,373 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:21,827 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:21,855 INFO     [learner.py:606] ====Pushing takes 0.026930809020996094 s
2021-08-18:15:57:21,886 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:21,895 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:57:21,896 INFO     [param_server.py:410] Lock worker 1 with localStep 116 , while globalStep is 115

2021-08-18:15:57:22,200 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:22,224 INFO     [learner.py:606] ====Pushing takes 0.022281646728515625 s
2021-08-18:15:57:22,250 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:22,256 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:22,257 INFO     [param_server.py:410] Lock worker 2 with localStep 116 , while globalStep is 115

2021-08-18:15:57:22,520 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:22,537 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:23,125 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:23,139 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:23,718 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:23,732 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:24,325 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:24,365 INFO     [learner.py:606] ====Pushing takes 0.0383143424987793 s
2021-08-18:15:57:24,416 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:24,426 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:24,427 INFO     [param_server.py:381] ====After aggregation in epoch: 115, virtual_clock: 3775.8705847986557, top_1: : 61.1488 % (1895.0), top_5: : 100.0 % (3099.0), test loss: 2.584139664967855, test len: 3099.0
2021-08-18:15:57:24,429 INFO     [param_server.py:410] Lock worker 3 with localStep 116 , while globalStep is 116

2021-08-18:15:57:24,430 INFO     [param_server.py:441] ====Epoch 117 completes 20 clients with loss 8.81156613067262, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:24,430 INFO     [param_server.py:450] ====Start to sample for epoch 117, global virtualClock: 3775.8705847986557, round_duration: 28.015855495488744
2021-08-18:15:57:24,431 INFO     [oort.py:208] Training selector: Pacer 115: lastExploitationUtil 297.8760562484927, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:57:24,431 INFO     [oort.py:321] scores are 26,{3: 0.22613998252364867, 5: 0.08540220429608385, 6: 0.050499531784650845, 7: 0.06395670567046159, 11: 0.1368790909543824, 14: 0.011497518105660028, 27: 0.12768250646403262, 50: 0.031282925384757465, 51: 0.144146499169966, 53: 0.05851455362539707, 58: 0.004754959453452255, 60: 0.0021218395155432404, 67: 0.002597099539123696, 70: 0.011944442297462136, 79: 0.014541614679048449, 81: 0.02506364316780487, 84: 0.15660141536713307, 85: 0.009790254391494517, 87: 0.03367648110456504, 93: 0.13010610894857336, 97: 0.4666452508626949, 103: 0.06987251868825399, 105: 0.04310430120428776, 107: 0.013789103888614254, 110: 0.034004126708454846, 113: 0.11224496814495255, 119: 0.019013514541958022},[97, 3, 84, 51, 11, 93, 27, 113, 5, 103, 7, 53, 6, 105, 110, 87, 50, 81, 119, 79, 107, 70, 14, 85, 58, 67, 60]
2021-08-18:15:57:24,432 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:24,432 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:24,433 INFO     [oort.py:398] At round 115, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 418.30581634166805, 'duration': 21.635252629006885, 'time_stamp': 116, 'count': 67, 'status': True, 'gradient': 21.9477994373634}, [0.4803424571338667, -2.5862291916309646e-06]), ({'reward': 870.8383336729248, 'duration': 15.972045438625893, 'time_stamp': 116, 'count': 113, 'status': True, 'gradient': 21.31783975892139}, [1.0, -2.5862291916309646e-06]), ({'reward': 473.7557671487241, 'duration': 17.343863580585587, 'time_stamp': 116, 'count': 7, 'status': True, 'gradient': 13.510396461881513}, [0.5440174066344569, -2.5862291916309646e-06])]
2021-08-18:15:57:24,434 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:57:24,749 INFO     [param_server.py:553] For epoch: 117, median_reward: 280.5626128549748, dev: 280.5626128549748
2021-08-18:15:57:25,351 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4441, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:57:25,352 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1708.8507, eval_time 0.5677, test_loss 2.4441, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:57:25,389 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2395, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:57:25,390 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1708.8903, eval_time 0.6053, test_loss 2.2395, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:57:25,426 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5043, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:57:25,427 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1708.9275, eval_time 0.6428, test_loss 2.5043, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:57:25,449 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:25,459 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:25,466 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:25,469 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:25,533 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:25,548 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:26,816 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:26,830 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:27,841 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:27,855 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:28,213 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:28,222 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:28,401 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:28,435 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:29,680 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:29,706 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:29,982 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:29,992 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:30,330 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:30,357 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:57:30,549 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:30,558 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:30,956 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:57:31,17 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:31,400 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:31,420 INFO     [learner.py:606] ====Pushing takes 0.018502235412597656 s
2021-08-18:15:57:31,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:31,458 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:57:31,459 INFO     [param_server.py:410] Lock worker 1 with localStep 117 , while globalStep is 116

2021-08-18:15:57:31,661 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:31,670 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:32,299 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:32,309 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:32,647 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:32,659 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:33,29 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:33,43 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:33,351 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:33,371 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:33,860 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:33,882 INFO     [learner.py:606] ====Pushing takes 0.020692110061645508 s
2021-08-18:15:57:33,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:33,921 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:33,922 INFO     [param_server.py:410] Lock worker 2 with localStep 117 , while globalStep is 116

2021-08-18:15:57:35,400 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:35,418 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:35,946 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:35,955 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:36,550 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:36,559 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:37,104 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:37,141 INFO     [learner.py:606] ====Pushing takes 0.03592967987060547 s
2021-08-18:15:57:37,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:37,199 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:37,200 INFO     [param_server.py:381] ====After aggregation in epoch: 116, virtual_clock: 3814.2666063574416, top_1: : 60.2775 % (1868.0), top_5: : 100.0 % (3099.0), test loss: 2.3959483140044746, test len: 3099.0
2021-08-18:15:57:37,203 INFO     [param_server.py:410] Lock worker 3 with localStep 117 , while globalStep is 117

2021-08-18:15:57:37,203 INFO     [param_server.py:441] ====Epoch 118 completes 20 clients with loss 7.198625783344463, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:37,207 INFO     [param_server.py:450] ====Start to sample for epoch 118, global virtualClock: 3814.2666063574416, round_duration: 38.39602155878561
2021-08-18:15:57:37,207 INFO     [oort.py:208] Training selector: Pacer 116: lastExploitationUtil 415.4597794058495, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:57:37,208 INFO     [oort.py:321] scores are 26,{3: 0.3117593734179832, 5: 0.09530187288936254, 6: 0.050329112951762435, 7: 0.6671830912353521, 11: 0.015070915705867032, 14: 0.014229345986238805, 27: 0.1289554928915726, 50: 0.02514236407028439, 51: 0.2693090103544165, 53: 0.05831708680573722, 58: 0.005884745089499036, 60: 0.002625991828538623, 67: 0.0024216271178371814, 70: 0.01254701034724687, 79: 0.026742878916358515, 81: 0.1575790396690077, 84: 0.451455214214042, 85: 0.00975721559552718, 87: 0.13964768997282964, 93: 0.15614763831981376, 97: 0.2759758356864563, 103: 0.07788896768378419, 105: 0.05709823523208547, 107: 0.01706541605485208, 110: 0.009302194892618253, 113: 0.06374087342904147, 119: 0.023531154667085635},[7, 84, 3, 97, 51, 81, 93, 87, 27, 5, 103, 113, 53, 105, 6, 79, 50, 119, 107, 11, 14, 70, 85, 110, 58, 60, 67]
2021-08-18:15:57:37,209 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:37,209 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:37,210 INFO     [oort.py:398] At round 116, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 644.9411186282891, 'duration': 29.570969934622333, 'time_stamp': 117, 'count': 101, 'status': True, 'gradient': 20.273718056787967}, [0.6810744588691032, -2.56412447969641e-06]), ({'reward': 558.2292549796115, 'duration': 21.635252629006885, 'time_stamp': 117, 'count': 68, 'status': True, 'gradient': 21.95482766290499}, [0.5895030755220719, -2.56412447969641e-06]), ({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 117, 'count': 114, 'status': True, 'gradient': 20.589424559371}, [1.056042154947087e-08, -2.56412447969641e-06])]
2021-08-18:15:57:37,211 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:57:37,506 INFO     [param_server.py:553] For epoch: 118, median_reward: 305.5162578343454, dev: 305.5162578343454
2021-08-18:15:57:38,98 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4099, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:15:57:38,98 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1721.5988, eval_time 0.5536, test_loss 2.4099, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:15:57:38,145 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9372, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:57:38,145 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4045, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:57:38,146 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1721.6448, eval_time 0.6063, test_loss 2.9372, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:57:38,167 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:57:38,147 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1721.6471, eval_time 0.6021, test_loss 2.4045, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:57:38,176 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:38,242 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:57:38,255 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:57:38,259 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:38,269 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:39,465 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:39,480 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:40,119 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:40,133 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:40,447 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:40,459 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:41,449 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:41,477 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:41,698 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:41,707 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:42,241 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:42,250 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:42,824 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:42,852 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:42,854 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:42,864 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:43,372 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:43,385 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:43,438 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:43,452 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:43,503 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:43,536 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:57:43,888 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:43,898 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:44,76 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:44,85 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:44,192 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:57:44,218 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:44,652 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:44,681 INFO     [learner.py:606] ====Pushing takes 0.02700185775756836 s
2021-08-18:15:57:44,710 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:44,718 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:57:44,719 INFO     [param_server.py:410] Lock worker 1 with localStep 118 , while globalStep is 117

2021-08-18:15:57:45,324 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:45,349 INFO     [learner.py:606] ====Pushing takes 0.022925615310668945 s
2021-08-18:15:57:45,382 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:45,389 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:45,389 INFO     [param_server.py:410] Lock worker 2 with localStep 118 , while globalStep is 117

2021-08-18:15:57:45,673 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:45,705 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:46,394 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:46,415 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:47,3 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:47,17 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:47,558 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:47,594 INFO     [learner.py:606] ====Pushing takes 0.03471875190734863 s
2021-08-18:15:57:47,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:47,641 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:47,641 INFO     [param_server.py:381] ====After aggregation in epoch: 117, virtual_clock: 3842.9500093804572, top_1: : 60.9229 % (1888.0), top_5: : 100.0 % (3099.0), test loss: 2.5838817247637995, test len: 3099.0
2021-08-18:15:57:47,644 INFO     [param_server.py:410] Lock worker 3 with localStep 118 , while globalStep is 118

2021-08-18:15:57:47,644 INFO     [param_server.py:441] ====Epoch 119 completes 20 clients with loss 6.264854295193164, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:47,645 INFO     [param_server.py:450] ====Start to sample for epoch 119, global virtualClock: 3842.9500093804572, round_duration: 28.683403023015895
2021-08-18:15:57:47,646 INFO     [oort.py:208] Training selector: Pacer 117: lastExploitationUtil 396.6523324831437, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:57:47,646 INFO     [oort.py:321] scores are 26,{3: 0.16565335420534388, 5: 0.05531759259833304, 6: 0.2970064310110343, 7: 0.17585539338865414, 11: 0.11826248583954622, 14: 0.012380294409115755, 27: 0.05934118253684482, 50: 0.01516140256877622, 51: 0.4683883610840215, 53: 0.058121859230130246, 58: 0.0051200439430634575, 60: 0.0023787625012287356, 67: 0.002796504133209576, 70: 0.010916572146278756, 79: 0.04433372627387887, 81: 0.3525186943187635, 84: 0.40439399283894767, 85: 0.009724551454539912, 87: 0.010398388007348443, 93: 0.09591837866007603, 97: 0.2975958896826258, 103: 0.09477754869584472, 105: 0.01890864826285018, 107: 0.014847827523305945, 110: 0.019579036128543118, 113: 0.3277145999608298, 119: 0.020473367001315197},[51, 84, 81, 113, 97, 6, 7, 3, 11, 93, 103, 27, 53, 5, 79, 119, 110, 105, 50, 107, 14, 70, 87, 85, 58, 67, 60]
2021-08-18:15:57:47,647 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:47,648 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:47,648 INFO     [oort.py:398] At round 117, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 452.1922826822045, 'duration': 30.380154975061778, 'time_stamp': 118, 'count': 112, 'status': True, 'gradient': 11.832199047324185}, [0.4259719542139883, -2.5423944270714182e-06]), ({'reward': 396.65385806903805, 'duration': 48.8795967667807, 'time_stamp': 118, 'count': 89, 'status': True, 'gradient': 17.335042795122696}, [0.3736527642560932, -2.5423944270714182e-06]), ({'reward': 575.6158726897235, 'duration': 12.029357192292537, 'time_stamp': 118, 'count': 115, 'status': True, 'gradient': 27.56666369982426}, [0.5422414072254065, -2.5423944270714182e-06])]
2021-08-18:15:57:47,649 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:57:47,970 INFO     [param_server.py:553] For epoch: 119, median_reward: 302.4211634565738, dev: 302.4211634565738
2021-08-18:15:57:48,656 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7634, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:15:57:48,660 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1732.1585, eval_time 0.6447, test_loss 2.7634, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:15:57:48,688 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5236, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:57:48,689 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1732.1896, eval_time 0.6698, test_loss 2.5236, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:57:48,721 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5898, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:57:48,721 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1732.2217, eval_time 0.7061, test_loss 2.5898, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:57:48,743 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:57:48,765 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:48,771 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:57:48,779 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:48,822 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:57:48,835 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:50,177 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:50,198 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:51,332 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:51,342 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:51,520 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:51,534 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:51,935 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:51,962 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:53,145 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:53,172 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:53,580 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:53,593 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:53,796 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:53,823 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:57:53,822 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:53,843 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:54,427 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:57:54,454 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:54,794 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:54,804 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:54,819 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:54,839 INFO     [learner.py:606] ====Pushing takes 0.018593788146972656 s
2021-08-18:15:57:54,870 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:54,877 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:57:54,878 INFO     [param_server.py:410] Lock worker 1 with localStep 119 , while globalStep is 118

2021-08-18:15:57:55,405 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:55,414 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:56,41 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:56,51 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:56,400 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:56,410 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:57,101 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:57,115 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:57,611 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:57,634 INFO     [learner.py:606] ====Pushing takes 0.021193742752075195 s
2021-08-18:15:57:57,671 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:57,679 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:57,680 INFO     [param_server.py:410] Lock worker 2 with localStep 119 , while globalStep is 118

2021-08-18:15:57:58,229 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:58,240 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:58,798 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:58,818 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:59,540 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:59,550 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:00,122 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:00,160 INFO     [learner.py:606] ====Pushing takes 0.036461830139160156 s
2021-08-18:15:58:00,203 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:00,213 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:00,214 INFO     [param_server.py:381] ====After aggregation in epoch: 118, virtual_clock: 3881.346030939243, top_1: : 60.2775 % (1868.0), top_5: : 100.0 % (3099.0), test loss: 2.6256165504455566, test len: 3099.0
2021-08-18:15:58:00,216 INFO     [param_server.py:410] Lock worker 3 with localStep 119 , while globalStep is 119

2021-08-18:15:58:00,217 INFO     [param_server.py:441] ====Epoch 120 completes 20 clients with loss 8.131872173883789, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:00,218 INFO     [param_server.py:450] ====Start to sample for epoch 120, global virtualClock: 3881.346030939243, round_duration: 38.39602155878561
2021-08-18:15:58:00,218 INFO     [oort.py:208] Training selector: Pacer 118: lastExploitationUtil 353.5248695870531, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:58:00,219 INFO     [oort.py:321] scores are 26,{3: 0.25009627780400956, 5: 0.07673265959316596, 6: 0.049994036164886825, 7: 0.07094744285641671, 11: 0.12958244873522978, 14: 0.010712315622037004, 27: 0.0829184961645277, 50: 0.0037167438394753284, 51: 0.04895714300162595, 53: 0.48884620796820666, 58: 0.004430227982010649, 60: 0.002268129299213671, 67: 0.0024197352601901196, 70: 0.009445798498585813, 79: 0.011296557826451673, 81: 0.10122606339019963, 84: 0.11207208358781094, 85: 0.026831073165355906, 87: 0.010363853502023363, 93: 0.03289739728551202, 97: 0.3202610057467535, 103: 0.06195980619703197, 105: 0.06193393917041536, 107: 0.012847401642896916, 110: 0.08141912505159041, 113: 0.2012631899311471, 119: 0.017715020492759838},[53, 97, 3, 113, 11, 84, 81, 27, 110, 5, 7, 103, 105, 6, 51, 93, 85, 119, 107, 79, 14, 87, 70, 58, 50, 67, 60]
2021-08-18:15:58:00,220 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:58:00,220 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:00,221 INFO     [oort.py:398] At round 118, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 683.6263603508306, 'duration': 17.343863580585587, 'time_stamp': 119, 'count': 10, 'status': True, 'gradient': 20.289905516074036}, [0.609063761137504, -2.521029588483939e-06]), ({'reward': 696.6530630760701, 'duration': 30.380154975061778, 'time_stamp': 119, 'count': 113, 'status': True, 'gradient': 15.217212815128244}, [0.6206698210581915, -2.521029588483939e-06]), ({'reward': 244.17803487411192, 'duration': 17.619275735353515, 'time_stamp': 119, 'count': 115, 'status': True, 'gradient': 20.288511279033557}, [0.2175400037367417, -2.521029588483939e-06])]
2021-08-18:15:58:00,221 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:58:00,506 INFO     [param_server.py:553] For epoch: 120, median_reward: 293.0768438895351, dev: 293.0768438895351
2021-08-18:15:58:01,96 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6085, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:15:58:01,97 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1744.5976, eval_time 0.557, test_loss 2.6085, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:15:58:01,142 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4523, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:15:58:01,144 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1744.644, eval_time 0.604, test_loss 2.4523, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:15:58:01,174 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:01,190 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:01,213 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:01,220 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6019, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:58:01,221 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1744.7199, eval_time 0.6818, test_loss 2.6019, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:58:01,228 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:01,316 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:01,342 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:02,433 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:02,447 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:03,132 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:03,152 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:03,439 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:03,448 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:04,564 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:04,591 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:04,851 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:04,867 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:05,236 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:05,245 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:05,723 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:05,744 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:05,751 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:05,760 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:06,259 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:06,268 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:06,285 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:06,306 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:58:06,627 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:06,638 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:06,783 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:06,792 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:06,805 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:58:06,825 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:07,160 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:07,169 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:07,323 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:07,355 INFO     [learner.py:606] ====Pushing takes 0.029387712478637695 s
2021-08-18:15:58:07,386 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:07,394 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:58:07,395 INFO     [param_server.py:410] Lock worker 1 with localStep 120 , while globalStep is 119

2021-08-18:15:58:08,74 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:08,92 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:08,508 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:08,530 INFO     [learner.py:606] ====Pushing takes 0.021125078201293945 s
2021-08-18:15:58:08,557 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:08,564 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:58:08,564 INFO     [param_server.py:410] Lock worker 2 with localStep 120 , while globalStep is 119

2021-08-18:15:58:08,674 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:08,692 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:09,219 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:09,240 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:09,900 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:09,938 INFO     [learner.py:606] ====Pushing takes 0.036461591720581055 s
2021-08-18:15:58:09,976 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:09,985 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:09,986 INFO     [param_server.py:381] ====After aggregation in epoch: 119, virtual_clock: 3909.361886434732, top_1: : 61.8264 % (1916.0), top_5: : 100.0 % (3099.0), test loss: 2.554214676221212, test len: 3099.0
2021-08-18:15:58:09,988 INFO     [param_server.py:410] Lock worker 3 with localStep 120 , while globalStep is 120

2021-08-18:15:58:09,989 INFO     [param_server.py:441] ====Epoch 121 completes 20 clients with loss 10.140151114477476, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:09,989 INFO     [param_server.py:450] ====Start to sample for epoch 121, global virtualClock: 3909.361886434732, round_duration: 28.015855495488744
2021-08-18:15:58:09,990 INFO     [oort.py:208] Training selector: Pacer 119: lastExploitationUtil 269.7074775583072, lastExplorationUtil 0.0, last_util_record 80
2021-08-18:15:58:09,991 INFO     [oort.py:321] scores are 26,{3: 0.1745741129825523, 5: 0.026330378875639042, 6: 0.04982930455387488, 7: 0.06310787550875115, 11: 0.1157647671109997, 14: 0.008082107711854993, 27: 0.022582149050973156, 50: 0.007714087154546006, 51: 0.14932656173378261, 53: 0.057737951430278066, 58: 0.003342468706301564, 60: 0.002123564817756249, 67: 0.001825614712732972, 70: 0.007126560081276983, 79: 0.04068228602547037, 81: 0.21751534430581337, 84: 0.10165248240622288, 85: 0.02242601159167001, 87: 0.01705251583490788, 93: 0.03610709155123797, 97: 0.46627296028593945, 103: 0.045938995844890834, 105: 0.014836324554300456, 107: 0.009692963459903274, 110: 0.009209816647633618, 113: 0.11778192083696945, 119: 0.013365429921208587},[97, 81, 3, 51, 113, 11, 84, 7, 53, 6, 103, 79, 93, 5, 27, 85, 87, 105, 119, 107, 110, 14, 50, 70, 58, 60, 67]
2021-08-18:15:58:10,7 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:58:10,8 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:10,8 INFO     [oort.py:398] At round 119, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10.900000000000002, sampled score is [({'reward': 118.37864955618338, 'duration': 13.298442137908651, 'time_stamp': 120, 'count': 117, 'status': True, 'gradient': 16.916614339724855}, [0.09756241320915819, -2.5000208335069482e-06]), ({'reward': 1213.270872573906, 'duration': 15.972045438625893, 'time_stamp': 120, 'count': 117, 'status': True, 'gradient': 21.354856409590276}, [1.0, -2.5000208335069482e-06]), ({'reward': 548.8740113859787, 'duration': 35.433463751176646, 'time_stamp': 120, 'count': 21, 'status': True, 'gradient': 8.458406668916293}, [0.4523874702212239, -2.5000208335069482e-06])]
2021-08-18:15:58:10,9 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:58:10,289 INFO     [param_server.py:541] Handle Wight 0.04150986671447754 | Send 0.29961276054382324
2021-08-18:15:58:10,290 INFO     [param_server.py:553] For epoch: 121, median_reward: 274.9163391021467, dev: 274.9163391021467
2021-08-18:15:58:10,881 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3704, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:15:58:10,885 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1754.3835, eval_time 0.5618, test_loss 2.3704, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:15:58:10,952 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7984, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:15:58:10,952 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1754.4528, eval_time 0.6289, test_loss 2.7984, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:15:58:10,952 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4759, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:15:58:10,953 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1754.4535, eval_time 0.6289, test_loss 2.4759, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:15:58:10,985 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:11,7 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:11,23 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:11,24 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:11,31 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:11,37 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:12,261 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:12,281 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:13,420 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:13,447 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:13,655 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:13,666 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:14,228 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:14,255 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:15,457 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:15,484 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:15,765 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:15,779 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:15,875 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:15,886 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:16,106 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:16,133 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:58:16,730 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:58:16,757 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:16,948 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:16,957 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:17,132 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:17,153 INFO     [learner.py:606] ====Pushing takes 0.019246816635131836 s
2021-08-18:15:58:17,214 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:17,220 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:58:17,221 INFO     [param_server.py:410] Lock worker 1 with localStep 121 , while globalStep is 120

2021-08-18:15:58:17,515 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:17,524 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:18,104 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:18,116 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:18,650 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:18,669 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:19,309 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:19,318 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:19,855 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:19,877 INFO     [learner.py:606] ====Pushing takes 0.021190166473388672 s
2021-08-18:15:58:19,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:19,922 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:58:19,923 INFO     [param_server.py:410] Lock worker 2 with localStep 121 , while globalStep is 120

2021-08-18:15:58:20,421 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:20,433 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:21,8 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:21,17 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:21,661 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:21,672 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:22,250 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:22,288 INFO     [learner.py:606] ====Pushing takes 0.03670358657836914 s
2021-08-18:15:58:22,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:22,357 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:22,358 INFO     [param_server.py:381] ====After aggregation in epoch: 120, virtual_clock: 3947.7579079935176, top_1: : 61.8264 % (1916.0), top_5: : 100.0 % (3099.0), test loss: 2.5482304238334845, test len: 3099.0
2021-08-18:15:58:22,361 INFO     [param_server.py:410] Lock worker 3 with localStep 121 , while globalStep is 121

2021-08-18:15:58:22,361 INFO     [param_server.py:441] ====Epoch 122 completes 20 clients with loss 7.681372590122287, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:22,362 INFO     [param_server.py:450] ====Start to sample for epoch 122, global virtualClock: 3947.7579079935176, round_duration: 38.39602155878561
2021-08-18:15:58:22,362 INFO     [oort.py:208] Training selector: Pacer 120: lastExploitationUtil 423.2793673425577, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:58:22,363 INFO     [oort.py:321] scores are 26,{3: 0.3172049715277313, 5: 0.008048486803800277, 6: 0.04966639847893173, 7: 0.0629015580337397, 11: 0.014872467663147457, 14: 0.013757584178548629, 27: 0.07887393985353847, 50: 0.02709943100538339, 51: 0.3915714636490791, 53: 0.4173205212255125, 58: 0.003895653198099028, 60: 0.0025389293132825393, 67: 0.003107611155835009, 70: 0.012131024940169904, 79: 0.03999178556838548, 81: 0.19906464418784117, 84: 0.47454426621022583, 85: 0.04480081568827405, 87: 0.07456923107481939, 93: 0.015115610576995349, 97: 0.46618246986774514, 103: 0.08913955897202637, 105: 0.05991780967918031, 107: 0.01649962676736073, 110: 0.009179707154947642, 113: 0.6167159859489064, 119: 0.0227509993406555},[113, 84, 97, 53, 51, 3, 81, 103, 27, 87, 7, 105, 6, 85, 79, 50, 119, 107, 93, 11, 14, 70, 110, 5, 58, 67, 60]
2021-08-18:15:58:22,372 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:58:22,373 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:22,373 INFO     [oort.py:398] At round 120, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 489.83543168449205, 'duration': 17.619275735353515, 'time_stamp': 121, 'count': 117, 'status': True, 'gradient': 20.307066124448166}, [0.48941272094823424, -2.4793593335482134e-06]), ({'reward': 687.7449615983567, 'duration': 13.298442137908651, 'time_stamp': 121, 'count': 118, 'status': True, 'gradient': 21.364743950875337}, [0.6871554947895323, -2.4793593335482134e-06]), ({'reward': 393.5735126032947, 'duration': 11.058674649423494, 'time_stamp': 121, 'count': 118, 'status': True, 'gradient': 20.623080672961883}, [0.3932319109453652, -2.4793593335482134e-06])]
2021-08-18:15:58:22,374 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 27, 103, 79, 50, 105, 119]
2021-08-18:15:58:22,687 INFO     [param_server.py:553] For epoch: 122, median_reward: 306.97576934503155, dev: 306.97576934503155
2021-08-18:15:58:23,367 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7854, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:58:23,368 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1766.868, eval_time 0.6574, test_loss 2.7854, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:58:23,402 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6873, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:58:23,403 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1766.9037, eval_time 0.6934, test_loss 2.6873, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:58:23,410 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5382, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:58:23,412 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1766.9103, eval_time 0.7019, test_loss 2.5382, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:58:23,439 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:23,447 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:23,474 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:23,490 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:23,515 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:23,531 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:24,582 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:24,596 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:25,250 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:25,259 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:25,559 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:25,569 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:26,394 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:26,422 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:26,903 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:26,913 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:27,310 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:27,319 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:27,730 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:27,763 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:27,893 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:27,903 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:28,432 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:28,441 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:28,513 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:28,547 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:58:28,894 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:28,908 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:29,38 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:29,47 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:29,166 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:58:29,200 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:29,794 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:29,823 INFO     [learner.py:606] ====Pushing takes 0.02709794044494629 s
2021-08-18:15:58:29,852 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:29,858 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:58:29,858 INFO     [param_server.py:410] Lock worker 1 with localStep 122 , while globalStep is 121

2021-08-18:15:58:30,174 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:30,186 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:58:30,599 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:30,609 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:30,910 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:58:30,933 INFO     [learner.py:606] ====Pushing takes 0.02126145362854004 s
2021-08-18:15:58:30,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:30,965 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:58:30,966 INFO     [param_server.py:410] Lock worker 2 with localStep 122 , while globalStep is 121

2021-08-18:15:58:31,127 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:31,138 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:31,689 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:31,707 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:32,223 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:32,261 INFO     [learner.py:606] ====Pushing takes 0.036191463470458984 s
2021-08-18:15:58:32,305 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:32,315 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:32,316 INFO     [param_server.py:381] ====After aggregation in epoch: 121, virtual_clock: 3977.4574261344164, top_1: : 59.5353 % (1845.0), top_5: : 100.0 % (3099.0), test loss: 2.670266495810614, test len: 3099.0
2021-08-18:15:58:32,320 INFO     [param_server.py:410] Lock worker 3 with localStep 122 , while globalStep is 122

2021-08-18:15:58:32,321 INFO     [param_server.py:441] ====Epoch 123 completes 20 clients with loss 7.598376367138093, sampled rewards are: 
 {3: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:58:32,321 INFO     [param_server.py:450] ====Start to sample for epoch 123, global virtualClock: 3977.4574261344164, round_duration: 29.6995181408989
2021-08-18:15:58:32,322 INFO     [oort.py:208] Training selector: Pacer 121: lastExploitationUtil 272.7363453809615, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:58:32,322 INFO     [oort.py:321] scores are 26,{3: 0.376627588707384, 5: 0.008055460195945162, 6: 0.04950528425787614, 7: 0.07605165299799214, 11: 0.014824222448754896, 14: 0.013426145109933837, 27: 0.1188541000995501, 50: 0.004036976831412978, 51: 0.048478527973927, 53: 0.8739055861865923, 58: 0.005552570130981048, 60: 0.002477763024495787, 67: 0.003032744541628651, 70: 0.011838771914105784, 79: 0.03175795555926301, 81: 0.2794689094824105, 84: 0.039667308129174975, 85: 0.009597501392184586, 87: 0.10549480617336723, 93: 0.014986848748682542, 97: 0.42202575319125357, 103: 0.09144847619937546, 105: 0.061897884819298, 107: 0.016102128132622767, 110: 0.009149928845807407, 113: 0.8045953490111509, 119: 0.007362713585021444},[53, 113, 97, 3, 81, 27, 87, 103, 7, 105, 6, 51, 84, 79, 107, 93, 11, 14, 70, 85, 110, 5, 119, 58, 50, 67, 60]
2021-08-18:15:58:32,323 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:58:32,324 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:32,324 INFO     [oort.py:398] At round 121, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 491.81546474110496, 'duration': 8.009219946401625, 'time_stamp': 122, 'count': 46, 'status': True, 'gradient': 21.377715331573228}, [0.7418978541884189, -2.4590365494799157e-06]), ({'reward': 301.54099655638777, 'duration': 42.701901101086094, 'time_stamp': 122, 'count': 84, 'status': True, 'gradient': 8.466493004138542}, [0.45486522258260853, -2.4590365494799157e-06]), ({'reward': 629.6742104030068, 'duration': 17.343863580585587, 'time_stamp': 122, 'count': 13, 'status': True, 'gradient': 15.239652646028205}, [0.9498603776668582, -2.4590365494799157e-06])]
2021-08-18:15:58:32,325 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 5, 27, 103, 79, 50, 105, 119]
2021-08-18:15:58:32,608 INFO     [param_server.py:553] For epoch: 123, median_reward: 272.1105015100442, dev: 272.1105015100442
2021-08-18:15:58:33,342 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6862, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:58:33,343 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1776.8415, eval_time 0.6789, test_loss 2.6862, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:58:33,352 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8129, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:58:33,355 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1776.8558, eval_time 0.6863, test_loss 2.8129, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:58:33,356 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5658, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:15:58:33,359 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1776.8594, eval_time 0.6869, test_loss 2.5658, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:15:58:33,419 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:58:33,423 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:58:33,427 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:58:33,434 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:33,442 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:33,442 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:34,701 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:34,714 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:35,917 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:35,931 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:36,145 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:36,156 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:36,209 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:36,230 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:37,371 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:37,398 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:38,29 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:38,56 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:58:38,303 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:38,316 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:38,498 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:38,507 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:38,667 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:58:38,700 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:38,919 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:38,928 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:39,120 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:39,140 INFO     [learner.py:606] ====Pushing takes 0.01860213279724121 s
2021-08-18:15:58:39,171 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:39,178 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:58:39,179 INFO     [param_server.py:410] Lock worker 1 with localStep 123 , while globalStep is 122

2021-08-18:15:58:39,452 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:39,461 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:58:39,493 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:39,504 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:40,19 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:40,29 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:40,137 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:58:40,159 INFO     [learner.py:606] ====Pushing takes 0.021050214767456055 s
2021-08-18:15:58:40,194 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:40,202 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:58:40,203 INFO     [param_server.py:410] Lock worker 2 with localStep 123 , while globalStep is 122

2021-08-18:15:58:40,616 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:40,625 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:42,862 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:42,874 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:43,551 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:43,565 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:44,162 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:44,171 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:44,717 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:44,753 INFO     [learner.py:606] ====Pushing takes 0.03465151786804199 s
2021-08-18:15:58:44,790 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:44,799 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:44,800 INFO     [param_server.py:381] ====After aggregation in epoch: 122, virtual_clock: 4015.8534476932023, top_1: : 60.697 % (1881.0), top_5: : 100.0 % (3099.0), test loss: 2.6882804720490068, test len: 3099.0
2021-08-18:15:58:44,802 INFO     [param_server.py:410] Lock worker 3 with localStep 123 , while globalStep is 123

2021-08-18:15:58:44,802 INFO     [param_server.py:441] ====Epoch 124 completes 20 clients with loss 8.775226985609628, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:58:44,803 INFO     [param_server.py:450] ====Start to sample for epoch 124, global virtualClock: 4015.8534476932023, round_duration: 38.39602155878561
2021-08-18:15:58:44,827 INFO     [oort.py:208] Training selector: Pacer 122: lastExploitationUtil 445.0239726274889, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:58:44,827 INFO     [oort.py:321] scores are 26,{3: 0.22346799246701424, 5: 0.02386857612085217, 6: 0.4825808223819365, 7: 0.06249567440629794, 11: 0.027149880177803145, 14: 0.013395329055368587, 27: 0.11762858352637123, 50: 0.04727325480439619, 51: 0.2785417584952986, 53: 0.057177843246726485, 58: 0.005539825720524238, 60: 0.002472075995200526, 67: 0.003025783703613565, 70: 0.011811599241808305, 79: 0.06270493146312944, 81: 0.2266052167883673, 84: 0.0782777925433277, 85: 0.0822794760926917, 87: 0.08408913015277769, 93: 0.014938603162224924, 97: 0.46600445199307333, 103: 0.06457437574012634, 105: 0.04571235330650952, 107: 0.016065170088814317, 110: 0.009157776141938589, 113: 0.06249567440629794, 119: 0.007669373796534521},[6, 97, 51, 81, 3, 27, 87, 85, 84, 103, 79, 7, 113, 53, 50, 105, 11, 5, 107, 93, 14, 70, 110, 119, 58, 67, 60]
2021-08-18:15:58:44,829 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:58:44,829 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:44,829 INFO     [oort.py:398] At round 122, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 1040.021454237612, 'duration': 42.701901101086094, 'time_stamp': 123, 'count': 85, 'status': True, 'gradient': 11.85871310227475}, [0.9594131495159298, -2.4390442198717086e-06]), ({'reward': 583.5258541000737, 'duration': 17.343863580585587, 'time_stamp': 123, 'count': 14, 'status': True, 'gradient': 20.330396381202025}, [0.5382948286816728, -2.4390442198717086e-06]), ({'reward': 66.38266403273394, 'duration': 13.298442137908651, 'time_stamp': 123, 'count': 120, 'status': True, 'gradient': 21.388618772456347}, [0.06122895605022937, -2.4390442198717086e-06])]
2021-08-18:15:58:44,830 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:58:45,98 INFO     [param_server.py:553] For epoch: 124, median_reward: 309.43963098648135, dev: 309.43963098648135
2021-08-18:15:58:45,719 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.461, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:58:45,720 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1789.2209, eval_time 0.5855, test_loss 2.461, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:58:45,763 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6756, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:58:45,764 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1789.2644, eval_time 0.6315, test_loss 2.6756, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:58:45,787 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:58:45,795 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:45,799 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5915, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:58:45,803 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1789.3014, eval_time 0.6704, test_loss 2.5915, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:58:45,832 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:58:45,844 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:45,869 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:58:45,889 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:47,26 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:47,40 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:47,748 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:47,766 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:48,2 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:48,13 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:49,113 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:49,131 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:49,529 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:49,540 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:49,720 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:49,730 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:50,213 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:50,235 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:50,333 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:50,342 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:50,903 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:50,930 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:58:50,944 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:50,953 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:51,168 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:51,177 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:51,529 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:51,540 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:51,591 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:58:51,625 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:51,727 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:51,736 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:52,111 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:52,140 INFO     [learner.py:606] ====Pushing takes 0.027179718017578125 s
2021-08-18:15:58:52,172 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:52,179 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:58:52,179 INFO     [param_server.py:410] Lock worker 1 with localStep 124 , while globalStep is 123

2021-08-18:15:58:52,801 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:52,814 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:52,823 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:52,849 INFO     [learner.py:606] ====Pushing takes 0.02132725715637207 s
2021-08-18:15:58:52,876 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:52,883 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:58:52,884 INFO     [param_server.py:410] Lock worker 2 with localStep 124 , while globalStep is 123

2021-08-18:15:58:53,295 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:53,306 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:53,811 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:53,825 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:54,401 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:54,438 INFO     [learner.py:606] ====Pushing takes 0.03614664077758789 s
2021-08-18:15:58:54,491 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:54,500 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:54,501 INFO     [param_server.py:381] ====After aggregation in epoch: 123, virtual_clock: 4043.869303188691, top_1: : 61.1165 % (1894.0), top_5: : 100.0 % (3099.0), test loss: 2.576038360595703, test len: 3099.0
2021-08-18:15:58:54,503 INFO     [param_server.py:410] Lock worker 3 with localStep 124 , while globalStep is 124

2021-08-18:15:58:54,504 INFO     [param_server.py:441] ====Epoch 125 completes 20 clients with loss 8.869132623612563, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:54,504 INFO     [param_server.py:450] ====Start to sample for epoch 125, global virtualClock: 4043.869303188691, round_duration: 28.015855495488744
2021-08-18:15:58:54,505 INFO     [oort.py:208] Training selector: Pacer 123: lastExploitationUtil 349.4303116163865, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:58:54,506 INFO     [oort.py:321] scores are 26,{3: 0.24901138616874802, 5: 0.05849643580015645, 6: 0.07527613402195879, 7: 0.06229602747404355, 11: 0.14708860872004495, 14: 0.011326848535675648, 27: 0.0770870426137733, 50: 0.01631203018026604, 51: 0.04816809654801624, 53: 0.2063669343392038, 58: 0.0057692809720817605, 60: 0.0020903428538841164, 67: 0.00255854810067624, 70: 0.009987675183122454, 79: 0.015398549149260006, 81: 0.22192246400311957, 84: 0.03941329919905226, 85: 0.009536043955936548, 87: 0.13360437326320226, 93: 0.014890880718682442, 97: 0.46591688781101254, 103: 0.06221553939899107, 105: 0.04548101519377445, 107: 0.013584417937306102, 110: 0.06103666121941538, 113: 0.06229602747404355, 119: 0.01873127725205367},[97, 3, 81, 53, 11, 87, 27, 6, 7, 113, 103, 110, 5, 51, 105, 84, 119, 50, 79, 93, 107, 14, 70, 85, 58, 67, 60]
2021-08-18:15:58:54,507 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:58:54,507 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:54,508 INFO     [oort.py:398] At round 123, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 124, 'count': 121, 'status': True, 'gradient': 21.605435559193438}, [9.664092362193468e-09, -2.4193743497931457e-06]), ({'reward': 579.2676814209225, 'duration': 21.753601635627824, 'time_stamp': 124, 'count': 116, 'status': True, 'gradient': 21.604458173710622}, [0.5597999831402986, -2.4193743497931457e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 124, 'count': 48, 'status': True, 'gradient': 21.395795978584115}, [9.664092362193468e-09, -2.4193743497931457e-06])]
2021-08-18:15:58:54,508 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:58:54,788 INFO     [param_server.py:553] For epoch: 125, median_reward: 292.4360554748429, dev: 292.4360554748429
2021-08-18:15:58:55,416 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5558, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:58:55,418 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1798.9181, eval_time 0.5907, test_loss 2.5558, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:58:55,420 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4786, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:15:58:55,420 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1798.919, eval_time 0.5974, test_loss 2.4786, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:15:58:55,458 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8681, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:58:55,459 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1798.959, eval_time 0.633, test_loss 2.8681, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:58:55,497 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:58:55,499 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:58:55,505 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:55,520 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:55,526 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:58:55,538 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:56,647 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:56,657 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:57,797 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:57,807 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:58,257 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:58,272 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:58,513 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:58,540 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:59,668 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:59,689 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:00,176 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:00,191 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:00,270 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:00,291 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:59:00,587 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:00,598 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:00,894 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:59:00,927 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:01,360 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:01,380 INFO     [learner.py:606] ====Pushing takes 0.018645524978637695 s
2021-08-18:15:59:01,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:01,423 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:59:01,423 INFO     [param_server.py:410] Lock worker 1 with localStep 125 , while globalStep is 124

2021-08-18:15:59:01,660 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:01,675 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:02,280 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:02,289 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:03,20 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:03,33 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:03,40 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:03,50 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:03,648 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:03,657 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:04,138 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:04,161 INFO     [learner.py:606] ====Pushing takes 0.020922183990478516 s
2021-08-18:15:59:04,204 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:04,213 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:59:04,214 INFO     [param_server.py:410] Lock worker 2 with localStep 125 , while globalStep is 124

2021-08-18:15:59:05,345 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:05,363 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:05,997 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:06,10 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:06,603 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:06,614 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:07,163 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:07,200 INFO     [learner.py:606] ====Pushing takes 0.0352785587310791 s
2021-08-18:15:59:07,261 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:07,283 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:07,283 INFO     [param_server.py:381] ====After aggregation in epoch: 124, virtual_clock: 4082.265324747477, top_1: : 60.7615 % (1883.0), top_5: : 100.0 % (3099.0), test loss: 2.634158938019364, test len: 3099.0
2021-08-18:15:59:07,286 INFO     [param_server.py:410] Lock worker 3 with localStep 125 , while globalStep is 125

2021-08-18:15:59:07,286 INFO     [param_server.py:441] ====Epoch 126 completes 20 clients with loss 7.189046727571068, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:07,287 INFO     [param_server.py:450] ====Start to sample for epoch 126, global virtualClock: 4082.265324747477, round_duration: 38.39602155878561
2021-08-18:15:59:07,288 INFO     [oort.py:208] Training selector: Pacer 124: lastExploitationUtil 386.31962226742394, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:59:07,288 INFO     [oort.py:321] scores are 26,{3: 0.199247689877503, 5: 0.11658735006555984, 6: 0.48829497975140784, 7: 0.07822004328049659, 11: 0.029538540165397975, 14: 0.013287646459930271, 27: 0.07570345845843895, 50: 0.03687486104397346, 51: 0.27012508777000066, 53: 0.2929740033315677, 58: 0.005495292076789454, 60: 0.0024522034293095623, 67: 0.002754375971057327, 70: 0.011716647960105716, 79: 0.03509476855496684, 81: 0.06012254584009243, 84: 0.03928834256176396, 85: 0.04639140539842836, 87: 0.10675661853254775, 93: 0.07704053503455371, 97: 0.3572646414051203, 103: 0.0946502045771457, 105: 0.030886318762134782, 110: 0.0647066164565868, 112: 0.4633673201980607, 113: 0.2650332587680624, 119: 0.021973860521246634},[6, 112, 97, 53, 51, 113, 3, 5, 87, 103, 7, 93, 27, 110, 81, 85, 84, 50, 79, 105, 11, 119, 14, 70, 58, 67, 60]
2021-08-18:15:59:07,289 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:59:07,291 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:07,291 INFO     [oort.py:398] At round 124, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 244.93862914802088, 'duration': 11.058674649423494, 'time_stamp': 125, 'count': 122, 'status': True, 'gradient': 20.664005216692207}, [0.25812356799607694, -2.400019200153603e-06]), ({'reward': 805.6764659766892, 'duration': 29.570969934622333, 'time_stamp': 125, 'count': 108, 'status': True, 'gradient': 20.347079117046558}, [0.8490697785171973, -2.400019200153603e-06]), ({'reward': 99.37146851702647, 'duration': 17.619275735353515, 'time_stamp': 125, 'count': 121, 'status': True, 'gradient': 20.345864192367653}, [0.10471433412358329, -2.400019200153603e-06])]
2021-08-18:15:59:07,292 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:59:07,637 INFO     [param_server.py:553] For epoch: 126, median_reward: 299.63215328466805, dev: 299.63215328466805
2021-08-18:15:59:08,288 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0658, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:59:08,289 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1811.7896, eval_time 0.6063, test_loss 3.0658, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:59:08,358 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:08,372 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:08,372 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5756, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:59:08,373 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1811.8738, eval_time 0.6911, test_loss 2.5756, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:59:08,406 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4145, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:59:08,409 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1811.9081, eval_time 0.7281, test_loss 2.4145, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:59:08,442 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:08,460 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:08,479 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:08,506 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:09,638 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:09,652 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:10,272 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:10,286 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:10,664 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:10,673 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:11,388 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:11,408 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:11,902 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:11,916 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:12,429 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:12,440 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:12,601 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:12,615 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:13,118 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:13,130 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:13,265 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:13,279 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:59:13,620 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:13,631 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:13,802 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:13,812 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:13,958 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:59:13,978 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:14,152 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:14,162 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:14,439 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:14,449 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:14,489 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:14,518 INFO     [learner.py:606] ====Pushing takes 0.027723312377929688 s
2021-08-18:15:59:14,549 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:14,556 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:59:14,557 INFO     [param_server.py:410] Lock worker 1 with localStep 126 , while globalStep is 125

2021-08-18:15:59:15,386 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:15,406 INFO     [learner.py:606] ====Pushing takes 0.019054889678955078 s
2021-08-18:15:59:15,441 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:15,447 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:59:15,448 INFO     [param_server.py:410] Lock worker 2 with localStep 126 , while globalStep is 125

2021-08-18:15:59:16,143 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:16,155 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:16,788 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:16,807 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:17,362 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:17,374 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:17,894 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:17,932 INFO     [learner.py:606] ====Pushing takes 0.03625369071960449 s
2021-08-18:15:59:17,979 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:17,996 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:17,997 INFO     [param_server.py:381] ====After aggregation in epoch: 125, virtual_clock: 4110.948727770493, top_1: : 60.213 % (1866.0), top_5: : 100.0 % (3099.0), test loss: 2.6852827359128884, test len: 3099.0
2021-08-18:15:59:18,0 INFO     [param_server.py:410] Lock worker 3 with localStep 126 , while globalStep is 126

2021-08-18:15:59:18,0 INFO     [param_server.py:441] ====Epoch 127 completes 20 clients with loss 8.349853920934303, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:18,0 INFO     [param_server.py:450] ====Start to sample for epoch 127, global virtualClock: 4110.948727770493, round_duration: 28.683403023015895
2021-08-18:15:59:18,1 INFO     [oort.py:208] Training selector: Pacer 125: lastExploitationUtil 328.31287042690354, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:59:18,2 INFO     [oort.py:321] scores are 25,{3: 0.20286384722245418, 5: 0.058947457658858685, 6: 0.5054793855395832, 7: 0.06190311815708597, 11: 0.054090944716799504, 14: 0.009322202578024272, 27: 0.023896089876755514, 50: 0.0036337765814471452, 51: 0.04786429396731856, 53: 0.05663570831252221, 58: 0.0038553272861168394, 60: 0.0017203902285845077, 67: 0.002218888739818951, 70: 0.008220038525925193, 79: 0.008347494914544732, 81: 0.0709180200029063, 84: 0.11631967750275377, 85: 0.08883909281209373, 87: 0.05398322294312897, 93: 0.05924824498766504, 97: 0.4657445607254677, 103: 0.01601148971752457, 105: 0.025578725368445476, 110: 0.07243453458980653, 113: 0.4123044680757702, 119: 0.015416182227457163},[6, 97, 113, 3, 84, 85, 110, 81, 7, 93, 5, 53, 11, 87, 51, 105, 27, 103, 119, 14, 79, 70, 58, 50, 67, 60]
2021-08-18:15:59:18,2 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:59:18,3 INFO     [oort.py:365] exploration poss is [13.46362773 12.44949144  2.63282729  1.23777438]
2021-08-18:15:59:18,4 INFO     [oort.py:398] At round 125, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 64, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 636.8175798246751, 'duration': 27.035726288496562, 'time_stamp': 126, 'count': 116, 'status': True, 'gradient': 11.874177647471122}, [0.5184552222408126, -2.380971277549824e-06]), ({'reward': 1228.2888509445042, 'duration': 15.972045438625893, 'time_stamp': 126, 'count': 123, 'status': True, 'gradient': 21.414004318984944}, [1.0, -2.380971277549824e-06]), ({'reward': 593.8747553226063, 'duration': 17.343863580585587, 'time_stamp': 126, 'count': 17, 'status': True, 'gradient': 15.267407034004458}, [0.4834934347611785, -2.380971277549824e-06])]
2021-08-18:15:59:18,5 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:59:18,328 INFO     [param_server.py:553] For epoch: 127, median_reward: 287.5473773609721, dev: 287.5473773609721
2021-08-18:15:59:18,934 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9052, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:15:59:18,937 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1822.4371, eval_time 0.5639, test_loss 2.9052, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:15:59:19,11 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:19,15 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5006, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:59:19,16 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1822.5151, eval_time 0.6439, test_loss 2.5006, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:59:19,18 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6106, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:59:19,19 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:19,19 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1822.5194, eval_time 0.6464, test_loss 2.6106, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:59:19,89 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:19,95 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:19,110 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:19,125 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:20,445 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:20,455 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:21,612 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:21,621 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:21,699 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:21,714 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:22,214 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:22,235 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:23,383 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:23,410 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:23,989 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:24,10 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:59:24,93 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:24,107 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:24,181 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:24,191 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:24,577 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:59:24,604 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:24,985 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:25,5 INFO     [learner.py:606] ====Pushing takes 0.018835067749023438 s
2021-08-18:15:59:25,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:25,43 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:59:25,44 INFO     [param_server.py:410] Lock worker 1 with localStep 127 , while globalStep is 126

2021-08-18:15:59:25,284 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:25,298 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:25,904 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:25,914 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:26,587 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:26,599 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:26,822 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:26,832 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:27,405 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:27,414 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:28,0 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:28,22 INFO     [learner.py:606] ====Pushing takes 0.0211031436920166 s
2021-08-18:15:59:28,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:28,66 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:59:28,67 INFO     [param_server.py:410] Lock worker 2 with localStep 127 , while globalStep is 126

2021-08-18:15:59:28,879 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:28,897 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:29,572 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:29,585 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:30,172 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:30,190 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:30,695 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:30,733 INFO     [learner.py:606] ====Pushing takes 0.03694629669189453 s
2021-08-18:15:59:30,775 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:30,793 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:30,794 INFO     [param_server.py:381] ====After aggregation in epoch: 126, virtual_clock: 4149.344749329279, top_1: : 61.0197 % (1891.0), top_5: : 100.0 % (3099.0), test loss: 2.6721226087322942, test len: 3099.0
2021-08-18:15:59:30,797 INFO     [param_server.py:410] Lock worker 3 with localStep 127 , while globalStep is 127

2021-08-18:15:59:30,798 INFO     [param_server.py:441] ====Epoch 128 completes 20 clients with loss 7.638490992559863, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:30,798 INFO     [param_server.py:450] ====Start to sample for epoch 128, global virtualClock: 4149.344749329279, round_duration: 38.39602155878561
2021-08-18:15:59:30,799 INFO     [oort.py:208] Training selector: Pacer 126: lastExploitationUtil 338.38657035108974, lastExplorationUtil 338.3540884885222, last_util_record 100
2021-08-18:15:59:30,801 INFO     [oort.py:321] scores are 26,{3: 0.11338775980131402, 5: 0.07119445571580454, 6: 0.1576824744182199, 7: 0.06368489196895974, 11: 0.023064722019037254, 13: 0.0023865504489007597, 14: 0.010701770847331524, 27: 0.09352301028484558, 50: 0.026876093832021188, 51: 0.047714803620262286, 53: 0.11948974470905949, 58: 0.004425867042918441, 60: 0.0019749862589021035, 67: 0.0024881125320049447, 70: 0.009436500432640478, 79: 0.041040084229031625, 81: 0.086515327587644, 84: 0.17206114328175784, 85: 0.05691408413438285, 87: 0.010100859737296942, 93: 0.01591015487130286, 97: 0.465659763894918, 103: 0.035014834575620844, 105: 0.05964136016147187, 110: 0.022742955795165234, 113: 0.5990142620709233, 119: 0.017697582535684077},[113, 97, 84, 6, 53, 3, 27, 81, 5, 7, 105, 85, 51, 79, 103, 50, 11, 110, 119, 93, 14, 87, 70, 58, 67, 13, 60]
2021-08-18:15:59:30,802 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:59:30,803 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:30,803 INFO     [oort.py:398] At round 126, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 225.00562819943613, 'duration': 13.298442137908651, 'time_stamp': 127, 'count': 124, 'status': True, 'gradient': 21.426288197276737}, [0.21024730638520744, -2.362223324593109e-06]), ({'reward': 2.123659525280287, 'duration': 5.8943907365129, 'time_stamp': 127, 'count': 124, 'status': True, 'gradient': 21.63835920433623}, [0.0019751197304757086, -2.362223324593109e-06]), ({'reward': 1070.1575322815042, 'duration': 15.972045438625893, 'time_stamp': 127, 'count': 124, 'status': True, 'gradient': 21.42185176308614}, [1.0, -2.362223324593109e-06])]
2021-08-18:15:59:30,805 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:59:31,160 INFO     [param_server.py:553] For epoch: 128, median_reward: 290.8326392724057, dev: 290.8326392724057
2021-08-18:15:59:31,771 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4056, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:59:31,773 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1835.273, eval_time 0.5671, test_loss 2.4056, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:59:31,834 INFO     [learner.py:526] ====Start train round 128
2021-08-18:15:59:31,844 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:31,849 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5178, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:59:31,850 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1835.35, eval_time 0.6444, test_loss 2.5178, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:59:31,886 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4871, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:59:31,890 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1835.3882, eval_time 0.6844, test_loss 2.4871, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:59:31,920 INFO     [learner.py:526] ====Start train round 128
2021-08-18:15:59:31,937 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:31,960 INFO     [learner.py:526] ====Start train round 128
2021-08-18:15:59:31,984 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:33,316 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:33,337 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:33,980 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:34,1 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:34,64 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:34,77 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:35,319 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:35,334 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:35,844 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:35,858 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:35,868 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:35,880 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:36,427 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:36,441 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:36,572 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:36,581 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:37,148 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:37,162 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:59:37,278 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:37,287 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:37,587 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:37,596 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:37,833 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:59:37,847 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:37,926 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:37,938 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:38,156 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:38,166 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:38,276 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:38,307 INFO     [learner.py:606] ====Pushing takes 0.029449939727783203 s
2021-08-18:15:59:38,337 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:38,347 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:59:38,348 INFO     [param_server.py:410] Lock worker 1 with localStep 128 , while globalStep is 127

2021-08-18:15:59:39,101 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:39,113 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:39,438 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:39,461 INFO     [learner.py:606] ====Pushing takes 0.02149677276611328 s
2021-08-18:15:59:39,495 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:39,502 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:59:39,503 INFO     [param_server.py:410] Lock worker 2 with localStep 128 , while globalStep is 127

2021-08-18:15:59:39,742 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:39,751 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:40,334 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:40,343 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:40,830 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:40,867 INFO     [learner.py:606] ====Pushing takes 0.0360867977142334 s
2021-08-18:15:59:40,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:40,919 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:40,920 INFO     [param_server.py:381] ====After aggregation in epoch: 127, virtual_clock: 4177.3606048247675, top_1: : 58.7286 % (1820.0), top_5: : 100.0 % (3099.0), test loss: 2.470173831339235, test len: 3099.0
2021-08-18:15:59:40,922 INFO     [param_server.py:410] Lock worker 3 with localStep 128 , while globalStep is 128

2021-08-18:15:59:40,923 INFO     [param_server.py:441] ====Epoch 129 completes 20 clients with loss 6.9461465127909525, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:40,923 INFO     [param_server.py:450] ====Start to sample for epoch 129, global virtualClock: 4177.3606048247675, round_duration: 28.015855495488744
2021-08-18:15:59:40,924 INFO     [oort.py:208] Training selector: Pacer 127: lastExploitationUtil 367.00857932715456, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:59:40,925 INFO     [oort.py:321] scores are 26,{3: 0.1426380329375678, 5: 0.010554044108402338, 6: 0.30629391194819927, 7: 0.061518474054965876, 11: 0.139509365262397, 13: 0.0031928964144378614, 14: 0.014317587873459338, 27: 0.10958260939207802, 50: 0.05563452451726842, 51: 0.04756688215794973, 53: 0.5310996345078879, 58: 0.005518465834044791, 60: 0.0026422766581435846, 67: 0.003234106745978433, 70: 0.01262481939575039, 79: 0.012316887754172796, 81: 0.02217243666566141, 84: 0.5369512294570741, 85: 0.06139938975398755, 87: 0.010069545892754144, 93: 0.01470501886383602, 97: 0.46557585631130477, 103: 0.07873040710563312, 105: 0.06175058598817177, 110: 0.11125273191716233, 113: 0.7101143249912435, 119: 0.023677080804401434},[113, 84, 53, 97, 6, 3, 11, 110, 27, 103, 105, 7, 85, 50, 51, 119, 81, 93, 14, 70, 79, 5, 87, 58, 67, 13, 60]
2021-08-18:15:59:40,926 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:59:40,926 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:40,927 INFO     [oort.py:398] At round 127, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 128, 'count': 125, 'status': True, 'gradient': 21.645732145135256}, [1.2100071597793766e-08, -2.3437683106899294e-06]), ({'reward': 650.5664912168729, 'duration': 13.298442137908651, 'time_stamp': 128, 'count': 125, 'status': True, 'gradient': 16.9795526301001}, [0.7871780243134691, -2.3437683106899294e-06]), ({'reward': 826.4513807949863, 'duration': 15.972045438625893, 'time_stamp': 128, 'count': 125, 'status': True, 'gradient': 21.434023978593753}, [1.0, -2.3437683106899294e-06])]
2021-08-18:15:59:40,951 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:59:41,281 INFO     [param_server.py:553] For epoch: 129, median_reward: 296.94205602532685, dev: 296.94205602532685
2021-08-18:15:59:41,869 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4544, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:15:59:41,869 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1845.37, eval_time 0.5353, test_loss 2.4544, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:15:59:41,877 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7303, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:59:41,878 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1845.3786, eval_time 0.5441, test_loss 2.7303, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:59:41,940 INFO     [learner.py:526] ====Start train round 129
2021-08-18:15:59:41,945 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6164, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:15:59:41,946 INFO     [learner.py:526] ====Start train round 129
2021-08-18:15:59:41,946 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1845.4451, eval_time 0.6143, test_loss 2.6164, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:15:59:41,948 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:41,955 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:42,36 INFO     [learner.py:526] ====Start train round 129
2021-08-18:15:59:42,62 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:43,287 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:43,315 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:44,588 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:44,604 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:44,665 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:44,674 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:45,351 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:45,372 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:46,482 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:46,502 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:46,838 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:46,856 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:47,76 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:47,96 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:59:47,152 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:47,166 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:47,690 INFO     [learner.py:439] Completed to run client 103
2021-08-18:15:59:47,717 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:48,84 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:48,112 INFO     [learner.py:606] ====Pushing takes 0.027189970016479492 s
2021-08-18:15:59:48,146 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:48,152 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:59:48,153 INFO     [param_server.py:410] Lock worker 1 with localStep 129 , while globalStep is 128

2021-08-18:15:59:48,465 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:48,477 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:49,76 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:49,92 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:49,705 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:49,719 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:49,780 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:49,794 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:50,337 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:50,346 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:50,899 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:50,921 INFO     [learner.py:606] ====Pushing takes 0.021083593368530273 s
2021-08-18:15:59:50,955 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:50,963 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:59:50,963 INFO     [param_server.py:410] Lock worker 2 with localStep 129 , while globalStep is 128

2021-08-18:15:59:51,714 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:51,742 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:52,476 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:52,494 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:53,55 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:53,73 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:53,690 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:53,726 INFO     [learner.py:606] ====Pushing takes 0.0353085994720459 s
2021-08-18:15:59:53,781 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:53,790 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:53,791 INFO     [param_server.py:381] ====After aggregation in epoch: 128, virtual_clock: 4215.756626383553, top_1: : 61.7296 % (1913.0), top_5: : 100.0 % (3099.0), test loss: 2.600372106940658, test len: 3099.0
2021-08-18:15:59:53,794 INFO     [param_server.py:410] Lock worker 3 with localStep 129 , while globalStep is 129

2021-08-18:15:59:53,794 INFO     [param_server.py:441] ====Epoch 130 completes 20 clients with loss 7.887816969174963, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:53,795 INFO     [param_server.py:450] ====Start to sample for epoch 130, global virtualClock: 4215.756626383553, round_duration: 38.39602155878561
2021-08-18:15:59:53,796 INFO     [oort.py:208] Training selector: Pacer 128: lastExploitationUtil 372.9918169825902, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:15:59:53,796 INFO     [oort.py:321] scores are 26,{3: 0.30722063999157234, 5: 0.007847291873020738, 6: 0.12589195704308942, 7: 0.4612737375122414, 11: 0.061364469775733003, 13: 0.0029548641450933325, 14: 0.013250203439173125, 27: 0.10951367739251641, 50: 0.013744730535009003, 51: 0.047420497291605516, 53: 0.056110583276876375, 58: 0.0054798069917581585, 60: 0.0024124580311803475, 67: 0.002993002222647622, 70: 0.011683631827858568, 79: 0.043005745888089614, 81: 0.3500818366396995, 84: 0.11926540771966405, 85: 0.050718200925972866, 87: 0.10875218644024, 93: 0.10389216475396686, 97: 0.29365098290149716, 103: 0.08623128070224334, 105: 0.06181818378556568, 110: 0.040774235686008575, 113: 0.06132915381378772, 119: 0.02191194077360037},[7, 81, 3, 97, 6, 84, 27, 87, 93, 103, 105, 11, 113, 53, 85, 51, 79, 110, 119, 50, 14, 70, 5, 58, 67, 13, 60]
2021-08-18:15:59:53,797 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000004
2021-08-18:15:59:53,798 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:53,798 INFO     [oort.py:398] At round 128, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 772.4876850460822, 'duration': 30.380154975061778, 'time_stamp': 129, 'count': 123, 'status': True, 'gradient': 16.986585986893136}, [0.8420381435300971, -2.325599423251345e-06]), ({'reward': 366.9153148427873, 'duration': 5.8943907365129, 'time_stamp': 129, 'count': 126, 'status': True, 'gradient': 21.650370991331293}, [0.39994459459893855, -2.325599423251345e-06]), ({'reward': 831.4391362701574, 'duration': 35.433463751176646, 'time_stamp': 129, 'count': 30, 'status': True, 'gradient': 15.288045914302597}, [0.9062980838047014, -2.325599423251345e-06])]
2021-08-18:15:59:53,799 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:15:59:54,127 INFO     [param_server.py:553] For epoch: 130, median_reward: 298.4769463950464, dev: 298.4769463950464
2021-08-18:15:59:54,715 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4022, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:59:54,716 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1858.2165, eval_time 0.5282, test_loss 2.4022, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:59:54,781 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5207, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:59:54,784 INFO     [learner.py:526] ====Start train round 130
2021-08-18:15:59:54,784 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1858.2847, eval_time 0.6011, test_loss 2.5207, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:59:54,794 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:54,819 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6452, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:15:59:54,820 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1858.3182, eval_time 0.637, test_loss 2.6452, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:15:59:54,857 INFO     [learner.py:526] ====Start train round 130
2021-08-18:15:59:54,879 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:54,916 INFO     [learner.py:526] ====Start train round 130
2021-08-18:15:59:54,940 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:56,4 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:56,25 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:56,739 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:56,759 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:56,941 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:56,950 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:58,136 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:58,146 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:58,156 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:58,176 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:58,744 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:58,758 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:59,251 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:59,265 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:59,394 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:59,405 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:59,809 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:59,818 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:59,917 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:59,937 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:59,939 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:15:59:59,946 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:00,362 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:00,376 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:00,559 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:00,565 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:00,568 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:00,585 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:01,108 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:01,138 INFO     [learner.py:606] ====Pushing takes 0.02865433692932129 s
2021-08-18:16:00:01,169 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:01,178 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:01,179 INFO     [param_server.py:410] Lock worker 1 with localStep 130 , while globalStep is 129

2021-08-18:16:00:01,753 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:01,777 INFO     [learner.py:606] ====Pushing takes 0.02245950698852539 s
2021-08-18:16:00:01,806 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:01,813 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:01,814 INFO     [param_server.py:410] Lock worker 2 with localStep 130 , while globalStep is 129

2021-08-18:16:00:01,893 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:01,904 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:02,513 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:02,524 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:03,68 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:03,82 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:00:03,596 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:00:03,636 INFO     [learner.py:606] ====Pushing takes 0.03798842430114746 s
2021-08-18:16:00:03,682 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:03,692 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:03,693 INFO     [param_server.py:381] ====After aggregation in epoch: 129, virtual_clock: 4243.772481879042, top_1: : 61.4069 % (1903.0), top_5: : 100.0 % (3099.0), test loss: 2.5226920269153736, test len: 3099.0
2021-08-18:16:00:03,696 INFO     [param_server.py:410] Lock worker 3 with localStep 130 , while globalStep is 130

2021-08-18:16:00:03,697 INFO     [param_server.py:441] ====Epoch 131 completes 20 clients with loss 8.42869242549829, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:03,697 INFO     [param_server.py:450] ====Start to sample for epoch 131, global virtualClock: 4243.772481879042, round_duration: 28.015855495488744
2021-08-18:16:00:03,698 INFO     [oort.py:208] Training selector: Pacer 129: lastExploitationUtil 305.99201890990156, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:00:03,699 INFO     [oort.py:321] scores are 26,{3: 0.3043672492106486, 5: 0.007823318015529445, 6: 0.15385700099350957, 7: 0.06114179027265981, 11: 0.014456387522377786, 13: 0.0024145131100455396, 14: 0.01082716102795429, 27: 0.08962548488413215, 50: 0.03258234583374372, 51: 0.0472756253711225, 53: 0.38146516741333925, 58: 0.0053041715127062124, 60: 0.0019981267173611785, 67: 0.0024456769415197124, 70: 0.009547065731652711, 79: 0.06511228948857453, 81: 0.02203667261373287, 84: 0.182411695610212, 85: 0.009359357622404947, 87: 0.060085387908072704, 93: 0.06442569172534736, 97: 0.3674807116697808, 103: 0.04020059596591099, 105: 0.04004740667775146, 110: 0.03589792682929539, 113: 0.34682829200583465, 119: 0.017904941028254403},[53, 97, 113, 3, 84, 6, 27, 79, 93, 7, 87, 51, 103, 105, 110, 50, 81, 119, 11, 14, 70, 85, 5, 58, 67, 13, 60]
2021-08-18:16:00:03,700 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:00:03,701 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:03,702 INFO     [oort.py:398] At round 129, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 272.16782732509705, 'duration': 8.009219946401625, 'time_stamp': 130, 'count': 54, 'status': True, 'gradient': 21.45312217557268}, [0.28568651223026414, -2.3077100593081503e-06]), ({'reward': 739.9470995139577, 'duration': 15.972045438625893, 'time_stamp': 130, 'count': 127, 'status': True, 'gradient': 21.45235979307443}, [0.7767185915512573, -2.3077100593081503e-06]), ({'reward': 216.42733108454024, 'duration': 13.298442137908651, 'time_stamp': 130, 'count': 127, 'status': True, 'gradient': 16.99393172761443}, [0.22717521555969658, -2.3077100593081503e-06])]
2021-08-18:16:00:03,702 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:16:00:04,38 INFO     [param_server.py:553] For epoch: 131, median_reward: 284.01012815169787, dev: 284.01012815169787
2021-08-18:16:00:04,653 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7675, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:00:04,654 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1868.1545, eval_time 0.5715, test_loss 2.7675, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:00:04,669 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5412, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:00:04,673 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1868.1711, eval_time 0.59, test_loss 2.5412, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:00:04,695 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2649, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:00:04,696 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1868.1968, eval_time 0.611, test_loss 2.2649, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:00:04,738 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:04,746 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:04,751 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:04,764 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:04,779 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:04,786 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:06,58 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:06,67 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:07,320 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:07,341 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:07,489 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:07,500 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:08,1 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:08,28 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:09,230 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:09,256 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:09,750 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:09,759 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:09,840 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:09,861 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:09,917 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:09,928 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:10,419 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:10,441 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:10,765 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:10,786 INFO     [learner.py:606] ====Pushing takes 0.019371509552001953 s
2021-08-18:16:00:10,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:10,822 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:10,823 INFO     [param_server.py:410] Lock worker 1 with localStep 131 , while globalStep is 130

2021-08-18:16:00:11,18 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:11,32 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:11,822 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:11,836 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:12,504 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:12,524 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:12,531 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:12,545 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:13,207 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:13,225 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:13,785 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:13,807 INFO     [learner.py:606] ====Pushing takes 0.021240234375 s
2021-08-18:16:00:13,842 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:13,849 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:13,849 INFO     [param_server.py:410] Lock worker 2 with localStep 131 , while globalStep is 130

2021-08-18:16:00:14,762 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:14,775 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:15,338 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:15,347 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:15,934 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:15,946 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:00:16,639 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:00:16,677 INFO     [learner.py:606] ====Pushing takes 0.03727078437805176 s
2021-08-18:16:00:16,730 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:16,740 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:16,741 INFO     [param_server.py:381] ====After aggregation in epoch: 130, virtual_clock: 4282.168503437828, top_1: : 61.6973 % (1912.0), top_5: : 100.0 % (3099.0), test loss: 2.5245152016480765, test len: 3099.0
2021-08-18:16:00:16,743 INFO     [param_server.py:410] Lock worker 3 with localStep 131 , while globalStep is 131

2021-08-18:16:00:16,744 INFO     [param_server.py:441] ====Epoch 132 completes 20 clients with loss 6.168933823529446, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:16,744 INFO     [param_server.py:450] ====Start to sample for epoch 132, global virtualClock: 4282.168503437828, round_duration: 38.39602155878561
2021-08-18:16:00:16,745 INFO     [oort.py:208] Training selector: Pacer 130: lastExploitationUtil 396.6713315832882, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:00:16,745 INFO     [oort.py:321] scores are 25,{3: 0.236680922065397, 5: 0.08193196693989266, 6: 0.11503708499445002, 7: 0.3693522159290122, 11: 0.12817936964677953, 13: 0.002084456049440023, 27: 0.035573077321324205, 50: 0.0035782001352834825, 51: 0.10201208044248519, 53: 0.06896366214421869, 58: 0.00479611398438669, 60: 0.002140204195796598, 67: 0.002619577630549917, 70: 0.010225913080934831, 79: 0.011031539997144315, 81: 0.15153700408119095, 84: 0.64303048396249, 85: 0.009330970637468697, 87: 0.04917639705478135, 93: 0.0375654076184467, 97: 0.33346469331499723, 103: 0.0897052932474621, 105: 0.06179646939338048, 110: 0.039541380986309674, 113: 0.06095634687478274, 119: 0.019178077937303323},[84, 7, 97, 3, 81, 11, 6, 51, 103, 5, 53, 105, 113, 87, 110, 93, 27, 119, 79, 70, 85, 58, 50, 67, 60, 13]
2021-08-18:16:00:16,747 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:00:16,747 INFO     [oort.py:365] exploration poss is [34.17082011 13.46362773 12.44949144  2.63282729]
2021-08-18:16:00:16,748 INFO     [oort.py:398] At round 130, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 63, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 1087.2530235759987, 'duration': 13.298442137908651, 'time_stamp': 131, 'count': 128, 'status': True, 'gradient': 21.46563003276973}, [0.9554073135132238, -2.2900938175100593e-06]), ({'reward': 238.97710199018786, 'duration': 27.689063957948644, 'time_stamp': 131, 'count': 122, 'status': True, 'gradient': 20.928685208798093}, [0.20999070073011425, -2.2900938175100593e-06]), ({'reward': 0.01, 'duration': 43.65853298740619, 'time_stamp': 131, 'count': 109, 'status': True, 'gradient': 8.500725850623393}, [8.787430997564553e-09, -2.2900938175100593e-06])]
2021-08-18:16:00:16,748 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:16:00:17,44 INFO     [param_server.py:553] For epoch: 132, median_reward: 302.3434032008154, dev: 302.3434032008154
2021-08-18:16:00:17,722 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4456, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:00:17,723 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1881.2233, eval_time 0.6338, test_loss 2.4456, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:00:17,770 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5721, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:00:17,770 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1881.2707, eval_time 0.6784, test_loss 2.5721, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:00:17,812 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:17,820 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:17,836 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:17,844 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4346, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:00:17,845 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1881.3433, eval_time 0.7552, test_loss 2.4346, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:00:17,849 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:17,914 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:17,943 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:18,991 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:19,18 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:19,658 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:19,678 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:20,66 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:20,76 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:21,186 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:21,213 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:21,224 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:21,244 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:21,941 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:21,953 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:22,434 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:22,461 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:22,574 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:22,583 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:23,41 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:23,56 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:23,62 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:23,83 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:23,254 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:23,269 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:23,748 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:23,755 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:23,768 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:23,769 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:23,859 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:23,868 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:24,255 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:24,284 INFO     [learner.py:606] ====Pushing takes 0.027480602264404297 s
2021-08-18:16:00:24,314 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:24,322 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:24,323 INFO     [param_server.py:410] Lock worker 1 with localStep 132 , while globalStep is 131

2021-08-18:16:00:25,50 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:25,72 INFO     [learner.py:606] ====Pushing takes 0.021202564239501953 s
2021-08-18:16:00:25,98 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:25,105 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:25,106 INFO     [param_server.py:410] Lock worker 2 with localStep 132 , while globalStep is 131

2021-08-18:16:00:25,134 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:25,148 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:25,745 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:25,759 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:26,418 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:26,436 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:00:26,947 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:00:26,989 INFO     [learner.py:606] ====Pushing takes 0.03994584083557129 s
2021-08-18:16:00:27,35 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:27,45 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:27,46 INFO     [param_server.py:381] ====After aggregation in epoch: 131, virtual_clock: 4310.184358933317, top_1: : 60.6325 % (1879.0), top_5: : 100.0 % (3099.0), test loss: 2.484060353702969, test len: 3099.0
2021-08-18:16:00:27,49 INFO     [param_server.py:410] Lock worker 3 with localStep 132 , while globalStep is 132

2021-08-18:16:00:27,49 INFO     [param_server.py:441] ====Epoch 133 completes 20 clients with loss 7.843617055901831, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:27,49 INFO     [param_server.py:450] ====Start to sample for epoch 133, global virtualClock: 4310.184358933317, round_duration: 28.015855495488744
2021-08-18:16:00:27,50 INFO     [oort.py:208] Training selector: Pacer 131: lastExploitationUtil 305.6344846545205, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:00:27,51 INFO     [oort.py:321] scores are 25,{3: 0.026291618170678138, 5: 0.13572979784196068, 6: 0.6047980074961459, 7: 0.06077279647731201, 11: 0.10233356173922428, 13: 0.0027438259455463843, 27: 0.11677766537442508, 50: 0.026778970525035615, 51: 0.04699031458196604, 53: 0.42075091771162865, 58: 0.005088435834026339, 60: 0.0028536151385948412, 67: 0.0027792401783396196, 70: 0.010849179716340997, 79: 0.05990003309717539, 81: 0.17474628963868014, 84: 0.21053775461570956, 85: 0.11124887072649249, 87: 0.009947490937641402, 93: 0.014526776425053447, 97: 0.09666791090999105, 103: 0.0373647413751486, 105: 0.04467628261826401, 110: 0.0232004968788579, 113: 0.1506875377684266, 119: 0.02034697659847281},[6, 53, 84, 81, 113, 5, 27, 85, 11, 97, 7, 79, 51, 105, 103, 50, 3, 110, 119, 93, 70, 87, 58, 60, 67, 13]
2021-08-18:16:00:27,52 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:00:27,53 INFO     [oort.py:365] exploration poss is [34.17082011 13.46362773 12.44949144]
2021-08-18:16:00:27,53 INFO     [oort.py:398] At round 131, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 63, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 73.54392357039085, 'duration': 8.009219946401625, 'time_stamp': 132, 'count': 56, 'status': True, 'gradient': 21.472085061352978}, [0.08991475351876912, -2.272744490488566e-06]), ({'reward': 576.7293417097536, 'duration': 11.90395711384456, 'time_stamp': 132, 'count': 130, 'status': True, 'gradient': 21.364121965898157}, [0.705192498764502, -2.272744490488566e-06]), ({'reward': 222.4564188023288, 'duration': 13.298442137908651, 'time_stamp': 132, 'count': 129, 'status': True, 'gradient': 17.00856616959901}, [0.2719998080579427, -2.272744490488566e-06])]
2021-08-18:16:00:27,54 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105]
2021-08-18:16:00:27,374 INFO     [param_server.py:553] For epoch: 133, median_reward: 284.13298191383564, dev: 284.13298191383564
2021-08-18:16:00:27,938 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.786, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:00:27,939 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1891.4395, eval_time 0.5208, test_loss 2.786, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:00:27,987 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4734, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:00:27,988 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1891.4885, eval_time 0.5672, test_loss 2.4734, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:00:28,19 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6765, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:00:28,20 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1891.5189, eval_time 0.6021, test_loss 2.6765, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:00:28,38 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:00:28,52 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:28,58 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:00:28,71 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:28,100 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:00:28,130 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:29,147 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:29,157 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:30,354 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:30,369 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:30,869 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:30,879 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:30,941 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:30,961 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:32,164 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:32,191 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:32,822 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:32,850 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:32,873 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:32,900 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:33,153 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:33,168 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:33,410 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:33,430 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:33,764 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:33,784 INFO     [learner.py:606] ====Pushing takes 0.018766164779663086 s
2021-08-18:16:00:33,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:33,823 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:33,824 INFO     [param_server.py:410] Lock worker 1 with localStep 133 , while globalStep is 132

2021-08-18:16:00:34,166 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:34,175 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:34,836 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:34,845 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:35,489 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:35,498 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:35,845 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:35,859 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:36,586 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:36,600 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:37,171 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:37,194 INFO     [learner.py:606] ====Pushing takes 0.020678281784057617 s
2021-08-18:16:00:37,237 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:37,244 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:37,245 INFO     [param_server.py:410] Lock worker 2 with localStep 133 , while globalStep is 132

2021-08-18:16:00:37,735 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:37,749 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:38,345 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:38,355 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:38,849 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:38,860 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:00:39,401 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:00:39,437 INFO     [learner.py:606] ====Pushing takes 0.0351719856262207 s
2021-08-18:16:00:39,475 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:39,485 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:39,486 INFO     [param_server.py:381] ====After aggregation in epoch: 132, virtual_clock: 4348.580380492102, top_1: : 60.9551 % (1889.0), top_5: : 100.0 % (3099.0), test loss: 2.645296264577795, test len: 3099.0
2021-08-18:16:00:39,488 INFO     [param_server.py:410] Lock worker 3 with localStep 133 , while globalStep is 133

2021-08-18:16:00:39,488 INFO     [param_server.py:441] ====Epoch 134 completes 20 clients with loss 8.513027757515795, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:39,489 INFO     [param_server.py:450] ====Start to sample for epoch 134, global virtualClock: 4348.580380492102, round_duration: 38.39602155878561
2021-08-18:16:00:39,489 INFO     [oort.py:208] Training selector: Pacer 132: lastExploitationUtil 347.73671978659297, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:00:39,490 INFO     [oort.py:321] scores are 25,{3: 0.20086938602108814, 5: 0.04390113645997422, 6: 0.047842080548663526, 7: 0.06059109374244556, 11: 0.01432618063094553, 13: 0.0021945138627432284, 27: 0.10988771485335377, 50: 0.003556759401470704, 51: 0.0730105326272877, 53: 0.4667608522115849, 58: 0.004069734450749413, 60: 0.0020294826218429135, 67: 0.002222838190286423, 70: 0.008677181337084372, 79: 0.03272944154304487, 81: 0.25294342275565473, 84: 0.11384830558099632, 85: 0.06800011406345512, 87: 0.021315565044148402, 93: 0.01448334325827115, 97: 0.18209026722816504, 103: 0.059377566181368614, 105: 0.061775194888438086, 110: 0.008842523367311296, 113: 0.06059109374244556, 119: 0.016273525761623716},[53, 81, 3, 97, 84, 27, 51, 85, 105, 7, 113, 103, 6, 5, 79, 87, 119, 93, 11, 110, 70, 58, 50, 67, 13, 60]
2021-08-18:16:00:39,491 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:00:39,491 INFO     [oort.py:365] exploration poss is [13.46362773 12.44949144]
2021-08-18:16:00:39,492 INFO     [oort.py:398] At round 132, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 63, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 777.1512780839191, 'duration': 17.619275735353515, 'time_stamp': 133, 'count': 129, 'status': True, 'gradient': 20.41741534929604}, [0.6412124025421899, -2.2556560575643446e-06]), ({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 133, 'count': 131, 'status': True, 'gradient': 21.371443274327092}, [8.250911544322978e-09, -2.2556560575643446e-06]), ({'reward': 544.8963399593877, 'duration': 11.058674649423494, 'time_stamp': 133, 'count': 130, 'status': True, 'gradient': 20.736715691784607}, [0.44958090752241053, -2.2556560575643446e-06])]
2021-08-18:16:00:39,492 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:00:39,764 INFO     [param_server.py:553] For epoch: 134, median_reward: 292.90431598488016, dev: 292.90431598488016
2021-08-18:16:00:40,456 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6561, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:16:00:40,457 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1903.9577, eval_time 0.6493, test_loss 2.6561, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:16:00:40,540 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:00:40,542 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5484, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:16:00:40,543 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1904.0431, eval_time 0.732, test_loss 2.5484, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:16:00:40,549 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:40,578 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5901, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:16:00:40,579 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1904.0777, eval_time 0.771, test_loss 2.5901, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:16:00:40,610 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:00:40,631 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:40,648 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:00:40,677 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:41,761 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:41,771 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:42,958 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:42,972 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:43,473 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:43,487 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:43,934 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:43,954 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:45,271 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:45,284 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:45,696 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:45,705 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:45,889 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:45,910 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:46,58 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:46,80 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:46,670 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:46,691 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:46,754 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:46,774 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:47,326 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:47,330 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:47,337 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:47,350 INFO     [learner.py:606] ====Pushing takes 0.019229412078857422 s
2021-08-18:16:00:47,382 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:47,391 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:47,392 INFO     [param_server.py:410] Lock worker 1 with localStep 134 , while globalStep is 133

2021-08-18:16:00:47,855 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:47,865 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:48,930 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:48,940 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:49,582 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:49,594 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:50,526 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:50,539 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:51,125 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:51,136 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:51,814 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:51,836 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:51,838 INFO     [learner.py:606] ====Pushing takes 0.021879196166992188 s
2021-08-18:16:00:51,846 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:00:51,880 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:51,887 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:51,888 INFO     [param_server.py:410] Lock worker 2 with localStep 134 , while globalStep is 133

2021-08-18:16:00:52,366 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:00:52,406 INFO     [learner.py:606] ====Pushing takes 0.0381929874420166 s
2021-08-18:16:00:52,447 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:52,457 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:52,458 INFO     [param_server.py:381] ====After aggregation in epoch: 133, virtual_clock: 4388.443560803614, top_1: : 59.2772 % (1837.0), top_5: : 100.0 % (3099.0), test loss: 2.5982165115850946, test len: 3099.0
2021-08-18:16:00:52,460 INFO     [param_server.py:410] Lock worker 3 with localStep 134 , while globalStep is 134

2021-08-18:16:00:52,461 INFO     [param_server.py:441] ====Epoch 135 completes 20 clients with loss 4.3899747026249365, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:52,461 INFO     [param_server.py:450] ====Start to sample for epoch 135, global virtualClock: 4388.443560803614, round_duration: 39.863180311511634
2021-08-18:16:00:52,462 INFO     [oort.py:208] Training selector: Pacer 133: lastExploitationUtil 412.7327122907958, lastExplorationUtil 0.009999000099990002, last_util_record 100
2021-08-18:16:00:52,462 INFO     [oort.py:321] scores are 26,{3: 0.3648613521613975, 5: 0.007856448641013413, 6: 0.07929177109869183, 7: 0.3638915725314252, 11: 0.014283651218703789, 13: 0.0029289503444471987, 27: 0.10307493708835908, 36: 0.00359851180211868, 50: 0.058604405134042616, 51: 0.39385137466267894, 53: 0.05527075754924087, 58: 0.005431749748179122, 60: 0.0024238484822117178, 67: 0.0026488110089568423, 70: 0.011581167791901886, 79: 0.02213437703438888, 81: 0.33884971553945176, 84: 0.46416366026266875, 85: 0.08699300540243204, 87: 0.02718499761729212, 93: 0.09128647723846918, 97: 0.3389144351179759, 103: 0.09449983854422406, 105: 0.027014239380331186, 110: 0.014999718417826222, 113: 0.14332997065533248, 119: 0.021719775707087965},[84, 51, 3, 7, 97, 81, 113, 27, 103, 93, 85, 6, 50, 53, 87, 105, 79, 119, 110, 11, 70, 5, 58, 36, 13, 67, 60]
2021-08-18:16:00:52,463 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:00:52,464 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:52,465 INFO     [oort.py:398] At round 133, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 0.01, 'duration': 21.753601635627824, 'time_stamp': 134, 'count': 126, 'status': True, 'gradient': 21.6999612049813}, [1.0164646360814104e-08, -2.2388226777811796e-06]), ({'reward': 700.7896212927163, 'duration': 15.972045438625893, 'time_stamp': 134, 'count': 131, 'status': True, 'gradient': 21.493401433734718}, [0.7123177128952448, -2.2388226777811796e-06]), ({'reward': 81.58563746294045, 'duration': 8.009219946401625, 'time_stamp': 134, 'count': 58, 'status': True, 'gradient': 21.491232425493557}, [0.08291876081152656, -2.2388226777811796e-06])]
2021-08-18:16:00:52,465 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:00:52,749 INFO     [param_server.py:553] For epoch: 135, median_reward: 304.29582852378996, dev: 304.29582852378996
2021-08-18:16:00:53,449 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6671, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:16:00:53,450 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1916.9503, eval_time 0.6426, test_loss 2.6671, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:16:00:53,455 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6319, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:00:53,456 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1916.9563, eval_time 0.647, test_loss 2.6319, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:00:53,525 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:00:53,529 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:00:53,544 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:53,547 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:53,563 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9678, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:00:53,564 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1917.0631, eval_time 0.7594, test_loss 2.9678, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:00:53,632 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:00:53,666 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:54,719 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:54,729 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:56,21 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:56,42 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:56,255 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:56,265 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:56,841 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:56,868 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:58,100 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:58,114 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:58,506 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:58,521 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:58,598 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:58,610 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:58,839 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:58,853 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:59,458 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:59,478 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:59,727 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:59,736 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:00,209 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:00,231 INFO     [learner.py:606] ====Pushing takes 0.01979994773864746 s
2021-08-18:16:01:00,262 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:00,268 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:00,268 INFO     [param_server.py:410] Lock worker 1 with localStep 135 , while globalStep is 134

2021-08-18:16:01:00,300 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:00,311 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:00,885 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:00,894 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:01,362 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:01,377 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:02,20 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:02,29 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:02,609 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:02,638 INFO     [learner.py:606] ====Pushing takes 0.025722980499267578 s
2021-08-18:16:01:02,673 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:02,679 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:02,680 INFO     [param_server.py:410] Lock worker 2 with localStep 135 , while globalStep is 134

2021-08-18:16:01:03,23 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:03,33 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:03,633 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:03,645 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:04,238 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:04,249 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:04,903 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:04,941 INFO     [learner.py:606] ====Pushing takes 0.03619527816772461 s
2021-08-18:16:01:04,986 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:04,999 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:05,0 INFO     [param_server.py:381] ====After aggregation in epoch: 134, virtual_clock: 4426.8395823624, top_1: : 59.8258 % (1854.0), top_5: : 100.0 % (3099.0), test loss: 2.7555834297780635, test len: 3099.0
2021-08-18:16:01:05,2 INFO     [param_server.py:410] Lock worker 3 with localStep 135 , while globalStep is 135

2021-08-18:16:01:05,3 INFO     [param_server.py:441] ====Epoch 136 completes 20 clients with loss 5.924630576828568, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:05,3 INFO     [param_server.py:450] ====Start to sample for epoch 136, global virtualClock: 4426.8395823624, round_duration: 38.39602155878561
2021-08-18:16:01:05,4 INFO     [oort.py:208] Training selector: Pacer 134: lastExploitationUtil 316.45689132652706, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:01:05,5 INFO     [oort.py:321] scores are 26,{3: 0.14074457940532972, 5: 0.1356607465891697, 6: 0.047559441538577316, 7: 0.30503022418348835, 11: 0.24304285419902225, 13: 0.0025080718962426614, 27: 0.06532808469634971, 36: 0.0196100775445193, 50: 0.010467438451953226, 51: 0.35473081198291856, 53: 0.17185604953279865, 58: 0.0046512290372756095, 60: 0.0025240939651378215, 67: 0.002540443279762771, 70: 0.009917000306818767, 79: 0.021186682538482306, 81: 0.03032915987610372, 84: 0.06058678396771235, 85: 0.009220264325729977, 87: 0.009859157662690299, 93: 0.014397779299632422, 97: 0.4242275674874239, 103: 0.0731545799306541, 105: 0.02313240124286506, 110: 0.06161272183912664, 113: 0.5019494317157098, 119: 0.01859873082072438},[113, 97, 51, 7, 11, 53, 3, 5, 103, 27, 110, 84, 6, 81, 105, 79, 36, 119, 93, 50, 70, 87, 85, 58, 67, 60, 13]
2021-08-18:16:01:05,6 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:05,6 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:05,7 INFO     [oort.py:398] At round 134, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 229.93489874894834, 'duration': 5.8943907365129, 'time_stamp': 135, 'count': 132, 'status': True, 'gradient': 21.715686462640726}, [0.2447970980696536, -2.2222386832495074e-06]), ({'reward': 908.91110611164, 'duration': 21.753601635627824, 'time_stamp': 135, 'count': 127, 'status': True, 'gradient': 21.70786088518501}, [0.9676913948429106, -2.2222386832495074e-06]), ({'reward': 119.86391420698298, 'duration': 11.058674649423494, 'time_stamp': 135, 'count': 132, 'status': True, 'gradient': 20.757311721216748}, [0.12760641288397961, -2.2222386832495074e-06])]
2021-08-18:16:01:05,7 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:01:05,333 INFO     [param_server.py:553] For epoch: 136, median_reward: 287.2846950084217, dev: 287.2846950084217
2021-08-18:16:01:06,2 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8827, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:01:06,3 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1929.5031, eval_time 0.6131, test_loss 2.8827, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:01:06,42 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3502, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:01:06,43 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1929.5435, eval_time 0.6467, test_loss 2.3502, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:01:06,83 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:06,97 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:06,111 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:06,117 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6416, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:01:06,120 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1929.6189, eval_time 0.7314, test_loss 2.6416, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:01:06,132 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:06,190 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:06,218 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:07,254 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:07,267 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:07,979 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:07,998 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:08,381 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:08,392 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:09,235 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:09,249 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:10,35 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:10,49 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:10,142 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:10,153 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:10,450 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:10,464 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:10,915 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:10,924 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:11,17 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:11,31 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:11,585 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:11,594 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:11,599 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:11,603 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:11,613 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:11,617 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:12,75 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:12,84 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:12,138 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:12,167 INFO     [learner.py:606] ====Pushing takes 0.027392148971557617 s
2021-08-18:16:01:12,196 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:12,202 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:12,202 INFO     [param_server.py:410] Lock worker 1 with localStep 136 , while globalStep is 135

2021-08-18:16:01:12,284 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:12,298 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:13,330 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:13,340 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:13,369 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:13,394 INFO     [learner.py:606] ====Pushing takes 0.02196359634399414 s
2021-08-18:16:01:13,424 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:13,431 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:13,432 INFO     [param_server.py:410] Lock worker 2 with localStep 136 , while globalStep is 135

2021-08-18:16:01:13,861 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:13,872 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:14,569 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:14,579 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:15,116 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:15,154 INFO     [learner.py:606] ====Pushing takes 0.037244558334350586 s
2021-08-18:16:01:15,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:15,213 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:15,213 INFO     [param_server.py:381] ====After aggregation in epoch: 135, virtual_clock: 4454.855437857888, top_1: : 62.2459 % (1929.0), top_5: : 100.0 % (3099.0), test loss: 2.624857392576006, test len: 3099.0
2021-08-18:16:01:15,215 INFO     [param_server.py:410] Lock worker 3 with localStep 136 , while globalStep is 136

2021-08-18:16:01:15,216 INFO     [param_server.py:441] ====Epoch 137 completes 20 clients with loss 6.713778470174103, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:15,216 INFO     [param_server.py:450] ====Start to sample for epoch 137, global virtualClock: 4454.855437857888, round_duration: 28.015855495488744
2021-08-18:16:01:15,217 INFO     [oort.py:208] Training selector: Pacer 135: lastExploitationUtil 286.82129200714485, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:01:15,217 INFO     [oort.py:321] scores are 26,{3: 0.39429512996574145, 5: 0.007684491491937471, 6: 0.2842014860043791, 7: 0.07012634273111158, 11: 0.13226503496896144, 13: 0.0027192492280942457, 27: 0.03060812094697455, 36: 0.047413605867278996, 50: 0.04312550859092009, 51: 0.22075595849665966, 53: 0.05494650979928779, 58: 0.004634102398774884, 60: 0.0020679086089062907, 67: 0.0025310889234549205, 70: 0.00988048417787622, 79: 0.06197793772313161, 81: 0.021645626941752483, 84: 0.15695201163226044, 85: 0.00919327373329379, 87: 0.009830296829981286, 93: 0.08388218180706637, 97: 0.44395444613727586, 103: 0.006700364270249428, 105: 0.023047223697195893, 110: 0.03639953170710232, 113: 0.549440204073896, 119: 0.018530247042181962},[113, 97, 3, 6, 51, 84, 11, 93, 7, 79, 53, 36, 50, 110, 27, 105, 81, 119, 70, 87, 85, 5, 103, 58, 13, 67, 60]
2021-08-18:16:01:15,218 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:15,219 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:15,219 INFO     [oort.py:398] At round 135, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 161.82837077522606, 'duration': 27.689063957948644, 'time_stamp': 136, 'count': 127, 'status': True, 'gradient': 20.979499515675347}, [0.18936152914529286, -2.205898572783625e-06]), ({'reward': 256.2707962447489, 'duration': 11.90395711384456, 'time_stamp': 136, 'count': 134, 'status': True, 'gradient': 21.40196292173799}, [0.29987902423715546, -2.205898572783625e-06]), ({'reward': 418.2112463910154, 'duration': 8.009219946401625, 'time_stamp': 136, 'count': 60, 'status': True, 'gradient': 21.510237830361717}, [0.48938340021264937, -2.205898572783625e-06])]
2021-08-18:16:01:15,220 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:01:15,493 INFO     [param_server.py:553] For epoch: 137, median_reward: 280.19360511969643, dev: 280.19360511969643
2021-08-18:16:01:16,42 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3647, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:01:16,43 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1939.5439, eval_time 0.5034, test_loss 2.3647, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:01:16,44 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6857, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:01:16,45 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1939.5454, eval_time 0.5054, test_loss 2.6857, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:01:16,111 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:16,112 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:16,120 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:16,121 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:16,179 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6389, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:01:16,180 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1939.6784, eval_time 0.6422, test_loss 2.6389, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:01:16,260 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:16,289 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:17,324 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:17,338 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:18,655 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:18,673 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:18,962 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:18,971 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:19,499 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:19,525 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:20,685 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:20,705 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:21,84 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:21,98 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:21,272 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:21,288 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:21,292 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:21,297 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:21,857 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:21,878 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:22,204 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:22,224 INFO     [learner.py:606] ====Pushing takes 0.019120216369628906 s
2021-08-18:16:01:22,254 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:22,260 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:22,261 INFO     [param_server.py:410] Lock worker 1 with localStep 137 , while globalStep is 136

2021-08-18:16:01:22,421 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:22,430 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:23,40 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:23,55 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:23,724 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:23,738 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:23,906 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:23,917 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:24,661 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:24,673 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:25,263 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:25,285 INFO     [learner.py:606] ====Pushing takes 0.021170854568481445 s
2021-08-18:16:01:25,312 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:25,322 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:25,322 INFO     [param_server.py:410] Lock worker 2 with localStep 137 , while globalStep is 136

2021-08-18:16:01:26,11 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:26,26 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:26,751 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:26,761 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:27,333 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:27,344 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:27,895 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:27,932 INFO     [learner.py:606] ====Pushing takes 0.03585219383239746 s
2021-08-18:16:01:27,969 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:27,979 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:27,980 INFO     [param_server.py:381] ====After aggregation in epoch: 136, virtual_clock: 4493.251459416674, top_1: : 60.7615 % (1883.0), top_5: : 100.0 % (3099.0), test loss: 2.5630690013920816, test len: 3099.0
2021-08-18:16:01:27,993 INFO     [param_server.py:410] Lock worker 3 with localStep 137 , while globalStep is 137

2021-08-18:16:01:27,994 INFO     [param_server.py:441] ====Epoch 138 completes 20 clients with loss 4.302536288368985, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:27,994 INFO     [param_server.py:450] ====Start to sample for epoch 138, global virtualClock: 4493.251459416674, round_duration: 38.39602155878561
2021-08-18:16:01:27,995 INFO     [oort.py:208] Training selector: Pacer 136: lastExploitationUtil 292.76690289684376, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:01:27,996 INFO     [oort.py:321] scores are 26,{3: 0.26397413593061925, 5: 0.03261850132985071, 6: 0.25414400218794814, 7: 0.059882224612863647, 11: 0.014158575351574618, 13: 0.002626843519993037, 27: 0.05980071032885888, 36: 0.009779067752962209, 50: 0.011638701377446698, 51: 0.3699651962794784, 53: 0.05478677500013569, 58: 0.004554513285630041, 60: 0.0020323929905438328, 67: 0.0024876183426663367, 70: 0.009710790264041532, 79: 0.03188552222518174, 81: 0.12782199300513944, 84: 0.3387855168356226, 85: 0.034659181798279, 87: 0.06664223179486707, 93: 0.01431389929720704, 97: 0.4648582071500153, 103: 0.08902208371749383, 105: 0.0226513955655181, 110: 0.008739072654417122, 113: 0.7555801096603154, 119: 0.018211996429327137},[113, 97, 51, 84, 3, 6, 81, 103, 87, 7, 27, 53, 85, 5, 79, 105, 119, 93, 11, 50, 36, 70, 110, 58, 13, 67, 60]
2021-08-18:16:01:27,996 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:27,997 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:27,997 INFO     [oort.py:398] At round 136, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 137, 'count': 134, 'status': True, 'gradient': 21.732007113440336}, [1.1238277579522888e-08, -2.1897970058175624e-06]), ({'reward': 292.76802892339344, 'duration': 48.8795967667807, 'time_stamp': 137, 'count': 108, 'status': True, 'gradient': 19.578321665810854}, [0.3290096105057995, -2.1897970058175624e-06]), ({'reward': 619.0531586376235, 'duration': 8.009219946401625, 'time_stamp': 137, 'count': 61, 'status': True, 'gradient': 21.516836159997183}, [0.6956978962857293, -2.1897970058175624e-06])]
2021-08-18:16:01:27,998 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:01:28,283 INFO     [param_server.py:553] For epoch: 138, median_reward: 281.4818257671404, dev: 281.4818257671404
2021-08-18:16:01:28,944 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8335, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:01:28,945 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1952.4456, eval_time 0.6168, test_loss 2.8335, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:01:28,988 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4314, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:01:28,989 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1952.49, eval_time 0.6609, test_loss 2.4314, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:01:29,11 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:01:29,19 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:29,55 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:01:29,69 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:29,68 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6165, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:01:29,71 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1952.57, eval_time 0.7431, test_loss 2.6165, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:01:29,139 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:01:29,164 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:30,99 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:30,113 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:30,733 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:30,754 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:31,608 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:31,628 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:32,656 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:32,677 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:32,917 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:32,950 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:33,548 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:33,557 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:34,47 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:34,67 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:34,104 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:34,131 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:34,608 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:34,615 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:34,617 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:34,625 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:34,656 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:34,670 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:35,175 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:35,184 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:35,192 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:35,202 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:35,230 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:35,244 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:35,731 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:35,764 INFO     [learner.py:606] ====Pushing takes 0.03156113624572754 s
2021-08-18:16:01:35,794 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:35,800 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:35,801 INFO     [param_server.py:410] Lock worker 1 with localStep 138 , while globalStep is 137

2021-08-18:16:01:36,463 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:36,473 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:36,500 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:36,523 INFO     [learner.py:606] ====Pushing takes 0.021483659744262695 s
2021-08-18:16:01:36,554 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:36,560 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:36,561 INFO     [param_server.py:410] Lock worker 2 with localStep 138 , while globalStep is 137

2021-08-18:16:01:37,52 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:37,62 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:37,689 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:37,703 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:38,266 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:38,304 INFO     [learner.py:606] ====Pushing takes 0.03685808181762695 s
2021-08-18:16:01:38,354 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:38,364 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:38,372 INFO     [param_server.py:381] ====After aggregation in epoch: 137, virtual_clock: 4521.267314912163, top_1: : 61.1165 % (1894.0), top_5: : 100.0 % (3099.0), test loss: 2.627116349008348, test len: 3099.0
2021-08-18:16:01:38,375 INFO     [param_server.py:410] Lock worker 3 with localStep 138 , while globalStep is 138

2021-08-18:16:01:38,376 INFO     [param_server.py:441] ====Epoch 139 completes 20 clients with loss 4.730320022432822, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:38,377 INFO     [param_server.py:450] ====Start to sample for epoch 139, global virtualClock: 4521.267314912163, round_duration: 28.015855495488744
2021-08-18:16:01:38,378 INFO     [oort.py:208] Training selector: Pacer 137: lastExploitationUtil 271.37246139601575, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:01:38,378 INFO     [oort.py:321] scores are 26,{3: 0.15067627317241183, 5: 0.13559372438396494, 6: 0.3476132030980033, 7: 0.6350961230395972, 11: 0.014117697515311804, 13: 0.0024594374678436268, 27: 0.0742007531110328, 36: 0.0062537310181069545, 50: 0.02940798536967298, 51: 0.3125322434413759, 53: 0.13382019674978568, 58: 0.004004223655735699, 60: 0.0017868333189769712, 67: 0.002187057011245197, 70: 0.008537504153044542, 79: 0.006987482926782177, 81: 0.09453810481164539, 84: 0.03777675755677812, 85: 0.04473565783825935, 87: 0.009773420241604217, 93: 0.014272573018451985, 97: 0.3775239305808688, 103: 0.013956967699585059, 105: 0.019914587634434197, 110: 0.03338216254772955, 113: 0.37607297191655625, 119: 0.016011569699570623},[7, 97, 113, 6, 51, 3, 5, 53, 81, 27, 85, 84, 110, 50, 105, 119, 93, 11, 103, 87, 70, 79, 36, 58, 13, 67, 60]
2021-08-18:16:01:38,379 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:01:38,380 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:38,380 INFO     [oort.py:398] At round 137, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 138, 'count': 135, 'status': True, 'gradient': 17.051801369440305}, [1.0399166937728123e-08, -2.1739287965854843e-06]), ({'reward': 553.310846536134, 'duration': 5.8943907365129, 'time_stamp': 138, 'count': 135, 'status': True, 'gradient': 21.7362278739257}, [0.575386797390745, -2.1739287965854843e-06]), ({'reward': 331.27701124985424, 'duration': 12.029357192292537, 'time_stamp': 138, 'count': 135, 'status': True, 'gradient': 27.81020080939316}, [0.3444901054941304, -2.1739287965854843e-06])]
2021-08-18:16:01:38,382 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:01:38,736 INFO     [param_server.py:553] For epoch: 139, median_reward: 276.8463456132596, dev: 276.8463456132596
2021-08-18:16:01:39,273 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6222, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:01:39,274 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1962.7728, eval_time 0.5151, test_loss 2.6222, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:01:39,353 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:01:39,368 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5707, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:01:39,369 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:39,369 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1962.8696, eval_time 0.6075, test_loss 2.5707, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:01:39,380 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4944, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:01:39,381 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1962.8818, eval_time 0.6187, test_loss 2.4944, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:01:39,435 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:01:39,443 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:39,452 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:01:39,461 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:40,641 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:40,655 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:42,34 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:42,54 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:42,204 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:42,218 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:42,495 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:42,529 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:43,778 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:43,811 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:44,498 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:44,532 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:44,577 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:44,589 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:44,597 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:44,616 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:45,159 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:45,186 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:45,552 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:45,572 INFO     [learner.py:606] ====Pushing takes 0.018793582916259766 s
2021-08-18:16:01:45,605 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:45,612 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:45,613 INFO     [param_server.py:410] Lock worker 1 with localStep 139 , while globalStep is 138

2021-08-18:16:01:45,713 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:45,727 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:46,455 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:46,469 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:47,100 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:47,109 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:47,217 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:47,227 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:47,900 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:47,911 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:48,542 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:48,568 INFO     [learner.py:606] ====Pushing takes 0.02449321746826172 s
2021-08-18:16:01:48,603 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:48,609 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:48,610 INFO     [param_server.py:410] Lock worker 2 with localStep 139 , while globalStep is 138

2021-08-18:16:01:49,360 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:49,370 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:50,51 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:50,62 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:50,647 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:50,656 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:51,356 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:51,393 INFO     [learner.py:606] ====Pushing takes 0.036162376403808594 s
2021-08-18:16:01:51,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:51,442 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:51,442 INFO     [param_server.py:381] ====After aggregation in epoch: 138, virtual_clock: 4559.663336470949, top_1: : 61.6328 % (1910.0), top_5: : 100.0 % (3099.0), test loss: 2.562419984075758, test len: 3099.0
2021-08-18:16:01:51,444 INFO     [param_server.py:410] Lock worker 3 with localStep 139 , while globalStep is 139

2021-08-18:16:01:51,445 INFO     [param_server.py:441] ====Epoch 140 completes 20 clients with loss 4.64381650006786, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:51,446 INFO     [param_server.py:450] ====Start to sample for epoch 140, global virtualClock: 4559.663336470949, round_duration: 38.39602155878561
2021-08-18:16:01:51,446 INFO     [oort.py:208] Training selector: Pacer 138: lastExploitationUtil 275.90803276921577, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:01:51,447 INFO     [oort.py:321] scores are 26,{3: 0.16995152888623188, 5: 0.05232544873354905, 6: 0.34544643650805607, 7: 0.13995840073317978, 11: 0.014077215865475567, 13: 0.0022487869746196116, 27: 0.04849210569428356, 36: 0.028871108955914514, 50: 0.020725567708368718, 51: 0.046035649120118635, 53: 0.24372695240953712, 58: 0.004170384146749323, 60: 0.0018609803015550877, 67: 0.0022480044008148328, 70: 0.008891779039780381, 79: 0.003653294575329773, 81: 0.0940328962066491, 84: 0.19485998061744336, 85: 0.035544396514236125, 87: 0.09065993883459957, 93: 0.014231647272411, 97: 0.3939211805543936, 103: 0.09442203139722263, 105: 0.02074096946126636, 110: 0.008688855281377075, 113: 0.5640443733794689, 119: 0.01667599069897424},[113, 97, 6, 53, 84, 3, 7, 103, 81, 87, 5, 27, 51, 85, 36, 105, 50, 119, 93, 11, 70, 110, 58, 79, 13, 67, 60]
2021-08-18:16:01:51,448 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:01:51,448 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:51,448 INFO     [oort.py:398] At round 138, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 231.15930659887303, 'duration': 13.298442137908651, 'time_stamp': 139, 'count': 136, 'status': True, 'gradient': 21.538504464327307}, [0.24845444225148472, -2.1582889085533007e-06]), ({'reward': 459.9149708159723, 'duration': 26.145070720211294, 'time_stamp': 139, 'count': 131, 'status': True, 'gradient': 23.884715771711843}, [0.49433602996803877, -2.1582889085533007e-06]), ({'reward': 351.6477220683054, 'duration': 11.90395711384456, 'time_stamp': 139, 'count': 137, 'status': True, 'gradient': 21.431992369148592}, [0.37796329178519317, -2.1582889085533007e-06])]
2021-08-18:16:01:51,449 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:01:51,736 INFO     [param_server.py:553] For epoch: 140, median_reward: 277.4533514959943, dev: 277.4533514959943
2021-08-18:16:01:52,378 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.581, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:01:52,379 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1975.8791, eval_time 0.5854, test_loss 2.581, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:01:52,445 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:01:52,458 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:52,458 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0435, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:01:52,458 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1975.9589, eval_time 0.6654, test_loss 3.0435, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:01:52,506 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5235, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:01:52,509 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1976.0075, eval_time 0.7167, test_loss 2.5235, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:01:52,524 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:01:52,549 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:52,627 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:01:52,654 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:53,787 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:53,808 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:54,520 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:54,540 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:54,661 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:54,675 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:55,871 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:55,885 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:56,127 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:56,147 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:56,766 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:56,786 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:57,188 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:57,206 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:57,389 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:57,402 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:57,672 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:57,683 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:57,765 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:57,782 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:57,947 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:57,960 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:58,288 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:58,298 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:58,363 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:58,384 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:58,559 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:58,573 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:58,829 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:58,857 INFO     [learner.py:606] ====Pushing takes 0.026886701583862305 s
2021-08-18:16:01:58,886 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:58,892 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:58,893 INFO     [param_server.py:410] Lock worker 1 with localStep 140 , while globalStep is 139

2021-08-18:16:01:59,559 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:59,582 INFO     [learner.py:606] ====Pushing takes 0.02100658416748047 s
2021-08-18:16:01:59,609 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:59,616 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:59,617 INFO     [param_server.py:410] Lock worker 2 with localStep 140 , while globalStep is 139

2021-08-18:16:01:59,799 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:59,818 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:00,326 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:00,335 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:00,910 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:00,919 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:01,405 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:01,444 INFO     [learner.py:606] ====Pushing takes 0.03809547424316406 s
2021-08-18:16:02:01,485 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:01,498 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:01,499 INFO     [param_server.py:381] ====After aggregation in epoch: 139, virtual_clock: 4587.679191966437, top_1: : 61.9232 % (1919.0), top_5: : 100.0 % (3099.0), test loss: 2.716013334415577, test len: 3099.0
2021-08-18:16:02:01,502 INFO     [param_server.py:410] Lock worker 3 with localStep 140 , while globalStep is 140

2021-08-18:16:02:01,502 INFO     [param_server.py:441] ====Epoch 141 completes 20 clients with loss 5.515748302570083, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:01,503 INFO     [param_server.py:450] ====Start to sample for epoch 141, global virtualClock: 4587.679191966437, round_duration: 28.015855495488744
2021-08-18:16:02:01,504 INFO     [oort.py:208] Training selector: Pacer 139: lastExploitationUtil 303.09170910764817, lastExplorationUtil 0.0, last_util_record 100
2021-08-18:16:02:01,505 INFO     [oort.py:321] scores are 26,{3: 0.22073648443116115, 5: 0.08155257042072454, 6: 0.04687677882381695, 7: 0.05936855729275187, 11: 0.09441663168077509, 13: 0.002562499813346351, 27: 0.12842544434859512, 36: 0.018470875072331538, 50: 0.00803735083049667, 51: 0.07719625179598892, 53: 0.4531454232168409, 58: 0.004752165820168621, 60: 0.0021205928926117143, 67: 0.0023664182187182786, 70: 0.010132210114570056, 79: 0.04177054443059832, 81: 0.304060732208724, 84: 0.15959395465130377, 85: 0.09992661619533297, 87: 0.00971764045564313, 93: 0.014191115243343303, 97: 0.23690900508878293, 103: 0.06817520322979245, 105: 0.023634399777732466, 110: 0.03416489019360493, 113: 0.17757510650594754, 119: 0.01900234372387151},[53, 81, 97, 3, 113, 84, 27, 85, 11, 5, 51, 103, 7, 6, 79, 110, 105, 119, 36, 93, 70, 87, 50, 58, 13, 67, 60]
2021-08-18:16:02:01,513 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:02:01,514 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:01,514 INFO     [oort.py:398] At round 139, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.200000000000003, sampled score is [({'reward': 103.43487701444487, 'duration': 8.009219946401625, 'time_stamp': 140, 'count': 64, 'status': True, 'gradient': 21.550274026056826}, [0.11820656064241393, -2.142872449088924e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 140, 'count': 137, 'status': True, 'gradient': 21.757921345711694}, [1.1429218252459852e-08, -2.142872449088924e-06]), ({'reward': 297.45535213906385, 'duration': 21.753601635627824, 'time_stamp': 140, 'count': 132, 'status': True, 'gradient': 21.763181095073183}, [0.33995679620694574, -2.142872449088924e-06])]
2021-08-18:16:02:01,515 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:02:01,843 INFO     [param_server.py:541] Handle Wight 0.04869842529296875 | Send 0.3400239944458008
2021-08-18:16:02:01,844 INFO     [param_server.py:553] For epoch: 141, median_reward: 283.34317068905165, dev: 283.34317068905165
2021-08-18:16:02:02,452 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6971, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:02:02,453 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1985.9536, eval_time 0.5761, test_loss 2.6971, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:02:02,521 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:02,527 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6135, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:02:02,528 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1986.0271, eval_time 0.6515, test_loss 2.6135, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:02:02,529 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:02,532 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.843, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:02:02,534 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1986.0341, eval_time 0.6568, test_loss 2.843, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:02:02,605 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:02,612 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:02,624 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:02,640 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:04,20 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:04,47 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:05,265 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:05,277 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:05,431 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:05,452 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:05,966 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:05,988 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:07,72 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:07,92 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:07,668 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:07,689 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:07,725 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:07,735 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:07,885 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:07,904 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:08,233 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:08,248 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:08,521 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:08,541 INFO     [learner.py:606] ====Pushing takes 0.018866777420043945 s
2021-08-18:16:02:08,575 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:08,584 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:08,585 INFO     [param_server.py:410] Lock worker 1 with localStep 141 , while globalStep is 140

2021-08-18:16:02:09,45 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:09,56 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:09,652 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:09,666 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:10,331 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:10,345 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:10,508 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:10,518 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:11,117 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:11,126 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:02:11,668 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:02:11,690 INFO     [learner.py:606] ====Pushing takes 0.020964860916137695 s
2021-08-18:16:02:11,725 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:11,732 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:02:11,733 INFO     [param_server.py:410] Lock worker 2 with localStep 141 , while globalStep is 140

2021-08-18:16:02:12,643 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:12,657 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:13,306 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:13,318 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:13,847 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:13,857 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:14,456 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:14,492 INFO     [learner.py:606] ====Pushing takes 0.035264015197753906 s
2021-08-18:16:02:14,538 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:14,547 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:14,548 INFO     [param_server.py:381] ====After aggregation in epoch: 140, virtual_clock: 4626.075213525223, top_1: : 61.7296 % (1913.0), top_5: : 100.0 % (3099.0), test loss: 2.7178786904723555, test len: 3099.0
2021-08-18:16:02:14,550 INFO     [param_server.py:410] Lock worker 3 with localStep 141 , while globalStep is 141

2021-08-18:16:02:14,550 INFO     [param_server.py:441] ====Epoch 142 completes 20 clients with loss 5.711010662536244, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:14,551 INFO     [param_server.py:450] ====Start to sample for epoch 142, global virtualClock: 4626.075213525223, round_duration: 38.39602155878561
2021-08-18:16:02:14,552 INFO     [oort.py:208] Training selector: Pacer 140: lastExploitationUtil 308.19667034109864, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:02:14,552 INFO     [oort.py:321] scores are 26,{3: 0.3474065783900638, 5: 0.08058136136727645, 6: 0.27330105158007384, 7: 0.34251338611266013, 11: 0.03340569603238404, 13: 0.0025955480967521133, 27: 0.12320492489848911, 36: 0.0035263994954896453, 50: 0.0034751366107440597, 51: 0.045774680029172884, 53: 0.4397408118421949, 58: 0.004813453989634288, 60: 0.002147941950175843, 67: 0.002364254361758267, 70: 0.010262884134388134, 79: 0.05027256664400173, 81: 0.14884329976716312, 84: 0.24433819196220097, 85: 0.019815501936493674, 87: 0.009690150381295465, 93: 0.014150970229242762, 97: 0.4026909979516338, 103: 0.09439195349416238, 105: 0.0239392100797319, 110: 0.0273141095827783, 113: 0.120971314650166, 119: 0.019247414899092444},[53, 97, 3, 7, 6, 84, 81, 27, 113, 103, 5, 79, 51, 11, 110, 105, 85, 119, 93, 70, 87, 58, 36, 50, 13, 67, 60]
2021-08-18:16:02:14,553 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:02:14,554 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:14,554 INFO     [oort.py:398] At round 140, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 766.3571908201925, 'duration': 17.343863580585587, 'time_stamp': 141, 'count': 32, 'status': True, 'gradient': 20.49091092681942}, [0.8747970060605827, -2.1276746643593236e-06]), ({'reward': 752.4656859431781, 'duration': 15.972045438625893, 'time_stamp': 141, 'count': 138, 'status': True, 'gradient': 21.55281777248141}, [0.8589396415878188, -2.1276746643593236e-06]), ({'reward': 309.9245347646251, 'duration': 17.619275735353515, 'time_stamp': 141, 'count': 137, 'status': True, 'gradient': 20.489177049095396}, [0.35377217481131423, -2.1276746643593236e-06])]
2021-08-18:16:02:14,555 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:02:14,897 INFO     [param_server.py:553] For epoch: 142, median_reward: 284.4492498771003, dev: 284.4492498771003
2021-08-18:16:02:15,526 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5165, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:02:15,526 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 1999.027, eval_time 0.5728, test_loss 2.5165, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:02:15,597 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:15,602 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5553, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:16:02:15,603 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 1999.103, eval_time 0.6492, test_loss 2.5553, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:16:02:15,606 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:15,672 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:15,691 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:15,691 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6069, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:15,692 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 1999.1906, eval_time 0.7398, test_loss 2.6069, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:15,768 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:15,802 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:16,983 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:16,998 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:17,620 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:17,630 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:17,715 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:17,724 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:19,41 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:19,62 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:19,311 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:19,329 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:19,714 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:19,727 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:20,254 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:20,274 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:20,275 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:20,288 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:20,804 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:20,817 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:20,824 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:20,831 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:21,153 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:21,163 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:21,379 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:21,413 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:21,503 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:21,517 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:21,771 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:21,835 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:02:21,835 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:21,863 INFO     [learner.py:606] ====Pushing takes 0.02732086181640625 s
2021-08-18:16:02:21,893 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:21,900 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:21,901 INFO     [param_server.py:410] Lock worker 1 with localStep 142 , while globalStep is 141

2021-08-18:16:02:22,728 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:22,745 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:23,154 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:02:23,176 INFO     [learner.py:606] ====Pushing takes 0.02090597152709961 s
2021-08-18:16:02:23,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:23,209 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:02:23,210 INFO     [param_server.py:410] Lock worker 2 with localStep 142 , while globalStep is 141

2021-08-18:16:02:23,348 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:23,363 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:24,14 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:24,33 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:24,505 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:24,542 INFO     [learner.py:606] ====Pushing takes 0.0353245735168457 s
2021-08-18:16:02:24,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:24,591 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:24,591 INFO     [param_server.py:381] ====After aggregation in epoch: 141, virtual_clock: 4654.091069020712, top_1: : 61.052 % (1892.0), top_5: : 100.0 % (3099.0), test loss: 2.55956561477096, test len: 3099.0
2021-08-18:16:02:24,594 INFO     [param_server.py:410] Lock worker 3 with localStep 142 , while globalStep is 142

2021-08-18:16:02:24,594 INFO     [param_server.py:441] ====Epoch 143 completes 20 clients with loss 4.9111522278371815, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:24,595 INFO     [param_server.py:450] ====Start to sample for epoch 143, global virtualClock: 4654.091069020712, round_duration: 28.015855495488744
2021-08-18:16:02:24,596 INFO     [oort.py:208] Training selector: Pacer 141: lastExploitationUtil 242.98787673817375, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:02:24,596 INFO     [oort.py:321] scores are 26,{3: 0.09275752698956093, 5: 0.033874256493156285, 6: 0.24328018794132056, 7: 0.05903425481154581, 11: 0.03667424764246408, 13: 0.0021294175270788864, 27: 0.061955596156499385, 36: 0.0289403981167384, 50: 0.03185148561265899, 51: 0.10762105697695544, 53: 0.16226937828902022, 58: 0.003257805559935731, 60: 0.001453753841372796, 67: 0.0017793727582936282, 70: 0.006946047695892927, 79: 0.005760439976048794, 81: 0.021277076455830223, 84: 0.03734964880144259, 85: 0.009036743940428965, 87: 0.02694257205834495, 93: 0.032878040652955895, 97: 0.4644862934743027, 103: 0.022074461364924344, 105: 0.01620235528711171, 110: 0.008615321912851045, 113: 0.7320856939947368, 119: 0.013026889923054459},[113, 97, 6, 53, 51, 3, 27, 7, 84, 11, 5, 93, 50, 36, 87, 103, 81, 105, 119, 85, 110, 70, 79, 58, 13, 67, 60]
2021-08-18:16:02:24,597 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:02:24,598 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:24,598 INFO     [oort.py:398] At round 141, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 746.2890774760565, 'duration': 8.009219946401625, 'time_stamp': 142, 'count': 66, 'status': True, 'gradient': 21.562290497531226}, [0.6730514482019543, -2.112690934443202e-06]), ({'reward': 1108.8094576628787, 'duration': 15.972045438625893, 'time_stamp': 142, 'count': 139, 'status': True, 'gradient': 21.560837532443667}, [1.0, -2.112690934443202e-06]), ({'reward': 131.2109186050326, 'duration': 11.058674649423494, 'time_stamp': 142, 'count': 139, 'status': True, 'gradient': 18.787717957238698}, [0.11832701262165754, -2.112690934443202e-06])]
2021-08-18:16:02:24,599 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:02:24,960 INFO     [param_server.py:553] For epoch: 143, median_reward: 270.6274931772775, dev: 270.6274931772775
2021-08-18:16:02:25,592 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7297, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:02:25,593 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2009.0936, eval_time 0.5734, test_loss 2.7297, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:02:25,642 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0807, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:25,643 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2009.1432, eval_time 0.6253, test_loss 3.0807, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:25,650 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9746, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:02:25,654 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2009.1522, eval_time 0.6374, test_loss 2.9746, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:02:25,662 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:25,674 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:25,710 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:25,724 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:25,730 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:25,755 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:26,907 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:26,927 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:28,33 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:28,42 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:28,325 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:28,334 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:28,786 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:28,807 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:29,922 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:29,943 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:30,234 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:30,245 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:30,519 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:30,540 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:30,660 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:30,670 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:31,85 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:31,105 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:31,425 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:31,446 INFO     [learner.py:606] ====Pushing takes 0.019008398056030273 s
2021-08-18:16:02:31,479 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:31,488 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:31,489 INFO     [param_server.py:410] Lock worker 1 with localStep 143 , while globalStep is 142

2021-08-18:16:02:31,846 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:31,858 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:32,606 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:32,620 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:32,996 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:33,10 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:33,210 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:33,220 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:33,726 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:33,740 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:02:34,327 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:02:34,349 INFO     [learner.py:606] ====Pushing takes 0.020307064056396484 s
2021-08-18:16:02:34,382 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:34,389 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:02:34,390 INFO     [param_server.py:410] Lock worker 2 with localStep 143 , while globalStep is 142

2021-08-18:16:02:35,412 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:35,423 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:36,25 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:36,39 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:36,574 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:36,588 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:37,261 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:37,299 INFO     [learner.py:606] ====Pushing takes 0.036618947982788086 s
2021-08-18:16:02:37,345 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:37,355 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:37,356 INFO     [param_server.py:381] ====After aggregation in epoch: 142, virtual_clock: 4692.487090579498, top_1: : 61.5037 % (1906.0), top_5: : 100.0 % (3099.0), test loss: 2.928341733084785, test len: 3099.0
2021-08-18:16:02:37,358 INFO     [param_server.py:410] Lock worker 3 with localStep 143 , while globalStep is 143

2021-08-18:16:02:37,359 INFO     [param_server.py:441] ====Epoch 144 completes 20 clients with loss 4.985302686926179, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:37,360 INFO     [param_server.py:450] ====Start to sample for epoch 144, global virtualClock: 4692.487090579498, round_duration: 38.39602155878561
2021-08-18:16:02:37,360 INFO     [oort.py:208] Training selector: Pacer 142: lastExploitationUtil 223.20685590867805, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:02:37,361 INFO     [oort.py:321] scores are 26,{3: 0.13865893547616895, 5: 0.01055562367305813, 6: 0.26267399045043444, 7: 0.05886947341426419, 11: 0.16644042148284344, 13: 0.0022550105715400683, 27: 0.07677613090245397, 36: 0.020013149229591427, 50: 0.009704039025025495, 51: 0.04551864049967961, 53: 0.05386020000384094, 58: 0.004181925831322278, 60: 0.002005333012450913, 67: 0.002284115722856736, 70: 0.00891638735051587, 79: 0.0339639725190857, 81: 0.12624126180049655, 84: 0.3294123045373004, 85: 0.09498062183467132, 87: 0.055665025916262045, 93: 0.014071817130694404, 97: 0.46441401940238486, 103: 0.05864729964407326, 105: 0.020798370822588393, 110: 0.008591274098791861, 113: 0.11874677027295458, 119: 0.01672214208882621},[97, 84, 6, 11, 3, 81, 113, 85, 27, 7, 103, 87, 53, 51, 79, 105, 36, 119, 93, 5, 50, 70, 110, 58, 67, 13, 60]
2021-08-18:16:02:37,362 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:02:37,363 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:37,363 INFO     [oort.py:398] At round 142, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 204.94045910445115, 'duration': 11.90395711384456, 'time_stamp': 143, 'count': 141, 'status': True, 'gradient': 21.46479279648206}, [0.2738022004712597, -2.0979167686487338e-06]), ({'reward': 448.5104065578839, 'duration': 35.433463751176646, 'time_stamp': 143, 'count': 44, 'status': True, 'gradient': 15.380165793377644}, [0.5992295899309876, -2.0979167686487338e-06]), ({'reward': 0.01, 'duration': 21.635252629006885, 'time_stamp': 143, 'count': 94, 'status': True, 'gradient': 22.20890031217092}, [1.3360736530188397e-08, -2.0979167686487338e-06])]
2021-08-18:16:02:37,364 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:02:37,692 INFO     [param_server.py:553] For epoch: 144, median_reward: 265.79818014331954, dev: 265.79818014331954
2021-08-18:16:02:38,393 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6863, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,396 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2021.8966, eval_time 0.6707, test_loss 2.6863, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:02:38,430 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5831, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,430 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2021.929, eval_time 0.7049, test_loss 2.5831, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:02:38,430 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.69, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,433 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2021.9336, eval_time 0.703, test_loss 2.69, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:02:38,468 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:02:38,475 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:38,500 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:02:38,505 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:02:38,521 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:38,522 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:39,464 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:39,475 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:40,31 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:40,41 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:40,522 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:40,532 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:41,548 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:41,569 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:41,785 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:41,796 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:42,283 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:42,295 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:42,773 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:42,793 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:42,983 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:42,995 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:43,460 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:43,480 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:43,508 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:43,517 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:43,541 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:43,551 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:44,57 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:44,68 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:44,71 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:44,84 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:44,101 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:44,104 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:02:44,554 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:44,580 INFO     [learner.py:606] ====Pushing takes 0.024850130081176758 s
2021-08-18:16:02:44,609 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:44,615 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:44,615 INFO     [param_server.py:410] Lock worker 1 with localStep 144 , while globalStep is 143

2021-08-18:16:02:45,533 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:02:45,564 INFO     [learner.py:606] ====Pushing takes 0.029779672622680664 s
2021-08-18:16:02:45,570 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:45,591 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:45,605 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:45,612 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:02:45,622 INFO     [param_server.py:410] Lock worker 2 with localStep 144 , while globalStep is 143

2021-08-18:16:02:46,103 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:46,124 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:46,725 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:46,739 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:47,298 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:47,336 INFO     [learner.py:606] ====Pushing takes 0.036704301834106445 s
2021-08-18:16:02:47,375 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:47,388 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:47,388 INFO     [param_server.py:381] ====After aggregation in epoch: 143, virtual_clock: 4720.5029460749865, top_1: : 61.7619 % (1914.0), top_5: : 100.0 % (3099.0), test loss: 2.6531474325391984, test len: 3099.0
2021-08-18:16:02:47,391 INFO     [param_server.py:410] Lock worker 3 with localStep 144 , while globalStep is 144

2021-08-18:16:02:47,392 INFO     [param_server.py:441] ====Epoch 145 completes 20 clients with loss 5.7715656091272916, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:47,392 INFO     [param_server.py:450] ====Start to sample for epoch 145, global virtualClock: 4720.5029460749865, round_duration: 28.015855495488744
2021-08-18:16:02:47,393 INFO     [oort.py:208] Training selector: Pacer 143: lastExploitationUtil 363.5326615370143, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:02:47,394 INFO     [oort.py:321] scores are 26,{3: 0.08174698743394074, 5: 0.08827368877499478, 6: 0.04635380992639403, 7: 0.05870622703610877, 11: 0.1037290436000258, 13: 0.002737953903218929, 27: 0.11827610504758881, 36: 0.02255171953564437, 50: 0.007722442525944651, 51: 0.4391867043091147, 53: 0.5924970172591505, 58: 0.005077546108806545, 60: 0.0022657896625882814, 67: 0.001849025012706254, 70: 0.01082596146424453, 79: 0.028812031395161912, 81: 0.04512029751743731, 84: 0.22539834749574722, 85: 0.08003469583836097, 87: 0.03084311590879907, 93: 0.014032795664263303, 97: 0.4568923959674794, 103: 0.09434789600251868, 105: 0.025252644618605838, 110: 0.008567450301855562, 113: 0.6237267594758188, 119: 0.020303432179040553},[113, 53, 97, 51, 84, 27, 11, 103, 5, 3, 85, 7, 6, 81, 87, 79, 105, 36, 119, 93, 70, 110, 50, 58, 13, 60, 67]
2021-08-18:16:02:47,396 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:02:47,396 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:47,397 INFO     [oort.py:398] At round 143, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 547.9655446789459, 'duration': 8.009219946401625, 'time_stamp': 144, 'count': 68, 'status': True, 'gradient': 21.57983884843083}, [0.5650205427511402, -2.083347801026398e-06]), ({'reward': 493.9240458536469, 'duration': 12.029357192292537, 'time_stamp': 144, 'count': 141, 'status': True, 'gradient': 27.876581466667382}, [0.5092960287159716, -2.083347801026398e-06]), ({'reward': 571.119950158031, 'duration': 11.058674649423494, 'time_stamp': 144, 'count': 141, 'status': True, 'gradient': 18.80402465536011}, [0.5888960462279468, -2.083347801026398e-06])]
2021-08-18:16:02:47,397 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:02:47,723 INFO     [param_server.py:553] For epoch: 145, median_reward: 296.03737916004417, dev: 296.03737916004417
2021-08-18:16:02:48,340 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5709, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:48,341 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2031.8413, eval_time 0.5684, test_loss 2.5709, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:48,361 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.647, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:02:48,362 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2031.8608, eval_time 0.5943, test_loss 2.647, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:02:48,363 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6278, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:16:02:48,365 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2031.8649, eval_time 0.5923, test_loss 2.6278, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:16:02:48,417 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:02:48,431 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:48,458 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:02:48,472 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:48,483 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:02:48,507 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:49,576 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:49,585 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:50,711 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:50,720 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:51,152 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:51,166 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:51,257 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:51,271 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:52,286 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:52,308 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:52,840 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:52,853 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:52,890 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:52,912 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:53,463 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:53,484 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:53,633 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:53,643 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:53,813 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:53,834 INFO     [learner.py:606] ====Pushing takes 0.01878523826599121 s
2021-08-18:16:02:53,867 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:53,873 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:53,874 INFO     [param_server.py:410] Lock worker 1 with localStep 145 , while globalStep is 144

2021-08-18:16:02:54,641 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:54,652 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:55,243 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:55,253 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:55,833 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:55,854 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:55,909 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:55,919 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:56,545 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:56,565 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:02:57,89 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:02:57,118 INFO     [learner.py:606] ====Pushing takes 0.02726149559020996 s
2021-08-18:16:02:57,152 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:57,160 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:02:57,161 INFO     [param_server.py:410] Lock worker 2 with localStep 145 , while globalStep is 144

2021-08-18:16:02:58,117 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:58,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:58,846 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:58,873 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:59,415 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:59,426 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:00,40 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:00,77 INFO     [learner.py:606] ====Pushing takes 0.03493523597717285 s
2021-08-18:16:03:00,131 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:00,140 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:00,141 INFO     [param_server.py:381] ====After aggregation in epoch: 144, virtual_clock: 4758.898967633772, top_1: : 60.4389 % (1873.0), top_5: : 100.0 % (3099.0), test loss: 2.6152249486358077, test len: 3099.0
2021-08-18:16:03:00,144 INFO     [param_server.py:410] Lock worker 3 with localStep 145 , while globalStep is 145

2021-08-18:16:03:00,144 INFO     [param_server.py:441] ====Epoch 146 completes 20 clients with loss 3.8920659283201777, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:00,145 INFO     [param_server.py:450] ====Start to sample for epoch 146, global virtualClock: 4758.898967633772, round_duration: 38.39602155878561
2021-08-18:16:03:00,146 INFO     [oort.py:208] Training selector: Pacer 144: lastExploitationUtil 287.3353989180701, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:00,146 INFO     [oort.py:321] scores are 26,{3: 0.19686690221656475, 5: 0.05117870093435327, 6: 0.04622611442022417, 7: 0.06619195811258176, 11: 0.013842283977956872, 13: 0.0025288528724920737, 27: 0.0677276698165591, 36: 0.0494867436275843, 50: 0.01916809605005742, 51: 0.04526736922412995, 53: 0.17543561740137678, 58: 0.00468976743814801, 60: 0.0020927484169703564, 67: 0.002075982327701054, 70: 0.009999168983143457, 79: 0.030325192236538064, 81: 0.04632583966373442, 84: 0.4124446006283663, 85: 0.03199641793442033, 87: 0.1426026739002802, 93: 0.013994138109508435, 97: 0.1836619482348994, 103: 0.09433348363366705, 105: 0.023324067949684748, 110: 0.04224678781110352, 113: 0.7497829243570209, 119: 0.018752833174821047},[113, 84, 3, 97, 53, 87, 103, 27, 7, 5, 36, 81, 6, 51, 110, 85, 79, 105, 50, 119, 93, 11, 70, 58, 13, 60, 67]
2021-08-18:16:03:00,169 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:03:00,170 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:00,170 INFO     [oort.py:398] At round 144, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 498.66351856625, 'duration': 13.298442137908651, 'time_stamp': 145, 'count': 142, 'status': True, 'gradient': 21.58990381768498}, [0.5933588179631528, -2.0689797860674918e-06]), ({'reward': 840.4011891701723, 'duration': 35.433463751176646, 'time_stamp': 145, 'count': 46, 'status': True, 'gradient': 15.391162828666625}, [1.0, -2.0689797860674918e-06]), ({'reward': 580.9206857668578, 'duration': 8.009219946401625, 'time_stamp': 145, 'count': 69, 'status': True, 'gradient': 21.587394042330576}, [0.6912384331731063, -2.0689797860674918e-06])]
2021-08-18:16:03:00,171 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:03:00,503 INFO     [param_server.py:553] For epoch: 146, median_reward: 279.52790876155416, dev: 279.52790876155416
2021-08-18:16:03:01,183 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0789, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:03:01,188 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2044.6888, eval_time 0.6605, test_loss 3.0789, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:03:01,189 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4552, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:03:01,189 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2044.6898, eval_time 0.6627, test_loss 2.4552, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:03:01,219 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7962, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:03:01,221 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2044.7192, eval_time 0.6941, test_loss 2.7962, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:03:01,260 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:01,267 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:01,268 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:01,275 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:01,295 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:01,309 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:02,446 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:02,455 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:03,103 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:03,113 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:03,627 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:03,641 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:04,159 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:04,178 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:04,456 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:04,466 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:05,531 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:05,558 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:05,616 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:05,625 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:06,255 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:06,251 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:06,268 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:06,288 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:06,299 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:06,319 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:06,807 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:06,817 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:06,859 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:06,880 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:03:06,884 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:06,917 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:07,398 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:07,407 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:07,424 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:07,452 INFO     [learner.py:606] ====Pushing takes 0.026873111724853516 s
2021-08-18:16:03:07,482 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:07,491 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:07,492 INFO     [param_server.py:410] Lock worker 1 with localStep 146 , while globalStep is 145

2021-08-18:16:03:08,239 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:03:08,270 INFO     [learner.py:606] ====Pushing takes 0.029287338256835938 s
2021-08-18:16:03:08,298 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:08,305 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:03:08,306 INFO     [param_server.py:410] Lock worker 2 with localStep 146 , while globalStep is 145

2021-08-18:16:03:08,696 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:08,706 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:09,291 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:09,310 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:10,15 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:10,30 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:10,655 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:10,692 INFO     [learner.py:606] ====Pushing takes 0.03557777404785156 s
2021-08-18:16:03:10,740 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:10,750 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:10,751 INFO     [param_server.py:381] ====After aggregation in epoch: 145, virtual_clock: 4786.914823129261, top_1: : 61.6005 % (1909.0), top_5: : 100.0 % (3099.0), test loss: 2.776756363886374, test len: 3099.0
2021-08-18:16:03:10,754 INFO     [param_server.py:410] Lock worker 3 with localStep 146 , while globalStep is 146

2021-08-18:16:03:10,755 INFO     [param_server.py:441] ====Epoch 147 completes 20 clients with loss 5.905790946158524, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:10,755 INFO     [param_server.py:450] ====Start to sample for epoch 147, global virtualClock: 4786.914823129261, round_duration: 28.015855495488744
2021-08-18:16:03:10,756 INFO     [oort.py:208] Training selector: Pacer 145: lastExploitationUtil 328.1122109378662, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:10,757 INFO     [oort.py:321] scores are 26,{3: 0.3135633870961393, 5: 0.07124751270916452, 6: 0.11692727626285904, 7: 0.21794936163776876, 11: 0.0850488616841322, 13: 0.0027028650020523843, 27: 0.08533414392398744, 36: 0.015461014140233612, 50: 0.05143505761093146, 51: 0.045143475411456926, 53: 0.1600816604946215, 58: 0.00501247360580676, 60: 0.001997737792041679, 67: 0.0027377505568546992, 70: 0.010687218773432572, 79: 0.0035824935019789627, 81: 0.3258158086005885, 84: 0.12253139886295321, 85: 0.00893724678155511, 87: 0.14555782709129783, 93: 0.06092161757894652, 97: 0.4642012131865723, 103: 0.06059083371838837, 105: 0.02492901332949816, 110: 0.008520464732127205, 113: 0.20604740773044525, 119: 0.02004322870219077},[97, 81, 3, 7, 113, 53, 87, 84, 6, 27, 11, 5, 93, 103, 50, 51, 105, 119, 36, 70, 85, 110, 58, 79, 67, 13, 60]
2021-08-18:16:03:10,758 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:03:10,758 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:10,759 INFO     [oort.py:398] At round 145, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 120.10410474581289, 'duration': 13.298442137908651, 'time_stamp': 146, 'count': 143, 'status': True, 'gradient': 17.108701685437776}, [0.13528690100961427, -2.0548085945794165e-06]), ({'reward': 696.5224650614075, 'duration': 17.343863580585587, 'time_stamp': 146, 'count': 37, 'status': True, 'gradient': 13.687131925634802}, [0.784626411252841, -2.0548085945794165e-06]), ({'reward': 79.63835157191552, 'duration': 11.90395711384456, 'time_stamp': 146, 'count': 144, 'status': True, 'gradient': 21.492542336614985}, [0.08970193329072439, -2.0548085945794165e-06])]
2021-08-18:16:03:10,760 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:03:11,99 INFO     [param_server.py:553] For epoch: 147, median_reward: 288.89732526033356, dev: 288.89732526033356
2021-08-18:16:03:11,692 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2989, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:03:11,693 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2055.1916, eval_time 0.5599, test_loss 3.2989, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:03:11,759 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7266, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:03:11,760 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2055.2601, eval_time 0.6243, test_loss 2.7266, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:03:11,771 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:11,788 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:11,806 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5386, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:03:11,807 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2055.3075, eval_time 0.6715, test_loss 2.5386, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:03:11,831 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:11,841 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:11,877 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:11,889 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:13,40 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:13,56 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:14,54 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:14,63 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:14,596 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:14,606 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:14,678 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:14,692 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:15,752 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:15,778 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:16,154 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:16,168 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:16,403 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:16,429 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:17,25 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:17,52 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:17,72 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:17,86 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:17,419 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:17,439 INFO     [learner.py:606] ====Pushing takes 0.018407583236694336 s
2021-08-18:16:03:17,471 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:17,478 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:17,478 INFO     [param_server.py:410] Lock worker 1 with localStep 147 , while globalStep is 146

2021-08-18:16:03:18,302 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:18,322 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:18,919 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:18,928 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:19,393 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:19,420 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:19,442 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:19,451 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:20,86 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:20,106 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:03:20,628 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:03:20,656 INFO     [learner.py:606] ====Pushing takes 0.025839805603027344 s
2021-08-18:16:03:20,690 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:20,697 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:03:20,698 INFO     [param_server.py:410] Lock worker 2 with localStep 147 , while globalStep is 146

2021-08-18:16:03:21,659 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:21,671 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:22,321 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:22,331 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:22,975 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:22,989 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:23,618 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:23,655 INFO     [learner.py:606] ====Pushing takes 0.03591322898864746 s
2021-08-18:16:03:23,706 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:23,718 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:23,718 INFO     [param_server.py:381] ====After aggregation in epoch: 146, virtual_clock: 4825.310844688047, top_1: : 61.1165 % (1894.0), top_5: : 100.0 % (3099.0), test loss: 2.854710102081299, test len: 3099.0
2021-08-18:16:03:23,721 INFO     [param_server.py:410] Lock worker 3 with localStep 147 , while globalStep is 147

2021-08-18:16:03:23,721 INFO     [param_server.py:441] ====Epoch 148 completes 20 clients with loss 4.9468467554757405, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:23,722 INFO     [param_server.py:450] ====Start to sample for epoch 148, global virtualClock: 4825.310844688047, round_duration: 38.39602155878561
2021-08-18:16:03:23,723 INFO     [oort.py:208] Training selector: Pacer 146: lastExploitationUtil 315.36572135743285, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:23,723 INFO     [oort.py:321] scores are 26,{3: 0.17067437429055315, 5: 0.039987525676604366, 6: 0.27222251182926005, 7: 0.5541300422981391, 11: 0.013766860191426082, 13: 0.002015787096581157, 27: 0.007058578915419052, 36: 0.0034683154970974054, 50: 0.028293419851239874, 51: 0.045020716547547954, 53: 0.30308449704102713, 58: 0.003738284971268078, 60: 0.001549025844011148, 67: 0.0020418046191633737, 70: 0.007970489715715276, 79: 0.01835965287518767, 81: 0.020985587892402402, 84: 0.3112415856741685, 85: 0.03161585316128611, 87: 0.009530542066954556, 93: 0.1205241889001024, 97: 0.4641315812538318, 103: 0.02832746350291021, 105: 0.01859196939615711, 110: 0.08000143756697536, 113: 0.12487476057814623, 119: 0.014948168614052813},[7, 97, 84, 53, 6, 3, 113, 93, 110, 51, 5, 85, 103, 50, 81, 105, 79, 119, 11, 87, 70, 27, 58, 36, 67, 13, 60]
2021-08-18:16:03:23,724 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:03:23,725 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:23,725 INFO     [oort.py:398] At round 146, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 315.3669343025149, 'duration': 43.8287324306519, 'time_stamp': 147, 'count': 135, 'status': True, 'gradient': 19.658938570462972}, [0.26097182797252705, -2.0408302097293197e-06]), ({'reward': 1208.4045770805376, 'duration': 15.972045438625893, 'time_stamp': 147, 'count': 144, 'status': True, 'gradient': 21.603084470066868}, [1.0, -2.0408302097293197e-06]), ({'reward': 346.2623904291297, 'duration': 11.90395711384456, 'time_stamp': 147, 'count': 145, 'status': True, 'gradient': 21.49726853226175}, [0.28653918523887967, -2.0408302097293197e-06])]
2021-08-18:16:03:23,726 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 50, 105, 119]
2021-08-18:16:03:24,58 INFO     [param_server.py:553] For epoch: 148, median_reward: 286.135575229165, dev: 286.135575229165
2021-08-18:16:03:24,737 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6169, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:03:24,739 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2068.239, eval_time 0.6441, test_loss 2.6169, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:03:24,785 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9673, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:03:24,786 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2068.2867, eval_time 0.6904, test_loss 2.9673, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:03:24,821 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8539, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:03:24,824 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2068.3225, eval_time 0.7308, test_loss 2.8539, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:03:24,827 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:24,841 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:24,856 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:24,872 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:24,905 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:24,923 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:26,5 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:26,19 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:26,591 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:26,605 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:27,515 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:27,524 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:28,68 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:28,95 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:28,416 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:28,436 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:29,218 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:29,235 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:29,528 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:29,555 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:29,852 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:29,867 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:30,268 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:30,295 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:30,489 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:30,510 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:30,907 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:30,926 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:31,60 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:31,81 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:31,496 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:31,524 INFO     [learner.py:606] ====Pushing takes 0.026453018188476562 s
2021-08-18:16:03:31,555 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:31,561 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:31,562 INFO     [param_server.py:410] Lock worker 1 with localStep 148 , while globalStep is 147

2021-08-18:16:03:31,592 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:31,613 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:03:32,264 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:32,276 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:32,868 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:32,880 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:32,909 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:03:32,919 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:03:33,356 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:33,370 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:03:33,437 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:03:33,464 INFO     [learner.py:606] ====Pushing takes 0.02512502670288086 s
2021-08-18:16:03:33,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:33,515 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:03:33,516 INFO     [param_server.py:410] Lock worker 2 with localStep 148 , while globalStep is 147

2021-08-18:16:03:34,9 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:03:34,47 INFO     [learner.py:606] ====Pushing takes 0.03688979148864746 s
2021-08-18:16:03:34,91 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:34,100 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:34,101 INFO     [param_server.py:381] ====After aggregation in epoch: 147, virtual_clock: 4856.1790325023385, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 2.8127061327298484, test len: 3099.0
2021-08-18:16:03:34,104 INFO     [param_server.py:410] Lock worker 3 with localStep 148 , while globalStep is 148

2021-08-18:16:03:34,104 INFO     [param_server.py:441] ====Epoch 149 completes 20 clients with loss 10.261265191825204, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:03:34,105 INFO     [param_server.py:450] ====Start to sample for epoch 149, global virtualClock: 4856.1790325023385, round_duration: 30.86818781429151
2021-08-18:16:03:34,105 INFO     [oort.py:208] Training selector: Pacer 147: lastExploitationUtil 337.7675873665194, lastExplorationUtil 0.0, last_util_record 120
2021-08-18:16:03:34,106 INFO     [oort.py:321] scores are 24,{5: 0.13006729397273648, 6: 0.2784103564091284, 7: 0.05806819378728095, 11: 0.0775843971770178, 27: 0.0990347907320254, 36: 0.003470690064356156, 50: 0.053105448545293144, 51: 0.30912404655510867, 53: 0.05312710221197478, 58: 0.00483454097227822, 60: 0.0021573517450385483, 67: 0.0026405659719900415, 70: 0.01030784421089132, 79: 0.06492369178344327, 81: 0.09039927595113495, 84: 0.1795252294934324, 85: 0.03680340449421973, 87: 0.009504792685981246, 93: 0.05437319306244546, 97: 0.22517879428064924, 103: 0.025757071521639967, 105: 0.047166658884937124, 110: 0.022206886494966774, 113: 0.3801971795134176, 119: 0.0027193622312736304},[113, 51, 6, 97, 84, 5, 27, 81, 11, 79, 7, 93, 53, 50, 105, 85, 103, 110, 70, 87, 58, 36, 119, 67, 60]
2021-08-18:16:03:34,107 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:03:34,108 INFO     [oort.py:365] exploration poss is [143.26994305  49.77795679  13.46362773]
2021-08-18:16:03:34,109 INFO     [oort.py:398] At round 147, UCB exploited 25, augment_factor 1.0416666666666667, exploreLen 2, un-explored 62, exploration 0.0, round_threshold 11.500000000000004, sampled score is [({'reward': 306.72414856202903, 'duration': 8.009219946401625, 'time_stamp': 148, 'count': 72, 'status': True, 'gradient': 21.617429602352846}, [0.32212899622871655, -2.027040723248132e-06]), ({'reward': 173.64073919244387, 'duration': 27.035726288496562, 'time_stamp': 148, 'count': 138, 'status': True, 'gradient': 13.699575949573044}, [0.18235708196200062, -2.027040723248132e-06]), ({'reward': 806.1057131469852, 'duration': 43.65853298740619, 'time_stamp': 148, 'count': 126, 'status': True, 'gradient': 26.00544288995861}, [0.8466084753928482, -2.027040723248132e-06])]
2021-08-18:16:03:34,109 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50]
2021-08-18:16:03:34,441 INFO     [param_server.py:553] For epoch: 149, median_reward: 289.6279523872764, dev: 289.6279523872764
2021-08-18:16:03:35,25 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8332, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:03:35,35 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6999, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:03:35,36 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2078.5361, eval_time 0.5598, test_loss 2.6999, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:03:35,39 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6877, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:03:35,41 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2078.5392, eval_time 0.5648, test_loss 2.6877, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:03:35,26 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2078.5268, eval_time 0.5507, test_loss 2.8332, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:03:35,109 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:03:35,114 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:03:35,117 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:35,123 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:35,127 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:03:35,144 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:36,365 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:36,374 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:37,687 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:37,715 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:38,39 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:38,53 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:38,206 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:38,246 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:03:39,143 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:03:39,183 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:40,145 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:40,166 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:40,513 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:40,546 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:40,650 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:40,664 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:41,242 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:41,276 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:41,836 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:41,851 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:41,857 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:41,869 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:42,171 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:42,197 INFO     [learner.py:606] ====Pushing takes 0.02452564239501953 s
2021-08-18:16:03:42,231 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:42,238 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:03:42,238 INFO     [param_server.py:410] Lock worker 1 with localStep 149 , while globalStep is 148

2021-08-18:16:03:42,688 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:42,702 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:43,12 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:43,24 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:43,597 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:43,607 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:03:44,54 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:03:44,77 INFO     [learner.py:606] ====Pushing takes 0.022768735885620117 s
2021-08-18:16:03:44,106 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:44,115 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:03:44,115 INFO     [param_server.py:410] Lock worker 2 with localStep 149 , while globalStep is 148

2021-08-18:16:03:45,159 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:45,169 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:45,863 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:45,874 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:46,440 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:46,450 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:46,993 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:47,30 INFO     [learner.py:606] ====Pushing takes 0.03523898124694824 s
2021-08-18:16:03:47,75 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:47,85 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:47,86 INFO     [param_server.py:381] ====After aggregation in epoch: 148, virtual_clock: 4893.5225517754, top_1: : 61.536 % (1907.0), top_5: : 100.0 % (3099.0), test loss: 2.7402630558720342, test len: 3099.0
2021-08-18:16:03:47,88 INFO     [param_server.py:410] Lock worker 3 with localStep 149 , while globalStep is 149

2021-08-18:16:03:47,89 INFO     [param_server.py:441] ====Epoch 150 completes 20 clients with loss 8.301414940683333, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:47,90 INFO     [param_server.py:450] ====Start to sample for epoch 150, global virtualClock: 4893.5225517754, round_duration: 37.343519273061496
2021-08-18:16:03:47,91 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50, 105]
2021-08-18:16:03:47,378 INFO     [param_server.py:553] For epoch: 150, median_reward: 292.9572464214355, dev: 292.9572464214355
2021-08-18:16:03:48,8 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6552, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:03:48,12 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2091.5123, eval_time 0.5963, test_loss 2.6552, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:03:48,81 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:03:48,86 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9289, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:03:48,86 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2091.5867, eval_time 0.6736, test_loss 2.9289, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:03:48,88 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:48,135 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6781, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:03:48,138 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2091.6362, eval_time 0.7249, test_loss 2.6781, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:03:48,152 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:03:48,174 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:48,207 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:03:48,232 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:49,484 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:49,505 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:49,647 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:49,681 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:50,531 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:50,565 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:50,762 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:50,777 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:50,781 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:50,802 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:51,282 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:51,315 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:52,17 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:52,32 INFO     [learner.py:606] ====Pushing takes 0.013864517211914062 s
2021-08-18:16:03:52,48 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:52,54 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:16:03:52,54 INFO     [param_server.py:410] Lock worker 1 with localStep 150 , while globalStep is 149

2021-08-18:16:03:53,396 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:53,414 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:53,458 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:53,478 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:54,496 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:54,507 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:55,154 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:55,168 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:55,926 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:55,937 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:56,541 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:56,550 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:03:57,454 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:57,468 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:58,79 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:58,91 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:58,254 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:03:58,277 INFO     [learner.py:606] ====Pushing takes 0.02164316177368164 s
2021-08-18:16:03:58,312 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:58,320 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:58,320 INFO     [param_server.py:410] Lock worker 2 with localStep 150 , while globalStep is 149

2021-08-18:16:03:58,668 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:58,677 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:59,165 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:59,176 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:59,677 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:59,687 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:04:00,261 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:04:00,300 INFO     [learner.py:606] ====Pushing takes 0.03856301307678223 s
2021-08-18:16:04:00,346 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:00,357 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:00,358 INFO     [param_server.py:381] ====After aggregation in epoch: 149, virtual_clock: 4930.814303515483, top_1: : 61.4069 % (1903.0), top_5: : 100.0 % (3099.0), test loss: 2.7540781762864857, test len: 3099.0
2021-08-18:16:04:00,361 INFO     [param_server.py:410] Lock worker 3 with localStep 150 , while globalStep is 150

2021-08-18:16:04:00,361 INFO     [param_server.py:441] ====Epoch 151 completes 20 clients with loss 8.384863650105192, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:00,362 INFO     [param_server.py:450] ====Start to sample for epoch 151, global virtualClock: 4930.814303515483, round_duration: 37.29175174008306
2021-08-18:16:04:00,363 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50, 105]
2021-08-18:16:04:00,685 INFO     [param_server.py:553] For epoch: 151, median_reward: 305.2936322799613, dev: 305.2936322799613
2021-08-18:16:04:01,355 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7123, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:04:01,356 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2104.8563, eval_time 0.6152, test_loss 2.7123, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:04:01,434 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.096, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:16:04:01,436 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2104.9362, eval_time 0.6954, test_loss 3.096, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:16:04:01,442 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:01,451 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:01,521 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:01,522 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1127, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:04:01,523 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2105.0217, eval_time 0.7827, test_loss 3.1127, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:04:01,541 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:01,592 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:01,623 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:02,721 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:02,735 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:03,88 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:03,108 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:03,792 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:03,807 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:03,813 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:03,834 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:04,245 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:04,259 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:04,417 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:04,444 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:05,86 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:05,102 INFO     [learner.py:606] ====Pushing takes 0.014549493789672852 s
2021-08-18:16:04:05,123 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:05,130 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:16:04:05,131 INFO     [param_server.py:410] Lock worker 1 with localStep 151 , while globalStep is 150

2021-08-18:16:04:05,780 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:05,791 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:06,596 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:06,606 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:07,815 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:07,836 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:08,430 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:08,445 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:08,677 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:08,698 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:09,248 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:09,268 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:09,898 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:09,924 INFO     [learner.py:606] ====Pushing takes 0.024660348892211914 s
2021-08-18:16:04:09,957 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:09,964 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:09,965 INFO     [param_server.py:410] Lock worker 2 with localStep 151 , while globalStep is 150

2021-08-18:16:04:11,61 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:11,75 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:11,729 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:11,739 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:12,274 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:12,285 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:13,341 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:13,360 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:14,44 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:14,54 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:04:14,645 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:04:14,687 INFO     [learner.py:606] ====Pushing takes 0.04124116897583008 s
2021-08-18:16:04:14,747 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:14,758 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:14,759 INFO     [param_server.py:381] ====After aggregation in epoch: 150, virtual_clock: 4969.210325074268, top_1: : 60.6325 % (1879.0), top_5: : 100.0 % (3099.0), test loss: 2.9736766197063305, test len: 3099.0
2021-08-18:16:04:14,761 INFO     [param_server.py:410] Lock worker 3 with localStep 151 , while globalStep is 151

2021-08-18:16:04:14,762 INFO     [param_server.py:441] ====Epoch 152 completes 20 clients with loss 7.694398353367248, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:14,762 INFO     [param_server.py:450] ====Start to sample for epoch 152, global virtualClock: 4969.210325074268, round_duration: 38.39602155878561
2021-08-18:16:04:14,763 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50, 105]
2021-08-18:16:04:15,100 INFO     [param_server.py:553] For epoch: 152, median_reward: 298.9688646843128, dev: 298.9688646843128
2021-08-18:16:04:15,769 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9804, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:04:15,772 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2119.2726, eval_time 0.6478, test_loss 2.9804, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:04:15,783 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5212, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:04:15,785 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2119.2851, eval_time 0.6576, test_loss 2.5212, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:04:15,805 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9396, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:04:15,806 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2119.3047, eval_time 0.6819, test_loss 2.9396, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:04:15,844 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:15,851 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:15,865 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:15,875 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:15,877 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:15,894 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:17,54 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:17,63 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:17,138 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:17,158 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:17,753 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:17,762 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:17,872 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:17,892 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:18,268 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:18,286 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:18,533 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:18,560 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:19,31 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:19,53 INFO     [learner.py:606] ====Pushing takes 0.020773887634277344 s
2021-08-18:16:04:19,78 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:19,84 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:16:04:19,85 INFO     [param_server.py:410] Lock worker 1 with localStep 152 , while globalStep is 151

2021-08-18:16:04:19,320 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:19,330 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:20,267 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:20,279 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:20,963 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:20,973 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:21,64 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:21,85 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:21,634 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:21,639 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:21,654 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:21,660 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:23,169 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:23,193 INFO     [learner.py:606] ====Pushing takes 0.021023273468017578 s
2021-08-18:16:04:23,230 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:23,240 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:23,241 INFO     [param_server.py:410] Lock worker 2 with localStep 152 , while globalStep is 151

2021-08-18:16:04:23,427 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:23,447 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:23,976 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:23,994 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:24,591 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:24,609 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:25,75 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:25,93 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:25,691 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:25,709 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:04:26,326 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:04:26,369 INFO     [learner.py:606] ====Pushing takes 0.04041576385498047 s
2021-08-18:16:04:26,426 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:26,437 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:26,438 INFO     [param_server.py:381] ====After aggregation in epoch: 151, virtual_clock: 4999.548354205444, top_1: : 61.7941 % (1915.0), top_5: : 100.0 % (3099.0), test loss: 2.8137305952884533, test len: 3099.0
2021-08-18:16:04:26,441 INFO     [param_server.py:410] Lock worker 3 with localStep 152 , while globalStep is 152

2021-08-18:16:04:26,442 INFO     [param_server.py:441] ====Epoch 153 completes 20 clients with loss 9.553745867730902, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:26,442 INFO     [param_server.py:450] ====Start to sample for epoch 153, global virtualClock: 4999.548354205444, round_duration: 30.338029131175713
2021-08-18:16:04:26,443 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50, 105]
2021-08-18:16:04:26,775 INFO     [param_server.py:553] For epoch: 153, median_reward: 319.8003548670373, dev: 319.8003548670373
2021-08-18:16:04:27,311 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0123, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:04:27,314 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2130.8125, eval_time 0.5166, test_loss 3.0123, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:04:27,354 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7532, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:04:27,355 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2130.8558, eval_time 0.558, test_loss 2.7532, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:04:27,361 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0449, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:04:27,362 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2130.8625, eval_time 0.5622, test_loss 3.0449, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:04:27,399 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:27,413 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:27,425 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:27,432 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:27,434 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:27,441 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:28,491 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:28,511 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:28,556 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:28,566 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:29,89 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:29,110 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:29,555 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:29,566 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:29,650 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:29,670 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:29,993 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:30,7 INFO     [learner.py:606] ====Pushing takes 0.013058900833129883 s
2021-08-18:16:04:30,30 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:30,36 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:16:04:30,37 INFO     [param_server.py:410] Lock worker 1 with localStep 153 , while globalStep is 152

2021-08-18:16:04:30,42 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:30,51 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:31,606 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:31,627 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:32,470 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:32,485 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:33,583 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:33,595 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:34,289 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:34,303 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:34,663 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:34,681 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:35,431 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:35,442 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:35,977 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:36,0 INFO     [learner.py:606] ====Pushing takes 0.02131366729736328 s
2021-08-18:16:04:36,35 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:36,43 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:36,44 INFO     [param_server.py:410] Lock worker 2 with localStep 153 , while globalStep is 152

2021-08-18:16:04:36,715 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:36,733 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:37,297 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:37,308 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:37,820 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:37,836 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:39,98 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:39,117 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:39,871 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:39,885 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:04:40,491 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:04:40,530 INFO     [learner.py:606] ====Pushing takes 0.038057565689086914 s
2021-08-18:16:04:40,579 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:40,590 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:40,591 INFO     [param_server.py:381] ====After aggregation in epoch: 152, virtual_clock: 5037.94437576423, top_1: : 60.6325 % (1879.0), top_5: : 100.0 % (3099.0), test loss: 2.936788609734288, test len: 3099.0
2021-08-18:16:04:40,593 INFO     [param_server.py:410] Lock worker 3 with localStep 153 , while globalStep is 153

2021-08-18:16:04:40,594 INFO     [param_server.py:441] ====Epoch 154 completes 20 clients with loss 8.637861509463878, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:40,594 INFO     [param_server.py:450] ====Start to sample for epoch 154, global virtualClock: 5037.94437576423, round_duration: 38.39602155878561
2021-08-18:16:04:40,595 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:04:40,922 INFO     [param_server.py:553] For epoch: 154, median_reward: 338.6536288858518, dev: 338.6536288858518
2021-08-18:16:04:41,551 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4882, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:04:41,552 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2145.0529, eval_time 0.597, test_loss 2.4882, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:04:41,584 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9193, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:04:41,585 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2145.0858, eval_time 0.6301, test_loss 2.9193, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:04:41,619 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:41,627 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:41,655 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:41,661 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7999, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:04:41,662 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2145.161, eval_time 0.7075, test_loss 2.7999, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:04:41,667 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:41,731 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:41,755 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:04:42,545 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:04:42,572 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:42,950 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:42,971 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:43,693 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:43,713 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:43,870 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:43,897 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:44,55 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:44,69 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:44,611 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:44,645 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:45,327 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:45,360 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:45,668 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:45,695 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:45,871 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:45,901 INFO     [learner.py:606] ====Pushing takes 0.027539730072021484 s
2021-08-18:16:04:45,933 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:45,942 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:45,943 INFO     [param_server.py:410] Lock worker 1 with localStep 154 , while globalStep is 153

2021-08-18:16:04:46,26 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:46,41 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:46,595 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:46,605 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:47,286 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:47,300 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:47,506 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:47,515 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:48,199 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:48,208 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:49,187 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:49,201 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:49,592 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:49,615 INFO     [learner.py:606] ====Pushing takes 0.02124190330505371 s
2021-08-18:16:04:49,652 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:49,660 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:04:49,660 INFO     [param_server.py:410] Lock worker 2 with localStep 154 , while globalStep is 153

2021-08-18:16:04:49,820 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:49,839 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:50,384 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:50,396 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:51,11 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:51,20 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:51,546 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:51,582 INFO     [learner.py:606] ====Pushing takes 0.03557014465332031 s
2021-08-18:16:04:51,627 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:51,639 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:51,640 INFO     [param_server.py:381] ====After aggregation in epoch: 153, virtual_clock: 5067.413189569293, top_1: : 62.1813 % (1927.0), top_5: : 100.0 % (3099.0), test loss: 2.73576780601784, test len: 3099.0
2021-08-18:16:04:51,643 INFO     [param_server.py:410] Lock worker 3 with localStep 154 , while globalStep is 154

2021-08-18:16:04:51,643 INFO     [param_server.py:441] ====Epoch 155 completes 20 clients with loss 10.266338092157602, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:51,644 INFO     [param_server.py:450] ====Start to sample for epoch 155, global virtualClock: 5067.413189569293, round_duration: 29.468813805062297
2021-08-18:16:04:51,646 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:04:51,991 INFO     [param_server.py:553] For epoch: 155, median_reward: 283.7546597644468, dev: 283.7546597644468
2021-08-18:16:04:52,584 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6021, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:04:52,585 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5961, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:04:52,585 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2156.0859, eval_time 0.5596, test_loss 2.6021, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:04:52,586 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2156.0865, eval_time 0.5598, test_loss 2.5961, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:04:52,630 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7379, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:04:52,631 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2156.1298, eval_time 0.6061, test_loss 2.7379, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:04:52,655 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:04:52,656 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:04:52,666 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:52,667 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:52,697 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:04:52,733 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:04:53,553 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:04:53,586 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:53,754 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:53,768 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:54,880 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:54,913 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:55,8 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:55,28 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:55,546 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:55,574 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:55,607 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:55,618 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:56,169 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:56,196 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:56,572 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:56,592 INFO     [learner.py:606] ====Pushing takes 0.018460750579833984 s
2021-08-18:16:04:56,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:56,632 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:56,632 INFO     [param_server.py:410] Lock worker 1 with localStep 155 , while globalStep is 154

2021-08-18:16:04:57,315 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:57,333 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:57,947 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:57,961 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:59,72 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:59,90 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:59,716 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:59,726 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:00,125 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:00,143 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:00,834 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:00,848 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:01,414 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:01,436 INFO     [learner.py:606] ====Pushing takes 0.02115464210510254 s
2021-08-18:16:05:01,471 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:01,479 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:01,479 INFO     [param_server.py:410] Lock worker 2 with localStep 155 , while globalStep is 154

2021-08-18:16:05:02,241 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:02,255 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:03,48 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:03,66 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:03,750 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:03,760 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:04,898 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:04,908 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:05,566 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:05,604 INFO     [learner.py:606] ====Pushing takes 0.03695487976074219 s
2021-08-18:16:05:05,650 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:05,661 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:05,662 INFO     [param_server.py:381] ====After aggregation in epoch: 154, virtual_clock: 5105.8092111280785, top_1: : 61.4714 % (1905.0), top_5: : 100.0 % (3099.0), test loss: 2.645381293914936, test len: 3099.0
2021-08-18:16:05:05,664 INFO     [param_server.py:410] Lock worker 3 with localStep 155 , while globalStep is 155

2021-08-18:16:05:05,664 INFO     [param_server.py:441] ====Epoch 156 completes 20 clients with loss 7.400346028849729, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:05,665 INFO     [param_server.py:450] ====Start to sample for epoch 156, global virtualClock: 5105.8092111280785, round_duration: 38.39602155878561
2021-08-18:16:05:05,666 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:06,6 INFO     [param_server.py:553] For epoch: 156, median_reward: 287.7494703540128, dev: 287.7494703540128
2021-08-18:16:05:06,659 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7241, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:16:05:06,660 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2170.1607, eval_time 0.6096, test_loss 2.7241, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:16:05:06,663 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6444, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:05:06,664 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2170.165, eval_time 0.6116, test_loss 2.6444, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:05:06,731 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:06,735 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:06,738 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:06,744 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:06,780 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9682, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:05:06,784 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2170.2825, eval_time 0.7332, test_loss 2.9682, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:05:06,851 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:06,879 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:07,663 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:07,697 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:07,738 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:07,752 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:08,323 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:08,337 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:08,924 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:08,945 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:09,23 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:09,57 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:09,761 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:09,782 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:10,90 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:10,110 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:10,347 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:10,368 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:10,771 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:10,802 INFO     [learner.py:606] ====Pushing takes 0.028983116149902344 s
2021-08-18:16:05:10,835 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:10,841 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:10,842 INFO     [param_server.py:410] Lock worker 1 with localStep 156 , while globalStep is 155

2021-08-18:16:05:10,911 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:10,929 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:11,576 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:11,595 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:12,46 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:12,57 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:12,141 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:12,151 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:12,643 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:12,652 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:13,802 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:13,825 INFO     [learner.py:606] ====Pushing takes 0.0216672420501709 s
2021-08-18:16:05:13,836 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:13,850 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:13,864 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:13,871 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:13,872 INFO     [param_server.py:410] Lock worker 2 with localStep 156 , while globalStep is 155

2021-08-18:16:05:14,389 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:14,402 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:15,4 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:15,18 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:15,492 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:15,506 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:16,47 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:16,84 INFO     [learner.py:606] ====Pushing takes 0.035898447036743164 s
2021-08-18:16:05:16,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:16,139 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:16,140 INFO     [param_server.py:381] ====After aggregation in epoch: 155, virtual_clock: 5135.278024933141, top_1: : 60.7938 % (1884.0), top_5: : 100.0 % (3099.0), test loss: 2.7788716157277427, test len: 3099.0
2021-08-18:16:05:16,151 INFO     [param_server.py:410] Lock worker 3 with localStep 156 , while globalStep is 156

2021-08-18:16:05:16,152 INFO     [param_server.py:441] ====Epoch 157 completes 20 clients with loss 9.357959273175547, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:16,153 INFO     [param_server.py:450] ====Start to sample for epoch 157, global virtualClock: 5135.278024933141, round_duration: 29.468813805062297
2021-08-18:16:05:16,154 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:16,498 INFO     [param_server.py:553] For epoch: 157, median_reward: 293.5585068309231, dev: 293.5585068309231
2021-08-18:16:05:17,100 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5634, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:05:17,101 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2180.6015, eval_time 0.5573, test_loss 3.5634, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:05:17,106 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7159, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:16:05:17,107 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2180.6075, eval_time 0.5635, test_loss 2.7159, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:16:05:17,149 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7038, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:05:17,150 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2180.6491, eval_time 0.607, test_loss 2.7038, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:05:17,178 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:17,183 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:17,186 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:17,191 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:17,221 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:17,244 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:17,984 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:18,11 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:18,321 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:18,331 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:19,203 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:19,236 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:19,376 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:19,390 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:19,782 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:19,792 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:19,922 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:19,956 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:20,609 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:20,643 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:21,73 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:21,93 INFO     [learner.py:606] ====Pushing takes 0.018811702728271484 s
2021-08-18:16:05:21,126 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:21,133 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:21,133 INFO     [param_server.py:410] Lock worker 1 with localStep 157 , while globalStep is 156

2021-08-18:16:05:21,697 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:21,711 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:22,173 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:22,193 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:23,399 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:23,420 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:24,164 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:24,182 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:24,488 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:24,504 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:25,94 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:25,108 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:25,676 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:25,699 INFO     [learner.py:606] ====Pushing takes 0.021397829055786133 s
2021-08-18:16:05:25,733 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:25,743 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:25,744 INFO     [param_server.py:410] Lock worker 2 with localStep 157 , while globalStep is 156

2021-08-18:16:05:26,477 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:26,492 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:27,295 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:27,314 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:27,880 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:27,899 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:29,49 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:29,59 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:29,624 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:29,662 INFO     [learner.py:606] ====Pushing takes 0.036376953125 s
2021-08-18:16:05:29,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:29,710 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:29,711 INFO     [param_server.py:381] ====After aggregation in epoch: 156, virtual_clock: 5173.674046491927, top_1: : 60.7938 % (1884.0), top_5: : 100.0 % (3099.0), test loss: 2.9943768227541887, test len: 3099.0
2021-08-18:16:05:29,713 INFO     [param_server.py:410] Lock worker 3 with localStep 157 , while globalStep is 157

2021-08-18:16:05:29,713 INFO     [param_server.py:441] ====Epoch 158 completes 20 clients with loss 7.601738597529578, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:29,721 INFO     [param_server.py:450] ====Start to sample for epoch 158, global virtualClock: 5173.674046491927, round_duration: 38.39602155878561
2021-08-18:16:05:29,722 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:30,76 INFO     [param_server.py:553] For epoch: 158, median_reward: 312.03192075039044, dev: 312.03192075039044
2021-08-18:16:05:30,785 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6248, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:05:30,786 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2194.2864, eval_time 0.6748, test_loss 2.6248, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:05:30,808 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0362, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:05:30,812 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2194.3104, eval_time 0.7025, test_loss 3.0362, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:05:30,826 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9709, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:05:30,829 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2194.3296, eval_time 0.7192, test_loss 2.9709, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:05:30,854 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:30,861 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:30,899 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:30,902 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:30,913 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:30,922 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:31,633 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:31,660 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:32,40 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:32,50 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:32,646 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:32,655 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:33,2 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:33,29 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:33,46 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:33,56 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:33,813 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:33,840 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:34,518 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:34,533 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:34,541 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:34,568 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:34,892 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:34,906 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:35,109 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:35,139 INFO     [learner.py:606] ====Pushing takes 0.027425765991210938 s
2021-08-18:16:05:35,169 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:35,177 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:35,177 INFO     [param_server.py:410] Lock worker 1 with localStep 158 , while globalStep is 157

2021-08-18:16:05:35,520 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:35,534 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:36,109 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:36,130 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:36,134 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:36,143 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:36,613 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:36,622 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:37,832 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:37,856 INFO     [learner.py:606] ====Pushing takes 0.02152848243713379 s
2021-08-18:16:05:37,868 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:37,878 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:37,892 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:37,899 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:37,900 INFO     [param_server.py:410] Lock worker 2 with localStep 158 , while globalStep is 157

2021-08-18:16:05:38,385 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:38,394 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:39,3 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:39,17 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:39,619 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:39,637 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:40,244 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:40,282 INFO     [learner.py:606] ====Pushing takes 0.035906314849853516 s
2021-08-18:16:05:40,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:40,330 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:40,331 INFO     [param_server.py:381] ====After aggregation in epoch: 157, virtual_clock: 5203.142860296989, top_1: : 62.6654 % (1942.0), top_5: : 100.0 % (3099.0), test loss: 2.8773100287825972, test len: 3099.0
2021-08-18:16:05:40,333 INFO     [param_server.py:410] Lock worker 3 with localStep 158 , while globalStep is 158

2021-08-18:16:05:40,334 INFO     [param_server.py:441] ====Epoch 159 completes 20 clients with loss 9.143637039791777, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:40,334 INFO     [param_server.py:450] ====Start to sample for epoch 159, global virtualClock: 5203.142860296989, round_duration: 29.468813805062297
2021-08-18:16:05:40,335 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:40,706 INFO     [param_server.py:553] For epoch: 159, median_reward: 300.8526536301981, dev: 300.8526536301981
2021-08-18:16:05:41,340 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1003, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:05:41,341 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2204.8395, eval_time 0.591, test_loss 3.1003, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:05:41,370 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7538, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:16:05:41,371 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2204.8713, eval_time 0.621, test_loss 2.7538, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:16:05:41,372 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4865, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:05:41,372 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2204.8727, eval_time 0.619, test_loss 2.4865, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:05:41,441 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:41,441 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:41,450 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:41,450 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:41,457 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:41,478 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:42,147 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:42,168 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:42,672 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:42,691 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:43,277 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:43,297 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:43,875 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:43,882 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:43,896 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:43,896 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:44,48 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:44,58 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:44,447 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:44,469 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:44,851 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:44,871 INFO     [learner.py:606] ====Pushing takes 0.018436908721923828 s
2021-08-18:16:05:44,896 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:44,905 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:44,905 INFO     [param_server.py:410] Lock worker 1 with localStep 159 , while globalStep is 158

2021-08-18:16:05:46,331 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:46,341 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:46,475 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:46,490 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:47,561 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:47,575 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:48,274 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:48,293 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:49,354 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:49,366 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:50,9 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:50,18 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:50,644 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:50,666 INFO     [learner.py:606] ====Pushing takes 0.021090030670166016 s
2021-08-18:16:05:50,702 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:50,709 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:50,710 INFO     [param_server.py:410] Lock worker 2 with localStep 159 , while globalStep is 158

2021-08-18:16:05:50,911 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:50,932 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:51,709 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:51,729 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:52,364 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:52,382 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:53,429 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:53,444 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:54,87 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:54,136 INFO     [learner.py:606] ====Pushing takes 0.0478208065032959 s
2021-08-18:16:05:54,184 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:54,194 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:54,194 INFO     [param_server.py:381] ====After aggregation in epoch: 158, virtual_clock: 5241.538881855775, top_1: : 61.2456 % (1898.0), top_5: : 100.0 % (3099.0), test loss: 2.7802129939750384, test len: 3099.0
2021-08-18:16:05:54,197 INFO     [param_server.py:410] Lock worker 3 with localStep 159 , while globalStep is 159

2021-08-18:16:05:54,197 INFO     [param_server.py:441] ====Epoch 160 completes 20 clients with loss 6.861415165007505, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:54,198 INFO     [param_server.py:450] ====Start to sample for epoch 160, global virtualClock: 5241.538881855775, round_duration: 38.39602155878561
2021-08-18:16:05:54,199 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:54,530 INFO     [param_server.py:553] For epoch: 160, median_reward: 291.833140586836, dev: 291.833140586836
2021-08-18:16:05:55,144 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6331, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:05:55,145 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2218.6457, eval_time 0.5734, test_loss 2.6331, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:05:55,149 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5934, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:05:55,150 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2218.6507, eval_time 0.5786, test_loss 2.5934, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:05:55,215 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:05:55,218 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:05:55,223 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:55,220 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5504, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:05:55,224 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2218.7227, eval_time 0.6534, test_loss 2.5504, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:05:55,233 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:55,304 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:05:55,322 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:56,53 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:56,80 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:56,491 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:56,505 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:57,141 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:57,159 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:57,408 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:57,422 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:57,539 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:57,548 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:58,56 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:58,75 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:58,758 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:58,778 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:59,130 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:59,149 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:59,195 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:59,225 INFO     [learner.py:606] ====Pushing takes 0.028868675231933594 s
2021-08-18:16:05:59,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:59,267 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:59,268 INFO     [param_server.py:410] Lock worker 1 with localStep 160 , while globalStep is 159

2021-08-18:16:05:59,291 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:59,302 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:59,827 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:59,840 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:00,392 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:00,401 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:00,894 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:00,904 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:01,513 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:01,523 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:02,145 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:02,163 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:02,676 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:02,677 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:02,690 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:02,700 INFO     [learner.py:606] ====Pushing takes 0.021992921829223633 s
2021-08-18:16:06:02,735 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:02,742 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:02,743 INFO     [param_server.py:410] Lock worker 2 with localStep 160 , while globalStep is 159

2021-08-18:16:06:03,205 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:03,224 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:03,716 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:03,725 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:04,305 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:04,345 INFO     [learner.py:606] ====Pushing takes 0.038079023361206055 s
2021-08-18:16:06:04,392 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:04,405 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:04,406 INFO     [param_server.py:381] ====After aggregation in epoch: 159, virtual_clock: 5271.007695660837, top_1: : 62.7622 % (1945.0), top_5: : 100.0 % (3099.0), test loss: 2.5923191143406767, test len: 3099.0
2021-08-18:16:06:04,408 INFO     [param_server.py:410] Lock worker 3 with localStep 160 , while globalStep is 160

2021-08-18:16:06:04,409 INFO     [param_server.py:441] ====Epoch 161 completes 20 clients with loss 6.600638625232829, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:04,409 INFO     [param_server.py:450] ====Start to sample for epoch 161, global virtualClock: 5271.007695660837, round_duration: 29.468813805062297
2021-08-18:16:06:04,410 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:04,749 INFO     [param_server.py:541] Handle Wight 0.05080771446228027 | Send 0.3400766849517822
2021-08-18:16:06:04,753 INFO     [param_server.py:553] For epoch: 161, median_reward: 287.6307875278128, dev: 287.6307875278128
2021-08-18:16:06:05,347 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7015, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:16:06:05,348 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2228.8484, eval_time 0.5535, test_loss 2.7015, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:16:06:05,419 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:05,430 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8669, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:06:05,431 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:05,432 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2228.9302, eval_time 0.6371, test_loss 2.8669, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:06:05,432 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8596, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:06:05,432 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2228.9329, eval_time 0.6312, test_loss 2.8596, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:06:05,501 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:05,523 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:05,550 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:05,575 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:06,307 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:06,335 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:06,560 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:06,581 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:07,492 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:07,513 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:07,842 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:07,860 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:08,104 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:08,125 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:08,316 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:08,325 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:08,665 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:08,686 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:09,21 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:09,50 INFO     [learner.py:606] ====Pushing takes 0.027794361114501953 s
2021-08-18:16:06:09,74 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:09,81 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:09,82 INFO     [param_server.py:410] Lock worker 1 with localStep 161 , while globalStep is 160

2021-08-18:16:06:10,175 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:10,195 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:10,589 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:10,599 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:11,665 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:11,675 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:12,368 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:12,377 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:12,947 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:12,965 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:13,702 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:13,716 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:14,303 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:14,328 INFO     [learner.py:606] ====Pushing takes 0.022925615310668945 s
2021-08-18:16:06:14,362 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:14,370 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:14,370 INFO     [param_server.py:410] Lock worker 2 with localStep 161 , while globalStep is 160

2021-08-18:16:06:14,733 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:14,747 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:15,368 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:15,387 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:15,942 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:15,960 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:17,10 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:17,29 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:17,586 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:17,621 INFO     [learner.py:606] ====Pushing takes 0.0335698127746582 s
2021-08-18:16:06:17,660 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:17,675 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:17,676 INFO     [param_server.py:381] ====After aggregation in epoch: 160, virtual_clock: 5309.403717219623, top_1: : 61.6328 % (1910.0), top_5: : 100.0 % (3099.0), test loss: 2.8093473249011574, test len: 3099.0
2021-08-18:16:06:17,678 INFO     [param_server.py:410] Lock worker 3 with localStep 161 , while globalStep is 161

2021-08-18:16:06:17,678 INFO     [param_server.py:441] ====Epoch 162 completes 20 clients with loss 7.413000261229652, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:17,679 INFO     [param_server.py:450] ====Start to sample for epoch 162, global virtualClock: 5309.403717219623, round_duration: 38.39602155878561
2021-08-18:16:06:17,680 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:18,19 INFO     [param_server.py:553] For epoch: 162, median_reward: 296.6822559282052, dev: 296.6822559282052
2021-08-18:16:06:18,663 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.293, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:06:18,664 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2242.1642, eval_time 0.5988, test_loss 3.293, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:06:18,694 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5526, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:06:18,695 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2242.1958, eval_time 0.6236, test_loss 2.5526, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:06:18,734 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:18,746 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:18,745 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0012, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:06:18,749 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2242.2476, eval_time 0.684, test_loss 3.0012, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:06:18,762 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:18,780 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:18,846 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:18,881 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:19,743 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:19,777 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:19,916 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:19,937 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:20,724 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:20,737 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:20,988 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:21,9 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:21,129 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:21,144 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:21,520 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:21,535 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:22,82 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:22,100 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:22,442 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:22,445 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:22,459 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:22,478 INFO     [learner.py:606] ====Pushing takes 0.03343987464904785 s
2021-08-18:16:06:22,510 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:22,516 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:22,517 INFO     [param_server.py:410] Lock worker 1 with localStep 162 , while globalStep is 161

2021-08-18:16:06:23,64 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:23,76 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:23,742 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:23,751 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:24,350 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:24,364 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:24,389 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:24,399 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:25,29 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:25,43 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:26,123 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:26,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:26,230 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:26,253 INFO     [learner.py:606] ====Pushing takes 0.021271467208862305 s
2021-08-18:16:06:26,280 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:26,291 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:26,292 INFO     [param_server.py:410] Lock worker 2 with localStep 162 , while globalStep is 161

2021-08-18:16:06:26,612 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:26,623 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:27,256 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:27,270 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:27,923 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:27,938 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:28,586 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:28,623 INFO     [learner.py:606] ====Pushing takes 0.034943580627441406 s
2021-08-18:16:06:28,667 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:28,677 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:28,677 INFO     [param_server.py:381] ====After aggregation in epoch: 161, virtual_clock: 5338.8725310246855, top_1: : 61.5682 % (1908.0), top_5: : 100.0 % (3099.0), test loss: 2.9489351378546824, test len: 3099.0
2021-08-18:16:06:28,680 INFO     [param_server.py:410] Lock worker 3 with localStep 162 , while globalStep is 162

2021-08-18:16:06:28,680 INFO     [param_server.py:441] ====Epoch 163 completes 20 clients with loss 8.253198849821977, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:28,680 INFO     [param_server.py:450] ====Start to sample for epoch 163, global virtualClock: 5338.8725310246855, round_duration: 29.468813805062297
2021-08-18:16:06:28,681 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:29,10 INFO     [param_server.py:553] For epoch: 163, median_reward: 291.7484227183605, dev: 291.7484227183605
2021-08-18:16:06:29,715 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6289, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:06:29,717 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2253.2156, eval_time 0.6515, test_loss 2.6289, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:06:29,784 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9859, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:16:06:29,783 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4145, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:06:29,794 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2253.2943, eval_time 0.7247, test_loss 2.4145, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:06:29,788 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2253.2881, eval_time 0.7221, test_loss 2.9859, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:16:06:29,812 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:29,839 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:29,864 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:29,871 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:29,872 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:29,880 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:30,656 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:30,690 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:30,986 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:31,0 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:31,984 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:32,17 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:32,96 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:32,114 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:32,698 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:32,724 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:32,755 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:32,769 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:33,331 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:33,357 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:33,731 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:33,753 INFO     [learner.py:606] ====Pushing takes 0.021326065063476562 s
2021-08-18:16:06:33,785 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:33,792 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:33,793 INFO     [param_server.py:410] Lock worker 1 with localStep 163 , while globalStep is 162

2021-08-18:16:06:34,430 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:34,449 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:35,225 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:35,235 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:36,515 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:36,524 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:37,97 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:37,104 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:37,107 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:37,118 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:37,773 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:37,788 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:38,449 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:38,474 INFO     [learner.py:606] ====Pushing takes 0.02098369598388672 s
2021-08-18:16:06:38,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:38,514 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:38,515 INFO     [param_server.py:410] Lock worker 2 with localStep 163 , while globalStep is 162

2021-08-18:16:06:39,166 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:39,175 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:39,980 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:39,994 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:40,670 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:40,685 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:41,843 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:41,861 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:42,525 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:42,562 INFO     [learner.py:606] ====Pushing takes 0.03642678260803223 s
2021-08-18:16:06:42,611 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:42,621 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:42,622 INFO     [param_server.py:381] ====After aggregation in epoch: 162, virtual_clock: 5377.268552583471, top_1: : 60.2452 % (1867.0), top_5: : 100.0 % (3099.0), test loss: 2.676403723933079, test len: 3099.0
2021-08-18:16:06:42,625 INFO     [param_server.py:410] Lock worker 3 with localStep 163 , while globalStep is 163

2021-08-18:16:06:42,625 INFO     [param_server.py:441] ====Epoch 164 completes 20 clients with loss 8.026119492703176, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:42,626 INFO     [param_server.py:450] ====Start to sample for epoch 164, global virtualClock: 5377.268552583471, round_duration: 38.39602155878561
2021-08-18:16:06:42,627 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:42,960 INFO     [param_server.py:553] For epoch: 164, median_reward: 301.22628556653234, dev: 301.22628556653234
2021-08-18:16:06:43,661 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7538, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:06:43,662 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2267.1625, eval_time 0.6581, test_loss 2.7538, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:06:43,660 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4962, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:06:43,663 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2267.1639, eval_time 0.6558, test_loss 2.4962, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:06:43,732 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:43,741 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7553, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:06:43,745 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2267.2433, eval_time 0.7407, test_loss 2.7553, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:06:43,747 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:43,748 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:43,761 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:43,814 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:43,849 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:44,635 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:44,668 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:44,931 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:44,945 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:45,599 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:45,609 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:45,976 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:46,3 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:46,147 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:46,156 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:46,613 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:46,633 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:47,271 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:47,285 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:47,285 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:47,305 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:47,808 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:47,840 INFO     [learner.py:606] ====Pushing takes 0.026931285858154297 s
2021-08-18:16:06:47,869 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:47,875 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:47,875 INFO     [param_server.py:410] Lock worker 1 with localStep 164 , while globalStep is 163

2021-08-18:16:06:48,31 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:48,49 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:48,680 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:48,689 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:49,150 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:49,168 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:49,190 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:49,206 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:49,738 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:49,748 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:50,711 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:50,722 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:50,823 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:50,846 INFO     [learner.py:606] ====Pushing takes 0.021273136138916016 s
2021-08-18:16:06:50,883 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:50,890 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:50,891 INFO     [param_server.py:410] Lock worker 2 with localStep 164 , while globalStep is 163

2021-08-18:16:06:51,305 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:51,317 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:51,816 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:51,828 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:52,349 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:52,359 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:52,958 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:52,996 INFO     [learner.py:606] ====Pushing takes 0.036197662353515625 s
2021-08-18:16:06:53,43 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:53,53 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:53,54 INFO     [param_server.py:381] ====After aggregation in epoch: 163, virtual_clock: 5406.737366388534, top_1: : 62.4072 % (1934.0), top_5: : 100.0 % (3099.0), test loss: 2.6684617974140026, test len: 3099.0
2021-08-18:16:06:53,58 INFO     [param_server.py:410] Lock worker 3 with localStep 164 , while globalStep is 164

2021-08-18:16:06:53,59 INFO     [param_server.py:441] ====Epoch 165 completes 20 clients with loss 6.28618387364547, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:53,59 INFO     [param_server.py:450] ====Start to sample for epoch 165, global virtualClock: 5406.737366388534, round_duration: 29.468813805062297
2021-08-18:16:06:53,60 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:06:53,393 INFO     [param_server.py:553] For epoch: 165, median_reward: 276.58653827464246, dev: 276.58653827464246
2021-08-18:16:06:54,29 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8242, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:06:54,30 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2277.5285, eval_time 0.5919, test_loss 2.8242, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:06:54,41 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2412, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:16:06:54,42 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2277.5421, eval_time 0.6012, test_loss 3.2412, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:16:06:54,87 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.997, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:06:54,88 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2277.5884, eval_time 0.6425, test_loss 3.997, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:06:54,105 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:06:54,110 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:06:54,119 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:54,133 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:54,157 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:06:54,171 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:54,951 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:54,984 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:55,372 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:55,392 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:56,241 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:56,274 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:56,600 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:56,618 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:56,958 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:56,958 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:56,973 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:56,992 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:57,633 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:57,667 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:58,86 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:58,106 INFO     [learner.py:606] ====Pushing takes 0.01842331886291504 s
2021-08-18:16:06:58,138 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:58,145 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:58,146 INFO     [param_server.py:410] Lock worker 1 with localStep 165 , while globalStep is 164

2021-08-18:16:06:58,907 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:58,925 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:59,506 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:59,516 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:00,689 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:00,703 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:01,418 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:01,432 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:01,726 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:01,747 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:02,440 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:02,455 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:02,960 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:02,983 INFO     [learner.py:606] ====Pushing takes 0.02097153663635254 s
2021-08-18:16:07:03,18 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:03,31 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:03,32 INFO     [param_server.py:410] Lock worker 2 with localStep 165 , while globalStep is 164

2021-08-18:16:07:03,682 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:03,696 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:04,353 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:04,362 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:05,731 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:05,742 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:06,343 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:06,358 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:07:06,988 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:07:07,23 INFO     [learner.py:606] ====Pushing takes 0.03360915184020996 s
2021-08-18:16:07:07,61 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:07,72 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:07,72 INFO     [param_server.py:381] ====After aggregation in epoch: 164, virtual_clock: 5445.1333879473195, top_1: : 61.2778 % (1899.0), top_5: : 100.0 % (3099.0), test loss: 3.3541493459984104, test len: 3099.0
2021-08-18:16:07:07,75 INFO     [param_server.py:410] Lock worker 3 with localStep 165 , while globalStep is 165

2021-08-18:16:07:07,76 INFO     [param_server.py:441] ====Epoch 166 completes 20 clients with loss 9.256721651439808, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:07,76 INFO     [param_server.py:450] ====Start to sample for epoch 166, global virtualClock: 5445.1333879473195, round_duration: 38.39602155878561
2021-08-18:16:07:07,77 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:07:07,414 INFO     [param_server.py:553] For epoch: 166, median_reward: 293.55552150266135, dev: 293.55552150266135
2021-08-18:16:07:08,96 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1377, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:07:08,100 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2291.6006, eval_time 0.6407, test_loss 3.1377, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:07:08,103 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0685, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:16:07:08,106 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2291.6067, eval_time 0.6471, test_loss 3.0685, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:16:07:08,167 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:08,174 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:08,185 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:08,186 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:08,221 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9521, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:07:08,224 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2291.723, eval_time 0.7652, test_loss 2.9521, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:07:08,317 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:08,353 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:09,125 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:09,158 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:09,496 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:09,511 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:10,163 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:10,172 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:10,520 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:10,547 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:10,712 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:10,731 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:11,163 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:11,190 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:11,853 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:11,874 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:11,903 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:11,918 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:12,398 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:12,427 INFO     [learner.py:606] ====Pushing takes 0.027526140213012695 s
2021-08-18:16:07:12,455 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:12,461 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:12,462 INFO     [param_server.py:410] Lock worker 1 with localStep 166 , while globalStep is 165

2021-08-18:16:07:12,573 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:12,582 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:13,184 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:13,195 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:13,784 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:13,793 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:13,845 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:13,855 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:14,435 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:14,444 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:15,559 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:15,573 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:15,677 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:15,699 INFO     [learner.py:606] ====Pushing takes 0.020776987075805664 s
2021-08-18:16:07:15,727 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:15,734 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:15,735 INFO     [param_server.py:410] Lock worker 2 with localStep 166 , while globalStep is 165

2021-08-18:16:07:16,182 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:16,196 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:16,897 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:16,907 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:17,576 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:17,586 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:07:18,141 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:07:18,178 INFO     [learner.py:606] ====Pushing takes 0.036368370056152344 s
2021-08-18:16:07:18,216 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:18,226 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:18,227 INFO     [param_server.py:381] ====After aggregation in epoch: 165, virtual_clock: 5474.602201752382, top_1: : 61.1488 % (1895.0), top_5: : 100.0 % (3099.0), test loss: 3.0527699346895574, test len: 3099.0
2021-08-18:16:07:18,229 INFO     [param_server.py:410] Lock worker 3 with localStep 166 , while globalStep is 166

2021-08-18:16:07:18,230 INFO     [param_server.py:441] ====Epoch 167 completes 20 clients with loss 8.626174024194874, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:18,230 INFO     [param_server.py:450] ====Start to sample for epoch 167, global virtualClock: 5474.602201752382, round_duration: 29.468813805062297
2021-08-18:16:07:18,231 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:07:18,524 INFO     [param_server.py:553] For epoch: 167, median_reward: 286.9672099641769, dev: 286.9672099641769
2021-08-18:16:07:19,145 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7594, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:07:19,146 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2302.6465, eval_time 0.5751, test_loss 2.7594, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:07:19,202 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:19,209 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9847, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:07:19,211 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2302.7094, eval_time 0.6421, test_loss 2.9847, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:07:19,211 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:19,215 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3907, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:07:19,216 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2302.7169, eval_time 0.6441, test_loss 2.3907, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:07:19,287 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:19,296 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:19,330 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:19,363 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:20,182 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:20,216 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:20,455 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:20,469 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:21,482 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:21,509 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:21,541 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:21,555 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:22,140 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:22,167 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:22,184 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:22,202 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:22,736 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:22,764 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:23,139 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:23,163 INFO     [learner.py:606] ====Pushing takes 0.017085552215576172 s
2021-08-18:16:07:23,188 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:23,196 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:23,197 INFO     [param_server.py:410] Lock worker 1 with localStep 167 , while globalStep is 166

2021-08-18:16:07:23,974 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:23,993 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:24,564 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:24,576 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:25,833 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:25,842 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:26,488 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:26,497 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:26,957 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:26,972 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:27,608 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:27,617 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:28,171 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:28,194 INFO     [learner.py:606] ====Pushing takes 0.021892547607421875 s
2021-08-18:16:07:28,227 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:28,234 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:28,235 INFO     [param_server.py:410] Lock worker 2 with localStep 167 , while globalStep is 166

2021-08-18:16:07:28,629 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:28,657 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:29,545 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:29,559 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:30,736 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:30,746 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:31,302 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:31,316 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:07:31,881 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:07:31,917 INFO     [learner.py:606] ====Pushing takes 0.03377890586853027 s
2021-08-18:16:07:31,958 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:31,970 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:31,971 INFO     [param_server.py:381] ====After aggregation in epoch: 166, virtual_clock: 5512.998223311168, top_1: : 62.8267 % (1947.0), top_5: : 100.0 % (3099.0), test loss: 2.7116188627702216, test len: 3099.0
2021-08-18:16:07:31,973 INFO     [param_server.py:410] Lock worker 3 with localStep 167 , while globalStep is 167

2021-08-18:16:07:31,974 INFO     [param_server.py:441] ====Epoch 168 completes 20 clients with loss 9.030516968844246, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:31,974 INFO     [param_server.py:450] ====Start to sample for epoch 168, global virtualClock: 5512.998223311168, round_duration: 38.39602155878561
2021-08-18:16:07:31,975 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:07:32,309 INFO     [param_server.py:553] For epoch: 168, median_reward: 305.1526879326355, dev: 305.1526879326355
2021-08-18:16:07:33,67 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7843, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:07:33,68 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2316.5685, eval_time 0.6994, test_loss 2.7843, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:07:33,73 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7638, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:16:07:33,74 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2316.5744, eval_time 0.7059, test_loss 2.7638, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:16:07:33,136 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:33,142 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:33,148 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:33,154 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:33,188 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.204, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:07:33,189 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2316.6874, eval_time 0.824, test_loss 3.204, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:07:33,295 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:33,324 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:34,126 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:34,153 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:34,175 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:34,184 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:34,824 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:34,838 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:35,484 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:35,495 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:35,505 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:35,510 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:36,134 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:36,154 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:36,626 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:36,644 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:36,681 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:36,701 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:37,115 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:37,143 INFO     [learner.py:606] ====Pushing takes 0.026554346084594727 s
2021-08-18:16:07:37,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:37,174 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:37,175 INFO     [param_server.py:410] Lock worker 1 with localStep 168 , while globalStep is 167

2021-08-18:16:07:37,334 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:37,344 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:37,898 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:37,912 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:38,444 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:38,455 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:38,467 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:38,478 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:39,67 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:39,76 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:40,74 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:40,85 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:40,158 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:40,182 INFO     [learner.py:606] ====Pushing takes 0.02215886116027832 s
2021-08-18:16:07:40,216 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:40,224 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:40,225 INFO     [param_server.py:410] Lock worker 2 with localStep 168 , while globalStep is 167

2021-08-18:16:07:40,648 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:40,658 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:41,241 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:41,252 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:41,887 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:41,899 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:07:42,540 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:07:42,578 INFO     [learner.py:606] ====Pushing takes 0.03644251823425293 s
2021-08-18:16:07:42,621 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:42,631 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:42,632 INFO     [param_server.py:381] ====After aggregation in epoch: 167, virtual_clock: 5542.46703711623, top_1: : 61.6973 % (1912.0), top_5: : 100.0 % (3099.0), test loss: 2.917371405495538, test len: 3099.0
2021-08-18:16:07:42,635 INFO     [param_server.py:410] Lock worker 3 with localStep 168 , while globalStep is 168

2021-08-18:16:07:42,635 INFO     [param_server.py:441] ====Epoch 169 completes 20 clients with loss 9.738117688991274, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:42,636 INFO     [param_server.py:450] ====Start to sample for epoch 169, global virtualClock: 5542.46703711623, round_duration: 29.468813805062297
2021-08-18:16:07:42,637 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:07:42,980 INFO     [param_server.py:553] For epoch: 169, median_reward: 285.2593313625199, dev: 285.2593313625199
2021-08-18:16:07:43,657 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8258, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:07:43,660 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2327.1603, eval_time 0.6238, test_loss 2.8258, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:07:43,690 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1077, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:07:43,693 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2327.1917, eval_time 0.657, test_loss 3.1077, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:07:43,702 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6631, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:07:43,705 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2327.2053, eval_time 0.6684, test_loss 2.6631, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:07:43,729 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:43,744 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:43,777 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:43,790 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:43,801 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:43,830 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:44,692 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:44,725 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:45,72 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:45,87 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:46,30 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:46,64 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:46,445 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:46,460 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:46,615 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:46,633 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:46,758 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:46,792 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:47,408 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:47,442 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:47,875 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:47,895 INFO     [learner.py:606] ====Pushing takes 0.019332408905029297 s
2021-08-18:16:07:47,928 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:47,935 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:47,935 INFO     [param_server.py:410] Lock worker 1 with localStep 169 , while globalStep is 168

2021-08-18:16:07:48,872 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:48,886 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:49,137 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:49,151 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:50,99 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:50,110 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:50,834 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:50,843 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:51,790 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:51,804 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:52,498 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:52,507 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:53,72 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:53,95 INFO     [learner.py:606] ====Pushing takes 0.020984172821044922 s
2021-08-18:16:07:53,129 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:53,137 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:53,137 INFO     [param_server.py:410] Lock worker 2 with localStep 169 , while globalStep is 168

2021-08-18:16:07:53,172 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:53,183 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:53,833 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:53,842 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:54,918 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:54,928 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:55,551 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:55,561 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:07:56,182 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:07:56,218 INFO     [learner.py:606] ====Pushing takes 0.03520512580871582 s
2021-08-18:16:07:56,263 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:56,272 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:56,273 INFO     [param_server.py:381] ====After aggregation in epoch: 168, virtual_clock: 5580.863058675016, top_1: : 63.0203 % (1953.0), top_5: : 100.0 % (3099.0), test loss: 2.8655224861922086, test len: 3099.0
2021-08-18:16:07:56,276 INFO     [param_server.py:410] Lock worker 3 with localStep 169 , while globalStep is 169

2021-08-18:16:07:56,277 INFO     [param_server.py:441] ====Epoch 170 completes 20 clients with loss 7.99517754443359, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:56,277 INFO     [param_server.py:450] ====Start to sample for epoch 170, global virtualClock: 5580.863058675016, round_duration: 38.39602155878561
2021-08-18:16:07:56,278 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:07:56,610 INFO     [param_server.py:553] For epoch: 170, median_reward: 303.01480981553703, dev: 303.01480981553703
2021-08-18:16:07:57,193 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4249, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:07:57,194 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2340.6945, eval_time 0.5268, test_loss 2.4249, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:07:57,222 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8279, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:07:57,223 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2340.7238, eval_time 0.5577, test_loss 2.8279, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:07:57,261 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:07:57,277 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:57,290 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:07:57,303 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:57,391 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7249, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:07:57,392 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2340.8909, eval_time 0.7266, test_loss 2.7249, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:07:57,459 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:07:57,493 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:58,370 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:58,374 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:58,388 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:58,403 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:59,8 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:59,18 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:59,610 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:59,611 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:59,631 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:59,638 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:00,234 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:00,261 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:00,582 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:00,597 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:00,909 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:00,936 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:01,460 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:01,491 INFO     [learner.py:606] ====Pushing takes 0.02933502197265625 s
2021-08-18:16:08:01,527 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:01,534 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:01,534 INFO     [param_server.py:410] Lock worker 1 with localStep 170 , while globalStep is 169

2021-08-18:16:08:01,710 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:01,731 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:02,379 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:02,393 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:02,705 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:02,728 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:03,71 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:03,87 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:03,391 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:03,400 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:04,714 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:04,736 INFO     [learner.py:606] ====Pushing takes 0.02088761329650879 s
2021-08-18:16:08:04,747 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:04,757 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:04,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:04,772 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:04,772 INFO     [param_server.py:410] Lock worker 2 with localStep 170 , while globalStep is 169

2021-08-18:16:08:05,328 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:05,338 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:05,871 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:05,882 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:06,372 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:06,383 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:06,900 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:06,938 INFO     [learner.py:606] ====Pushing takes 0.03666830062866211 s
2021-08-18:16:08:06,984 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:06,994 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:06,995 INFO     [param_server.py:381] ====After aggregation in epoch: 169, virtual_clock: 5610.331872480078, top_1: : 61.5682 % (1908.0), top_5: : 100.0 % (3099.0), test loss: 2.6592594335476556, test len: 3099.0
2021-08-18:16:08:06,997 INFO     [param_server.py:410] Lock worker 3 with localStep 170 , while globalStep is 170

2021-08-18:16:08:06,997 INFO     [param_server.py:441] ====Epoch 171 completes 20 clients with loss 10.837933460659336, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:06,998 INFO     [param_server.py:450] ====Start to sample for epoch 171, global virtualClock: 5610.331872480078, round_duration: 29.468813805062297
2021-08-18:16:08:06,999 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:07,336 INFO     [param_server.py:553] For epoch: 171, median_reward: 286.2427204257377, dev: 286.2427204257377
2021-08-18:16:08:07,974 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6583, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:08:07,978 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2351.4766, eval_time 0.5977, test_loss 2.6583, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:08:08,1 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4072, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:08:08,1 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7081, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:08:08,2 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2351.502, eval_time 0.6211, test_loss 2.4072, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:08:08,2 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2351.5024, eval_time 0.6217, test_loss 2.7081, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:08:08,44 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:08,67 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:08,70 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:08,70 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:08,77 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:08,78 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:08,806 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:08,833 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:09,287 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:09,301 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:10,175 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:10,214 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:10,499 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:10,518 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:10,731 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:10,746 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:10,966 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:11,5 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:11,677 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:11,717 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:12,192 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:12,221 INFO     [learner.py:606] ====Pushing takes 0.026997089385986328 s
2021-08-18:16:08:12,251 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:12,257 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:12,258 INFO     [param_server.py:410] Lock worker 1 with localStep 171 , while globalStep is 170

2021-08-18:16:08:12,819 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:12,833 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:13,650 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:13,672 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:14,782 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:14,801 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:15,405 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:15,415 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:15,770 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:15,788 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:16,496 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:16,509 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:17,19 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:17,43 INFO     [learner.py:606] ====Pushing takes 0.022489070892333984 s
2021-08-18:16:08:17,78 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:17,85 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:17,86 INFO     [param_server.py:410] Lock worker 2 with localStep 171 , while globalStep is 170

2021-08-18:16:08:17,825 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:17,839 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:18,471 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:18,481 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:19,682 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:19,694 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:20,314 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:20,323 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:20,836 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:20,872 INFO     [learner.py:606] ====Pushing takes 0.03480935096740723 s
2021-08-18:16:08:20,925 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:20,936 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:20,937 INFO     [param_server.py:381] ====After aggregation in epoch: 170, virtual_clock: 5648.727894038864, top_1: : 63.0203 % (1953.0), top_5: : 100.0 % (3099.0), test loss: 2.5911898215611777, test len: 3099.0
2021-08-18:16:08:20,940 INFO     [param_server.py:410] Lock worker 3 with localStep 171 , while globalStep is 171

2021-08-18:16:08:20,940 INFO     [param_server.py:441] ====Epoch 172 completes 20 clients with loss 8.218144588071123, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:20,941 INFO     [param_server.py:450] ====Start to sample for epoch 172, global virtualClock: 5648.727894038864, round_duration: 38.39602155878561
2021-08-18:16:08:20,942 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:21,295 INFO     [param_server.py:553] For epoch: 172, median_reward: 277.137458666969, dev: 277.137458666969
2021-08-18:16:08:21,858 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5768, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:08:21,858 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2365.3589, eval_time 0.5033, test_loss 2.5768, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:08:21,895 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8602, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:08:21,898 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2365.3985, eval_time 0.5431, test_loss 2.8602, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:08:21,945 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:21,955 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:21,972 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:21,987 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:22,58 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6813, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:08:22,59 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2365.558, eval_time 0.7044, test_loss 2.6813, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:08:22,132 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:22,170 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:22,966 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:23,0 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:23,183 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:23,193 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:23,799 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:23,808 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:24,17 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:24,28 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:24,467 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:24,501 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:25,197 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:25,230 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:25,616 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:25,630 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:25,815 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:25,848 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:26,226 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:26,256 INFO     [learner.py:606] ====Pushing takes 0.028124094009399414 s
2021-08-18:16:08:26,288 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:26,296 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:26,297 INFO     [param_server.py:410] Lock worker 1 with localStep 172 , while globalStep is 171

2021-08-18:16:08:26,343 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:26,370 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:27,36 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:27,63 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:27,518 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:27,546 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:27,700 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:27,714 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:28,101 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:28,115 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:29,281 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:29,305 INFO     [learner.py:606] ====Pushing takes 0.022081851959228516 s
2021-08-18:16:08:29,327 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:29,339 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:29,341 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:29,348 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:29,349 INFO     [param_server.py:410] Lock worker 2 with localStep 172 , while globalStep is 171

2021-08-18:16:08:29,888 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:29,899 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:30,431 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:30,441 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:31,13 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:31,23 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:31,656 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:31,693 INFO     [learner.py:606] ====Pushing takes 0.03580594062805176 s
2021-08-18:16:08:31,741 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:31,751 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:31,752 INFO     [param_server.py:381] ====After aggregation in epoch: 171, virtual_clock: 5678.196707843927, top_1: : 61.6328 % (1910.0), top_5: : 100.0 % (3099.0), test loss: 2.7060891080785683, test len: 3099.0
2021-08-18:16:08:31,755 INFO     [param_server.py:410] Lock worker 3 with localStep 172 , while globalStep is 172

2021-08-18:16:08:31,755 INFO     [param_server.py:441] ====Epoch 173 completes 20 clients with loss 9.924441784696988, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:31,756 INFO     [param_server.py:450] ====Start to sample for epoch 173, global virtualClock: 5678.196707843927, round_duration: 29.468813805062297
2021-08-18:16:08:31,757 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:32,82 INFO     [param_server.py:553] For epoch: 173, median_reward: 300.62449326032004, dev: 300.62449326032004
2021-08-18:16:08:32,622 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5944, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:08:32,623 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2376.1233, eval_time 0.5008, test_loss 2.5944, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:08:32,654 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8227, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:08:32,655 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2376.1556, eval_time 0.5353, test_loss 2.8227, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:08:32,677 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2085, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:08:32,678 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2376.1767, eval_time 0.5626, test_loss 3.2085, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:08:32,693 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:32,700 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:32,736 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:32,750 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:32,769 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:32,790 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:33,481 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:33,508 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:34,11 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:34,25 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:34,760 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:34,798 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:35,257 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:35,271 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:35,272 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:35,281 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:35,549 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:35,589 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:36,260 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:36,296 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:36,727 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:36,755 INFO     [learner.py:606] ====Pushing takes 0.02700638771057129 s
2021-08-18:16:08:36,786 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:36,793 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:36,794 INFO     [param_server.py:410] Lock worker 1 with localStep 173 , while globalStep is 172

2021-08-18:16:08:37,439 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:37,454 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:37,557 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:37,584 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:38,584 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:38,611 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:39,369 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:39,396 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:40,305 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:40,323 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:40,891 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:40,905 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:41,500 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:41,522 INFO     [learner.py:606] ====Pushing takes 0.020532608032226562 s
2021-08-18:16:08:41,550 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:41,557 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:41,558 INFO     [param_server.py:410] Lock worker 2 with localStep 173 , while globalStep is 172

2021-08-18:16:08:41,833 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:41,843 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:42,468 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:42,478 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:43,494 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:43,509 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:44,102 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:44,111 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:44,612 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:44,648 INFO     [learner.py:606] ====Pushing takes 0.03472590446472168 s
2021-08-18:16:08:44,697 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:44,709 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:44,709 INFO     [param_server.py:381] ====After aggregation in epoch: 172, virtual_clock: 5716.592729402712, top_1: : 63.6012 % (1971.0), top_5: : 100.0 % (3099.0), test loss: 2.8752157114170216, test len: 3099.0
2021-08-18:16:08:44,712 INFO     [param_server.py:410] Lock worker 3 with localStep 173 , while globalStep is 173

2021-08-18:16:08:44,712 INFO     [param_server.py:441] ====Epoch 174 completes 20 clients with loss 7.163991001904834, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:44,712 INFO     [param_server.py:450] ====Start to sample for epoch 174, global virtualClock: 5716.592729402712, round_duration: 38.39602155878561
2021-08-18:16:08:44,713 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:45,47 INFO     [param_server.py:553] For epoch: 174, median_reward: 303.69282004876436, dev: 303.69282004876436
2021-08-18:16:08:45,678 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4741, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:08:45,679 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2389.1795, eval_time 0.5966, test_loss 2.4741, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:08:45,711 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2064, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:08:45,712 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2389.2125, eval_time 0.6312, test_loss 4.2064, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:08:45,754 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0865, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:08:45,758 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2389.2561, eval_time 0.6765, test_loss 3.0865, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:08:45,768 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:08:45,777 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:45,791 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:08:45,806 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:45,855 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:08:45,883 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:46,636 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:46,669 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:47,35 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:47,49 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:47,669 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:47,679 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:47,987 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:48,14 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:48,71 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:48,80 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:48,712 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:48,746 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:49,201 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:49,219 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:49,375 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:49,408 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:49,786 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:49,800 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:49,960 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:49,990 INFO     [learner.py:606] ====Pushing takes 0.028766870498657227 s
2021-08-18:16:08:50,17 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:50,23 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:50,24 INFO     [param_server.py:410] Lock worker 1 with localStep 174 , while globalStep is 173

2021-08-18:16:08:50,437 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:50,465 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:50,929 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:50,939 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:51,48 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:51,69 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:51,462 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:51,472 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:52,731 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:52,736 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:52,750 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:52,755 INFO     [learner.py:606] ====Pushing takes 0.022703886032104492 s
2021-08-18:16:08:52,782 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:52,789 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:52,790 INFO     [param_server.py:410] Lock worker 2 with localStep 174 , while globalStep is 173

2021-08-18:16:08:53,452 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:53,472 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:54,0 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:54,14 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:54,692 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:54,710 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:55,306 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:55,343 INFO     [learner.py:606] ====Pushing takes 0.03608250617980957 s
2021-08-18:16:08:55,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:55,388 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:55,389 INFO     [param_server.py:381] ====After aggregation in epoch: 173, virtual_clock: 5746.061543207775, top_1: : 62.1168 % (1925.0), top_5: : 100.0 % (3099.0), test loss: 3.2556649667245368, test len: 3099.0
2021-08-18:16:08:55,391 INFO     [param_server.py:410] Lock worker 3 with localStep 174 , while globalStep is 174

2021-08-18:16:08:55,392 INFO     [param_server.py:441] ====Epoch 175 completes 20 clients with loss 10.127596257075423, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:55,392 INFO     [param_server.py:450] ====Start to sample for epoch 175, global virtualClock: 5746.061543207775, round_duration: 29.468813805062297
2021-08-18:16:08:55,393 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:55,690 INFO     [param_server.py:553] For epoch: 175, median_reward: 280.0092040484213, dev: 280.0092040484213
2021-08-18:16:08:56,269 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7963, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:08:56,270 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2399.769, eval_time 0.5458, test_loss 2.7963, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:08:56,356 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:08:56,377 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:56,395 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6431, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:08:56,396 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4227, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:08:56,396 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2399.8968, eval_time 0.6701, test_loss 2.6431, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:08:56,397 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2399.8973, eval_time 0.6703, test_loss 2.4227, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:08:56,466 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:08:56,466 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:08:56,475 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:56,476 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:57,32 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:57,52 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:57,839 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:57,862 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:58,170 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:58,190 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:58,757 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:58,777 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:59,88 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:59,103 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:59,159 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:59,168 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:59,335 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:59,362 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:59,712 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:59,743 INFO     [learner.py:606] ====Pushing takes 0.029187440872192383 s
2021-08-18:16:08:59,776 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:59,782 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:59,783 INFO     [param_server.py:410] Lock worker 1 with localStep 175 , while globalStep is 174

2021-08-18:16:09:01,496 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:01,506 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:01,558 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:01,572 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:02,662 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:02,681 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:03,409 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:03,436 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:04,365 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:04,380 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:05,177 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:05,197 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:05,780 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:05,806 INFO     [learner.py:606] ====Pushing takes 0.025364160537719727 s
2021-08-18:16:09:05,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:05,858 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:05,859 INFO     [param_server.py:410] Lock worker 2 with localStep 175 , while globalStep is 174

2021-08-18:16:09:06,71 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:06,99 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:06,969 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:06,996 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:08,235 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:08,269 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:08,972 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:08,986 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:09,575 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:09,610 INFO     [learner.py:606] ====Pushing takes 0.03382539749145508 s
2021-08-18:16:09:09,654 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:09,663 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:09,664 INFO     [param_server.py:381] ====After aggregation in epoch: 174, virtual_clock: 5784.457564766561, top_1: : 62.504 % (1937.0), top_5: : 100.0 % (3099.0), test loss: 2.620705023959831, test len: 3099.0
2021-08-18:16:09:09,666 INFO     [param_server.py:410] Lock worker 3 with localStep 175 , while globalStep is 175

2021-08-18:16:09:09,692 INFO     [param_server.py:441] ====Epoch 176 completes 20 clients with loss 8.048997913415867, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:09,692 INFO     [param_server.py:450] ====Start to sample for epoch 176, global virtualClock: 5784.457564766561, round_duration: 38.39602155878561
2021-08-18:16:09:09,693 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:10,23 INFO     [param_server.py:553] For epoch: 176, median_reward: 300.66999037276025, dev: 300.66999037276025
2021-08-18:16:09:10,677 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7302, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:09:10,678 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2414.1789, eval_time 0.6189, test_loss 2.7302, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:09:10,721 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7072, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:09:10,722 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2414.2224, eval_time 0.6627, test_loss 2.7072, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:09:10,721 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:09:10,724 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2414.2226, eval_time 0.6671, test_loss 2.6, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:09:10,749 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:10,758 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:10,793 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:10,802 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:10,806 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:10,818 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:11,585 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:11,599 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:12,109 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:12,123 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:12,761 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:12,770 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:12,772 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:12,782 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:13,114 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:13,123 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:13,389 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:13,404 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:14,3 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:14,18 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:14,386 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:14,397 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:14,398 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:14,439 INFO     [learner.py:606] ====Pushing takes 0.040667057037353516 s
2021-08-18:16:09:14,467 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:14,472 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:14,473 INFO     [param_server.py:410] Lock worker 1 with localStep 176 , while globalStep is 175

2021-08-18:16:09:14,934 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:14,943 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:15,565 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:15,575 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:16,151 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:16,162 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:16,213 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:16,222 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:16,787 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:16,796 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:17,844 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:17,857 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:18,180 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:18,205 INFO     [learner.py:606] ====Pushing takes 0.020734786987304688 s
2021-08-18:16:09:18,231 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:18,238 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:18,238 INFO     [param_server.py:410] Lock worker 2 with localStep 176 , while globalStep is 175

2021-08-18:16:09:18,443 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:18,463 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:19,26 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:19,47 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:19,582 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:19,602 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:20,178 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:20,214 INFO     [learner.py:606] ====Pushing takes 0.03464221954345703 s
2021-08-18:16:09:20,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:20,268 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:20,269 INFO     [param_server.py:381] ====After aggregation in epoch: 175, virtual_clock: 5813.926378571623, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 2.679134068665681, test len: 3099.0
2021-08-18:16:09:20,271 INFO     [param_server.py:410] Lock worker 3 with localStep 176 , while globalStep is 176

2021-08-18:16:09:20,272 INFO     [param_server.py:441] ====Epoch 177 completes 20 clients with loss 7.695797975092415, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:20,272 INFO     [param_server.py:450] ====Start to sample for epoch 177, global virtualClock: 5813.926378571623, round_duration: 29.468813805062297
2021-08-18:16:09:20,273 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:20,554 INFO     [param_server.py:553] For epoch: 177, median_reward: 295.01149225216193, dev: 295.01149225216193
2021-08-18:16:09:21,248 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5963, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:09:21,249 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2424.748, eval_time 0.6404, test_loss 2.5963, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:09:21,327 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5709, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:09:21,327 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:21,328 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2424.8283, eval_time 0.7167, test_loss 2.5709, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:09:21,348 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:21,358 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9183, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:09:21,359 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2424.8598, eval_time 0.7452, test_loss 2.9183, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:09:21,410 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:21,424 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:21,431 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:21,444 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:22,40 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:22,60 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:22,671 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:22,685 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:23,156 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:23,177 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:23,723 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:23,737 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:23,786 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:23,807 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:24,282 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:24,295 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:24,354 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:24,375 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:24,698 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:24,718 INFO     [learner.py:606] ====Pushing takes 0.01893448829650879 s
2021-08-18:16:09:24,750 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:24,758 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:24,759 INFO     [param_server.py:410] Lock worker 1 with localStep 177 , while globalStep is 176

2021-08-18:16:09:25,895 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:25,907 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:26,489 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:26,499 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:27,677 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:27,686 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:28,251 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:28,261 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:28,629 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:28,643 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:29,291 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:29,305 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:29,828 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:29,852 INFO     [learner.py:606] ====Pushing takes 0.022834062576293945 s
2021-08-18:16:09:29,886 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:29,893 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:29,894 INFO     [param_server.py:410] Lock worker 2 with localStep 177 , while globalStep is 176

2021-08-18:16:09:30,289 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:30,299 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:31,37 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:31,51 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:32,116 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:32,137 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:32,855 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:32,875 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:33,443 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:33,479 INFO     [learner.py:606] ====Pushing takes 0.03486061096191406 s
2021-08-18:16:09:33,527 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:33,536 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:33,537 INFO     [param_server.py:381] ====After aggregation in epoch: 176, virtual_clock: 5852.322400130409, top_1: : 62.7622 % (1945.0), top_5: : 100.0 % (3099.0), test loss: 2.6951469955620944, test len: 3099.0
2021-08-18:16:09:33,540 INFO     [param_server.py:410] Lock worker 3 with localStep 177 , while globalStep is 177

2021-08-18:16:09:33,540 INFO     [param_server.py:441] ====Epoch 178 completes 20 clients with loss 7.514135912521537, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:33,541 INFO     [param_server.py:450] ====Start to sample for epoch 178, global virtualClock: 5852.322400130409, round_duration: 38.39602155878561
2021-08-18:16:09:33,542 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:33,874 INFO     [param_server.py:553] For epoch: 178, median_reward: 312.3305487000233, dev: 312.3305487000233
2021-08-18:16:09:34,567 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6527, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:09:34,568 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2438.0682, eval_time 0.6446, test_loss 2.6527, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:09:34,597 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6231, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:16:09:34,599 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2438.0989, eval_time 0.6798, test_loss 2.6231, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:16:09:34,636 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:34,634 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9271, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:09:34,637 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2438.1356, eval_time 0.7184, test_loss 2.9271, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:09:34,645 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:34,681 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:34,694 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:34,707 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:34,724 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:35,454 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:35,474 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:35,820 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:35,834 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:36,444 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:36,454 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:36,598 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:36,616 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:36,880 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:36,895 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:37,292 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:37,313 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:37,952 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:37,970 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:37,989 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:38,3 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:38,391 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:38,420 INFO     [learner.py:606] ====Pushing takes 0.027411222457885742 s
2021-08-18:16:09:38,450 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:38,456 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:38,457 INFO     [param_server.py:410] Lock worker 1 with localStep 178 , while globalStep is 177

2021-08-18:16:09:38,705 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:38,714 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:39,372 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:39,382 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:39,626 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:39,636 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:39,972 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:39,982 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:40,398 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:40,412 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:41,547 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:41,557 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:41,839 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:41,861 INFO     [learner.py:606] ====Pushing takes 0.020729541778564453 s
2021-08-18:16:09:41,894 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:41,900 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:41,901 INFO     [param_server.py:410] Lock worker 2 with localStep 178 , while globalStep is 177

2021-08-18:16:09:42,108 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:42,118 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:42,629 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:42,643 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:43,150 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:43,162 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:43,850 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:43,882 INFO     [learner.py:606] ====Pushing takes 0.03044271469116211 s
2021-08-18:16:09:43,926 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:43,938 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:43,938 INFO     [param_server.py:381] ====After aggregation in epoch: 177, virtual_clock: 5881.791213935471, top_1: : 61.8909 % (1918.0), top_5: : 100.0 % (3099.0), test loss: 2.734295319627833, test len: 3099.0
2021-08-18:16:09:43,940 INFO     [param_server.py:410] Lock worker 3 with localStep 178 , while globalStep is 178

2021-08-18:16:09:43,941 INFO     [param_server.py:441] ====Epoch 179 completes 20 clients with loss 8.78439034964313, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:43,941 INFO     [param_server.py:450] ====Start to sample for epoch 179, global virtualClock: 5881.791213935471, round_duration: 29.468813805062297
2021-08-18:16:09:43,942 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:44,227 INFO     [param_server.py:553] For epoch: 179, median_reward: 302.01002153380506, dev: 302.01002153380506
2021-08-18:16:09:44,801 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9218, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:09:44,802 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2448.3022, eval_time 0.5301, test_loss 2.9218, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:09:44,869 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:09:44,870 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8498, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:09:44,870 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2448.3691, eval_time 0.5988, test_loss 2.8498, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:09:44,878 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:44,885 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4661, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:09:44,886 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2448.386, eval_time 0.6137, test_loss 2.4661, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:09:44,950 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:09:44,954 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:09:44,972 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:44,975 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:45,713 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:45,742 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:46,182 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:46,202 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:46,983 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:47,10 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:47,480 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:47,501 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:47,689 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:47,717 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:48,107 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:48,117 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:48,287 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:48,314 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:48,659 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:48,679 INFO     [learner.py:606] ====Pushing takes 0.01918649673461914 s
2021-08-18:16:09:48,711 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:48,717 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:48,718 INFO     [param_server.py:410] Lock worker 1 with localStep 179 , while globalStep is 178

2021-08-18:16:09:49,803 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:49,823 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:50,541 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:50,555 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:51,769 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:51,780 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:52,308 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:52,318 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:52,659 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:52,673 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:53,333 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:53,347 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:53,951 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:53,974 INFO     [learner.py:606] ====Pushing takes 0.021294355392456055 s
2021-08-18:16:09:54,8 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:54,15 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:54,16 INFO     [param_server.py:410] Lock worker 2 with localStep 179 , while globalStep is 178

2021-08-18:16:09:54,456 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:54,466 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:55,74 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:55,85 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:56,139 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:56,156 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:56,888 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:56,906 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:57,507 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:57,543 INFO     [learner.py:606] ====Pushing takes 0.03381156921386719 s
2021-08-18:16:09:57,591 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:57,601 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:57,602 INFO     [param_server.py:381] ====After aggregation in epoch: 178, virtual_clock: 5920.187235494257, top_1: : 62.6008 % (1940.0), top_5: : 100.0 % (3099.0), test loss: 2.7459030151367188, test len: 3099.0
2021-08-18:16:09:57,605 INFO     [param_server.py:410] Lock worker 3 with localStep 179 , while globalStep is 179

2021-08-18:16:09:57,605 INFO     [param_server.py:441] ====Epoch 180 completes 20 clients with loss 7.5205683923236535, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:57,606 INFO     [param_server.py:450] ====Start to sample for epoch 180, global virtualClock: 5920.187235494257, round_duration: 38.39602155878561
2021-08-18:16:09:57,607 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:57,910 INFO     [param_server.py:553] For epoch: 180, median_reward: 303.64572552677424, dev: 303.64572552677424
2021-08-18:16:09:58,618 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.773, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:09:58,622 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2462.1219, eval_time 0.6669, test_loss 2.773, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:09:58,660 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.988, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:09:58,661 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2462.1613, eval_time 0.7046, test_loss 2.988, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:09:58,692 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:09:58,697 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8738, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:09:58,699 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2462.1979, eval_time 0.7447, test_loss 2.8738, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:09:58,714 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:58,728 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:09:58,744 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:58,769 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:09:58,800 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:59,564 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:59,591 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:59,826 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:59,840 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:00,523 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:00,532 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:00,980 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:01,0 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:01,13 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:01,23 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:01,664 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:01,698 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:02,132 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:02,144 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:02,217 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:02,237 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:02,646 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:02,676 INFO     [learner.py:606] ====Pushing takes 0.0279843807220459 s
2021-08-18:16:10:02,706 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:02,712 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:02,712 INFO     [param_server.py:410] Lock worker 1 with localStep 180 , while globalStep is 179

2021-08-18:16:10:02,744 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:02,759 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:03,358 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:03,370 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:03,800 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:03,809 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:03,926 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:03,940 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:04,389 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:04,403 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:05,610 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:05,628 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:05,728 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:05,751 INFO     [learner.py:606] ====Pushing takes 0.02174663543701172 s
2021-08-18:16:10:05,785 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:05,793 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:05,794 INFO     [param_server.py:410] Lock worker 2 with localStep 180 , while globalStep is 179

2021-08-18:16:10:06,123 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:06,134 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:06,610 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:06,619 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:07,122 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:07,132 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:07,601 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:07,640 INFO     [learner.py:606] ====Pushing takes 0.03711342811584473 s
2021-08-18:16:10:07,686 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:07,695 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:07,696 INFO     [param_server.py:381] ====After aggregation in epoch: 179, virtual_clock: 5949.656049299319, top_1: : 62.5363 % (1938.0), top_5: : 100.0 % (3099.0), test loss: 2.8782784144083657, test len: 3099.0
2021-08-18:16:10:07,698 INFO     [param_server.py:410] Lock worker 3 with localStep 180 , while globalStep is 180

2021-08-18:16:10:07,699 INFO     [param_server.py:441] ====Epoch 181 completes 20 clients with loss 6.960084292624215, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:07,699 INFO     [param_server.py:450] ====Start to sample for epoch 181, global virtualClock: 5949.656049299319, round_duration: 29.468813805062297
2021-08-18:16:10:07,700 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:08,45 INFO     [param_server.py:541] Handle Wight 0.046440839767456055 | Send 0.34584498405456543
2021-08-18:16:10:08,46 INFO     [param_server.py:553] For epoch: 181, median_reward: 290.79089714028163, dev: 290.79089714028163
2021-08-18:16:10:08,685 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7638, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:10:08,686 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2472.1867, eval_time 0.5967, test_loss 2.7638, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:10:08,690 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6756, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:10:08,691 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2472.1896, eval_time 0.6013, test_loss 2.6756, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:10:08,695 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.764, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:10:08,696 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2472.1965, eval_time 0.604, test_loss 2.764, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:10:08,757 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:08,765 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:08,766 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:08,768 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:08,775 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:08,794 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:09,526 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:09,553 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:09,854 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:09,868 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:10,748 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:10,775 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:10,924 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:10,938 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:11,454 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:11,488 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:11,709 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:11,730 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:12,98 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:12,125 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:12,498 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:12,520 INFO     [learner.py:606] ====Pushing takes 0.020907878875732422 s
2021-08-18:16:10:12,554 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:12,561 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:12,562 INFO     [param_server.py:410] Lock worker 1 with localStep 181 , while globalStep is 180

2021-08-18:16:10:13,273 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:13,293 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:14,284 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:14,294 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:15,459 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:15,473 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:15,857 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:15,868 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:16,28 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:16,37 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:16,512 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:16,526 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:17,3 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:17,31 INFO     [learner.py:606] ====Pushing takes 0.02642512321472168 s
2021-08-18:16:10:17,69 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:17,76 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:17,76 INFO     [param_server.py:410] Lock worker 2 with localStep 181 , while globalStep is 180

2021-08-18:16:10:18,71 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:18,90 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:18,760 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:18,774 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:20,3 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:20,15 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:20,614 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:20,623 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:21,216 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:21,251 INFO     [learner.py:606] ====Pushing takes 0.034229278564453125 s
2021-08-18:16:10:21,298 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:21,310 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:21,311 INFO     [param_server.py:381] ====After aggregation in epoch: 180, virtual_clock: 5988.052070858105, top_1: : 62.4072 % (1934.0), top_5: : 100.0 % (3099.0), test loss: 2.734468091417242, test len: 3099.0
2021-08-18:16:10:21,313 INFO     [param_server.py:410] Lock worker 3 with localStep 181 , while globalStep is 181

2021-08-18:16:10:21,314 INFO     [param_server.py:441] ====Epoch 182 completes 20 clients with loss 7.9415829479964835, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:21,314 INFO     [param_server.py:450] ====Start to sample for epoch 182, global virtualClock: 5988.052070858105, round_duration: 38.39602155878561
2021-08-18:16:10:21,331 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:21,675 INFO     [param_server.py:553] For epoch: 182, median_reward: 308.0140010853667, dev: 308.0140010853667
2021-08-18:16:10:22,273 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0163, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:10:22,275 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2485.7749, eval_time 0.5551, test_loss 3.0163, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:10:22,314 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6143, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:10:22,315 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2485.8158, eval_time 0.5958, test_loss 2.6143, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:10:22,342 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:22,358 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:22,383 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:22,395 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:22,400 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0095, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:10:22,404 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2485.9025, eval_time 0.6846, test_loss 3.0095, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:10:22,474 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:22,502 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:23,249 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:23,276 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:23,440 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:23,458 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:24,33 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:24,46 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:24,573 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:24,593 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:25,91 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:25,114 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:25,187 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:25,208 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:25,603 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:25,614 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:25,760 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:25,780 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:26,238 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:26,267 INFO     [learner.py:606] ====Pushing takes 0.027078628540039062 s
2021-08-18:16:10:26,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:26,303 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:26,304 INFO     [param_server.py:410] Lock worker 1 with localStep 182 , while globalStep is 181

2021-08-18:16:10:26,966 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:26,976 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:27,351 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:27,361 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:27,538 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:27,548 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:27,974 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:27,983 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:28,85 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:28,94 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:29,342 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:29,366 INFO     [learner.py:606] ====Pushing takes 0.022687911987304688 s
2021-08-18:16:10:29,403 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:29,410 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:29,410 INFO     [param_server.py:410] Lock worker 2 with localStep 182 , while globalStep is 181

2021-08-18:16:10:29,590 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:29,599 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:30,197 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:30,209 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:30,799 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:30,811 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:31,402 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:31,411 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:31,937 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:31,974 INFO     [learner.py:606] ====Pushing takes 0.03494429588317871 s
2021-08-18:16:10:32,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:32,22 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:32,23 INFO     [param_server.py:381] ====After aggregation in epoch: 181, virtual_clock: 6017.520884663168, top_1: : 62.1813 % (1927.0), top_5: : 100.0 % (3099.0), test loss: 2.8800137329984596, test len: 3099.0
2021-08-18:16:10:32,25 INFO     [param_server.py:410] Lock worker 3 with localStep 182 , while globalStep is 182

2021-08-18:16:10:32,25 INFO     [param_server.py:441] ====Epoch 183 completes 20 clients with loss 7.634510791581487, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:32,26 INFO     [param_server.py:450] ====Start to sample for epoch 183, global virtualClock: 6017.520884663168, round_duration: 29.468813805062297
2021-08-18:16:10:32,27 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:32,395 INFO     [param_server.py:553] For epoch: 183, median_reward: 275.8363040967978, dev: 275.8363040967978
2021-08-18:16:10:33,42 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6556, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:10:33,46 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2496.5442, eval_time 0.6054, test_loss 2.6556, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:10:33,106 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6572, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:10:33,110 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2496.6101, eval_time 0.6695, test_loss 2.6572, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:10:33,125 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:33,150 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4716, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:10:33,151 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2496.6513, eval_time 0.7105, test_loss 2.4716, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:10:33,152 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:33,173 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:33,180 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:33,249 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:33,262 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:33,946 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:33,973 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:34,479 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:34,493 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:35,168 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:35,196 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:35,562 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:35,576 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:35,873 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:35,906 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:35,983 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:36,3 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:36,524 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:36,558 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:36,978 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:36,998 INFO     [learner.py:606] ====Pushing takes 0.019182443618774414 s
2021-08-18:16:10:37,30 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:37,37 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:37,37 INFO     [param_server.py:410] Lock worker 1 with localStep 183 , while globalStep is 182

2021-08-18:16:10:38,30 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:38,45 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:38,869 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:38,887 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:40,78 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:40,89 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:40,675 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:40,685 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:40,811 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:40,825 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:41,499 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:41,514 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:42,76 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:42,102 INFO     [learner.py:606] ====Pushing takes 0.02503228187561035 s
2021-08-18:16:10:42,136 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:42,146 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:42,146 INFO     [param_server.py:410] Lock worker 2 with localStep 183 , while globalStep is 182

2021-08-18:16:10:42,770 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:42,781 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:43,576 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:43,586 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:44,685 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:44,697 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:45,191 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:45,200 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:45,750 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:45,786 INFO     [learner.py:606] ====Pushing takes 0.03455781936645508 s
2021-08-18:16:10:45,833 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:45,843 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:45,844 INFO     [param_server.py:381] ====After aggregation in epoch: 182, virtual_clock: 6055.9169062219535, top_1: : 62.7299 % (1944.0), top_5: : 100.0 % (3099.0), test loss: 2.59479468398624, test len: 3099.0
2021-08-18:16:10:45,848 INFO     [param_server.py:410] Lock worker 3 with localStep 183 , while globalStep is 183

2021-08-18:16:10:45,849 INFO     [param_server.py:441] ====Epoch 184 completes 20 clients with loss 8.851004783092382, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:45,849 INFO     [param_server.py:450] ====Start to sample for epoch 184, global virtualClock: 6055.9169062219535, round_duration: 38.39602155878561
2021-08-18:16:10:45,850 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:46,177 INFO     [param_server.py:553] For epoch: 184, median_reward: 299.3373765778066, dev: 299.3373765778066
2021-08-18:16:10:46,946 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5586, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:10:46,947 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2510.4479, eval_time 0.7253, test_loss 2.5586, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:10:46,948 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6299, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:10:46,949 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2510.4493, eval_time 0.7264, test_loss 2.6299, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:10:47,14 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:10:47,21 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.636, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:10:47,23 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2510.5221, eval_time 0.8012, test_loss 2.636, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:10:47,25 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:10:47,27 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:47,42 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:47,90 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:10:47,118 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:47,864 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:47,891 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:48,156 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:48,170 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:48,765 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:48,775 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:49,250 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:49,277 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:49,327 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:49,376 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:49,885 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:49,912 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:50,274 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:50,284 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:50,534 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:50,561 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:50,909 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:50,938 INFO     [learner.py:606] ====Pushing takes 0.027837514877319336 s
2021-08-18:16:10:50,968 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:50,974 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:50,974 INFO     [param_server.py:410] Lock worker 1 with localStep 184 , while globalStep is 183

2021-08-18:16:10:51,511 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:51,529 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:52,145 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:52,155 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:52,213 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:52,227 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:52,812 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:52,823 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:52,833 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:52,834 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:54,150 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:54,173 INFO     [learner.py:606] ====Pushing takes 0.021723031997680664 s
2021-08-18:16:10:54,207 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:54,214 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:54,215 INFO     [param_server.py:410] Lock worker 2 with localStep 184 , while globalStep is 183

2021-08-18:16:10:54,506 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:54,517 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:55,115 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:55,125 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:55,741 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:55,753 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:56,277 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:56,286 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:56,836 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:56,875 INFO     [learner.py:606] ====Pushing takes 0.037578582763671875 s
2021-08-18:16:10:56,920 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:56,930 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:56,930 INFO     [param_server.py:381] ====After aggregation in epoch: 183, virtual_clock: 6085.385720027016, top_1: : 63.7625 % (1976.0), top_5: : 100.0 % (3099.0), test loss: 2.6081692775090533, test len: 3099.0
2021-08-18:16:10:56,933 INFO     [param_server.py:410] Lock worker 3 with localStep 184 , while globalStep is 184

2021-08-18:16:10:56,933 INFO     [param_server.py:441] ====Epoch 185 completes 20 clients with loss 8.244286908785794, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:56,934 INFO     [param_server.py:450] ====Start to sample for epoch 185, global virtualClock: 6085.385720027016, round_duration: 29.468813805062297
2021-08-18:16:10:56,934 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:57,219 INFO     [param_server.py:553] For epoch: 185, median_reward: 280.91638208327663, dev: 280.91638208327663
2021-08-18:16:10:57,806 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2515, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:10:57,807 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2521.3053, eval_time 0.5535, test_loss 3.2515, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:10:57,815 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8008, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:10:57,816 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2521.3164, eval_time 0.5618, test_loss 2.8008, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:10:57,883 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:10:57,884 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:10:57,883 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5995, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:10:57,888 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2521.3881, eval_time 0.632, test_loss 2.5995, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:10:57,892 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:57,907 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:57,956 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:10:57,963 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:58,654 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:58,680 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:59,84 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:59,98 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:59,909 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:59,949 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:00,493 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:00,507 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:00,631 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:00,645 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:00,700 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:00,766 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:01,437 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:01,477 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:01,942 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:01,961 INFO     [learner.py:606] ====Pushing takes 0.018456459045410156 s
2021-08-18:16:11:01,990 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:01,999 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:01,999 INFO     [param_server.py:410] Lock worker 1 with localStep 185 , while globalStep is 184

2021-08-18:16:11:02,780 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:02,789 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:03,443 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:03,464 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:04,780 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:04,793 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:05,370 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:05,388 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:05,465 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:05,479 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:05,983 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:06,4 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:06,629 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:06,654 INFO     [learner.py:606] ====Pushing takes 0.023587942123413086 s
2021-08-18:16:11:06,690 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:06,698 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:06,699 INFO     [param_server.py:410] Lock worker 2 with localStep 185 , while globalStep is 184

2021-08-18:16:11:07,810 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:07,819 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:08,482 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:08,494 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:09,547 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:09,560 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:10,223 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:10,235 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:10,778 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:10,815 INFO     [learner.py:606] ====Pushing takes 0.03576326370239258 s
2021-08-18:16:11:10,868 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:10,878 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:10,879 INFO     [param_server.py:381] ====After aggregation in epoch: 184, virtual_clock: 6123.781741585802, top_1: : 62.0523 % (1923.0), top_5: : 100.0 % (3099.0), test loss: 2.8839322063657975, test len: 3099.0
2021-08-18:16:11:10,881 INFO     [param_server.py:410] Lock worker 3 with localStep 185 , while globalStep is 185

2021-08-18:16:11:10,882 INFO     [param_server.py:441] ====Epoch 186 completes 20 clients with loss 6.865847167703983, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:10,882 INFO     [param_server.py:450] ====Start to sample for epoch 186, global virtualClock: 6123.781741585802, round_duration: 38.39602155878561
2021-08-18:16:11:10,883 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:11:11,212 INFO     [param_server.py:553] For epoch: 186, median_reward: 289.2409109002352, dev: 289.2409109002352
2021-08-18:16:11:11,781 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5409, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:11:11,782 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2535.2822, eval_time 0.5319, test_loss 2.5409, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:11:11,812 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8899, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:11:11,813 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2535.3138, eval_time 0.5637, test_loss 2.8899, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:11:11,850 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:11,856 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9955, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:11:11,859 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2535.3574, eval_time 0.6136, test_loss 2.9955, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:11:11,859 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:11,883 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:11,897 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:11,929 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:11,951 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:12,687 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:12,714 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:13,84 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:13,96 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:13,590 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:13,599 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:14,21 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:14,54 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:14,163 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:14,182 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:14,761 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:14,795 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:15,113 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:15,123 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:15,424 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:15,458 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:15,866 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:15,895 INFO     [learner.py:606] ====Pushing takes 0.02695488929748535 s
2021-08-18:16:11:15,924 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:15,930 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:15,931 INFO     [param_server.py:410] Lock worker 1 with localStep 186 , while globalStep is 185

2021-08-18:16:11:16,163 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:16,177 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:16,863 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:16,871 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:16,880 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:16,883 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:17,541 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:17,553 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:17,679 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:17,692 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:18,998 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:19,12 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:11:19,328 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:19,341 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:19,533 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:11:19,559 INFO     [learner.py:606] ====Pushing takes 0.024431467056274414 s
2021-08-18:16:11:19,589 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:19,605 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:11:19,605 INFO     [param_server.py:410] Lock worker 2 with localStep 186 , while globalStep is 185

2021-08-18:16:11:20,8 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:20,18 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:20,650 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:20,660 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:21,225 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:21,262 INFO     [learner.py:606] ====Pushing takes 0.036379098892211914 s
2021-08-18:16:11:21,306 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:21,315 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:21,315 INFO     [param_server.py:381] ====After aggregation in epoch: 185, virtual_clock: 6153.250555390864, top_1: : 62.4072 % (1934.0), top_5: : 100.0 % (3099.0), test loss: 2.8087790895391396, test len: 3099.0
2021-08-18:16:11:21,319 INFO     [param_server.py:410] Lock worker 3 with localStep 186 , while globalStep is 186

2021-08-18:16:11:21,319 INFO     [param_server.py:441] ====Epoch 187 completes 20 clients with loss 7.401442290532094, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:11:21,320 INFO     [param_server.py:450] ====Start to sample for epoch 187, global virtualClock: 6153.250555390864, round_duration: 29.468813805062297
2021-08-18:16:11:21,321 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:11:21,664 INFO     [param_server.py:553] For epoch: 187, median_reward: 294.56803883803747, dev: 294.56803883803747
2021-08-18:16:11:22,213 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8239, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:11:22,214 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2545.7127, eval_time 0.5266, test_loss 2.8239, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:11:22,292 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:22,308 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:22,325 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7239, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:11:22,326 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2545.8267, eval_time 0.6387, test_loss 2.7239, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:11:22,330 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4955, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:11:22,331 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2545.8318, eval_time 0.6437, test_loss 2.4955, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:11:22,385 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:22,399 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:22,401 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:22,411 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:22,904 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:22,918 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:23,682 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:23,697 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:24,98 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:24,131 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:24,816 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:24,849 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:24,989 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:25,7 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:25,37 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:25,47 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:25,482 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:25,521 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:25,983 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:26,2 INFO     [learner.py:606] ====Pushing takes 0.017961502075195312 s
2021-08-18:16:11:26,39 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:26,45 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:26,45 INFO     [param_server.py:410] Lock worker 1 with localStep 187 , while globalStep is 186

2021-08-18:16:11:27,186 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:27,196 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:27,219 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:27,238 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:28,494 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:28,514 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:29,315 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:29,341 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:29,835 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:29,862 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:30,485 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:30,499 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:31,68 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:31,83 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:11:31,750 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:31,765 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:31,765 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:11:31,792 INFO     [learner.py:606] ====Pushing takes 0.025972604751586914 s
2021-08-18:16:11:31,828 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:31,836 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:11:31,837 INFO     [param_server.py:410] Lock worker 2 with localStep 187 , while globalStep is 186

2021-08-18:16:11:32,401 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:32,410 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:33,572 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:33,587 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:34,210 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:34,247 INFO     [learner.py:606] ====Pushing takes 0.035596370697021484 s
2021-08-18:16:11:34,296 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:34,306 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:34,308 INFO     [param_server.py:381] ====After aggregation in epoch: 186, virtual_clock: 6191.64657694965, top_1: : 63.2462 % (1960.0), top_5: : 100.0 % (3099.0), test loss: 2.681092597820141, test len: 3099.0
2021-08-18:16:11:34,311 INFO     [param_server.py:410] Lock worker 3 with localStep 187 , while globalStep is 187

2021-08-18:16:11:34,311 INFO     [param_server.py:441] ====Epoch 188 completes 20 clients with loss 7.218547255480312, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:11:34,312 INFO     [param_server.py:450] ====Start to sample for epoch 188, global virtualClock: 6191.64657694965, round_duration: 38.39602155878561
2021-08-18:16:11:34,313 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:11:34,659 INFO     [param_server.py:553] For epoch: 188, median_reward: 286.7553699878493, dev: 286.7553699878493
2021-08-18:16:11:35,318 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4474, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:11:35,319 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2558.8192, eval_time 0.6369, test_loss 2.4474, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:11:35,357 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.504, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:11:35,357 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7086, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:11:35,360 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2558.8583, eval_time 0.678, test_loss 2.504, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:11:35,360 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2558.8602, eval_time 0.678, test_loss 2.7086, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:11:35,385 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:35,393 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:35,426 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:35,427 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:35,441 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:35,442 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:36,868 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:36,881 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:36,883 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:36,897 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:38,2 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:38,14 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:38,36 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:38,46 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:38,476 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:38,503 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:39,339 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:39,373 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:40,103 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:40,137 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:40,279 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:40,293 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:40,552 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:40,564 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:40,864 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:40,884 INFO     [learner.py:606] ====Pushing takes 0.018717288970947266 s
2021-08-18:16:11:40,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:40,924 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:40,925 INFO     [param_server.py:410] Lock worker 1 with localStep 188 , while globalStep is 187

2021-08-18:16:11:41,543 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:41,562 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:42,286 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:42,306 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:43,388 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:43,401 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:44,551 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:44,560 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:45,119 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:45,129 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:45,758 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:45,770 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:46,788 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:46,790 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:46,799 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:11:46,801 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:47,331 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:11:47,352 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:47,358 INFO     [learner.py:606] ====Pushing takes 0.026020050048828125 s
2021-08-18:16:11:47,390 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:47,397 INFO     [learner.py:606] ====Pushing takes 0.04385685920715332 s
2021-08-18:16:11:47,401 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:11:47,402 INFO     [param_server.py:410] Lock worker 2 with localStep 188 , while globalStep is 187

2021-08-18:16:11:47,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:47,441 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:47,442 INFO     [param_server.py:381] ====After aggregation in epoch: 187, virtual_clock: 6234.884974120583, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 2.5533326433764567, test len: 3099.0
2021-08-18:16:11:47,444 INFO     [param_server.py:410] Lock worker 3 with localStep 188 , while globalStep is 188

2021-08-18:16:11:47,444 INFO     [param_server.py:441] ====Epoch 189 completes 20 clients with loss 7.607759132780271, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:11:47,445 INFO     [param_server.py:450] ====Start to sample for epoch 189, global virtualClock: 6234.884974120583, round_duration: 43.23839717093311
2021-08-18:16:11:47,446 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:11:47,781 INFO     [param_server.py:553] For epoch: 189, median_reward: 311.7267290230095, dev: 311.7267290230095
2021-08-18:16:11:48,386 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7011, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:11:48,387 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2571.8876, eval_time 0.5766, test_loss 2.7011, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:11:48,418 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1982, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:11:48,419 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2571.9194, eval_time 0.6085, test_loss 3.1982, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:11:48,464 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:11:48,466 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9737, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:11:48,467 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2571.9656, eval_time 0.6579, test_loss 2.9737, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:11:48,475 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:48,488 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:11:48,501 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:48,537 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:11:48,554 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:49,256 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:49,276 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:49,811 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:49,825 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:50,740 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:50,774 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:51,29 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:51,43 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:51,83 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:51,93 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:51,614 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:51,654 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:52,411 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:52,445 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:53,193 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:53,200 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:53,218 INFO     [learner.py:606] ====Pushing takes 0.020158052444458008 s
2021-08-18:16:11:53,219 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:53,248 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:53,254 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:53,255 INFO     [param_server.py:410] Lock worker 1 with localStep 189 , while globalStep is 188

2021-08-18:16:11:53,443 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:53,463 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:54,795 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:54,809 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:55,600 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:55,621 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:56,151 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:56,169 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:56,806 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:56,820 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:57,493 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:57,502 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:11:58,282 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:11:58,309 INFO     [learner.py:606] ====Pushing takes 0.025082111358642578 s
2021-08-18:16:11:58,339 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:58,350 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:11:58,351 INFO     [param_server.py:410] Lock worker 2 with localStep 189 , while globalStep is 188

2021-08-18:16:11:58,679 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:58,689 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:59,389 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:59,399 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:00,51 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:00,61 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:00,671 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:00,706 INFO     [learner.py:606] ====Pushing takes 0.03328990936279297 s
2021-08-18:16:12:00,741 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:00,750 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:00,750 INFO     [param_server.py:381] ====After aggregation in epoch: 188, virtual_clock: 6273.280995679369, top_1: : 62.3427 % (1932.0), top_5: : 100.0 % (3099.0), test loss: 2.9576741236227533, test len: 3099.0
2021-08-18:16:12:00,752 INFO     [param_server.py:410] Lock worker 3 with localStep 189 , while globalStep is 189

2021-08-18:16:12:00,753 INFO     [param_server.py:441] ====Epoch 190 completes 20 clients with loss 7.759198583012202, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:00,753 INFO     [param_server.py:450] ====Start to sample for epoch 190, global virtualClock: 6273.280995679369, round_duration: 38.39602155878561
2021-08-18:16:12:00,754 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:01,71 INFO     [param_server.py:553] For epoch: 190, median_reward: 289.99513081510094, dev: 289.99513081510094
2021-08-18:16:12:01,738 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.778, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:12:01,739 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2585.2399, eval_time 0.6394, test_loss 2.778, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:12:01,776 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6747, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:12:01,777 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2585.2755, eval_time 0.6818, test_loss 2.6747, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:12:01,777 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0253, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:12:01,778 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2585.2784, eval_time 0.6803, test_loss 3.0253, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:12:01,808 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:01,817 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:01,847 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:01,849 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:01,862 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:01,869 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:03,153 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:03,180 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:03,575 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:03,585 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:04,525 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:04,535 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:04,646 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:04,667 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:04,919 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:04,928 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:05,674 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:05,707 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:06,470 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:06,504 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:06,906 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:06,927 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:07,243 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:07,264 INFO     [learner.py:606] ====Pushing takes 0.019106149673461914 s
2021-08-18:16:12:07,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:07,301 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:07,302 INFO     [param_server.py:410] Lock worker 1 with localStep 190 , while globalStep is 189

2021-08-18:16:12:07,562 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:07,575 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:08,234 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:08,252 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:08,923 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:08,937 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:10,241 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:10,251 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:11,436 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:11,446 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:11,763 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:11,775 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:12,498 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:12,509 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:13,666 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:13,679 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:13,697 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:13,716 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:14,315 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:14,351 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:14,353 INFO     [learner.py:606] ====Pushing takes 0.0373380184173584 s
2021-08-18:16:12:14,389 INFO     [learner.py:606] ====Pushing takes 0.037420034408569336 s
2021-08-18:16:12:14,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:14,413 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:12:14,413 INFO     [param_server.py:410] Lock worker 3 with localStep 190 , while globalStep is 189

2021-08-18:16:12:14,435 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:14,442 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:14,443 INFO     [param_server.py:381] ====After aggregation in epoch: 189, virtual_clock: 6317.647632769472, top_1: : 61.8909 % (1918.0), top_5: : 100.0 % (3099.0), test loss: 2.8260074037092706, test len: 3099.0
2021-08-18:16:12:14,445 INFO     [param_server.py:410] Lock worker 2 with localStep 190 , while globalStep is 190

2021-08-18:16:12:14,445 INFO     [param_server.py:441] ====Epoch 191 completes 20 clients with loss 7.024357723161723, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:14,446 INFO     [param_server.py:450] ====Start to sample for epoch 191, global virtualClock: 6317.647632769472, round_duration: 44.36663709010263
2021-08-18:16:12:14,447 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:14,780 INFO     [param_server.py:553] For epoch: 191, median_reward: 303.0199034511508, dev: 303.0199034511508
2021-08-18:16:12:15,401 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6599, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:12:15,401 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2598.9018, eval_time 0.5849, test_loss 2.6599, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:12:15,446 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7521, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:12:15,447 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2598.9471, eval_time 0.6324, test_loss 2.7521, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:12:15,470 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:15,478 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:15,514 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:15,520 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8396, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:12:15,523 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2599.0219, eval_time 0.7091, test_loss 2.8396, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:12:15,531 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:15,591 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:15,619 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:16,415 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:16,441 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:16,809 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:16,823 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:17,915 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:17,939 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:17,942 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:17,953 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:18,230 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:18,245 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:18,645 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:18,678 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:19,364 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:19,397 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:20,18 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:20,38 INFO     [learner.py:606] ====Pushing takes 0.018415212631225586 s
2021-08-18:16:12:20,65 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:20,72 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:20,73 INFO     [param_server.py:410] Lock worker 1 with localStep 191 , while globalStep is 190

2021-08-18:16:12:20,133 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:20,143 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:20,820 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:20,832 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:21,999 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:22,13 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:22,663 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:22,677 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:22,806 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:22,839 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:23,587 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:23,597 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:24,186 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:24,195 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:24,777 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:24,802 INFO     [learner.py:606] ====Pushing takes 0.02472090721130371 s
2021-08-18:16:12:24,831 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:24,841 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:12:24,842 INFO     [param_server.py:410] Lock worker 2 with localStep 191 , while globalStep is 190

2021-08-18:16:12:25,10 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:25,24 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:25,603 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:25,612 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:26,258 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:26,268 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:26,802 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:26,838 INFO     [learner.py:606] ====Pushing takes 0.03444838523864746 s
2021-08-18:16:12:26,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:26,890 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:26,891 INFO     [param_server.py:381] ====After aggregation in epoch: 190, virtual_clock: 6354.991152042533, top_1: : 62.6331 % (1941.0), top_5: : 100.0 % (3099.0), test loss: 2.7505472324512623, test len: 3099.0
2021-08-18:16:12:26,894 INFO     [param_server.py:410] Lock worker 3 with localStep 191 , while globalStep is 191

2021-08-18:16:12:26,894 INFO     [param_server.py:441] ====Epoch 192 completes 20 clients with loss 8.046026144611277, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:26,895 INFO     [param_server.py:450] ====Start to sample for epoch 192, global virtualClock: 6354.991152042533, round_duration: 37.343519273061496
2021-08-18:16:12:26,896 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:27,235 INFO     [param_server.py:553] For epoch: 192, median_reward: 308.6235846565403, dev: 308.6235846565403
2021-08-18:16:12:27,881 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7339, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:12:27,882 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4659, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:12:27,885 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2611.3856, eval_time 0.6144, test_loss 2.7339, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:12:27,885 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2611.386, eval_time 0.6122, test_loss 2.4659, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:12:27,920 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9778, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:12:27,921 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2611.4193, eval_time 0.6525, test_loss 2.9778, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:12:27,972 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:27,979 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:27,982 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:27,991 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:27,994 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:28,10 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:29,196 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:29,216 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:29,505 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:29,514 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:30,553 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:30,563 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:30,642 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:30,663 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:30,683 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:30,692 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:31,386 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:31,413 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:32,174 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:32,207 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:32,867 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:32,889 INFO     [learner.py:606] ====Pushing takes 0.016628742218017578 s
2021-08-18:16:12:32,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:32,924 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:32,925 INFO     [param_server.py:410] Lock worker 1 with localStep 192 , while globalStep is 191

2021-08-18:16:12:33,41 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:33,69 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:33,250 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:33,264 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:34,199 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:34,208 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:34,923 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:34,938 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:35,808 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:35,821 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:36,968 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:36,978 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:37,686 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:37,700 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:38,499 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:38,514 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:39,650 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:39,664 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:39,713 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:39,724 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:40,208 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:40,236 INFO     [learner.py:606] ====Pushing takes 0.026012182235717773 s
2021-08-18:16:12:40,264 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:40,272 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:12:40,273 INFO     [param_server.py:410] Lock worker 2 with localStep 192 , while globalStep is 191

2021-08-18:16:12:40,461 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:40,494 INFO     [learner.py:606] ====Pushing takes 0.030899524688720703 s
2021-08-18:16:12:40,529 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:40,538 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:40,539 INFO     [param_server.py:381] ====After aggregation in epoch: 191, virtual_clock: 6399.357789132636, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 2.7258574819123305, test len: 3099.0
2021-08-18:16:12:40,542 INFO     [param_server.py:410] Lock worker 3 with localStep 192 , while globalStep is 192

2021-08-18:16:12:40,542 INFO     [param_server.py:441] ====Epoch 193 completes 20 clients with loss 5.9575371054368595, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:40,543 INFO     [param_server.py:450] ====Start to sample for epoch 193, global virtualClock: 6399.357789132636, round_duration: 44.36663709010263
2021-08-18:16:12:40,544 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:40,895 INFO     [param_server.py:553] For epoch: 193, median_reward: 289.4566701985493, dev: 289.4566701985493
2021-08-18:16:12:41,534 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7779, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:12:41,535 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2625.0353, eval_time 0.5955, test_loss 2.7779, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:12:41,544 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7355, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:12:41,544 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2625.0446, eval_time 0.6038, test_loss 2.7355, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:12:41,627 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:41,627 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:41,635 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:41,637 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:41,627 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0281, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:12:41,651 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2625.1498, eval_time 0.7118, test_loss 3.0281, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:12:41,723 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:41,741 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:42,488 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:42,509 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:42,917 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:42,927 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:43,950 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:43,951 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:43,964 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:43,978 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:44,510 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:44,523 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:44,669 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:44,696 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:45,334 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:45,361 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:46,29 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:46,49 INFO     [learner.py:606] ====Pushing takes 0.01871514320373535 s
2021-08-18:16:12:46,84 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:46,92 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:46,93 INFO     [param_server.py:410] Lock worker 1 with localStep 193 , while globalStep is 192

2021-08-18:16:12:46,248 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:46,258 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:46,904 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:46,923 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:48,22 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:48,46 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:48,734 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:48,748 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:48,986 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:48,997 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:49,782 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:49,791 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:50,431 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:50,445 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:50,937 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:50,946 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:51,142 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:51,169 INFO     [learner.py:606] ====Pushing takes 0.025452852249145508 s
2021-08-18:16:12:51,206 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:51,214 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:12:51,215 INFO     [param_server.py:410] Lock worker 2 with localStep 193 , while globalStep is 192

2021-08-18:16:12:51,588 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:51,609 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:52,193 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:52,207 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:52,769 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:52,809 INFO     [learner.py:606] ====Pushing takes 0.03591656684875488 s
2021-08-18:16:12:52,853 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:52,864 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:52,864 INFO     [param_server.py:381] ====After aggregation in epoch: 192, virtual_clock: 6436.701308405697, top_1: : 61.8264 % (1916.0), top_5: : 100.0 % (3099.0), test loss: 2.84717098430351, test len: 3099.0
2021-08-18:16:12:52,866 INFO     [param_server.py:410] Lock worker 3 with localStep 193 , while globalStep is 193

2021-08-18:16:12:52,867 INFO     [param_server.py:441] ====Epoch 194 completes 20 clients with loss 7.820422533425113, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:52,867 INFO     [param_server.py:450] ====Start to sample for epoch 194, global virtualClock: 6436.701308405697, round_duration: 37.343519273061496
2021-08-18:16:12:52,868 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:53,170 INFO     [param_server.py:553] For epoch: 194, median_reward: 276.6045215018684, dev: 276.6045215018684
2021-08-18:16:12:53,698 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8349, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:12:53,702 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2637.202, eval_time 0.5067, test_loss 2.8349, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:12:53,736 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9087, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:12:53,737 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2637.2372, eval_time 0.5413, test_loss 2.9087, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:12:53,771 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:12:53,779 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:53,784 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0925, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:12:53,787 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2637.2859, eval_time 0.5946, test_loss 3.0925, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:12:53,809 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:12:53,818 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:53,849 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:12:53,869 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:55,69 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:55,89 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:55,329 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:55,339 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:56,428 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:56,444 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:56,578 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:56,588 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:56,867 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:56,900 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:57,782 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:57,816 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:58,638 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:58,664 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:58,922 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:58,932 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:59,236 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:59,247 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:59,357 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:59,375 INFO     [learner.py:606] ====Pushing takes 0.016581058502197266 s
2021-08-18:16:12:59,407 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:59,413 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:59,413 INFO     [param_server.py:410] Lock worker 1 with localStep 194 , while globalStep is 193

2021-08-18:16:13:00,282 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:00,300 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:01,21 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:01,36 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:01,757 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:01,771 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:02,807 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:02,825 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:03,702 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:03,715 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:04,455 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:04,464 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:05,306 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:05,315 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:05,812 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:05,831 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:05,863 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:05,890 INFO     [learner.py:606] ====Pushing takes 0.025550127029418945 s
2021-08-18:16:13:05,926 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:05,934 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:05,934 INFO     [param_server.py:410] Lock worker 2 with localStep 194 , while globalStep is 193

2021-08-18:16:13:06,451 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:06,487 INFO     [learner.py:606] ====Pushing takes 0.03466629981994629 s
2021-08-18:16:13:06,534 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:06,543 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:06,543 INFO     [param_server.py:381] ====After aggregation in epoch: 193, virtual_clock: 6481.0679454958, top_1: : 61.9232 % (1919.0), top_5: : 100.0 % (3099.0), test loss: 2.945367093439456, test len: 3099.0
2021-08-18:16:13:06,546 INFO     [param_server.py:410] Lock worker 3 with localStep 194 , while globalStep is 194

2021-08-18:16:13:06,546 INFO     [param_server.py:441] ====Epoch 195 completes 20 clients with loss 8.347127838164578, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:06,546 INFO     [param_server.py:450] ====Start to sample for epoch 195, global virtualClock: 6481.0679454958, round_duration: 44.36663709010263
2021-08-18:16:13:06,547 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:06,821 INFO     [param_server.py:553] For epoch: 195, median_reward: 290.7748947683453, dev: 290.7748947683453
2021-08-18:16:13:07,512 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7851, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:13:07,512 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8401, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:13:07,513 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2651.0132, eval_time 0.6564, test_loss 2.7851, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:13:07,513 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2651.0135, eval_time 0.6565, test_loss 2.8401, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:13:07,582 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8284, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:13:07,583 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2651.0819, eval_time 0.7276, test_loss 2.8284, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:13:07,585 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:07,586 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:07,594 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:07,594 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:07,644 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:07,665 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:08,465 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:08,485 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:08,896 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:08,907 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:09,991 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:10,18 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:10,28 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:10,41 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:10,558 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:10,572 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:10,693 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:10,720 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:11,441 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:11,470 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:12,127 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:12,148 INFO     [learner.py:606] ====Pushing takes 0.01959395408630371 s
2021-08-18:16:13:12,182 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:12,188 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:12,189 INFO     [param_server.py:410] Lock worker 1 with localStep 195 , while globalStep is 194

2021-08-18:16:13:12,261 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:12,270 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:12,898 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:12,917 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:14,70 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:14,84 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:14,767 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:14,780 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:14,840 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:14,859 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:15,454 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:15,463 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:16,98 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:16,108 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:16,751 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:16,777 INFO     [learner.py:606] ====Pushing takes 0.02472209930419922 s
2021-08-18:16:13:16,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:16,823 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:16,824 INFO     [param_server.py:410] Lock worker 2 with localStep 195 , while globalStep is 194

2021-08-18:16:13:17,35 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:17,45 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:17,632 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:17,643 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:18,235 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:18,249 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:18,855 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:18,892 INFO     [learner.py:606] ====Pushing takes 0.03651881217956543 s
2021-08-18:16:13:18,938 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:18,947 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:18,948 INFO     [param_server.py:381] ====After aggregation in epoch: 194, virtual_clock: 6518.411464768861, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 2.8178374767303467, test len: 3099.0
2021-08-18:16:13:18,951 INFO     [param_server.py:410] Lock worker 3 with localStep 195 , while globalStep is 195

2021-08-18:16:13:18,951 INFO     [param_server.py:441] ====Epoch 196 completes 20 clients with loss 5.903115082477986, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:18,952 INFO     [param_server.py:450] ====Start to sample for epoch 196, global virtualClock: 6518.411464768861, round_duration: 37.343519273061496
2021-08-18:16:13:18,953 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:19,292 INFO     [param_server.py:553] For epoch: 196, median_reward: 287.65941461602245, dev: 287.65941461602245
2021-08-18:16:13:19,876 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9177, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:13:19,877 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2663.3778, eval_time 0.5401, test_loss 2.9177, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:13:19,920 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5621, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:13:19,921 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2663.4217, eval_time 0.5815, test_loss 2.5621, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:13:19,944 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:19,959 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:19,989 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:19,993 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.817, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:13:19,996 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2663.4944, eval_time 0.6586, test_loss 2.817, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:13:20,5 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:20,64 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:20,95 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:21,377 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:21,397 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:21,725 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:21,735 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:22,795 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:22,823 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:22,894 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:22,903 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:22,949 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:22,963 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:23,629 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:23,650 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:24,372 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:24,399 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:25,113 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:25,131 INFO     [learner.py:606] ====Pushing takes 0.016497135162353516 s
2021-08-18:16:13:25,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:25,170 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:25,170 INFO     [param_server.py:410] Lock worker 1 with localStep 196 , while globalStep is 195

2021-08-18:16:13:25,237 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:25,251 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:25,546 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:25,561 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:26,480 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:26,494 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:27,195 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:27,209 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:28,95 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:28,104 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:29,194 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:29,208 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:29,958 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:29,970 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:30,560 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:30,570 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:31,620 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:31,630 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:31,702 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:31,714 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:32,198 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:32,225 INFO     [learner.py:606] ====Pushing takes 0.026361703872680664 s
2021-08-18:16:13:32,263 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:32,271 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:32,272 INFO     [param_server.py:410] Lock worker 2 with localStep 196 , while globalStep is 195

2021-08-18:16:13:32,376 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:32,411 INFO     [learner.py:606] ====Pushing takes 0.03335380554199219 s
2021-08-18:16:13:32,445 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:32,454 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:32,455 INFO     [param_server.py:381] ====After aggregation in epoch: 195, virtual_clock: 6562.778101858964, top_1: : 63.9238 % (1981.0), top_5: : 100.0 % (3099.0), test loss: 2.7655906301957587, test len: 3099.0
2021-08-18:16:13:32,457 INFO     [param_server.py:410] Lock worker 3 with localStep 196 , while globalStep is 196

2021-08-18:16:13:32,458 INFO     [param_server.py:441] ====Epoch 197 completes 20 clients with loss 6.671966731733643, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:32,458 INFO     [param_server.py:450] ====Start to sample for epoch 197, global virtualClock: 6562.778101858964, round_duration: 44.36663709010263
2021-08-18:16:13:32,459 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:32,734 INFO     [param_server.py:553] For epoch: 197, median_reward: 304.52269808019196, dev: 304.52269808019196
2021-08-18:16:13:33,413 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8081, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:13:33,418 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2676.9186, eval_time 0.6347, test_loss 2.8081, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:13:33,462 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5514, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:13:33,467 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2676.9673, eval_time 0.6813, test_loss 2.5514, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:13:33,492 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7226, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:13:33,493 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2676.9913, eval_time 0.7131, test_loss 2.7226, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:13:33,493 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:33,501 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:33,552 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:33,558 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:33,569 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:33,570 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:34,466 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:34,493 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:34,738 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:34,748 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:35,900 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:35,926 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:35,927 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:35,940 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:36,590 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:36,598 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:36,607 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:36,611 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:37,253 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:37,273 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:37,915 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:37,937 INFO     [learner.py:606] ====Pushing takes 0.017203807830810547 s
2021-08-18:16:13:37,967 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:37,973 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:37,974 INFO     [param_server.py:410] Lock worker 1 with localStep 197 , while globalStep is 196

2021-08-18:16:13:38,504 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:38,514 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:39,60 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:39,92 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:40,243 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:40,262 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:40,917 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:40,927 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:41,202 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:41,214 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:41,763 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:41,772 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:42,306 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:42,315 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:42,988 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:43,14 INFO     [learner.py:606] ====Pushing takes 0.024687767028808594 s
2021-08-18:16:13:43,51 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:43,60 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:43,61 INFO     [param_server.py:410] Lock worker 2 with localStep 197 , while globalStep is 196

2021-08-18:16:13:43,213 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:43,224 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:43,901 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:43,911 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:44,427 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:44,439 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:45,98 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:45,134 INFO     [learner.py:606] ====Pushing takes 0.03524637222290039 s
2021-08-18:16:13:45,174 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:45,182 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:45,183 INFO     [param_server.py:381] ====After aggregation in epoch: 196, virtual_clock: 6600.121621132025, top_1: : 62.7944 % (1946.0), top_5: : 100.0 % (3099.0), test loss: 2.6940025841748274, test len: 3099.0
2021-08-18:16:13:45,185 INFO     [param_server.py:410] Lock worker 3 with localStep 197 , while globalStep is 197

2021-08-18:16:13:45,185 INFO     [param_server.py:441] ====Epoch 198 completes 20 clients with loss 7.227543783784153, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:45,186 INFO     [param_server.py:450] ====Start to sample for epoch 198, global virtualClock: 6600.121621132025, round_duration: 37.343519273061496
2021-08-18:16:13:45,186 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:45,470 INFO     [param_server.py:553] For epoch: 198, median_reward: 282.4401180165036, dev: 282.4401180165036
2021-08-18:16:13:46,56 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8231, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:13:46,57 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2689.5578, eval_time 0.5277, test_loss 2.8231, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:13:46,109 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8912, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:13:46,110 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2689.6109, eval_time 0.5807, test_loss 2.8912, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:13:46,122 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:46,130 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:46,188 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:46,188 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8131, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:13:46,189 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2689.688, eval_time 0.6635, test_loss 2.8131, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:13:46,210 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:46,272 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:46,300 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:47,696 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:47,705 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:47,930 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:47,957 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:48,888 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:48,898 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:49,57 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:49,67 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:49,388 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:49,409 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:50,169 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:50,189 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:50,928 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:50,950 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:51,363 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:51,389 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:51,493 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:51,513 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:51,669 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:51,687 INFO     [learner.py:606] ====Pushing takes 0.016760826110839844 s
2021-08-18:16:13:51,717 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:51,726 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:51,726 INFO     [param_server.py:410] Lock worker 1 with localStep 198 , while globalStep is 197

2021-08-18:16:13:52,485 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:52,499 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:53,99 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:53,109 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:53,999 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:54,9 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:55,187 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:55,196 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:55,667 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:55,678 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:56,353 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:56,364 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:57,471 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:57,482 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:57,557 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:57,571 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:58,76 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:58,101 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:58,115 INFO     [learner.py:606] ====Pushing takes 0.03504180908203125 s
2021-08-18:16:13:58,137 INFO     [learner.py:606] ====Pushing takes 0.034217119216918945 s
2021-08-18:16:13:58,168 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:58,177 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:13:58,178 INFO     [param_server.py:410] Lock worker 3 with localStep 198 , while globalStep is 197

2021-08-18:16:13:58,203 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:58,211 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:58,212 INFO     [param_server.py:381] ====After aggregation in epoch: 197, virtual_clock: 6644.488258222128, top_1: : 64.666 % (2004.0), top_5: : 100.0 % (3099.0), test loss: 2.8424898341850002, test len: 3099.0
2021-08-18:16:13:58,216 INFO     [param_server.py:410] Lock worker 2 with localStep 198 , while globalStep is 198

2021-08-18:16:13:58,217 INFO     [param_server.py:441] ====Epoch 199 completes 20 clients with loss 6.8379439018588055, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:58,218 INFO     [param_server.py:450] ====Start to sample for epoch 199, global virtualClock: 6644.488258222128, round_duration: 44.36663709010263
2021-08-18:16:13:58,219 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:58,544 INFO     [param_server.py:553] For epoch: 199, median_reward: 292.46449204898016, dev: 292.46449204898016
2021-08-18:16:13:59,154 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.933, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:16:13:59,156 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2702.6564, eval_time 0.5653, test_loss 2.933, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:16:13:59,240 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0684, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:13:59,241 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2702.7413, eval_time 0.6463, test_loss 3.0684, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:13:59,250 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:13:59,258 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:59,276 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3118, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:13:59,279 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2702.7777, eval_time 0.6908, test_loss 3.3118, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:13:59,309 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:13:59,329 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:59,346 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:13:59,369 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:00,342 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:00,351 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:00,363 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:00,390 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:01,462 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:01,474 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:01,908 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:01,928 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:02,256 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:02,265 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:02,689 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:02,710 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:03,426 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:03,447 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:03,957 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:03,969 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:04,112 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:04,133 INFO     [learner.py:606] ====Pushing takes 0.0189206600189209 s
2021-08-18:16:14:04,166 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:04,172 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:04,173 INFO     [param_server.py:410] Lock worker 1 with localStep 199 , while globalStep is 198

2021-08-18:16:14:04,765 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:04,778 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:05,890 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:05,900 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:06,567 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:06,577 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:06,694 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:06,704 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:07,272 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:07,281 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:07,860 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:07,874 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:08,565 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:08,591 INFO     [learner.py:606] ====Pushing takes 0.024775981903076172 s
2021-08-18:16:14:08,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:08,639 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:08,640 INFO     [param_server.py:410] Lock worker 2 with localStep 199 , while globalStep is 198

2021-08-18:16:14:08,749 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:08,763 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:09,434 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:09,445 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:10,46 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:10,57 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:10,682 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:10,719 INFO     [learner.py:606] ====Pushing takes 0.03521323204040527 s
2021-08-18:16:14:10,767 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:10,775 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:10,776 INFO     [param_server.py:381] ====After aggregation in epoch: 198, virtual_clock: 6681.831777495189, top_1: : 62.4718 % (1936.0), top_5: : 100.0 % (3099.0), test loss: 3.104393808930008, test len: 3099.0
2021-08-18:16:14:10,778 INFO     [param_server.py:410] Lock worker 3 with localStep 199 , while globalStep is 199

2021-08-18:16:14:10,779 INFO     [param_server.py:441] ====Epoch 200 completes 20 clients with loss 7.357179717942053, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:10,779 INFO     [param_server.py:450] ====Start to sample for epoch 200, global virtualClock: 6681.831777495189, round_duration: 37.343519273061496
2021-08-18:16:14:10,780 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:14:11,49 INFO     [param_server.py:553] For epoch: 200, median_reward: 312.5600626420608, dev: 312.5600626420608
2021-08-18:16:14:11,595 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7924, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:14:11,596 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2715.0963, eval_time 0.4903, test_loss 2.7924, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:14:11,675 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:11,684 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.148, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:14:11,685 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2715.1856, eval_time 0.5747, test_loss 3.148, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:14:11,688 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:11,748 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9824, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:14:11,748 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2715.2471, eval_time 0.644, test_loss 2.9824, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:14:11,756 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:11,778 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:11,817 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:11,845 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:13,203 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:13,215 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:13,467 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:13,500 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:14,778 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:14,787 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:14,852 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:14,862 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:15,600 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:15,621 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:17,18 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:17,39 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:17,306 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:17,320 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:17,498 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:17,513 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:17,960 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:17,988 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:18,95 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:18,109 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:18,706 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:18,721 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:14:19,398 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:14:19,420 INFO     [learner.py:606] ====Pushing takes 0.020612239837646484 s
2021-08-18:16:14:19,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:19,461 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:14:19,462 INFO     [param_server.py:410] Lock worker 1 with localStep 200 , while globalStep is 199

2021-08-18:16:14:20,308 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:20,320 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:20,862 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:20,871 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:21,641 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:21,650 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:22,105 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:22,116 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:23,789 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:23,807 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:24,44 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:24,58 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:24,670 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:24,703 INFO     [learner.py:606] ====Pushing takes 0.0313568115234375 s
2021-08-18:16:14:24,748 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:24,757 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:14:24,758 INFO     [param_server.py:410] Lock worker 3 with localStep 200 , while globalStep is 199

2021-08-18:16:14:24,846 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:24,873 INFO     [learner.py:606] ====Pushing takes 0.02610611915588379 s
2021-08-18:16:14:24,911 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:24,920 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:24,921 INFO     [param_server.py:381] ====After aggregation in epoch: 199, virtual_clock: 6746.254449475378, top_1: : 63.1817 % (1958.0), top_5: : 100.0 % (3099.0), test loss: 2.974303466302377, test len: 3099.0
2021-08-18:16:14:24,923 INFO     [param_server.py:410] Lock worker 2 with localStep 200 , while globalStep is 200

2021-08-18:16:14:24,924 INFO     [param_server.py:441] ====Epoch 201 completes 20 clients with loss 252.07483212075823, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:24,924 INFO     [param_server.py:450] ====Start to sample for epoch 201, global virtualClock: 6746.254449475378, round_duration: 64.42267198018864
2021-08-18:16:14:24,925 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:14:25,208 INFO     [param_server.py:541] Handle Wight 0.04322409629821777 | Send 0.28318262100219727
2021-08-18:16:14:25,208 INFO     [param_server.py:553] For epoch: 201, median_reward: 368.1589266659768, dev: 368.1589266659768
2021-08-18:16:14:25,857 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1213, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:16:14:25,857 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2729.3576, eval_time 0.5925, test_loss 3.1213, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:16:14:25,907 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6073, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:14:25,909 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2729.4093, eval_time 0.644, test_loss 2.6073, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:14:25,927 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:25,939 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:25,982 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:25,996 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:26,20 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8875, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:14:26,21 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2729.5193, eval_time 0.7576, test_loss 2.8875, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:14:26,78 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:26,111 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:27,480 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:27,494 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:27,606 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:27,634 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:28,688 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:28,706 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:28,838 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:28,856 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:29,448 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:29,468 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:30,116 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:30,130 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:30,739 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:30,759 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:31,420 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:31,435 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:31,439 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:31,455 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:14:31,505 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:31,523 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:31,987 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:14:32,8 INFO     [learner.py:606] ====Pushing takes 0.019855976104736328 s
2021-08-18:16:14:32,41 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:32,51 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:32,46 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:32,62 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:14:32,63 INFO     [param_server.py:410] Lock worker 1 with localStep 201 , while globalStep is 200

2021-08-18:16:14:34,77 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:34,88 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:34,693 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:34,704 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:35,257 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:35,267 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:35,332 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:35,342 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:36,360 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:36,378 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:36,745 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:36,754 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:36,890 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:36,920 INFO     [learner.py:606] ====Pushing takes 0.028203725814819336 s
2021-08-18:16:14:36,960 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:36,968 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:14:36,968 INFO     [param_server.py:410] Lock worker 3 with localStep 201 , while globalStep is 200

2021-08-18:16:14:37,257 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:37,283 INFO     [learner.py:606] ====Pushing takes 0.024226903915405273 s
2021-08-18:16:14:37,315 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:37,323 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:37,323 INFO     [param_server.py:381] ====After aggregation in epoch: 200, virtual_clock: 6792.906310866351, top_1: : 61.6005 % (1909.0), top_5: : 100.0 % (3099.0), test loss: 2.8720299623630665, test len: 3099.0
2021-08-18:16:14:37,354 INFO     [param_server.py:410] Lock worker 2 with localStep 201 , while globalStep is 201

2021-08-18:16:14:37,354 INFO     [param_server.py:441] ====Epoch 202 completes 20 clients with loss 118.38915897785029, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:37,355 INFO     [param_server.py:450] ====Start to sample for epoch 202, global virtualClock: 6792.906310866351, round_duration: 46.65186139097271
2021-08-18:16:14:37,356 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:14:37,696 INFO     [param_server.py:553] For epoch: 202, median_reward: 342.0212008375489, dev: 342.0212008375489
2021-08-18:16:14:38,308 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7282, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:14:38,312 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2741.8119, eval_time 0.5602, test_loss 2.7282, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:14:38,336 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7192, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:14:38,337 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2741.8378, eval_time 0.5818, test_loss 2.7192, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:14:38,383 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:38,389 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8047, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:14:38,392 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:38,392 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2741.8907, eval_time 0.6411, test_loss 2.8047, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:14:38,412 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:38,421 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:38,456 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:38,474 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:39,922 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:39,931 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:39,938 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:39,965 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:41,73 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:41,82 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:41,517 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:41,536 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:41,548 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:41,576 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:42,334 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:42,355 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:43,124 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:43,144 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:43,793 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:43,802 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:43,843 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:43,856 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:14:44,47 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:44,57 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:44,523 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:14:44,545 INFO     [learner.py:606] ====Pushing takes 0.020002365112304688 s
2021-08-18:16:14:44,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:44,587 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:14:44,588 INFO     [param_server.py:410] Lock worker 1 with localStep 202 , while globalStep is 201

2021-08-18:16:14:44,795 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:44,805 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:46,519 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:46,530 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:47,469 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:47,480 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:47,700 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:47,709 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:48,118 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:48,137 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:48,899 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:48,919 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:49,319 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:49,338 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:50,17 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:50,46 INFO     [learner.py:606] ====Pushing takes 0.027416467666625977 s
2021-08-18:16:14:50,85 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:50,95 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:14:50,96 INFO     [param_server.py:410] Lock worker 3 with localStep 202 , while globalStep is 201

2021-08-18:16:14:50,306 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:50,336 INFO     [learner.py:606] ====Pushing takes 0.02780008316040039 s
2021-08-18:16:14:50,367 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:50,375 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:50,375 INFO     [param_server.py:381] ====After aggregation in epoch: 201, virtual_clock: 6839.558172257324, top_1: : 63.7948 % (1977.0), top_5: : 100.0 % (3099.0), test loss: 2.7507014671961465, test len: 3099.0
2021-08-18:16:14:50,387 INFO     [param_server.py:410] Lock worker 2 with localStep 202 , while globalStep is 202

2021-08-18:16:14:50,388 INFO     [param_server.py:441] ====Epoch 203 completes 20 clients with loss 251.30638208101382, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:50,388 INFO     [param_server.py:450] ====Start to sample for epoch 203, global virtualClock: 6839.558172257324, round_duration: 46.65186139097271
2021-08-18:16:14:50,389 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:14:50,722 INFO     [param_server.py:553] For epoch: 203, median_reward: 347.36215306523667, dev: 347.36215306523667
2021-08-18:16:14:51,419 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8621, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:14:51,420 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2754.9203, eval_time 0.6404, test_loss 2.8621, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:14:51,420 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6936, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:14:51,421 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2754.9216, eval_time 0.6415, test_loss 2.6936, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:14:51,489 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:14:51,498 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:51,512 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:14:51,522 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:51,541 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8835, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:14:51,541 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2755.0398, eval_time 0.764, test_loss 2.8835, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:14:51,599 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:14:51,624 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:53,19 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:53,46 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:53,48 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:53,59 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:54,158 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:54,179 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:54,216 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:54,229 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:55,144 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:55,164 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:55,873 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:55,888 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:56,577 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:56,588 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:56,670 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:56,679 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:56,793 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:56,804 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:57,267 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:57,281 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:14:57,339 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:57,349 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:57,816 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:14:57,847 INFO     [learner.py:606] ====Pushing takes 0.022517681121826172 s
2021-08-18:16:14:57,875 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:57,882 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:14:57,883 INFO     [param_server.py:410] Lock worker 1 with localStep 203 , while globalStep is 202

2021-08-18:16:14:59,385 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:59,397 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:00,67 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:00,78 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:00,553 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:00,562 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:00,625 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:00,634 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:01,725 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:01,736 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:01,929 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:01,947 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:02,328 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:02,355 INFO     [learner.py:606] ====Pushing takes 0.02595663070678711 s
2021-08-18:16:15:02,394 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:02,402 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:02,403 INFO     [param_server.py:410] Lock worker 2 with localStep 203 , while globalStep is 202

2021-08-18:16:15:02,591 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:02,622 INFO     [learner.py:606] ====Pushing takes 0.029607772827148438 s
2021-08-18:16:15:02,653 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:02,661 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:02,662 INFO     [param_server.py:381] ====After aggregation in epoch: 202, virtual_clock: 6886.210033648297, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 2.813067100666187, test len: 3099.0
2021-08-18:16:15:02,664 INFO     [param_server.py:410] Lock worker 3 with localStep 203 , while globalStep is 203

2021-08-18:16:15:02,665 INFO     [param_server.py:441] ====Epoch 204 completes 20 clients with loss 284.40779947412136, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:02,665 INFO     [param_server.py:450] ====Start to sample for epoch 204, global virtualClock: 6886.210033648297, round_duration: 46.65186139097271
2021-08-18:16:15:02,666 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:03,5 INFO     [param_server.py:553] For epoch: 204, median_reward: 349.73368419739074, dev: 349.73368419739074
2021-08-18:16:15:03,575 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8681, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:15:03,576 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2767.0764, eval_time 0.5271, test_loss 2.8681, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:15:03,647 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4778, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:15:03,647 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:03,648 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2767.1482, eval_time 0.5987, test_loss 2.4778, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:15:03,661 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:03,726 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:03,734 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:03,848 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5769, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:15:03,850 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2767.3481, eval_time 0.8006, test_loss 2.5769, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:15:03,943 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:03,976 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:05,304 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:05,313 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:05,472 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:05,500 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:06,437 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:06,447 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:06,503 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:06,517 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:07,140 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:07,167 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:07,918 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:07,944 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:08,650 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:08,671 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:09,105 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:09,118 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:09,134 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:09,174 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:09,254 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:09,275 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:09,738 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:09,747 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:09,871 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:09,895 INFO     [learner.py:606] ====Pushing takes 0.02269148826599121 s
2021-08-18:16:15:09,928 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:09,937 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:09,937 INFO     [param_server.py:410] Lock worker 1 with localStep 204 , while globalStep is 203

2021-08-18:16:15:11,738 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:11,748 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:12,384 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:12,394 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:12,963 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:12,972 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:13,150 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:13,164 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:14,265 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:14,279 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:14,318 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:14,332 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:14,882 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:14,910 INFO     [learner.py:606] ====Pushing takes 0.026596546173095703 s
2021-08-18:16:15:14,943 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:14,951 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:14,951 INFO     [param_server.py:410] Lock worker 3 with localStep 204 , while globalStep is 203

2021-08-18:16:15:15,543 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:15,575 INFO     [learner.py:606] ====Pushing takes 0.03076934814453125 s
2021-08-18:16:15:15,606 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:15,614 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:15,615 INFO     [param_server.py:381] ====After aggregation in epoch: 203, virtual_clock: 6932.86189503927, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 2.640923241774241, test len: 3099.0
2021-08-18:16:15:15,617 INFO     [param_server.py:410] Lock worker 2 with localStep 204 , while globalStep is 204

2021-08-18:16:15:15,617 INFO     [param_server.py:441] ====Epoch 205 completes 20 clients with loss 154.84458512764095, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:15,618 INFO     [param_server.py:450] ====Start to sample for epoch 205, global virtualClock: 6932.86189503927, round_duration: 46.65186139097271
2021-08-18:16:15:15,619 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:15,897 INFO     [param_server.py:553] For epoch: 205, median_reward: 342.847080762708, dev: 342.847080762708
2021-08-18:16:15:16,613 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4994, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:15:16,615 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2780.1151, eval_time 0.6784, test_loss 2.4994, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:15:16,621 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0525, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:15:16,622 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2780.1222, eval_time 0.6857, test_loss 3.0525, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:15:16,687 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:16,692 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:16,693 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0791, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:15:16,694 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2780.1924, eval_time 0.7623, test_loss 3.0791, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:15:16,697 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:16,700 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:16,773 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:16,796 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:18,146 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:18,181 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:18,335 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:18,344 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:19,443 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:19,461 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:19,497 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:19,508 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:20,180 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:20,207 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:20,974 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:21,2 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:21,777 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:21,797 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:22,88 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:22,109 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:22,276 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:22,288 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:22,393 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:22,413 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:22,869 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:22,883 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:22,907 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:22,930 INFO     [learner.py:606] ====Pushing takes 0.021131515502929688 s
2021-08-18:16:15:22,957 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:22,965 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:22,965 INFO     [param_server.py:410] Lock worker 1 with localStep 205 , while globalStep is 204

2021-08-18:16:15:24,888 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:24,897 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:25,544 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:25,559 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:25,962 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:25,971 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:26,284 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:26,298 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:27,102 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:27,120 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:27,593 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:27,605 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:27,633 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:27,659 INFO     [learner.py:606] ====Pushing takes 0.024631738662719727 s
2021-08-18:16:15:27,690 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:27,698 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:27,699 INFO     [param_server.py:410] Lock worker 2 with localStep 205 , while globalStep is 204

2021-08-18:16:15:28,134 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:28,166 INFO     [learner.py:606] ====Pushing takes 0.028233766555786133 s
2021-08-18:16:15:28,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:28,215 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:28,216 INFO     [param_server.py:381] ====After aggregation in epoch: 204, virtual_clock: 6979.513756430243, top_1: : 62.6976 % (1943.0), top_5: : 100.0 % (3099.0), test loss: 2.8769886515758656, test len: 3099.0
2021-08-18:16:15:28,218 INFO     [param_server.py:410] Lock worker 3 with localStep 205 , while globalStep is 205

2021-08-18:16:15:28,219 INFO     [param_server.py:441] ====Epoch 206 completes 20 clients with loss 214.50721833557404, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:28,219 INFO     [param_server.py:450] ====Start to sample for epoch 206, global virtualClock: 6979.513756430243, round_duration: 46.65186139097271
2021-08-18:16:15:28,220 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:28,573 INFO     [param_server.py:553] For epoch: 206, median_reward: 342.06610000889276, dev: 342.06610000889276
2021-08-18:16:15:29,165 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6197, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:15:29,166 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2792.6666, eval_time 0.5678, test_loss 2.6197, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:15:29,171 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9348, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:15:29,175 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2792.6751, eval_time 0.5765, test_loss 2.9348, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:15:29,235 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:29,243 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:29,265 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0204, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:15:29,267 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2792.7652, eval_time 0.6708, test_loss 3.0204, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:15:29,279 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:29,287 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:29,336 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:29,360 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:30,910 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:30,930 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:30,984 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:30,994 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:32,37 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:32,52 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:32,139 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:32,150 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:32,513 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:32,540 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:33,438 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:33,464 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:34,131 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:34,158 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:34,546 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:34,559 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:34,805 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:34,821 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:34,831 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:34,832 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:35,292 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:35,305 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:35,454 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:35,478 INFO     [learner.py:606] ====Pushing takes 0.02292323112487793 s
2021-08-18:16:15:35,512 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:35,520 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:35,520 INFO     [param_server.py:410] Lock worker 1 with localStep 206 , while globalStep is 205

2021-08-18:16:15:37,471 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:37,483 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:37,994 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:38,12 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:38,592 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:38,602 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:38,752 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:38,766 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:39,908 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:39,917 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:39,949 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:39,961 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:40,639 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:40,669 INFO     [learner.py:606] ====Pushing takes 0.02883291244506836 s
2021-08-18:16:15:40,702 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:40,711 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:40,712 INFO     [param_server.py:410] Lock worker 3 with localStep 206 , while globalStep is 205

2021-08-18:16:15:41,415 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:41,442 INFO     [learner.py:606] ====Pushing takes 0.025516033172607422 s
2021-08-18:16:15:41,473 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:41,481 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:41,482 INFO     [param_server.py:381] ====After aggregation in epoch: 205, virtual_clock: 7026.165617821216, top_1: : 64.5047 % (1999.0), top_5: : 100.0 % (3099.0), test loss: 2.8583126686237477, test len: 3099.0
2021-08-18:16:15:41,485 INFO     [param_server.py:410] Lock worker 2 with localStep 206 , while globalStep is 206

2021-08-18:16:15:41,485 INFO     [param_server.py:441] ====Epoch 207 completes 20 clients with loss 187.12815244977543, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:41,486 INFO     [param_server.py:450] ====Start to sample for epoch 207, global virtualClock: 7026.165617821216, round_duration: 46.65186139097271
2021-08-18:16:15:41,487 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:41,820 INFO     [param_server.py:553] For epoch: 207, median_reward: 344.26384173749426, dev: 344.26384173749426
2021-08-18:16:15:42,466 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6387, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:15:42,466 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2805.9668, eval_time 0.6126, test_loss 2.6387, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:15:42,505 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1947, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:15:42,506 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2806.0062, eval_time 0.6521, test_loss 3.1947, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:15:42,538 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:42,544 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.736, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:15:42,546 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2806.0451, eval_time 0.6928, test_loss 2.736, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:15:42,553 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:42,581 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:42,596 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:42,614 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:42,632 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:43,914 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:43,942 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:44,149 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:44,158 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:45,321 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:45,337 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:45,344 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:45,353 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:45,894 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:45,921 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:46,585 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:46,612 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:47,493 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:47,520 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:47,622 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:47,632 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:47,889 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:47,903 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:48,222 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:48,249 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:48,394 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:48,413 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:48,911 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:48,935 INFO     [learner.py:606] ====Pushing takes 0.021906137466430664 s
2021-08-18:16:15:48,970 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:48,979 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:48,980 INFO     [param_server.py:410] Lock worker 1 with localStep 207 , while globalStep is 206

2021-08-18:16:15:50,703 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:50,714 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:51,322 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:51,336 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:51,665 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:51,674 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:52,83 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:52,93 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:52,979 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:52,990 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:53,275 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:53,288 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:53,478 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:53,506 INFO     [learner.py:606] ====Pushing takes 0.026900768280029297 s
2021-08-18:16:15:53,542 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:53,550 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:53,550 INFO     [param_server.py:410] Lock worker 2 with localStep 207 , while globalStep is 206

2021-08-18:16:15:53,932 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:53,961 INFO     [learner.py:606] ====Pushing takes 0.027453899383544922 s
2021-08-18:16:15:53,993 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:54,1 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:54,2 INFO     [param_server.py:381] ====After aggregation in epoch: 206, virtual_clock: 7072.817479212189, top_1: : 61.8587 % (1917.0), top_5: : 100.0 % (3099.0), test loss: 2.8564704281312445, test len: 3099.0
2021-08-18:16:15:54,5 INFO     [param_server.py:410] Lock worker 3 with localStep 207 , while globalStep is 207

2021-08-18:16:15:54,5 INFO     [param_server.py:441] ====Epoch 208 completes 20 clients with loss 244.24468047600578, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:54,6 INFO     [param_server.py:450] ====Start to sample for epoch 208, global virtualClock: 7072.817479212189, round_duration: 46.65186139097271
2021-08-18:16:15:54,7 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:54,345 INFO     [param_server.py:553] For epoch: 208, median_reward: 356.99764828783447, dev: 356.99764828783447
2021-08-18:16:15:55,29 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8029, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:15:55,30 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2818.5307, eval_time 0.6501, test_loss 2.8029, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:15:55,33 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4869, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:15:55,34 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2818.5348, eval_time 0.6525, test_loss 2.4869, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:15:55,99 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:15:55,102 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:15:55,108 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1213, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:15:55,108 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:55,109 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2818.6077, eval_time 0.7291, test_loss 3.1213, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:15:55,111 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:55,178 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:15:55,196 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:56,645 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:56,671 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:56,908 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:56,923 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:58,46 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:58,61 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:58,130 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:58,144 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:58,186 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:58,293 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:59,184 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:59,211 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:59,996 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:00,23 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:00,470 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:00,481 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:00,660 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:00,687 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:00,886 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:00,897 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:01,137 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:01,146 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:01,335 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:01,360 INFO     [learner.py:606] ====Pushing takes 0.02359485626220703 s
2021-08-18:16:16:01,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:01,404 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:01,404 INFO     [param_server.py:410] Lock worker 1 with localStep 208 , while globalStep is 207

2021-08-18:16:16:03,734 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:03,746 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:04,42 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:04,55 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:04,747 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:04,760 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:04,873 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:04,887 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:05,984 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:05,997 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:06,209 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:06,218 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:06,741 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:06,770 INFO     [learner.py:606] ====Pushing takes 0.027191877365112305 s
2021-08-18:16:16:06,808 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:06,816 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:06,817 INFO     [param_server.py:410] Lock worker 3 with localStep 208 , while globalStep is 207

2021-08-18:16:16:07,481 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:07,512 INFO     [learner.py:606] ====Pushing takes 0.028577327728271484 s
2021-08-18:16:16:07,543 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:07,551 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:07,552 INFO     [param_server.py:381] ====After aggregation in epoch: 207, virtual_clock: 7119.469340603162, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.8036946853001914, test len: 3099.0
2021-08-18:16:16:07,554 INFO     [param_server.py:410] Lock worker 2 with localStep 208 , while globalStep is 208

2021-08-18:16:16:07,555 INFO     [param_server.py:441] ====Epoch 209 completes 20 clients with loss 162.4351783825385, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:07,556 INFO     [param_server.py:450] ====Start to sample for epoch 209, global virtualClock: 7119.469340603162, round_duration: 46.65186139097271
2021-08-18:16:16:07,557 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:07,878 INFO     [param_server.py:553] For epoch: 209, median_reward: 340.792738886912, dev: 340.792738886912
2021-08-18:16:16:08,499 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8381, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:16:08,502 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2832.0024, eval_time 0.5879, test_loss 2.8381, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:16:08,513 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4907, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:16:08,517 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2832.0171, eval_time 0.6025, test_loss 2.4907, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:16:08,570 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:08,578 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:08,587 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7197, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:16:08,587 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:08,588 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2832.0862, eval_time 0.6759, test_loss 2.7197, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:16:08,597 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:08,645 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:08,664 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:09,908 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:09,941 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:10,181 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:10,192 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:11,445 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:11,456 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:11,498 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:11,507 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:12,2 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:12,22 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:12,825 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:12,853 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:13,766 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:13,793 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:13,818 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:13,830 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:14,96 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:14,108 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:14,539 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:14,548 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:14,575 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:14,602 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:15,339 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:15,363 INFO     [learner.py:606] ====Pushing takes 0.022591114044189453 s
2021-08-18:16:16:15,399 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:15,406 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:15,407 INFO     [param_server.py:410] Lock worker 1 with localStep 209 , while globalStep is 208

2021-08-18:16:16:16,890 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:16,901 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:17,557 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:17,567 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:18,133 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:18,142 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:18,192 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:18,201 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:19,327 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:19,337 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:19,370 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:19,379 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:19,940 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:19,969 INFO     [learner.py:606] ====Pushing takes 0.02773904800415039 s
2021-08-18:16:16:20,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:20,15 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:20,16 INFO     [param_server.py:410] Lock worker 3 with localStep 209 , while globalStep is 208

2021-08-18:16:16:20,23 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:20,55 INFO     [learner.py:606] ====Pushing takes 0.029936552047729492 s
2021-08-18:16:16:20,87 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:20,94 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:20,95 INFO     [param_server.py:381] ====After aggregation in epoch: 208, virtual_clock: 7166.121201994135, top_1: : 62.5363 % (1938.0), top_5: : 100.0 % (3099.0), test loss: 2.682830779640763, test len: 3099.0
2021-08-18:16:16:20,97 INFO     [param_server.py:410] Lock worker 2 with localStep 209 , while globalStep is 209

2021-08-18:16:16:20,98 INFO     [param_server.py:441] ====Epoch 210 completes 20 clients with loss 101.71114122283915, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:20,98 INFO     [param_server.py:450] ====Start to sample for epoch 210, global virtualClock: 7166.121201994135, round_duration: 46.65186139097271
2021-08-18:16:16:20,99 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:20,420 INFO     [param_server.py:553] For epoch: 210, median_reward: 348.5825874083183, dev: 348.5825874083183
2021-08-18:16:16:21,2 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7691, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:16:21,3 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2844.5036, eval_time 0.5498, test_loss 2.7691, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:16:21,10 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4628, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:16:21,11 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2844.5111, eval_time 0.5553, test_loss 2.4628, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:16:21,73 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:21,81 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:21,82 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:21,85 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6929, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:16:21,88 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2844.5864, eval_time 0.6345, test_loss 2.6929, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:16:21,91 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:21,157 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:21,178 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:22,571 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:22,592 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:22,637 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:22,646 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:23,794 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:23,805 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:24,41 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:24,83 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:24,67 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:24,93 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:25,37 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:25,64 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:25,949 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:25,975 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:26,337 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:26,346 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:26,551 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:26,563 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:26,601 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:26,628 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:27,185 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:27,194 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:27,233 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:27,259 INFO     [learner.py:606] ====Pushing takes 0.023998737335205078 s
2021-08-18:16:16:27,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:27,305 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:27,306 INFO     [param_server.py:410] Lock worker 1 with localStep 210 , while globalStep is 209

2021-08-18:16:16:29,82 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:29,97 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:30,187 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:30,184 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:30,197 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:30,198 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:30,815 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:30,825 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:31,387 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:31,397 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:31,988 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:31,999 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:32,554 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:32,583 INFO     [learner.py:606] ====Pushing takes 0.027521610260009766 s
2021-08-18:16:16:32,623 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:32,633 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:32,633 INFO     [param_server.py:410] Lock worker 3 with localStep 210 , while globalStep is 209

2021-08-18:16:16:32,694 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:32,724 INFO     [learner.py:606] ====Pushing takes 0.02775430679321289 s
2021-08-18:16:16:32,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:32,762 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:32,762 INFO     [param_server.py:381] ====After aggregation in epoch: 209, virtual_clock: 7212.773063385108, top_1: : 64.8274 % (2009.0), top_5: : 100.0 % (3099.0), test loss: 2.641604613374781, test len: 3099.0
2021-08-18:16:16:32,766 INFO     [param_server.py:410] Lock worker 2 with localStep 210 , while globalStep is 210

2021-08-18:16:16:32,767 INFO     [param_server.py:441] ====Epoch 211 completes 20 clients with loss 133.2571144199452, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:32,767 INFO     [param_server.py:450] ====Start to sample for epoch 211, global virtualClock: 7212.773063385108, round_duration: 46.65186139097271
2021-08-18:16:16:32,768 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:33,77 INFO     [param_server.py:553] For epoch: 211, median_reward: 328.91402439180223, dev: 328.91402439180223
2021-08-18:16:16:33,767 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7788, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:16:33,768 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2857.2684, eval_time 0.6562, test_loss 2.7788, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:16:33,811 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6463, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:16:33,812 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2857.3128, eval_time 0.6995, test_loss 2.6463, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:16:33,839 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:33,848 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:33,851 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9848, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:16:33,852 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2857.3507, eval_time 0.7403, test_loss 2.9848, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:16:33,881 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:33,896 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:33,920 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:33,941 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:35,338 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:35,365 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:35,525 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:35,534 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:36,766 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:36,775 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:36,809 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:36,819 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:37,285 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:37,312 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:38,124 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:38,151 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:39,30 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:39,57 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:39,97 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:39,107 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:39,405 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:39,418 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:39,740 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:39,749 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:39,769 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:39,796 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:40,497 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:40,522 INFO     [learner.py:606] ====Pushing takes 0.023438692092895508 s
2021-08-18:16:16:40,557 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:40,568 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:40,569 INFO     [param_server.py:410] Lock worker 1 with localStep 211 , while globalStep is 210

2021-08-18:16:16:42,173 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:42,184 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:42,897 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:42,911 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:43,342 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:43,357 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:43,512 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:43,522 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:44,598 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:44,609 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:44,875 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:44,885 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:45,216 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:45,247 INFO     [learner.py:606] ====Pushing takes 0.0297701358795166 s
2021-08-18:16:16:45,285 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:45,292 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:45,293 INFO     [param_server.py:410] Lock worker 2 with localStep 211 , while globalStep is 210

2021-08-18:16:16:45,521 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:45,550 INFO     [learner.py:606] ====Pushing takes 0.02751922607421875 s
2021-08-18:16:16:45,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:45,589 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:45,590 INFO     [param_server.py:381] ====After aggregation in epoch: 210, virtual_clock: 7259.424924776081, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 2.8033162046361855, test len: 3099.0
2021-08-18:16:16:45,600 INFO     [param_server.py:410] Lock worker 3 with localStep 211 , while globalStep is 211

2021-08-18:16:16:45,601 INFO     [param_server.py:441] ====Epoch 212 completes 20 clients with loss 148.07211776773977, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:45,601 INFO     [param_server.py:450] ====Start to sample for epoch 212, global virtualClock: 7259.424924776081, round_duration: 46.65186139097271
2021-08-18:16:16:45,602 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:45,880 INFO     [param_server.py:553] For epoch: 212, median_reward: 329.598328523498, dev: 329.598328523498
2021-08-18:16:16:46,507 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0296, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:16:46,508 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2870.0084, eval_time 0.5941, test_loss 3.0296, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:16:46,513 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6476, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:16:46,514 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2870.0146, eval_time 0.6002, test_loss 2.6476, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:16:46,593 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5331, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:16:46,594 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2870.0924, eval_time 0.6799, test_loss 2.5331, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:16:46,599 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:16:46,599 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:16:46,607 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:46,614 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:46,667 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:16:46,686 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:48,29 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:48,49 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:48,54 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:48,66 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:49,122 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:49,131 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:49,368 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:49,388 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:49,507 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:49,520 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:50,172 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:50,199 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:50,942 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:50,968 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:51,690 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:51,717 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:51,762 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:51,775 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:51,893 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:51,903 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:52,394 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:52,417 INFO     [learner.py:606] ====Pushing takes 0.02244734764099121 s
2021-08-18:16:16:52,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:52,461 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:52,462 INFO     [param_server.py:410] Lock worker 1 with localStep 212 , while globalStep is 211

2021-08-18:16:16:52,499 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:52,512 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:54,523 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:54,538 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:55,303 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:55,312 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:55,804 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:55,814 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:55,982 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:55,996 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:57,110 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:57,124 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:57,283 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:57,294 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:57,880 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:57,910 INFO     [learner.py:606] ====Pushing takes 0.028575420379638672 s
2021-08-18:16:16:57,949 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:57,957 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:57,958 INFO     [param_server.py:410] Lock worker 3 with localStep 212 , while globalStep is 211

2021-08-18:16:16:58,354 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:58,386 INFO     [learner.py:606] ====Pushing takes 0.0301973819732666 s
2021-08-18:16:16:58,421 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:58,428 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:58,429 INFO     [param_server.py:381] ====After aggregation in epoch: 211, virtual_clock: 7306.076786167054, top_1: : 65.021 % (2015.0), top_5: : 100.0 % (3099.0), test loss: 2.736784393036807, test len: 3099.0
2021-08-18:16:16:58,433 INFO     [param_server.py:410] Lock worker 2 with localStep 212 , while globalStep is 212

2021-08-18:16:16:58,433 INFO     [param_server.py:441] ====Epoch 213 completes 20 clients with loss 130.38233893091015, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:58,434 INFO     [param_server.py:450] ====Start to sample for epoch 213, global virtualClock: 7306.076786167054, round_duration: 46.65186139097271
2021-08-18:16:16:58,435 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:58,768 INFO     [param_server.py:553] For epoch: 213, median_reward: 339.9276592867212, dev: 339.9276592867212
2021-08-18:16:16:59,478 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8383, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:16:59,479 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2882.9798, eval_time 0.6772, test_loss 2.8383, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:16:59,524 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6572, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:16:59,525 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2883.0254, eval_time 0.7205, test_loss 2.6572, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:16:59,547 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:16:59,555 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:59,566 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6524, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:16:59,569 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2883.0681, eval_time 0.7685, test_loss 2.6524, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:16:59,600 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:16:59,613 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:59,638 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:16:59,657 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:00,884 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:00,911 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:01,137 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:01,154 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:02,341 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:02,352 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:02,400 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:02,413 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:02,889 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:02,909 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:03,718 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:03,738 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:04,566 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:04,593 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:04,623 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:04,637 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:05,4 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:05,15 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:05,261 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:05,288 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:05,305 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:05,343 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:06,35 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:06,59 INFO     [learner.py:606] ====Pushing takes 0.022504329681396484 s
2021-08-18:16:17:06,95 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:06,102 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:06,103 INFO     [param_server.py:410] Lock worker 1 with localStep 213 , while globalStep is 212

2021-08-18:16:17:07,621 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:07,630 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:08,182 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:08,198 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:08,776 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:08,787 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:08,863 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:08,873 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:09,949 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:09,958 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:10,270 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:10,288 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:10,482 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:10,508 INFO     [learner.py:606] ====Pushing takes 0.025084733963012695 s
2021-08-18:16:17:10,553 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:10,565 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:10,565 INFO     [param_server.py:410] Lock worker 2 with localStep 213 , while globalStep is 212

2021-08-18:16:17:10,825 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:10,856 INFO     [learner.py:606] ====Pushing takes 0.02944803237915039 s
2021-08-18:16:17:10,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:10,903 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:10,904 INFO     [param_server.py:381] ====After aggregation in epoch: 212, virtual_clock: 7352.728647558027, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 2.7159662070097745, test len: 3099.0
2021-08-18:16:17:10,907 INFO     [param_server.py:410] Lock worker 3 with localStep 213 , while globalStep is 213

2021-08-18:16:17:10,908 INFO     [param_server.py:441] ====Epoch 214 completes 20 clients with loss 122.61698433119034, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:10,908 INFO     [param_server.py:450] ====Start to sample for epoch 214, global virtualClock: 7352.728647558027, round_duration: 46.65186139097271
2021-08-18:16:17:10,909 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:11,226 INFO     [param_server.py:553] For epoch: 214, median_reward: 325.62399867480866, dev: 325.62399867480866
2021-08-18:16:17:11,885 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7107, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:17:11,886 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2895.3863, eval_time 0.6246, test_loss 2.7107, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:17:11,927 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7239, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:17:11,928 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2895.4288, eval_time 0.667, test_loss 2.7239, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:17:11,956 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:11,965 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:11,968 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5311, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:17:11,969 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2895.4673, eval_time 0.708, test_loss 2.5311, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:17:12,3 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:12,16 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:12,37 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:12,53 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:13,431 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:13,452 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:13,590 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:13,600 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:14,799 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:14,810 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:14,948 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:14,958 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:14,987 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:15,8 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:15,781 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:15,802 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:16,638 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:16,658 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:17,238 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:17,258 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:17,312 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:17,331 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:17,434 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:17,443 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:17,923 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:17,948 INFO     [learner.py:606] ====Pushing takes 0.020237445831298828 s
2021-08-18:16:17:17,987 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:17,994 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:17,995 INFO     [param_server.py:410] Lock worker 1 with localStep 214 , while globalStep is 213

2021-08-18:16:17:18,31 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:18,45 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:19,981 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:19,991 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:20,739 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:20,750 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:21,295 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:21,304 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:21,420 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:21,429 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:22,395 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:22,407 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:22,497 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:22,508 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:23,186 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:23,224 INFO     [learner.py:606] ====Pushing takes 0.02926468849182129 s
2021-08-18:16:17:23,263 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:23,270 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:23,271 INFO     [param_server.py:410] Lock worker 3 with localStep 214 , while globalStep is 213

2021-08-18:16:17:23,562 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:23,590 INFO     [learner.py:606] ====Pushing takes 0.02579212188720703 s
2021-08-18:16:17:23,621 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:23,629 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:23,629 INFO     [param_server.py:381] ====After aggregation in epoch: 213, virtual_clock: 7399.380508949, top_1: : 63.6657 % (1973.0), top_5: : 100.0 % (3099.0), test loss: 2.655243239331025, test len: 3099.0
2021-08-18:16:17:23,632 INFO     [param_server.py:410] Lock worker 2 with localStep 214 , while globalStep is 214

2021-08-18:16:17:23,633 INFO     [param_server.py:441] ====Epoch 215 completes 20 clients with loss 215.21301034750985, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:23,633 INFO     [param_server.py:450] ====Start to sample for epoch 215, global virtualClock: 7399.380508949, round_duration: 46.65186139097271
2021-08-18:16:17:23,634 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:23,969 INFO     [param_server.py:553] For epoch: 215, median_reward: 335.71140669096786, dev: 335.71140669096786
2021-08-18:16:17:24,572 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6634, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:17:24,573 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2908.0736, eval_time 0.5592, test_loss 2.6634, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:17:24,627 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5376, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:17:24,628 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2908.1287, eval_time 0.6133, test_loss 2.5376, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:17:24,644 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:24,653 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:24,671 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.715, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:17:24,672 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2908.171, eval_time 0.6585, test_loss 2.715, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:17:24,713 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:24,728 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:24,741 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:24,762 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:26,263 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:26,296 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:26,324 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:26,344 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:27,685 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:27,689 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:27,694 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:27,698 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:28,69 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:28,90 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:28,875 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:28,895 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:29,736 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:29,757 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:30,235 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:30,249 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:30,400 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:30,412 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:30,504 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:30,524 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:31,25 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:31,27 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:31,35 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:31,52 INFO     [learner.py:606] ====Pushing takes 0.02354717254638672 s
2021-08-18:16:17:31,87 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:31,97 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:31,98 INFO     [param_server.py:410] Lock worker 1 with localStep 215 , while globalStep is 214

2021-08-18:16:17:33,180 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:33,192 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:33,844 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:33,854 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:34,485 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:34,495 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:34,606 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:34,616 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:35,800 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:35,805 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:35,811 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:35,815 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:36,411 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:36,432 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:36,437 INFO     [learner.py:606] ====Pushing takes 0.025153636932373047 s
2021-08-18:16:17:36,474 INFO     [learner.py:606] ====Pushing takes 0.04135394096374512 s
2021-08-18:16:17:36,478 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:36,490 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:36,491 INFO     [param_server.py:410] Lock worker 2 with localStep 215 , while globalStep is 214

2021-08-18:16:17:36,516 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:36,523 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:36,524 INFO     [param_server.py:381] ====After aggregation in epoch: 214, virtual_clock: 7446.032370339973, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 2.6386728352970548, test len: 3099.0
2021-08-18:16:17:36,526 INFO     [param_server.py:410] Lock worker 3 with localStep 215 , while globalStep is 215

2021-08-18:16:17:36,527 INFO     [param_server.py:441] ====Epoch 216 completes 20 clients with loss 197.98050649485265, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:36,528 INFO     [param_server.py:450] ====Start to sample for epoch 216, global virtualClock: 7446.032370339973, round_duration: 46.65186139097271
2021-08-18:16:17:36,529 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:36,866 INFO     [param_server.py:553] For epoch: 216, median_reward: 349.3344255606906, dev: 349.3344255606906
2021-08-18:16:17:37,525 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.633, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:17:37,526 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2921.0263, eval_time 0.615, test_loss 2.633, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:17:37,593 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:37,602 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:37,603 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6729, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:17:37,603 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2921.1038, eval_time 0.6892, test_loss 2.6729, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:17:37,636 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9021, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:17:37,667 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2921.1659, eval_time 0.7564, test_loss 2.9021, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:17:37,694 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:37,714 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:37,738 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:37,763 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:39,130 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:39,151 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:39,336 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:39,346 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:40,566 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:40,577 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:40,587 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:40,586 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:40,629 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:40,638 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:41,302 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:41,323 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:42,61 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:42,82 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:42,767 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:42,795 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:43,106 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:43,124 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:43,205 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:43,223 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:43,475 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:43,500 INFO     [learner.py:606] ====Pushing takes 0.023334980010986328 s
2021-08-18:16:17:43,534 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:43,569 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:43,570 INFO     [param_server.py:410] Lock worker 1 with localStep 216 , while globalStep is 215

2021-08-18:16:17:43,706 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:43,715 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:45,877 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:45,888 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:46,321 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:46,332 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:47,7 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:47,16 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:47,32 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:47,42 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:48,106 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:48,118 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:48,155 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:48,169 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:48,738 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:48,767 INFO     [learner.py:606] ====Pushing takes 0.028367280960083008 s
2021-08-18:16:17:48,808 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:48,818 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:48,818 INFO     [param_server.py:410] Lock worker 3 with localStep 216 , while globalStep is 215

2021-08-18:16:17:49,368 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:49,394 INFO     [learner.py:606] ====Pushing takes 0.02527618408203125 s
2021-08-18:16:17:49,425 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:49,433 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:49,434 INFO     [param_server.py:381] ====After aggregation in epoch: 215, virtual_clock: 7492.684231730946, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 2.736007787563183, test len: 3099.0
2021-08-18:16:17:49,436 INFO     [param_server.py:410] Lock worker 2 with localStep 216 , while globalStep is 216

2021-08-18:16:17:49,436 INFO     [param_server.py:441] ====Epoch 217 completes 20 clients with loss 180.56307583572755, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:49,437 INFO     [param_server.py:450] ====Start to sample for epoch 217, global virtualClock: 7492.684231730946, round_duration: 46.65186139097271
2021-08-18:16:17:49,438 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:49,777 INFO     [param_server.py:553] For epoch: 217, median_reward: 337.50521368562727, dev: 337.50521368562727
2021-08-18:16:17:50,454 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6473, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:17:50,455 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2933.9553, eval_time 0.6324, test_loss 2.6473, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:17:50,520 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:17:50,530 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:50,531 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5622, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:17:50,532 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2934.0323, eval_time 0.7067, test_loss 2.5622, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:17:50,565 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9707, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:17:50,567 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2934.0653, eval_time 0.7443, test_loss 2.9707, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:17:50,621 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:17:50,635 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:17:50,642 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:50,655 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:52,114 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:52,141 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:52,227 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:52,240 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:53,447 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:53,458 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:53,535 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:53,544 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:54,121 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:54,141 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:54,879 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:54,900 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:55,509 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:55,523 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:55,924 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:55,935 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:56,102 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:56,112 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:56,130 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:56,194 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:56,532 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:56,541 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:56,855 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:56,878 INFO     [learner.py:606] ====Pushing takes 0.021177291870117188 s
2021-08-18:16:17:56,916 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:56,923 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:56,923 INFO     [param_server.py:410] Lock worker 1 with localStep 217 , while globalStep is 216

2021-08-18:16:17:58,818 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:58,828 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:59,304 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:59,313 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:59,942 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:59,952 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:00,8 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:00,20 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:01,55 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:01,67 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:01,95 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:01,117 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:01,697 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:01,717 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:01,723 INFO     [learner.py:606] ====Pushing takes 0.024443626403808594 s
2021-08-18:16:18:01,758 INFO     [learner.py:606] ====Pushing takes 0.03904008865356445 s
2021-08-18:16:18:01,758 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:01,766 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:01,766 INFO     [param_server.py:410] Lock worker 2 with localStep 217 , while globalStep is 216

2021-08-18:16:18:01,791 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:01,798 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:01,799 INFO     [param_server.py:381] ====After aggregation in epoch: 216, virtual_clock: 7539.336093121919, top_1: : 63.6657 % (1973.0), top_5: : 100.0 % (3099.0), test loss: 2.7267245584064064, test len: 3099.0
2021-08-18:16:18:01,801 INFO     [param_server.py:410] Lock worker 3 with localStep 217 , while globalStep is 217

2021-08-18:16:18:01,801 INFO     [param_server.py:441] ====Epoch 218 completes 20 clients with loss 126.08909680318978, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:01,801 INFO     [param_server.py:450] ====Start to sample for epoch 218, global virtualClock: 7539.336093121919, round_duration: 46.65186139097271
2021-08-18:16:18:01,802 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:02,125 INFO     [param_server.py:553] For epoch: 218, median_reward: 334.2203998442255, dev: 334.2203998442255
2021-08-18:16:18:02,776 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8047, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:18:02,780 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2946.2803, eval_time 0.6082, test_loss 2.8047, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:18:02,816 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7894, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:18:02,820 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2946.3203, eval_time 0.648, test_loss 2.7894, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:18:02,856 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:02,863 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:02,919 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:02,933 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:02,933 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7695, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:18:02,934 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2946.4324, eval_time 0.7643, test_loss 3.7695, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:18:02,993 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:03,27 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:04,453 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:04,467 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:04,517 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:04,544 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:05,659 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:05,668 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:05,827 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:05,841 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:06,115 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:06,136 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:06,852 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:06,873 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:07,595 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:07,616 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:08,236 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:08,247 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:08,255 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:08,269 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:08,311 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:08,321 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:08,789 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:08,813 INFO     [learner.py:606] ====Pushing takes 0.023304224014282227 s
2021-08-18:16:18:08,851 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:08,862 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:08,863 INFO     [param_server.py:410] Lock worker 1 with localStep 218 , while globalStep is 217

2021-08-18:16:18:08,869 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:08,878 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:10,783 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:10,794 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:11,513 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:11,525 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:12,12 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:12,21 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:12,148 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:12,158 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:13,160 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:13,169 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:13,488 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:13,499 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:14,3 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:14,32 INFO     [learner.py:606] ====Pushing takes 0.02838921546936035 s
2021-08-18:16:18:14,72 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:14,80 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:14,80 INFO     [param_server.py:410] Lock worker 3 with localStep 218 , while globalStep is 217

2021-08-18:16:18:14,456 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:14,485 INFO     [learner.py:606] ====Pushing takes 0.02734851837158203 s
2021-08-18:16:18:14,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:14,529 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:14,530 INFO     [param_server.py:381] ====After aggregation in epoch: 217, virtual_clock: 7585.9879545128915, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.1211890953558465, test len: 3099.0
2021-08-18:16:18:14,532 INFO     [param_server.py:410] Lock worker 2 with localStep 218 , while globalStep is 218

2021-08-18:16:18:14,533 INFO     [param_server.py:441] ====Epoch 219 completes 20 clients with loss 218.36210772127808, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:14,533 INFO     [param_server.py:450] ====Start to sample for epoch 219, global virtualClock: 7585.9879545128915, round_duration: 46.65186139097271
2021-08-18:16:18:14,534 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:14,878 INFO     [param_server.py:553] For epoch: 219, median_reward: 323.2352982464233, dev: 323.2352982464233
2021-08-18:16:18:15,540 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7207, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:18:15,541 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2959.0411, eval_time 0.6181, test_loss 2.7207, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:18:15,594 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.931, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:18:15,595 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2959.0958, eval_time 0.6721, test_loss 2.931, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:18:15,608 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:15,616 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:15,665 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3135, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:18:15,668 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2959.1666, eval_time 0.7454, test_loss 3.3135, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:18:15,684 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:15,700 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:15,740 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:15,768 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:17,167 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:17,188 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:17,254 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:17,264 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:18,591 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:18,600 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:18,679 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:18,691 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:19,92 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:19,106 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:19,771 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:19,785 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:20,437 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:20,456 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:20,936 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:20,950 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:21,112 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:21,121 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:21,122 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:21,141 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:21,660 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:21,677 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:21,694 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:21,718 INFO     [learner.py:606] ====Pushing takes 0.021729707717895508 s
2021-08-18:16:18:21,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:21,760 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:21,761 INFO     [param_server.py:410] Lock worker 1 with localStep 219 , while globalStep is 218

2021-08-18:16:18:23,655 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:23,678 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:24,480 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:24,498 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:24,876 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:24,886 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:25,157 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:25,168 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:25,978 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:25,988 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:26,404 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:26,422 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:26,486 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:26,513 INFO     [learner.py:606] ====Pushing takes 0.025702238082885742 s
2021-08-18:16:18:26,544 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:26,552 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:26,553 INFO     [param_server.py:410] Lock worker 2 with localStep 219 , while globalStep is 218

2021-08-18:16:18:26,964 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:26,993 INFO     [learner.py:606] ====Pushing takes 0.027652978897094727 s
2021-08-18:16:18:27,30 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:27,38 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:27,39 INFO     [param_server.py:381] ====After aggregation in epoch: 218, virtual_clock: 7632.6398159038645, top_1: : 62.9235 % (1950.0), top_5: : 100.0 % (3099.0), test loss: 2.988424089219835, test len: 3099.0
2021-08-18:16:18:27,41 INFO     [param_server.py:410] Lock worker 3 with localStep 219 , while globalStep is 219

2021-08-18:16:18:27,41 INFO     [param_server.py:441] ====Epoch 220 completes 20 clients with loss 62.58042882613529, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:27,42 INFO     [param_server.py:450] ====Start to sample for epoch 220, global virtualClock: 7632.6398159038645, round_duration: 46.65186139097271
2021-08-18:16:18:27,42 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:27,328 INFO     [param_server.py:553] For epoch: 220, median_reward: 332.73757085958215, dev: 332.73757085958215
2021-08-18:16:18:28,32 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0363, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:18:28,33 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2971.5336, eval_time 0.6605, test_loss 3.0363, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:18:28,82 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7187, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:18:28,83 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2971.5839, eval_time 0.7084, test_loss 2.7187, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:18:28,100 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:28,114 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:28,151 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8374, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:18:28,152 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2971.6503, eval_time 0.779, test_loss 2.8374, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:18:28,162 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:28,178 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:28,229 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:28,250 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:29,621 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:29,632 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:29,714 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:29,735 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:30,748 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:30,762 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:30,788 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:30,809 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:31,159 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:31,180 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:31,892 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:31,913 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:32,626 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:32,646 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:33,198 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:33,212 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:33,274 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:33,284 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:33,339 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:33,366 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:33,883 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:33,907 INFO     [learner.py:606] ====Pushing takes 0.0223848819732666 s
2021-08-18:16:18:33,941 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:33,951 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:33,952 INFO     [param_server.py:410] Lock worker 1 with localStep 220 , while globalStep is 219

2021-08-18:16:18:33,999 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:34,13 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:35,958 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:35,969 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:36,853 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:36,862 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:37,129 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:37,139 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:37,537 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:37,548 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:38,243 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:38,253 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:38,732 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:38,751 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:39,352 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:39,354 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:39,384 INFO     [learner.py:606] ====Pushing takes 0.03025197982788086 s
2021-08-18:16:18:39,396 INFO     [learner.py:606] ====Pushing takes 0.03988313674926758 s
2021-08-18:16:18:39,424 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:39,432 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:39,433 INFO     [param_server.py:410] Lock worker 3 with localStep 220 , while globalStep is 219

2021-08-18:16:18:39,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:39,465 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:39,466 INFO     [param_server.py:381] ====After aggregation in epoch: 219, virtual_clock: 7679.291677294837, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 2.8640999242111485, test len: 3099.0
2021-08-18:16:18:39,468 INFO     [param_server.py:410] Lock worker 2 with localStep 220 , while globalStep is 220

2021-08-18:16:18:39,469 INFO     [param_server.py:441] ====Epoch 221 completes 20 clients with loss 143.83187560778407, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:39,469 INFO     [param_server.py:450] ====Start to sample for epoch 221, global virtualClock: 7679.291677294837, round_duration: 46.65186139097271
2021-08-18:16:18:39,470 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:39,784 INFO     [param_server.py:541] Handle Wight 0.03496742248535156 | Send 0.3149082660675049
2021-08-18:16:18:39,785 INFO     [param_server.py:553] For epoch: 221, median_reward: 330.0511292743865, dev: 330.0511292743865
2021-08-18:16:18:40,395 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7636, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:18:40,396 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2983.8964, eval_time 0.5646, test_loss 2.7636, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:18:40,436 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7176, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:18:40,437 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2983.9372, eval_time 0.6053, test_loss 2.7176, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:18:40,476 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:40,484 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:40,509 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8525, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:18:40,510 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2984.0084, eval_time 0.6805, test_loss 2.8525, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:18:40,515 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:40,531 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:40,580 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:40,608 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:41,990 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:42,10 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:42,45 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:42,54 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:43,151 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:43,167 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:43,316 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:43,335 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:43,883 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:43,909 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:44,728 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:44,755 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:45,511 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:45,564 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:45,885 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:45,895 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:45,988 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:46,3 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:46,192 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:46,213 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:46,708 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:46,717 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:46,836 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:46,858 INFO     [learner.py:606] ====Pushing takes 0.020671367645263672 s
2021-08-18:16:18:46,893 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:46,900 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:46,901 INFO     [param_server.py:410] Lock worker 1 with localStep 221 , while globalStep is 220

2021-08-18:16:18:48,566 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:48,577 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:49,553 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:49,564 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:49,880 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:49,890 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:50,220 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:50,230 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:51,241 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:51,251 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:51,386 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:51,395 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:51,870 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:51,896 INFO     [learner.py:606] ====Pushing takes 0.025200843811035156 s
2021-08-18:16:18:51,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:51,944 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:51,944 INFO     [param_server.py:410] Lock worker 2 with localStep 221 , while globalStep is 220

2021-08-18:16:18:52,4 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:52,33 INFO     [learner.py:606] ====Pushing takes 0.026943683624267578 s
2021-08-18:16:18:52,63 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:52,71 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:52,72 INFO     [param_server.py:381] ====After aggregation in epoch: 220, virtual_clock: 7725.94353868581, top_1: : 63.2462 % (1960.0), top_5: : 100.0 % (3099.0), test loss: 2.777907640845687, test len: 3099.0
2021-08-18:16:18:52,90 INFO     [param_server.py:410] Lock worker 3 with localStep 221 , while globalStep is 221

2021-08-18:16:18:52,90 INFO     [param_server.py:441] ====Epoch 222 completes 20 clients with loss 276.83017484352325, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:52,91 INFO     [param_server.py:450] ====Start to sample for epoch 222, global virtualClock: 7725.94353868581, round_duration: 46.65186139097271
2021-08-18:16:18:52,92 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:52,394 INFO     [param_server.py:553] For epoch: 222, median_reward: 377.5912829103082, dev: 377.5912829103082
2021-08-18:16:18:52,953 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9022, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:18:52,954 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2996.4542, eval_time 0.5256, test_loss 2.9022, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:18:53,21 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:18:53,25 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6808, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:18:53,28 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2996.5269, eval_time 0.6002, test_loss 2.6808, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:18:53,29 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:53,87 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7125, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:18:53,88 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2996.5882, eval_time 0.6552, test_loss 2.7125, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:18:53,96 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:18:53,112 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:53,156 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:18:53,168 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:54,414 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:54,435 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:54,677 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:54,686 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:55,818 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:55,827 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:55,857 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:55,873 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:56,97 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:56,124 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:57,45 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:57,72 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:57,836 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:57,863 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:58,387 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:58,408 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:58,481 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:58,492 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:58,508 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:58,512 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:59,62 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:59,80 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:59,86 INFO     [learner.py:606] ====Pushing takes 0.022202014923095703 s
2021-08-18:16:18:59,90 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:59,121 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:59,131 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:59,131 INFO     [param_server.py:410] Lock worker 1 with localStep 222 , while globalStep is 221

2021-08-18:16:19:01,99 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:01,110 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:01,716 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:01,729 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:02,326 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:02,336 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:02,406 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:02,416 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:03,660 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:03,673 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:03,711 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:03,729 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:04,402 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:04,432 INFO     [learner.py:606] ====Pushing takes 0.029125213623046875 s
2021-08-18:16:19:04,477 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:04,485 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:04,485 INFO     [param_server.py:410] Lock worker 3 with localStep 222 , while globalStep is 221

2021-08-18:16:19:04,779 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:04,806 INFO     [learner.py:606] ====Pushing takes 0.025272130966186523 s
2021-08-18:16:19:04,837 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:04,844 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:04,845 INFO     [param_server.py:381] ====After aggregation in epoch: 221, virtual_clock: 7772.595400076783, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 2.7651623399169356, test len: 3099.0
2021-08-18:16:19:04,847 INFO     [param_server.py:410] Lock worker 2 with localStep 222 , while globalStep is 222

2021-08-18:16:19:04,848 INFO     [param_server.py:441] ====Epoch 223 completes 20 clients with loss 128.36506025038435, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:04,848 INFO     [param_server.py:450] ====Start to sample for epoch 223, global virtualClock: 7772.595400076783, round_duration: 46.65186139097271
2021-08-18:16:19:04,849 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:05,131 INFO     [param_server.py:553] For epoch: 223, median_reward: 354.61879274892937, dev: 354.61879274892937
2021-08-18:16:19:05,766 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7554, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:19:05,767 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 3009.2678, eval_time 0.6011, test_loss 2.7554, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:19:05,812 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8124, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:19:05,813 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 3009.3138, eval_time 0.6466, test_loss 2.8124, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:19:05,837 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:05,846 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:05,869 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8058, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:19:05,870 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 3009.3684, eval_time 0.7054, test_loss 2.8058, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:19:05,884 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:05,897 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:05,939 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:05,962 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:07,248 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:07,275 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:07,556 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:07,565 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:08,617 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:08,627 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:08,795 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:08,809 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:09,387 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:09,421 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:10,123 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:10,150 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:10,945 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:10,966 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:11,268 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:11,278 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:11,354 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:11,366 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:11,637 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:11,657 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:12,29 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:12,43 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:12,321 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:12,341 INFO     [learner.py:606] ====Pushing takes 0.018932819366455078 s
2021-08-18:16:19:12,374 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:12,381 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:12,382 INFO     [param_server.py:410] Lock worker 1 with localStep 223 , while globalStep is 222

2021-08-18:16:19:14,79 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:14,90 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:14,689 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:14,703 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:15,344 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:15,354 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:15,383 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:15,392 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:16,591 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:16,603 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:16,622 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:16,633 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:17,242 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:17,270 INFO     [learner.py:606] ====Pushing takes 0.026758670806884766 s
2021-08-18:16:19:17,301 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:17,304 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:17,309 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:17,310 INFO     [param_server.py:410] Lock worker 2 with localStep 223 , while globalStep is 222

2021-08-18:16:19:17,332 INFO     [learner.py:606] ====Pushing takes 0.02706766128540039 s
2021-08-18:16:19:17,367 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:17,375 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:17,376 INFO     [param_server.py:381] ====After aggregation in epoch: 222, virtual_clock: 7819.247261467756, top_1: : 65.1178 % (2018.0), top_5: : 100.0 % (3099.0), test loss: 2.791218130676835, test len: 3099.0
2021-08-18:16:19:17,379 INFO     [param_server.py:410] Lock worker 3 with localStep 223 , while globalStep is 223

2021-08-18:16:19:17,379 INFO     [param_server.py:441] ====Epoch 224 completes 20 clients with loss 158.94180961977165, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:17,380 INFO     [param_server.py:450] ====Start to sample for epoch 224, global virtualClock: 7819.247261467756, round_duration: 46.65186139097271
2021-08-18:16:19:17,381 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:17,653 INFO     [param_server.py:553] For epoch: 224, median_reward: 339.83228261606865, dev: 339.83228261606865
2021-08-18:16:19:18,274 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7183, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:19:18,274 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3021.7748, eval_time 0.5875, test_loss 2.7183, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:19:18,308 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5305, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:19:18,309 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3021.8096, eval_time 0.6207, test_loss 2.5305, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:19:18,343 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:18,352 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:18,354 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6459, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:19:18,357 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3021.8556, eval_time 0.6702, test_loss 2.6459, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:19:18,379 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:18,391 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:18,415 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:18,432 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:19,785 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:19,805 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:19,845 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:19,855 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:21,43 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:21,53 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:21,106 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:21,121 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:21,279 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:21,306 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:22,75 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:22,109 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:22,848 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:22,868 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:23,648 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:23,659 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:23,669 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:23,672 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:23,707 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:23,721 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:24,254 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:24,278 INFO     [learner.py:606] ====Pushing takes 0.02289438247680664 s
2021-08-18:16:19:24,294 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:24,304 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:24,314 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:24,323 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:24,324 INFO     [param_server.py:410] Lock worker 1 with localStep 224 , while globalStep is 223

2021-08-18:16:19:26,256 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:26,270 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:27,2 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:27,11 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:27,544 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:27,557 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:27,680 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:27,690 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:28,848 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:28,858 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:28,922 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:28,934 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:29,622 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:29,651 INFO     [learner.py:606] ====Pushing takes 0.027328968048095703 s
2021-08-18:16:19:29,689 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:29,697 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:29,698 INFO     [param_server.py:410] Lock worker 3 with localStep 224 , while globalStep is 223

2021-08-18:16:19:30,42 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:30,69 INFO     [learner.py:606] ====Pushing takes 0.025458574295043945 s
2021-08-18:16:19:30,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:30,110 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:30,110 INFO     [param_server.py:381] ====After aggregation in epoch: 223, virtual_clock: 7865.899122858729, top_1: : 65.7631 % (2038.0), top_5: : 100.0 % (3099.0), test loss: 2.6315660344229808, test len: 3099.0
2021-08-18:16:19:30,113 INFO     [param_server.py:410] Lock worker 2 with localStep 224 , while globalStep is 224

2021-08-18:16:19:30,113 INFO     [param_server.py:441] ====Epoch 225 completes 20 clients with loss 230.6754085850718, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:30,114 INFO     [param_server.py:450] ====Start to sample for epoch 225, global virtualClock: 7865.899122858729, round_duration: 46.65186139097271
2021-08-18:16:19:30,115 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:30,426 INFO     [param_server.py:553] For epoch: 225, median_reward: 356.5817991696211, dev: 356.5817991696211
2021-08-18:16:19:31,61 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0123, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:19:31,62 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3034.5626, eval_time 0.6003, test_loss 3.0123, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:19:31,111 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5868, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:19:31,112 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3034.6124, eval_time 0.6499, test_loss 2.5868, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:19:31,127 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:31,135 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:31,180 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5214, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:19:31,181 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3034.6795, eval_time 0.7198, test_loss 2.5214, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:19:31,183 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:31,196 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:31,252 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:31,274 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:32,507 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:32,528 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:32,808 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:32,817 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:34,24 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:34,28 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:34,34 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:34,43 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:34,732 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:34,752 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:35,398 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:35,418 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:36,154 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:36,176 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:36,315 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:36,326 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:36,675 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:36,685 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:36,923 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:36,925 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:36,933 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:36,946 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:37,518 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:37,542 INFO     [learner.py:606] ====Pushing takes 0.022871732711791992 s
2021-08-18:16:19:37,582 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:37,589 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:37,590 INFO     [param_server.py:410] Lock worker 1 with localStep 225 , while globalStep is 224

2021-08-18:16:19:39,280 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:39,292 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:39,761 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:39,781 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:40,475 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:40,486 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:40,512 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:40,522 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:41,536 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:41,546 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:41,795 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:41,807 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:42,191 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:42,224 INFO     [learner.py:606] ====Pushing takes 0.03106093406677246 s
2021-08-18:16:19:42,278 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:42,287 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:42,287 INFO     [param_server.py:410] Lock worker 3 with localStep 225 , while globalStep is 224

2021-08-18:16:19:42,430 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:42,457 INFO     [learner.py:606] ====Pushing takes 0.025426387786865234 s
2021-08-18:16:19:42,492 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:42,499 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:42,500 INFO     [param_server.py:381] ====After aggregation in epoch: 224, virtual_clock: 7912.550984249702, top_1: : 63.2462 % (1960.0), top_5: : 100.0 % (3099.0), test loss: 2.706842549559143, test len: 3099.0
2021-08-18:16:19:42,503 INFO     [param_server.py:410] Lock worker 2 with localStep 225 , while globalStep is 225

2021-08-18:16:19:42,503 INFO     [param_server.py:441] ====Epoch 226 completes 20 clients with loss 87.43684103677177, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:42,522 INFO     [param_server.py:450] ====Start to sample for epoch 226, global virtualClock: 7912.550984249702, round_duration: 46.65186139097271
2021-08-18:16:19:42,523 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:42,866 INFO     [param_server.py:553] For epoch: 226, median_reward: 323.61111482984063, dev: 323.61111482984063
2021-08-18:16:19:43,583 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8338, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:19:43,588 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3047.088, eval_time 0.6769, test_loss 2.8338, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:19:43,589 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3854, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:19:43,592 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3047.0927, eval_time 0.6809, test_loss 2.3854, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:19:43,642 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0243, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:19:43,643 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3047.1419, eval_time 0.7325, test_loss 3.0243, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:19:43,659 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:19:43,662 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:19:43,666 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:43,670 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:43,716 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:19:43,736 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:44,992 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:45,13 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:45,183 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:45,210 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:46,344 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:46,354 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:46,412 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:46,443 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:46,484 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:46,493 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:47,230 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:47,257 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:48,16 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:48,37 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:48,695 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:48,715 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:48,902 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:48,912 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:49,235 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:49,245 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:49,394 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:49,418 INFO     [learner.py:606] ====Pushing takes 0.02199721336364746 s
2021-08-18:16:19:49,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:49,461 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:49,462 INFO     [param_server.py:410] Lock worker 1 with localStep 226 , while globalStep is 225

2021-08-18:16:19:49,639 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:49,648 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:51,697 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:51,706 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:52,302 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:52,324 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:52,919 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:52,933 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:53,91 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:53,105 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:54,59 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:54,77 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:54,80 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:54,89 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:54,675 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:54,701 INFO     [learner.py:606] ====Pushing takes 0.024411678314208984 s
2021-08-18:16:19:54,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:54,762 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:54,762 INFO     [param_server.py:410] Lock worker 3 with localStep 226 , while globalStep is 225

2021-08-18:16:19:55,146 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:55,174 INFO     [learner.py:606] ====Pushing takes 0.02657151222229004 s
2021-08-18:16:19:55,212 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:55,220 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:55,220 INFO     [param_server.py:381] ====After aggregation in epoch: 225, virtual_clock: 7959.202845640675, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 2.747833755833131, test len: 3099.0
2021-08-18:16:19:55,224 INFO     [param_server.py:410] Lock worker 2 with localStep 226 , while globalStep is 226

2021-08-18:16:19:55,224 INFO     [param_server.py:441] ====Epoch 227 completes 20 clients with loss 311.705364147859, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:55,224 INFO     [param_server.py:450] ====Start to sample for epoch 227, global virtualClock: 7959.202845640675, round_duration: 46.65186139097271
2021-08-18:16:19:55,225 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:55,566 INFO     [param_server.py:553] For epoch: 227, median_reward: 353.65316121084857, dev: 353.65316121084857
2021-08-18:16:19:56,289 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.284, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:19:56,290 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3059.7908, eval_time 0.6795, test_loss 4.284, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:19:56,292 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.537, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:19:56,292 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3059.7929, eval_time 0.6774, test_loss 2.537, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:19:56,346 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6305, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:19:56,349 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3059.8478, eval_time 0.7382, test_loss 3.6305, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:19:56,362 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:19:56,371 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:56,386 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:19:56,395 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:56,426 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:19:56,447 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:57,672 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:57,692 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:57,916 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:57,931 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:59,56 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:59,67 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:59,154 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:59,163 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:59,344 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:59,365 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:00,56 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:00,84 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:00,819 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:00,839 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:01,424 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:01,434 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:01,520 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:01,541 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:01,795 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:01,804 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:02,63 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:02,73 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:02,155 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:02,179 INFO     [learner.py:606] ====Pushing takes 0.02202749252319336 s
2021-08-18:16:20:02,215 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:02,222 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:02,223 INFO     [param_server.py:410] Lock worker 1 with localStep 227 , while globalStep is 226

2021-08-18:16:20:04,394 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:04,409 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:04,771 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:04,790 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:05,509 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:05,518 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:05,590 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:05,605 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:06,770 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:06,789 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:06,818 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:06,833 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:07,401 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:07,427 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:07,427 INFO     [learner.py:606] ====Pushing takes 0.02457118034362793 s
2021-08-18:16:20:07,468 INFO     [learner.py:606] ====Pushing takes 0.04018115997314453 s
2021-08-18:16:20:07,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:07,481 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:07,482 INFO     [param_server.py:410] Lock worker 2 with localStep 227 , while globalStep is 226

2021-08-18:16:20:07,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:07,515 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:07,515 INFO     [param_server.py:381] ====After aggregation in epoch: 226, virtual_clock: 8005.854707031648, top_1: : 64.0207 % (1984.0), top_5: : 100.0 % (3099.0), test loss: 3.4838243237248174, test len: 3099.0
2021-08-18:16:20:07,518 INFO     [param_server.py:410] Lock worker 3 with localStep 227 , while globalStep is 227

2021-08-18:16:20:07,519 INFO     [param_server.py:441] ====Epoch 228 completes 20 clients with loss 156.7077057792477, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:07,520 INFO     [param_server.py:450] ====Start to sample for epoch 228, global virtualClock: 8005.854707031648, round_duration: 46.65186139097271
2021-08-18:16:20:07,521 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:07,838 INFO     [param_server.py:553] For epoch: 228, median_reward: 343.23043655276234, dev: 343.23043655276234
2021-08-18:16:20:08,584 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7426, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:20:08,585 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3072.0855, eval_time 0.7117, test_loss 2.7426, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:20:08,628 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6895, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:20:08,629 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3072.13, eval_time 0.7561, test_loss 2.6895, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:20:08,664 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6597, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:20:08,665 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3072.1634, eval_time 0.7919, test_loss 2.6597, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:20:08,675 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:08,684 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:08,698 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:08,714 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:08,734 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:08,760 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:10,153 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:10,173 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:10,516 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:10,526 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:11,424 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:11,438 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:11,680 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:11,689 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:11,778 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:11,791 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:12,157 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:12,178 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:13,34 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:13,52 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:13,689 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:13,703 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:14,75 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:14,86 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:14,272 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:14,298 INFO     [learner.py:606] ====Pushing takes 0.023342609405517578 s
2021-08-18:16:20:14,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:14,340 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:14,341 INFO     [param_server.py:410] Lock worker 1 with localStep 228 , while globalStep is 227

2021-08-18:16:20:14,511 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:14,522 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:14,723 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:14,733 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:17,23 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:17,32 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:17,383 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:17,397 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:18,120 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:18,129 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:18,243 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:18,252 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:19,379 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:19,393 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:19,426 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:19,435 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:19,986 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:20,16 INFO     [learner.py:606] ====Pushing takes 0.028702497482299805 s
2021-08-18:16:20:20,55 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:20,63 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:20,63 INFO     [param_server.py:410] Lock worker 3 with localStep 228 , while globalStep is 227

2021-08-18:16:20:20,693 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:20,720 INFO     [learner.py:606] ====Pushing takes 0.025574684143066406 s
2021-08-18:16:20:20,751 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:20,759 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:20,760 INFO     [param_server.py:381] ====After aggregation in epoch: 227, virtual_clock: 8052.506568422621, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 2.6972424476235, test len: 3099.0
2021-08-18:16:20:20,763 INFO     [param_server.py:410] Lock worker 2 with localStep 228 , while globalStep is 228

2021-08-18:16:20:20,763 INFO     [param_server.py:441] ====Epoch 229 completes 20 clients with loss 160.22228866174774, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:20,764 INFO     [param_server.py:450] ====Start to sample for epoch 229, global virtualClock: 8052.506568422621, round_duration: 46.65186139097271
2021-08-18:16:20:20,764 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:21,52 INFO     [param_server.py:553] For epoch: 229, median_reward: 332.64940105090335, dev: 332.64940105090335
2021-08-18:16:20:21,637 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.687, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:20:21,637 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3085.1379, eval_time 0.54, test_loss 2.687, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:20:21,684 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.471, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:20:21,685 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3085.1855, eval_time 0.5869, test_loss 2.471, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:20:21,716 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:21,731 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:21,755 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:21,763 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8222, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:20:21,764 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3085.263, eval_time 0.6669, test_loss 2.8222, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:20:21,778 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:21,833 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:21,854 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:23,121 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:23,149 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:23,399 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:23,410 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:24,579 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:24,594 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:24,664 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:24,673 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:24,964 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:24,984 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:25,697 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:25,711 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:26,412 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:26,426 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:26,900 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:26,910 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:27,80 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:27,101 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:27,398 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:27,409 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:27,600 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:27,609 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:27,722 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:27,744 INFO     [learner.py:606] ====Pushing takes 0.021710872650146484 s
2021-08-18:16:20:27,785 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:27,794 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:27,795 INFO     [param_server.py:410] Lock worker 1 with localStep 229 , while globalStep is 228

2021-08-18:16:20:30,152 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:30,166 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:30,362 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:30,376 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:30,977 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:30,987 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:31,266 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:31,275 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:32,320 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:32,340 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:32,496 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:32,507 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:32,989 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:33,8 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:33,19 INFO     [learner.py:606] ====Pushing takes 0.02846670150756836 s
2021-08-18:16:20:33,39 INFO     [learner.py:606] ====Pushing takes 0.029567241668701172 s
2021-08-18:16:20:33,68 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:33,76 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:33,77 INFO     [param_server.py:410] Lock worker 3 with localStep 229 , while globalStep is 228

2021-08-18:16:20:33,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:33,108 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:33,109 INFO     [param_server.py:381] ====After aggregation in epoch: 228, virtual_clock: 8099.158429813594, top_1: : 63.4398 % (1966.0), top_5: : 100.0 % (3099.0), test loss: 2.6600403454568653, test len: 3099.0
2021-08-18:16:20:33,111 INFO     [param_server.py:410] Lock worker 2 with localStep 229 , while globalStep is 229

2021-08-18:16:20:33,112 INFO     [param_server.py:441] ====Epoch 230 completes 20 clients with loss 64.8926423496164, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:33,112 INFO     [param_server.py:450] ====Start to sample for epoch 230, global virtualClock: 8099.158429813594, round_duration: 46.65186139097271
2021-08-18:16:20:33,114 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:33,433 INFO     [param_server.py:553] For epoch: 230, median_reward: 310.8925760362109, dev: 310.8925760362109
2021-08-18:16:20:34,52 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7727, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:20:34,54 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3097.5547, eval_time 0.57, test_loss 2.7727, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:20:34,59 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7987, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:20:34,60 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3097.5605, eval_time 0.5802, test_loss 2.7987, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:20:34,126 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:34,133 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5398, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:20:34,136 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3097.6347, eval_time 0.6583, test_loss 2.5398, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:20:34,139 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:34,154 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:34,162 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:34,205 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:34,227 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:35,622 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:35,643 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:35,678 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:35,692 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:36,822 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:36,832 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:36,920 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:36,929 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:37,107 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:37,121 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:37,850 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:37,870 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:38,579 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:38,592 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:39,236 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:39,251 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:39,270 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:39,280 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:39,571 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:39,580 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:39,893 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:39,917 INFO     [learner.py:606] ====Pushing takes 0.022507667541503906 s
2021-08-18:16:20:39,952 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:39,958 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:39,959 INFO     [param_server.py:410] Lock worker 1 with localStep 230 , while globalStep is 229

2021-08-18:16:20:39,993 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:40,3 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:42,168 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:42,177 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:42,661 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:42,675 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:43,315 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:43,330 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:43,369 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:43,383 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:44,443 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:44,463 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:44,649 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:44,658 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:45,184 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:45,216 INFO     [learner.py:606] ====Pushing takes 0.031276702880859375 s
2021-08-18:16:20:45,254 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:45,263 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:45,264 INFO     [param_server.py:410] Lock worker 3 with localStep 230 , while globalStep is 229

2021-08-18:16:20:45,768 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:45,797 INFO     [learner.py:606] ====Pushing takes 0.026857376098632812 s
2021-08-18:16:20:45,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:45,844 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:45,845 INFO     [param_server.py:381] ====After aggregation in epoch: 229, virtual_clock: 8145.810291204567, top_1: : 64.8919 % (2011.0), top_5: : 100.0 % (3099.0), test loss: 2.7037177913718753, test len: 3099.0
2021-08-18:16:20:45,847 INFO     [param_server.py:410] Lock worker 2 with localStep 230 , while globalStep is 230

2021-08-18:16:20:45,848 INFO     [param_server.py:441] ====Epoch 231 completes 20 clients with loss 167.8345990311322, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:45,848 INFO     [param_server.py:450] ====Start to sample for epoch 231, global virtualClock: 8145.810291204567, round_duration: 46.65186139097271
2021-08-18:16:20:45,849 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:46,117 INFO     [param_server.py:553] For epoch: 231, median_reward: 341.0876416248709, dev: 341.0876416248709
2021-08-18:16:20:46,693 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8178, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:20:46,694 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3110.1948, eval_time 0.5322, test_loss 2.8178, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:20:46,771 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:20:46,777 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.752, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:20:46,778 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3110.2765, eval_time 0.6158, test_loss 2.752, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:20:46,781 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:46,845 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:20:46,865 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:46,872 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.435, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:20:46,893 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3110.3934, eval_time 0.7261, test_loss 2.435, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:20:46,963 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:20:46,978 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:48,222 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:48,240 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:48,501 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:48,510 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:49,699 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:49,711 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:49,773 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:49,783 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:50,155 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:50,176 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:50,941 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:50,961 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:51,617 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:51,630 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:52,144 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:52,155 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:52,231 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:52,245 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:52,539 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:52,551 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:52,820 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:52,848 INFO     [learner.py:606] ====Pushing takes 0.023226022720336914 s
2021-08-18:16:20:52,872 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:52,881 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:52,882 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:52,891 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:52,892 INFO     [param_server.py:410] Lock worker 1 with localStep 231 , while globalStep is 230

2021-08-18:16:20:55,274 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:55,285 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:55,768 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:55,780 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:56,344 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:56,353 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:56,505 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:56,519 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:57,625 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:57,639 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:57,713 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:57,732 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:58,233 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:58,259 INFO     [learner.py:606] ====Pushing takes 0.02506852149963379 s
2021-08-18:16:20:58,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:58,300 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:58,301 INFO     [param_server.py:410] Lock worker 2 with localStep 231 , while globalStep is 230

2021-08-18:16:20:58,338 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:58,370 INFO     [learner.py:606] ====Pushing takes 0.03038620948791504 s
2021-08-18:16:20:58,404 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:58,411 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:58,412 INFO     [param_server.py:381] ====After aggregation in epoch: 230, virtual_clock: 8192.462152595539, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 2.6682737050233065, test len: 3099.0
2021-08-18:16:20:58,414 INFO     [param_server.py:410] Lock worker 3 with localStep 231 , while globalStep is 231

2021-08-18:16:20:58,414 INFO     [param_server.py:441] ====Epoch 232 completes 20 clients with loss 156.41452166897548, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:58,415 INFO     [param_server.py:450] ====Start to sample for epoch 232, global virtualClock: 8192.462152595539, round_duration: 46.65186139097271
2021-08-18:16:20:58,416 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:58,748 INFO     [param_server.py:553] For epoch: 232, median_reward: 347.0429249327039, dev: 347.0429249327039
2021-08-18:16:20:59,385 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6841, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:20:59,386 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3122.8863, eval_time 0.5912, test_loss 2.6841, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:20:59,474 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:20:59,480 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6809, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:20:59,481 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3122.9813, eval_time 0.686, test_loss 2.6809, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:20:59,483 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:59,515 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.025, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:20:59,516 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3123.0146, eval_time 0.7235, test_loss 3.025, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:20:59,551 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:20:59,572 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:59,581 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:20:59,602 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:00,914 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:00,928 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:01,148 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:01,158 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:02,195 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:02,205 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:02,290 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:02,299 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:02,342 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:02,356 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:03,189 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:03,209 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:03,887 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:03,907 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:04,539 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:04,551 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:04,564 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:04,578 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:04,943 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:04,956 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:05,102 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:05,111 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:05,265 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:05,289 INFO     [learner.py:606] ====Pushing takes 0.022131681442260742 s
2021-08-18:16:21:05,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:05,335 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:05,335 INFO     [param_server.py:410] Lock worker 1 with localStep 232 , while globalStep is 231

2021-08-18:16:21:07,536 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:07,546 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:07,745 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:07,760 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:08,500 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:08,521 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:08,757 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:08,766 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:09,885 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:09,897 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:10,62 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:10,71 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:10,464 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:10,495 INFO     [learner.py:606] ====Pushing takes 0.02981400489807129 s
2021-08-18:16:21:10,527 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:10,534 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:10,535 INFO     [param_server.py:410] Lock worker 3 with localStep 232 , while globalStep is 231

2021-08-18:16:21:11,300 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:11,328 INFO     [learner.py:606] ====Pushing takes 0.026129484176635742 s
2021-08-18:16:21:11,361 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:11,368 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:11,370 INFO     [param_server.py:381] ====After aggregation in epoch: 231, virtual_clock: 8239.114013986511, top_1: : 63.1817 % (1958.0), top_5: : 100.0 % (3099.0), test loss: 2.7966973781585693, test len: 3099.0
2021-08-18:16:21:11,372 INFO     [param_server.py:410] Lock worker 2 with localStep 232 , while globalStep is 232

2021-08-18:16:21:11,372 INFO     [param_server.py:441] ====Epoch 233 completes 20 clients with loss 103.49152697028805, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:11,373 INFO     [param_server.py:450] ====Start to sample for epoch 233, global virtualClock: 8239.114013986511, round_duration: 46.65186139097271
2021-08-18:16:21:11,374 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:11,734 INFO     [param_server.py:553] For epoch: 233, median_reward: 341.25670174157034, dev: 341.25670174157034
2021-08-18:16:21:12,286 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1575, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:21:12,287 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3135.7875, eval_time 0.5092, test_loss 3.1575, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:21:12,330 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.505, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:21:12,331 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3135.8312, eval_time 0.5528, test_loss 2.505, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:21:12,366 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:12,382 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:12,401 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:12,417 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:12,547 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6196, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:21:12,548 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3136.0465, eval_time 0.77, test_loss 2.6196, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:21:12,622 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:12,648 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:13,999 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:14,18 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:14,129 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:14,139 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:15,190 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:15,200 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:15,348 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:15,357 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:15,871 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:15,893 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:16,599 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:16,627 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:17,268 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:17,281 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:17,479 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:17,489 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:17,948 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:17,962 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:18,37 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:18,43 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:18,47 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:18,53 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:18,505 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:18,528 INFO     [learner.py:606] ====Pushing takes 0.02131342887878418 s
2021-08-18:16:21:18,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:18,574 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:18,575 INFO     [param_server.py:410] Lock worker 1 with localStep 233 , while globalStep is 232

2021-08-18:16:21:20,610 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:20,621 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:20,720 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:20,740 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:21,457 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:21,477 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:21,769 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:21,778 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:22,699 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:22,710 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:22,994 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:23,8 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:23,366 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:23,400 INFO     [learner.py:606] ====Pushing takes 0.029976844787597656 s
2021-08-18:16:21:23,438 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:23,448 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:23,449 INFO     [param_server.py:410] Lock worker 3 with localStep 233 , while globalStep is 232

2021-08-18:16:21:23,621 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:23,648 INFO     [learner.py:606] ====Pushing takes 0.025554180145263672 s
2021-08-18:16:21:23,685 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:23,692 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:23,693 INFO     [param_server.py:381] ====After aggregation in epoch: 232, virtual_clock: 8285.765875377483, top_1: : 64.182 % (1989.0), top_5: : 100.0 % (3099.0), test loss: 2.760670214615486, test len: 3099.0
2021-08-18:16:21:23,696 INFO     [param_server.py:410] Lock worker 2 with localStep 233 , while globalStep is 233

2021-08-18:16:21:23,697 INFO     [param_server.py:441] ====Epoch 234 completes 20 clients with loss 106.5831194234553, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:23,697 INFO     [param_server.py:450] ====Start to sample for epoch 234, global virtualClock: 8285.765875377483, round_duration: 46.65186139097271
2021-08-18:16:21:23,699 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:24,29 INFO     [param_server.py:553] For epoch: 234, median_reward: 309.4245680583789, dev: 309.4245680583789
2021-08-18:16:21:24,690 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6489, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:21:24,691 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3148.1918, eval_time 0.6154, test_loss 2.6489, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:21:24,696 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1548, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:21:24,697 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3148.1974, eval_time 0.624, test_loss 3.1548, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:21:24,754 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6516, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:21:24,755 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3148.2532, eval_time 0.6817, test_loss 2.6516, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:21:24,762 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:24,768 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:24,770 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:24,778 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:24,816 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:24,835 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:26,33 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:26,53 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:26,261 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:26,270 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:27,461 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:27,471 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:27,502 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:27,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:27,630 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:27,643 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:28,280 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:28,294 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:29,24 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:29,51 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:29,724 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:29,744 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:29,868 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:29,881 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:30,155 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:30,166 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:30,288 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:30,313 INFO     [learner.py:606] ====Pushing takes 0.023563861846923828 s
2021-08-18:16:21:30,347 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:30,355 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:30,355 INFO     [param_server.py:410] Lock worker 1 with localStep 234 , while globalStep is 233

2021-08-18:16:21:30,736 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:30,745 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:32,786 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:32,796 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:33,638 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:33,653 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:33,906 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:33,919 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:34,311 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:34,320 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:34,979 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:34,989 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:35,509 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:35,527 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:36,93 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:36,122 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:36,123 INFO     [learner.py:606] ====Pushing takes 0.028656721115112305 s
2021-08-18:16:21:36,165 INFO     [learner.py:606] ====Pushing takes 0.03919172286987305 s
2021-08-18:16:21:36,166 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:36,174 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:36,174 INFO     [param_server.py:410] Lock worker 3 with localStep 234 , while globalStep is 233

2021-08-18:16:21:36,198 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:36,211 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:36,212 INFO     [param_server.py:381] ====After aggregation in epoch: 233, virtual_clock: 8332.417736768455, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 2.8184313573012196, test len: 3099.0
2021-08-18:16:21:36,215 INFO     [param_server.py:410] Lock worker 2 with localStep 234 , while globalStep is 234

2021-08-18:16:21:36,215 INFO     [param_server.py:441] ====Epoch 235 completes 20 clients with loss 81.14984607380438, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:36,216 INFO     [param_server.py:450] ====Start to sample for epoch 235, global virtualClock: 8332.417736768455, round_duration: 46.65186139097271
2021-08-18:16:21:36,217 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:36,555 INFO     [param_server.py:553] For epoch: 235, median_reward: 317.69249049343387, dev: 317.69249049343387
2021-08-18:16:21:37,107 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1863, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:21:37,108 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3160.6086, eval_time 0.5301, test_loss 3.1863, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:21:37,113 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1509, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:21:37,114 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3160.6141, eval_time 0.536, test_loss 3.1509, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:21:37,145 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7282, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:21:37,148 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3160.6465, eval_time 0.5702, test_loss 2.7282, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:21:37,167 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:37,175 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:37,187 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:37,196 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:37,221 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:37,234 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:38,484 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:38,504 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:38,672 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:38,682 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:39,798 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:39,813 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:39,892 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:39,906 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:40,377 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:40,391 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:41,183 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:41,204 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:41,887 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:41,908 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:42,204 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:42,218 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:42,617 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:42,628 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:42,704 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:42,724 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:42,807 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:42,822 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:43,223 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:43,246 INFO     [learner.py:606] ====Pushing takes 0.022145986557006836 s
2021-08-18:16:21:43,281 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:43,290 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:43,291 INFO     [param_server.py:410] Lock worker 1 with localStep 235 , while globalStep is 234

2021-08-18:16:21:45,94 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:45,113 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:45,659 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:45,668 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:46,188 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:46,198 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:46,277 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:46,291 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:47,421 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:47,431 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:47,457 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:47,475 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:48,18 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:48,45 INFO     [learner.py:606] ====Pushing takes 0.0252535343170166 s
2021-08-18:16:21:48,84 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:48,94 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:48,95 INFO     [param_server.py:410] Lock worker 2 with localStep 235 , while globalStep is 234

2021-08-18:16:21:48,102 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:48,127 INFO     [learner.py:606] ====Pushing takes 0.024159908294677734 s
2021-08-18:16:21:48,168 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:48,176 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:48,177 INFO     [param_server.py:381] ====After aggregation in epoch: 234, virtual_clock: 8379.069598159427, top_1: : 64.4724 % (1998.0), top_5: : 100.0 % (3099.0), test loss: 3.0218132005797487, test len: 3099.0
2021-08-18:16:21:48,179 INFO     [param_server.py:410] Lock worker 3 with localStep 235 , while globalStep is 235

2021-08-18:16:21:48,180 INFO     [param_server.py:441] ====Epoch 236 completes 20 clients with loss 179.3910164590948, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:48,180 INFO     [param_server.py:450] ====Start to sample for epoch 236, global virtualClock: 8379.069598159427, round_duration: 46.65186139097271
2021-08-18:16:21:48,181 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:48,455 INFO     [param_server.py:553] For epoch: 236, median_reward: 324.54633801400354, dev: 324.54633801400354
2021-08-18:16:21:49,69 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6802, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:21:49,79 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6957, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:21:49,83 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3172.5833, eval_time 0.6013, test_loss 2.6802, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:21:49,83 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3172.5834, eval_time 0.6035, test_loss 2.6957, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:21:49,115 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0672, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:21:49,116 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3172.6147, eval_time 0.6366, test_loss 3.0672, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:21:49,154 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:21:49,154 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:21:49,161 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:49,162 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:49,194 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:21:49,208 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:50,540 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:50,560 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:50,737 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:50,746 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:51,764 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:51,774 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:51,908 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:51,918 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:52,86 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:52,107 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:52,883 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:52,904 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:53,670 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:53,697 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:54,198 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:54,208 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:54,560 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:54,569 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:54,583 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:54,587 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:54,832 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:54,847 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:55,226 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:55,251 INFO     [learner.py:606] ====Pushing takes 0.023201942443847656 s
2021-08-18:16:21:55,285 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:55,292 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:55,293 INFO     [param_server.py:410] Lock worker 1 with localStep 236 , while globalStep is 235

2021-08-18:16:21:57,249 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:57,263 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:57,734 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:57,743 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:58,374 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:58,383 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:58,389 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:58,399 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:59,566 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:59,587 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:59,619 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:59,633 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:00,186 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:00,215 INFO     [learner.py:606] ====Pushing takes 0.02749323844909668 s
2021-08-18:16:22:00,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:00,267 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:00,268 INFO     [param_server.py:410] Lock worker 3 with localStep 236 , while globalStep is 235

2021-08-18:16:22:00,946 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:00,974 INFO     [learner.py:606] ====Pushing takes 0.025898218154907227 s
2021-08-18:16:22:01,5 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:01,12 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:01,13 INFO     [param_server.py:381] ====After aggregation in epoch: 235, virtual_clock: 8425.7214595504, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 2.8143470728838884, test len: 3099.0
2021-08-18:16:22:01,17 INFO     [param_server.py:410] Lock worker 2 with localStep 236 , while globalStep is 236

2021-08-18:16:22:01,18 INFO     [param_server.py:441] ====Epoch 237 completes 20 clients with loss 325.96487527946033, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:01,18 INFO     [param_server.py:450] ====Start to sample for epoch 237, global virtualClock: 8425.7214595504, round_duration: 46.65186139097271
2021-08-18:16:22:01,20 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:01,366 INFO     [param_server.py:553] For epoch: 237, median_reward: 338.5081528570696, dev: 338.5081528570696
2021-08-18:16:22:02,44 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8273, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:22:02,45 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3185.5453, eval_time 0.6534, test_loss 2.8273, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:22:02,57 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5403, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:22:02,58 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3185.5581, eval_time 0.6661, test_loss 2.5403, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:22:02,91 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7777, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:22:02,92 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3185.591, eval_time 0.703, test_loss 2.7777, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:22:02,116 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:02,126 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:02,130 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:02,139 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:02,164 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:02,180 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:03,451 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:03,472 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:03,814 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:03,827 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:04,849 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:04,863 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:04,942 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:04,951 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:05,481 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:05,508 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:06,318 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:06,352 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:07,120 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:07,147 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:07,165 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:07,175 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:07,760 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:07,774 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:07,865 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:07,882 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:07,892 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:07,896 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:08,397 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:08,422 INFO     [learner.py:606] ====Pushing takes 0.022632122039794922 s
2021-08-18:16:22:08,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:08,468 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:08,468 INFO     [param_server.py:410] Lock worker 1 with localStep 237 , while globalStep is 236

2021-08-18:16:22:10,438 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:10,449 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:10,577 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:10,591 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:11,307 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:11,321 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:11,585 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:11,595 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:12,508 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:12,527 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:13,0 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:13,17 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:13,187 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:13,217 INFO     [learner.py:606] ====Pushing takes 0.02848076820373535 s
2021-08-18:16:22:13,255 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:13,263 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:13,264 INFO     [param_server.py:410] Lock worker 3 with localStep 237 , while globalStep is 236

2021-08-18:16:22:13,556 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:13,585 INFO     [learner.py:606] ====Pushing takes 0.027086734771728516 s
2021-08-18:16:22:13,617 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:13,625 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:13,625 INFO     [param_server.py:381] ====After aggregation in epoch: 236, virtual_clock: 8472.373320941371, top_1: : 64.6015 % (2002.0), top_5: : 100.0 % (3099.0), test loss: 2.7150927119784884, test len: 3099.0
2021-08-18:16:22:13,628 INFO     [param_server.py:410] Lock worker 2 with localStep 237 , while globalStep is 237

2021-08-18:16:22:13,628 INFO     [param_server.py:441] ====Epoch 238 completes 20 clients with loss 149.31700769475697, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:13,629 INFO     [param_server.py:450] ====Start to sample for epoch 238, global virtualClock: 8472.373320941371, round_duration: 46.65186139097271
2021-08-18:16:22:13,630 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:13,912 INFO     [param_server.py:553] For epoch: 238, median_reward: 335.16079726516153, dev: 335.16079726516153
2021-08-18:16:22:14,625 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7031, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:22:14,629 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3198.1271, eval_time 0.7051, test_loss 2.7031, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:22:14,630 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.822, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:22:14,631 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3198.1315, eval_time 0.7047, test_loss 2.822, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:22:14,634 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7219, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:22:14,635 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3198.1356, eval_time 0.7074, test_loss 2.7219, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:22:14,702 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:14,703 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:14,710 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:14,713 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:14,719 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:14,735 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:16,7 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:16,25 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:16,344 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:16,353 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:17,372 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:17,381 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:17,386 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:17,390 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:17,611 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:17,621 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:18,155 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:18,182 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:18,957 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:18,984 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:19,609 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:19,619 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:19,766 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:19,799 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:20,357 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:20,358 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:20,369 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:20,378 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:20,383 INFO     [learner.py:606] ====Pushing takes 0.023145437240600586 s
2021-08-18:16:22:20,399 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:20,418 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:20,425 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:20,426 INFO     [param_server.py:410] Lock worker 1 with localStep 238 , while globalStep is 237

2021-08-18:16:22:22,974 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:22,990 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:23,387 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:23,405 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:23,990 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:23,999 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:24,126 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:24,135 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:25,215 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:25,225 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:25,227 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:25,239 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:25,839 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:25,869 INFO     [learner.py:606] ====Pushing takes 0.028492450714111328 s
2021-08-18:16:22:25,909 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:25,920 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:25,921 INFO     [param_server.py:410] Lock worker 3 with localStep 238 , while globalStep is 237

2021-08-18:16:22:26,337 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:26,363 INFO     [learner.py:606] ====Pushing takes 0.024924039840698242 s
2021-08-18:16:22:26,394 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:26,402 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:26,403 INFO     [param_server.py:381] ====After aggregation in epoch: 237, virtual_clock: 8519.025182332343, top_1: : 64.8274 % (2009.0), top_5: : 100.0 % (3099.0), test loss: 2.7490138764734624, test len: 3099.0
2021-08-18:16:22:26,406 INFO     [param_server.py:410] Lock worker 2 with localStep 238 , while globalStep is 238

2021-08-18:16:22:26,406 INFO     [param_server.py:441] ====Epoch 239 completes 20 clients with loss 163.5663139486395, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:26,407 INFO     [param_server.py:450] ====Start to sample for epoch 239, global virtualClock: 8519.025182332343, round_duration: 46.65186139097271
2021-08-18:16:22:26,407 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:26,744 INFO     [param_server.py:553] For epoch: 239, median_reward: 334.46944211497197, dev: 334.46944211497197
2021-08-18:16:22:27,393 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7226, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:22:27,394 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.416, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:22:27,394 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3210.8944, eval_time 0.6375, test_loss 2.7226, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:22:27,394 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5559, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:22:27,395 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3210.8932, eval_time 0.6388, test_loss 3.416, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:22:27,395 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3210.8957, eval_time 0.6371, test_loss 2.5559, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:22:27,464 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:27,468 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:27,473 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:27,477 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:27,502 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:27,511 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:28,688 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:28,701 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:29,102 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:29,111 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:30,152 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:30,163 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:30,385 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:30,394 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:30,609 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:30,630 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:31,425 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:31,458 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:32,345 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:32,385 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:32,462 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:32,475 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:33,83 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:33,114 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:33,122 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:33,128 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:33,256 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:33,271 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:33,799 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:33,823 INFO     [learner.py:606] ====Pushing takes 0.022060155868530273 s
2021-08-18:16:22:33,857 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:33,864 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:33,865 INFO     [param_server.py:410] Lock worker 1 with localStep 239 , while globalStep is 238

2021-08-18:16:22:35,929 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:35,950 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:36,163 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:36,172 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:36,707 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:36,716 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:37,122 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:37,131 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:37,730 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:37,742 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:38,249 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:38,252 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:38,266 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:38,286 INFO     [learner.py:606] ====Pushing takes 0.029484272003173828 s
2021-08-18:16:22:38,327 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:38,335 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:38,336 INFO     [param_server.py:410] Lock worker 3 with localStep 239 , while globalStep is 238

2021-08-18:16:22:38,745 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:38,772 INFO     [learner.py:606] ====Pushing takes 0.025127649307250977 s
2021-08-18:16:22:38,806 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:38,814 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:38,815 INFO     [param_server.py:381] ====After aggregation in epoch: 238, virtual_clock: 8565.677043723315, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 2.8981501349696406, test len: 3099.0
2021-08-18:16:22:38,818 INFO     [param_server.py:410] Lock worker 2 with localStep 239 , while globalStep is 239

2021-08-18:16:22:38,818 INFO     [param_server.py:441] ====Epoch 240 completes 20 clients with loss 242.02645560018627, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:38,819 INFO     [param_server.py:450] ====Start to sample for epoch 240, global virtualClock: 8565.677043723315, round_duration: 46.65186139097271
2021-08-18:16:22:38,820 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:39,97 INFO     [param_server.py:553] For epoch: 240, median_reward: 325.1199038222132, dev: 325.1199038222132
2021-08-18:16:22:39,853 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9867, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:22:39,854 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3223.3541, eval_time 0.7413, test_loss 2.9867, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:22:39,855 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6994, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:22:39,855 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8159, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:22:39,855 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3223.3539, eval_time 0.7466, test_loss 2.6994, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:22:39,856 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3223.3561, eval_time 0.7434, test_loss 2.8159, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:22:39,921 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:39,922 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:39,928 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:39,929 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:39,931 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:39,936 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:41,283 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:41,351 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:41,629 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:41,638 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:42,657 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:42,667 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:42,823 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:42,843 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:42,886 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:42,896 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:43,684 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:43,704 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:44,614 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:44,653 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:45,25 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:45,43 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:45,443 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:45,483 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:45,564 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:45,578 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:45,848 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:45,868 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:46,88 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:46,115 INFO     [learner.py:606] ====Pushing takes 0.025552749633789062 s
2021-08-18:16:22:46,149 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:46,157 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:46,158 INFO     [param_server.py:410] Lock worker 1 with localStep 240 , while globalStep is 239

2021-08-18:16:22:48,105 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:48,120 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:48,872 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:48,886 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:49,395 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:49,408 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:49,582 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:49,603 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:50,638 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:50,647 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:50,669 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:50,678 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:51,332 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:51,363 INFO     [learner.py:606] ====Pushing takes 0.0301361083984375 s
2021-08-18:16:22:51,402 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:51,409 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:51,410 INFO     [param_server.py:410] Lock worker 3 with localStep 240 , while globalStep is 239

2021-08-18:16:22:51,854 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:51,882 INFO     [learner.py:606] ====Pushing takes 0.026358842849731445 s
2021-08-18:16:22:51,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:51,923 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:51,924 INFO     [param_server.py:381] ====After aggregation in epoch: 239, virtual_clock: 8612.328905114287, top_1: : 63.8593 % (1979.0), top_5: : 100.0 % (3099.0), test loss: 2.8340136607488, test len: 3099.0
2021-08-18:16:22:51,926 INFO     [param_server.py:410] Lock worker 2 with localStep 240 , while globalStep is 240

2021-08-18:16:22:51,927 INFO     [param_server.py:441] ====Epoch 241 completes 20 clients with loss 96.02078256213903, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:51,956 INFO     [param_server.py:450] ====Start to sample for epoch 241, global virtualClock: 8612.328905114287, round_duration: 46.65186139097271
2021-08-18:16:22:51,958 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:52,228 INFO     [param_server.py:541] Handle Wight 0.03742623329162598 | Send 0.27204108238220215
2021-08-18:16:22:52,229 INFO     [param_server.py:553] For epoch: 241, median_reward: 317.8101464779384, dev: 317.8101464779384
2021-08-18:16:22:52,817 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.61, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:22:52,819 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6098, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:22:52,823 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3236.3219, eval_time 0.5815, test_loss 2.61, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:22:52,823 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3236.3238, eval_time 0.5816, test_loss 2.6098, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:22:52,821 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4004, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:22:52,825 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3236.3255, eval_time 0.583, test_loss 2.4004, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:22:52,892 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:22:52,894 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:22:52,902 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:52,904 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:52,927 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:22:52,943 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:54,171 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:54,192 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:54,517 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:54,529 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:55,550 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:55,560 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:55,706 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:55,716 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:56,75 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:56,96 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:56,908 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:56,942 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:57,758 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:57,793 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:58,135 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:58,146 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:58,425 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:58,435 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:58,575 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:58,609 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:58,797 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:58,818 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:59,196 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:59,222 INFO     [learner.py:606] ====Pushing takes 0.023823976516723633 s
2021-08-18:16:22:59,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:59,268 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:59,269 INFO     [param_server.py:410] Lock worker 1 with localStep 241 , while globalStep is 240

2021-08-18:16:23:01,217 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:01,230 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:01,540 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:01,549 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:02,270 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:02,290 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:02,448 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:02,463 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:03,500 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:03,512 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:03,872 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:03,881 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:04,141 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:04,170 INFO     [learner.py:606] ====Pushing takes 0.027762413024902344 s
2021-08-18:16:23:04,209 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:04,219 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:04,219 INFO     [param_server.py:410] Lock worker 3 with localStep 241 , while globalStep is 240

2021-08-18:16:23:04,463 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:04,491 INFO     [learner.py:606] ====Pushing takes 0.026266813278198242 s
2021-08-18:16:23:04,523 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:04,531 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:04,531 INFO     [param_server.py:381] ====After aggregation in epoch: 240, virtual_clock: 8658.98076650526, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 2.5400397777557373, test len: 3099.0
2021-08-18:16:23:04,534 INFO     [param_server.py:410] Lock worker 2 with localStep 241 , while globalStep is 241

2021-08-18:16:23:04,535 INFO     [param_server.py:441] ====Epoch 242 completes 20 clients with loss 66.61609827969016, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:04,535 INFO     [param_server.py:450] ====Start to sample for epoch 242, global virtualClock: 8658.98076650526, round_duration: 46.65186139097271
2021-08-18:16:23:04,536 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:04,810 INFO     [param_server.py:553] For epoch: 242, median_reward: 318.5124624284018, dev: 318.5124624284018
2021-08-18:16:23:05,476 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6423, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:23:05,477 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3248.9778, eval_time 0.6557, test_loss 2.6423, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:23:05,483 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6903, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:23:05,485 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3248.9852, eval_time 0.6627, test_loss 2.6903, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:23:05,518 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8802, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:23:05,519 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3249.0178, eval_time 0.6978, test_loss 2.8802, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:23:05,547 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:05,555 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:05,586 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:05,591 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:05,594 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:05,613 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:07,50 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:07,70 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:07,271 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:07,280 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:08,311 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:08,327 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:08,590 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:08,600 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:08,603 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:08,621 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:09,413 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:09,440 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:10,190 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:10,217 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:10,713 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:10,725 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:10,946 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:10,973 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:11,117 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:11,127 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:11,531 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:11,551 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:11,678 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:11,703 INFO     [learner.py:606] ====Pushing takes 0.023067712783813477 s
2021-08-18:16:23:11,737 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:11,744 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:11,745 INFO     [param_server.py:410] Lock worker 1 with localStep 242 , while globalStep is 241

2021-08-18:16:23:13,882 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:13,893 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:14,564 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:14,574 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:15,40 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:15,50 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:15,362 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:15,383 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:16,384 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:16,393 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:16,543 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:16,554 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:17,55 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:17,86 INFO     [learner.py:606] ====Pushing takes 0.029911041259765625 s
2021-08-18:16:23:17,132 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:17,140 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:17,141 INFO     [param_server.py:410] Lock worker 3 with localStep 242 , while globalStep is 241

2021-08-18:16:23:17,614 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:17,641 INFO     [learner.py:606] ====Pushing takes 0.025943994522094727 s
2021-08-18:16:23:17,672 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:17,680 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:17,680 INFO     [param_server.py:381] ====After aggregation in epoch: 241, virtual_clock: 8705.632627896231, top_1: : 64.5369 % (2000.0), top_5: : 100.0 % (3099.0), test loss: 2.73757584117077, test len: 3099.0
2021-08-18:16:23:17,683 INFO     [param_server.py:410] Lock worker 2 with localStep 242 , while globalStep is 242

2021-08-18:16:23:17,683 INFO     [param_server.py:441] ====Epoch 243 completes 20 clients with loss 165.655218792455, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:17,684 INFO     [param_server.py:450] ====Start to sample for epoch 243, global virtualClock: 8705.632627896231, round_duration: 46.65186139097271
2021-08-18:16:23:17,685 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:17,985 INFO     [param_server.py:553] For epoch: 243, median_reward: 329.68692147217087, dev: 329.68692147217087
2021-08-18:16:23:18,641 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6852, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:23:18,641 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3262.1418, eval_time 0.6343, test_loss 2.6852, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:23:18,676 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4875, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:23:18,677 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3262.1771, eval_time 0.6695, test_loss 2.4875, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:23:18,704 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3747, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:23:18,705 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3262.204, eval_time 0.6983, test_loss 3.3747, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:23:18,712 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:18,720 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:18,767 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:18,775 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:18,793 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:18,809 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:20,237 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:20,258 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:20,317 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:20,328 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:21,507 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:21,516 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:21,537 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:21,547 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:22,119 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:22,147 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:22,851 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:22,878 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:23,706 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:23,714 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:23,725 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:23,741 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:24,77 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:24,90 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:24,620 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:24,654 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:24,672 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:24,692 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:25,245 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:25,269 INFO     [learner.py:606] ====Pushing takes 0.02239990234375 s
2021-08-18:16:23:25,302 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:25,312 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:25,312 INFO     [param_server.py:410] Lock worker 1 with localStep 243 , while globalStep is 242

2021-08-18:16:23:26,866 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:26,877 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:27,386 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:27,396 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:28,16 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:28,25 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:28,106 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:28,127 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:29,322 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:29,334 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:29,378 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:29,387 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:29,916 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:29,929 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:29,945 INFO     [learner.py:606] ====Pushing takes 0.027894973754882812 s
2021-08-18:16:23:29,967 INFO     [learner.py:606] ====Pushing takes 0.036522626876831055 s
2021-08-18:16:23:29,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:30,4 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:30,5 INFO     [param_server.py:410] Lock worker 3 with localStep 243 , while globalStep is 242

2021-08-18:16:23:30,34 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:30,42 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:30,43 INFO     [param_server.py:381] ====After aggregation in epoch: 242, virtual_clock: 8752.284489287204, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 2.849130853458687, test len: 3099.0
2021-08-18:16:23:30,45 INFO     [param_server.py:410] Lock worker 2 with localStep 243 , while globalStep is 243

2021-08-18:16:23:30,45 INFO     [param_server.py:441] ====Epoch 244 completes 20 clients with loss 291.9862395323794, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:30,46 INFO     [param_server.py:450] ====Start to sample for epoch 244, global virtualClock: 8752.284489287204, round_duration: 46.65186139097271
2021-08-18:16:23:30,47 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:30,318 INFO     [param_server.py:553] For epoch: 244, median_reward: 353.73620514023776, dev: 353.73620514023776
2021-08-18:16:23:31,28 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0061, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:23:31,29 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3274.5296, eval_time 0.688, test_loss 4.0061, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:23:31,29 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6647, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:23:31,30 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3274.5306, eval_time 0.6889, test_loss 2.6647, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:23:31,65 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8945, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:23:31,65 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3274.5641, eval_time 0.7243, test_loss 2.8945, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:23:31,99 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:31,108 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:31,122 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:31,131 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:31,140 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:31,153 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:32,537 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:32,550 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:32,551 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:32,560 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:33,719 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:33,728 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:33,977 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:33,987 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:34,42 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:34,62 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:34,880 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:34,900 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:35,597 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:35,624 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:36,371 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:36,389 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:36,415 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:36,415 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:36,427 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:36,442 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:36,953 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:36,978 INFO     [learner.py:606] ====Pushing takes 0.023840665817260742 s
2021-08-18:16:23:37,13 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:37,20 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:37,20 INFO     [param_server.py:410] Lock worker 1 with localStep 244 , while globalStep is 243

2021-08-18:16:23:37,66 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:37,80 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:38,951 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:38,961 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:39,673 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:39,684 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:40,70 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:40,81 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:40,329 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:40,340 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:41,165 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:41,177 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:41,740 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:41,754 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:42,389 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:42,406 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:42,421 INFO     [learner.py:606] ====Pushing takes 0.02926492691040039 s
2021-08-18:16:23:42,447 INFO     [learner.py:606] ====Pushing takes 0.03939104080200195 s
2021-08-18:16:23:42,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:42,478 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:42,478 INFO     [param_server.py:410] Lock worker 3 with localStep 244 , while globalStep is 243

2021-08-18:16:23:42,504 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:42,512 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:42,513 INFO     [param_server.py:381] ====After aggregation in epoch: 243, virtual_clock: 8798.936350678176, top_1: : 64.3433 % (1994.0), top_5: : 100.0 % (3099.0), test loss: 3.1884373382285793, test len: 3099.0
2021-08-18:16:23:42,515 INFO     [param_server.py:410] Lock worker 2 with localStep 244 , while globalStep is 244

2021-08-18:16:23:42,516 INFO     [param_server.py:441] ====Epoch 245 completes 20 clients with loss 117.32613659677301, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:42,516 INFO     [param_server.py:450] ====Start to sample for epoch 245, global virtualClock: 8798.936350678176, round_duration: 46.65186139097271
2021-08-18:16:23:42,517 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:42,794 INFO     [param_server.py:553] For epoch: 245, median_reward: 349.8283217671151, dev: 349.8283217671151
2021-08-18:16:23:43,499 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2424, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:23:43,502 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3287.0011, eval_time 0.6852, test_loss 3.2424, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:23:43,505 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2674, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:23:43,507 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3287.0079, eval_time 0.6879, test_loss 3.2674, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:23:43,514 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7195, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:23:43,517 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3287.0175, eval_time 0.6974, test_loss 2.7195, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:23:43,572 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:23:43,581 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:43,583 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:23:43,589 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:23:43,590 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:43,596 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:44,777 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:44,786 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:45,196 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:45,206 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:46,267 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:46,276 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:46,314 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:46,324 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:46,802 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:46,823 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:47,557 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:47,584 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:48,334 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:48,361 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:48,629 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:48,644 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:48,800 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:48,819 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:49,113 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:49,133 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:49,349 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:49,359 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:49,696 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:49,721 INFO     [learner.py:606] ====Pushing takes 0.0226287841796875 s
2021-08-18:16:23:49,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:49,764 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:49,765 INFO     [param_server.py:410] Lock worker 1 with localStep 245 , while globalStep is 244

2021-08-18:16:23:51,563 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:51,573 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:52,62 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:52,72 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:52,569 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:52,579 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:52,634 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:52,644 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:53,808 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:53,829 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:53,837 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:53,848 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:54,394 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:54,421 INFO     [learner.py:606] ====Pushing takes 0.02605438232421875 s
2021-08-18:16:23:54,436 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:54,459 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:54,467 INFO     [learner.py:606] ====Pushing takes 0.029391765594482422 s
2021-08-18:16:23:54,468 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:54,488 INFO     [param_server.py:410] Lock worker 2 with localStep 245 , while globalStep is 244

2021-08-18:16:23:54,513 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:54,520 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:54,521 INFO     [param_server.py:381] ====After aggregation in epoch: 244, virtual_clock: 8845.588212069148, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 3.0764484891185053, test len: 3099.0
2021-08-18:16:23:54,523 INFO     [param_server.py:410] Lock worker 3 with localStep 245 , while globalStep is 245

2021-08-18:16:23:54,524 INFO     [param_server.py:441] ====Epoch 246 completes 20 clients with loss 106.67880265682578, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:54,524 INFO     [param_server.py:450] ====Start to sample for epoch 246, global virtualClock: 8845.588212069148, round_duration: 46.65186139097271
2021-08-18:16:23:54,525 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:54,808 INFO     [param_server.py:553] For epoch: 246, median_reward: 312.41839737314723, dev: 312.41839737314723
2021-08-18:16:23:55,470 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5518, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:23:55,472 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3298.972, eval_time 0.6378, test_loss 3.5518, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:23:55,475 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1332, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:23:55,476 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3298.9744, eval_time 0.6449, test_loss 3.1332, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:23:55,477 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8883, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:23:55,478 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3298.9785, eval_time 0.6448, test_loss 2.8883, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:23:55,549 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:23:55,549 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:23:55,558 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:55,558 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:55,565 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:23:55,573 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:56,597 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:56,606 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:57,76 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:57,85 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:58,60 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:58,81 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:58,97 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:58,107 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:58,451 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:58,460 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:58,918 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:58,939 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:59,746 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:59,766 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:00,545 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:00,572 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:00,643 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:00,661 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:01,137 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:01,146 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:01,180 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:01,204 INFO     [learner.py:606] ====Pushing takes 0.02298569679260254 s
2021-08-18:16:24:01,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:01,248 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:01,249 INFO     [param_server.py:410] Lock worker 1 with localStep 246 , while globalStep is 245

2021-08-18:16:24:01,344 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:01,354 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:03,841 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:03,865 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:04,51 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:04,62 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:04,595 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:04,605 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:04,933 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:04,942 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:05,578 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:05,592 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:06,257 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:06,257 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:06,266 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:06,286 INFO     [learner.py:606] ====Pushing takes 0.02739119529724121 s
2021-08-18:16:24:06,334 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:06,341 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:06,342 INFO     [param_server.py:410] Lock worker 3 with localStep 246 , while globalStep is 245

2021-08-18:16:24:07,261 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:07,288 INFO     [learner.py:606] ====Pushing takes 0.025348901748657227 s
2021-08-18:16:24:07,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:07,329 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:07,330 INFO     [param_server.py:381] ====After aggregation in epoch: 245, virtual_clock: 8892.24007346012, top_1: : 64.3433 % (1994.0), top_5: : 100.0 % (3099.0), test loss: 3.191110540319372, test len: 3099.0
2021-08-18:16:24:07,333 INFO     [param_server.py:410] Lock worker 2 with localStep 246 , while globalStep is 246

2021-08-18:16:24:07,333 INFO     [param_server.py:441] ====Epoch 247 completes 20 clients with loss 345.57215489589504, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:07,334 INFO     [param_server.py:450] ====Start to sample for epoch 247, global virtualClock: 8892.24007346012, round_duration: 46.65186139097271
2021-08-18:16:24:07,335 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:07,702 INFO     [param_server.py:553] For epoch: 247, median_reward: 355.36472452200786, dev: 355.36472452200786
2021-08-18:16:24:08,318 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7546, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:24:08,319 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3311.8197, eval_time 0.5928, test_loss 2.7546, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:24:08,367 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4794, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:24:08,368 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3311.8683, eval_time 0.6408, test_loss 2.4794, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:24:08,366 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0376, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:24:08,370 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3311.8686, eval_time 0.6442, test_loss 3.0376, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:24:08,385 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:08,400 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:08,441 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:08,447 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:08,458 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:08,459 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:09,658 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:09,667 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:10,131 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:10,142 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:11,156 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:11,165 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:11,312 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:11,322 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:11,407 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:11,427 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:12,224 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:12,244 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:13,119 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:13,147 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:13,745 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:13,755 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:13,812 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:13,839 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:13,972 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:13,983 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:14,391 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:14,401 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:14,548 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:14,573 INFO     [learner.py:606] ====Pushing takes 0.023303508758544922 s
2021-08-18:16:24:14,611 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:14,620 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:14,620 INFO     [param_server.py:410] Lock worker 1 with localStep 247 , while globalStep is 246

2021-08-18:16:24:16,669 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:16,678 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:17,205 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:17,219 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:17,857 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:17,871 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:17,887 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:17,897 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:19,52 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:19,62 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:19,214 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:19,238 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:19,754 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:19,783 INFO     [learner.py:606] ====Pushing takes 0.0268857479095459 s
2021-08-18:16:24:19,822 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:19,830 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:19,831 INFO     [param_server.py:410] Lock worker 3 with localStep 247 , while globalStep is 246

2021-08-18:16:24:19,839 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:19,867 INFO     [learner.py:606] ====Pushing takes 0.026387691497802734 s
2021-08-18:16:24:19,899 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:19,906 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:19,907 INFO     [param_server.py:381] ====After aggregation in epoch: 246, virtual_clock: 8938.891934851092, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 2.757208353943295, test len: 3099.0
2021-08-18:16:24:19,909 INFO     [param_server.py:410] Lock worker 2 with localStep 247 , while globalStep is 247

2021-08-18:16:24:19,909 INFO     [param_server.py:441] ====Epoch 248 completes 20 clients with loss 373.33640308588684, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:19,910 INFO     [param_server.py:450] ====Start to sample for epoch 248, global virtualClock: 8938.891934851092, round_duration: 46.65186139097271
2021-08-18:16:24:19,911 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:20,253 INFO     [param_server.py:553] For epoch: 248, median_reward: 369.4317745351065, dev: 369.4317745351065
2021-08-18:16:24:20,910 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8576, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:24:20,911 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3324.4113, eval_time 0.6355, test_loss 2.8576, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:24:20,919 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7152, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:24:20,920 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3324.4203, eval_time 0.6444, test_loss 2.7152, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:24:20,952 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7407, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:24:20,953 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3324.4517, eval_time 0.6776, test_loss 2.7407, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:24:20,979 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:20,990 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:20,993 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:21,7 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:21,23 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:21,37 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:22,226 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:22,240 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:22,606 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:22,617 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:23,639 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:23,668 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:23,704 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:23,723 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:23,826 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:23,841 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:24,456 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:24,477 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:25,302 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:25,323 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:26,3 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:26,29 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:26,154 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:26,165 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:26,342 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:26,355 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:26,712 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:26,736 INFO     [learner.py:606] ====Pushing takes 0.022835969924926758 s
2021-08-18:16:24:26,776 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:26,784 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:26,784 INFO     [param_server.py:410] Lock worker 1 with localStep 248 , while globalStep is 247

2021-08-18:16:24:26,869 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:26,879 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:28,983 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:28,997 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:29,863 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:29,872 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:30,193 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:30,203 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:30,548 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:30,562 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:31,476 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:31,486 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:31,746 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:31,757 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:32,421 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:32,450 INFO     [learner.py:606] ====Pushing takes 0.027385234832763672 s
2021-08-18:16:24:32,489 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:32,498 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:32,498 INFO     [param_server.py:410] Lock worker 3 with localStep 248 , while globalStep is 247

2021-08-18:16:24:32,834 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:32,862 INFO     [learner.py:606] ====Pushing takes 0.025820016860961914 s
2021-08-18:16:24:32,893 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:32,904 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:32,904 INFO     [param_server.py:381] ====After aggregation in epoch: 247, virtual_clock: 8985.543796242064, top_1: : 63.6657 % (1973.0), top_5: : 100.0 % (3099.0), test loss: 2.771189519652614, test len: 3099.0
2021-08-18:16:24:32,907 INFO     [param_server.py:410] Lock worker 2 with localStep 248 , while globalStep is 248

2021-08-18:16:24:32,908 INFO     [param_server.py:441] ====Epoch 249 completes 20 clients with loss 123.4897699113077, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:32,908 INFO     [param_server.py:450] ====Start to sample for epoch 249, global virtualClock: 8985.543796242064, round_duration: 46.65186139097271
2021-08-18:16:24:32,909 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:33,253 INFO     [param_server.py:553] For epoch: 249, median_reward: 340.5062815064087, dev: 340.5062815064087
2021-08-18:16:24:33,879 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6521, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:24:33,880 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3337.3804, eval_time 0.587, test_loss 3.6521, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:24:33,891 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.648, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:24:33,892 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3337.392, eval_time 0.5979, test_loss 2.648, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:24:33,960 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:33,966 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:33,969 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:33,970 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.856, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:24:33,970 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3337.4691, eval_time 0.6784, test_loss 2.856, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:24:33,974 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:34,43 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:34,60 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:35,361 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:35,382 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:35,500 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:35,514 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:36,623 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:36,633 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:36,762 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:36,777 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:37,299 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:37,327 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:38,202 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:38,228 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:39,19 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:39,56 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:39,174 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:39,186 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:39,394 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:39,406 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:39,911 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:39,937 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:39,938 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:39,951 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:40,583 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:40,608 INFO     [learner.py:606] ====Pushing takes 0.024327993392944336 s
2021-08-18:16:24:40,645 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:40,652 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:40,653 INFO     [param_server.py:410] Lock worker 1 with localStep 249 , while globalStep is 248

2021-08-18:16:24:42,37 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:42,49 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:42,671 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:42,680 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:43,288 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:43,299 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:43,521 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:43,535 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:44,535 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:44,546 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:44,574 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:44,584 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:45,133 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:45,148 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:45,161 INFO     [learner.py:606] ====Pushing takes 0.026885032653808594 s
2021-08-18:16:24:45,197 INFO     [learner.py:606] ====Pushing takes 0.0477452278137207 s
2021-08-18:16:24:45,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:45,221 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:45,222 INFO     [param_server.py:410] Lock worker 2 with localStep 249 , while globalStep is 248

2021-08-18:16:24:45,247 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:45,255 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:45,255 INFO     [param_server.py:381] ====After aggregation in epoch: 248, virtual_clock: 9032.195657633036, top_1: : 65.9568 % (2044.0), top_5: : 100.0 % (3099.0), test loss: 3.05207848990405, test len: 3099.0
2021-08-18:16:24:45,258 INFO     [param_server.py:410] Lock worker 3 with localStep 249 , while globalStep is 249

2021-08-18:16:24:45,258 INFO     [param_server.py:441] ====Epoch 250 completes 20 clients with loss 209.54254041910258, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:45,259 INFO     [param_server.py:450] ====Start to sample for epoch 250, global virtualClock: 9032.195657633036, round_duration: 46.65186139097271
2021-08-18:16:24:45,260 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:45,594 INFO     [param_server.py:553] For epoch: 250, median_reward: 352.57156887508404, dev: 352.57156887508404
2021-08-18:16:24:46,239 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9642, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:24:46,240 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3349.7404, eval_time 0.6104, test_loss 2.9642, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:24:46,244 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6585, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:24:46,245 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3349.7451, eval_time 0.6151, test_loss 2.6585, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:24:46,313 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:24:46,322 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9187, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:24:46,322 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:46,323 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3349.8214, eval_time 0.6943, test_loss 2.9187, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:24:46,330 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:24:46,338 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:46,393 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:24:46,416 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:47,722 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:47,749 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:48,6 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:48,16 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:49,292 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:49,300 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:49,301 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:49,313 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:49,463 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:49,490 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:50,364 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:50,385 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:51,98 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:51,125 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:51,735 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:51,746 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:51,838 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:51,858 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:51,869 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:51,878 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:52,411 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:52,422 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:52,564 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:52,588 INFO     [learner.py:606] ====Pushing takes 0.022797346115112305 s
2021-08-18:16:24:52,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:52,634 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:52,635 INFO     [param_server.py:410] Lock worker 1 with localStep 250 , while globalStep is 249

2021-08-18:16:24:54,627 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:54,639 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:55,354 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:55,363 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:55,689 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:55,698 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:56,208 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:56,217 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:56,801 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:56,811 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:57,267 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:57,281 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:57,812 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:57,828 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:57,840 INFO     [learner.py:606] ====Pushing takes 0.026505231857299805 s
2021-08-18:16:24:57,871 INFO     [learner.py:606] ====Pushing takes 0.03893327713012695 s
2021-08-18:16:24:57,879 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:57,887 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:57,887 INFO     [param_server.py:410] Lock worker 2 with localStep 250 , while globalStep is 249

2021-08-18:16:24:57,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:57,922 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:57,923 INFO     [param_server.py:381] ====After aggregation in epoch: 249, virtual_clock: 9078.847519024008, top_1: : 62.2136 % (1928.0), top_5: : 100.0 % (3099.0), test loss: 2.8471374864931462, test len: 3099.0
2021-08-18:16:24:57,925 INFO     [param_server.py:410] Lock worker 3 with localStep 250 , while globalStep is 250

2021-08-18:16:24:57,925 INFO     [param_server.py:441] ====Epoch 251 completes 20 clients with loss 230.57901620356827, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:57,926 INFO     [param_server.py:450] ====Start to sample for epoch 251, global virtualClock: 9078.847519024008, round_duration: 46.65186139097271
2021-08-18:16:24:57,927 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:58,271 INFO     [param_server.py:553] For epoch: 251, median_reward: 325.0491237386696, dev: 325.0491237386696
2021-08-18:16:24:58,854 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7694, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:24:58,855 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3362.3551, eval_time 0.5398, test_loss 2.7694, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:24:58,871 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4367, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:24:58,872 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3362.3727, eval_time 0.555, test_loss 2.4367, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:24:58,932 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:24:58,939 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:58,944 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:24:58,953 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:58,988 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0778, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:24:58,991 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3362.4898, eval_time 0.6763, test_loss 3.0778, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:24:59,62 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:24:59,86 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:00,460 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:00,487 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:00,561 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:00,573 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:01,743 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:01,763 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:01,828 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:01,841 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:02,417 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:02,437 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:03,121 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:03,141 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:03,822 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:03,842 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:04,51 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:04,61 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:04,499 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:04,520 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:04,547 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:04,557 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:04,756 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:04,765 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:05,168 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:05,192 INFO     [learner.py:606] ====Pushing takes 0.022939682006835938 s
2021-08-18:16:25:05,232 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:05,240 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:05,241 INFO     [param_server.py:410] Lock worker 1 with localStep 251 , while globalStep is 250

2021-08-18:16:25:07,361 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:07,371 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:07,460 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:07,470 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:08,200 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:08,214 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:08,656 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:08,665 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:09,376 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:09,387 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:10,2 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:10,10 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:10,11 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:10,40 INFO     [learner.py:606] ====Pushing takes 0.02809286117553711 s
2021-08-18:16:25:10,78 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:10,88 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:10,89 INFO     [param_server.py:410] Lock worker 3 with localStep 251 , while globalStep is 250

2021-08-18:16:25:10,554 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:10,581 INFO     [learner.py:606] ====Pushing takes 0.026140928268432617 s
2021-08-18:16:25:10,625 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:10,632 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:10,633 INFO     [param_server.py:381] ====After aggregation in epoch: 250, virtual_clock: 9125.49938041498, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 2.7613328849827803, test len: 3099.0
2021-08-18:16:25:10,635 INFO     [param_server.py:410] Lock worker 2 with localStep 251 , while globalStep is 251

2021-08-18:16:25:10,636 INFO     [param_server.py:441] ====Epoch 252 completes 20 clients with loss 308.9661085848426, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:10,636 INFO     [param_server.py:450] ====Start to sample for epoch 252, global virtualClock: 9125.49938041498, round_duration: 46.65186139097271
2021-08-18:16:25:10,637 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:10,965 INFO     [param_server.py:553] For epoch: 252, median_reward: 334.9656683774778, dev: 334.9656683774778
2021-08-18:16:25:11,538 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.815, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:25:11,539 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.768, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:25:11,540 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3375.0403, eval_time 0.5304, test_loss 2.768, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:25:11,540 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3375.0402, eval_time 0.5292, test_loss 2.815, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:25:11,611 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:11,612 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:11,619 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:11,627 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:11,653 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8119, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:25:11,654 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3375.153, eval_time 0.6449, test_loss 2.8119, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:25:11,729 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:11,754 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:13,116 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:13,143 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:13,267 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:13,281 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:14,299 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:14,311 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:14,475 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:14,487 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:14,667 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:14,688 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:15,353 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:15,367 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:16,45 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:16,63 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:16,610 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:16,621 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:16,628 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:16,648 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:17,38 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:17,49 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:17,142 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:17,167 INFO     [learner.py:606] ====Pushing takes 0.023108482360839844 s
2021-08-18:16:25:17,167 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:17,177 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:17,203 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:17,211 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:17,212 INFO     [param_server.py:410] Lock worker 1 with localStep 252 , while globalStep is 251

2021-08-18:16:25:19,606 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:19,625 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:19,764 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:19,776 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:20,442 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:20,451 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:20,907 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:20,917 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:21,548 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:21,557 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:22,69 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:22,100 INFO     [learner.py:606] ====Pushing takes 0.028993844985961914 s
2021-08-18:16:25:22,120 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:22,134 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:22,140 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:22,148 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:22,149 INFO     [param_server.py:410] Lock worker 3 with localStep 252 , while globalStep is 251

2021-08-18:16:25:23,328 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:23,355 INFO     [learner.py:606] ====Pushing takes 0.024773120880126953 s
2021-08-18:16:25:23,385 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:23,395 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:23,396 INFO     [param_server.py:381] ====After aggregation in epoch: 251, virtual_clock: 9172.151241805952, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.798283649815454, test len: 3099.0
2021-08-18:16:25:23,399 INFO     [param_server.py:410] Lock worker 2 with localStep 252 , while globalStep is 252

2021-08-18:16:25:23,400 INFO     [param_server.py:441] ====Epoch 253 completes 20 clients with loss 113.63430896690255, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:23,400 INFO     [param_server.py:450] ====Start to sample for epoch 253, global virtualClock: 9172.151241805952, round_duration: 46.65186139097271
2021-08-18:16:25:23,401 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:23,738 INFO     [param_server.py:553] For epoch: 253, median_reward: 340.3168397703786, dev: 340.3168397703786
2021-08-18:16:25:24,471 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5105, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:25:24,472 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3387.9728, eval_time 0.7017, test_loss 3.5105, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:25:24,522 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.585, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:25:24,523 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3388.0235, eval_time 0.7504, test_loss 2.585, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:25:24,543 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:24,551 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:24,556 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1042, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:25:24,559 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3388.0577, eval_time 0.7884, test_loss 3.1042, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:25:24,594 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:24,610 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:24,629 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:24,649 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:25,853 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:25,867 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:26,24 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:26,34 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:27,215 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:27,219 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:27,224 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:27,233 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:27,735 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:27,757 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:28,615 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:28,643 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:29,472 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:29,493 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:29,562 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:29,572 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:29,710 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:29,723 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:30,114 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:30,135 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:30,184 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:30,193 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:30,706 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:30,728 INFO     [learner.py:606] ====Pushing takes 0.020817041397094727 s
2021-08-18:16:25:30,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:30,773 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:30,774 INFO     [param_server.py:410] Lock worker 1 with localStep 253 , while globalStep is 252

2021-08-18:16:25:32,404 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:32,414 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:32,741 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:32,750 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:33,365 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:33,384 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:33,590 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:33,604 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:34,453 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:34,465 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:35,21 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:35,50 INFO     [learner.py:606] ====Pushing takes 0.027791738510131836 s
2021-08-18:16:25:35,53 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:35,63 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:35,88 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:35,96 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:35,97 INFO     [param_server.py:410] Lock worker 3 with localStep 253 , while globalStep is 252

2021-08-18:16:25:35,702 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:35,728 INFO     [learner.py:606] ====Pushing takes 0.0241091251373291 s
2021-08-18:16:25:35,759 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:35,766 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:35,767 INFO     [param_server.py:381] ====After aggregation in epoch: 252, virtual_clock: 9218.803103196924, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 3.0665554647092463, test len: 3099.0
2021-08-18:16:25:35,770 INFO     [param_server.py:410] Lock worker 2 with localStep 253 , while globalStep is 253

2021-08-18:16:25:35,770 INFO     [param_server.py:441] ====Epoch 254 completes 20 clients with loss 242.24564978694292, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:35,771 INFO     [param_server.py:450] ====Start to sample for epoch 254, global virtualClock: 9218.803103196924, round_duration: 46.65186139097271
2021-08-18:16:25:35,771 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:36,108 INFO     [param_server.py:553] For epoch: 254, median_reward: 355.330228433663, dev: 355.330228433663
2021-08-18:16:25:36,767 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8417, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:25:36,768 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3400.2689, eval_time 0.6347, test_loss 2.8417, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:25:36,773 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.739, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:25:36,774 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3400.2745, eval_time 0.6424, test_loss 2.739, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:25:36,778 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8498, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:25:36,779 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3400.2776, eval_time 0.6477, test_loss 2.8498, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:25:36,839 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:36,840 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:36,848 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:36,849 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:36,855 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:36,862 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:38,255 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:38,269 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:38,410 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:38,423 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:39,459 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:39,470 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:39,539 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:39,549 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:39,753 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:39,774 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:40,614 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:40,634 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:41,301 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:41,328 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:41,781 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:41,793 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:42,61 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:42,88 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:42,97 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:42,109 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:42,468 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:42,478 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:42,743 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:42,768 INFO     [learner.py:606] ====Pushing takes 0.022848129272460938 s
2021-08-18:16:25:42,807 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:42,815 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:42,816 INFO     [param_server.py:410] Lock worker 1 with localStep 254 , while globalStep is 253

2021-08-18:16:25:44,920 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:44,940 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:45,210 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:45,220 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:45,896 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:45,907 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:46,211 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:46,222 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:47,219 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:47,237 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:47,473 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:47,482 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:47,891 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:47,925 INFO     [learner.py:606] ====Pushing takes 0.027774810791015625 s
2021-08-18:16:25:47,964 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:47,977 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:47,977 INFO     [param_server.py:410] Lock worker 3 with localStep 254 , while globalStep is 253

2021-08-18:16:25:48,709 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:48,736 INFO     [learner.py:606] ====Pushing takes 0.02519679069519043 s
2021-08-18:16:25:48,768 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:48,776 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:48,777 INFO     [param_server.py:381] ====After aggregation in epoch: 253, virtual_clock: 9265.454964587896, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 2.810149104506882, test len: 3099.0
2021-08-18:16:25:48,779 INFO     [param_server.py:410] Lock worker 2 with localStep 254 , while globalStep is 254

2021-08-18:16:25:48,780 INFO     [param_server.py:441] ====Epoch 255 completes 20 clients with loss 164.79081119172994, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:48,780 INFO     [param_server.py:450] ====Start to sample for epoch 255, global virtualClock: 9265.454964587896, round_duration: 46.65186139097271
2021-08-18:16:25:48,781 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:49,119 INFO     [param_server.py:553] For epoch: 255, median_reward: 360.21937815700124, dev: 360.21937815700124
2021-08-18:16:25:49,789 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8845, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:25:49,790 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3413.2902, eval_time 0.6528, test_loss 2.8845, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:25:49,790 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0116, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:25:49,791 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3413.2892, eval_time 0.6548, test_loss 3.0116, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:25:49,798 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6779, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:25:49,799 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3413.2994, eval_time 0.6614, test_loss 2.6779, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:25:49,876 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:25:49,876 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:25:49,884 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:49,885 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:49,888 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:25:49,898 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:51,77 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:51,91 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:51,479 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:51,488 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:52,550 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:52,572 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:52,739 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:52,748 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:52,956 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:52,990 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:53,939 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:53,973 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:54,832 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:54,863 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:54,866 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:54,877 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:55,544 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:55,562 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:55,578 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:55,587 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:55,599 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:55,632 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:56,216 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:56,241 INFO     [learner.py:606] ====Pushing takes 0.022793292999267578 s
2021-08-18:16:25:56,277 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:56,285 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:56,302 INFO     [param_server.py:410] Lock worker 1 with localStep 255 , while globalStep is 254

2021-08-18:16:25:58,259 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:58,273 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:58,290 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:58,299 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:59,45 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:59,66 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:59,470 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:59,479 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:00,256 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:00,268 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:00,649 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:00,659 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:00,822 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:00,856 INFO     [learner.py:606] ====Pushing takes 0.03244423866271973 s
2021-08-18:16:26:00,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:00,903 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:00,904 INFO     [param_server.py:410] Lock worker 3 with localStep 255 , while globalStep is 254

2021-08-18:16:26:01,194 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:01,232 INFO     [learner.py:606] ====Pushing takes 0.03641343116760254 s
2021-08-18:16:26:01,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:01,278 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:01,278 INFO     [param_server.py:381] ====After aggregation in epoch: 254, virtual_clock: 9312.106825978868, top_1: : 64.6338 % (2003.0), top_5: : 100.0 % (3099.0), test loss: 2.8579828783317844, test len: 3099.0
2021-08-18:16:26:01,281 INFO     [param_server.py:410] Lock worker 2 with localStep 255 , while globalStep is 255

2021-08-18:16:26:01,281 INFO     [param_server.py:441] ====Epoch 256 completes 20 clients with loss 170.11517057192273, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:01,282 INFO     [param_server.py:450] ====Start to sample for epoch 256, global virtualClock: 9312.106825978868, round_duration: 46.65186139097271
2021-08-18:16:26:01,283 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:01,617 INFO     [param_server.py:553] For epoch: 256, median_reward: 332.2337520471348, dev: 332.2337520471348
2021-08-18:16:26:02,239 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9015, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:26:02,243 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3425.7416, eval_time 0.6123, test_loss 2.9015, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:26:02,248 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6188, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:26:02,249 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3425.7495, eval_time 0.6181, test_loss 2.6188, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:26:02,249 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9852, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:26:02,250 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3425.7503, eval_time 0.6192, test_loss 2.9852, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:26:02,321 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:02,330 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:02,334 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:02,341 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:02,354 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:02,364 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:03,418 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:03,434 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:03,893 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:03,903 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:04,934 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:04,946 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:05,23 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:05,33 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:05,47 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:05,74 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:06,3 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:06,37 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:06,919 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:06,959 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:07,180 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:07,200 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:07,772 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:07,806 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:07,817 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:07,829 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:07,970 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:07,985 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:08,432 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:08,456 INFO     [learner.py:606] ====Pushing takes 0.022170305252075195 s
2021-08-18:16:26:08,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:08,499 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:08,500 INFO     [param_server.py:410] Lock worker 1 with localStep 256 , while globalStep is 255

2021-08-18:16:26:10,548 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:10,560 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:10,790 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:10,805 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:11,401 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:11,413 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:11,737 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:11,756 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:12,520 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:12,531 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:13,13 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:13,23 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:13,111 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:13,141 INFO     [learner.py:606] ====Pushing takes 0.028311967849731445 s
2021-08-18:16:26:13,181 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:13,189 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:13,191 INFO     [param_server.py:410] Lock worker 3 with localStep 256 , while globalStep is 255

2021-08-18:16:26:14,338 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:14,376 INFO     [learner.py:606] ====Pushing takes 0.03612327575683594 s
2021-08-18:16:26:14,419 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:14,427 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:14,428 INFO     [param_server.py:381] ====After aggregation in epoch: 255, virtual_clock: 9358.75868736984, top_1: : 65.3114 % (2024.0), top_5: : 100.0 % (3099.0), test loss: 2.8351726134618125, test len: 3099.0
2021-08-18:16:26:14,430 INFO     [param_server.py:410] Lock worker 2 with localStep 256 , while globalStep is 256

2021-08-18:16:26:14,430 INFO     [param_server.py:441] ====Epoch 257 completes 20 clients with loss 111.25766823224903, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:14,431 INFO     [param_server.py:450] ====Start to sample for epoch 257, global virtualClock: 9358.75868736984, round_duration: 46.65186139097271
2021-08-18:16:26:14,432 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:14,773 INFO     [param_server.py:553] For epoch: 257, median_reward: 333.0041085540814, dev: 333.0041085540814
2021-08-18:16:26:15,384 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7296, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:26:15,386 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3438.886, eval_time 0.598, test_loss 2.7296, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:26:15,391 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9573, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:26:15,392 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3438.8924, eval_time 0.6054, test_loss 2.9573, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:26:15,426 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6355, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:26:15,426 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3438.925, eval_time 0.6414, test_loss 2.6355, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:26:15,463 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:15,471 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:15,493 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:15,481 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:15,506 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:15,506 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:16,782 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:16,796 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:17,97 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:17,111 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:18,83 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:18,101 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:18,283 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:18,307 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:18,995 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:19,28 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:19,924 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:19,957 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:20,433 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:20,443 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:20,796 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:20,830 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:20,851 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:20,863 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:21,64 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:21,73 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:21,570 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:21,604 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:22,199 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:22,222 INFO     [learner.py:606] ====Pushing takes 0.021668434143066406 s
2021-08-18:16:26:22,258 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:22,265 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:22,265 INFO     [param_server.py:410] Lock worker 1 with localStep 257 , while globalStep is 256

2021-08-18:16:26:23,681 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:23,691 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:23,850 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:23,869 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:24,695 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:24,708 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:24,732 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:24,746 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:25,749 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:25,760 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:25,876 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:25,886 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:26,361 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:26,391 INFO     [learner.py:606] ====Pushing takes 0.0288693904876709 s
2021-08-18:16:26:26,431 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:26,438 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:26,439 INFO     [param_server.py:410] Lock worker 3 with localStep 257 , while globalStep is 256

2021-08-18:16:26:26,489 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:26,516 INFO     [learner.py:606] ====Pushing takes 0.02506422996520996 s
2021-08-18:16:26:26,547 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:26,554 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:26,555 INFO     [param_server.py:381] ====After aggregation in epoch: 256, virtual_clock: 9405.410548760812, top_1: : 66.9894 % (2076.0), top_5: : 100.0 % (3099.0), test loss: 2.7741323356275207, test len: 3099.0
2021-08-18:16:26:26,558 INFO     [param_server.py:410] Lock worker 2 with localStep 257 , while globalStep is 257

2021-08-18:16:26:26,558 INFO     [param_server.py:441] ====Epoch 258 completes 20 clients with loss 263.81334280162025, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:26,558 INFO     [param_server.py:450] ====Start to sample for epoch 258, global virtualClock: 9405.410548760812, round_duration: 46.65186139097271
2021-08-18:16:26:26,559 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:26,899 INFO     [param_server.py:553] For epoch: 258, median_reward: 328.6320806823746, dev: 328.6320806823746
2021-08-18:16:26:27,574 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.633, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:26:27,575 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3451.0751, eval_time 0.648, test_loss 2.633, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:26:27,601 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9267, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:26:27,602 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3451.1026, eval_time 0.6776, test_loss 2.9267, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:26:27,608 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7806, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:26:27,610 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3451.1081, eval_time 0.6873, test_loss 2.7806, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:26:27,642 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:27,651 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:27,671 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:27,681 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:27,685 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:27,694 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:28,953 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:28,967 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:29,466 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:29,479 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:30,426 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:30,447 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:30,462 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:30,472 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:30,804 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:30,813 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:31,232 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:31,259 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:32,165 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:32,198 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:32,752 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:32,763 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:32,960 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:32,993 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:33,439 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:33,451 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:33,513 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:33,527 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:33,710 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:33,735 INFO     [learner.py:606] ====Pushing takes 0.022971153259277344 s
2021-08-18:16:26:33,762 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:33,772 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:33,773 INFO     [param_server.py:410] Lock worker 1 with localStep 258 , while globalStep is 257

2021-08-18:16:26:36,72 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:36,86 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:36,441 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:36,455 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:37,181 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:37,195 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:37,514 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:37,523 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:38,358 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:38,369 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:38,775 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:38,788 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:38,968 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:38,995 INFO     [learner.py:606] ====Pushing takes 0.026192665100097656 s
2021-08-18:16:26:39,25 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:39,32 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:39,33 INFO     [param_server.py:410] Lock worker 3 with localStep 258 , while globalStep is 257

2021-08-18:16:26:40,63 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:40,93 INFO     [learner.py:606] ====Pushing takes 0.02747821807861328 s
2021-08-18:16:26:40,135 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:40,143 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:40,144 INFO     [param_server.py:381] ====After aggregation in epoch: 257, virtual_clock: 9452.062410151784, top_1: : 64.4079 % (1996.0), top_5: : 100.0 % (3099.0), test loss: 2.7800825745971114, test len: 3099.0
2021-08-18:16:26:40,146 INFO     [param_server.py:410] Lock worker 2 with localStep 258 , while globalStep is 258

2021-08-18:16:26:40,147 INFO     [param_server.py:441] ====Epoch 259 completes 20 clients with loss 165.93134043819805, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:40,147 INFO     [param_server.py:450] ====Start to sample for epoch 259, global virtualClock: 9452.062410151784, round_duration: 46.65186139097271
2021-08-18:16:26:40,148 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:40,476 INFO     [param_server.py:553] For epoch: 259, median_reward: 316.26478023781806, dev: 316.26478023781806
2021-08-18:16:26:41,59 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5403, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:26:41,60 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3464.5609, eval_time 0.5716, test_loss 2.5403, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:26:41,66 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8769, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:26:41,66 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3464.5666, eval_time 0.5779, test_loss 2.8769, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:26:41,75 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9297, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:26:41,81 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3464.5797, eval_time 0.5933, test_loss 2.9297, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:26:41,133 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:26:41,142 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:26:41,143 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:41,150 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:41,181 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:26:41,190 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:42,330 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:42,344 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:42,731 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:42,740 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:43,810 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:43,822 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:43,934 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:43,943 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:43,983 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:44,11 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:44,847 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:44,880 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:45,666 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:45,700 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:46,295 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:46,309 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:46,421 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:46,448 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:46,581 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:46,592 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:47,5 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:47,15 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:47,77 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:47,101 INFO     [learner.py:606] ====Pushing takes 0.022549152374267578 s
2021-08-18:16:26:47,133 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:47,151 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:47,152 INFO     [param_server.py:410] Lock worker 1 with localStep 259 , while globalStep is 258

2021-08-18:16:26:49,206 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:49,231 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:49,858 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:49,872 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:50,411 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:50,424 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:50,536 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:50,555 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:51,739 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:51,750 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:51,778 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:51,787 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:52,279 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:52,309 INFO     [learner.py:606] ====Pushing takes 0.028369665145874023 s
2021-08-18:16:26:52,338 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:52,343 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:52,352 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:52,353 INFO     [param_server.py:410] Lock worker 3 with localStep 259 , while globalStep is 258

2021-08-18:16:26:52,366 INFO     [learner.py:606] ====Pushing takes 0.026154041290283203 s
2021-08-18:16:26:52,404 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:52,411 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:52,412 INFO     [param_server.py:381] ====After aggregation in epoch: 258, virtual_clock: 9498.714271542756, top_1: : 66.1826 % (2051.0), top_5: : 100.0 % (3099.0), test loss: 2.782275595046856, test len: 3099.0
2021-08-18:16:26:52,415 INFO     [param_server.py:410] Lock worker 2 with localStep 259 , while globalStep is 259

2021-08-18:16:26:52,415 INFO     [param_server.py:441] ====Epoch 260 completes 20 clients with loss 139.5947593479057, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:52,416 INFO     [param_server.py:450] ====Start to sample for epoch 260, global virtualClock: 9498.714271542756, round_duration: 46.65186139097271
2021-08-18:16:26:52,417 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:52,757 INFO     [param_server.py:553] For epoch: 260, median_reward: 306.6865000520263, dev: 306.6865000520263
2021-08-18:16:26:53,333 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9995, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:26:53,335 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3476.8336, eval_time 0.567, test_loss 2.9995, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:26:53,412 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0051, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:26:53,413 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3476.913, eval_time 0.6428, test_loss 3.0051, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:26:53,418 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:26:53,430 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:53,432 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1613, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:26:53,433 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3476.9335, eval_time 0.6627, test_loss 3.1613, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:26:53,507 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:26:53,512 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:26:53,517 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:53,521 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:54,684 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:54,702 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:55,172 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:55,181 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:56,118 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:56,165 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:56,223 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:56,233 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:56,445 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:56,455 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:56,912 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:56,933 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:57,810 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:57,843 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:58,678 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:58,712 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:58,787 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:58,810 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:59,152 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:59,163 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:59,349 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:59,372 INFO     [learner.py:606] ====Pushing takes 0.022342205047607422 s
2021-08-18:16:26:59,408 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:59,416 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:59,416 INFO     [param_server.py:410] Lock worker 1 with localStep 260 , while globalStep is 259

2021-08-18:16:26:59,466 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:59,478 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:01,928 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:01,942 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:02,486 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:02,500 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:03,144 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:03,155 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:03,194 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:03,207 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:04,290 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:04,302 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:04,328 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:04,338 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:04,945 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:04,976 INFO     [learner.py:606] ====Pushing takes 0.02972269058227539 s
2021-08-18:16:27:05,17 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:05,25 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:05,26 INFO     [param_server.py:410] Lock worker 3 with localStep 260 , while globalStep is 259

2021-08-18:16:27:05,491 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:05,518 INFO     [learner.py:606] ====Pushing takes 0.025156259536743164 s
2021-08-18:16:27:05,551 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:05,559 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:05,559 INFO     [param_server.py:381] ====After aggregation in epoch: 259, virtual_clock: 9545.366132933728, top_1: : 65.4405 % (2028.0), top_5: : 100.0 % (3099.0), test loss: 3.055303670741894, test len: 3099.0
2021-08-18:16:27:05,562 INFO     [param_server.py:410] Lock worker 2 with localStep 260 , while globalStep is 260

2021-08-18:16:27:05,562 INFO     [param_server.py:441] ====Epoch 261 completes 20 clients with loss 79.45548391490883, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:05,563 INFO     [param_server.py:450] ====Start to sample for epoch 261, global virtualClock: 9545.366132933728, round_duration: 46.65186139097271
2021-08-18:16:27:05,564 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:05,905 INFO     [param_server.py:541] Handle Wight 0.036476850509643555 | Send 0.34189796447753906
2021-08-18:16:27:05,906 INFO     [param_server.py:553] For epoch: 261, median_reward: 307.3138395165328, dev: 307.3138395165328
2021-08-18:16:27:06,535 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.219, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:27:06,536 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3490.0366, eval_time 0.6179, test_loss 3.219, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:27:06,536 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0655, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:27:06,537 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3490.0375, eval_time 0.6182, test_loss 3.0655, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:27:06,571 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.833, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:27:06,574 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3490.0719, eval_time 0.6564, test_loss 2.833, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:27:06,610 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:06,616 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:06,618 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:06,625 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:06,649 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:06,665 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:08,9 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:08,28 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:08,232 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:08,251 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:09,249 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:09,258 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:09,592 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:09,601 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:09,811 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:09,844 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:10,817 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:10,850 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:11,593 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:11,602 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:11,733 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:11,766 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:12,224 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:12,233 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:12,244 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:12,258 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:12,496 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:12,530 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:13,130 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:13,156 INFO     [learner.py:606] ====Pushing takes 0.02197098731994629 s
2021-08-18:16:27:13,194 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:13,203 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:13,203 INFO     [param_server.py:410] Lock worker 1 with localStep 261 , while globalStep is 260

2021-08-18:16:27:14,962 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:14,981 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:15,100 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:15,114 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:15,940 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:15,961 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:16,71 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:16,82 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:17,71 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:17,82 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:17,236 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:17,245 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:17,687 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:17,715 INFO     [learner.py:606] ====Pushing takes 0.027821063995361328 s
2021-08-18:16:27:17,720 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:17,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:17,756 INFO     [learner.py:606] ====Pushing takes 0.03431844711303711 s
2021-08-18:16:27:17,761 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:17,762 INFO     [param_server.py:410] Lock worker 3 with localStep 261 , while globalStep is 260

2021-08-18:16:27:17,787 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:17,794 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:17,795 INFO     [param_server.py:381] ====After aggregation in epoch: 260, virtual_clock: 9592.0179943247, top_1: : 65.5373 % (2031.0), top_5: : 100.0 % (3099.0), test loss: 3.03914119137658, test len: 3099.0
2021-08-18:16:27:17,797 INFO     [param_server.py:410] Lock worker 2 with localStep 261 , while globalStep is 261

2021-08-18:16:27:17,797 INFO     [param_server.py:441] ====Epoch 262 completes 20 clients with loss 137.20296415276056, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:17,798 INFO     [param_server.py:450] ====Start to sample for epoch 262, global virtualClock: 9592.0179943247, round_duration: 46.65186139097271
2021-08-18:16:27:17,798 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:18,122 INFO     [param_server.py:553] For epoch: 262, median_reward: 326.7818244249326, dev: 326.7818244249326
2021-08-18:16:27:18,786 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5813, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:27:18,789 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3502.2897, eval_time 0.643, test_loss 2.5813, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:27:18,818 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6947, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:27:18,819 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3502.3196, eval_time 0.6733, test_loss 2.6947, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:27:18,825 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7157, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:27:18,826 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3502.3248, eval_time 0.6803, test_loss 2.7157, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:27:18,860 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:18,871 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:18,892 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:18,896 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:18,905 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:18,910 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:20,257 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:20,272 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:20,708 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:20,717 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:21,659 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:21,668 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:21,680 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:21,700 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:21,778 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:21,787 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:22,435 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:22,455 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:23,154 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:23,174 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:23,924 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:23,949 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:23,953 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:23,965 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:24,426 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:24,440 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:24,567 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:24,577 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:24,587 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:24,591 INFO     [learner.py:606] ====Pushing takes 0.022966861724853516 s
2021-08-18:16:27:24,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:24,632 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:24,632 INFO     [param_server.py:410] Lock worker 1 with localStep 262 , while globalStep is 261

2021-08-18:16:27:27,28 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:27,37 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:27,207 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:27,221 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:28,39 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:28,53 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:28,243 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:28,258 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:29,350 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:29,371 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:29,484 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:29,494 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:30,74 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:30,104 INFO     [learner.py:606] ====Pushing takes 0.02815723419189453 s
2021-08-18:16:27:30,136 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:30,146 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:30,147 INFO     [param_server.py:410] Lock worker 3 with localStep 262 , while globalStep is 261

2021-08-18:16:27:30,988 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:31,15 INFO     [learner.py:606] ====Pushing takes 0.025660276412963867 s
2021-08-18:16:27:31,44 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:31,52 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:31,52 INFO     [param_server.py:381] ====After aggregation in epoch: 261, virtual_clock: 9638.669855715672, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 2.663890328672197, test len: 3099.0
2021-08-18:16:27:31,55 INFO     [param_server.py:410] Lock worker 2 with localStep 262 , while globalStep is 262

2021-08-18:16:27:31,55 INFO     [param_server.py:441] ====Epoch 263 completes 20 clients with loss 155.45282525160286, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:31,56 INFO     [param_server.py:450] ====Start to sample for epoch 263, global virtualClock: 9638.669855715672, round_duration: 46.65186139097271
2021-08-18:16:27:31,57 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:31,373 INFO     [param_server.py:553] For epoch: 263, median_reward: 314.0627637162277, dev: 314.0627637162277
2021-08-18:16:27:32,76 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6382, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:27:32,77 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3515.5777, eval_time 0.6816, test_loss 2.6382, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:27:32,80 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6918, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:27:32,81 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3515.5816, eval_time 0.6848, test_loss 2.6918, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:27:32,84 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0904, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:27:32,88 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3515.5862, eval_time 0.6921, test_loss 3.0904, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:27:32,148 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:32,154 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:32,156 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:32,161 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:32,183 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:32,197 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:33,571 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:33,584 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:33,964 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:33,978 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:34,841 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:34,856 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:35,103 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:35,112 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:35,428 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:35,443 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:36,171 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:36,192 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:36,928 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:36,948 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:37,186 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:37,197 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:37,791 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:37,819 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:37,847 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:37,853 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:37,858 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:37,865 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:38,352 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:38,380 INFO     [learner.py:606] ====Pushing takes 0.02369832992553711 s
2021-08-18:16:27:38,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:38,420 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:38,421 INFO     [param_server.py:410] Lock worker 1 with localStep 263 , while globalStep is 262

2021-08-18:16:27:40,470 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:40,482 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:40,497 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:40,506 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:41,121 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:41,135 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:41,551 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:41,565 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:42,338 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:42,359 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:42,835 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:42,848 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:42,895 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:42,924 INFO     [learner.py:606] ====Pushing takes 0.028028011322021484 s
2021-08-18:16:27:42,964 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:42,973 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:42,973 INFO     [param_server.py:410] Lock worker 3 with localStep 263 , while globalStep is 262

2021-08-18:16:27:43,323 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:43,349 INFO     [learner.py:606] ====Pushing takes 0.02491450309753418 s
2021-08-18:16:27:43,381 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:43,389 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:43,389 INFO     [param_server.py:381] ====After aggregation in epoch: 262, virtual_clock: 9685.321717106644, top_1: : 66.344 % (2056.0), top_5: : 100.0 % (3099.0), test loss: 2.8067989879184303, test len: 3099.0
2021-08-18:16:27:43,391 INFO     [param_server.py:410] Lock worker 2 with localStep 263 , while globalStep is 263

2021-08-18:16:27:43,392 INFO     [param_server.py:441] ====Epoch 264 completes 20 clients with loss 111.25587221795276, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:43,392 INFO     [param_server.py:450] ====Start to sample for epoch 264, global virtualClock: 9685.321717106644, round_duration: 46.65186139097271
2021-08-18:16:27:43,393 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:43,676 INFO     [param_server.py:553] For epoch: 264, median_reward: 306.4415201302585, dev: 306.4415201302585
2021-08-18:16:27:44,410 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9456, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:27:44,410 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3527.9108, eval_time 0.7009, test_loss 2.9456, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:27:44,436 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.647, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:27:44,438 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3527.9383, eval_time 0.7283, test_loss 2.647, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:27:44,477 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7363, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:27:44,478 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3527.9763, eval_time 0.7681, test_loss 3.7363, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:27:44,497 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:27:44,499 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:27:44,508 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:44,510 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:44,590 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:27:44,606 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:45,853 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:45,864 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:46,227 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:46,238 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:47,107 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:47,117 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:47,242 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:47,254 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:47,457 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:47,469 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:47,860 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:47,878 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:48,602 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:48,620 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:49,223 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:49,250 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:49,563 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:49,572 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:50,30 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:50,55 INFO     [learner.py:606] ====Pushing takes 0.022955656051635742 s
2021-08-18:16:27:50,66 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:50,77 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:50,93 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:50,103 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:50,104 INFO     [param_server.py:410] Lock worker 1 with localStep 264 , while globalStep is 263

2021-08-18:16:27:50,195 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:50,204 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:52,810 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:52,824 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:52,905 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:52,919 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:53,570 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:53,584 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:53,997 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:54,6 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:54,726 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:54,746 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:55,297 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:55,311 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:55,350 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:55,380 INFO     [learner.py:606] ====Pushing takes 0.02827286720275879 s
2021-08-18:16:27:55,419 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:55,427 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:55,427 INFO     [param_server.py:410] Lock worker 3 with localStep 264 , while globalStep is 263

2021-08-18:16:27:56,520 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:56,548 INFO     [learner.py:606] ====Pushing takes 0.025892019271850586 s
2021-08-18:16:27:56,579 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:56,587 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:56,587 INFO     [param_server.py:381] ====After aggregation in epoch: 263, virtual_clock: 9731.973578497616, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 3.109634077107465, test len: 3099.0
2021-08-18:16:27:56,590 INFO     [param_server.py:410] Lock worker 2 with localStep 264 , while globalStep is 264

2021-08-18:16:27:56,591 INFO     [param_server.py:441] ====Epoch 265 completes 20 clients with loss 78.80212335381286, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:56,591 INFO     [param_server.py:450] ====Start to sample for epoch 265, global virtualClock: 9731.973578497616, round_duration: 46.65186139097271
2021-08-18:16:27:56,592 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:56,926 INFO     [param_server.py:553] For epoch: 265, median_reward: 318.30702799407203, dev: 318.30702799407203
2021-08-18:16:27:57,607 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9914, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:27:57,608 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3541.1066, eval_time 0.6588, test_loss 2.9914, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:27:57,613 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0018, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:27:57,614 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3541.1142, eval_time 0.662, test_loss 3.0018, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:27:57,618 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1089, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:27:57,619 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3541.1196, eval_time 0.663, test_loss 3.1089, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:27:57,687 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:27:57,692 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:27:57,693 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:27:57,695 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:57,702 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:57,702 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:58,682 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:58,693 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:59,124 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:59,136 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:00,186 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:00,198 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:00,222 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:00,233 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:00,374 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:00,384 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:00,988 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:01,15 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:01,836 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:01,863 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:02,515 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:02,526 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:02,600 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:02,628 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:03,56 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:03,74 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:03,153 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:03,165 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:03,292 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:03,318 INFO     [learner.py:606] ====Pushing takes 0.021764039993286133 s
2021-08-18:16:28:03,355 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:03,363 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:03,364 INFO     [param_server.py:410] Lock worker 1 with localStep 265 , while globalStep is 264

2021-08-18:16:28:05,678 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:05,688 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:05,723 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:05,737 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:06,535 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:06,549 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:06,946 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:06,960 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:07,806 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:07,828 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:08,328 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:08,337 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:08,397 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:08,427 INFO     [learner.py:606] ====Pushing takes 0.02788686752319336 s
2021-08-18:16:28:08,466 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:08,477 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:08,478 INFO     [param_server.py:410] Lock worker 3 with localStep 265 , while globalStep is 264

2021-08-18:16:28:08,858 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:08,885 INFO     [learner.py:606] ====Pushing takes 0.025796175003051758 s
2021-08-18:16:28:08,919 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:08,928 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:08,929 INFO     [param_server.py:381] ====After aggregation in epoch: 264, virtual_clock: 9778.625439888589, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.0340418285793724, test len: 3099.0
2021-08-18:16:28:08,931 INFO     [param_server.py:410] Lock worker 2 with localStep 265 , while globalStep is 265

2021-08-18:16:28:08,932 INFO     [param_server.py:441] ====Epoch 266 completes 20 clients with loss 257.98195721672505, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:08,951 INFO     [param_server.py:450] ====Start to sample for epoch 266, global virtualClock: 9778.625439888589, round_duration: 46.65186139097271
2021-08-18:16:28:08,952 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:09,235 INFO     [param_server.py:553] For epoch: 266, median_reward: 335.35498769436765, dev: 335.35498769436765
2021-08-18:16:28:09,936 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8459, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:28:09,937 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3553.4378, eval_time 0.6766, test_loss 2.8459, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:28:09,969 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9414, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:28:09,970 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3553.4705, eval_time 0.7118, test_loss 2.9414, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:28:09,977 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6865, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:28:09,979 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3553.4774, eval_time 0.7204, test_loss 2.6865, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:28:10,12 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:10,21 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:10,38 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:10,51 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:10,70 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:10,86 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:11,243 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:11,253 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:11,677 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:11,688 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:12,686 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:12,700 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:12,706 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:12,716 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:12,907 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:12,917 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:13,377 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:13,390 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:14,52 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:14,72 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:14,671 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:14,704 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:14,970 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:14,979 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:15,313 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:15,337 INFO     [learner.py:606] ====Pushing takes 0.023155927658081055 s
2021-08-18:16:28:15,372 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:15,379 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:15,380 INFO     [param_server.py:410] Lock worker 1 with localStep 266 , while globalStep is 265

2021-08-18:16:28:15,574 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:15,588 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:15,610 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:15,623 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:18,170 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:18,180 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:18,268 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:18,282 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:18,769 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:18,778 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:19,510 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:19,520 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:20,70 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:20,91 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:20,700 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:20,710 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:20,719 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:20,749 INFO     [learner.py:606] ====Pushing takes 0.028640270233154297 s
2021-08-18:16:28:20,787 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:20,795 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:20,796 INFO     [param_server.py:410] Lock worker 3 with localStep 266 , while globalStep is 265

2021-08-18:16:28:21,879 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:21,906 INFO     [learner.py:606] ====Pushing takes 0.025318145751953125 s
2021-08-18:16:28:21,938 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:21,946 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:21,947 INFO     [param_server.py:381] ====After aggregation in epoch: 265, virtual_clock: 9825.27730127956, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 2.824593932540328, test len: 3099.0
2021-08-18:16:28:21,949 INFO     [param_server.py:410] Lock worker 2 with localStep 266 , while globalStep is 266

2021-08-18:16:28:21,950 INFO     [param_server.py:441] ====Epoch 267 completes 20 clients with loss 149.61931069540645, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:21,950 INFO     [param_server.py:450] ====Start to sample for epoch 267, global virtualClock: 9825.27730127956, round_duration: 46.65186139097271
2021-08-18:16:28:21,951 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:22,285 INFO     [param_server.py:553] For epoch: 267, median_reward: 337.7757317601727, dev: 337.7757317601727
2021-08-18:16:28:22,907 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4946, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:28:22,910 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3566.4108, eval_time 0.6006, test_loss 3.4946, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:28:22,912 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6153, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:28:22,915 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3566.416, eval_time 0.6056, test_loss 2.6153, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:28:22,947 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8249, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:28:22,950 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3566.4483, eval_time 0.6422, test_loss 2.8249, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:28:22,982 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:22,986 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:22,997 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:23,8 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:23,22 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:23,35 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:24,290 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:24,304 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:24,604 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:24,620 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:25,666 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:25,675 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:25,865 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:25,881 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:25,929 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:25,949 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:26,761 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:26,782 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:27,579 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:27,606 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:27,949 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:27,960 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:28,251 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:28,278 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:28,740 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:28,751 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:28,825 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:28,826 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:28,835 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:28,848 INFO     [learner.py:606] ====Pushing takes 0.02158331871032715 s
2021-08-18:16:28:28,884 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:28,893 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:28,894 INFO     [param_server.py:410] Lock worker 1 with localStep 267 , while globalStep is 266

2021-08-18:16:28:31,269 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:31,279 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:31,304 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:31,328 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:32,48 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:32,68 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:32,620 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:32,629 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:33,376 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:33,392 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:33,827 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:33,847 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:33,987 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:34,17 INFO     [learner.py:606] ====Pushing takes 0.029434919357299805 s
2021-08-18:16:28:34,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:34,68 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:34,69 INFO     [param_server.py:410] Lock worker 3 with localStep 267 , while globalStep is 266

2021-08-18:16:28:34,476 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:34,502 INFO     [learner.py:606] ====Pushing takes 0.025061607360839844 s
2021-08-18:16:28:34,533 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:34,541 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:34,542 INFO     [param_server.py:381] ====After aggregation in epoch: 266, virtual_clock: 9871.929162670533, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 2.978285767413952, test len: 3099.0
2021-08-18:16:28:34,544 INFO     [param_server.py:410] Lock worker 2 with localStep 267 , while globalStep is 267

2021-08-18:16:28:34,545 INFO     [param_server.py:441] ====Epoch 268 completes 20 clients with loss 178.44650504069688, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:34,546 INFO     [param_server.py:450] ====Start to sample for epoch 268, global virtualClock: 9871.929162670533, round_duration: 46.65186139097271
2021-08-18:16:28:34,547 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:34,881 INFO     [param_server.py:553] For epoch: 268, median_reward: 330.2676905197275, dev: 330.2676905197275
2021-08-18:16:28:35,402 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6891, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:28:35,403 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3578.9033, eval_time 0.4879, test_loss 2.6891, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:28:35,415 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4749, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:28:35,416 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3578.9168, eval_time 0.4992, test_loss 2.4749, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:28:35,475 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:35,484 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:35,487 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:35,489 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7317, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:28:35,490 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3578.9883, eval_time 0.5753, test_loss 2.7317, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:28:35,495 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:35,582 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:35,607 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:36,964 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:36,984 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:37,88 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:37,102 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:38,244 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:38,246 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:38,259 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:38,265 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:38,337 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:38,355 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:39,117 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:39,135 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:39,948 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:39,962 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:40,620 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:40,640 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:40,676 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:40,686 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:41,78 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:41,89 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:41,196 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:41,221 INFO     [learner.py:606] ====Pushing takes 0.023844480514526367 s
2021-08-18:16:28:41,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:41,266 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:41,266 INFO     [param_server.py:410] Lock worker 1 with localStep 268 , while globalStep is 267

2021-08-18:16:28:41,280 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:41,336 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:43,752 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:43,762 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:44,167 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:44,176 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:44,876 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:44,885 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:44,936 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:44,947 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:46,77 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:46,85 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:46,95 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:46,106 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:46,691 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:46,720 INFO     [learner.py:606] ====Pushing takes 0.028434276580810547 s
2021-08-18:16:28:46,762 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:46,769 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:46,770 INFO     [param_server.py:410] Lock worker 3 with localStep 268 , while globalStep is 267

2021-08-18:16:28:47,430 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:47,458 INFO     [learner.py:606] ====Pushing takes 0.02570939064025879 s
2021-08-18:16:28:47,488 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:47,495 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:47,496 INFO     [param_server.py:381] ====After aggregation in epoch: 267, virtual_clock: 9918.581024061505, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 2.631910421230175, test len: 3099.0
2021-08-18:16:28:47,499 INFO     [param_server.py:410] Lock worker 2 with localStep 268 , while globalStep is 268

2021-08-18:16:28:47,499 INFO     [param_server.py:441] ====Epoch 269 completes 20 clients with loss 160.31693055888482, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:47,499 INFO     [param_server.py:450] ====Start to sample for epoch 269, global virtualClock: 9918.581024061505, round_duration: 46.65186139097271
2021-08-18:16:28:47,500 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:47,821 INFO     [param_server.py:553] For epoch: 269, median_reward: 334.55106211421645, dev: 334.55106211421645
2021-08-18:16:28:48,415 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6153, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:28:48,416 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3591.9167, eval_time 0.5438, test_loss 2.6153, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:28:48,452 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3507, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:28:48,453 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3591.9531, eval_time 0.5816, test_loss 3.3507, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:28:48,511 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:28:48,522 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9535, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:28:48,524 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3592.0223, eval_time 0.6567, test_loss 2.9535, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:28:48,524 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:28:48,526 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:48,542 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:48,601 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:28:48,625 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:50,17 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:50,31 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:50,184 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:50,196 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:51,149 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:51,158 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:51,158 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:51,169 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:51,627 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:51,636 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:52,182 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:52,191 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:52,760 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:52,779 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:53,307 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:53,322 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:53,417 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:53,437 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:53,703 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:53,716 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:53,926 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:53,936 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:54,32 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:54,56 INFO     [learner.py:606] ====Pushing takes 0.022831439971923828 s
2021-08-18:16:28:54,92 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:54,99 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:54,100 INFO     [param_server.py:410] Lock worker 1 with localStep 269 , while globalStep is 268

2021-08-18:16:28:56,390 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:56,403 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:56,666 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:56,676 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:57,440 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:57,450 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:57,647 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:57,661 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:58,613 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:58,633 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:59,129 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:59,149 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:59,206 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:59,236 INFO     [learner.py:606] ====Pushing takes 0.02843165397644043 s
2021-08-18:16:28:59,274 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:59,282 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:59,283 INFO     [param_server.py:410] Lock worker 3 with localStep 269 , while globalStep is 268

2021-08-18:16:28:59,696 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:59,723 INFO     [learner.py:606] ====Pushing takes 0.025396108627319336 s
2021-08-18:16:28:59,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:59,764 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:59,764 INFO     [param_server.py:381] ====After aggregation in epoch: 268, virtual_clock: 9965.232885452477, top_1: : 64.6015 % (2002.0), top_5: : 100.0 % (3099.0), test loss: 2.973152458667755, test len: 3099.0
2021-08-18:16:28:59,767 INFO     [param_server.py:410] Lock worker 2 with localStep 269 , while globalStep is 269

2021-08-18:16:28:59,767 INFO     [param_server.py:441] ====Epoch 270 completes 20 clients with loss 107.00864077131239, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:59,768 INFO     [param_server.py:450] ====Start to sample for epoch 270, global virtualClock: 9965.232885452477, round_duration: 46.65186139097271
2021-08-18:16:28:59,769 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:00,84 INFO     [param_server.py:553] For epoch: 270, median_reward: 312.78030235739266, dev: 312.78030235739266
2021-08-18:16:29:00,672 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3346, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:29:00,673 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3604.1738, eval_time 0.555, test_loss 3.3346, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:29:00,704 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5247, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:29:00,705 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3604.2056, eval_time 0.586, test_loss 2.5247, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:29:00,744 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:00,758 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:00,778 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9192, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:29:00,779 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3604.2774, eval_time 0.6604, test_loss 2.9192, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:29:00,784 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:00,825 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:00,845 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:00,865 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:02,58 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:02,72 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:02,514 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:02,525 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:03,383 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:03,393 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:03,473 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:03,484 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:03,745 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:03,755 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:04,11 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:04,21 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:04,636 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:04,646 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:05,288 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:05,307 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:05,659 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:05,671 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:05,962 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:05,986 INFO     [learner.py:606] ====Pushing takes 0.022534847259521484 s
2021-08-18:16:29:06,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:06,22 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:06,23 INFO     [param_server.py:410] Lock worker 1 with localStep 270 , while globalStep is 269

2021-08-18:16:29:06,392 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:06,402 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:06,531 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:06,541 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:09,5 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:09,21 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:09,26 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:09,45 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:09,708 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:09,722 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:10,309 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:10,324 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:10,800 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:10,818 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:11,485 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:11,515 INFO     [learner.py:606] ====Pushing takes 0.02889537811279297 s
2021-08-18:16:29:11,554 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:11,563 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:11,564 INFO     [param_server.py:410] Lock worker 3 with localStep 270 , while globalStep is 269

2021-08-18:16:29:11,712 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:11,722 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:13,112 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:13,139 INFO     [learner.py:606] ====Pushing takes 0.025476455688476562 s
2021-08-18:16:29:13,171 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:13,179 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:13,179 INFO     [param_server.py:381] ====After aggregation in epoch: 269, virtual_clock: 10011.884746843449, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 2.9261426285461147, test len: 3099.0
2021-08-18:16:29:13,181 INFO     [param_server.py:410] Lock worker 2 with localStep 270 , while globalStep is 270

2021-08-18:16:29:13,182 INFO     [param_server.py:441] ====Epoch 271 completes 20 clients with loss 101.81455910617392, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:13,183 INFO     [param_server.py:450] ====Start to sample for epoch 271, global virtualClock: 10011.884746843449, round_duration: 46.65186139097271
2021-08-18:16:29:13,183 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:13,476 INFO     [param_server.py:553] For epoch: 271, median_reward: 321.7478745786908, dev: 321.7478745786908
2021-08-18:16:29:14,75 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.886, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:29:14,76 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3617.5761, eval_time 0.5739, test_loss 2.886, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:29:14,77 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6299, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:29:14,77 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3617.5778, eval_time 0.5753, test_loss 2.6299, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:29:14,110 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1897, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:29:14,114 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3617.6128, eval_time 0.6149, test_loss 3.1897, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:29:14,143 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:14,153 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:14,154 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:14,162 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:14,183 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:14,198 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:15,368 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:15,377 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:15,894 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:15,903 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:16,843 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:16,852 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:16,915 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:16,924 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:16,974 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:16,983 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:17,578 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:17,592 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:18,383 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:18,417 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:19,59 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:19,71 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:19,102 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:19,135 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:19,569 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:19,589 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:19,721 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:19,724 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:19,734 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:19,746 INFO     [learner.py:606] ====Pushing takes 0.023680448532104492 s
2021-08-18:16:29:19,772 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:19,779 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:19,780 INFO     [param_server.py:410] Lock worker 1 with localStep 271 , while globalStep is 270

2021-08-18:16:29:22,297 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:22,306 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:22,456 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:22,467 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:22,857 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:22,867 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:23,724 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:23,733 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:24,71 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:24,92 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:24,869 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:24,899 INFO     [learner.py:606] ====Pushing takes 0.028284311294555664 s
2021-08-18:16:29:24,934 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:24,945 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:24,945 INFO     [param_server.py:410] Lock worker 3 with localStep 271 , while globalStep is 270

2021-08-18:16:29:25,38 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:25,47 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:25,630 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:25,658 INFO     [learner.py:606] ====Pushing takes 0.02737283706665039 s
2021-08-18:16:29:25,690 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:25,698 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:25,698 INFO     [param_server.py:381] ====After aggregation in epoch: 270, virtual_clock: 10058.53660823442, top_1: : 64.4079 % (1996.0), top_5: : 100.0 % (3099.0), test loss: 2.901849344924644, test len: 3099.0
2021-08-18:16:29:25,701 INFO     [param_server.py:410] Lock worker 2 with localStep 271 , while globalStep is 271

2021-08-18:16:29:25,701 INFO     [param_server.py:441] ====Epoch 272 completes 20 clients with loss 222.78206942327796, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:25,702 INFO     [param_server.py:450] ====Start to sample for epoch 272, global virtualClock: 10058.53660823442, round_duration: 46.65186139097271
2021-08-18:16:29:25,702 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:25,979 INFO     [param_server.py:553] For epoch: 272, median_reward: 334.3339300673661, dev: 334.3339300673661
2021-08-18:16:29:26,706 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8182, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:29:26,706 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.851, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:29:26,707 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3630.2073, eval_time 0.7012, test_loss 2.8182, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:29:26,707 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3630.2074, eval_time 0.7038, test_loss 2.851, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:29:26,734 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7723, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:29:26,735 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3630.2338, eval_time 0.7319, test_loss 2.7723, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:29:26,776 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:26,776 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:26,784 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:26,784 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:26,805 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:26,820 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:28,65 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:28,83 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:28,424 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:28,436 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:29,469 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:29,483 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:29,487 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:29,501 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:29,554 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:29,629 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:30,261 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:30,282 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:31,49 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:31,70 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:31,749 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:31,760 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:31,771 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:31,799 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:32,409 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:32,434 INFO     [learner.py:606] ====Pushing takes 0.024058818817138672 s
2021-08-18:16:29:32,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:32,471 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:32,472 INFO     [param_server.py:410] Lock worker 1 with localStep 272 , while globalStep is 271

2021-08-18:16:29:32,517 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:32,530 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:32,797 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:32,814 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:35,229 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:35,238 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:35,546 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:35,555 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:35,909 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:35,919 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:36,773 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:36,784 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:37,18 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:37,37 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:37,709 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:37,736 INFO     [learner.py:606] ====Pushing takes 0.02607417106628418 s
2021-08-18:16:29:37,779 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:37,787 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:37,788 INFO     [param_server.py:410] Lock worker 3 with localStep 272 , while globalStep is 271

2021-08-18:16:29:38,232 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:38,245 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:39,456 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:39,484 INFO     [learner.py:606] ====Pushing takes 0.026684045791625977 s
2021-08-18:16:29:39,517 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:39,525 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:39,526 INFO     [param_server.py:381] ====After aggregation in epoch: 271, virtual_clock: 10105.188469625393, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 2.8138327189134777, test len: 3099.0
2021-08-18:16:29:39,529 INFO     [param_server.py:410] Lock worker 2 with localStep 272 , while globalStep is 272

2021-08-18:16:29:39,529 INFO     [param_server.py:441] ====Epoch 273 completes 20 clients with loss 203.68494556186982, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:39,530 INFO     [param_server.py:450] ====Start to sample for epoch 273, global virtualClock: 10105.188469625393, round_duration: 46.65186139097271
2021-08-18:16:29:39,531 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:39,880 INFO     [param_server.py:553] For epoch: 273, median_reward: 333.32160090523246, dev: 333.32160090523246
2021-08-18:16:29:40,493 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9207, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:29:40,494 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3643.9941, eval_time 0.59, test_loss 2.9207, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:29:40,524 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5965, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:29:40,525 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3644.0255, eval_time 0.6212, test_loss 2.5965, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:29:40,562 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:29:40,570 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:40,569 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.841, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:29:40,573 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3644.0716, eval_time 0.6692, test_loss 2.841, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:29:40,618 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:29:40,626 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:40,643 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:29:40,660 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:42,66 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:42,86 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:42,274 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:42,294 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:43,230 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:43,251 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:43,493 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:43,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:43,978 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:43,987 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:44,583 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:44,592 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:45,371 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:45,392 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:45,640 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:45,650 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:46,51 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:46,61 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:46,110 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:46,131 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:46,254 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:46,264 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:46,719 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:46,743 INFO     [learner.py:606] ====Pushing takes 0.022843122482299805 s
2021-08-18:16:29:46,780 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:46,790 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:46,791 INFO     [param_server.py:410] Lock worker 1 with localStep 273 , while globalStep is 272

2021-08-18:16:29:48,710 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:48,720 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:48,761 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:48,772 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:49,307 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:49,316 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:49,770 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:49,781 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:50,374 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:50,393 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:50,978 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:50,985 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:50,994 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:51,8 INFO     [learner.py:606] ====Pushing takes 0.028267621994018555 s
2021-08-18:16:29:51,57 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:51,65 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:51,66 INFO     [param_server.py:410] Lock worker 3 with localStep 273 , while globalStep is 272

2021-08-18:16:29:51,490 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:51,517 INFO     [learner.py:606] ====Pushing takes 0.02626943588256836 s
2021-08-18:16:29:51,559 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:51,572 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:51,573 INFO     [param_server.py:381] ====After aggregation in epoch: 272, virtual_clock: 10151.840331016365, top_1: : 64.0207 % (1984.0), top_5: : 100.0 % (3099.0), test loss: 2.7860489498685905, test len: 3099.0
2021-08-18:16:29:51,575 INFO     [param_server.py:410] Lock worker 2 with localStep 273 , while globalStep is 273

2021-08-18:16:29:51,575 INFO     [param_server.py:441] ====Epoch 274 completes 20 clients with loss 158.95799152587193, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:51,576 INFO     [param_server.py:450] ====Start to sample for epoch 274, global virtualClock: 10151.840331016365, round_duration: 46.65186139097271
2021-08-18:16:29:51,577 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:51,916 INFO     [param_server.py:553] For epoch: 274, median_reward: 326.13528682731027, dev: 326.13528682731027
2021-08-18:16:29:52,547 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7724, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:29:52,548 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3656.0482, eval_time 0.585, test_loss 2.7724, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:29:52,627 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:29:52,627 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9997, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:29:52,628 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3656.1283, eval_time 0.6674, test_loss 2.9997, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:29:52,635 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:52,669 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8211, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:29:52,671 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3656.1692, eval_time 0.7101, test_loss 2.8211, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:29:52,697 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:29:52,715 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:52,742 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:29:52,767 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:54,65 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:54,92 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:54,629 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:54,639 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:55,230 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:55,239 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:55,562 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:55,572 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:55,933 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:55,943 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:55,966 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:55,975 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:56,623 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:56,633 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:57,198 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:57,207 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:57,775 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:57,799 INFO     [learner.py:606] ====Pushing takes 0.0227200984954834 s
2021-08-18:16:29:57,837 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:57,848 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:57,849 INFO     [param_server.py:410] Lock worker 1 with localStep 274 , while globalStep is 273

2021-08-18:16:29:57,863 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:57,873 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:58,496 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:58,506 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:58,544 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:58,556 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:01,232 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:01,242 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:01,285 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:01,295 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:02,34 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:02,45 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:02,244 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:02,254 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:03,195 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:03,214 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:03,470 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:03,491 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:03,879 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:03,910 INFO     [learner.py:606] ====Pushing takes 0.028731346130371094 s
2021-08-18:16:30:03,948 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:03,962 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:03,963 INFO     [param_server.py:410] Lock worker 3 with localStep 274 , while globalStep is 273

2021-08-18:16:30:04,998 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:05,25 INFO     [learner.py:606] ====Pushing takes 0.02527308464050293 s
2021-08-18:16:30:05,61 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:05,73 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:05,74 INFO     [param_server.py:381] ====After aggregation in epoch: 273, virtual_clock: 10198.492192407337, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 2.8643665854577662, test len: 3099.0
2021-08-18:16:30:05,77 INFO     [param_server.py:410] Lock worker 2 with localStep 274 , while globalStep is 274

2021-08-18:16:30:05,78 INFO     [param_server.py:441] ====Epoch 275 completes 20 clients with loss 209.58665148646918, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:05,78 INFO     [param_server.py:450] ====Start to sample for epoch 275, global virtualClock: 10198.492192407337, round_duration: 46.65186139097271
2021-08-18:16:30:05,80 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:06,152 INFO     [param_server.py:553] For epoch: 275, median_reward: 334.2832498049974, dev: 334.2832498049974
2021-08-18:16:30:06,752 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9664, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:30:06,753 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3670.2532, eval_time 0.5757, test_loss 2.9664, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:30:06,789 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9419, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:30:06,792 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1771, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:30:06,811 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3670.3092, eval_time 0.636, test_loss 2.9419, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:30:06,811 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3670.3112, eval_time 0.6361, test_loss 3.1771, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:30:06,844 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:06,854 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:06,880 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:06,883 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:06,895 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:06,896 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:08,86 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:08,96 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:08,529 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:08,539 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:09,559 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:09,568 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:09,681 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:09,691 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:09,707 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:09,716 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:10,377 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:10,388 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:10,992 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:11,13 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:11,732 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:11,753 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:11,817 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:11,827 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:12,207 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:12,218 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:12,417 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:12,423 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:12,432 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:12,440 INFO     [learner.py:606] ====Pushing takes 0.021645545959472656 s
2021-08-18:16:30:12,476 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:12,484 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:12,484 INFO     [param_server.py:410] Lock worker 1 with localStep 275 , while globalStep is 274

2021-08-18:16:30:14,895 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:14,923 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:15,109 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:15,118 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:15,740 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:15,761 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:16,202 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:16,217 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:17,65 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:17,83 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:17,466 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:17,476 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:17,805 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:17,835 INFO     [learner.py:606] ====Pushing takes 0.028063297271728516 s
2021-08-18:16:30:17,874 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:17,882 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:17,883 INFO     [param_server.py:410] Lock worker 3 with localStep 275 , while globalStep is 274

2021-08-18:16:30:18,144 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:18,170 INFO     [learner.py:606] ====Pushing takes 0.02477860450744629 s
2021-08-18:16:30:18,203 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:18,210 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:18,211 INFO     [param_server.py:381] ====After aggregation in epoch: 274, virtual_clock: 10245.144053798309, top_1: : 64.0852 % (1986.0), top_5: : 100.0 % (3099.0), test loss: 3.0284578226230763, test len: 3099.0
2021-08-18:16:30:18,213 INFO     [param_server.py:410] Lock worker 2 with localStep 275 , while globalStep is 275

2021-08-18:16:30:18,214 INFO     [param_server.py:441] ====Epoch 276 completes 20 clients with loss 97.98524947446042, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:18,235 INFO     [param_server.py:450] ====Start to sample for epoch 276, global virtualClock: 10245.144053798309, round_duration: 46.65186139097271
2021-08-18:16:30:18,237 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:18,574 INFO     [param_server.py:553] For epoch: 276, median_reward: 315.13773677368295, dev: 315.13773677368295
2021-08-18:16:30:19,178 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4369, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:30:19,179 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3682.68, eval_time 0.5654, test_loss 3.4369, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:30:19,222 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8771, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:30:19,223 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3682.7233, eval_time 0.609, test_loss 2.8771, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:30:19,225 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1269, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:30:19,228 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3682.7263, eval_time 0.6202, test_loss 3.1269, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:30:19,292 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:19,298 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:19,301 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:19,312 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:19,315 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:19,328 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:20,589 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:20,608 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:21,97 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:21,106 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:21,865 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:21,874 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:21,922 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:21,932 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:22,356 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:22,365 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:22,506 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:22,515 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:23,32 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:23,52 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:23,632 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:23,659 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:24,53 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:24,64 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:24,265 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:24,289 INFO     [learner.py:606] ====Pushing takes 0.022890806198120117 s
2021-08-18:16:30:24,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:24,335 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:24,335 INFO     [param_server.py:410] Lock worker 1 with localStep 276 , while globalStep is 275

2021-08-18:16:30:24,691 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:24,701 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:24,894 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:24,904 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:27,468 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:27,477 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:27,772 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:27,784 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:28,75 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:28,85 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:29,21 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:29,32 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:29,324 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:29,342 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:29,922 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:29,951 INFO     [learner.py:606] ====Pushing takes 0.027519941329956055 s
2021-08-18:16:30:29,990 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:29,999 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:30,0 INFO     [param_server.py:410] Lock worker 3 with localStep 276 , while globalStep is 275

2021-08-18:16:30:30,327 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:30,336 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:31,490 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:31,519 INFO     [learner.py:606] ====Pushing takes 0.027761459350585938 s
2021-08-18:16:30:31,559 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:31,568 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:31,569 INFO     [param_server.py:381] ====After aggregation in epoch: 275, virtual_clock: 10291.795915189281, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.1469392555731317, test len: 3099.0
2021-08-18:16:30:31,578 INFO     [param_server.py:410] Lock worker 2 with localStep 276 , while globalStep is 276

2021-08-18:16:30:31,579 INFO     [param_server.py:441] ====Epoch 277 completes 20 clients with loss 143.73532133771485, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:31,581 INFO     [param_server.py:450] ====Start to sample for epoch 277, global virtualClock: 10291.795915189281, round_duration: 46.65186139097271
2021-08-18:16:30:31,582 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:31,917 INFO     [param_server.py:553] For epoch: 277, median_reward: 339.41010444640074, dev: 339.41010444640074
2021-08-18:16:30:32,550 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5872, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:30:32,551 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3696.0514, eval_time 0.6064, test_loss 2.5872, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:30:32,584 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8934, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:30:32,585 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3696.0838, eval_time 0.644, test_loss 2.8934, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:30:32,594 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8209, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:30:32,595 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3696.0953, eval_time 0.6504, test_loss 2.8209, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:30:32,642 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:32,656 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:32,660 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:32,673 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:32,674 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:32,687 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:33,792 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:33,806 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:34,285 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:34,297 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:35,276 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:35,290 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:35,418 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:35,432 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:35,474 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:35,495 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:36,152 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:36,179 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:37,6 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:37,32 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:37,603 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:37,617 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:37,709 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:37,730 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:38,327 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:38,329 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:38,345 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:38,353 INFO     [learner.py:606] ====Pushing takes 0.021270751953125 s
2021-08-18:16:30:38,372 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:38,391 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:38,391 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:38,398 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:38,399 INFO     [param_server.py:410] Lock worker 1 with localStep 277 , while globalStep is 276

2021-08-18:16:30:41,109 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:41,121 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:41,137 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:41,149 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:41,749 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:41,759 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:42,256 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:42,265 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:42,908 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:42,927 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:43,487 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:43,501 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:43,593 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:43,623 INFO     [learner.py:606] ====Pushing takes 0.02817058563232422 s
2021-08-18:16:30:43,663 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:43,673 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:43,674 INFO     [param_server.py:410] Lock worker 3 with localStep 277 , while globalStep is 276

2021-08-18:16:30:44,77 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:44,103 INFO     [learner.py:606] ====Pushing takes 0.02524566650390625 s
2021-08-18:16:30:44,134 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:44,141 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:44,142 INFO     [param_server.py:381] ====After aggregation in epoch: 276, virtual_clock: 10338.447776580253, top_1: : 66.0858 % (2048.0), top_5: : 100.0 % (3099.0), test loss: 2.76715428299374, test len: 3099.0
2021-08-18:16:30:44,144 INFO     [param_server.py:410] Lock worker 2 with localStep 277 , while globalStep is 277

2021-08-18:16:30:44,145 INFO     [param_server.py:441] ====Epoch 278 completes 20 clients with loss 64.78595664598203, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:44,145 INFO     [param_server.py:450] ====Start to sample for epoch 278, global virtualClock: 10338.447776580253, round_duration: 46.65186139097271
2021-08-18:16:30:44,147 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:44,474 INFO     [param_server.py:553] For epoch: 278, median_reward: 331.22703344780297, dev: 331.22703344780297
2021-08-18:16:30:45,138 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6294, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:30:45,139 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3708.64, eval_time 0.6302, test_loss 2.6294, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:30:45,174 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8326, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:30:45,174 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3708.673, eval_time 0.6653, test_loss 2.8326, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:30:45,177 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0138, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:30:45,178 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3708.6786, eval_time 0.6689, test_loss 3.0138, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:30:45,221 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:30:45,230 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:45,241 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:30:45,245 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:30:45,255 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:45,257 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:46,552 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:46,572 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:47,23 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:47,42 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:47,904 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:47,913 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:48,95 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:48,115 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:48,565 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:48,579 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:48,710 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:48,724 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:49,427 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:49,441 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:50,59 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:50,73 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:50,231 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:50,240 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:50,684 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:50,708 INFO     [learner.py:606] ====Pushing takes 0.02249622344970703 s
2021-08-18:16:30:50,744 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:50,751 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:50,752 INFO     [param_server.py:410] Lock worker 1 with localStep 278 , while globalStep is 277

2021-08-18:16:30:50,931 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:50,940 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:51,161 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:51,172 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:53,577 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:53,594 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:53,900 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:53,914 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:54,268 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:54,277 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:55,123 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:55,132 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:55,392 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:55,411 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:55,996 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:56,27 INFO     [learner.py:606] ====Pushing takes 0.02957463264465332 s
2021-08-18:16:30:56,66 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:56,74 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:56,75 INFO     [param_server.py:410] Lock worker 3 with localStep 278 , while globalStep is 277

2021-08-18:16:30:56,409 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:56,418 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:57,556 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:57,588 INFO     [learner.py:606] ====Pushing takes 0.031244993209838867 s
2021-08-18:16:30:57,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:57,637 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:57,638 INFO     [param_server.py:381] ====After aggregation in epoch: 277, virtual_clock: 10385.099637971225, top_1: : 64.3756 % (1995.0), top_5: : 100.0 % (3099.0), test loss: 2.825266692373488, test len: 3099.0
2021-08-18:16:30:57,640 INFO     [param_server.py:410] Lock worker 2 with localStep 278 , while globalStep is 278

2021-08-18:16:30:57,640 INFO     [param_server.py:441] ====Epoch 279 completes 20 clients with loss 112.35566837334879, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:57,641 INFO     [param_server.py:450] ====Start to sample for epoch 279, global virtualClock: 10385.099637971225, round_duration: 46.65186139097271
2021-08-18:16:30:57,642 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:30:57,970 INFO     [param_server.py:553] For epoch: 279, median_reward: 312.3324450787225, dev: 312.3324450787225
2021-08-18:16:30:58,672 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7626, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:30:58,673 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3722.1735, eval_time 0.6545, test_loss 2.7626, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:30:58,780 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:30:58,781 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0508, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:30:58,784 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3722.2827, eval_time 0.7688, test_loss 3.0508, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:30:58,788 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0703, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:30:58,788 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:58,789 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3722.289, eval_time 0.7724, test_loss 3.0703, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:30:58,850 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:30:58,857 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:30:58,877 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:58,886 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:00,815 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:00,824 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:01,528 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:01,537 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:01,716 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:01,727 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:03,378 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:03,392 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:03,745 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:03,755 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:04,409 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:04,421 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:05,13 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:05,24 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:05,312 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:05,333 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:06,905 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:06,931 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:07,26 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:07,38 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:07,800 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:07,812 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:07,889 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:07,922 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:08,654 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:08,668 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:09,308 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:09,329 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:09,576 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:09,616 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:31:10,246 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:31:10,275 INFO     [learner.py:606] ====Pushing takes 0.027592897415161133 s
2021-08-18:16:31:10,314 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:10,322 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:31:10,323 INFO     [param_server.py:410] Lock worker 1 with localStep 279 , while globalStep is 278

2021-08-18:16:31:11,139 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:11,160 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:11,702 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:11,712 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:12,950 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:12,979 INFO     [learner.py:606] ====Pushing takes 0.027726411819458008 s
2021-08-18:16:31:13,24 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:13,35 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:31:13,36 INFO     [param_server.py:410] Lock worker 3 with localStep 279 , while globalStep is 278

2021-08-18:16:31:13,225 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:13,252 INFO     [learner.py:606] ====Pushing takes 0.021764039993286133 s
2021-08-18:16:31:13,277 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:13,284 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:13,285 INFO     [param_server.py:381] ====After aggregation in epoch: 278, virtual_clock: 10478.428653352123, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 2.961229165395101, test len: 3099.0
2021-08-18:16:31:13,290 INFO     [param_server.py:410] Lock worker 2 with localStep 279 , while globalStep is 279

2021-08-18:16:31:13,291 INFO     [param_server.py:441] ====Epoch 280 completes 20 clients with loss 64.71227028183301, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:13,291 INFO     [param_server.py:450] ====Start to sample for epoch 280, global virtualClock: 10478.428653352123, round_duration: 93.32901538089713
2021-08-18:16:31:13,318 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:31:13,652 INFO     [param_server.py:553] For epoch: 280, median_reward: 374.8732215535227, dev: 374.8732215535227
2021-08-18:16:31:14,427 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8203, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:31:14,428 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3737.9288, eval_time 0.7491, test_loss 2.8203, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:31:14,430 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9401, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:31:14,431 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3737.9294, eval_time 0.7532, test_loss 2.9401, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:31:14,438 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6127, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:31:14,439 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3737.9394, eval_time 0.7584, test_loss 2.6127, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:31:14,499 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:14,504 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:14,507 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:14,509 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:14,514 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:14,516 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:15,578 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:15,588 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:16,64 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:16,73 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:17,51 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:17,61 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:17,342 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:17,362 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:18,595 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:18,605 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:18,624 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:18,651 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:19,377 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:19,387 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:19,642 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:19,676 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:20,76 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:20,87 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:20,525 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:20,558 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:21,153 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:21,180 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:31:21,488 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:21,501 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:21,983 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:31:22,10 INFO     [learner.py:606] ====Pushing takes 0.024889230728149414 s
2021-08-18:16:31:22,50 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:22,57 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:31:22,58 INFO     [param_server.py:410] Lock worker 1 with localStep 280 , while globalStep is 279

2021-08-18:16:31:22,702 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:22,716 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:22,894 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:22,916 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:23,683 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:23,692 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:25,264 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:25,273 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:25,277 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:25,285 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:25,876 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:25,906 INFO     [learner.py:606] ====Pushing takes 0.028354167938232422 s
2021-08-18:16:31:25,945 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:25,953 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:31:25,954 INFO     [param_server.py:410] Lock worker 3 with localStep 280 , while globalStep is 279

2021-08-18:16:31:26,53 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:26,79 INFO     [learner.py:606] ====Pushing takes 0.025233030319213867 s
2021-08-18:16:31:26,104 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:26,111 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:26,112 INFO     [param_server.py:381] ====After aggregation in epoch: 279, virtual_clock: 10540.62997400866, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 2.791058231283117, test len: 3099.0
2021-08-18:16:31:26,114 INFO     [param_server.py:410] Lock worker 2 with localStep 280 , while globalStep is 280

2021-08-18:16:31:26,114 INFO     [param_server.py:441] ====Epoch 281 completes 20 clients with loss 159.69780957978625, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:26,115 INFO     [param_server.py:450] ====Start to sample for epoch 281, global virtualClock: 10540.62997400866, round_duration: 62.20132065653664
2021-08-18:16:31:26,116 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:31:26,416 INFO     [param_server.py:541] Handle Wight 0.028475046157836914 | Send 0.3014652729034424
2021-08-18:16:31:26,417 INFO     [param_server.py:553] For epoch: 281, median_reward: 319.17771117999, dev: 319.17771117999
2021-08-18:16:31:27,21 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8868, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:31:27,22 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7165, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:31:27,22 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3750.5209, eval_time 0.5948, test_loss 2.8868, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:31:27,23 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3750.523, eval_time 0.5947, test_loss 2.7165, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:31:27,32 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6915, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:31:27,32 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3750.533, eval_time 0.6028, test_loss 2.6915, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:31:27,93 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:27,93 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:27,102 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:27,102 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:27,103 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:27,112 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:28,237 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:28,250 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:28,744 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:28,755 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:29,686 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:29,696 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:30,467 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:30,500 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:31,481 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:31,502 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:31,905 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:31,915 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:31,968 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:31,995 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:32,625 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:32,634 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:32,832 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:32,860 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:33,679 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:33,700 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:34,341 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:34,353 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:34,435 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:34,462 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:31:35,55 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:31:35,82 INFO     [learner.py:606] ====Pushing takes 0.025454044342041016 s
2021-08-18:16:31:35,118 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:35,128 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:31:35,129 INFO     [param_server.py:410] Lock worker 1 with localStep 281 , while globalStep is 280

2021-08-18:16:31:35,344 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:35,366 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:35,585 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:35,598 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:36,307 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:36,320 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:37,989 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:38,4 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:38,63 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:38,77 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:38,636 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:38,666 INFO     [learner.py:606] ====Pushing takes 0.028659582138061523 s
2021-08-18:16:31:38,698 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:38,706 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:31:38,707 INFO     [param_server.py:410] Lock worker 3 with localStep 281 , while globalStep is 280

2021-08-18:16:31:38,976 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:38,999 INFO     [learner.py:606] ====Pushing takes 0.02180027961730957 s
2021-08-18:16:31:39,24 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:39,31 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:39,32 INFO     [param_server.py:381] ====After aggregation in epoch: 280, virtual_clock: 10604.763948731412, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 2.7649317229235613, test len: 3099.0
2021-08-18:16:31:39,35 INFO     [param_server.py:410] Lock worker 2 with localStep 281 , while globalStep is 281

2021-08-18:16:31:39,36 INFO     [param_server.py:441] ====Epoch 282 completes 20 clients with loss 78.27405501981421, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:39,36 INFO     [param_server.py:450] ====Start to sample for epoch 282, global virtualClock: 10604.763948731412, round_duration: 64.13397472275163
2021-08-18:16:31:39,37 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:31:39,329 INFO     [param_server.py:553] For epoch: 282, median_reward: 364.32754871215076, dev: 364.32754871215076
2021-08-18:16:31:39,958 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7395, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:31:39,958 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3763.4587, eval_time 0.6033, test_loss 2.7395, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:31:40,5 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8585, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:31:40,6 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3763.5047, eval_time 0.6523, test_loss 2.8585, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:31:40,9 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5188, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:31:40,10 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3763.5109, eval_time 0.6544, test_loss 2.5188, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:31:40,26 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:31:40,34 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:40,76 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:31:40,82 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:31:40,89 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:40,90 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:41,544 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:41,585 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:41,899 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:41,913 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:42,815 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:42,824 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:43,594 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:43,614 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:44,845 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:44,857 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:45,33 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:45,54 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:45,226 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:45,236 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:45,722 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:45,743 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:46,54 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:46,63 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:46,365 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:46,386 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:47,79 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:47,100 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:31:47,551 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:47,562 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:47,701 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:31:47,727 INFO     [learner.py:606] ====Pushing takes 0.02450871467590332 s
2021-08-18:16:31:47,764 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:47,775 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:31:47,775 INFO     [param_server.py:410] Lock worker 1 with localStep 282 , while globalStep is 281

2021-08-18:16:31:48,769 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:48,782 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:48,832 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:48,841 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:49,706 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:49,720 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:50,928 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:50,938 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:51,430 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:51,444 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:51,475 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:51,505 INFO     [learner.py:606] ====Pushing takes 0.02797842025756836 s
2021-08-18:16:31:51,540 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:51,548 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:31:51,548 INFO     [param_server.py:410] Lock worker 3 with localStep 282 , while globalStep is 281

2021-08-18:16:31:52,287 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:52,311 INFO     [learner.py:606] ====Pushing takes 0.022681236267089844 s
2021-08-18:16:31:52,336 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:52,343 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:52,343 INFO     [param_server.py:381] ====After aggregation in epoch: 281, virtual_clock: 10662.410136641241, top_1: : 65.1178 % (2018.0), top_5: : 100.0 % (3099.0), test loss: 2.7055908375316196, test len: 3099.0
2021-08-18:16:31:52,346 INFO     [param_server.py:410] Lock worker 2 with localStep 282 , while globalStep is 282

2021-08-18:16:31:52,346 INFO     [param_server.py:441] ====Epoch 283 completes 20 clients with loss 149.58849462114276, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:52,346 INFO     [param_server.py:450] ====Start to sample for epoch 283, global virtualClock: 10662.410136641241, round_duration: 57.6461879098304
2021-08-18:16:31:52,347 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:31:52,629 INFO     [param_server.py:553] For epoch: 283, median_reward: 351.46070257826375, dev: 351.46070257826375
2021-08-18:16:31:53,222 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.592, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:31:53,228 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3776.728, eval_time 0.5587, test_loss 2.592, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:31:53,253 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.04, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:31:53,255 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3776.755, eval_time 0.5858, test_loss 3.04, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:31:53,301 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:31:53,301 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9793, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:31:53,305 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3776.8032, eval_time 0.6359, test_loss 2.9793, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:31:53,311 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:53,327 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:31:53,339 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:53,373 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:31:53,394 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:54,521 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:54,535 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:55,8 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:55,23 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:55,892 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:55,902 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:56,124 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:56,133 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:57,407 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:57,425 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:57,659 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:57,671 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:58,174 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:58,188 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:58,307 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:58,317 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:58,787 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:58,805 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:58,976 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:58,985 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:59,458 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:59,481 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:00,57 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:00,84 INFO     [learner.py:606] ====Pushing takes 0.025414228439331055 s
2021-08-18:16:32:00,124 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:00,134 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:00,135 INFO     [param_server.py:410] Lock worker 1 with localStep 283 , while globalStep is 282

2021-08-18:16:32:00,182 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:00,192 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:01,261 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:01,272 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:01,646 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:01,660 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:02,326 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:02,336 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:03,467 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:03,477 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:03,570 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:03,597 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:04,108 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:04,136 INFO     [learner.py:606] ====Pushing takes 0.02738213539123535 s
2021-08-18:16:32:04,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:04,175 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:04,176 INFO     [param_server.py:410] Lock worker 3 with localStep 283 , while globalStep is 282

2021-08-18:16:32:04,417 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:04,440 INFO     [learner.py:606] ====Pushing takes 0.021584272384643555 s
2021-08-18:16:32:04,465 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:04,472 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:04,472 INFO     [param_server.py:381] ====After aggregation in epoch: 282, virtual_clock: 10720.056324551071, top_1: : 66.3117 % (2055.0), top_5: : 100.0 % (3099.0), test loss: 2.870425873332554, test len: 3099.0
2021-08-18:16:32:04,475 INFO     [param_server.py:410] Lock worker 2 with localStep 283 , while globalStep is 283

2021-08-18:16:32:04,475 INFO     [param_server.py:441] ====Epoch 284 completes 20 clients with loss 226.98643887120033, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:04,476 INFO     [param_server.py:450] ====Start to sample for epoch 284, global virtualClock: 10720.056324551071, round_duration: 57.6461879098304
2021-08-18:16:32:04,477 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:04,803 INFO     [param_server.py:553] For epoch: 284, median_reward: 378.1379979128568, dev: 378.1379979128568
2021-08-18:16:32:05,607 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5506, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:32:05,608 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3789.1086, eval_time 0.751, test_loss 2.5506, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:32:05,609 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8709, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:32:05,610 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3789.1105, eval_time 0.7602, test_loss 2.8709, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:32:05,651 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0079, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:32:05,652 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3789.1509, eval_time 0.8036, test_loss 3.0079, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:32:05,677 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:05,684 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:05,689 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:05,698 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:05,721 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:05,742 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:06,972 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:06,981 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:07,425 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:07,436 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:08,465 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:08,479 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:08,610 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:08,629 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:09,930 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:09,945 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:09,945 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:09,955 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:10,672 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:10,686 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:10,693 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:10,705 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:11,411 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:11,414 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:11,424 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:11,431 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:12,86 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:12,107 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:12,586 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:12,596 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:12,839 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:12,862 INFO     [learner.py:606] ====Pushing takes 0.02213287353515625 s
2021-08-18:16:32:12,898 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:12,905 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:12,906 INFO     [param_server.py:410] Lock worker 1 with localStep 284 , while globalStep is 283

2021-08-18:16:32:13,834 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:13,848 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:14,173 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:14,188 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:15,79 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:15,93 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:16,185 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:16,205 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:16,330 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:16,340 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:16,971 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:16,998 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:16,999 INFO     [learner.py:606] ====Pushing takes 0.026408672332763672 s
2021-08-18:16:32:17,29 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:17,30 INFO     [learner.py:606] ====Pushing takes 0.030530691146850586 s
2021-08-18:16:32:17,37 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:17,37 INFO     [param_server.py:410] Lock worker 3 with localStep 284 , while globalStep is 283

2021-08-18:16:32:17,57 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:17,82 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:17,82 INFO     [param_server.py:381] ====After aggregation in epoch: 283, virtual_clock: 10777.7025124609, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 2.80979421403673, test len: 3099.0
2021-08-18:16:32:17,85 INFO     [param_server.py:410] Lock worker 2 with localStep 284 , while globalStep is 284

2021-08-18:16:32:17,86 INFO     [param_server.py:441] ====Epoch 285 completes 20 clients with loss 161.24989432310062, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:17,86 INFO     [param_server.py:450] ====Start to sample for epoch 285, global virtualClock: 10777.7025124609, round_duration: 57.6461879098304
2021-08-18:16:32:17,87 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:17,350 INFO     [param_server.py:553] For epoch: 285, median_reward: 361.8433451183763, dev: 361.8433451183763
2021-08-18:16:32:18,36 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3074, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:32:18,37 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3801.5372, eval_time 0.6517, test_loss 3.3074, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:32:18,40 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8655, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:32:18,44 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3801.5445, eval_time 0.6602, test_loss 2.8655, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:32:18,84 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4482, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:32:18,85 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3801.5839, eval_time 0.7013, test_loss 3.4482, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:32:18,117 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:18,125 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:18,129 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:18,137 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:18,154 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:18,170 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:19,321 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:19,332 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:19,797 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:19,807 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:20,783 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:20,793 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:20,912 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:20,922 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:22,53 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:22,67 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:22,472 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:22,483 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:22,942 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:22,969 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:23,128 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:23,140 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:23,719 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:23,746 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:23,817 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:23,827 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:24,437 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:24,464 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:25,32 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:25,62 INFO     [learner.py:606] ====Pushing takes 0.027043819427490234 s
2021-08-18:16:32:25,99 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:25,109 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:25,110 INFO     [param_server.py:410] Lock worker 1 with localStep 285 , while globalStep is 284

2021-08-18:16:32:25,264 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:25,278 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:26,509 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:26,527 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:26,539 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:26,549 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:27,168 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:27,185 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:28,338 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:28,350 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:28,767 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:28,782 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:28,946 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:28,975 INFO     [learner.py:606] ====Pushing takes 0.027646780014038086 s
2021-08-18:16:32:29,8 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:29,16 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:29,16 INFO     [param_server.py:410] Lock worker 3 with localStep 285 , while globalStep is 284

2021-08-18:16:32:29,613 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:29,636 INFO     [learner.py:606] ====Pushing takes 0.02235889434814453 s
2021-08-18:16:32:29,666 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:29,673 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:29,674 INFO     [param_server.py:381] ====After aggregation in epoch: 284, virtual_clock: 10835.34870037073, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.2070432680624505, test len: 3099.0
2021-08-18:16:32:29,676 INFO     [param_server.py:410] Lock worker 2 with localStep 285 , while globalStep is 285

2021-08-18:16:32:29,677 INFO     [param_server.py:441] ====Epoch 286 completes 20 clients with loss 139.87937872347746, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:29,677 INFO     [param_server.py:450] ====Start to sample for epoch 286, global virtualClock: 10835.34870037073, round_duration: 57.6461879098304
2021-08-18:16:32:29,678 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:29,941 INFO     [param_server.py:553] For epoch: 286, median_reward: 336.58605798290205, dev: 336.58605798290205
2021-08-18:16:32:30,621 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7567, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:32:30,622 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3814.1223, eval_time 0.6474, test_loss 2.7567, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:32:30,657 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6625, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:32:30,658 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3814.1579, eval_time 0.6831, test_loss 2.6625, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:32:30,697 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:30,701 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8087, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:32:30,702 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3814.2007, eval_time 0.7277, test_loss 2.8087, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:32:30,714 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:30,727 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:30,741 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:30,772 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:30,792 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:32,83 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:32,92 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:32,567 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:32,576 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:33,557 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:33,568 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:33,843 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:33,857 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:35,102 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:35,122 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:35,164 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:35,184 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:35,858 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:35,868 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:35,938 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:35,959 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:36,542 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:36,553 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:36,558 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:36,577 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:37,131 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:37,145 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:37,715 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:37,742 INFO     [learner.py:606] ====Pushing takes 0.025160789489746094 s
2021-08-18:16:32:37,789 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:37,798 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:37,799 INFO     [param_server.py:410] Lock worker 1 with localStep 286 , while globalStep is 285

2021-08-18:16:32:38,71 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:38,90 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:39,173 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:39,185 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:39,219 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:39,229 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:39,874 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:39,886 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:41,13 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:41,25 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:41,494 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:41,507 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:41,704 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:41,734 INFO     [learner.py:606] ====Pushing takes 0.028650999069213867 s
2021-08-18:16:32:41,772 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:41,780 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:41,781 INFO     [param_server.py:410] Lock worker 3 with localStep 286 , while globalStep is 285

2021-08-18:16:32:42,216 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:42,238 INFO     [learner.py:606] ====Pushing takes 0.021336078643798828 s
2021-08-18:16:32:42,264 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:42,271 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:42,271 INFO     [param_server.py:381] ====After aggregation in epoch: 285, virtual_clock: 10892.99488828056, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 2.7426755153746516, test len: 3099.0
2021-08-18:16:32:42,274 INFO     [param_server.py:410] Lock worker 2 with localStep 286 , while globalStep is 286

2021-08-18:16:32:42,274 INFO     [param_server.py:441] ====Epoch 287 completes 20 clients with loss 125.38369825347047, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:42,274 INFO     [param_server.py:450] ====Start to sample for epoch 287, global virtualClock: 10892.99488828056, round_duration: 57.6461879098304
2021-08-18:16:32:42,275 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:42,551 INFO     [param_server.py:553] For epoch: 287, median_reward: 354.89952087478656, dev: 354.89952087478656
2021-08-18:16:32:43,245 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7966, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:32:43,246 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3826.7467, eval_time 0.6504, test_loss 2.7966, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:32:43,264 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6232, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:32:43,265 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3826.7653, eval_time 0.6687, test_loss 2.6232, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:32:43,319 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:32:43,334 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:43,336 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0456, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:32:43,339 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:32:43,339 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3826.8375, eval_time 0.7428, test_loss 3.0456, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:32:43,347 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:43,414 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:32:43,430 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:44,683 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:44,724 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:45,0 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:45,10 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:46,103 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:46,113 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:46,410 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:46,431 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:47,732 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:47,746 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:47,762 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:47,771 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:48,480 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:48,498 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:48,615 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:48,624 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:49,67 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:49,84 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:49,281 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:49,292 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:49,665 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:49,678 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:50,286 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:50,314 INFO     [learner.py:606] ====Pushing takes 0.026332378387451172 s
2021-08-18:16:32:50,356 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:50,368 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:50,369 INFO     [param_server.py:410] Lock worker 1 with localStep 287 , while globalStep is 286

2021-08-18:16:32:50,562 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:50,571 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:51,748 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:51,757 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:51,985 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:51,994 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:52,713 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:52,723 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:54,3 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:54,15 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:54,112 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:54,130 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:54,653 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:54,681 INFO     [learner.py:606] ====Pushing takes 0.027168989181518555 s
2021-08-18:16:32:54,719 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:54,727 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:54,727 INFO     [param_server.py:410] Lock worker 3 with localStep 287 , while globalStep is 286

2021-08-18:16:32:54,882 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:54,904 INFO     [learner.py:606] ====Pushing takes 0.021094322204589844 s
2021-08-18:16:32:54,932 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:54,943 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:54,944 INFO     [param_server.py:381] ====After aggregation in epoch: 286, virtual_clock: 10950.64107619039, top_1: : 64.5047 % (1999.0), top_5: : 100.0 % (3099.0), test loss: 2.8217955430348716, test len: 3099.0
2021-08-18:16:32:54,946 INFO     [param_server.py:410] Lock worker 2 with localStep 287 , while globalStep is 287

2021-08-18:16:32:54,947 INFO     [param_server.py:441] ====Epoch 288 completes 20 clients with loss 161.82050934272763, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:54,947 INFO     [param_server.py:450] ====Start to sample for epoch 288, global virtualClock: 10950.64107619039, round_duration: 57.6461879098304
2021-08-18:16:32:54,948 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:55,290 INFO     [param_server.py:553] For epoch: 288, median_reward: 357.233309792507, dev: 357.233309792507
2021-08-18:16:32:55,948 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4338, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:32:55,948 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3839.4487, eval_time 0.6026, test_loss 2.4338, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:32:55,951 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8995, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:32:55,952 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3839.4523, eval_time 0.6068, test_loss 2.8995, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:32:56,19 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:32:56,23 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:32:56,38 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:56,38 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:56,62 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9043, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:32:56,63 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3839.562, eval_time 0.7182, test_loss 2.9043, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:32:56,131 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:32:56,156 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:57,556 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:57,577 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:57,784 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:57,798 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:58,937 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:58,949 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:59,531 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:59,551 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:00,705 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:00,716 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:00,784 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:00,796 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:01,339 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:01,350 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:01,363 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:01,372 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:01,923 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:01,935 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:01,944 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:01,954 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:02,474 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:02,486 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:03,34 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:03,61 INFO     [learner.py:606] ====Pushing takes 0.026228904724121094 s
2021-08-18:16:33:03,108 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:03,117 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:03,117 INFO     [param_server.py:410] Lock worker 1 with localStep 288 , while globalStep is 287

2021-08-18:16:33:03,336 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:03,348 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:04,553 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:04,562 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:04,603 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:04,614 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:05,160 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:05,169 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:06,416 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:06,426 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:06,870 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:06,885 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:07,15 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:07,43 INFO     [learner.py:606] ====Pushing takes 0.02753472328186035 s
2021-08-18:16:33:07,73 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:07,81 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:07,82 INFO     [param_server.py:410] Lock worker 3 with localStep 288 , while globalStep is 287

2021-08-18:16:33:07,672 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:07,699 INFO     [learner.py:606] ====Pushing takes 0.025257349014282227 s
2021-08-18:16:33:07,725 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:07,732 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:07,733 INFO     [param_server.py:381] ====After aggregation in epoch: 287, virtual_clock: 11008.28726410022, top_1: : 66.3763 % (2057.0), top_5: : 100.0 % (3099.0), test loss: 2.7458370813617, test len: 3099.0
2021-08-18:16:33:07,735 INFO     [param_server.py:410] Lock worker 2 with localStep 288 , while globalStep is 288

2021-08-18:16:33:07,735 INFO     [param_server.py:441] ====Epoch 289 completes 20 clients with loss 149.5375870911565, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:07,736 INFO     [param_server.py:450] ====Start to sample for epoch 289, global virtualClock: 11008.28726410022, round_duration: 57.6461879098304
2021-08-18:16:33:07,737 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:08,63 INFO     [param_server.py:553] For epoch: 289, median_reward: 343.66084202226943, dev: 343.66084202226943
2021-08-18:16:33:08,653 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6879, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:33:08,654 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3852.1546, eval_time 0.5348, test_loss 2.6879, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:33:08,689 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0767, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:33:08,690 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3852.1901, eval_time 0.5705, test_loss 3.0767, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:33:08,720 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:08,733 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:08,755 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:08,782 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:08,806 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6923, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:33:08,808 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3852.3063, eval_time 0.6895, test_loss 2.6923, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:33:08,874 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:08,909 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:10,237 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:10,257 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:10,650 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:10,665 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:11,705 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:11,716 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:11,969 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:11,978 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:13,263 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:13,276 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:13,444 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:13,457 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:13,983 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:13,992 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:14,145 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:14,155 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:14,648 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:14,658 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:14,779 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:14,789 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:15,236 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:15,248 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:15,901 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:15,928 INFO     [learner.py:606] ====Pushing takes 0.0251004695892334 s
2021-08-18:16:33:15,971 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:15,980 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:15,981 INFO     [param_server.py:410] Lock worker 1 with localStep 289 , while globalStep is 288

2021-08-18:16:33:16,145 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:16,156 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:17,253 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:17,263 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:17,514 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:17,524 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:18,175 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:18,187 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:19,403 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:19,412 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:19,584 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:19,604 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:20,24 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:20,53 INFO     [learner.py:606] ====Pushing takes 0.027513504028320312 s
2021-08-18:16:33:20,92 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:20,100 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:20,100 INFO     [param_server.py:410] Lock worker 3 with localStep 289 , while globalStep is 288

2021-08-18:16:33:20,460 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:20,483 INFO     [learner.py:606] ====Pushing takes 0.02135753631591797 s
2021-08-18:16:33:20,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:20,514 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:20,515 INFO     [param_server.py:381] ====After aggregation in epoch: 288, virtual_clock: 11065.93345201005, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 2.818967966845742, test len: 3099.0
2021-08-18:16:33:20,519 INFO     [param_server.py:410] Lock worker 2 with localStep 289 , while globalStep is 289

2021-08-18:16:33:20,520 INFO     [param_server.py:441] ====Epoch 290 completes 20 clients with loss 114.35968921190602, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:20,520 INFO     [param_server.py:450] ====Start to sample for epoch 290, global virtualClock: 11065.93345201005, round_duration: 57.6461879098304
2021-08-18:16:33:20,521 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:20,852 INFO     [param_server.py:553] For epoch: 290, median_reward: 338.23751047635494, dev: 338.23751047635494
2021-08-18:16:33:21,499 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9268, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:33:21,500 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3865.0008, eval_time 0.5865, test_loss 2.9268, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:33:21,543 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0362, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:33:21,544 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3865.0444, eval_time 0.6303, test_loss 3.0362, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:33:21,570 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:21,586 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:21,612 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:21,618 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7602, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:33:21,622 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3865.1206, eval_time 0.7144, test_loss 3.7602, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:33:21,635 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:21,696 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:21,724 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:22,998 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:23,17 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:23,323 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:23,333 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:24,373 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:24,387 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:24,913 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:24,923 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:26,34 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:26,43 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:26,93 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:26,103 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:26,655 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:26,667 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:26,678 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:26,688 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:27,310 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:27,324 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:27,396 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:27,406 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:28,15 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:28,34 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:28,557 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:28,570 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:28,620 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:28,647 INFO     [learner.py:606] ====Pushing takes 0.025265932083129883 s
2021-08-18:16:33:28,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:28,701 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:28,702 INFO     [param_server.py:410] Lock worker 1 with localStep 290 , while globalStep is 289

2021-08-18:16:33:29,779 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:29,797 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:30,103 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:30,113 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:30,748 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:30,757 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:32,14 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:32,25 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:32,590 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:32,597 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:32,617 INFO     [learner.py:606] ====Pushing takes 0.026727676391601562 s
2021-08-18:16:33:32,618 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:32,655 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:32,663 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:32,663 INFO     [param_server.py:410] Lock worker 3 with localStep 290 , while globalStep is 289

2021-08-18:16:33:33,380 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:33,403 INFO     [learner.py:606] ====Pushing takes 0.021854400634765625 s
2021-08-18:16:33:33,437 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:33,444 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:33,445 INFO     [param_server.py:381] ====After aggregation in epoch: 289, virtual_clock: 11123.579639919879, top_1: : 63.6657 % (1973.0), top_5: : 100.0 % (3099.0), test loss: 3.2410457664065895, test len: 3099.0
2021-08-18:16:33:33,448 INFO     [param_server.py:410] Lock worker 2 with localStep 290 , while globalStep is 290

2021-08-18:16:33:33,448 INFO     [param_server.py:441] ====Epoch 291 completes 20 clients with loss 91.33254353833787, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:33,449 INFO     [param_server.py:450] ====Start to sample for epoch 291, global virtualClock: 11123.579639919879, round_duration: 57.6461879098304
2021-08-18:16:33:33,450 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:33,798 INFO     [param_server.py:553] For epoch: 291, median_reward: 334.01856381381157, dev: 334.01856381381157
2021-08-18:16:33:34,509 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8805, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:33:34,513 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3878.0139, eval_time 0.6704, test_loss 2.8805, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:33:34,534 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1026, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:33:34,535 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3878.035, eval_time 0.6916, test_loss 3.1026, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:33:34,583 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:33:34,589 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8443, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:33:34,589 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3878.0881, eval_time 0.7464, test_loss 2.8443, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:33:34,602 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:34,616 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:33:34,635 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:34,671 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:33:34,689 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:35,884 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:35,898 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:36,140 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:36,150 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:37,172 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:37,186 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:37,777 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:37,786 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:38,873 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:38,883 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:38,950 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:38,970 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:39,494 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:39,505 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:39,691 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:39,710 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:40,124 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:40,133 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:40,349 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:40,363 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:40,983 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:41,11 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:41,644 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:41,659 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:41,661 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:41,686 INFO     [learner.py:606] ====Pushing takes 0.023691177368164062 s
2021-08-18:16:33:41,736 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:41,743 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:41,744 INFO     [param_server.py:410] Lock worker 1 with localStep 291 , while globalStep is 290

2021-08-18:16:33:42,753 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:42,763 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:43,43 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:43,61 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:43,418 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:43,428 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:44,667 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:44,678 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:45,217 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:45,247 INFO     [learner.py:606] ====Pushing takes 0.029087066650390625 s
2021-08-18:16:33:45,270 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:45,284 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:45,287 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:45,296 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:45,297 INFO     [param_server.py:410] Lock worker 3 with localStep 291 , while globalStep is 290

2021-08-18:16:33:46,53 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:46,74 INFO     [learner.py:606] ====Pushing takes 0.020140647888183594 s
2021-08-18:16:33:46,106 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:46,113 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:46,114 INFO     [param_server.py:381] ====After aggregation in epoch: 290, virtual_clock: 11181.225827829709, top_1: : 67.0862 % (2079.0), top_5: : 100.0 % (3099.0), test loss: 2.9424534727025917, test len: 3099.0
2021-08-18:16:33:46,116 INFO     [param_server.py:410] Lock worker 2 with localStep 291 , while globalStep is 291

2021-08-18:16:33:46,117 INFO     [param_server.py:441] ====Epoch 292 completes 20 clients with loss 97.87990956624586, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:46,117 INFO     [param_server.py:450] ====Start to sample for epoch 292, global virtualClock: 11181.225827829709, round_duration: 57.6461879098304
2021-08-18:16:33:46,118 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:46,442 INFO     [param_server.py:553] For epoch: 292, median_reward: 332.891087571933, dev: 332.891087571933
2021-08-18:16:33:47,76 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7879, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:33:47,77 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3890.5775, eval_time 0.5907, test_loss 2.7879, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:33:47,119 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8015, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:33:47,120 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3890.6209, eval_time 0.6334, test_loss 2.8015, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:33:47,163 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:33:47,178 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:47,192 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:33:47,204 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.137, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:33:47,206 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3890.7043, eval_time 0.7194, test_loss 3.137, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:33:47,214 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:47,276 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:33:47,304 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:48,729 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:48,743 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:48,970 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:48,979 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:50,84 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:50,93 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:50,620 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:50,634 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:51,480 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:51,491 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:51,702 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:51,722 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:52,234 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:52,243 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:52,439 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:52,460 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:52,913 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:52,928 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:53,102 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:53,123 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:53,867 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:53,888 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:54,408 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:54,422 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:54,530 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:54,558 INFO     [learner.py:606] ====Pushing takes 0.026360034942626953 s
2021-08-18:16:33:54,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:54,608 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:54,608 INFO     [param_server.py:410] Lock worker 1 with localStep 292 , while globalStep is 291

2021-08-18:16:33:55,624 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:55,634 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:55,698 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:55,709 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:56,322 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:56,331 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:57,427 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:57,437 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:57,936 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:57,959 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:58,150 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:58,179 INFO     [learner.py:606] ====Pushing takes 0.028062105178833008 s
2021-08-18:16:33:58,218 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:58,226 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:58,228 INFO     [param_server.py:410] Lock worker 3 with localStep 292 , while globalStep is 291

2021-08-18:16:33:58,701 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:58,728 INFO     [learner.py:606] ====Pushing takes 0.025846242904663086 s
2021-08-18:16:33:58,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:58,760 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:58,775 INFO     [param_server.py:381] ====After aggregation in epoch: 291, virtual_clock: 11238.872015739538, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.9088138430206865, test len: 3099.0
2021-08-18:16:33:58,777 INFO     [param_server.py:410] Lock worker 2 with localStep 292 , while globalStep is 292

2021-08-18:16:33:58,777 INFO     [param_server.py:441] ====Epoch 293 completes 20 clients with loss 52.669288147771994, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:58,778 INFO     [param_server.py:450] ====Start to sample for epoch 293, global virtualClock: 11238.872015739538, round_duration: 57.6461879098304
2021-08-18:16:33:58,779 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:59,70 INFO     [param_server.py:553] For epoch: 293, median_reward: 322.5477729513197, dev: 322.5477729513197
2021-08-18:16:33:59,670 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7057, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:33:59,671 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3903.1717, eval_time 0.5494, test_loss 2.7057, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:33:59,700 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7624, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:33:59,701 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3903.2011, eval_time 0.5815, test_loss 2.7624, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:33:59,738 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:33:59,752 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:59,775 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:33:59,790 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:59,795 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9841, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:33:59,798 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3903.2969, eval_time 0.6831, test_loss 2.9841, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:33:59,867 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:33:59,890 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:01,165 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:01,185 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:01,466 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:01,476 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:02,529 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:02,543 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:03,114 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:03,135 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:04,122 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:04,142 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:04,433 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:04,454 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:04,630 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:04,640 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:05,280 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:05,289 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:05,295 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:05,298 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:06,25 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:06,43 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:06,622 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:06,634 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:07,44 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:07,55 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:07,229 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:07,256 INFO     [learner.py:606] ====Pushing takes 0.025127172470092773 s
2021-08-18:16:34:07,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:07,308 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:07,308 INFO     [param_server.py:410] Lock worker 1 with localStep 293 , while globalStep is 292

2021-08-18:16:34:07,994 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:08,7 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:08,352 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:08,361 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:08,686 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:08,697 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:09,833 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:09,842 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:10,370 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:10,400 INFO     [learner.py:606] ====Pushing takes 0.02842402458190918 s
2021-08-18:16:34:10,441 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:10,449 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:10,450 INFO     [param_server.py:410] Lock worker 3 with localStep 293 , while globalStep is 292

2021-08-18:16:34:10,781 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:10,796 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:11,631 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:11,653 INFO     [learner.py:606] ====Pushing takes 0.021156787872314453 s
2021-08-18:16:34:11,685 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:11,692 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:11,693 INFO     [param_server.py:381] ====After aggregation in epoch: 292, virtual_clock: 11296.518203649368, top_1: : 66.828 % (2071.0), top_5: : 100.0 % (3099.0), test loss: 2.817418606192977, test len: 3099.0
2021-08-18:16:34:11,695 INFO     [param_server.py:410] Lock worker 2 with localStep 293 , while globalStep is 293

2021-08-18:16:34:11,696 INFO     [param_server.py:441] ====Epoch 294 completes 20 clients with loss 222.40589928357213, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:11,696 INFO     [param_server.py:450] ====Start to sample for epoch 294, global virtualClock: 11296.518203649368, round_duration: 57.6461879098304
2021-08-18:16:34:11,697 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:12,32 INFO     [param_server.py:553] For epoch: 294, median_reward: 365.27962163761947, dev: 365.27962163761947
2021-08-18:16:34:12,696 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6374, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:34:12,697 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3916.1976, eval_time 0.6076, test_loss 2.6374, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:34:12,702 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8236, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:34:12,703 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3916.2038, eval_time 0.6159, test_loss 2.8236, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:34:12,764 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:12,770 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:12,776 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:12,783 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:12,813 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8553, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:34:12,813 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3916.3119, eval_time 0.7259, test_loss 2.8553, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:34:12,883 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:12,916 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:14,231 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:14,251 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:14,391 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:14,409 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:15,454 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:15,468 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:16,363 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:16,377 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:17,376 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:17,390 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:17,459 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:17,477 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:17,814 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:17,824 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:18,61 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:18,76 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:18,589 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:18,598 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:18,643 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:18,653 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:19,346 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:19,356 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:19,873 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:19,899 INFO     [learner.py:606] ====Pushing takes 0.024999380111694336 s
2021-08-18:16:34:19,941 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:19,950 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:19,950 INFO     [param_server.py:410] Lock worker 1 with localStep 294 , while globalStep is 293

2021-08-18:16:34:20,59 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:20,68 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:21,291 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:21,301 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:21,319 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:21,330 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:21,995 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:22,5 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:23,125 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:23,138 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:23,634 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:23,648 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:23,790 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:23,816 INFO     [learner.py:606] ====Pushing takes 0.024867773056030273 s
2021-08-18:16:34:23,854 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:23,864 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:23,865 INFO     [param_server.py:410] Lock worker 3 with localStep 294 , while globalStep is 293

2021-08-18:16:34:24,356 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:24,376 INFO     [learner.py:606] ====Pushing takes 0.018718957901000977 s
2021-08-18:16:34:24,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:24,409 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:24,409 INFO     [param_server.py:381] ====After aggregation in epoch: 293, virtual_clock: 11354.164391559198, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.772115429242452, test len: 3099.0
2021-08-18:16:34:24,413 INFO     [param_server.py:410] Lock worker 2 with localStep 294 , while globalStep is 294

2021-08-18:16:34:24,413 INFO     [param_server.py:441] ====Epoch 295 completes 20 clients with loss 77.1702690772878, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:24,413 INFO     [param_server.py:450] ====Start to sample for epoch 295, global virtualClock: 11354.164391559198, round_duration: 57.6461879098304
2021-08-18:16:34:24,414 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:24,747 INFO     [param_server.py:553] For epoch: 295, median_reward: 324.43608514188105, dev: 324.43608514188105
2021-08-18:16:34:25,418 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7666, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:34:25,419 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3928.9199, eval_time 0.6169, test_loss 2.7666, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:34:25,422 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8855, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:34:25,423 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3928.9238, eval_time 0.6203, test_loss 2.8855, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:34:25,474 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:25,477 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:25,493 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:25,495 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:25,549 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7345, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:34:25,549 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3929.048, eval_time 0.7473, test_loss 2.7345, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:34:25,621 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:25,659 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:27,93 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:27,119 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:27,383 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:27,400 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:28,379 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:28,401 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:28,971 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:28,980 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:30,172 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:30,182 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:30,229 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:30,238 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:30,834 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:30,843 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:30,898 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:30,909 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:31,473 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:31,485 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:31,517 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:31,527 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:32,21 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:32,30 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:32,574 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:32,600 INFO     [learner.py:606] ====Pushing takes 0.024721384048461914 s
2021-08-18:16:34:32,643 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:32,651 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:32,652 INFO     [param_server.py:410] Lock worker 1 with localStep 295 , while globalStep is 294

2021-08-18:16:34:32,898 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:32,913 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:34,93 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:34,103 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:34,131 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:34,142 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:34,703 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:34,713 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:35,876 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:35,889 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:36,290 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:36,305 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:36,405 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:36,434 INFO     [learner.py:606] ====Pushing takes 0.02839183807373047 s
2021-08-18:16:34:36,473 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:36,480 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:36,481 INFO     [param_server.py:410] Lock worker 3 with localStep 295 , while globalStep is 294

2021-08-18:16:34:37,159 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:37,182 INFO     [learner.py:606] ====Pushing takes 0.021314144134521484 s
2021-08-18:16:34:37,207 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:37,214 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:37,215 INFO     [param_server.py:381] ====After aggregation in epoch: 294, virtual_clock: 11411.810579469027, top_1: : 67.1507 % (2081.0), top_5: : 100.0 % (3099.0), test loss: 2.795529661355195, test len: 3099.0
2021-08-18:16:34:37,217 INFO     [param_server.py:410] Lock worker 2 with localStep 295 , while globalStep is 295

2021-08-18:16:34:37,217 INFO     [param_server.py:441] ====Epoch 296 completes 20 clients with loss 78.24833566000358, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:37,218 INFO     [param_server.py:450] ====Start to sample for epoch 296, global virtualClock: 11411.810579469027, round_duration: 57.6461879098304
2021-08-18:16:34:37,219 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:37,551 INFO     [param_server.py:553] For epoch: 296, median_reward: 325.04558779968306, dev: 325.04558779968306
2021-08-18:16:34:38,179 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4503, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:34:38,182 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3941.6828, eval_time 0.5654, test_loss 2.4503, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:34:38,259 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9418, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:34:38,260 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3941.7603, eval_time 0.643, test_loss 2.9418, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:34:38,261 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:34:38,281 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:38,327 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:34:38,353 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:38,355 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0865, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:34:38,358 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3941.8568, eval_time 0.7412, test_loss 3.0865, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:34:38,423 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:34:38,455 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:39,788 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:39,802 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:40,170 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:40,179 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:41,195 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:41,209 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:41,594 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:41,604 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:42,723 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:42,732 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:42,974 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:42,985 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:43,356 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:43,365 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:43,439 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:43,449 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:43,986 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:43,996 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:44,111 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:44,121 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:44,553 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:44,567 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:45,138 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:45,163 INFO     [learner.py:606] ====Pushing takes 0.024512767791748047 s
2021-08-18:16:34:45,194 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:45,204 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:45,205 INFO     [param_server.py:410] Lock worker 1 with localStep 296 , while globalStep is 295

2021-08-18:16:34:45,704 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:45,713 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:46,847 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:46,856 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:46,895 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:46,904 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:47,656 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:47,667 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:48,833 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:48,842 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:49,490 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:49,498 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:49,511 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:49,530 INFO     [learner.py:606] ====Pushing takes 0.031030893325805664 s
2021-08-18:16:34:49,569 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:49,579 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:49,580 INFO     [param_server.py:410] Lock worker 3 with localStep 296 , while globalStep is 295

2021-08-18:16:34:50,235 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:50,259 INFO     [learner.py:606] ====Pushing takes 0.021871328353881836 s
2021-08-18:16:34:50,283 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:50,290 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:50,291 INFO     [param_server.py:381] ====After aggregation in epoch: 295, virtual_clock: 11469.456767378857, top_1: : 66.1504 % (2050.0), top_5: : 100.0 % (3099.0), test loss: 2.8262135552035432, test len: 3099.0
2021-08-18:16:34:50,293 INFO     [param_server.py:410] Lock worker 2 with localStep 296 , while globalStep is 296

2021-08-18:16:34:50,294 INFO     [param_server.py:441] ====Epoch 297 completes 20 clients with loss 135.17138039376218, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:50,294 INFO     [param_server.py:450] ====Start to sample for epoch 297, global virtualClock: 11469.456767378857, round_duration: 57.6461879098304
2021-08-18:16:34:50,295 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:50,593 INFO     [param_server.py:553] For epoch: 297, median_reward: 326.74399678049133, dev: 326.74399678049133
2021-08-18:16:34:51,328 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8968, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:34:51,354 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3954.8546, eval_time 0.7165, test_loss 2.8968, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:34:51,389 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7371, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:34:51,390 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3954.8909, eval_time 0.7522, test_loss 2.7371, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:34:51,423 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:34:51,437 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:51,460 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:34:51,464 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1537, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:34:51,465 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3954.9634, eval_time 0.827, test_loss 3.1537, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:34:51,476 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:51,561 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:34:51,591 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:52,969 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:52,977 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:52,986 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:52,993 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:54,102 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:54,120 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:54,720 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:54,731 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:55,592 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:55,602 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:55,949 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:55,964 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:56,320 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:56,330 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:56,758 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:56,772 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:57,27 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:57,38 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:57,514 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:57,535 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:58,132 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:58,158 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:58,266 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:58,278 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:58,711 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:58,739 INFO     [learner.py:606] ====Pushing takes 0.026178598403930664 s
2021-08-18:16:34:58,780 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:58,788 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:58,789 INFO     [param_server.py:410] Lock worker 1 with localStep 297 , while globalStep is 296

2021-08-18:16:34:59,640 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:59,660 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:59,695 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:59,704 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:00,278 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:00,292 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:01,537 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:01,549 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:02,61 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:02,69 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:02,75 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:02,98 INFO     [learner.py:606] ====Pushing takes 0.027634382247924805 s
2021-08-18:16:35:02,139 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:02,147 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:02,148 INFO     [param_server.py:410] Lock worker 3 with localStep 297 , while globalStep is 296

2021-08-18:16:35:02,811 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:02,834 INFO     [learner.py:606] ====Pushing takes 0.02145528793334961 s
2021-08-18:16:35:02,859 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:02,869 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:02,870 INFO     [param_server.py:381] ====After aggregation in epoch: 296, virtual_clock: 11527.102955288687, top_1: : 65.5373 % (2031.0), top_5: : 100.0 % (3099.0), test loss: 2.9292344782087536, test len: 3099.0
2021-08-18:16:35:02,872 INFO     [param_server.py:410] Lock worker 2 with localStep 297 , while globalStep is 297

2021-08-18:16:35:02,872 INFO     [param_server.py:441] ====Epoch 298 completes 20 clients with loss 125.66897792928972, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:02,872 INFO     [param_server.py:450] ====Start to sample for epoch 298, global virtualClock: 11527.102955288687, round_duration: 57.6461879098304
2021-08-18:16:35:02,873 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:03,166 INFO     [param_server.py:553] For epoch: 298, median_reward: 328.440873974063, dev: 328.440873974063
2021-08-18:16:35:03,751 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8937, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:35:03,753 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3967.2534, eval_time 0.5379, test_loss 2.8937, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:35:03,756 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7803, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:35:03,757 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3967.2576, eval_time 0.5423, test_loss 2.7803, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:35:03,825 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:03,828 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9167, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:35:03,829 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3967.3276, eval_time 0.6182, test_loss 2.9167, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:35:03,842 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:03,843 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:03,857 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:03,907 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:03,933 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:05,198 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:05,216 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:05,527 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:05,537 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:06,609 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:06,624 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:06,978 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:06,992 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:08,94 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:08,121 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:08,175 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:08,188 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:08,804 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:08,824 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:09,77 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:09,89 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:09,577 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:09,597 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:09,857 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:09,867 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:10,259 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:10,279 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:10,878 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:10,903 INFO     [learner.py:606] ====Pushing takes 0.024330854415893555 s
2021-08-18:16:35:10,918 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:10,936 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:10,944 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:10,952 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:10,952 INFO     [param_server.py:410] Lock worker 1 with localStep 298 , while globalStep is 297

2021-08-18:16:35:12,282 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:12,300 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:12,645 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:12,655 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:13,258 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:13,274 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:14,643 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:14,657 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:14,662 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:14,671 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:15,345 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:15,389 INFO     [learner.py:606] ====Pushing takes 0.04313206672668457 s
2021-08-18:16:35:15,428 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:15,435 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:15,436 INFO     [param_server.py:410] Lock worker 3 with localStep 298 , while globalStep is 297

2021-08-18:16:35:15,471 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:15,493 INFO     [learner.py:606] ====Pushing takes 0.020882606506347656 s
2021-08-18:16:35:15,518 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:15,526 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:15,526 INFO     [param_server.py:381] ====After aggregation in epoch: 297, virtual_clock: 11584.749143198516, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 2.863557974497477, test len: 3099.0
2021-08-18:16:35:15,529 INFO     [param_server.py:410] Lock worker 2 with localStep 298 , while globalStep is 298

2021-08-18:16:35:15,529 INFO     [param_server.py:441] ====Epoch 299 completes 20 clients with loss 135.61589315693473, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:15,530 INFO     [param_server.py:450] ====Start to sample for epoch 299, global virtualClock: 11584.749143198516, round_duration: 57.6461879098304
2021-08-18:16:35:15,531 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:15,795 INFO     [param_server.py:553] For epoch: 299, median_reward: 351.0615522130467, dev: 351.0615522130467
2021-08-18:16:35:16,474 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7965, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:35:16,475 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3979.9752, eval_time 0.6441, test_loss 2.7965, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:35:16,478 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0779, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:35:16,479 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3979.979, eval_time 0.6492, test_loss 3.0779, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:35:16,548 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:16,552 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:16,560 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:16,564 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:16,573 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.996, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:35:16,574 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3980.0722, eval_time 0.7442, test_loss 2.996, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:35:16,652 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:16,679 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:18,57 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:18,71 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:18,218 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:18,228 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:19,226 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:19,240 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:19,965 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:19,992 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:20,766 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:20,776 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:21,332 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:21,353 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:21,428 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:21,438 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:22,11 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:22,20 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:22,50 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:22,71 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:22,801 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:22,822 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:23,512 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:23,530 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:23,624 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:23,642 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:24,42 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:24,70 INFO     [learner.py:606] ====Pushing takes 0.026142597198486328 s
2021-08-18:16:35:24,112 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:24,125 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:24,126 INFO     [param_server.py:410] Lock worker 1 with localStep 299 , while globalStep is 298

2021-08-18:16:35:24,668 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:24,677 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:24,868 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:24,878 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:25,343 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:25,353 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:26,527 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:26,539 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:27,131 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:27,164 INFO     [learner.py:606] ====Pushing takes 0.031334877014160156 s
2021-08-18:16:35:27,198 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:27,206 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:27,207 INFO     [param_server.py:410] Lock worker 3 with localStep 299 , while globalStep is 298

2021-08-18:16:35:27,260 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:27,300 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:28,108 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:28,134 INFO     [learner.py:606] ====Pushing takes 0.021368026733398438 s
2021-08-18:16:35:28,172 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:28,178 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:28,179 INFO     [param_server.py:381] ====After aggregation in epoch: 298, virtual_clock: 11642.395331108346, top_1: : 66.4408 % (2059.0), top_5: : 100.0 % (3099.0), test loss: 2.9567960191656044, test len: 3099.0
2021-08-18:16:35:28,182 INFO     [param_server.py:410] Lock worker 2 with localStep 299 , while globalStep is 299

2021-08-18:16:35:28,183 INFO     [param_server.py:441] ====Epoch 300 completes 20 clients with loss 128.20886551136104, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:28,183 INFO     [param_server.py:450] ====Start to sample for epoch 300, global virtualClock: 11642.395331108346, round_duration: 57.6461879098304
2021-08-18:16:35:28,184 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:28,499 INFO     [param_server.py:553] For epoch: 300, median_reward: 335.0346430406266, dev: 335.0346430406266
2021-08-18:16:35:29,43 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6824, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:35:29,46 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3992.5461, eval_time 0.5097, test_loss 2.6824, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:35:29,70 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.895, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:35:29,72 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3992.572, eval_time 0.5377, test_loss 2.895, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:35:29,112 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:29,119 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:29,139 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:29,155 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:29,180 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1946, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:35:29,181 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3992.6793, eval_time 0.6467, test_loss 3.1946, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:35:29,249 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:29,275 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:30,602 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:30,629 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:30,984 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:30,993 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:31,949 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:31,967 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:32,708 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:32,735 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:33,531 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:33,545 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:34,32 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:34,45 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:34,449 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:34,460 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:34,691 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:34,709 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:35,158 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:35,172 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:35,278 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:35,297 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:35,859 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:35,869 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:36,293 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:36,304 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:36,386 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:36,414 INFO     [learner.py:606] ====Pushing takes 0.026732206344604492 s
2021-08-18:16:35:36,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:36,470 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:36,471 INFO     [param_server.py:410] Lock worker 1 with localStep 300 , while globalStep is 299

2021-08-18:16:35:37,618 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:37,628 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:37,888 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:37,899 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:38,627 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:38,640 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:39,755 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:39,764 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:39,834 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:39,849 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:40,418 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:40,449 INFO     [learner.py:606] ====Pushing takes 0.029672622680664062 s
2021-08-18:16:35:40,465 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:40,492 INFO     [learner.py:606] ====Pushing takes 0.025722742080688477 s
2021-08-18:16:35:40,491 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:40,501 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:40,502 INFO     [param_server.py:410] Lock worker 3 with localStep 300 , while globalStep is 299

2021-08-18:16:35:40,521 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:40,528 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:40,529 INFO     [param_server.py:381] ====After aggregation in epoch: 299, virtual_clock: 11700.041519018176, top_1: : 63.7302 % (1975.0), top_5: : 100.0 % (3099.0), test loss: 2.9240359950948647, test len: 3099.0
2021-08-18:16:35:40,532 INFO     [param_server.py:410] Lock worker 2 with localStep 300 , while globalStep is 300

2021-08-18:16:35:40,532 INFO     [param_server.py:441] ====Epoch 301 completes 20 clients with loss 206.79563328295433, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:40,533 INFO     [param_server.py:450] ====Start to sample for epoch 301, global virtualClock: 11700.041519018176, round_duration: 57.6461879098304
2021-08-18:16:35:40,534 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:40,825 INFO     [param_server.py:541] Handle Wight 0.029923200607299805 | Send 0.2918434143066406
2021-08-18:16:35:40,826 INFO     [param_server.py:553] For epoch: 301, median_reward: 337.2937798438562, dev: 337.2937798438562
2021-08-18:16:35:41,626 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0521, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:35:41,626 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4005.1268, eval_time 0.7569, test_loss 3.0521, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:35:41,632 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6064, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:35:41,633 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4005.1332, eval_time 0.7609, test_loss 2.6064, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:35:41,693 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:35:41,701 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:35:41,706 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:41,706 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9248, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:35:41,709 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4005.2075, eval_time 0.8394, test_loss 2.9248, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:35:41,714 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:41,777 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:35:41,802 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:43,549 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:43,576 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:43,600 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:43,613 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:44,573 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:44,582 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:45,384 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:45,405 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:46,225 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:46,236 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:46,247 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:46,258 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:46,963 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:46,974 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:46,999 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:47,8 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:47,633 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:47,644 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:47,704 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:47,714 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:48,306 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:48,331 INFO     [learner.py:606] ====Pushing takes 0.023907184600830078 s
2021-08-18:16:35:48,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:48,384 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:35:48,385 INFO     [param_server.py:410] Lock worker 1 with localStep 301 , while globalStep is 300

2021-08-18:16:35:49,46 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:49,56 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:50,265 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:50,276 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:50,493 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:50,506 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:51,233 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:51,246 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:52,485 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:52,499 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:52,622 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:52,636 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:53,181 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:53,194 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:53,204 INFO     [learner.py:606] ====Pushing takes 0.021205902099609375 s
2021-08-18:16:35:53,239 INFO     [learner.py:606] ====Pushing takes 0.04387497901916504 s
2021-08-18:16:35:53,242 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:53,250 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 12 clients
2021-08-18:16:35:53,251 INFO     [param_server.py:410] Lock worker 2 with localStep 301 , while globalStep is 300

2021-08-18:16:35:53,275 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:53,282 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:35:53,283 INFO     [param_server.py:381] ====After aggregation in epoch: 300, virtual_clock: 11760.931600334467, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 2.8610962496863475, test len: 3099.0
2021-08-18:16:35:53,285 INFO     [param_server.py:410] Lock worker 3 with localStep 301 , while globalStep is 301

2021-08-18:16:35:53,286 INFO     [param_server.py:441] ====Epoch 302 completes 19 clients with loss 157.5665147081526, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:53,287 INFO     [param_server.py:450] ====Start to sample for epoch 302, global virtualClock: 11760.931600334467, round_duration: 60.89008131629102
2021-08-18:16:35:53,287 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:53,571 INFO     [param_server.py:553] For epoch: 302, median_reward: 357.80105663021, dev: 357.80105663021
2021-08-18:16:35:54,160 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1103, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:35:54,161 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4017.6609, eval_time 0.5545, test_loss 3.1103, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:35:54,166 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6203, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:35:54,167 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4017.6672, eval_time 0.5596, test_loss 2.6203, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:35:54,228 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:35:54,239 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:54,253 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:35:54,262 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:54,289 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.135, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:35:54,290 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4017.7884, eval_time 0.6852, test_loss 3.135, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:35:54,360 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:35:54,384 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:55,913 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:55,940 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:56,183 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:56,197 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:57,66 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:57,81 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:57,933 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:57,974 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:58,684 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:58,698 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:58,924 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:58,938 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:59,330 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:59,344 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:59,581 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:59,590 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:59,965 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:59,983 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:00,308 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:00,317 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:00,671 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:00,695 INFO     [learner.py:606] ====Pushing takes 0.022381305694580078 s
2021-08-18:16:36:00,734 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:00,744 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:36:00,745 INFO     [param_server.py:410] Lock worker 1 with localStep 302 , while globalStep is 301

2021-08-18:16:36:01,710 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:01,744 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:03,42 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:03,53 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:03,209 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:03,219 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:03,913 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:03,923 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:05,55 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:05,68 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:05,480 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:05,489 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:05,689 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:05,731 INFO     [learner.py:606] ====Pushing takes 0.04105234146118164 s
2021-08-18:16:36:05,772 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:05,780 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 13 clients
2021-08-18:16:36:05,781 INFO     [param_server.py:410] Lock worker 3 with localStep 302 , while globalStep is 301

2021-08-18:16:36:06,107 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:06,130 INFO     [learner.py:606] ====Pushing takes 0.021279573440551758 s
2021-08-18:16:36:06,157 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:06,164 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:36:06,164 INFO     [param_server.py:381] ====After aggregation in epoch: 301, virtual_clock: 11821.821681650757, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 2.955211573176914, test len: 3099.0
2021-08-18:16:36:06,167 INFO     [param_server.py:410] Lock worker 2 with localStep 302 , while globalStep is 302

2021-08-18:16:36:06,168 INFO     [param_server.py:441] ====Epoch 303 completes 19 clients with loss 168.33021611218743, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:06,169 INFO     [param_server.py:450] ====Start to sample for epoch 303, global virtualClock: 11821.821681650757, round_duration: 60.89008131629102
2021-08-18:16:36:06,170 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:36:06,510 INFO     [param_server.py:553] For epoch: 303, median_reward: 353.7420151836832, dev: 353.7420151836832
2021-08-18:16:36:07,140 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6148, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:36:07,142 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4030.6421, eval_time 0.5864, test_loss 2.6148, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:36:07,144 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8718, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:36:07,145 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4030.6449, eval_time 0.5894, test_loss 2.8718, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:36:07,211 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:07,211 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:07,219 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:07,224 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:07,306 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7822, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:36:07,307 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4030.8058, eval_time 0.7519, test_loss 2.7822, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:36:07,398 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:07,426 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:08,956 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:08,983 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:09,308 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:09,328 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:10,1 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:10,19 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:11,96 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:11,116 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:11,887 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:11,907 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:12,0 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:12,31 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:12,582 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:12,596 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:12,731 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:12,746 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:13,184 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:13,202 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:13,450 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:13,459 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:13,834 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:13,858 INFO     [learner.py:606] ====Pushing takes 0.022298574447631836 s
2021-08-18:16:36:13,893 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:13,901 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:36:13,901 INFO     [param_server.py:410] Lock worker 1 with localStep 303 , while globalStep is 302

2021-08-18:16:36:14,798 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:14,807 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:16,115 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:16,125 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:16,150 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:16,160 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:16,822 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:16,833 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:18,402 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:18,411 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:18,432 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:18,455 INFO     [learner.py:606] ====Pushing takes 0.019138336181640625 s
2021-08-18:16:36:18,483 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:18,492 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:36:18,493 INFO     [param_server.py:410] Lock worker 2 with localStep 303 , while globalStep is 302

2021-08-18:16:36:18,949 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:18,978 INFO     [learner.py:606] ====Pushing takes 0.027953147888183594 s
2021-08-18:16:36:19,25 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:19,33 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:36:19,34 INFO     [param_server.py:381] ====After aggregation in epoch: 302, virtual_clock: 11885.95565637351, top_1: : 66.9248 % (2074.0), top_5: : 100.0 % (3099.0), test loss: 2.756255046774944, test len: 3099.0
2021-08-18:16:36:19,36 INFO     [param_server.py:410] Lock worker 3 with localStep 303 , while globalStep is 303

2021-08-18:16:36:19,37 INFO     [param_server.py:441] ====Epoch 304 completes 18 clients with loss 195.74005801288814, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:36:19,38 INFO     [param_server.py:450] ====Start to sample for epoch 304, global virtualClock: 11885.95565637351, round_duration: 64.13397472275163
2021-08-18:16:36:19,39 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:36:19,375 INFO     [param_server.py:553] For epoch: 304, median_reward: 356.631397606713, dev: 356.631397606713
2021-08-18:16:36:20,82 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7477, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:36:20,83 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4043.5837, eval_time 0.6475, test_loss 2.7477, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:36:20,119 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0776, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:36:20,120 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4043.6207, eval_time 0.6865, test_loss 3.0776, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:36:20,154 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:20,167 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:20,184 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:20,198 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9877, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:36:20,199 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4043.6981, eval_time 0.7686, test_loss 2.9877, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:36:20,200 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:20,320 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:20,349 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:21,896 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:21,922 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:22,140 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:22,154 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:23,6 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:23,20 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:23,954 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:23,968 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:24,627 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:24,641 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:24,833 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:24,843 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:25,340 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:25,354 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:25,481 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:25,495 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:25,998 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:26,7 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:26,174 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:26,183 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:26,556 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:26,580 INFO     [learner.py:606] ====Pushing takes 0.022612571716308594 s
2021-08-18:16:36:26,654 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:26,662 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:36:26,663 INFO     [param_server.py:410] Lock worker 1 with localStep 304 , while globalStep is 303

2021-08-18:16:36:27,564 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:27,577 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:28,835 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:28,846 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:28,851 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:28,855 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:29,636 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:29,645 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:31,238 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:31,262 INFO     [learner.py:606] ====Pushing takes 0.021889686584472656 s
2021-08-18:16:36:31,294 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:31,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:31,300 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:36:31,300 INFO     [param_server.py:410] Lock worker 2 with localStep 304 , while globalStep is 303

2021-08-18:16:36:31,312 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:31,986 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:32,15 INFO     [learner.py:606] ====Pushing takes 0.027675390243530273 s
2021-08-18:16:36:32,47 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:32,56 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:36:32,57 INFO     [param_server.py:381] ====After aggregation in epoch: 303, virtual_clock: 11950.089631096262, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.9376668113249322, test len: 3099.0
2021-08-18:16:36:32,60 INFO     [param_server.py:410] Lock worker 3 with localStep 304 , while globalStep is 304

2021-08-18:16:36:32,60 INFO     [param_server.py:441] ====Epoch 305 completes 18 clients with loss 220.16637960195789, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:36:32,60 INFO     [param_server.py:450] ====Start to sample for epoch 305, global virtualClock: 11950.089631096262, round_duration: 64.13397472275163
2021-08-18:16:36:32,62 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:36:32,403 INFO     [param_server.py:553] For epoch: 305, median_reward: 348.4910670058506, dev: 348.4910670058506
2021-08-18:16:36:33,61 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0863, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:36:33,65 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4056.5652, eval_time 0.6275, test_loss 3.0863, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:36:33,75 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6905, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:36:33,76 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4056.5765, eval_time 0.6339, test_loss 2.6905, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:36:33,102 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8548, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:36:33,105 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4056.6036, eval_time 0.668, test_loss 2.8548, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:36:33,136 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:33,144 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:33,150 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:33,159 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:33,195 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:33,211 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:34,417 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:34,437 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:34,883 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:34,897 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:35,708 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:35,722 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:36,488 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:36,501 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:37,160 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:37,175 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:37,676 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:37,686 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:37,858 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:37,873 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:38,4 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:38,22 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:38,615 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:38,633 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:38,756 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:38,766 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:39,274 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:39,300 INFO     [learner.py:606] ====Pushing takes 0.024366140365600586 s
2021-08-18:16:36:39,364 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:39,375 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:36:39,376 INFO     [param_server.py:410] Lock worker 1 with localStep 305 , while globalStep is 304

2021-08-18:16:36:40,398 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:40,410 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:41,568 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:41,572 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:41,578 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:41,581 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:42,267 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:42,278 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:43,955 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:43,976 INFO     [learner.py:606] ====Pushing takes 0.019681453704833984 s
2021-08-18:16:36:44,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:44,13 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:36:44,14 INFO     [param_server.py:410] Lock worker 2 with localStep 305 , while globalStep is 304

2021-08-18:16:36:44,124 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:44,134 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:44,804 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:44,832 INFO     [learner.py:606] ====Pushing takes 0.027098894119262695 s
2021-08-18:16:36:44,861 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:44,868 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:36:44,869 INFO     [param_server.py:381] ====After aggregation in epoch: 304, virtual_clock: 12014.223605819014, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 2.877188285191854, test len: 3099.0
2021-08-18:16:36:44,871 INFO     [param_server.py:410] Lock worker 3 with localStep 305 , while globalStep is 305

2021-08-18:16:36:44,872 INFO     [param_server.py:441] ====Epoch 306 completes 18 clients with loss 101.92293617793415, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:36:44,872 INFO     [param_server.py:450] ====Start to sample for epoch 306, global virtualClock: 12014.223605819014, round_duration: 64.13397472275163
2021-08-18:16:36:44,873 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:36:45,207 INFO     [param_server.py:553] For epoch: 306, median_reward: 340.01681250223487, dev: 340.01681250223487
2021-08-18:16:36:45,834 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9367, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:36:45,835 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4069.3353, eval_time 0.593, test_loss 2.9367, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:36:45,877 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6582, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:36:45,878 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4069.3785, eval_time 0.6343, test_loss 2.6582, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:36:45,901 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:36:45,910 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8953, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:36:45,911 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4069.4094, eval_time 0.6694, test_loss 2.8953, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:36:45,915 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:45,947 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:36:45,964 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:45,992 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:36:46,9 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:47,380 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:47,401 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:47,711 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:47,729 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:48,626 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:48,648 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:49,555 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:49,575 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:50,328 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:50,342 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:50,411 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:50,431 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:51,210 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:51,230 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:51,295 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:51,310 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:51,904 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:51,918 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:52,22 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:52,34 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:52,441 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:52,465 INFO     [learner.py:606] ====Pushing takes 0.02293562889099121 s
2021-08-18:16:36:52,504 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:52,511 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:36:52,512 INFO     [param_server.py:410] Lock worker 1 with localStep 306 , while globalStep is 305

2021-08-18:16:36:52,988 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:52,999 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:54,382 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:54,395 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:54,591 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:54,600 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:55,349 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:55,358 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:56,723 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:56,744 INFO     [learner.py:606] ====Pushing takes 0.01918482780456543 s
2021-08-18:16:36:56,779 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:56,791 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:36:56,791 INFO     [param_server.py:410] Lock worker 2 with localStep 306 , while globalStep is 305

2021-08-18:16:36:57,2 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:57,14 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:57,598 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:57,627 INFO     [learner.py:606] ====Pushing takes 0.028298377990722656 s
2021-08-18:16:36:57,660 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:57,668 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:36:57,668 INFO     [param_server.py:381] ====After aggregation in epoch: 305, virtual_clock: 12078.357580541766, top_1: : 65.989 % (2045.0), top_5: : 100.0 % (3099.0), test loss: 2.8300735773863614, test len: 3099.0
2021-08-18:16:36:57,671 INFO     [param_server.py:410] Lock worker 3 with localStep 306 , while globalStep is 306

2021-08-18:16:36:57,671 INFO     [param_server.py:441] ====Epoch 307 completes 18 clients with loss 111.23575013127157, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:36:57,672 INFO     [param_server.py:450] ====Start to sample for epoch 307, global virtualClock: 12078.357580541766, round_duration: 64.13397472275163
2021-08-18:16:36:57,673 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:36:58,11 INFO     [param_server.py:553] For epoch: 307, median_reward: 329.4116264225979, dev: 329.4116264225979
2021-08-18:16:36:58,634 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8179, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:36:58,635 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4082.1356, eval_time 0.5915, test_loss 2.8179, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:36:58,661 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6432, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:36:58,662 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4082.1628, eval_time 0.6182, test_loss 2.6432, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:36:58,699 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:36:58,715 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:58,730 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:36:58,746 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:58,750 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9321, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:36:58,752 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4082.2502, eval_time 0.7078, test_loss 2.9321, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:36:58,845 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:36:58,869 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:00,402 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:00,429 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:00,637 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:00,651 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:01,635 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:01,654 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:02,504 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:02,525 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:03,261 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:03,274 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:03,315 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:03,336 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:04,53 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:04,58 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:04,69 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:04,72 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:04,673 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:04,686 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:04,718 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:04,727 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:05,179 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:05,205 INFO     [learner.py:606] ====Pushing takes 0.024332523345947266 s
2021-08-18:16:37:05,243 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:05,250 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:05,251 INFO     [param_server.py:410] Lock worker 1 with localStep 307 , while globalStep is 306

2021-08-18:16:37:06,47 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:06,65 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:07,258 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:07,268 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:07,305 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:07,314 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:07,994 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:08,3 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:09,503 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:09,527 INFO     [learner.py:606] ====Pushing takes 0.01958632469177246 s
2021-08-18:16:37:09,557 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:09,563 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:37:09,563 INFO     [param_server.py:410] Lock worker 2 with localStep 307 , while globalStep is 306

2021-08-18:16:37:09,579 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:09,589 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:10,381 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:10,410 INFO     [learner.py:606] ====Pushing takes 0.027641773223876953 s
2021-08-18:16:37:10,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:10,463 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:37:10,464 INFO     [param_server.py:381] ====After aggregation in epoch: 306, virtual_clock: 12142.491555264518, top_1: : 67.0862 % (2079.0), top_5: : 100.0 % (3099.0), test loss: 2.7977591973763922, test len: 3099.0
2021-08-18:16:37:10,466 INFO     [param_server.py:410] Lock worker 3 with localStep 307 , while globalStep is 307

2021-08-18:16:37:10,467 INFO     [param_server.py:441] ====Epoch 308 completes 18 clients with loss 156.70483520131924, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:37:10,467 INFO     [param_server.py:450] ====Start to sample for epoch 308, global virtualClock: 12142.491555264518, round_duration: 64.13397472275163
2021-08-18:16:37:10,468 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:10,743 INFO     [param_server.py:553] For epoch: 308, median_reward: 354.11431937300614, dev: 354.11431937300614
2021-08-18:16:37:11,267 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8314, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:37:11,268 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4094.7685, eval_time 0.4809, test_loss 2.8314, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:37:11,337 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:11,355 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7971, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:37:11,359 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:11,360 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4094.8603, eval_time 0.5684, test_loss 2.7971, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:37:11,393 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6835, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:37:11,397 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4094.8957, eval_time 0.6099, test_loss 2.6835, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:37:11,428 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:11,444 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:11,468 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:11,494 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:12,829 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:12,849 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:13,122 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:13,137 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:14,143 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:14,153 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:14,854 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:14,874 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:15,613 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:15,634 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:15,963 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:15,973 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:16,372 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:16,393 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:16,525 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:16,539 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:17,106 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:17,120 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:17,202 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:17,211 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:17,716 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:17,739 INFO     [learner.py:606] ====Pushing takes 0.0221712589263916 s
2021-08-18:16:37:17,773 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:17,783 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:17,784 INFO     [param_server.py:410] Lock worker 1 with localStep 308 , while globalStep is 307

2021-08-18:16:37:18,790 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:18,803 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:20,39 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:20,47 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:20,50 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:20,60 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:20,827 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:20,840 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:22,220 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:22,240 INFO     [learner.py:606] ====Pushing takes 0.018857717514038086 s
2021-08-18:16:37:22,275 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:22,280 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:37:22,281 INFO     [param_server.py:410] Lock worker 2 with localStep 308 , while globalStep is 307

2021-08-18:16:37:22,431 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:22,440 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:23,103 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:23,135 INFO     [learner.py:606] ====Pushing takes 0.02839183807373047 s
2021-08-18:16:37:23,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:23,172 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:37:23,173 INFO     [param_server.py:381] ====After aggregation in epoch: 307, virtual_clock: 12206.62552998727, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 2.770683839365288, test len: 3099.0
2021-08-18:16:37:23,175 INFO     [param_server.py:410] Lock worker 3 with localStep 308 , while globalStep is 308

2021-08-18:16:37:23,175 INFO     [param_server.py:441] ====Epoch 309 completes 18 clients with loss 82.7082129316038, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:37:23,176 INFO     [param_server.py:450] ====Start to sample for epoch 309, global virtualClock: 12206.62552998727, round_duration: 64.13397472275163
2021-08-18:16:37:23,177 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:23,507 INFO     [param_server.py:553] For epoch: 309, median_reward: 347.8735473400858, dev: 347.8735473400858
2021-08-18:16:37:24,216 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8941, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:37:24,217 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4107.7173, eval_time 0.6751, test_loss 2.8941, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:37:24,222 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5977, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:37:24,224 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4107.724, eval_time 0.6816, test_loss 2.5977, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:37:24,272 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0784, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:37:24,273 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4107.7716, eval_time 0.7326, test_loss 3.0784, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:37:24,288 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:24,295 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:24,296 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:24,303 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:24,357 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:24,378 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:26,20 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:26,47 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:26,216 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:26,235 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:27,62 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:27,72 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:28,312 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:28,336 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:29,181 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:29,199 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:29,212 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:29,239 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:29,619 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:29,640 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:29,871 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:29,891 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:30,449 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:30,468 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:30,477 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:30,491 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:31,43 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:31,67 INFO     [learner.py:606] ====Pushing takes 0.022235870361328125 s
2021-08-18:16:37:31,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:31,109 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:31,109 INFO     [param_server.py:410] Lock worker 1 with localStep 309 , while globalStep is 308

2021-08-18:16:37:31,792 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:31,803 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:33,7 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:33,18 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:33,270 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:33,279 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:34,110 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:34,119 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:35,252 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:35,272 INFO     [learner.py:606] ====Pushing takes 0.01909804344177246 s
2021-08-18:16:37:35,301 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:35,309 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:37:35,309 INFO     [param_server.py:410] Lock worker 2 with localStep 309 , while globalStep is 308

2021-08-18:16:37:35,839 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:35,849 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:36,564 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:36,591 INFO     [learner.py:606] ====Pushing takes 0.026401519775390625 s
2021-08-18:16:37:36,630 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:36,637 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:37:36,638 INFO     [param_server.py:381] ====After aggregation in epoch: 308, virtual_clock: 12270.759504710022, top_1: : 66.9248 % (2074.0), top_5: : 100.0 % (3099.0), test loss: 2.856733154367518, test len: 3099.0
2021-08-18:16:37:36,641 INFO     [param_server.py:410] Lock worker 3 with localStep 309 , while globalStep is 309

2021-08-18:16:37:36,642 INFO     [param_server.py:441] ====Epoch 310 completes 18 clients with loss 79.0287082004802, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:37:36,642 INFO     [param_server.py:450] ====Start to sample for epoch 310, global virtualClock: 12270.759504710022, round_duration: 64.13397472275163
2021-08-18:16:37:36,643 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:36,918 INFO     [param_server.py:553] For epoch: 310, median_reward: 330.91489496683465, dev: 330.91489496683465
2021-08-18:16:37:37,540 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6289, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:37:37,540 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7184, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:37:37,541 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4121.0417, eval_time 0.5794, test_loss 2.6289, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:37:37,541 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4121.0417, eval_time 0.5795, test_loss 2.7184, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:37:37,610 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:37:37,613 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:37:37,616 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7756, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:37:37,617 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4121.1154, eval_time 0.655, test_loss 2.7756, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:37:37,618 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:37,620 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:37,698 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:37:37,716 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:39,223 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:39,256 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:39,566 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:39,585 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:40,691 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:40,709 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:41,305 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:41,326 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:42,72 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:42,86 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:42,388 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:42,403 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:42,781 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:42,795 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:43,88 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:43,102 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:43,400 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:43,414 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:43,759 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:43,768 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:44,14 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:44,40 INFO     [learner.py:606] ====Pushing takes 0.024064302444458008 s
2021-08-18:16:37:44,77 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:44,84 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:44,84 INFO     [param_server.py:410] Lock worker 1 with localStep 310 , while globalStep is 309

2021-08-18:16:37:45,77 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:45,86 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:46,346 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:46,357 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:46,481 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:46,491 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:47,131 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:47,141 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:48,509 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:48,532 INFO     [learner.py:606] ====Pushing takes 0.019255399703979492 s
2021-08-18:16:37:48,563 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:48,569 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:37:48,570 INFO     [param_server.py:410] Lock worker 2 with localStep 310 , while globalStep is 309

2021-08-18:16:37:48,898 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:48,913 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:49,700 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:49,730 INFO     [learner.py:606] ====Pushing takes 0.02794051170349121 s
2021-08-18:16:37:49,762 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:49,769 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:37:49,770 INFO     [param_server.py:381] ====After aggregation in epoch: 309, virtual_clock: 12334.893479432774, top_1: : 65.4405 % (2028.0), top_5: : 100.0 % (3099.0), test loss: 2.707652776329606, test len: 3099.0
2021-08-18:16:37:49,773 INFO     [param_server.py:410] Lock worker 3 with localStep 310 , while globalStep is 310

2021-08-18:16:37:49,773 INFO     [param_server.py:441] ====Epoch 311 completes 18 clients with loss 92.38689725914425, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:37:49,774 INFO     [param_server.py:450] ====Start to sample for epoch 311, global virtualClock: 12334.893479432774, round_duration: 64.13397472275163
2021-08-18:16:37:49,775 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:50,111 INFO     [param_server.py:553] For epoch: 311, median_reward: 334.0763693769208, dev: 334.0763693769208
2021-08-18:16:37:50,774 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.853, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:37:50,775 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4134.2757, eval_time 0.628, test_loss 2.853, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:37:50,829 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4592, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:37:50,830 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4134.3303, eval_time 0.6781, test_loss 2.4592, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:37:50,847 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:37:50,850 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.61, Top-1 Accuracy: 723.0/1033 (0.6999), Top-5 Accuracy: 1.0
2021-08-18:16:37:50,851 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4134.3497, eval_time 0.7044, test_loss 2.61, test_accuracy 0.6999, test_5_accuracy 1.0 

2021-08-18:16:37:50,862 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:50,903 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:37:50,916 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:50,922 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:37:50,950 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:52,441 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:52,463 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:52,528 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:52,541 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:53,520 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:53,531 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:54,471 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:54,485 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:55,164 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:55,178 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:55,360 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:55,373 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:55,917 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:55,930 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:55,938 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:55,939 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:56,635 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:56,650 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:56,696 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:56,705 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:57,269 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:57,293 INFO     [learner.py:606] ====Pushing takes 0.022754430770874023 s
2021-08-18:16:37:57,328 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:57,340 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:57,340 INFO     [param_server.py:410] Lock worker 1 with localStep 311 , while globalStep is 310

2021-08-18:16:37:58,126 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:58,169 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:59,472 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:59,481 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:59,507 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:59,525 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:00,247 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:00,262 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:01,639 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:01,662 INFO     [learner.py:606] ====Pushing takes 0.020060062408447266 s
2021-08-18:16:38:01,692 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:01,701 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:01,702 INFO     [param_server.py:410] Lock worker 2 with localStep 311 , while globalStep is 310

2021-08-18:16:38:01,992 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:02,4 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:02,592 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:02,623 INFO     [learner.py:606] ====Pushing takes 0.028444290161132812 s
2021-08-18:16:38:02,659 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:02,667 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:02,668 INFO     [param_server.py:381] ====After aggregation in epoch: 310, virtual_clock: 12399.027454155526, top_1: : 67.5702 % (2094.0), top_5: : 100.0 % (3099.0), test loss: 2.640722475670002, test len: 3099.0
2021-08-18:16:38:02,670 INFO     [param_server.py:410] Lock worker 3 with localStep 311 , while globalStep is 311

2021-08-18:16:38:02,671 INFO     [param_server.py:441] ====Epoch 312 completes 18 clients with loss 66.67203894928889, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:02,671 INFO     [param_server.py:450] ====Start to sample for epoch 312, global virtualClock: 12399.027454155526, round_duration: 64.13397472275163
2021-08-18:16:38:02,672 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:02,954 INFO     [param_server.py:553] For epoch: 312, median_reward: 329.4206849186841, dev: 329.4206849186841
2021-08-18:16:38:03,601 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8474, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:38:03,605 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4147.1055, eval_time 0.6278, test_loss 2.8474, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:38:03,612 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9702, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:38:03,613 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4147.1134, eval_time 0.6329, test_loss 2.9702, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:38:03,635 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8658, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:38:03,638 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4147.1366, eval_time 0.6611, test_loss 2.8658, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:38:03,683 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:03,690 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:03,699 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:03,704 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:03,711 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:03,718 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:05,22 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:05,43 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:05,424 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:05,438 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:06,256 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:06,266 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:07,181 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:07,208 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:07,988 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:08,8 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:08,306 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:08,324 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:08,664 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:08,685 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:08,712 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:08,726 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:09,364 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:09,378 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:09,500 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:09,514 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:09,983 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:10,6 INFO     [learner.py:606] ====Pushing takes 0.022182464599609375 s
2021-08-18:16:38:10,41 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:10,49 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:10,49 INFO     [param_server.py:410] Lock worker 1 with localStep 312 , while globalStep is 311

2021-08-18:16:38:11,128 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:11,140 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:12,277 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:12,286 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:12,316 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:12,328 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:13,18 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:13,32 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:14,430 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:14,457 INFO     [learner.py:606] ====Pushing takes 0.025818586349487305 s
2021-08-18:16:38:14,486 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:14,495 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:14,496 INFO     [param_server.py:410] Lock worker 2 with localStep 312 , while globalStep is 311

2021-08-18:16:38:14,708 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:14,718 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:15,371 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:15,401 INFO     [learner.py:606] ====Pushing takes 0.028736591339111328 s
2021-08-18:16:38:15,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:15,442 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:15,443 INFO     [param_server.py:381] ====After aggregation in epoch: 311, virtual_clock: 12463.161428878278, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 2.8944887496806957, test len: 3099.0
2021-08-18:16:38:15,445 INFO     [param_server.py:410] Lock worker 3 with localStep 312 , while globalStep is 312

2021-08-18:16:38:15,445 INFO     [param_server.py:441] ====Epoch 313 completes 18 clients with loss 62.95755218800988, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:15,446 INFO     [param_server.py:450] ====Start to sample for epoch 313, global virtualClock: 12463.161428878278, round_duration: 64.13397472275163
2021-08-18:16:38:15,446 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:15,736 INFO     [param_server.py:553] For epoch: 313, median_reward: 322.1074137922587, dev: 322.1074137922587
2021-08-18:16:38:16,437 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1197, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:38:16,438 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4159.9388, eval_time 0.6676, test_loss 3.1197, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:38:16,448 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7458, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:38:16,449 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4159.9496, eval_time 0.6777, test_loss 2.7458, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:38:16,515 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:16,518 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0117, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:38:16,519 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:16,519 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4160.0178, eval_time 0.7485, test_loss 3.0117, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:38:16,523 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:16,528 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:16,590 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:16,607 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:18,116 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:18,152 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:18,373 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:18,393 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:19,444 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:19,462 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:20,269 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:20,296 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:21,40 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:21,67 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:21,168 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:21,182 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:21,742 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:21,756 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:21,876 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:21,894 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:22,358 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:22,368 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:22,491 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:22,501 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:22,985 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:23,9 INFO     [learner.py:606] ====Pushing takes 0.02254509925842285 s
2021-08-18:16:38:23,47 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:23,54 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:23,55 INFO     [param_server.py:410] Lock worker 1 with localStep 313 , while globalStep is 312

2021-08-18:16:38:23,858 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:23,870 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:25,72 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:25,82 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:25,172 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:25,181 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:25,801 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:25,811 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:27,269 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:27,289 INFO     [learner.py:606] ====Pushing takes 0.018900632858276367 s
2021-08-18:16:38:27,314 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:27,321 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:27,322 INFO     [param_server.py:410] Lock worker 2 with localStep 313 , while globalStep is 312

2021-08-18:16:38:27,492 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:27,511 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:28,191 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:28,222 INFO     [learner.py:606] ====Pushing takes 0.02815699577331543 s
2021-08-18:16:38:28,253 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:28,265 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:28,266 INFO     [param_server.py:381] ====After aggregation in epoch: 312, virtual_clock: 12527.29540360103, top_1: : 67.4088 % (2089.0), top_5: : 100.0 % (3099.0), test loss: 2.959056637905262, test len: 3099.0
2021-08-18:16:38:28,269 INFO     [param_server.py:410] Lock worker 3 with localStep 313 , while globalStep is 313

2021-08-18:16:38:28,269 INFO     [param_server.py:441] ====Epoch 314 completes 18 clients with loss 68.43140359653844, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:28,270 INFO     [param_server.py:450] ====Start to sample for epoch 314, global virtualClock: 12527.29540360103, round_duration: 64.13397472275163
2021-08-18:16:38:28,270 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:28,536 INFO     [param_server.py:553] For epoch: 314, median_reward: 335.15391768835104, dev: 335.15391768835104
2021-08-18:16:38:29,145 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8742, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:38:29,150 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4172.6505, eval_time 0.5946, test_loss 2.8742, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:38:29,184 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.918, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:38:29,185 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4172.6835, eval_time 0.6294, test_loss 2.918, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:38:29,188 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6417, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:38:29,189 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4172.6898, eval_time 0.6248, test_loss 2.6417, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:38:29,218 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:29,225 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:29,250 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:29,259 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:29,263 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:29,273 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:30,870 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:30,897 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:31,411 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:31,432 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:32,133 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:32,142 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:33,379 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:33,401 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:34,187 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:34,201 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:34,369 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:34,388 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:34,548 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:34,559 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:34,786 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:34,801 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:35,311 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:35,321 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:35,582 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:35,596 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:35,675 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:35,684 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:36,201 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:36,225 INFO     [learner.py:606] ====Pushing takes 0.02271747589111328 s
2021-08-18:16:38:36,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:36,269 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:38:36,270 INFO     [param_server.py:410] Lock worker 1 with localStep 314 , while globalStep is 313

2021-08-18:16:38:37,954 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:37,973 INFO     [learner.py:606] ====Pushing takes 0.016895294189453125 s
2021-08-18:16:38:37,990 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:37,995 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:38:37,995 INFO     [param_server.py:410] Lock worker 2 with localStep 314 , while globalStep is 313

2021-08-18:16:38:38,69 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:38,108 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:38,961 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:38,975 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:40,823 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:40,841 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:41,676 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:41,705 INFO     [learner.py:606] ====Pushing takes 0.028217315673828125 s
2021-08-18:16:38:41,742 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:41,750 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:38:41,751 INFO     [param_server.py:381] ====After aggregation in epoch: 313, virtual_clock: 12594.673271730242, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 2.8112936064049054, test len: 3099.0
2021-08-18:16:38:41,754 INFO     [param_server.py:410] Lock worker 3 with localStep 314 , while globalStep is 314

2021-08-18:16:38:41,754 INFO     [param_server.py:441] ====Epoch 315 completes 17 clients with loss 98.95911562913606, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:38:41,754 INFO     [param_server.py:450] ====Start to sample for epoch 315, global virtualClock: 12594.673271730242, round_duration: 67.37786812921225
2021-08-18:16:38:41,755 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:42,75 INFO     [param_server.py:553] For epoch: 315, median_reward: 333.40667880662113, dev: 333.40667880662113
2021-08-18:16:38:42,722 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7096, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:38:42,723 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4186.2234, eval_time 0.6255, test_loss 2.7096, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:38:42,728 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5005, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:38:42,729 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4186.2297, eval_time 0.6316, test_loss 2.5005, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:38:42,795 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9563, Top-1 Accuracy: 716.0/1033 (0.6931), Top-5 Accuracy: 1.0
2021-08-18:16:38:42,795 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:38:42,795 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4186.2939, eval_time 0.6977, test_loss 2.9563, test_accuracy 0.6931, test_5_accuracy 1.0 

2021-08-18:16:38:42,800 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:38:42,804 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:42,809 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:42,864 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:38:42,885 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:44,354 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:44,375 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:44,982 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:44,996 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:45,450 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:45,461 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:46,910 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:46,937 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:47,720 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:47,738 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:47,771 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:47,791 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:47,798 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:47,818 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:48,451 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:48,462 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:48,527 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:48,536 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:49,56 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:49,67 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:49,111 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:49,121 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:49,742 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:49,764 INFO     [learner.py:606] ====Pushing takes 0.020589590072631836 s
2021-08-18:16:38:49,791 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:49,798 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:38:49,799 INFO     [param_server.py:410] Lock worker 1 with localStep 315 , while globalStep is 314

2021-08-18:16:38:51,313 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:51,330 INFO     [learner.py:606] ====Pushing takes 0.015067815780639648 s
2021-08-18:16:38:51,347 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:51,352 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:38:51,353 INFO     [param_server.py:410] Lock worker 2 with localStep 315 , while globalStep is 314

2021-08-18:16:38:51,457 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:51,472 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:52,160 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:52,169 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:53,896 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:53,910 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:54,519 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:54,546 INFO     [learner.py:606] ====Pushing takes 0.026586532592773438 s
2021-08-18:16:38:54,576 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:54,587 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:38:54,587 INFO     [param_server.py:381] ====After aggregation in epoch: 314, virtual_clock: 12662.051139859454, top_1: : 67.2798 % (2085.0), top_5: : 100.0 % (3099.0), test loss: 2.722095039155748, test len: 3099.0
2021-08-18:16:38:54,590 INFO     [param_server.py:410] Lock worker 3 with localStep 315 , while globalStep is 315

2021-08-18:16:38:54,590 INFO     [param_server.py:441] ====Epoch 316 completes 17 clients with loss 97.82821917562275, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:38:54,590 INFO     [param_server.py:450] ====Start to sample for epoch 316, global virtualClock: 12662.051139859454, round_duration: 67.37786812921225
2021-08-18:16:38:54,591 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:54,927 INFO     [param_server.py:553] For epoch: 316, median_reward: 344.7756809147011, dev: 344.7756809147011
2021-08-18:16:38:55,463 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6401, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:38:55,467 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4198.9677, eval_time 0.5065, test_loss 3.6401, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:38:55,467 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3346, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:38:55,468 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4198.9686, eval_time 0.5066, test_loss 4.3346, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:38:55,538 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:38:55,541 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:38:55,546 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:55,549 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:55,570 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3733, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:38:55,571 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4199.0699, eval_time 0.6114, test_loss 3.3733, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:38:55,641 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:38:55,667 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:57,219 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:57,245 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:57,514 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:57,529 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:58,189 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:58,202 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:59,878 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:59,906 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:00,520 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:00,534 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:00,643 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:00,663 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:00,861 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:00,880 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:01,488 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:01,502 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:01,722 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:01,737 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:01,743 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:01,757 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:02,154 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:02,163 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:02,792 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:02,816 INFO     [learner.py:606] ====Pushing takes 0.021928787231445312 s
2021-08-18:16:39:02,849 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:02,857 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:02,857 INFO     [param_server.py:410] Lock worker 1 with localStep 316 , while globalStep is 315

2021-08-18:16:39:03,895 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:03,911 INFO     [learner.py:606] ====Pushing takes 0.014687061309814453 s
2021-08-18:16:39:03,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:03,932 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:03,934 INFO     [param_server.py:410] Lock worker 2 with localStep 316 , while globalStep is 315

2021-08-18:16:39:04,435 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:04,445 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:05,141 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:05,151 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:06,833 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:06,845 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:07,626 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:07,656 INFO     [learner.py:606] ====Pushing takes 0.02884960174560547 s
2021-08-18:16:39:07,693 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:07,707 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:07,707 INFO     [param_server.py:381] ====After aggregation in epoch: 315, virtual_clock: 12729.429007988665, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 3.7826751470565796, test len: 3099.0
2021-08-18:16:39:07,710 INFO     [param_server.py:410] Lock worker 3 with localStep 316 , while globalStep is 316

2021-08-18:16:39:07,711 INFO     [param_server.py:441] ====Epoch 317 completes 17 clients with loss 135.47895086352614, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:07,711 INFO     [param_server.py:450] ====Start to sample for epoch 317, global virtualClock: 12729.429007988665, round_duration: 67.37786812921225
2021-08-18:16:39:07,712 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:08,66 INFO     [param_server.py:553] For epoch: 317, median_reward: 340.3870010985435, dev: 340.3870010985435
2021-08-18:16:39:08,652 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1106, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:39:08,653 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4212.1537, eval_time 0.5636, test_loss 3.1106, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:39:08,677 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6133, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:39:08,679 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4212.1791, eval_time 0.5882, test_loss 2.6133, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:39:08,746 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:08,749 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:08,755 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:08,761 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9095, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:39:08,764 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4212.2627, eval_time 0.6764, test_loss 2.9095, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:39:08,758 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:08,857 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:08,877 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:10,502 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:10,529 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:10,763 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:10,777 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:11,538 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:11,554 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:13,111 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:13,131 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:13,666 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:13,684 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:13,787 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:13,801 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:14,18 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:14,37 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:14,489 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:14,500 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:14,775 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:14,784 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:14,852 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:14,861 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:15,226 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:15,240 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:15,964 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:15,988 INFO     [learner.py:606] ====Pushing takes 0.022540569305419922 s
2021-08-18:16:39:16,24 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:16,34 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:16,35 INFO     [param_server.py:410] Lock worker 1 with localStep 317 , while globalStep is 316

2021-08-18:16:39:17,4 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:17,20 INFO     [learner.py:606] ====Pushing takes 0.014936685562133789 s
2021-08-18:16:39:17,42 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:17,47 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:17,56 INFO     [param_server.py:410] Lock worker 2 with localStep 317 , while globalStep is 316

2021-08-18:16:39:17,454 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:17,468 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:18,238 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:18,248 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:19,856 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:19,877 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:20,572 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:20,601 INFO     [learner.py:606] ====Pushing takes 0.027607440948486328 s
2021-08-18:16:39:20,638 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:20,645 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:20,646 INFO     [param_server.py:381] ====After aggregation in epoch: 316, virtual_clock: 12796.806876117877, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 2.8778080454579107, test len: 3099.0
2021-08-18:16:39:20,649 INFO     [param_server.py:410] Lock worker 3 with localStep 317 , while globalStep is 317

2021-08-18:16:39:20,649 INFO     [param_server.py:441] ====Epoch 318 completes 17 clients with loss 46.61605654288498, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:20,650 INFO     [param_server.py:450] ====Start to sample for epoch 318, global virtualClock: 12796.806876117877, round_duration: 67.37786812921225
2021-08-18:16:39:20,651 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:20,985 INFO     [param_server.py:553] For epoch: 318, median_reward: 315.6497050203491, dev: 315.6497050203491
2021-08-18:16:39:21,556 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4126, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:39:21,558 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4225.0579, eval_time 0.5477, test_loss 3.4126, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:39:21,608 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.166, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:39:21,608 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4225.1089, eval_time 0.5984, test_loss 3.166, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:39:21,624 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0182, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:39:21,625 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4225.1232, eval_time 0.6169, test_loss 3.0182, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:39:21,640 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:21,649 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:21,693 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:21,701 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:21,705 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:21,729 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:23,157 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:23,184 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:23,717 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:23,731 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:24,268 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:24,278 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:25,592 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:25,660 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:26,510 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:26,537 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:26,793 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:26,801 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:26,807 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:26,814 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:27,327 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:27,347 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:27,576 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:27,590 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:27,906 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:27,922 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:28,24 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:28,44 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:28,622 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:28,646 INFO     [learner.py:606] ====Pushing takes 0.02229022979736328 s
2021-08-18:16:39:28,680 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:28,687 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:28,687 INFO     [param_server.py:410] Lock worker 1 with localStep 318 , while globalStep is 317

2021-08-18:16:39:30,62 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:30,77 INFO     [learner.py:606] ====Pushing takes 0.014035224914550781 s
2021-08-18:16:39:30,97 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:30,102 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:30,103 INFO     [param_server.py:410] Lock worker 2 with localStep 318 , while globalStep is 317

2021-08-18:16:39:30,312 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:30,326 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:31,155 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:31,170 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:33,63 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:33,77 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:33,649 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:33,677 INFO     [learner.py:606] ====Pushing takes 0.026660919189453125 s
2021-08-18:16:39:33,719 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:33,732 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:33,733 INFO     [param_server.py:381] ====After aggregation in epoch: 317, virtual_clock: 12864.184744247088, top_1: : 64.8919 % (2011.0), top_5: : 100.0 % (3099.0), test loss: 3.1989117816642483, test len: 3099.0
2021-08-18:16:39:33,735 INFO     [param_server.py:410] Lock worker 3 with localStep 318 , while globalStep is 318

2021-08-18:16:39:33,735 INFO     [param_server.py:441] ====Epoch 319 completes 17 clients with loss 130.1872526964729, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:33,736 INFO     [param_server.py:450] ====Start to sample for epoch 319, global virtualClock: 12864.184744247088, round_duration: 67.37786812921225
2021-08-18:16:39:33,737 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:34,19 INFO     [param_server.py:553] For epoch: 319, median_reward: 337.56649785878966, dev: 337.56649785878966
2021-08-18:16:39:34,653 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9053, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:39:34,654 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4238.1544, eval_time 0.6111, test_loss 2.9053, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:39:34,656 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6183, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:39:34,657 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4238.1576, eval_time 0.614, test_loss 2.6183, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:39:34,691 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0101, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:39:34,692 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4238.1903, eval_time 0.6487, test_loss 3.0101, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:39:34,729 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:34,730 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:34,738 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:34,739 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:34,789 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:34,810 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:36,295 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:36,322 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:36,874 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:36,889 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:37,631 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:37,646 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:38,917 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:38,937 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:39,735 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:39,756 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:39,981 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:40,2 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:40,86 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:40,107 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:40,551 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:40,572 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:40,833 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:40,848 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:41,325 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:41,341 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:41,345 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:41,352 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:41,829 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:41,853 INFO     [learner.py:606] ====Pushing takes 0.022682666778564453 s
2021-08-18:16:39:41,888 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:41,895 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:41,896 INFO     [param_server.py:410] Lock worker 1 with localStep 319 , while globalStep is 318

2021-08-18:16:39:43,419 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:43,439 INFO     [learner.py:606] ====Pushing takes 0.014639616012573242 s
2021-08-18:16:39:43,458 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:43,462 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:43,463 INFO     [param_server.py:410] Lock worker 2 with localStep 319 , while globalStep is 318

2021-08-18:16:39:43,596 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:43,608 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:44,290 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:44,302 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:46,130 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:46,162 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:46,902 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:46,935 INFO     [learner.py:606] ====Pushing takes 0.03105783462524414 s
2021-08-18:16:39:46,976 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:46,985 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:46,985 INFO     [param_server.py:381] ====After aggregation in epoch: 318, virtual_clock: 12931.5626123763, top_1: : 67.3443 % (2087.0), top_5: : 100.0 % (3099.0), test loss: 2.8445283792637013, test len: 3099.0
2021-08-18:16:39:46,988 INFO     [param_server.py:410] Lock worker 3 with localStep 319 , while globalStep is 319

2021-08-18:16:39:46,988 INFO     [param_server.py:441] ====Epoch 320 completes 17 clients with loss 125.74500117076127, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:46,989 INFO     [param_server.py:450] ====Start to sample for epoch 320, global virtualClock: 12931.5626123763, round_duration: 67.37786812921225
2021-08-18:16:39:47,7 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:47,349 INFO     [param_server.py:553] For epoch: 320, median_reward: 351.5783105495975, dev: 351.5783105495975
2021-08-18:16:39:48,10 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1676, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:39:48,11 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4251.5118, eval_time 0.6404, test_loss 3.1676, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:39:48,50 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7094, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:39:48,53 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4251.5539, eval_time 0.6787, test_loss 2.7094, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:39:48,83 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:39:48,87 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8939, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:39:48,88 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4251.5867, eval_time 0.717, test_loss 2.8939, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:39:48,98 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:48,125 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:39:48,138 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:48,162 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:39:48,190 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:49,669 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:49,689 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:50,236 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:50,250 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:50,869 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:50,883 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:52,337 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:52,365 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:53,202 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:53,228 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:53,282 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:53,294 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:53,328 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:53,348 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:53,960 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:53,971 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:53,975 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:53,991 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:54,748 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:54,760 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:54,769 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:54,787 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:55,334 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:55,358 INFO     [learner.py:606] ====Pushing takes 0.022218942642211914 s
2021-08-18:16:39:55,395 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:55,405 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:39:55,406 INFO     [param_server.py:410] Lock worker 1 with localStep 320 , while globalStep is 319

2021-08-18:16:39:56,671 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:56,685 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:57,46 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:57,62 INFO     [learner.py:606] ====Pushing takes 0.014428853988647461 s
2021-08-18:16:39:57,77 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:57,83 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:39:57,83 INFO     [param_server.py:410] Lock worker 2 with localStep 320 , while globalStep is 319

2021-08-18:16:39:57,509 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:57,527 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:59,206 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:59,220 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:59,861 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:59,892 INFO     [learner.py:606] ====Pushing takes 0.029001474380493164 s
2021-08-18:16:39:59,924 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:59,932 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:39:59,932 INFO     [param_server.py:381] ====After aggregation in epoch: 319, virtual_clock: 12998.940480505511, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 2.923618378462615, test len: 3099.0
2021-08-18:16:39:59,935 INFO     [param_server.py:410] Lock worker 3 with localStep 320 , while globalStep is 320

2021-08-18:16:39:59,936 INFO     [param_server.py:441] ====Epoch 321 completes 17 clients with loss 109.35687162816336, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:39:59,936 INFO     [param_server.py:450] ====Start to sample for epoch 321, global virtualClock: 12998.940480505511, round_duration: 67.37786812921225
2021-08-18:16:39:59,937 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:00,281 INFO     [param_server.py:541] Handle Wight 0.03540611267089844 | Send 0.3447704315185547
2021-08-18:16:40:00,282 INFO     [param_server.py:553] For epoch: 321, median_reward: 331.89707568118484, dev: 331.89707568118484
2021-08-18:16:40:00,975 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9751, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:40:00,976 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4264.4749, eval_time 0.6824, test_loss 2.9751, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:40:00,992 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9749, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:40:00,996 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4264.4964, eval_time 0.6977, test_loss 2.9749, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:40:01,37 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0468, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:40:01,38 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4264.5381, eval_time 0.7365, test_loss 3.0468, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:40:01,69 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:01,90 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:01,90 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:01,100 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:01,142 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:01,156 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:02,538 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:02,565 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:03,199 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:03,209 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:03,850 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:03,864 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:05,32 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:05,52 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:05,841 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:05,868 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:06,34 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:06,49 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:06,268 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:06,288 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:06,637 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:06,664 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:06,988 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:07,2 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:07,331 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:07,359 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:07,498 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:07,511 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:07,955 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:07,979 INFO     [learner.py:606] ====Pushing takes 0.022336244583129883 s
2021-08-18:16:40:08,15 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:08,26 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:08,27 INFO     [param_server.py:410] Lock worker 1 with localStep 321 , while globalStep is 320

2021-08-18:16:40:09,715 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:09,732 INFO     [learner.py:606] ====Pushing takes 0.014606714248657227 s
2021-08-18:16:40:09,739 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:09,746 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:09,748 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:09,751 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:09,752 INFO     [param_server.py:410] Lock worker 2 with localStep 321 , while globalStep is 320

2021-08-18:16:40:10,600 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:10,614 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:12,485 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:12,503 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:13,145 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:13,179 INFO     [learner.py:606] ====Pushing takes 0.03278374671936035 s
2021-08-18:16:40:13,217 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:13,227 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:13,228 INFO     [param_server.py:381] ====After aggregation in epoch: 320, virtual_clock: 13066.318348634722, top_1: : 66.9894 % (2076.0), top_5: : 100.0 % (3099.0), test loss: 2.9989182772459806, test len: 3099.0
2021-08-18:16:40:13,230 INFO     [param_server.py:410] Lock worker 3 with localStep 321 , while globalStep is 321

2021-08-18:16:40:13,230 INFO     [param_server.py:441] ====Epoch 322 completes 17 clients with loss 128.52885526766545, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:13,231 INFO     [param_server.py:450] ====Start to sample for epoch 322, global virtualClock: 13066.318348634722, round_duration: 67.37786812921225
2021-08-18:16:40:13,232 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:13,564 INFO     [param_server.py:553] For epoch: 322, median_reward: 327.7025724125802, dev: 327.7025724125802
2021-08-18:16:40:14,276 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.781, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:40:14,279 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4277.7775, eval_time 0.6995, test_loss 2.781, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:40:14,282 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.95, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:40:14,282 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4277.7829, eval_time 0.7021, test_loss 2.95, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:40:14,283 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7772, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:40:14,284 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4277.7843, eval_time 0.7003, test_loss 2.7772, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:40:14,362 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:14,371 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:14,383 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:14,392 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:14,399 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:14,415 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:15,837 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:15,857 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:16,415 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:16,429 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:16,988 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:17,6 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:18,235 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:18,262 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:19,195 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:19,213 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:19,240 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:19,273 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:19,379 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:19,398 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:19,999 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:20,26 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:20,172 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:20,182 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:20,607 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:20,620 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:20,688 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:20,716 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:21,413 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:21,437 INFO     [learner.py:606] ====Pushing takes 0.021798133850097656 s
2021-08-18:16:40:21,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:21,476 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:21,477 INFO     [param_server.py:410] Lock worker 1 with localStep 322 , while globalStep is 321

2021-08-18:16:40:23,229 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:23,247 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:23,347 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:23,364 INFO     [learner.py:606] ====Pushing takes 0.015132427215576172 s
2021-08-18:16:40:23,380 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:23,385 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:23,386 INFO     [param_server.py:410] Lock worker 2 with localStep 322 , while globalStep is 321

2021-08-18:16:40:23,935 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:23,945 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:25,512 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:25,524 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:26,113 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:26,158 INFO     [learner.py:606] ====Pushing takes 0.04402303695678711 s
2021-08-18:16:40:26,199 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:26,207 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:26,208 INFO     [param_server.py:381] ====After aggregation in epoch: 321, virtual_clock: 13133.696216763934, top_1: : 64.5369 % (2000.0), top_5: : 100.0 % (3099.0), test loss: 2.8360635395403264, test len: 3099.0
2021-08-18:16:40:26,211 INFO     [param_server.py:410] Lock worker 3 with localStep 322 , while globalStep is 322

2021-08-18:16:40:26,211 INFO     [param_server.py:441] ====Epoch 323 completes 17 clients with loss 94.60242717305741, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:26,212 INFO     [param_server.py:450] ====Start to sample for epoch 323, global virtualClock: 13133.696216763934, round_duration: 67.37786812921225
2021-08-18:16:40:26,213 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:26,542 INFO     [param_server.py:553] For epoch: 323, median_reward: 333.76731817434325, dev: 333.76731817434325
2021-08-18:16:40:27,112 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8238, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:40:27,113 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4290.6113, eval_time 0.5568, test_loss 2.8238, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:40:27,151 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4841, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:40:27,152 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4290.653, eval_time 0.5915, test_loss 2.4841, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:40:27,153 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9321, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:40:27,154 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4290.6544, eval_time 0.5954, test_loss 2.9321, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:40:27,197 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:27,205 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:27,229 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:27,238 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:27,249 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:27,264 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:28,545 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:28,566 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:29,279 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:29,288 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:30,23 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:30,34 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:31,97 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:31,124 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:32,110 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:32,143 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:32,273 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:32,288 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:32,565 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:32,583 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:32,959 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:32,992 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:33,388 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:33,402 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:33,652 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:33,672 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:33,720 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:33,747 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:34,362 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:34,386 INFO     [learner.py:606] ====Pushing takes 0.022764921188354492 s
2021-08-18:16:40:34,421 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:34,431 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:34,432 INFO     [param_server.py:410] Lock worker 1 with localStep 323 , while globalStep is 322

2021-08-18:16:40:36,68 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:36,77 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:36,443 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:36,460 INFO     [learner.py:606] ====Pushing takes 0.015674591064453125 s
2021-08-18:16:40:36,481 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:36,486 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:36,486 INFO     [param_server.py:410] Lock worker 2 with localStep 323 , while globalStep is 322

2021-08-18:16:40:36,749 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:36,760 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:38,323 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:38,343 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:39,33 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:39,78 INFO     [learner.py:606] ====Pushing takes 0.04304051399230957 s
2021-08-18:16:40:39,116 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:39,124 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:39,125 INFO     [param_server.py:381] ====After aggregation in epoch: 322, virtual_clock: 13201.074084893145, top_1: : 67.1507 % (2081.0), top_5: : 100.0 % (3099.0), test loss: 2.7466415701675473, test len: 3099.0
2021-08-18:16:40:39,128 INFO     [param_server.py:410] Lock worker 3 with localStep 323 , while globalStep is 323

2021-08-18:16:40:39,129 INFO     [param_server.py:441] ====Epoch 324 completes 17 clients with loss 75.63499664927248, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:39,129 INFO     [param_server.py:450] ====Start to sample for epoch 324, global virtualClock: 13201.074084893145, round_duration: 67.37786812921225
2021-08-18:16:40:39,130 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:39,460 INFO     [param_server.py:553] For epoch: 324, median_reward: 336.08208898732653, dev: 336.08208898732653
2021-08-18:16:40:40,69 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1229, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:40:40,72 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4303.5726, eval_time 0.5856, test_loss 3.1229, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:40:40,88 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5928, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:40:40,88 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4303.5889, eval_time 0.5984, test_loss 2.5928, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:40:40,111 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7859, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:40:40,112 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4303.6105, eval_time 0.6271, test_loss 2.7859, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:40:40,139 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:40:40,147 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:40,208 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:40:40,212 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:40:40,223 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:40,227 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:41,607 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:41,628 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:42,268 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:42,279 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:43,151 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:43,165 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:44,241 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:44,269 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:45,51 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:45,71 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:45,215 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:45,230 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:45,714 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:45,724 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:45,824 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:45,857 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:46,452 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:46,461 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:46,477 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:46,491 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:46,497 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:46,502 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:47,43 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:47,67 INFO     [learner.py:606] ====Pushing takes 0.02285289764404297 s
2021-08-18:16:40:47,103 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:47,110 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:47,110 INFO     [param_server.py:410] Lock worker 1 with localStep 324 , while globalStep is 323

2021-08-18:16:40:49,66 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:49,83 INFO     [learner.py:606] ====Pushing takes 0.012637615203857422 s
2021-08-18:16:40:49,98 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:49,103 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:49,104 INFO     [param_server.py:410] Lock worker 2 with localStep 324 , while globalStep is 323

2021-08-18:16:40:49,270 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:49,289 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:50,154 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:50,172 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:51,844 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:51,862 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:52,614 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:52,659 INFO     [learner.py:606] ====Pushing takes 0.04345822334289551 s
2021-08-18:16:40:52,701 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:52,709 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:52,710 INFO     [param_server.py:381] ====After aggregation in epoch: 323, virtual_clock: 13268.451953022357, top_1: : 66.6989 % (2067.0), top_5: : 100.0 % (3099.0), test loss: 2.833893603748745, test len: 3099.0
2021-08-18:16:40:52,713 INFO     [param_server.py:410] Lock worker 3 with localStep 324 , while globalStep is 324

2021-08-18:16:40:52,714 INFO     [param_server.py:441] ====Epoch 325 completes 17 clients with loss 49.36832930727354, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:52,714 INFO     [param_server.py:450] ====Start to sample for epoch 325, global virtualClock: 13268.451953022357, round_duration: 67.37786812921225
2021-08-18:16:40:52,715 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:53,57 INFO     [param_server.py:553] For epoch: 325, median_reward: 322.7463294018915, dev: 322.7463294018915
2021-08-18:16:40:53,749 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8147, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:40:53,750 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4317.2505, eval_time 0.6661, test_loss 2.8147, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:40:53,790 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9704, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:40:53,793 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4317.2912, eval_time 0.7112, test_loss 2.9704, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:40:53,791 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5979, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:40:53,793 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4317.2939, eval_time 0.7092, test_loss 2.5979, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:40:53,841 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:40:53,849 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:53,862 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:40:53,882 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:40:53,896 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:53,898 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:55,177 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:55,191 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:55,926 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:55,936 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:56,546 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:56,556 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:57,402 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:57,422 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:58,278 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:58,298 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:58,906 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:58,924 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:59,12 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:59,26 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:59,76 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:59,110 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:59,840 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:59,845 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:59,858 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:59,867 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:00,242 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:00,252 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:00,397 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:00,421 INFO     [learner.py:606] ====Pushing takes 0.02236318588256836 s
2021-08-18:16:41:00,459 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:00,468 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:00,468 INFO     [param_server.py:410] Lock worker 1 with localStep 325 , while globalStep is 324

2021-08-18:16:41:02,547 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:02,561 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:02,805 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:02,852 INFO     [learner.py:606] ====Pushing takes 0.01491856575012207 s
2021-08-18:16:41:02,867 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:02,871 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:02,872 INFO     [param_server.py:410] Lock worker 2 with localStep 325 , while globalStep is 324

2021-08-18:16:41:03,418 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:03,432 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:05,120 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:05,131 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:05,664 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:05,699 INFO     [learner.py:606] ====Pushing takes 0.03392195701599121 s
2021-08-18:16:41:05,741 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:05,750 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:05,751 INFO     [param_server.py:381] ====After aggregation in epoch: 324, virtual_clock: 13335.829821151568, top_1: : 67.6025 % (2095.0), top_5: : 100.0 % (3099.0), test loss: 2.794355418947008, test len: 3099.0
2021-08-18:16:41:05,758 INFO     [param_server.py:410] Lock worker 3 with localStep 325 , while globalStep is 325

2021-08-18:16:41:05,759 INFO     [param_server.py:441] ====Epoch 326 completes 17 clients with loss 92.48435197065483, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:05,759 INFO     [param_server.py:450] ====Start to sample for epoch 326, global virtualClock: 13335.829821151568, round_duration: 67.37786812921225
2021-08-18:16:41:05,760 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:06,86 INFO     [param_server.py:553] For epoch: 326, median_reward: 338.94806780180585, dev: 338.94806780180585
2021-08-18:16:41:06,734 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9571, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:41:06,736 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4330.236, eval_time 0.6332, test_loss 2.9571, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:41:06,741 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7522, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:41:06,741 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0266, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:41:06,742 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4330.2425, eval_time 0.6387, test_loss 2.7522, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:41:06,742 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4330.2407, eval_time 0.6427, test_loss 3.0266, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:41:06,812 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:06,815 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:06,818 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:06,821 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:06,824 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:06,825 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:08,65 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:08,83 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:08,865 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:08,875 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:09,456 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:09,471 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:10,541 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:10,562 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:11,454 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:11,488 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:11,789 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:11,804 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:11,942 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:11,956 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:12,296 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:12,329 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:12,780 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:12,797 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:13,64 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:13,75 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:13,73 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:13,100 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:13,721 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:13,746 INFO     [learner.py:606] ====Pushing takes 0.02341938018798828 s
2021-08-18:16:41:13,782 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:13,795 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:13,796 INFO     [param_server.py:410] Lock worker 1 with localStep 326 , while globalStep is 325

2021-08-18:16:41:15,674 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:15,691 INFO     [learner.py:606] ====Pushing takes 0.015030860900878906 s
2021-08-18:16:41:15,712 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:15,717 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:15,718 INFO     [param_server.py:410] Lock worker 2 with localStep 326 , while globalStep is 325

2021-08-18:16:41:15,731 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:15,743 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:16,550 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:16,560 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:18,202 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:18,221 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:18,883 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:18,926 INFO     [learner.py:606] ====Pushing takes 0.04147696495056152 s
2021-08-18:16:41:18,958 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:18,965 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:18,966 INFO     [param_server.py:381] ====After aggregation in epoch: 325, virtual_clock: 13403.20768928078, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 2.9119835915388883, test len: 3099.0
2021-08-18:16:41:18,969 INFO     [param_server.py:410] Lock worker 3 with localStep 326 , while globalStep is 326

2021-08-18:16:41:18,969 INFO     [param_server.py:441] ====Epoch 327 completes 17 clients with loss 58.453135895022065, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:18,970 INFO     [param_server.py:450] ====Start to sample for epoch 327, global virtualClock: 13403.20768928078, round_duration: 67.37786812921225
2021-08-18:16:41:18,970 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:19,312 INFO     [param_server.py:553] For epoch: 327, median_reward: 317.1620315929573, dev: 317.1620315929573
2021-08-18:16:41:19,919 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8073, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:41:19,920 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4343.4183, eval_time 0.5957, test_loss 2.8073, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:41:19,919 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3677, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:41:19,923 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4343.4231, eval_time 0.5962, test_loss 3.3677, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:41:19,969 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4462, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:41:19,970 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4343.4702, eval_time 0.642, test_loss 2.4462, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:41:19,990 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:20,0 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:20,4 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:20,12 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:20,82 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:20,98 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:21,308 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:21,328 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:22,55 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:22,65 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:23,36 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:23,55 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:23,719 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:23,739 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:24,457 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:24,478 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:24,759 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:24,773 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:25,268 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:25,295 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:25,505 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:25,518 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:25,997 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:26,24 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:26,31 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:26,49 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:26,300 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:26,309 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:26,702 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:26,727 INFO     [learner.py:606] ====Pushing takes 0.023857593536376953 s
2021-08-18:16:41:26,764 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:26,771 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:26,772 INFO     [param_server.py:410] Lock worker 1 with localStep 327 , while globalStep is 326

2021-08-18:16:41:28,585 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:28,601 INFO     [learner.py:606] ====Pushing takes 0.014525413513183594 s
2021-08-18:16:41:28,616 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:28,621 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:28,621 INFO     [param_server.py:410] Lock worker 2 with localStep 327 , while globalStep is 326

2021-08-18:16:41:29,56 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:29,65 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:29,766 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:29,778 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:31,578 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:31,596 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:32,196 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:32,227 INFO     [learner.py:606] ====Pushing takes 0.0302731990814209 s
2021-08-18:16:41:32,257 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:32,264 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:32,265 INFO     [param_server.py:381] ====After aggregation in epoch: 326, virtual_clock: 13470.585557409991, top_1: : 67.2475 % (2084.0), top_5: : 100.0 % (3099.0), test loss: 2.8737304784633495, test len: 3099.0
2021-08-18:16:41:32,268 INFO     [param_server.py:410] Lock worker 3 with localStep 327 , while globalStep is 327

2021-08-18:16:41:32,269 INFO     [param_server.py:441] ====Epoch 328 completes 17 clients with loss 66.23673103151026, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:32,269 INFO     [param_server.py:450] ====Start to sample for epoch 328, global virtualClock: 13470.585557409991, round_duration: 67.37786812921225
2021-08-18:16:41:32,270 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:32,593 INFO     [param_server.py:553] For epoch: 328, median_reward: 318.0040620601809, dev: 318.0040620601809
2021-08-18:16:41:33,224 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.148, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:41:33,225 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4356.725, eval_time 0.604, test_loss 3.148, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:41:33,262 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8412, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:41:33,265 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4356.7638, eval_time 0.6472, test_loss 2.8412, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:41:33,293 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:33,308 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:33,334 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:33,346 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:33,395 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8853, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:41:33,399 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4356.8993, eval_time 0.7689, test_loss 2.8853, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:41:33,488 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:33,508 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:34,726 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:34,747 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:35,481 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:35,491 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:36,224 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:36,237 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:37,149 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:37,164 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:38,1 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:38,19 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:38,352 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:38,371 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:38,447 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:38,456 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:38,765 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:38,786 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:39,244 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:39,258 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:39,411 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:39,432 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:39,788 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:39,800 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:40,66 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:40,90 INFO     [learner.py:606] ====Pushing takes 0.022701263427734375 s
2021-08-18:16:41:40,125 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:40,135 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:40,136 INFO     [param_server.py:410] Lock worker 1 with localStep 328 , while globalStep is 327

2021-08-18:16:41:41,848 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:41,862 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:42,94 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:42,110 INFO     [learner.py:606] ====Pushing takes 0.014818429946899414 s
2021-08-18:16:41:42,126 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:42,131 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:42,132 INFO     [param_server.py:410] Lock worker 2 with localStep 328 , while globalStep is 327

2021-08-18:16:41:42,662 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:42,676 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:44,495 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:44,513 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:45,104 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:45,133 INFO     [learner.py:606] ====Pushing takes 0.02800774574279785 s
2021-08-18:16:41:45,163 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:45,171 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:45,172 INFO     [param_server.py:381] ====After aggregation in epoch: 327, virtual_clock: 13537.963425539203, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 2.958141267299652, test len: 3099.0
2021-08-18:16:41:45,174 INFO     [param_server.py:410] Lock worker 3 with localStep 328 , while globalStep is 328

2021-08-18:16:41:45,175 INFO     [param_server.py:441] ====Epoch 329 completes 17 clients with loss 61.334983680109715, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:45,175 INFO     [param_server.py:450] ====Start to sample for epoch 329, global virtualClock: 13537.963425539203, round_duration: 67.37786812921225
2021-08-18:16:41:45,176 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:45,516 INFO     [param_server.py:553] For epoch: 329, median_reward: 312.6679367687463, dev: 312.6679367687463
2021-08-18:16:41:46,158 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.866, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:41:46,160 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4369.6599, eval_time 0.6096, test_loss 2.866, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:41:46,200 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9628, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:41:46,201 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4369.6999, eval_time 0.6513, test_loss 2.9628, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:41:46,203 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6873, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:41:46,204 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4369.7044, eval_time 0.6524, test_loss 2.6873, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:41:46,231 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:41:46,238 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:46,268 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:41:46,275 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:41:46,283 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:46,291 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:47,446 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:47,456 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:48,326 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:48,336 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:48,999 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:49,13 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:49,716 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:49,734 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:50,423 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:50,437 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:51,77 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:51,92 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:51,140 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:51,168 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:51,300 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:51,315 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:51,853 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:51,880 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:52,92 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:52,111 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:52,396 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:52,410 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:52,521 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:52,545 INFO     [learner.py:606] ====Pushing takes 0.022866487503051758 s
2021-08-18:16:41:52,579 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:52,585 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:52,586 INFO     [param_server.py:410] Lock worker 1 with localStep 329 , while globalStep is 328

2021-08-18:16:41:54,633 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:54,654 INFO     [learner.py:606] ====Pushing takes 0.013882875442504883 s
2021-08-18:16:41:54,668 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:54,673 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:54,674 INFO     [param_server.py:410] Lock worker 2 with localStep 329 , while globalStep is 328

2021-08-18:16:41:55,159 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:55,173 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:55,960 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:55,974 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:57,637 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:57,648 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:58,262 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:58,292 INFO     [learner.py:606] ====Pushing takes 0.028448104858398438 s
2021-08-18:16:41:58,323 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:58,333 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:58,333 INFO     [param_server.py:381] ====After aggregation in epoch: 328, virtual_clock: 13605.341293668414, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 2.8386809472684504, test len: 3099.0
2021-08-18:16:41:58,335 INFO     [param_server.py:410] Lock worker 3 with localStep 329 , while globalStep is 329

2021-08-18:16:41:58,336 INFO     [param_server.py:441] ====Epoch 330 completes 17 clients with loss 63.522664182845745, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:58,337 INFO     [param_server.py:450] ====Start to sample for epoch 330, global virtualClock: 13605.341293668414, round_duration: 67.37786812921225
2021-08-18:16:41:58,338 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:58,619 INFO     [param_server.py:553] For epoch: 330, median_reward: 321.8778558896934, dev: 321.8778558896934
2021-08-18:16:41:59,333 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7805, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:41:59,334 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4382.834, eval_time 0.6882, test_loss 2.7805, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:41:59,380 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7413, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:41:59,381 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4382.8812, eval_time 0.7374, test_loss 2.7413, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:41:59,381 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7524, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:41:59,382 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4382.8803, eval_time 0.7399, test_loss 2.7524, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:41:59,401 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:41:59,410 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:59,452 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:41:59,469 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:59,488 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:41:59,503 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:00,805 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:00,819 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:01,673 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:01,682 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:02,274 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:02,289 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:03,495 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:03,515 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:04,281 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:04,301 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:04,613 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:04,628 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:04,753 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:04,771 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:05,180 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:05,207 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:05,493 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:05,511 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:05,956 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:05,971 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:05,983 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:05,985 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:06,503 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:06,527 INFO     [learner.py:606] ====Pushing takes 0.02273702621459961 s
2021-08-18:16:42:06,560 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:06,568 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:06,569 INFO     [param_server.py:410] Lock worker 1 with localStep 330 , while globalStep is 329

2021-08-18:16:42:08,236 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:08,249 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:08,430 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:08,446 INFO     [learner.py:606] ====Pushing takes 0.014332294464111328 s
2021-08-18:16:42:08,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:08,468 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:08,469 INFO     [param_server.py:410] Lock worker 2 with localStep 330 , while globalStep is 329

2021-08-18:16:42:08,995 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:09,5 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:10,716 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:10,726 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:11,341 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:11,371 INFO     [learner.py:606] ====Pushing takes 0.02802753448486328 s
2021-08-18:16:42:11,402 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:11,411 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:11,412 INFO     [param_server.py:381] ====After aggregation in epoch: 329, virtual_clock: 13672.719161797626, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 2.7580492330922026, test len: 3099.0
2021-08-18:16:42:11,414 INFO     [param_server.py:410] Lock worker 3 with localStep 330 , while globalStep is 330

2021-08-18:16:42:11,415 INFO     [param_server.py:441] ====Epoch 331 completes 17 clients with loss 82.13081598448086, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:11,415 INFO     [param_server.py:450] ====Start to sample for epoch 331, global virtualClock: 13672.719161797626, round_duration: 67.37786812921225
2021-08-18:16:42:11,416 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:11,750 INFO     [param_server.py:553] For epoch: 331, median_reward: 329.40364493368696, dev: 329.40364493368696
2021-08-18:16:42:12,466 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5058, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:42:12,467 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4395.9672, eval_time 0.6912, test_loss 2.5058, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:42:12,469 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1656, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:42:12,470 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4395.9704, eval_time 0.6954, test_loss 3.1656, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:42:12,503 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1633, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:42:12,505 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4396.004, eval_time 0.732, test_loss 3.1633, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:42:12,525 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:12,533 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:12,541 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:12,547 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:12,578 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:12,598 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:13,940 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:13,958 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:14,697 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:14,710 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:15,502 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:15,517 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:16,582 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:16,603 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:17,456 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:17,480 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:17,629 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:17,643 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:18,137 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:18,147 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:18,236 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:18,256 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:18,809 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:18,819 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:18,945 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:18,966 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:18,973 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:18,991 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:19,629 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:19,651 INFO     [learner.py:606] ====Pushing takes 0.020550966262817383 s
2021-08-18:16:42:19,678 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:19,688 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:19,688 INFO     [param_server.py:410] Lock worker 1 with localStep 331 , while globalStep is 330

2021-08-18:16:42:21,500 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:21,509 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:21,536 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:21,551 INFO     [learner.py:606] ====Pushing takes 0.013904333114624023 s
2021-08-18:16:42:21,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:21,573 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:21,573 INFO     [param_server.py:410] Lock worker 2 with localStep 331 , while globalStep is 330

2021-08-18:16:42:22,338 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:22,353 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:24,135 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:24,153 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:24,897 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:24,927 INFO     [learner.py:606] ====Pushing takes 0.02810978889465332 s
2021-08-18:16:42:24,958 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:24,967 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:24,968 INFO     [param_server.py:381] ====After aggregation in epoch: 330, virtual_clock: 13740.097029926837, top_1: : 67.7315 % (2099.0), top_5: : 100.0 % (3099.0), test loss: 2.9448882280676454, test len: 3099.0
2021-08-18:16:42:24,970 INFO     [param_server.py:410] Lock worker 3 with localStep 331 , while globalStep is 331

2021-08-18:16:42:24,971 INFO     [param_server.py:441] ====Epoch 332 completes 17 clients with loss 91.33321495335935, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:24,971 INFO     [param_server.py:450] ====Start to sample for epoch 332, global virtualClock: 13740.097029926837, round_duration: 67.37786812921225
2021-08-18:16:42:24,972 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:25,240 INFO     [param_server.py:553] For epoch: 332, median_reward: 325.3628959543645, dev: 325.3628959543645
2021-08-18:16:42:25,911 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9627, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:42:25,912 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4409.4127, eval_time 0.6457, test_loss 2.9627, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:42:25,917 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0821, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:42:25,918 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4409.4186, eval_time 0.6477, test_loss 3.0821, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:42:25,943 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8207, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:42:25,943 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4409.4419, eval_time 0.6801, test_loss 2.8207, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:42:25,980 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:25,987 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:25,994 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:25,998 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:26,12 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:26,29 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:27,313 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:27,340 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:28,132 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:28,142 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:28,745 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:28,755 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:29,773 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:29,791 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:30,543 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:30,561 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:30,974 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:30,988 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:31,38 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:31,49 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:31,316 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:31,337 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:31,808 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:31,818 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:32,45 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:32,66 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:32,354 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:32,369 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:32,578 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:32,603 INFO     [learner.py:606] ====Pushing takes 0.022352933883666992 s
2021-08-18:16:42:32,634 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:32,641 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:32,641 INFO     [param_server.py:410] Lock worker 1 with localStep 332 , while globalStep is 331

2021-08-18:16:42:34,779 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:34,798 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:34,884 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:34,902 INFO     [learner.py:606] ====Pushing takes 0.01424098014831543 s
2021-08-18:16:42:34,917 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:34,922 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:34,923 INFO     [param_server.py:410] Lock worker 2 with localStep 332 , while globalStep is 331

2021-08-18:16:42:35,650 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:35,669 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:37,437 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:37,451 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:38,116 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:38,145 INFO     [learner.py:606] ====Pushing takes 0.02805948257446289 s
2021-08-18:16:42:38,179 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:38,189 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:38,190 INFO     [param_server.py:381] ====After aggregation in epoch: 331, virtual_clock: 13807.474898056049, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 2.9551938573519387, test len: 3099.0
2021-08-18:16:42:38,193 INFO     [param_server.py:410] Lock worker 3 with localStep 332 , while globalStep is 332

2021-08-18:16:42:38,193 INFO     [param_server.py:441] ====Epoch 333 completes 17 clients with loss 161.1793612678662, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:38,194 INFO     [param_server.py:450] ====Start to sample for epoch 333, global virtualClock: 13807.474898056049, round_duration: 67.37786812921225
2021-08-18:16:42:38,195 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:38,512 INFO     [param_server.py:553] For epoch: 333, median_reward: 336.72188908087355, dev: 336.72188908087355
2021-08-18:16:42:39,144 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6258, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:42:39,145 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4422.6454, eval_time 0.5953, test_loss 2.6258, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:42:39,188 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0897, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:42:39,190 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4422.6882, eval_time 0.6425, test_loss 3.0897, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:42:39,191 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7807, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:42:39,192 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4422.6923, eval_time 0.645, test_loss 2.7807, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:42:39,215 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:42:39,225 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:39,260 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:42:39,260 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:42:39,273 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:39,277 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:40,550 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:40,570 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:41,381 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:41,391 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:41,863 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:41,873 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:42,922 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:42,943 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:43,743 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:43,764 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:44,251 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:44,265 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:44,307 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:44,326 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:44,501 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:44,528 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:45,109 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:45,129 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:45,234 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:45,261 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:45,588 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:45,601 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:45,878 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:45,900 INFO     [learner.py:606] ====Pushing takes 0.02025294303894043 s
2021-08-18:16:42:45,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:45,934 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:45,935 INFO     [param_server.py:410] Lock worker 1 with localStep 333 , while globalStep is 332

2021-08-18:16:42:47,968 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:47,982 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:48,19 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:48,34 INFO     [learner.py:606] ====Pushing takes 0.013200759887695312 s
2021-08-18:16:42:48,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:48,54 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:48,55 INFO     [param_server.py:410] Lock worker 2 with localStep 333 , while globalStep is 332

2021-08-18:16:42:48,844 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:48,858 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:50,487 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:50,499 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:51,89 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:51,122 INFO     [learner.py:606] ====Pushing takes 0.03194928169250488 s
2021-08-18:16:42:51,157 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:51,165 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:51,165 INFO     [param_server.py:381] ====After aggregation in epoch: 332, virtual_clock: 13874.85276618526, top_1: : 67.4411 % (2090.0), top_5: : 100.0 % (3099.0), test loss: 2.832078726203353, test len: 3099.0
2021-08-18:16:42:51,168 INFO     [param_server.py:410] Lock worker 3 with localStep 333 , while globalStep is 333

2021-08-18:16:42:51,169 INFO     [param_server.py:441] ====Epoch 334 completes 17 clients with loss 50.84675612651084, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:51,169 INFO     [param_server.py:450] ====Start to sample for epoch 334, global virtualClock: 13874.85276618526, round_duration: 67.37786812921225
2021-08-18:16:42:51,170 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:51,466 INFO     [param_server.py:553] For epoch: 334, median_reward: 311.70163028658976, dev: 311.70163028658976
2021-08-18:16:42:52,26 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0713, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:42:52,27 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4435.5275, eval_time 0.5356, test_loss 3.0713, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:42:52,68 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8404, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:42:52,70 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0934, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:42:52,71 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4435.5694, eval_time 0.5817, test_loss 2.8404, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:42:52,71 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4435.5714, eval_time 0.5792, test_loss 3.0934, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:42:52,100 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:42:52,112 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:52,141 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:42:52,142 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:42:52,156 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:52,157 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:53,328 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:53,346 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:54,126 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:54,139 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:54,936 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:54,955 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:55,878 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:55,898 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:56,717 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:56,739 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:57,53 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:57,67 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:57,544 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:57,557 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:57,624 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:57,651 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:58,309 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:58,323 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:58,337 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:58,357 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:58,364 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:58,371 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:58,977 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:59,2 INFO     [learner.py:606] ====Pushing takes 0.02261066436767578 s
2021-08-18:16:42:59,31 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:59,43 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:59,44 INFO     [param_server.py:410] Lock worker 1 with localStep 334 , while globalStep is 333

2021-08-18:16:43:00,859 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:00,875 INFO     [learner.py:606] ====Pushing takes 0.014267921447753906 s
2021-08-18:16:43:00,890 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:00,895 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:00,895 INFO     [param_server.py:410] Lock worker 2 with localStep 334 , while globalStep is 333

2021-08-18:16:43:01,119 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:01,128 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:01,866 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:01,876 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:03,683 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:03,711 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:04,340 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:04,370 INFO     [learner.py:606] ====Pushing takes 0.028738975524902344 s
2021-08-18:16:43:04,408 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:04,415 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:04,416 INFO     [param_server.py:381] ====After aggregation in epoch: 333, virtual_clock: 13942.230634314472, top_1: : 67.0216 % (2077.0), top_5: : 100.0 % (3099.0), test loss: 3.001708566038697, test len: 3099.0
2021-08-18:16:43:04,418 INFO     [param_server.py:410] Lock worker 3 with localStep 334 , while globalStep is 334

2021-08-18:16:43:04,419 INFO     [param_server.py:441] ====Epoch 335 completes 17 clients with loss 32.07190062704479, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:04,419 INFO     [param_server.py:450] ====Start to sample for epoch 335, global virtualClock: 13942.230634314472, round_duration: 67.37786812921225
2021-08-18:16:43:04,420 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:04,692 INFO     [param_server.py:553] For epoch: 335, median_reward: 306.39796060781714, dev: 306.39796060781714
2021-08-18:16:43:05,303 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9853, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:43:05,305 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4448.805, eval_time 0.5891, test_loss 2.9853, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:43:05,349 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3054, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:16:43:05,350 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4448.8491, eval_time 0.6349, test_loss 3.3054, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:16:43:05,354 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.976, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:43:05,356 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4448.8561, eval_time 0.634, test_loss 2.976, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:43:05,377 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:05,387 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:05,420 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:05,424 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:05,436 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:05,438 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:06,816 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:06,837 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:07,613 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:07,623 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:08,455 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:08,474 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:09,227 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:09,247 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:09,970 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:09,983 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:10,440 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:10,458 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:10,654 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:10,681 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:10,879 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:10,890 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:11,376 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:11,404 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:11,606 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:11,615 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:11,650 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:11,663 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:12,63 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:12,86 INFO     [learner.py:606] ====Pushing takes 0.021853923797607422 s
2021-08-18:16:43:12,121 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:12,127 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:12,128 INFO     [param_server.py:410] Lock worker 1 with localStep 335 , while globalStep is 334

2021-08-18:16:43:14,238 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:14,257 INFO     [learner.py:606] ====Pushing takes 0.015038013458251953 s
2021-08-18:16:43:14,278 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:14,282 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:14,283 INFO     [param_server.py:410] Lock worker 2 with localStep 335 , while globalStep is 334

2021-08-18:16:43:14,433 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:14,446 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:15,391 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:15,405 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:17,290 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:17,311 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:18,22 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:18,53 INFO     [learner.py:606] ====Pushing takes 0.02761983871459961 s
2021-08-18:16:43:18,92 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:18,102 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:18,103 INFO     [param_server.py:381] ====After aggregation in epoch: 334, virtual_clock: 14009.608502443683, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 3.0889148358945495, test len: 3099.0
2021-08-18:16:43:18,105 INFO     [param_server.py:410] Lock worker 3 with localStep 335 , while globalStep is 335

2021-08-18:16:43:18,105 INFO     [param_server.py:441] ====Epoch 336 completes 17 clients with loss 51.018084865454284, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:18,106 INFO     [param_server.py:450] ====Start to sample for epoch 336, global virtualClock: 14009.608502443683, round_duration: 67.37786812921225
2021-08-18:16:43:18,107 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:18,382 INFO     [param_server.py:553] For epoch: 336, median_reward: 319.86752509513946, dev: 319.86752509513946
2021-08-18:16:43:19,11 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0566, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:43:19,12 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4462.5127, eval_time 0.6077, test_loss 3.0566, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:43:19,58 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8085, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:43:19,59 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4462.5581, eval_time 0.6548, test_loss 2.8085, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:43:19,64 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4736, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:43:19,65 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4462.5654, eval_time 0.6557, test_loss 3.4736, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:43:19,81 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:19,90 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:19,124 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:19,132 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:19,139 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:19,146 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:20,415 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:20,429 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:21,270 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:21,280 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:21,826 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:21,836 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:22,790 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:22,811 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:23,726 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:23,753 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:24,69 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:24,80 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:24,149 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:24,163 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:24,609 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:24,636 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:24,784 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:24,798 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:25,345 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:25,379 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:25,409 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:25,428 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:25,931 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:25,955 INFO     [learner.py:606] ====Pushing takes 0.02290487289428711 s
2021-08-18:16:43:25,990 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:25,997 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:25,998 INFO     [param_server.py:410] Lock worker 1 with localStep 336 , while globalStep is 335

2021-08-18:16:43:27,722 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:27,736 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:27,818 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:27,834 INFO     [learner.py:606] ====Pushing takes 0.01463937759399414 s
2021-08-18:16:43:27,849 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:27,856 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:27,856 INFO     [param_server.py:410] Lock worker 2 with localStep 336 , while globalStep is 335

2021-08-18:16:43:28,682 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:28,703 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:30,436 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:30,447 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:30,962 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:30,992 INFO     [learner.py:606] ====Pushing takes 0.027827978134155273 s
2021-08-18:16:43:31,21 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:31,29 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:31,30 INFO     [param_server.py:381] ====After aggregation in epoch: 335, virtual_clock: 14076.986370572895, top_1: : 64.9242 % (2012.0), top_5: : 100.0 % (3099.0), test loss: 3.1129376336380292, test len: 3099.0
2021-08-18:16:43:31,33 INFO     [param_server.py:410] Lock worker 3 with localStep 336 , while globalStep is 336

2021-08-18:16:43:31,33 INFO     [param_server.py:441] ====Epoch 337 completes 17 clients with loss 171.01941430117472, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:31,33 INFO     [param_server.py:450] ====Start to sample for epoch 337, global virtualClock: 14076.986370572895, round_duration: 67.37786812921225
2021-08-18:16:43:31,34 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:31,314 INFO     [param_server.py:553] For epoch: 337, median_reward: 350.3193226029745, dev: 350.3193226029745
2021-08-18:16:43:31,863 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1249, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:16:43:31,866 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4475.3643, eval_time 0.5385, test_loss 3.1249, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:16:43:31,946 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9527, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:43:31,950 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4475.4501, eval_time 0.6227, test_loss 2.9527, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:43:31,950 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5972, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:43:31,951 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4475.4511, eval_time 0.6224, test_loss 2.5972, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:43:31,955 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:31,964 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:32,18 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:32,19 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:32,26 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:32,26 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:33,412 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:33,426 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:34,259 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:34,270 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:34,844 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:34,871 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:35,969 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:35,996 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:36,939 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:36,973 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:37,95 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:37,116 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:37,394 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:37,421 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:37,758 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:37,783 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:38,219 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:38,238 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:38,440 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:38,466 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:38,717 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:38,731 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:39,120 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:39,143 INFO     [learner.py:606] ====Pushing takes 0.021752595901489258 s
2021-08-18:16:43:39,177 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:39,186 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:39,187 INFO     [param_server.py:410] Lock worker 1 with localStep 337 , while globalStep is 336

2021-08-18:16:43:41,86 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:41,96 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:41,359 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:41,381 INFO     [learner.py:606] ====Pushing takes 0.01993870735168457 s
2021-08-18:16:43:41,395 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:41,400 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:41,401 INFO     [param_server.py:410] Lock worker 2 with localStep 337 , while globalStep is 336

2021-08-18:16:43:41,900 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:41,917 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:43,587 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:43,596 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:44,218 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:44,247 INFO     [learner.py:606] ====Pushing takes 0.028042078018188477 s
2021-08-18:16:43:44,283 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:44,290 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:44,291 INFO     [param_server.py:381] ====After aggregation in epoch: 336, virtual_clock: 14144.364238702106, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 2.8915970987743798, test len: 3099.0
2021-08-18:16:43:44,293 INFO     [param_server.py:410] Lock worker 3 with localStep 337 , while globalStep is 337

2021-08-18:16:43:44,294 INFO     [param_server.py:441] ====Epoch 338 completes 17 clients with loss 85.95229390413509, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:44,294 INFO     [param_server.py:450] ====Start to sample for epoch 338, global virtualClock: 14144.364238702106, round_duration: 67.37786812921225
2021-08-18:16:43:44,295 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:44,610 INFO     [param_server.py:553] For epoch: 338, median_reward: 322.93250568947894, dev: 322.93250568947894
2021-08-18:16:43:45,292 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.073, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:43:45,293 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4488.7937, eval_time 0.6721, test_loss 3.073, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:43:45,296 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8644, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:43:45,297 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4488.7956, eval_time 0.6758, test_loss 2.8644, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:43:45,336 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9851, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:43:45,337 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4488.8374, eval_time 0.7142, test_loss 2.9851, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:43:45,360 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:43:45,367 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:43:45,369 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:45,384 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:45,404 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:43:45,418 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:46,875 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:46,902 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:47,512 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:47,521 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:48,407 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:48,425 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:49,717 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:49,738 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:50,499 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:50,518 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:50,626 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:50,653 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:51,9 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:51,21 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:51,434 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:51,454 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:51,617 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:51,627 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:51,769 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:51,784 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:52,125 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:52,140 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:52,872 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:52,896 INFO     [learner.py:606] ====Pushing takes 0.022765636444091797 s
2021-08-18:16:43:52,941 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:52,950 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:52,951 INFO     [param_server.py:410] Lock worker 1 with localStep 338 , while globalStep is 337

2021-08-18:16:43:54,218 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:54,233 INFO     [learner.py:606] ====Pushing takes 0.013800859451293945 s
2021-08-18:16:43:54,253 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:54,258 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:54,259 INFO     [param_server.py:410] Lock worker 2 with localStep 338 , while globalStep is 337

2021-08-18:16:43:54,378 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:54,390 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:54,990 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:55,1 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:56,836 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:56,854 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:57,536 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:57,567 INFO     [learner.py:606] ====Pushing takes 0.02951192855834961 s
2021-08-18:16:43:57,604 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:57,611 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:57,612 INFO     [param_server.py:381] ====After aggregation in epoch: 337, virtual_clock: 14211.742106831318, top_1: : 67.0862 % (2079.0), top_5: : 100.0 % (3099.0), test loss: 2.974153443619057, test len: 3099.0
2021-08-18:16:43:57,614 INFO     [param_server.py:410] Lock worker 3 with localStep 338 , while globalStep is 338

2021-08-18:16:43:57,615 INFO     [param_server.py:441] ====Epoch 339 completes 17 clients with loss 25.53166080265056, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:57,615 INFO     [param_server.py:450] ====Start to sample for epoch 339, global virtualClock: 14211.742106831318, round_duration: 67.37786812921225
2021-08-18:16:43:57,616 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:57,900 INFO     [param_server.py:553] For epoch: 339, median_reward: 303.47052609200693, dev: 303.47052609200693
2021-08-18:16:43:58,618 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1356, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:43:58,619 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4502.1194, eval_time 0.6837, test_loss 3.1356, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:43:58,661 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9421, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:43:58,662 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4502.1627, eval_time 0.7267, test_loss 2.9421, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:43:58,694 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8761, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:43:58,695 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4502.1939, eval_time 0.7612, test_loss 2.8761, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:43:58,709 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:43:58,717 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:58,752 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:43:58,765 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:43:58,768 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:58,788 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:00,182 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:00,209 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:00,895 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:00,904 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:01,541 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:01,551 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:02,575 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:02,590 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:03,229 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:03,244 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:03,774 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:03,778 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:03,788 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:03,791 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:04,33 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:04,54 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:04,534 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:04,543 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:04,867 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:04,887 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:05,132 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:05,146 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:05,479 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:05,503 INFO     [learner.py:606] ====Pushing takes 0.0225985050201416 s
2021-08-18:16:44:05,539 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:05,546 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:05,546 INFO     [param_server.py:410] Lock worker 1 with localStep 339 , while globalStep is 338

2021-08-18:16:44:07,528 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:07,542 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:07,700 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:07,717 INFO     [learner.py:606] ====Pushing takes 0.015462875366210938 s
2021-08-18:16:44:07,739 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:07,744 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:07,745 INFO     [param_server.py:410] Lock worker 2 with localStep 339 , while globalStep is 338

2021-08-18:16:44:08,363 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:08,390 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:10,265 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:10,288 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:11,46 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:11,75 INFO     [learner.py:606] ====Pushing takes 0.027814865112304688 s
2021-08-18:16:44:11,112 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:11,119 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:11,120 INFO     [param_server.py:381] ====After aggregation in epoch: 338, virtual_clock: 14279.11997496053, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 2.984604546317348, test len: 3099.0
2021-08-18:16:44:11,122 INFO     [param_server.py:410] Lock worker 3 with localStep 339 , while globalStep is 339

2021-08-18:16:44:11,123 INFO     [param_server.py:441] ====Epoch 340 completes 17 clients with loss 66.84301535106049, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:11,123 INFO     [param_server.py:450] ====Start to sample for epoch 340, global virtualClock: 14279.11997496053, round_duration: 67.37786812921225
2021-08-18:16:44:11,124 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:11,401 INFO     [param_server.py:553] For epoch: 340, median_reward: 316.98403308154377, dev: 316.98403308154377
2021-08-18:16:44:12,8 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6462, Top-1 Accuracy: 721.0/1033 (0.698), Top-5 Accuracy: 1.0
2021-08-18:16:44:12,11 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4515.5098, eval_time 0.5862, test_loss 2.6462, test_accuracy 0.698, test_5_accuracy 1.0 

2021-08-18:16:44:12,9 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7885, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:44:12,12 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7768, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:44:12,13 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4515.5132, eval_time 0.5836, test_loss 2.7768, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:44:12,12 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4515.5126, eval_time 0.5873, test_loss 2.7885, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:44:12,82 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:12,90 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:12,119 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:12,125 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:12,127 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:12,134 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:13,288 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:13,297 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:14,202 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:14,212 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:14,757 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:14,767 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:15,733 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:15,748 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:16,484 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:16,498 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:17,115 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:17,129 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:17,233 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:17,247 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:17,315 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:17,348 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:17,961 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:17,982 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:18,197 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:18,231 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:18,385 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:18,394 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:18,873 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:18,897 INFO     [learner.py:606] ====Pushing takes 0.02252793312072754 s
2021-08-18:16:44:18,932 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:18,941 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:18,941 INFO     [param_server.py:410] Lock worker 1 with localStep 340 , while globalStep is 339

2021-08-18:16:44:20,740 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:20,756 INFO     [learner.py:606] ====Pushing takes 0.014969348907470703 s
2021-08-18:16:44:20,776 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:20,782 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:20,782 INFO     [param_server.py:410] Lock worker 2 with localStep 340 , while globalStep is 339

2021-08-18:16:44:20,981 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:20,996 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:21,809 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:21,818 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:23,559 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:23,572 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:24,281 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:24,310 INFO     [learner.py:606] ====Pushing takes 0.027945756912231445 s
2021-08-18:16:44:24,354 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:24,362 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:24,362 INFO     [param_server.py:381] ====After aggregation in epoch: 339, virtual_clock: 14346.49784308974, top_1: : 68.3446 % (2118.0), top_5: : 100.0 % (3099.0), test loss: 2.7371552765921314, test len: 3099.0
2021-08-18:16:44:24,365 INFO     [param_server.py:410] Lock worker 3 with localStep 340 , while globalStep is 340

2021-08-18:16:44:24,365 INFO     [param_server.py:441] ====Epoch 341 completes 17 clients with loss 99.00859948739766, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:24,366 INFO     [param_server.py:450] ====Start to sample for epoch 341, global virtualClock: 14346.49784308974, round_duration: 67.37786812921225
2021-08-18:16:44:24,367 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:24,674 INFO     [param_server.py:541] Handle Wight 0.04269599914550781 | Send 0.30810093879699707
2021-08-18:16:44:24,675 INFO     [param_server.py:553] For epoch: 341, median_reward: 343.0078698028304, dev: 343.0078698028304
2021-08-18:16:44:25,320 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8544, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:44:25,321 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4528.8197, eval_time 0.6357, test_loss 2.8544, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:44:25,321 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4171, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:44:25,322 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4528.8222, eval_time 0.6345, test_loss 3.4171, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:44:25,325 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2059, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:44:25,326 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4528.8261, eval_time 0.6382, test_loss 3.2059, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:44:25,388 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:25,392 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:25,397 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:25,400 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:25,408 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:25,417 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:26,517 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:26,530 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:27,331 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:27,341 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:28,144 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:28,162 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:28,930 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:28,956 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:29,759 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:29,779 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:30,216 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:30,234 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:30,660 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:30,679 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:30,738 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:30,771 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:31,438 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:31,452 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:31,472 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:31,499 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:31,530 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:31,544 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:32,79 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:32,103 INFO     [learner.py:606] ====Pushing takes 0.02245044708251953 s
2021-08-18:16:44:32,140 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:32,147 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:32,148 INFO     [param_server.py:410] Lock worker 1 with localStep 341 , while globalStep is 340

2021-08-18:16:44:33,892 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:33,908 INFO     [learner.py:606] ====Pushing takes 0.014198541641235352 s
2021-08-18:16:44:33,931 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:33,936 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:33,937 INFO     [param_server.py:410] Lock worker 2 with localStep 341 , while globalStep is 340

2021-08-18:16:44:34,115 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:34,124 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:34,808 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:34,820 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:36,389 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:36,408 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:37,132 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:37,163 INFO     [learner.py:606] ====Pushing takes 0.029468536376953125 s
2021-08-18:16:44:37,201 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:37,209 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:37,210 INFO     [param_server.py:381] ====After aggregation in epoch: 340, virtual_clock: 14413.875711218952, top_1: : 64.3756 % (1995.0), top_5: : 100.0 % (3099.0), test loss: 3.1591282884279885, test len: 3099.0
2021-08-18:16:44:37,213 INFO     [param_server.py:410] Lock worker 3 with localStep 341 , while globalStep is 341

2021-08-18:16:44:37,213 INFO     [param_server.py:441] ====Epoch 342 completes 17 clients with loss 48.94987406634227, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:37,214 INFO     [param_server.py:450] ====Start to sample for epoch 342, global virtualClock: 14413.875711218952, round_duration: 67.37786812921225
2021-08-18:16:44:37,214 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:37,540 INFO     [param_server.py:553] For epoch: 342, median_reward: 304.89969481086007, dev: 304.89969481086007
2021-08-18:16:44:38,210 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8878, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:44:38,210 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4541.7108, eval_time 0.6457, test_loss 2.8878, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:44:38,251 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2475, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:44:38,252 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4541.7502, eval_time 0.6891, test_loss 3.2475, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:44:38,260 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6125, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:44:38,261 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4541.7614, eval_time 0.6961, test_loss 3.6125, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:44:38,282 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:44:38,291 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:38,318 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:44:38,339 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:38,356 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:44:38,372 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:39,929 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:39,950 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:40,533 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:40,542 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:41,322 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:41,337 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:42,566 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:42,586 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:43,346 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:43,373 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:43,436 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:43,454 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:43,656 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:43,669 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:44,158 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:44,186 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:44,393 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:44,403 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:44,604 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:44,615 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:44,879 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:44,900 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:45,503 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:45,525 INFO     [learner.py:606] ====Pushing takes 0.021600961685180664 s
2021-08-18:16:44:45,560 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:45,569 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:45,586 INFO     [param_server.py:410] Lock worker 1 with localStep 342 , while globalStep is 341

2021-08-18:16:44:46,971 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:46,986 INFO     [learner.py:606] ====Pushing takes 0.013613224029541016 s
2021-08-18:16:44:47,1 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:47,6 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:47,7 INFO     [param_server.py:410] Lock worker 2 with localStep 342 , while globalStep is 341

2021-08-18:16:44:47,207 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:47,221 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:48,54 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:48,69 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:49,681 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:49,699 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:50,367 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:50,414 INFO     [learner.py:606] ====Pushing takes 0.04462003707885742 s
2021-08-18:16:44:50,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:50,461 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:50,462 INFO     [param_server.py:381] ====After aggregation in epoch: 341, virtual_clock: 14481.253579348164, top_1: : 67.4411 % (2090.0), top_5: : 100.0 % (3099.0), test loss: 3.249247542134038, test len: 3099.0
2021-08-18:16:44:50,464 INFO     [param_server.py:410] Lock worker 3 with localStep 342 , while globalStep is 342

2021-08-18:16:44:50,465 INFO     [param_server.py:441] ====Epoch 343 completes 17 clients with loss 114.75029715343568, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:50,465 INFO     [param_server.py:450] ====Start to sample for epoch 343, global virtualClock: 14481.253579348164, round_duration: 67.37786812921225
2021-08-18:16:44:50,466 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:50,787 INFO     [param_server.py:553] For epoch: 343, median_reward: 356.7421146131748, dev: 356.7421146131748
2021-08-18:16:44:51,420 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.085, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:44:51,423 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4554.9238, eval_time 0.6089, test_loss 3.085, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:44:51,460 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6966, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:44:51,461 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4554.9613, eval_time 0.646, test_loss 2.6966, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:44:51,467 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5138, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:44:51,473 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4554.9712, eval_time 0.6605, test_loss 3.5138, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:44:51,501 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:44:51,509 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:51,530 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:44:51,543 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:51,545 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:44:51,559 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:52,975 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:52,988 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:53,686 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:53,696 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:54,278 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:54,290 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:55,586 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:55,607 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:56,511 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:56,539 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:56,764 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:56,784 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:56,977 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:56,993 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:57,316 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:57,343 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:57,821 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:57,835 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:58,2 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:58,12 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:58,30 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:58,50 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:58,551 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:58,575 INFO     [learner.py:606] ====Pushing takes 0.021277666091918945 s
2021-08-18:16:44:58,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:58,617 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:58,618 INFO     [param_server.py:410] Lock worker 1 with localStep 343 , while globalStep is 342

2021-08-18:16:45:00,481 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:00,497 INFO     [learner.py:606] ====Pushing takes 0.014578580856323242 s
2021-08-18:16:45:00,513 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:00,518 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:00,519 INFO     [param_server.py:410] Lock worker 2 with localStep 343 , while globalStep is 342

2021-08-18:16:45:00,738 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:00,757 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:01,612 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:01,627 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:03,400 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:03,412 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:04,77 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:04,121 INFO     [learner.py:606] ====Pushing takes 0.04326939582824707 s
2021-08-18:16:45:04,155 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:04,166 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:04,167 INFO     [param_server.py:381] ====After aggregation in epoch: 342, virtual_clock: 14548.631447477375, top_1: : 67.2475 % (2084.0), top_5: : 100.0 % (3099.0), test loss: 3.098491275752032, test len: 3099.0
2021-08-18:16:45:04,169 INFO     [param_server.py:410] Lock worker 3 with localStep 343 , while globalStep is 343

2021-08-18:16:45:04,169 INFO     [param_server.py:441] ====Epoch 344 completes 17 clients with loss 138.34017052670995, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:04,169 INFO     [param_server.py:450] ====Start to sample for epoch 344, global virtualClock: 14548.631447477375, round_duration: 67.37786812921225
2021-08-18:16:45:04,170 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:04,508 INFO     [param_server.py:553] For epoch: 344, median_reward: 351.6519660507043, dev: 351.6519660507043
2021-08-18:16:45:05,198 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0629, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:45:05,199 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4568.6977, eval_time 0.6779, test_loss 3.0629, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:45:05,209 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2898, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:45:05,210 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4568.7102, eval_time 0.6888, test_loss 3.2898, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:45:05,214 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0662, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:45:05,215 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4568.715, eval_time 0.6931, test_loss 3.0662, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:45:05,278 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:05,280 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:05,285 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:05,290 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:05,291 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:05,294 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:06,893 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:06,913 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:07,612 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:07,627 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:08,486 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:08,505 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:09,462 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:09,482 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:10,225 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:10,245 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:10,671 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:10,689 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:10,884 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:10,898 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:11,55 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:11,82 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:11,774 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:11,778 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:11,792 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:11,794 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:11,896 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:11,906 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:12,302 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:12,326 INFO     [learner.py:606] ====Pushing takes 0.022313833236694336 s
2021-08-18:16:45:12,363 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:12,371 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:12,372 INFO     [param_server.py:410] Lock worker 1 with localStep 344 , while globalStep is 343

2021-08-18:16:45:14,478 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:14,494 INFO     [learner.py:606] ====Pushing takes 0.013303756713867188 s
2021-08-18:16:45:14,511 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:14,516 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:14,516 INFO     [param_server.py:410] Lock worker 2 with localStep 344 , while globalStep is 343

2021-08-18:16:45:14,547 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:14,557 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:15,228 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:15,238 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:16,910 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:16,921 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:17,660 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:17,690 INFO     [learner.py:606] ====Pushing takes 0.028877735137939453 s
2021-08-18:16:45:17,729 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:17,737 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:17,738 INFO     [param_server.py:381] ====After aggregation in epoch: 343, virtual_clock: 14616.009315606587, top_1: : 66.1504 % (2050.0), top_5: : 100.0 % (3099.0), test loss: 3.1396454925890325, test len: 3099.0
2021-08-18:16:45:17,741 INFO     [param_server.py:410] Lock worker 3 with localStep 344 , while globalStep is 344

2021-08-18:16:45:17,742 INFO     [param_server.py:441] ====Epoch 345 completes 17 clients with loss 100.95861477195729, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:17,743 INFO     [param_server.py:450] ====Start to sample for epoch 345, global virtualClock: 14616.009315606587, round_duration: 67.37786812921225
2021-08-18:16:45:17,744 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:18,84 INFO     [param_server.py:553] For epoch: 345, median_reward: 318.2218779792855, dev: 318.2218779792855
2021-08-18:16:45:18,760 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6997, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:45:18,761 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4582.2617, eval_time 0.6415, test_loss 2.6997, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:45:18,831 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:18,839 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:18,839 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0921, Top-1 Accuracy: 725.0/1033 (0.7018), Top-5 Accuracy: 1.0
2021-08-18:16:45:18,841 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4582.3395, eval_time 0.7221, test_loss 3.0921, test_accuracy 0.7018, test_5_accuracy 1.0 

2021-08-18:16:45:18,839 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3699, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:45:18,842 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4582.3426, eval_time 0.7206, test_loss 3.3699, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:45:18,910 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:18,919 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:18,932 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:18,947 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:20,363 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:20,390 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:20,953 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:20,966 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:21,683 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:21,697 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:22,836 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:22,856 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:23,684 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:23,711 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:23,918 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:23,941 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:24,246 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:24,266 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:24,497 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:24,511 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:24,948 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:24,959 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:25,110 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:25,125 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:25,140 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:25,151 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:25,799 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:25,823 INFO     [learner.py:606] ====Pushing takes 0.022501468658447266 s
2021-08-18:16:45:25,857 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:25,869 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:25,869 INFO     [param_server.py:410] Lock worker 1 with localStep 345 , while globalStep is 344

2021-08-18:16:45:27,542 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:27,552 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:27,772 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:27,787 INFO     [learner.py:606] ====Pushing takes 0.013521194458007812 s
2021-08-18:16:45:27,807 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:27,812 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:27,813 INFO     [param_server.py:410] Lock worker 2 with localStep 345 , while globalStep is 344

2021-08-18:16:45:28,381 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:28,402 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:30,283 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:30,304 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:30,961 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:30,990 INFO     [learner.py:606] ====Pushing takes 0.02740168571472168 s
2021-08-18:16:45:31,25 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:31,34 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:31,35 INFO     [param_server.py:381] ====After aggregation in epoch: 344, virtual_clock: 14683.387183735798, top_1: : 68.4414 % (2121.0), top_5: : 100.0 % (3099.0), test loss: 3.0539089584792105, test len: 3099.0
2021-08-18:16:45:31,38 INFO     [param_server.py:410] Lock worker 3 with localStep 345 , while globalStep is 345

2021-08-18:16:45:31,38 INFO     [param_server.py:441] ====Epoch 346 completes 17 clients with loss 106.99632599831658, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:31,39 INFO     [param_server.py:450] ====Start to sample for epoch 346, global virtualClock: 14683.387183735798, round_duration: 67.37786812921225
2021-08-18:16:45:31,40 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:31,449 INFO     [param_server.py:553] For epoch: 346, median_reward: 351.1314353385652, dev: 351.1314353385652
2021-08-18:16:45:32,100 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5607, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:45:32,101 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4595.6014, eval_time 0.6251, test_loss 3.5607, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:45:32,97 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3324, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:45:32,102 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4595.6023, eval_time 0.6277, test_loss 3.3324, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:45:32,134 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0031, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:45:32,137 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4595.6361, eval_time 0.6653, test_loss 3.0031, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:45:32,169 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:32,172 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:32,180 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:32,182 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:32,230 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:32,243 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:33,612 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:33,639 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:34,167 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:34,177 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:34,893 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:34,903 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:36,7 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:36,25 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:36,747 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:36,767 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:37,4 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:37,18 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:37,109 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:37,121 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:37,545 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:37,566 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:37,778 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:37,792 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:38,260 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:38,276 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:38,278 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:38,286 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:38,819 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:38,853 INFO     [learner.py:606] ====Pushing takes 0.0232541561126709 s
2021-08-18:16:45:38,886 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:38,893 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:38,894 INFO     [param_server.py:410] Lock worker 1 with localStep 346 , while globalStep is 345

2021-08-18:16:45:40,591 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:40,605 INFO     [learner.py:606] ====Pushing takes 0.01287388801574707 s
2021-08-18:16:45:40,620 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:40,625 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:40,626 INFO     [param_server.py:410] Lock worker 2 with localStep 346 , while globalStep is 345

2021-08-18:16:45:40,858 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:40,881 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:41,627 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:41,641 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:43,354 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:43,372 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:44,37 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:44,65 INFO     [learner.py:606] ====Pushing takes 0.02725362777709961 s
2021-08-18:16:45:44,100 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:44,110 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:44,110 INFO     [param_server.py:381] ====After aggregation in epoch: 345, virtual_clock: 14750.76505186501, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 3.2987249471523143, test len: 3099.0
2021-08-18:16:45:44,113 INFO     [param_server.py:410] Lock worker 3 with localStep 346 , while globalStep is 346

2021-08-18:16:45:44,113 INFO     [param_server.py:441] ====Epoch 347 completes 17 clients with loss 99.94807239292525, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:44,114 INFO     [param_server.py:450] ====Start to sample for epoch 347, global virtualClock: 14750.76505186501, round_duration: 67.37786812921225
2021-08-18:16:45:44,115 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:44,446 INFO     [param_server.py:553] For epoch: 347, median_reward: 323.74171136584005, dev: 323.74171136584005
2021-08-18:16:45:45,21 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1087, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:45:45,21 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4608.5218, eval_time 0.5465, test_loss 3.1087, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:45:45,27 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.458, Top-1 Accuracy: 725.0/1033 (0.7018), Top-5 Accuracy: 1.0
2021-08-18:16:45:45,28 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4608.527, eval_time 0.5544, test_loss 3.458, test_accuracy 0.7018, test_5_accuracy 1.0 

2021-08-18:16:45:45,88 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:45:45,96 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:45,107 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:45:45,114 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8881, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:45:45,114 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4608.6148, eval_time 0.6393, test_loss 2.8881, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:45:45,116 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:45,183 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:45:45,193 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:46,484 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:46,499 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:47,305 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:47,315 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:47,862 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:47,872 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:48,873 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:48,901 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:49,768 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:49,794 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:50,339 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:50,358 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:50,406 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:50,424 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:50,576 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:50,610 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:51,261 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:51,294 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:51,436 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:51,450 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:51,696 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:51,705 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:51,904 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:51,927 INFO     [learner.py:606] ====Pushing takes 0.02100396156311035 s
2021-08-18:16:45:51,963 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:51,970 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:51,970 INFO     [param_server.py:410] Lock worker 1 with localStep 347 , while globalStep is 346

2021-08-18:16:45:54,191 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:54,206 INFO     [learner.py:606] ====Pushing takes 0.01416778564453125 s
2021-08-18:16:45:54,227 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:54,232 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:54,232 INFO     [param_server.py:410] Lock worker 2 with localStep 347 , while globalStep is 346

2021-08-18:16:45:54,396 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:54,415 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:55,205 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:55,215 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:57,52 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:57,61 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:57,744 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:57,788 INFO     [learner.py:606] ====Pushing takes 0.042357683181762695 s
2021-08-18:16:45:57,828 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:57,836 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:57,837 INFO     [param_server.py:381] ====After aggregation in epoch: 346, virtual_clock: 14818.142919994221, top_1: : 68.2801 % (2116.0), top_5: : 100.0 % (3099.0), test loss: 3.1515842720314304, test len: 3099.0
2021-08-18:16:45:57,841 INFO     [param_server.py:410] Lock worker 3 with localStep 347 , while globalStep is 347

2021-08-18:16:45:57,842 INFO     [param_server.py:441] ====Epoch 348 completes 17 clients with loss 99.1488346246121, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:57,842 INFO     [param_server.py:450] ====Start to sample for epoch 348, global virtualClock: 14818.142919994221, round_duration: 67.37786812921225
2021-08-18:16:45:57,843 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:58,179 INFO     [param_server.py:553] For epoch: 348, median_reward: 337.78715220776263, dev: 337.78715220776263
2021-08-18:16:45:58,776 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5969, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:45:58,778 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4622.2761, eval_time 0.587, test_loss 3.5969, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:45:58,779 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7866, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:45:58,783 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4622.2838, eval_time 0.5886, test_loss 2.7866, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:45:58,784 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1175, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:45:58,784 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4622.2849, eval_time 0.5941, test_loss 3.1175, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:45:58,843 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:45:58,851 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:58,860 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:45:58,872 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:45:58,875 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:58,882 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:00,479 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:00,500 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:00,956 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:00,965 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:01,841 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:01,855 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:03,118 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:03,145 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:03,936 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:03,950 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:04,86 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:04,119 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:04,472 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:04,493 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:04,927 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:04,953 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:05,329 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:05,339 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:05,365 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:05,376 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:05,580 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:05,594 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:06,209 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:06,233 INFO     [learner.py:606] ====Pushing takes 0.022690296173095703 s
2021-08-18:16:46:06,269 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:06,278 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:06,278 INFO     [param_server.py:410] Lock worker 1 with localStep 348 , while globalStep is 347

2021-08-18:16:46:08,2 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:08,24 INFO     [learner.py:606] ====Pushing takes 0.01411890983581543 s
2021-08-18:16:46:08,44 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:08,49 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:08,50 INFO     [param_server.py:410] Lock worker 2 with localStep 348 , while globalStep is 347

2021-08-18:16:46:08,174 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:08,184 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:08,862 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:08,876 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:10,615 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:10,633 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:11,221 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:11,254 INFO     [learner.py:606] ====Pushing takes 0.03139185905456543 s
2021-08-18:16:46:11,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:11,299 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:11,300 INFO     [param_server.py:381] ====After aggregation in epoch: 347, virtual_clock: 14885.520788123433, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.1669860195230553, test len: 3099.0
2021-08-18:16:46:11,303 INFO     [param_server.py:410] Lock worker 3 with localStep 348 , while globalStep is 348

2021-08-18:16:46:11,303 INFO     [param_server.py:441] ====Epoch 349 completes 17 clients with loss 80.9487262265999, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:11,304 INFO     [param_server.py:450] ====Start to sample for epoch 349, global virtualClock: 14885.520788123433, round_duration: 67.37786812921225
2021-08-18:16:46:11,304 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:11,635 INFO     [param_server.py:553] For epoch: 349, median_reward: 325.3684312811646, dev: 325.3684312811646
2021-08-18:16:46:12,307 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8164, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:46:12,308 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4635.8085, eval_time 0.6379, test_loss 2.8164, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:46:12,316 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8247, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:46:12,317 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4635.8177, eval_time 0.6448, test_loss 2.8247, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:46:12,336 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5566, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:46:12,340 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4635.8388, eval_time 0.6708, test_loss 4.5566, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:46:12,379 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:12,389 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:12,394 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:12,403 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:12,420 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:12,443 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:14,188 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:14,215 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:14,500 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:14,510 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:15,555 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:15,570 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:16,628 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:16,642 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:17,373 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:17,387 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:17,487 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:17,507 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:17,891 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:17,905 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:18,162 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:18,176 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:18,572 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:18,582 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:18,643 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:18,655 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:18,755 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:18,775 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:19,371 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:19,394 INFO     [learner.py:606] ====Pushing takes 0.021344900131225586 s
2021-08-18:16:46:19,428 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:19,435 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:19,436 INFO     [param_server.py:410] Lock worker 1 with localStep 349 , while globalStep is 348

2021-08-18:16:46:21,109 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:21,124 INFO     [learner.py:606] ====Pushing takes 0.013635873794555664 s
2021-08-18:16:46:21,142 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:21,147 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:21,148 INFO     [param_server.py:410] Lock worker 2 with localStep 349 , while globalStep is 348

2021-08-18:16:46:21,231 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:21,250 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:22,25 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:22,39 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:23,693 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:23,712 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:24,397 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:24,427 INFO     [learner.py:606] ====Pushing takes 0.0283048152923584 s
2021-08-18:16:46:24,466 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:24,476 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:24,477 INFO     [param_server.py:381] ====After aggregation in epoch: 348, virtual_clock: 14952.898656252644, top_1: : 68.2801 % (2116.0), top_5: : 100.0 % (3099.0), test loss: 3.3991890417204957, test len: 3099.0
2021-08-18:16:46:24,479 INFO     [param_server.py:410] Lock worker 3 with localStep 349 , while globalStep is 349

2021-08-18:16:46:24,480 INFO     [param_server.py:441] ====Epoch 350 completes 17 clients with loss 177.31593291424048, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:24,480 INFO     [param_server.py:450] ====Start to sample for epoch 350, global virtualClock: 14952.898656252644, round_duration: 67.37786812921225
2021-08-18:16:46:24,481 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:24,813 INFO     [param_server.py:553] For epoch: 350, median_reward: 345.5183935012408, dev: 345.5183935012408
2021-08-18:16:46:25,436 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.783, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:46:25,439 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4648.9395, eval_time 0.5914, test_loss 2.783, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:46:25,509 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:25,510 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7673, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:46:25,511 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4649.0099, eval_time 0.6634, test_loss 2.7673, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:46:25,517 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3561, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:46:25,518 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4649.0186, eval_time 0.668, test_loss 3.3561, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:46:25,523 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:25,581 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:25,597 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:25,612 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:25,631 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:27,167 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:27,187 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:27,703 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:27,717 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:28,500 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:28,512 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:29,503 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:29,530 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:30,420 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:30,448 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:30,614 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:30,628 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:31,51 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:31,65 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:31,252 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:31,273 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:31,744 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:31,754 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:31,863 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:31,877 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:31,910 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:31,930 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:32,442 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:32,466 INFO     [learner.py:606] ====Pushing takes 0.023242950439453125 s
2021-08-18:16:46:32,503 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:32,511 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:32,511 INFO     [param_server.py:410] Lock worker 1 with localStep 350 , while globalStep is 349

2021-08-18:16:46:34,216 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:34,257 INFO     [learner.py:606] ====Pushing takes 0.013637304306030273 s
2021-08-18:16:46:34,277 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:34,282 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:34,283 INFO     [param_server.py:410] Lock worker 2 with localStep 350 , while globalStep is 349

2021-08-18:16:46:34,582 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:34,601 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:35,470 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:35,490 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:37,91 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:37,109 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:37,859 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:37,892 INFO     [learner.py:606] ====Pushing takes 0.030864238739013672 s
2021-08-18:16:46:37,931 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:37,940 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:37,941 INFO     [param_server.py:381] ====After aggregation in epoch: 349, virtual_clock: 15020.276524381856, top_1: : 66.1826 % (2051.0), top_5: : 100.0 % (3099.0), test loss: 2.9688006396646855, test len: 3099.0
2021-08-18:16:46:37,943 INFO     [param_server.py:410] Lock worker 3 with localStep 350 , while globalStep is 350

2021-08-18:16:46:37,944 INFO     [param_server.py:441] ====Epoch 351 completes 17 clients with loss 22.454012787353218, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:37,944 INFO     [param_server.py:450] ====Start to sample for epoch 351, global virtualClock: 15020.276524381856, round_duration: 67.37786812921225
2021-08-18:16:46:37,945 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:38,282 INFO     [param_server.py:553] For epoch: 351, median_reward: 302.58478831654185, dev: 302.58478831654185
2021-08-18:16:46:38,960 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7472, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:46:38,960 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5069, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:46:38,961 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4662.4613, eval_time 0.6503, test_loss 3.5069, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:46:38,961 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4662.4613, eval_time 0.6416, test_loss 2.7472, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:46:38,993 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8544, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:46:38,994 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4662.4921, eval_time 0.6874, test_loss 2.8544, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:46:39,31 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:46:39,40 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:39,66 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:46:39,74 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:46:39,78 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:39,82 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:40,647 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:40,667 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:41,195 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:41,209 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:41,886 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:41,901 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:43,227 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:43,254 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:44,57 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:44,84 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:44,189 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:44,206 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:44,326 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:44,341 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:44,883 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:44,904 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:45,135 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:45,149 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:45,367 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:45,378 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:45,563 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:45,584 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:46,171 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:46,195 INFO     [learner.py:606] ====Pushing takes 0.023303508758544922 s
2021-08-18:16:46:46,231 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:46,240 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:46,241 INFO     [param_server.py:410] Lock worker 1 with localStep 351 , while globalStep is 350

2021-08-18:16:46:47,943 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:47,958 INFO     [learner.py:606] ====Pushing takes 0.014197587966918945 s
2021-08-18:16:46:47,979 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:47,984 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:47,985 INFO     [param_server.py:410] Lock worker 2 with localStep 351 , while globalStep is 350

2021-08-18:16:46:48,4 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:48,32 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:48,959 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:48,980 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:50,634 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:50,646 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:51,286 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:51,316 INFO     [learner.py:606] ====Pushing takes 0.02882242202758789 s
2021-08-18:16:46:51,355 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:51,363 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:51,364 INFO     [param_server.py:381] ====After aggregation in epoch: 350, virtual_clock: 15087.654392511067, top_1: : 67.1507 % (2081.0), top_5: : 100.0 % (3099.0), test loss: 3.036168345698604, test len: 3099.0
2021-08-18:16:46:51,366 INFO     [param_server.py:410] Lock worker 3 with localStep 351 , while globalStep is 351

2021-08-18:16:46:51,367 INFO     [param_server.py:441] ====Epoch 352 completes 17 clients with loss 35.85370251298084, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:51,368 INFO     [param_server.py:450] ====Start to sample for epoch 352, global virtualClock: 15087.654392511067, round_duration: 67.37786812921225
2021-08-18:16:46:51,369 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:51,695 INFO     [param_server.py:553] For epoch: 352, median_reward: 305.0370192184581, dev: 305.0370192184581
2021-08-18:16:46:52,419 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9208, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:46:52,420 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4675.9202, eval_time 0.6981, test_loss 2.9208, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:46:52,467 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6999, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:46:52,468 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4675.9686, eval_time 0.7463, test_loss 2.6999, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:46:52,488 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:46:52,496 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:52,504 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7923, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:46:52,511 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4676.0092, eval_time 0.7914, test_loss 2.7923, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:46:52,549 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:46:52,562 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:52,580 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:46:52,602 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:54,192 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:54,213 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:54,771 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:54,785 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:55,417 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:55,436 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:56,685 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:56,703 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:57,443 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:57,463 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:57,716 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:57,726 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:57,845 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:57,859 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:58,184 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:58,205 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:58,607 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:58,621 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:58,907 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:58,928 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:59,52 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:59,66 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:59,656 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:59,680 INFO     [learner.py:606] ====Pushing takes 0.023212194442749023 s
2021-08-18:16:46:59,715 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:59,721 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:59,722 INFO     [param_server.py:410] Lock worker 1 with localStep 352 , while globalStep is 351

2021-08-18:16:47:01,420 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:01,429 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:01,808 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:01,824 INFO     [learner.py:606] ====Pushing takes 0.013863325119018555 s
2021-08-18:16:47:01,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:01,850 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:01,851 INFO     [param_server.py:410] Lock worker 2 with localStep 352 , while globalStep is 351

2021-08-18:16:47:02,240 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:02,254 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:04,2 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:04,21 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:04,774 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:04,808 INFO     [learner.py:606] ====Pushing takes 0.03231930732727051 s
2021-08-18:16:47:04,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:04,856 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:04,856 INFO     [param_server.py:381] ====After aggregation in epoch: 351, virtual_clock: 15155.032260640279, top_1: : 67.9251 % (2105.0), top_5: : 100.0 % (3099.0), test loss: 2.8043332585582026, test len: 3099.0
2021-08-18:16:47:04,859 INFO     [param_server.py:410] Lock worker 3 with localStep 352 , while globalStep is 352

2021-08-18:16:47:04,859 INFO     [param_server.py:441] ====Epoch 353 completes 17 clients with loss 83.30637881094316, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:04,860 INFO     [param_server.py:450] ====Start to sample for epoch 353, global virtualClock: 15155.032260640279, round_duration: 67.37786812921225
2021-08-18:16:47:04,860 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:05,143 INFO     [param_server.py:553] For epoch: 353, median_reward: 319.7115681764395, dev: 319.7115681764395
2021-08-18:16:47:05,967 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8278, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:47:05,970 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4689.4704, eval_time 0.8045, test_loss 2.8278, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:47:06,21 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5502, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:47:06,22 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4689.5229, eval_time 0.8517, test_loss 3.5502, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:47:06,38 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:06,46 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:06,55 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7858, Top-1 Accuracy: 721.0/1033 (0.698), Top-5 Accuracy: 1.0
2021-08-18:16:47:06,56 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4689.5543, eval_time 0.8901, test_loss 2.7858, test_accuracy 0.698, test_5_accuracy 1.0 

2021-08-18:16:47:06,92 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:06,104 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:06,142 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:06,160 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:07,621 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:07,634 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:08,189 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:08,202 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:08,684 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:08,694 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:09,877 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:09,897 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:10,617 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:10,637 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:11,52 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:11,61 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:11,83 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:11,98 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:11,433 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:11,460 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:11,884 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:11,898 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:12,143 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:12,163 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:12,230 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:12,239 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:12,788 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:12,813 INFO     [learner.py:606] ====Pushing takes 0.02282118797302246 s
2021-08-18:16:47:12,849 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:12,856 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:12,857 INFO     [param_server.py:410] Lock worker 1 with localStep 353 , while globalStep is 352

2021-08-18:16:47:14,920 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:14,925 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:14,939 INFO     [learner.py:606] ====Pushing takes 0.01569366455078125 s
2021-08-18:16:47:14,945 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:14,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:14,964 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:14,965 INFO     [param_server.py:410] Lock worker 2 with localStep 353 , while globalStep is 352

2021-08-18:16:47:15,762 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:15,782 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:17,634 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:17,646 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:18,188 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:18,219 INFO     [learner.py:606] ====Pushing takes 0.029616117477416992 s
2021-08-18:16:47:18,258 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:18,265 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:18,266 INFO     [param_server.py:381] ====After aggregation in epoch: 352, virtual_clock: 15222.41012876949, top_1: : 67.8283 % (2102.0), top_5: : 100.0 % (3099.0), test loss: 3.054617091461464, test len: 3099.0
2021-08-18:16:47:18,268 INFO     [param_server.py:410] Lock worker 3 with localStep 353 , while globalStep is 353

2021-08-18:16:47:18,269 INFO     [param_server.py:441] ====Epoch 354 completes 17 clients with loss 48.869189934609345, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:18,269 INFO     [param_server.py:450] ====Start to sample for epoch 354, global virtualClock: 15222.41012876949, round_duration: 67.37786812921225
2021-08-18:16:47:18,270 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:18,593 INFO     [param_server.py:553] For epoch: 354, median_reward: 320.58134865911506, dev: 320.58134865911506
2021-08-18:16:47:19,193 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7301, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:47:19,195 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4702.695, eval_time 0.5764, test_loss 2.7301, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:47:19,209 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7954, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:47:19,210 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4702.7108, eval_time 0.5924, test_loss 2.7954, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:47:19,231 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9721, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:47:19,232 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4702.7308, eval_time 0.6142, test_loss 2.9721, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:47:19,292 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:19,302 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:19,306 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:19,312 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:19,314 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:19,327 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:20,776 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:20,797 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:21,524 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:21,547 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:22,87 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:22,101 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:23,487 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:23,505 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:24,361 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:24,375 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:24,387 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:24,388 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:24,729 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:24,743 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:25,253 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:25,280 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:25,632 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:25,650 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:25,685 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:25,694 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:26,92 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:26,113 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:26,697 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:26,723 INFO     [learner.py:606] ====Pushing takes 0.024819612503051758 s
2021-08-18:16:47:26,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:26,758 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:26,759 INFO     [param_server.py:410] Lock worker 1 with localStep 354 , while globalStep is 353

2021-08-18:16:47:28,377 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:28,394 INFO     [learner.py:606] ====Pushing takes 0.015069723129272461 s
2021-08-18:16:47:28,413 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:28,418 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:28,419 INFO     [param_server.py:410] Lock worker 2 with localStep 354 , while globalStep is 353

2021-08-18:16:47:28,502 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:28,512 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:29,221 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:29,230 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:30,918 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:30,929 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:31,522 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:31,552 INFO     [learner.py:606] ====Pushing takes 0.029290437698364258 s
2021-08-18:16:47:31,583 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:31,591 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:31,592 INFO     [param_server.py:381] ====After aggregation in epoch: 353, virtual_clock: 15289.787996898702, top_1: : 67.3766 % (2088.0), top_5: : 100.0 % (3099.0), test loss: 2.832528997350622, test len: 3099.0
2021-08-18:16:47:31,595 INFO     [param_server.py:410] Lock worker 3 with localStep 354 , while globalStep is 354

2021-08-18:16:47:31,595 INFO     [param_server.py:441] ====Epoch 355 completes 17 clients with loss 128.04236766567317, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:31,596 INFO     [param_server.py:450] ====Start to sample for epoch 355, global virtualClock: 15289.787996898702, round_duration: 67.37786812921225
2021-08-18:16:47:31,596 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:31,873 INFO     [param_server.py:553] For epoch: 355, median_reward: 324.7363982490244, dev: 324.7363982490244
2021-08-18:16:47:32,528 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8889, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:47:32,530 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4716.03, eval_time 0.6221, test_loss 2.8889, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:47:32,566 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5817, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:47:32,567 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4716.0673, eval_time 0.6591, test_loss 2.5817, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:47:32,638 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8816, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:47:32,642 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4716.1409, eval_time 0.7347, test_loss 2.8816, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:47:32,647 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:32,660 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:32,667 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:32,675 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:32,713 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:32,742 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:34,331 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:34,364 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:34,774 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:34,791 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:35,656 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:35,676 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:37,128 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:37,142 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:37,612 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:37,621 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:37,821 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:37,842 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:38,266 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:38,276 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:38,595 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:38,610 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:38,883 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:38,887 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:38,893 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:38,896 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:39,206 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:39,221 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:39,756 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:39,779 INFO     [learner.py:606] ====Pushing takes 0.021634817123413086 s
2021-08-18:16:47:39,815 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:39,822 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:39,823 INFO     [param_server.py:410] Lock worker 1 with localStep 355 , while globalStep is 354

2021-08-18:16:47:41,543 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:41,552 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:41,592 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:41,608 INFO     [learner.py:606] ====Pushing takes 0.014229297637939453 s
2021-08-18:16:47:41,625 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:41,630 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:41,631 INFO     [param_server.py:410] Lock worker 2 with localStep 355 , while globalStep is 354

2021-08-18:16:47:42,242 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:42,252 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:43,953 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:43,966 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:44,711 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:44,741 INFO     [learner.py:606] ====Pushing takes 0.028652667999267578 s
2021-08-18:16:47:44,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:44,789 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:44,789 INFO     [param_server.py:381] ====After aggregation in epoch: 354, virtual_clock: 15357.165865027913, top_1: : 67.4088 % (2089.0), top_5: : 100.0 % (3099.0), test loss: 2.784044914775425, test len: 3099.0
2021-08-18:16:47:44,792 INFO     [param_server.py:410] Lock worker 3 with localStep 355 , while globalStep is 355

2021-08-18:16:47:44,792 INFO     [param_server.py:441] ====Epoch 356 completes 17 clients with loss 37.32883828974193, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:44,793 INFO     [param_server.py:450] ====Start to sample for epoch 356, global virtualClock: 15357.165865027913, round_duration: 67.37786812921225
2021-08-18:16:47:44,794 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:45,95 INFO     [param_server.py:553] For epoch: 356, median_reward: 314.2478199743851, dev: 314.2478199743851
2021-08-18:16:47:45,705 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3016, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:47:45,708 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4729.2079, eval_time 0.5579, test_loss 3.3016, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:47:45,786 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:47:45,799 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:45,812 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0859, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:47:45,812 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4729.3129, eval_time 0.6603, test_loss 3.0859, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:47:45,860 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.123, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:47:45,861 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4729.3593, eval_time 0.711, test_loss 3.123, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:47:45,883 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:47:45,912 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:45,944 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:47:45,978 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:47,488 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:47,508 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:48,119 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:48,140 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:48,922 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:48,931 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:49,884 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:49,903 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:50,564 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:50,574 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:51,50 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:51,60 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:51,309 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:51,328 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:51,340 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:51,352 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:52,48 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:52,66 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:52,136 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:52,147 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:52,334 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:52,343 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:52,672 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:52,698 INFO     [learner.py:606] ====Pushing takes 0.02475762367248535 s
2021-08-18:16:47:52,733 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:52,742 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:52,743 INFO     [param_server.py:410] Lock worker 1 with localStep 356 , while globalStep is 355

2021-08-18:16:47:54,896 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:54,918 INFO     [learner.py:606] ====Pushing takes 0.017659664154052734 s
2021-08-18:16:47:54,934 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:54,939 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:54,940 INFO     [param_server.py:410] Lock worker 2 with localStep 356 , while globalStep is 355

2021-08-18:16:47:54,968 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:54,996 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:55,976 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:56,3 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:58,39 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:58,59 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:58,799 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:58,833 INFO     [learner.py:606] ====Pushing takes 0.03274703025817871 s
2021-08-18:16:47:58,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:58,883 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:58,884 INFO     [param_server.py:381] ====After aggregation in epoch: 355, virtual_clock: 15424.543733157125, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 3.1701424298463046, test len: 3099.0
2021-08-18:16:47:58,887 INFO     [param_server.py:410] Lock worker 3 with localStep 356 , while globalStep is 356

2021-08-18:16:47:58,888 INFO     [param_server.py:441] ====Epoch 357 completes 17 clients with loss 76.44380065916279, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:58,888 INFO     [param_server.py:450] ====Start to sample for epoch 357, global virtualClock: 15424.543733157125, round_duration: 67.37786812921225
2021-08-18:16:47:58,889 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:59,182 INFO     [param_server.py:553] For epoch: 357, median_reward: 341.183443982906, dev: 341.183443982906
2021-08-18:16:47:59,885 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6829, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:47:59,886 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4743.3863, eval_time 0.6806, test_loss 2.6829, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:47:59,891 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6164, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:47:59,892 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4743.3924, eval_time 0.6863, test_loss 2.6164, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:47:59,920 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0597, Top-1 Accuracy: 719.0/1033 (0.696), Top-5 Accuracy: 1.0
2021-08-18:16:47:59,921 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4743.4192, eval_time 0.7152, test_loss 3.0597, test_accuracy 0.696, test_5_accuracy 1.0 

2021-08-18:16:47:59,976 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:47:59,985 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:59,990 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:47:59,999 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:00,15 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:48:00,29 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:01,459 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:01,473 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:02,396 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:02,410 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:02,749 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:02,758 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:03,805 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:03,823 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:04,608 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:04,622 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:05,75 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:05,87 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:05,107 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:05,118 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:05,388 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:05,416 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:05,780 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:05,800 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:06,285 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:06,319 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:06,344 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:06,357 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:07,45 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:07,83 INFO     [learner.py:606] ====Pushing takes 0.03526139259338379 s
2021-08-18:16:48:07,133 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:07,148 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:07,149 INFO     [param_server.py:410] Lock worker 1 with localStep 357 , while globalStep is 356

2021-08-18:16:48:09,1 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:09,17 INFO     [learner.py:606] ====Pushing takes 0.014139652252197266 s
2021-08-18:16:48:09,39 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:09,46 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:09,46 INFO     [param_server.py:410] Lock worker 2 with localStep 357 , while globalStep is 356

2021-08-18:16:48:09,75 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:09,88 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:09,907 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:09,917 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:11,583 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:11,596 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:12,323 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:12,369 INFO     [learner.py:606] ====Pushing takes 0.04497385025024414 s
2021-08-18:16:48:12,408 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:12,416 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:12,417 INFO     [param_server.py:381] ====After aggregation in epoch: 356, virtual_clock: 15491.921601286336, top_1: : 67.9251 % (2105.0), top_5: : 100.0 % (3099.0), test loss: 2.7863305166915615, test len: 3099.0
2021-08-18:16:48:12,420 INFO     [param_server.py:410] Lock worker 3 with localStep 357 , while globalStep is 357

2021-08-18:16:48:12,420 INFO     [param_server.py:441] ====Epoch 358 completes 17 clients with loss 141.25774353231085, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:12,421 INFO     [param_server.py:450] ====Start to sample for epoch 358, global virtualClock: 15491.921601286336, round_duration: 67.37786812921225
2021-08-18:16:48:12,422 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:48:12,752 INFO     [param_server.py:553] For epoch: 358, median_reward: 347.87955676524257, dev: 347.87955676524257
2021-08-18:16:48:13,401 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0742, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:48:13,402 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8787, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:48:13,405 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4756.9057, eval_time 0.6297, test_loss 3.0742, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:48:13,406 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4756.9061, eval_time 0.6278, test_loss 3.8787, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:48:13,436 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1013, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:48:13,458 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4756.9566, eval_time 0.6823, test_loss 4.1013, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:48:13,488 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:13,497 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:13,498 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:13,507 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:13,536 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:13,552 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:15,15 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:15,36 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:15,731 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:15,745 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:16,86 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:16,97 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:17,981 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:18,8 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:18,523 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:18,533 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:19,38 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:19,64 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:19,130 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:19,150 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:19,890 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:19,911 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:20,11 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:20,26 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:20,299 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:20,313 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:20,570 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:20,593 INFO     [learner.py:606] ====Pushing takes 0.021872282028198242 s
2021-08-18:16:48:20,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:20,630 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:48:20,631 INFO     [param_server.py:410] Lock worker 1 with localStep 358 , while globalStep is 357

2021-08-18:16:48:22,681 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:22,696 INFO     [learner.py:606] ====Pushing takes 0.013736963272094727 s
2021-08-18:16:48:22,714 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:22,721 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:48:22,721 INFO     [param_server.py:410] Lock worker 2 with localStep 358 , while globalStep is 357

2021-08-18:16:48:22,831 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:22,842 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:24,180 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:24,189 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:25,825 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:25,837 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:26,469 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:26,500 INFO     [learner.py:606] ====Pushing takes 0.030074119567871094 s
2021-08-18:16:48:26,535 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:26,548 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:48:26,548 INFO     [param_server.py:381] ====After aggregation in epoch: 357, virtual_clock: 15562.543362822009, top_1: : 65.8277 % (2040.0), top_5: : 100.0 % (3099.0), test loss: 3.6847426891326904, test len: 3099.0
2021-08-18:16:48:26,551 INFO     [param_server.py:410] Lock worker 3 with localStep 358 , while globalStep is 358

2021-08-18:16:48:26,552 INFO     [param_server.py:441] ====Epoch 359 completes 16 clients with loss 4.756588078172652, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:26,575 INFO     [param_server.py:450] ====Start to sample for epoch 359, global virtualClock: 15562.543362822009, round_duration: 70.62176153567286
2021-08-18:16:48:26,576 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:48:26,919 INFO     [param_server.py:553] For epoch: 359, median_reward: 346.5486562763502, dev: 346.5486562763502
2021-08-18:16:48:27,552 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1005, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:48:27,556 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4771.056, eval_time 0.5912, test_loss 3.1005, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:48:27,594 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7325, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:48:27,595 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4771.0951, eval_time 0.6237, test_loss 2.7325, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:48:27,620 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2579, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:48:27,621 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4771.1201, eval_time 0.6571, test_loss 3.2579, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:48:27,642 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:27,655 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:27,662 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:27,683 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:27,689 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:27,713 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:29,450 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:29,484 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:30,26 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:30,44 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:30,998 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:31,18 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:31,747 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:31,760 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:32,418 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:32,436 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:32,745 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:32,755 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:33,191 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:33,210 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:33,315 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:33,324 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:33,773 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:33,793 INFO     [learner.py:606] ====Pushing takes 0.0181884765625 s
2021-08-18:16:48:33,827 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:33,832 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:48:33,833 INFO     [param_server.py:410] Lock worker 1 with localStep 359 , while globalStep is 358

2021-08-18:16:48:34,125 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:34,134 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:34,543 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:34,562 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:36,720 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:36,733 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:36,994 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:37,10 INFO     [learner.py:606] ====Pushing takes 0.014308452606201172 s
2021-08-18:16:48:37,25 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:37,30 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:48:37,31 INFO     [param_server.py:410] Lock worker 2 with localStep 359 , while globalStep is 358

2021-08-18:16:48:38,41 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:38,62 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:39,990 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:40,18 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:40,799 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:40,830 INFO     [learner.py:606] ====Pushing takes 0.029575586318969727 s
2021-08-18:16:48:40,867 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:40,875 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:48:40,876 INFO     [param_server.py:381] ====After aggregation in epoch: 358, virtual_clock: 15633.165124357682, top_1: : 66.6344 % (2065.0), top_5: : 100.0 % (3099.0), test loss: 3.0302989328349077, test len: 3099.0
2021-08-18:16:48:40,879 INFO     [param_server.py:410] Lock worker 3 with localStep 359 , while globalStep is 359

2021-08-18:16:48:40,879 INFO     [param_server.py:441] ====Epoch 360 completes 16 clients with loss 6.179211141339655, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:40,879 INFO     [param_server.py:450] ====Start to sample for epoch 360, global virtualClock: 15633.165124357682, round_duration: 70.62176153567286
2021-08-18:16:48:40,880 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:48:41,207 INFO     [param_server.py:553] For epoch: 360, median_reward: 362.90765252234553, dev: 362.90765252234553
2021-08-18:16:48:41,969 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9883, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:48:41,970 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4785.4704, eval_time 0.7272, test_loss 2.9883, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:48:41,970 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.6445, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:48:41,971 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4785.4716, eval_time 0.7288, test_loss 4.6445, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:48:41,990 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0189, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:48:41,992 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4785.4905, eval_time 0.7494, test_loss 3.0189, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:48:42,37 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:48:42,53 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:42,64 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:48:42,76 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:42,77 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:48:42,97 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:43,365 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:43,379 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:44,254 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:44,267 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:44,734 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:44,743 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:45,706 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:45,720 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:46,615 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:46,643 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:47,6 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:47,24 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:47,104 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:47,114 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:47,385 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:47,412 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:47,861 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:47,874 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:48,26 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:48,51 INFO     [learner.py:606] ====Pushing takes 0.018901348114013672 s
2021-08-18:16:48:48,77 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:48,85 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:48:48,86 INFO     [param_server.py:410] Lock worker 1 with localStep 360 , while globalStep is 359

2021-08-18:16:48:48,790 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:48,805 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:50,779 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:50,792 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:51,266 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:51,281 INFO     [learner.py:606] ====Pushing takes 0.013689279556274414 s
2021-08-18:16:48:51,296 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:51,305 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:48:51,306 INFO     [param_server.py:410] Lock worker 2 with localStep 360 , while globalStep is 359

2021-08-18:16:48:52,265 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:52,279 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:53,982 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:54,0 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:54,680 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:54,709 INFO     [learner.py:606] ====Pushing takes 0.02694225311279297 s
2021-08-18:16:48:54,738 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:54,746 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:48:54,746 INFO     [param_server.py:381] ====After aggregation in epoch: 359, virtual_clock: 15703.786885893354, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.5505816693659185, test len: 3099.0
2021-08-18:16:48:54,749 INFO     [param_server.py:410] Lock worker 3 with localStep 360 , while globalStep is 360

2021-08-18:16:48:54,749 INFO     [param_server.py:441] ====Epoch 361 completes 16 clients with loss 3.847640295504444, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:54,750 INFO     [param_server.py:450] ====Start to sample for epoch 361, global virtualClock: 15703.786885893354, round_duration: 70.62176153567286
2021-08-18:16:48:54,751 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:48:55,82 INFO     [param_server.py:541] Handle Wight 0.0329592227935791 | Send 0.3326709270477295
2021-08-18:16:48:55,83 INFO     [param_server.py:553] For epoch: 361, median_reward: 345.64408317465643, dev: 345.64408317465643
2021-08-18:16:48:55,754 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1302, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:48:55,755 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4799.2552, eval_time 0.644, test_loss 3.1302, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:48:55,771 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0742, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:48:55,772 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4799.2725, eval_time 0.661, test_loss 3.0742, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:48:55,817 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4038, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:48:55,818 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4799.3168, eval_time 0.7118, test_loss 3.4038, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:48:55,841 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:48:55,850 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:55,859 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:48:55,874 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:55,889 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:48:55,901 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:57,404 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:57,424 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:58,180 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:58,190 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:58,871 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:58,892 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:00,23 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:00,50 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:00,998 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:01,19 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:01,36 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:01,57 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:01,506 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:01,516 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:01,650 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:01,664 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:02,194 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:02,203 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:02,262 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:02,283 INFO     [learner.py:606] ====Pushing takes 0.01874375343322754 s
2021-08-18:16:49:02,312 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:02,318 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:02,319 INFO     [param_server.py:410] Lock worker 1 with localStep 361 , while globalStep is 360

2021-08-18:16:49:02,762 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:02,780 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:04,978 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:04,989 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:04,996 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:05,7 INFO     [learner.py:606] ====Pushing takes 0.014216423034667969 s
2021-08-18:16:49:05,24 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:05,32 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:05,32 INFO     [param_server.py:410] Lock worker 2 with localStep 361 , while globalStep is 360

2021-08-18:16:49:06,379 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:06,390 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:08,53 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:08,70 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:08,715 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:08,745 INFO     [learner.py:606] ====Pushing takes 0.027801036834716797 s
2021-08-18:16:49:08,775 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:08,783 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:08,783 INFO     [param_server.py:381] ====After aggregation in epoch: 360, virtual_clock: 15774.408647429027, top_1: : 67.0539 % (2078.0), top_5: : 100.0 % (3099.0), test loss: 3.2027353004173, test len: 3099.0
2021-08-18:16:49:08,786 INFO     [param_server.py:410] Lock worker 3 with localStep 361 , while globalStep is 361

2021-08-18:16:49:08,786 INFO     [param_server.py:441] ====Epoch 362 completes 16 clients with loss 5.874096141609941, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:08,787 INFO     [param_server.py:450] ====Start to sample for epoch 362, global virtualClock: 15774.408647429027, round_duration: 70.62176153567286
2021-08-18:16:49:08,787 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:09,53 INFO     [param_server.py:553] For epoch: 362, median_reward: 355.7765046217379, dev: 355.7765046217379
2021-08-18:16:49:09,828 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8388, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:49:09,829 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4813.3294, eval_time 0.7402, test_loss 2.8388, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:49:09,831 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.82, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:49:09,832 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4813.3322, eval_time 0.7443, test_loss 2.82, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:49:09,865 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1791, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:49:09,912 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:09,901 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:09,913 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4813.4119, eval_time 0.8265, test_loss 3.1791, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:49:09,926 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:09,927 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:10,4 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:10,24 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:11,469 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:11,482 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:12,77 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:12,86 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:12,739 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:12,750 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:13,886 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:13,907 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:14,747 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:14,775 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:15,31 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:15,45 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:15,95 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:15,109 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:15,585 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:15,612 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:15,924 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:15,938 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:16,209 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:16,230 INFO     [learner.py:606] ====Pushing takes 0.01943206787109375 s
2021-08-18:16:49:16,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:16,265 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:16,265 INFO     [param_server.py:410] Lock worker 1 with localStep 362 , while globalStep is 361

2021-08-18:16:49:16,832 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:16,846 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:18,578 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:18,588 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:19,120 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:19,135 INFO     [learner.py:606] ====Pushing takes 0.013626813888549805 s
2021-08-18:16:49:19,151 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:19,159 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:19,159 INFO     [param_server.py:410] Lock worker 2 with localStep 362 , while globalStep is 361

2021-08-18:16:49:19,839 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:19,853 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:21,816 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:21,831 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:22,525 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:22,553 INFO     [learner.py:606] ====Pushing takes 0.027209997177124023 s
2021-08-18:16:49:22,596 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:22,607 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:22,607 INFO     [param_server.py:381] ====After aggregation in epoch: 361, virtual_clock: 15845.0304089647, top_1: : 67.4411 % (2090.0), top_5: : 100.0 % (3099.0), test loss: 2.945947309335073, test len: 3099.0
2021-08-18:16:49:22,610 INFO     [param_server.py:410] Lock worker 3 with localStep 362 , while globalStep is 362

2021-08-18:16:49:22,610 INFO     [param_server.py:441] ====Epoch 363 completes 16 clients with loss 5.084861325013539, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:22,610 INFO     [param_server.py:450] ====Start to sample for epoch 363, global virtualClock: 15845.0304089647, round_duration: 70.62176153567286
2021-08-18:16:49:22,611 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:22,903 INFO     [param_server.py:553] For epoch: 363, median_reward: 344.1701954723977, dev: 344.1701954723977
2021-08-18:16:49:23,517 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9868, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:49:23,523 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4827.0235, eval_time 0.5897, test_loss 2.9868, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:49:23,563 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0139, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:49:23,567 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4827.0672, eval_time 0.6354, test_loss 3.0139, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:49:23,597 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:23,606 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:23,607 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1526, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:49:23,607 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4827.106, eval_time 0.6817, test_loss 3.1526, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:49:23,660 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:23,674 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:23,680 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:23,696 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:24,880 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:24,894 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:25,783 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:25,793 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:26,352 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:26,366 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:27,446 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:27,466 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:28,244 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:28,271 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:28,640 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:28,656 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:28,880 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:28,890 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:28,921 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:28,935 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:29,515 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:29,536 INFO     [learner.py:606] ====Pushing takes 0.019346237182617188 s
2021-08-18:16:49:29,559 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:29,568 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:29,568 INFO     [param_server.py:410] Lock worker 1 with localStep 363 , while globalStep is 362

2021-08-18:16:49:29,574 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:29,584 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:30,505 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:30,515 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:32,467 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:32,481 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:32,929 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:32,945 INFO     [learner.py:606] ====Pushing takes 0.014289617538452148 s
2021-08-18:16:49:32,964 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:32,969 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:32,970 INFO     [param_server.py:410] Lock worker 2 with localStep 363 , while globalStep is 362

2021-08-18:16:49:33,715 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:33,726 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:35,300 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:35,309 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:35,958 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:35,989 INFO     [learner.py:606] ====Pushing takes 0.029336929321289062 s
2021-08-18:16:49:36,19 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:36,27 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:36,27 INFO     [param_server.py:381] ====After aggregation in epoch: 362, virtual_clock: 15915.652170500372, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.0511035080309266, test len: 3099.0
2021-08-18:16:49:36,30 INFO     [param_server.py:410] Lock worker 3 with localStep 363 , while globalStep is 363

2021-08-18:16:49:36,30 INFO     [param_server.py:441] ====Epoch 364 completes 16 clients with loss 5.212801876824107, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:36,31 INFO     [param_server.py:450] ====Start to sample for epoch 364, global virtualClock: 15915.652170500372, round_duration: 70.62176153567286
2021-08-18:16:49:36,31 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:36,356 INFO     [param_server.py:553] For epoch: 364, median_reward: 343.42329822937853, dev: 343.42329822937853
2021-08-18:16:49:37,34 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7136, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:49:37,35 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4840.5357, eval_time 0.6558, test_loss 2.7136, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:49:37,73 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.068, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:49:37,74 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4840.5748, eval_time 0.6952, test_loss 3.068, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:49:37,84 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0222, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:49:37,86 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4840.5841, eval_time 0.7063, test_loss 3.0222, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:49:37,104 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:37,121 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:37,130 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:37,144 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:37,150 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:37,170 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:38,656 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:38,682 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:39,379 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:39,392 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:40,117 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:40,135 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:41,232 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:41,254 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:42,113 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:42,133 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:42,299 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:42,314 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:42,454 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:42,472 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:42,958 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:42,978 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:43,270 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:43,284 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:43,632 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:43,658 INFO     [learner.py:606] ====Pushing takes 0.02160930633544922 s
2021-08-18:16:49:43,688 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:43,693 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:43,694 INFO     [param_server.py:410] Lock worker 1 with localStep 364 , while globalStep is 363

2021-08-18:16:49:43,974 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:43,985 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:46,56 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:46,65 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:46,213 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:46,228 INFO     [learner.py:606] ====Pushing takes 0.013305187225341797 s
2021-08-18:16:49:46,242 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:46,247 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:46,248 INFO     [param_server.py:410] Lock worker 2 with localStep 364 , while globalStep is 363

2021-08-18:16:49:47,338 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:47,350 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:48,926 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:48,944 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:49,605 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:49,634 INFO     [learner.py:606] ====Pushing takes 0.02705073356628418 s
2021-08-18:16:49:49,665 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:49,676 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:49,677 INFO     [param_server.py:381] ====After aggregation in epoch: 363, virtual_clock: 15986.273932036045, top_1: : 67.8283 % (2102.0), top_5: : 100.0 % (3099.0), test loss: 2.934597858676204, test len: 3099.0
2021-08-18:16:49:49,680 INFO     [param_server.py:410] Lock worker 3 with localStep 364 , while globalStep is 364

2021-08-18:16:49:49,680 INFO     [param_server.py:441] ====Epoch 365 completes 16 clients with loss 5.364302928013192, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:49,681 INFO     [param_server.py:450] ====Start to sample for epoch 365, global virtualClock: 15986.273932036045, round_duration: 70.62176153567286
2021-08-18:16:49:49,682 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:49,961 INFO     [param_server.py:553] For epoch: 365, median_reward: 359.98336595680513, dev: 359.98336595680513
2021-08-18:16:49:50,723 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3447, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:49:50,724 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0417, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:49:50,725 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4854.2254, eval_time 0.7237, test_loss 3.0417, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:49:50,725 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4854.225, eval_time 0.7281, test_loss 3.3447, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:49:50,794 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:49:50,808 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:50,810 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8001, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:49:50,811 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4854.3095, eval_time 0.8144, test_loss 3.8001, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:49:50,813 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:49:50,828 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:50,880 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:49:50,902 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:52,238 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:52,258 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:52,911 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:52,921 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:53,589 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:53,603 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:54,755 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:54,776 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:55,639 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:55,659 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:55,723 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:55,742 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:55,874 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:55,883 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:56,382 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:56,403 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:56,648 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:56,662 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:57,23 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:57,45 INFO     [learner.py:606] ====Pushing takes 0.02072739601135254 s
2021-08-18:16:49:57,81 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:57,87 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:57,88 INFO     [param_server.py:410] Lock worker 1 with localStep 365 , while globalStep is 364

2021-08-18:16:49:57,516 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:57,526 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:59,466 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:59,478 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:59,730 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:59,746 INFO     [learner.py:606] ====Pushing takes 0.014344453811645508 s
2021-08-18:16:49:59,771 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:59,776 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:59,777 INFO     [param_server.py:410] Lock worker 2 with localStep 365 , while globalStep is 364

2021-08-18:16:50:00,803 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:00,817 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:02,662 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:02,680 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:03,327 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:03,357 INFO     [learner.py:606] ====Pushing takes 0.028078556060791016 s
2021-08-18:16:50:03,398 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:03,406 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:03,407 INFO     [param_server.py:381] ====After aggregation in epoch: 364, virtual_clock: 16056.895693571718, top_1: : 63.6012 % (1971.0), top_5: : 100.0 % (3099.0), test loss: 3.395503211904455, test len: 3099.0
2021-08-18:16:50:03,409 INFO     [param_server.py:410] Lock worker 3 with localStep 365 , while globalStep is 365

2021-08-18:16:50:03,410 INFO     [param_server.py:441] ====Epoch 366 completes 16 clients with loss 4.137623988380115, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:03,410 INFO     [param_server.py:450] ====Start to sample for epoch 366, global virtualClock: 16056.895693571718, round_duration: 70.62176153567286
2021-08-18:16:50:03,411 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:03,667 INFO     [param_server.py:553] For epoch: 366, median_reward: 332.4327144479976, dev: 332.4327144479976
2021-08-18:16:50:04,474 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0582, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:50:04,475 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4867.9754, eval_time 0.7591, test_loss 4.0582, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:50:04,479 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7959, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:50:04,480 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4867.9801, eval_time 0.7597, test_loss 2.7959, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:50:04,545 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2578, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:50:04,549 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4868.0474, eval_time 0.8357, test_loss 3.2578, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:50:04,550 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:04,563 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:04,568 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:04,583 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:04,617 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:04,640 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:05,923 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:05,937 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:06,680 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:06,691 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:07,230 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:07,241 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:08,160 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:08,175 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:08,985 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:08,999 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:09,404 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:09,414 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:09,498 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:09,516 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:09,614 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:09,627 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:10,94 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:10,104 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:10,216 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:10,238 INFO     [learner.py:606] ====Pushing takes 0.020015716552734375 s
2021-08-18:16:50:10,272 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:10,280 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:10,280 INFO     [param_server.py:410] Lock worker 1 with localStep 366 , while globalStep is 365

2021-08-18:16:50:11,265 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:11,275 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:13,87 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:13,107 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:13,728 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:13,746 INFO     [learner.py:606] ====Pushing takes 0.0137481689453125 s
2021-08-18:16:50:13,770 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:13,776 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:13,776 INFO     [param_server.py:410] Lock worker 2 with localStep 366 , while globalStep is 365

2021-08-18:16:50:14,527 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:14,541 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:16,268 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:16,277 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:16,856 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:16,884 INFO     [learner.py:606] ====Pushing takes 0.02776050567626953 s
2021-08-18:16:50:16,916 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:16,924 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:16,925 INFO     [param_server.py:381] ====After aggregation in epoch: 365, virtual_clock: 16127.51745510739, top_1: : 68.0542 % (2109.0), top_5: : 100.0 % (3099.0), test loss: 3.3706261493541576, test len: 3099.0
2021-08-18:16:50:16,927 INFO     [param_server.py:410] Lock worker 3 with localStep 366 , while globalStep is 366

2021-08-18:16:50:16,928 INFO     [param_server.py:441] ====Epoch 367 completes 16 clients with loss 7.11980149647543, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:16,928 INFO     [param_server.py:450] ====Start to sample for epoch 367, global virtualClock: 16127.51745510739, round_duration: 70.62176153567286
2021-08-18:16:50:16,929 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:17,270 INFO     [param_server.py:553] For epoch: 367, median_reward: 357.2998282058386, dev: 357.2998282058386
2021-08-18:16:50:17,942 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7311, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:50:17,943 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4881.444, eval_time 0.6468, test_loss 2.7311, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:50:17,978 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8244, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:50:17,979 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4881.4779, eval_time 0.6867, test_loss 2.8244, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:50:17,980 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0901, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:50:17,982 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4881.4823, eval_time 0.6877, test_loss 3.0901, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:50:18,13 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:18,30 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:18,47 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:18,60 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:18,60 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:18,76 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:19,415 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:19,436 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:20,194 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:20,213 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:20,763 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:20,773 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:21,801 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:21,822 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:22,621 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:22,642 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:23,96 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:23,111 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:23,213 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:23,231 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:23,421 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:23,448 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:23,987 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:24,9 INFO     [learner.py:606] ====Pushing takes 0.02065134048461914 s
2021-08-18:16:50:24,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:24,44 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:24,44 INFO     [param_server.py:410] Lock worker 1 with localStep 367 , while globalStep is 366

2021-08-18:16:50:24,86 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:24,113 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:24,930 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:24,975 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:27,151 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:27,161 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:27,283 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:27,299 INFO     [learner.py:606] ====Pushing takes 0.014410018920898438 s
2021-08-18:16:50:27,316 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:27,322 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:27,323 INFO     [param_server.py:410] Lock worker 2 with localStep 367 , while globalStep is 366

2021-08-18:16:50:28,292 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:28,304 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:29,964 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:29,975 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:30,682 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:30,712 INFO     [learner.py:606] ====Pushing takes 0.0283203125 s
2021-08-18:16:50:30,742 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:30,754 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:30,755 INFO     [param_server.py:381] ====After aggregation in epoch: 366, virtual_clock: 16198.139216643063, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 2.881863080792957, test len: 3099.0
2021-08-18:16:50:30,757 INFO     [param_server.py:410] Lock worker 3 with localStep 367 , while globalStep is 367

2021-08-18:16:50:30,758 INFO     [param_server.py:441] ====Epoch 368 completes 16 clients with loss 4.5145416121535, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:30,758 INFO     [param_server.py:450] ====Start to sample for epoch 368, global virtualClock: 16198.139216643063, round_duration: 70.62176153567286
2021-08-18:16:50:30,759 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:31,42 INFO     [param_server.py:553] For epoch: 368, median_reward: 339.5658124020926, dev: 339.5658124020926
2021-08-18:16:50:31,674 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1249, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:50:31,675 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4895.175, eval_time 0.608, test_loss 4.1249, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:50:31,713 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9915, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:50:31,715 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4895.2133, eval_time 0.6496, test_loss 2.9915, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:50:31,714 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4776, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:50:31,717 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4895.2175, eval_time 0.6508, test_loss 3.4776, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:50:31,746 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:31,755 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:31,787 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:31,787 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:31,804 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:31,806 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:33,191 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:33,212 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:33,869 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:33,880 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:34,440 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:34,461 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:35,936 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:35,969 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:36,822 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:36,849 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:36,869 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:36,887 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:37,193 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:37,212 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:37,683 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:37,702 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:37,875 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:37,890 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:38,248 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:38,280 INFO     [learner.py:606] ====Pushing takes 0.02716517448425293 s
2021-08-18:16:50:38,316 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:38,322 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:38,323 INFO     [param_server.py:410] Lock worker 1 with localStep 368 , while globalStep is 367

2021-08-18:16:50:38,758 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:38,769 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:40,536 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:40,547 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:41,92 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:41,108 INFO     [learner.py:606] ====Pushing takes 0.013969898223876953 s
2021-08-18:16:50:41,123 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:41,129 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:41,130 INFO     [param_server.py:410] Lock worker 2 with localStep 368 , while globalStep is 367

2021-08-18:16:50:41,707 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:41,717 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:43,290 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:43,302 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:43,961 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:43,990 INFO     [learner.py:606] ====Pushing takes 0.027602434158325195 s
2021-08-18:16:50:44,22 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:44,30 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:44,31 INFO     [param_server.py:381] ====After aggregation in epoch: 367, virtual_clock: 16268.760978178736, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 3.531357395290225, test len: 3099.0
2021-08-18:16:50:44,33 INFO     [param_server.py:410] Lock worker 3 with localStep 368 , while globalStep is 368

2021-08-18:16:50:44,34 INFO     [param_server.py:441] ====Epoch 369 completes 16 clients with loss 4.1221075376059435, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:44,34 INFO     [param_server.py:450] ====Start to sample for epoch 369, global virtualClock: 16268.760978178736, round_duration: 70.62176153567286
2021-08-18:16:50:44,35 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:44,314 INFO     [param_server.py:553] For epoch: 369, median_reward: 330.32836531574924, dev: 330.32836531574924
2021-08-18:16:50:45,5 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.3539, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:50:45,5 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4908.5059, eval_time 0.6463, test_loss 5.3539, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:50:45,12 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0064, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:50:45,13 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4908.5135, eval_time 0.651, test_loss 3.0064, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:50:45,73 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0952, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:50:45,74 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:50:45,74 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4908.5729, eval_time 0.7151, test_loss 3.0952, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:50:45,82 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:50:45,89 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:45,96 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:45,142 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:50:45,168 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:46,972 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:46,999 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:47,327 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:47,342 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:48,199 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:48,209 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:49,411 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:49,426 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:50,234 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:50,246 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:50,252 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:50,264 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:50,533 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:50,542 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:50,937 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:50,951 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:51,183 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:51,193 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:51,601 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:51,624 INFO     [learner.py:606] ====Pushing takes 0.020579814910888672 s
2021-08-18:16:50:51,657 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:51,665 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:51,666 INFO     [param_server.py:410] Lock worker 1 with localStep 369 , while globalStep is 368

2021-08-18:16:50:52,101 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:52,110 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:53,928 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:53,939 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:54,250 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:54,266 INFO     [learner.py:606] ====Pushing takes 0.014501094818115234 s
2021-08-18:16:50:54,286 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:54,291 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:54,291 INFO     [param_server.py:410] Lock worker 2 with localStep 369 , while globalStep is 368

2021-08-18:16:50:55,19 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:55,29 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:57,11 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:57,31 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:57,764 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:57,793 INFO     [learner.py:606] ====Pushing takes 0.02761220932006836 s
2021-08-18:16:50:57,832 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:57,841 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:57,842 INFO     [param_server.py:381] ====After aggregation in epoch: 368, virtual_clock: 16339.382739714409, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 3.818473431799147, test len: 3099.0
2021-08-18:16:50:57,844 INFO     [param_server.py:410] Lock worker 3 with localStep 369 , while globalStep is 369

2021-08-18:16:50:57,844 INFO     [param_server.py:441] ====Epoch 370 completes 16 clients with loss 5.493657662006649, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:57,845 INFO     [param_server.py:450] ====Start to sample for epoch 370, global virtualClock: 16339.382739714409, round_duration: 70.62176153567286
2021-08-18:16:50:57,845 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:58,107 INFO     [param_server.py:553] For epoch: 370, median_reward: 341.4094564146198, dev: 341.4094564146198
2021-08-18:16:50:58,796 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2182, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:50:58,796 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4922.2968, eval_time 0.6454, test_loss 3.2182, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:50:58,807 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7377, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:50:58,808 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4922.3086, eval_time 0.6554, test_loss 2.7377, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:50:58,855 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1977, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:50:58,858 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4922.3566, eval_time 0.7069, test_loss 3.1977, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:50:58,866 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:50:58,877 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:50:58,887 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:58,894 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:58,935 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:50:58,952 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:00,449 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:00,469 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:01,109 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:01,122 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:01,563 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:01,578 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:02,825 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:02,849 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:03,593 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:03,607 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:03,824 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:03,836 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:03,919 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:03,933 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:04,343 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:04,362 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:04,595 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:04,604 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:04,955 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:04,976 INFO     [learner.py:606] ====Pushing takes 0.01943349838256836 s
2021-08-18:16:51:05,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:05,13 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:05,13 INFO     [param_server.py:410] Lock worker 1 with localStep 370 , while globalStep is 369

2021-08-18:16:51:05,899 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:05,908 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:07,512 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:07,526 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:08,61 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:08,78 INFO     [learner.py:606] ====Pushing takes 0.013055562973022461 s
2021-08-18:16:51:08,93 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:08,101 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:08,101 INFO     [param_server.py:410] Lock worker 2 with localStep 370 , while globalStep is 369

2021-08-18:16:51:08,940 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:08,961 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:10,763 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:10,774 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:11,387 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:11,416 INFO     [learner.py:606] ====Pushing takes 0.027629375457763672 s
2021-08-18:16:51:11,447 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:11,456 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:11,456 INFO     [param_server.py:381] ====After aggregation in epoch: 369, virtual_clock: 16410.00450125008, top_1: : 66.0536 % (2047.0), top_5: : 100.0 % (3099.0), test loss: 3.051206526932893, test len: 3099.0
2021-08-18:16:51:11,459 INFO     [param_server.py:410] Lock worker 3 with localStep 370 , while globalStep is 370

2021-08-18:16:51:11,460 INFO     [param_server.py:441] ====Epoch 371 completes 16 clients with loss 4.843393472591647, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:11,460 INFO     [param_server.py:450] ====Start to sample for epoch 371, global virtualClock: 16410.00450125008, round_duration: 70.62176153567286
2021-08-18:16:51:11,461 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:11,724 INFO     [param_server.py:553] For epoch: 371, median_reward: 350.8848760080028, dev: 350.8848760080028
2021-08-18:16:51:12,332 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1255, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:51:12,333 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4935.8339, eval_time 0.5874, test_loss 3.1255, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:51:12,373 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0928, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:51:12,373 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0865, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:51:12,374 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4935.8743, eval_time 0.628, test_loss 3.0928, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:51:12,374 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4935.8727, eval_time 0.6283, test_loss 4.0865, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:51:12,403 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:12,413 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:12,443 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:12,445 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:12,458 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:12,459 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:13,891 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:13,910 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:14,687 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:14,696 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:14,784 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:14,797 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:15,642 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:15,652 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:16,222 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:16,249 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:17,76 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:17,103 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:17,722 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:17,735 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:17,913 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:17,934 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:18,344 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:18,358 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:18,562 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:18,585 INFO     [learner.py:606] ====Pushing takes 0.018734216690063477 s
2021-08-18:16:51:18,615 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:18,621 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:51:18,621 INFO     [param_server.py:410] Lock worker 1 with localStep 371 , while globalStep is 370

2021-08-18:16:51:19,551 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:19,565 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:19,704 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:19,732 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:21,654 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:21,665 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:21,692 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:21,711 INFO     [learner.py:606] ====Pushing takes 0.016810178756713867 s
2021-08-18:16:51:21,726 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:21,731 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:51:21,732 INFO     [param_server.py:410] Lock worker 2 with localStep 371 , while globalStep is 370

2021-08-18:16:51:22,341 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:22,373 INFO     [learner.py:606] ====Pushing takes 0.031228303909301758 s
2021-08-18:16:51:22,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:22,408 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:51:22,408 INFO     [param_server.py:381] ====After aggregation in epoch: 370, virtual_clock: 16483.870156192213, top_1: : 64.7951 % (2008.0), top_5: : 100.0 % (3099.0), test loss: 3.434913078943888, test len: 3099.0
2021-08-18:16:51:22,410 INFO     [param_server.py:410] Lock worker 3 with localStep 371 , while globalStep is 371

2021-08-18:16:51:22,411 INFO     [param_server.py:441] ====Epoch 372 completes 15 clients with loss 4.014979679264396, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:22,411 INFO     [param_server.py:450] ====Start to sample for epoch 372, global virtualClock: 16483.870156192213, round_duration: 73.86565494213346
2021-08-18:16:51:22,412 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:22,677 INFO     [param_server.py:553] For epoch: 372, median_reward: 345.4775893023378, dev: 345.4775893023378
2021-08-18:16:51:23,359 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.413, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:51:23,362 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4946.8627, eval_time 0.6593, test_loss 3.413, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:51:23,368 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0736, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:51:23,369 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4946.8691, eval_time 0.6638, test_loss 3.0736, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:51:23,393 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4189, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:51:23,394 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4946.8924, eval_time 0.693, test_loss 3.4189, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:51:23,430 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:23,438 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:23,462 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:23,462 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:23,471 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:23,476 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:24,857 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:24,878 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:25,631 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:25,645 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:25,753 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:25,771 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:26,346 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:26,360 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:27,339 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:27,360 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:28,229 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:28,249 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:28,318 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:28,332 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:28,922 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:28,932 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:29,10 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:29,23 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:29,670 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:29,691 INFO     [learner.py:606] ====Pushing takes 0.01948857307434082 s
2021-08-18:16:51:29,718 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:29,729 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:51:29,729 INFO     [param_server.py:410] Lock worker 1 with localStep 372 , while globalStep is 371

2021-08-18:16:51:30,97 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:30,111 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:30,307 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:30,321 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:32,151 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:32,166 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:32,602 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:32,618 INFO     [learner.py:606] ====Pushing takes 0.013787031173706055 s
2021-08-18:16:51:32,635 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:32,640 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:51:32,641 INFO     [param_server.py:410] Lock worker 2 with localStep 372 , while globalStep is 371

2021-08-18:16:51:32,891 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:32,921 INFO     [learner.py:606] ====Pushing takes 0.028561830520629883 s
2021-08-18:16:51:32,946 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:32,953 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:51:32,954 INFO     [param_server.py:381] ====After aggregation in epoch: 371, virtual_clock: 16557.735811134346, top_1: : 67.0216 % (2077.0), top_5: : 100.0 % (3099.0), test loss: 3.301845771295053, test len: 3099.0
2021-08-18:16:51:32,956 INFO     [param_server.py:410] Lock worker 3 with localStep 372 , while globalStep is 372

2021-08-18:16:51:32,957 INFO     [param_server.py:441] ====Epoch 373 completes 15 clients with loss 4.238312491150721, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:32,957 INFO     [param_server.py:450] ====Start to sample for epoch 373, global virtualClock: 16557.735811134346, round_duration: 73.86565494213346
2021-08-18:16:51:32,958 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:33,224 INFO     [param_server.py:553] For epoch: 373, median_reward: 360.0130612502816, dev: 360.0130612502816
2021-08-18:16:51:33,865 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9592, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:51:33,869 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4957.3695, eval_time 0.6208, test_loss 2.9592, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:51:33,872 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2388, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:51:33,870 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0822, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:51:33,894 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4957.3942, eval_time 0.6456, test_loss 3.2388, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:51:33,894 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4957.3927, eval_time 0.6461, test_loss 3.0822, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:51:33,981 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:51:33,987 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:51:33,988 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:51:33,990 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:33,996 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:33,997 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:35,434 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:35,455 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:36,134 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:36,143 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:36,210 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:36,219 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:36,978 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:36,988 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:37,897 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:37,911 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:38,679 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:38,697 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:39,16 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:39,35 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:39,496 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:39,515 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:39,820 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:39,835 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:40,149 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:40,168 INFO     [learner.py:606] ====Pushing takes 0.0172426700592041 s
2021-08-18:16:51:40,191 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:40,197 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:51:40,197 INFO     [param_server.py:410] Lock worker 1 with localStep 373 , while globalStep is 372

2021-08-18:16:51:40,666 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:40,676 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:41,110 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:41,125 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:43,82 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:43,91 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:43,97 INFO     [learner.py:606] ====Pushing takes 0.013806819915771484 s
2021-08-18:16:51:43,105 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:43,112 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:43,118 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:51:43,118 INFO     [param_server.py:410] Lock worker 2 with localStep 373 , while globalStep is 372

2021-08-18:16:51:43,725 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:43,753 INFO     [learner.py:606] ====Pushing takes 0.026458024978637695 s
2021-08-18:16:51:43,780 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:43,786 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:51:43,787 INFO     [param_server.py:381] ====After aggregation in epoch: 372, virtual_clock: 16631.601466076478, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 3.0934019265351473, test len: 3099.0
2021-08-18:16:51:43,790 INFO     [param_server.py:410] Lock worker 3 with localStep 373 , while globalStep is 373

2021-08-18:16:51:43,791 INFO     [param_server.py:441] ====Epoch 374 completes 15 clients with loss 4.803211994956618, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:43,791 INFO     [param_server.py:450] ====Start to sample for epoch 374, global virtualClock: 16631.601466076478, round_duration: 73.86565494213346
2021-08-18:16:51:43,792 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:44,90 INFO     [param_server.py:553] For epoch: 374, median_reward: 344.7558669908742, dev: 344.7558669908742
2021-08-18:16:51:44,707 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2898, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:51:44,708 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4968.2083, eval_time 0.5833, test_loss 3.2898, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:51:44,783 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:51:44,792 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.9687, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:51:44,793 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4968.2915, eval_time 0.6695, test_loss 5.9687, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:51:44,796 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:44,797 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3829, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:51:44,797 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4968.2976, eval_time 0.6738, test_loss 3.3829, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:51:44,876 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:51:44,896 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:51:44,898 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:44,916 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:46,149 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:46,163 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:47,18 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:47,28 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:47,49 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:47,58 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:47,696 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:47,706 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:48,508 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:48,529 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:49,430 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:49,448 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:49,676 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:49,686 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:50,183 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:50,197 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:50,364 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:50,373 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:50,827 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:50,847 INFO     [learner.py:606] ====Pushing takes 0.01893138885498047 s
2021-08-18:16:51:50,876 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:50,884 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:51:50,885 INFO     [param_server.py:410] Lock worker 1 with localStep 374 , while globalStep is 373

2021-08-18:16:51:51,448 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:51,466 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:51,532 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:51,541 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:53,220 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:53,247 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:53,860 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:53,875 INFO     [learner.py:606] ====Pushing takes 0.013261795043945312 s
2021-08-18:16:51:53,889 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:53,894 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:51:53,895 INFO     [param_server.py:410] Lock worker 2 with localStep 374 , while globalStep is 373

2021-08-18:16:51:53,988 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:54,14 INFO     [learner.py:606] ====Pushing takes 0.024993896484375 s
2021-08-18:16:51:54,41 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:54,49 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:51:54,50 INFO     [param_server.py:381] ====After aggregation in epoch: 373, virtual_clock: 16705.46712101861, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 4.2138058874342175, test len: 3099.0
2021-08-18:16:51:54,52 INFO     [param_server.py:410] Lock worker 3 with localStep 374 , while globalStep is 374

2021-08-18:16:51:54,53 INFO     [param_server.py:441] ====Epoch 375 completes 15 clients with loss 5.981168355283147, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:54,53 INFO     [param_server.py:450] ====Start to sample for epoch 375, global virtualClock: 16705.46712101861, round_duration: 73.86565494213346
2021-08-18:16:51:54,54 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:54,350 INFO     [param_server.py:553] For epoch: 375, median_reward: 344.59971386581856, dev: 344.59971386581856
2021-08-18:16:51:55,59 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0926, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:51:55,60 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4978.5599, eval_time 0.6742, test_loss 3.0926, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:51:55,129 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:51:55,137 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:55,162 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3586, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:51:55,163 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4978.6634, eval_time 0.7775, test_loss 3.3586, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:51:55,199 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.813, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:51:55,203 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4978.7012, eval_time 0.818, test_loss 3.813, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:51:55,251 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:51:55,259 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:55,272 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:51:55,287 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:56,725 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:56,747 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:57,363 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:57,378 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:57,598 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:57,610 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:58,307 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:58,317 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:59,254 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:59,281 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:59,953 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:59,966 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:00,267 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:00,285 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:00,722 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:00,743 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:01,88 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:01,99 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:01,299 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:01,320 INFO     [learner.py:606] ====Pushing takes 0.019263029098510742 s
2021-08-18:16:52:01,350 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:01,356 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:01,356 INFO     [param_server.py:410] Lock worker 1 with localStep 375 , while globalStep is 374

2021-08-18:16:52:01,903 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:01,912 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:02,328 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:02,338 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:04,152 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:04,171 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:04,176 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:04,192 INFO     [learner.py:606] ====Pushing takes 0.014619112014770508 s
2021-08-18:16:52:04,207 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:04,213 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:04,214 INFO     [param_server.py:410] Lock worker 2 with localStep 375 , while globalStep is 374

2021-08-18:16:52:05,55 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:05,81 INFO     [learner.py:606] ====Pushing takes 0.024558067321777344 s
2021-08-18:16:52:05,109 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:05,116 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:05,116 INFO     [param_server.py:381] ====After aggregation in epoch: 374, virtual_clock: 16779.332775960742, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 3.421385725339254, test len: 3099.0
2021-08-18:16:52:05,119 INFO     [param_server.py:410] Lock worker 3 with localStep 375 , while globalStep is 375

2021-08-18:16:52:05,119 INFO     [param_server.py:441] ====Epoch 376 completes 15 clients with loss 4.867107480711594, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:05,140 INFO     [param_server.py:450] ====Start to sample for epoch 376, global virtualClock: 16779.332775960742, round_duration: 73.86565494213346
2021-08-18:16:52:05,141 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:05,406 INFO     [param_server.py:553] For epoch: 376, median_reward: 338.8339769445632, dev: 338.8339769445632
2021-08-18:16:52:06,79 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8701, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:52:06,80 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 4989.5807, eval_time 0.6357, test_loss 2.8701, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:52:06,82 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7738, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:52:06,83 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 4989.5832, eval_time 0.6376, test_loss 2.7738, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:52:06,118 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0533, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:52:06,120 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 4989.6183, eval_time 0.6795, test_loss 3.0533, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:52:06,150 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:06,162 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:06,166 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:06,175 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:06,202 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:06,224 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:07,676 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:07,697 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:08,453 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:08,463 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:08,569 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:08,581 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:09,478 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:09,487 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:10,140 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:10,154 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:11,11 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:11,25 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:11,164 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:11,178 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:11,728 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:11,749 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:12,284 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:12,303 INFO     [learner.py:606] ====Pushing takes 0.018349647521972656 s
2021-08-18:16:52:12,330 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:12,337 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:12,338 INFO     [param_server.py:410] Lock worker 1 with localStep 376 , while globalStep is 375

2021-08-18:16:52:12,396 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:12,405 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:12,796 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:12,817 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:13,698 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:13,707 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:15,98 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:15,118 INFO     [learner.py:606] ====Pushing takes 0.018743515014648438 s
2021-08-18:16:52:15,134 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:15,138 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:15,139 INFO     [param_server.py:410] Lock worker 2 with localStep 376 , while globalStep is 375

2021-08-18:16:52:15,282 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:15,291 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:15,935 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:15,959 INFO     [learner.py:606] ====Pushing takes 0.022731781005859375 s
2021-08-18:16:52:15,985 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:15,991 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:15,992 INFO     [param_server.py:381] ====After aggregation in epoch: 375, virtual_clock: 16853.198430902874, top_1: : 67.1184 % (2080.0), top_5: : 100.0 % (3099.0), test loss: 2.8990749656050294, test len: 3099.0
2021-08-18:16:52:15,994 INFO     [param_server.py:410] Lock worker 3 with localStep 376 , while globalStep is 376

2021-08-18:16:52:15,995 INFO     [param_server.py:441] ====Epoch 377 completes 15 clients with loss 5.449536534287432, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:15,995 INFO     [param_server.py:450] ====Start to sample for epoch 377, global virtualClock: 16853.198430902874, round_duration: 73.86565494213346
2021-08-18:16:52:15,996 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:16,256 INFO     [param_server.py:553] For epoch: 377, median_reward: 352.9788494193647, dev: 352.9788494193647
2021-08-18:16:52:16,878 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4014, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:52:16,878 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5000.3789, eval_time 0.5777, test_loss 3.4014, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:52:16,946 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:16,955 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1243, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:52:16,956 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5000.4561, eval_time 0.6522, test_loss 3.1243, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:52:16,963 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:17,0 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0411, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:52:17,4 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5000.5022, eval_time 0.7028, test_loss 4.0411, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:52:17,25 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:17,48 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:17,70 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:17,92 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:18,605 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:18,619 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:19,431 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:19,449 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:19,516 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:19,526 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:20,219 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:20,233 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:21,114 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:21,128 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:21,947 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:21,961 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:22,244 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:22,255 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:22,593 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:22,607 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:23,11 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:23,21 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:23,91 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:23,113 INFO     [learner.py:606] ====Pushing takes 0.019752025604248047 s
2021-08-18:16:52:23,142 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:23,148 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:23,149 INFO     [param_server.py:410] Lock worker 1 with localStep 377 , while globalStep is 376

2021-08-18:16:52:23,984 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:23,998 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:24,162 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:24,175 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:25,836 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:25,847 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:26,476 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:26,491 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:26,493 INFO     [learner.py:606] ====Pushing takes 0.015067100524902344 s
2021-08-18:16:52:26,510 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:26,515 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:26,516 INFO     [param_server.py:410] Lock worker 2 with localStep 377 , while globalStep is 376

2021-08-18:16:52:26,518 INFO     [learner.py:606] ====Pushing takes 0.025051593780517578 s
2021-08-18:16:52:26,544 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:26,550 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:26,551 INFO     [param_server.py:381] ====After aggregation in epoch: 376, virtual_clock: 16927.064085845006, top_1: : 63.5044 % (1968.0), top_5: : 100.0 % (3099.0), test loss: 3.522255778312683, test len: 3099.0
2021-08-18:16:52:26,554 INFO     [param_server.py:410] Lock worker 3 with localStep 377 , while globalStep is 377

2021-08-18:16:52:26,554 INFO     [param_server.py:441] ====Epoch 378 completes 15 clients with loss 6.610421895352766, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:26,554 INFO     [param_server.py:450] ====Start to sample for epoch 378, global virtualClock: 16927.064085845006, round_duration: 73.86565494213346
2021-08-18:16:52:26,569 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:26,839 INFO     [param_server.py:553] For epoch: 378, median_reward: 358.10663516569457, dev: 358.10663516569457
2021-08-18:16:52:27,544 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.18, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:52:27,545 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5011.0454, eval_time 0.6828, test_loss 3.18, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:52:27,594 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9724, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:52:27,607 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5011.1075, eval_time 0.7423, test_loss 2.9724, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:52:27,628 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:52:27,636 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:27,672 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0459, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:52:27,672 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5011.171, eval_time 0.8105, test_loss 3.0459, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:52:27,677 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:52:27,691 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:27,741 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:52:27,765 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:29,263 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:29,284 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:29,915 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:29,925 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:30,121 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:30,130 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:30,881 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:30,895 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:31,598 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:31,607 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:32,379 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:32,393 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:32,500 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:32,510 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:33,126 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:33,140 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:33,610 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:33,619 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:33,709 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:33,730 INFO     [learner.py:606] ====Pushing takes 0.019824504852294922 s
2021-08-18:16:52:33,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:33,763 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:33,763 INFO     [param_server.py:410] Lock worker 1 with localStep 378 , while globalStep is 377

2021-08-18:16:52:34,198 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:34,207 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:34,928 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:34,938 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:36,533 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:36,547 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:36,562 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:36,566 INFO     [learner.py:606] ====Pushing takes 0.013040781021118164 s
2021-08-18:16:52:36,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:36,587 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:36,588 INFO     [param_server.py:410] Lock worker 2 with localStep 378 , while globalStep is 377

2021-08-18:16:52:37,245 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:37,271 INFO     [learner.py:606] ====Pushing takes 0.022789955139160156 s
2021-08-18:16:52:37,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:37,306 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:37,307 INFO     [param_server.py:381] ====After aggregation in epoch: 377, virtual_clock: 17000.929740787138, top_1: : 67.9574 % (2106.0), top_5: : 100.0 % (3099.0), test loss: 3.0660803229720504, test len: 3099.0
2021-08-18:16:52:37,309 INFO     [param_server.py:410] Lock worker 3 with localStep 378 , while globalStep is 378

2021-08-18:16:52:37,310 INFO     [param_server.py:441] ====Epoch 379 completes 15 clients with loss 5.556682407176926, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:37,310 INFO     [param_server.py:450] ====Start to sample for epoch 379, global virtualClock: 17000.929740787138, round_duration: 73.86565494213346
2021-08-18:16:52:37,311 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:37,583 INFO     [param_server.py:553] For epoch: 379, median_reward: 359.1644501095973, dev: 359.1644501095973
2021-08-18:16:52:38,289 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6513, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:52:38,289 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5021.7899, eval_time 0.6716, test_loss 3.6513, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:52:38,324 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5396, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:52:38,328 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5021.8281, eval_time 0.7112, test_loss 3.5396, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:52:38,356 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:52:38,370 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:38,395 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:52:38,404 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.637, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:52:38,405 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5021.9035, eval_time 0.7883, test_loss 3.637, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:52:38,411 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:38,472 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:52:38,499 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:40,128 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:40,155 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:40,778 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:40,789 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:40,941 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:40,960 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:41,690 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:41,708 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:42,597 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:42,606 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:43,349 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:43,364 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:43,591 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:43,606 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:44,55 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:44,65 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:44,508 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:44,517 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:44,691 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:44,713 INFO     [learner.py:606] ====Pushing takes 0.02083563804626465 s
2021-08-18:16:52:44,746 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:44,753 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:44,753 INFO     [param_server.py:410] Lock worker 1 with localStep 379 , while globalStep is 378

2021-08-18:16:52:45,294 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:45,305 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:45,796 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:45,806 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:47,504 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:47,517 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:47,520 INFO     [learner.py:606] ====Pushing takes 0.014356613159179688 s
2021-08-18:16:52:47,527 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:47,537 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:47,543 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:47,543 INFO     [param_server.py:410] Lock worker 2 with localStep 379 , while globalStep is 378

2021-08-18:16:52:48,113 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:48,140 INFO     [learner.py:606] ====Pushing takes 0.02592635154724121 s
2021-08-18:16:52:48,169 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:48,178 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:48,179 INFO     [param_server.py:381] ====After aggregation in epoch: 378, virtual_clock: 17074.79539572927, top_1: : 63.1171 % (1956.0), top_5: : 100.0 % (3099.0), test loss: 3.6092923658865472, test len: 3099.0
2021-08-18:16:52:48,183 INFO     [param_server.py:410] Lock worker 3 with localStep 379 , while globalStep is 379

2021-08-18:16:52:48,183 INFO     [param_server.py:441] ====Epoch 380 completes 15 clients with loss 3.9728038566617103, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:48,184 INFO     [param_server.py:450] ====Start to sample for epoch 380, global virtualClock: 17074.79539572927, round_duration: 73.86565494213346
2021-08-18:16:52:48,185 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:48,522 INFO     [param_server.py:553] For epoch: 380, median_reward: 346.3360658663412, dev: 346.3360658663412
2021-08-18:16:52:49,149 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8541, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:52:49,150 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5032.6506, eval_time 0.5838, test_loss 2.8541, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:52:49,156 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4013, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:52:49,157 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5032.6573, eval_time 0.5907, test_loss 3.4013, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:52:49,224 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:52:49,229 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:52:49,236 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:49,237 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:49,245 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6215, Top-1 Accuracy: 718.0/1033 (0.6951), Top-5 Accuracy: 1.0
2021-08-18:16:52:49,249 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5032.7474, eval_time 0.6825, test_loss 3.6215, test_accuracy 0.6951, test_5_accuracy 1.0 

2021-08-18:16:52:49,320 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:52:49,348 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:51,201 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:51,228 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:51,505 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:51,525 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:51,812 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:51,821 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:52,517 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:52,531 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:53,569 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:53,583 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:54,276 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:54,286 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:54,558 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:54,570 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:54,940 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:54,952 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:55,214 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:55,224 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:55,580 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:55,600 INFO     [learner.py:606] ====Pushing takes 0.01913762092590332 s
2021-08-18:16:52:55,630 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:55,637 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:52:55,638 INFO     [param_server.py:410] Lock worker 1 with localStep 380 , while globalStep is 379

2021-08-18:16:52:56,169 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:56,181 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:56,446 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:56,456 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:58,105 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:58,119 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:58,529 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:58,544 INFO     [learner.py:606] ====Pushing takes 0.013935089111328125 s
2021-08-18:16:52:58,560 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:58,565 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:52:58,566 INFO     [param_server.py:410] Lock worker 2 with localStep 380 , while globalStep is 379

2021-08-18:16:52:58,830 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:58,857 INFO     [learner.py:606] ====Pushing takes 0.02530074119567871 s
2021-08-18:16:52:58,887 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:58,893 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:52:58,894 INFO     [param_server.py:381] ====After aggregation in epoch: 379, virtual_clock: 17148.661050671402, top_1: : 67.7315 % (2099.0), top_5: : 100.0 % (3099.0), test loss: 3.292315147541187, test len: 3099.0
2021-08-18:16:52:58,896 INFO     [param_server.py:410] Lock worker 3 with localStep 380 , while globalStep is 380

2021-08-18:16:52:58,897 INFO     [param_server.py:441] ====Epoch 381 completes 15 clients with loss 5.335143404591264, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:58,897 INFO     [param_server.py:450] ====Start to sample for epoch 381, global virtualClock: 17148.661050671402, round_duration: 73.86565494213346
2021-08-18:16:52:58,898 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:59,276 INFO     [param_server.py:541] Handle Wight 0.03230476379394531 | Send 0.3791224956512451
2021-08-18:16:52:59,277 INFO     [param_server.py:553] For epoch: 381, median_reward: 356.28026423287673, dev: 356.28026423287673
2021-08-18:16:52:59,903 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4045, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:52:59,903 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.495, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:52:59,904 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5043.404, eval_time 0.5956, test_loss 3.4045, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:52:59,904 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5043.404, eval_time 0.5957, test_loss 3.495, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:52:59,968 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.123, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:52:59,969 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5043.4673, eval_time 0.6607, test_loss 3.123, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:52:59,972 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:52:59,974 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:52:59,981 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:59,986 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:00,37 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:53:00,60 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:01,650 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:01,677 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:02,111 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:02,130 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:02,550 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:02,559 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:03,195 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:03,214 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:04,199 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:04,220 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:04,675 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:04,687 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:04,989 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:05,8 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:05,654 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:05,667 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:05,917 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:05,927 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:06,192 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:06,211 INFO     [learner.py:606] ====Pushing takes 0.01800227165222168 s
2021-08-18:16:53:06,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:06,249 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:06,250 INFO     [param_server.py:410] Lock worker 1 with localStep 381 , while globalStep is 380

2021-08-18:16:53:06,389 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:06,403 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:07,320 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:07,329 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:08,717 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:08,733 INFO     [learner.py:606] ====Pushing takes 0.014078140258789062 s
2021-08-18:16:53:08,747 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:08,752 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:08,753 INFO     [param_server.py:410] Lock worker 2 with localStep 381 , while globalStep is 380

2021-08-18:16:53:08,960 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:08,972 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:09,573 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:09,598 INFO     [learner.py:606] ====Pushing takes 0.023814916610717773 s
2021-08-18:16:53:09,625 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:09,632 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:09,633 INFO     [param_server.py:381] ====After aggregation in epoch: 380, virtual_clock: 17222.526705613534, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 3.3408447680649935, test len: 3099.0
2021-08-18:16:53:09,635 INFO     [param_server.py:410] Lock worker 3 with localStep 381 , while globalStep is 381

2021-08-18:16:53:09,636 INFO     [param_server.py:441] ====Epoch 382 completes 15 clients with loss 4.3865690479845085, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:09,636 INFO     [param_server.py:450] ====Start to sample for epoch 382, global virtualClock: 17222.526705613534, round_duration: 73.86565494213346
2021-08-18:16:53:09,637 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:09,969 INFO     [param_server.py:553] For epoch: 382, median_reward: 346.9906916862917, dev: 346.9906916862917
2021-08-18:16:53:10,588 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5645, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:53:10,588 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1138, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:53:10,589 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5054.0889, eval_time 0.5922, test_loss 3.5645, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:53:10,589 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5054.0891, eval_time 0.5899, test_loss 3.1138, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:53:10,661 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:10,666 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1072, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:53:10,670 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:10,670 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5054.169, eval_time 0.674, test_loss 3.1072, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:53:10,684 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:10,691 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:10,740 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:10,758 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:11,700 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:11,714 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:12,988 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:13,22 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:13,26 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:13,44 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:14,492 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:14,506 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:15,600 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:15,614 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:15,790 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:15,799 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:16,64 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:16,73 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:16,752 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:16,762 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:17,449 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:17,461 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:17,478 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:17,490 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:17,826 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:17,837 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:18,18 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:18,40 INFO     [learner.py:606] ====Pushing takes 0.01813673973083496 s
2021-08-18:16:53:18,64 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:18,70 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:53:18,70 INFO     [param_server.py:410] Lock worker 1 with localStep 382 , while globalStep is 381

2021-08-18:16:53:18,495 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:18,520 INFO     [learner.py:606] ====Pushing takes 0.022925138473510742 s
2021-08-18:16:53:18,543 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:18,549 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:53:18,550 INFO     [param_server.py:410] Lock worker 3 with localStep 382 , while globalStep is 381

2021-08-18:16:53:20,70 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:20,87 INFO     [learner.py:606] ====Pushing takes 0.015697479248046875 s
2021-08-18:16:53:20,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:20,107 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:53:20,107 INFO     [param_server.py:381] ====After aggregation in epoch: 381, virtual_clock: 17299.63625396213, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 3.26181349268666, test len: 3099.0
2021-08-18:16:53:20,110 INFO     [param_server.py:410] Lock worker 2 with localStep 382 , while globalStep is 382

2021-08-18:16:53:20,111 INFO     [param_server.py:441] ====Epoch 383 completes 14 clients with loss 4.749442325720293, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:20,111 INFO     [param_server.py:450] ====Start to sample for epoch 383, global virtualClock: 17299.63625396213, round_duration: 77.10954834859407
2021-08-18:16:53:20,112 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:20,439 INFO     [param_server.py:553] For epoch: 383, median_reward: 350.235125630557, dev: 350.235125630557
2021-08-18:16:53:21,31 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0832, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:53:21,44 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5064.5441, eval_time 0.5711, test_loss 3.0832, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:53:21,47 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.057, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:53:21,48 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5064.5486, eval_time 0.5752, test_loss 3.057, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:53:21,118 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:53:21,118 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2991, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:53:21,119 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5064.6178, eval_time 0.6465, test_loss 3.2991, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:53:21,125 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:53:21,133 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:21,141 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:21,192 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:53:21,223 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:21,867 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:21,877 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:23,405 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:23,415 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:23,488 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:23,516 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:24,745 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:24,755 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:26,75 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:26,84 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:26,155 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:26,169 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:26,259 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:26,277 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:27,245 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:27,254 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:27,808 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:27,819 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:27,823 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:27,833 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:27,872 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:27,884 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:28,388 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:28,414 INFO     [learner.py:606] ====Pushing takes 0.019207477569580078 s
2021-08-18:16:53:28,442 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:28,451 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:53:28,452 INFO     [param_server.py:410] Lock worker 1 with localStep 383 , while globalStep is 382

2021-08-18:16:53:28,841 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:28,864 INFO     [learner.py:606] ====Pushing takes 0.021776676177978516 s
2021-08-18:16:53:28,889 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:28,895 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:53:28,896 INFO     [param_server.py:410] Lock worker 3 with localStep 383 , while globalStep is 382

2021-08-18:16:53:29,973 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:29,992 INFO     [learner.py:606] ====Pushing takes 0.015543937683105469 s
2021-08-18:16:53:30,9 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:30,14 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:53:30,15 INFO     [param_server.py:381] ====After aggregation in epoch: 382, virtual_clock: 17376.745802310725, top_1: : 66.3763 % (2057.0), top_5: : 100.0 % (3099.0), test loss: 3.1464574337005615, test len: 3099.0
2021-08-18:16:53:30,18 INFO     [param_server.py:410] Lock worker 2 with localStep 383 , while globalStep is 383

2021-08-18:16:53:30,18 INFO     [param_server.py:441] ====Epoch 384 completes 14 clients with loss 4.295867684438032, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:30,19 INFO     [param_server.py:450] ====Start to sample for epoch 384, global virtualClock: 17376.745802310725, round_duration: 77.10954834859407
2021-08-18:16:53:30,20 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:30,337 INFO     [param_server.py:553] For epoch: 384, median_reward: 339.1515886104265, dev: 339.1515886104265
2021-08-18:16:53:30,981 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7817, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:53:30,983 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5074.4811, eval_time 0.6228, test_loss 3.7817, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:53:30,984 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.669, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:53:30,985 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8206, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:53:30,985 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5074.4859, eval_time 0.6257, test_loss 2.669, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:53:30,986 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5074.4864, eval_time 0.6264, test_loss 2.8206, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:53:31,53 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:53:31,57 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:53:31,66 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:31,66 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:31,69 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:53:31,79 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:31,775 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:31,803 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:32,977 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:32,998 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:33,189 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:33,199 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:34,605 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:34,624 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:35,537 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:35,557 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:35,954 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:35,964 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:36,20 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:36,32 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:36,801 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:36,821 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:37,576 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:37,596 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:37,648 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:37,661 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:37,730 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:37,743 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:38,293 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:38,313 INFO     [learner.py:606] ====Pushing takes 0.018316030502319336 s
2021-08-18:16:53:38,338 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:38,344 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:53:38,345 INFO     [param_server.py:410] Lock worker 1 with localStep 384 , while globalStep is 383

2021-08-18:16:53:38,754 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:38,776 INFO     [learner.py:606] ====Pushing takes 0.01998114585876465 s
2021-08-18:16:53:38,799 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:38,809 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:53:38,810 INFO     [param_server.py:410] Lock worker 3 with localStep 384 , while globalStep is 383

2021-08-18:16:53:40,16 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:40,31 INFO     [learner.py:606] ====Pushing takes 0.013245582580566406 s
2021-08-18:16:53:40,46 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:40,51 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:53:40,51 INFO     [param_server.py:381] ====After aggregation in epoch: 383, virtual_clock: 17453.85535065932, top_1: : 67.0862 % (2079.0), top_5: : 100.0 % (3099.0), test loss: 3.0904178553157386, test len: 3099.0
2021-08-18:16:53:40,54 INFO     [param_server.py:410] Lock worker 2 with localStep 384 , while globalStep is 384

2021-08-18:16:53:40,54 INFO     [param_server.py:441] ====Epoch 385 completes 14 clients with loss 3.676964671079478, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:40,55 INFO     [param_server.py:450] ====Start to sample for epoch 385, global virtualClock: 17453.85535065932, round_duration: 77.10954834859407
2021-08-18:16:53:40,55 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:40,352 INFO     [param_server.py:553] For epoch: 385, median_reward: 341.85253240989084, dev: 341.85253240989084
2021-08-18:16:53:41,83 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5577, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:53:41,84 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5084.5826, eval_time 0.7197, test_loss 3.5577, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:53:41,91 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3008, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:53:41,92 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5084.5919, eval_time 0.7227, test_loss 3.3008, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:53:41,94 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2979, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:53:41,95 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5084.5951, eval_time 0.7257, test_loss 3.2979, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:53:41,154 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:53:41,161 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:53:41,162 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:41,164 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:53:41,168 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:41,172 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:41,804 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:41,813 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:42,876 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:42,897 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:43,241 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:43,254 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:44,484 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:44,498 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:45,764 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:45,796 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:45,917 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:45,928 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:45,977 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:45,996 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:47,100 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:47,114 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:47,599 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:47,608 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:47,765 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:47,784 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:47,824 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:47,841 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:48,337 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:48,357 INFO     [learner.py:606] ====Pushing takes 0.018267393112182617 s
2021-08-18:16:53:48,381 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:48,389 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:53:48,390 INFO     [param_server.py:410] Lock worker 1 with localStep 385 , while globalStep is 384

2021-08-18:16:53:48,711 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:48,731 INFO     [learner.py:606] ====Pushing takes 0.019126176834106445 s
2021-08-18:16:53:48,756 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:48,763 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:53:48,763 INFO     [param_server.py:410] Lock worker 3 with localStep 385 , while globalStep is 384

2021-08-18:16:53:50,146 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:50,170 INFO     [learner.py:606] ====Pushing takes 0.019452333450317383 s
2021-08-18:16:53:50,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:50,195 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:53:50,196 INFO     [param_server.py:381] ====After aggregation in epoch: 384, virtual_clock: 17530.964899007915, top_1: : 64.6015 % (2002.0), top_5: : 100.0 % (3099.0), test loss: 3.3854937376799406, test len: 3099.0
2021-08-18:16:53:50,198 INFO     [param_server.py:410] Lock worker 2 with localStep 385 , while globalStep is 385

2021-08-18:16:53:50,199 INFO     [param_server.py:441] ====Epoch 386 completes 14 clients with loss 4.299226306487489, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:50,199 INFO     [param_server.py:450] ====Start to sample for epoch 386, global virtualClock: 17530.964899007915, round_duration: 77.10954834859407
2021-08-18:16:53:50,200 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:50,469 INFO     [param_server.py:553] For epoch: 386, median_reward: 355.8963880955227, dev: 355.8963880955227
2021-08-18:16:53:51,71 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1199, Top-1 Accuracy: 728.0/1033 (0.7047), Top-5 Accuracy: 1.0
2021-08-18:16:53:51,71 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0528, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:53:51,72 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5094.5724, eval_time 0.589, test_loss 3.0528, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:53:51,72 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5094.5705, eval_time 0.5902, test_loss 3.1199, test_accuracy 0.7047, test_5_accuracy 1.0 

2021-08-18:16:53:51,78 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0589, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:53:51,79 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5094.5795, eval_time 0.596, test_loss 3.0589, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:53:51,141 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:53:51,142 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:53:51,144 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:53:51,149 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:51,150 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:51,153 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:51,953 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:51,962 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:53,18 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:53,45 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:53,336 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:53,346 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:54,636 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:54,687 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:55,616 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:55,637 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:56,87 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:56,105 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:56,187 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:56,205 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:56,911 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:56,931 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:57,768 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:57,778 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:57,846 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:57,860 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:57,908 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:57,919 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:58,421 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:58,446 INFO     [learner.py:606] ====Pushing takes 0.019446372985839844 s
2021-08-18:16:53:58,474 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:58,480 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:53:58,481 INFO     [param_server.py:410] Lock worker 1 with localStep 386 , while globalStep is 385

2021-08-18:16:53:58,771 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:58,793 INFO     [learner.py:606] ====Pushing takes 0.020322799682617188 s
2021-08-18:16:53:58,815 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:58,824 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:53:58,825 INFO     [param_server.py:410] Lock worker 3 with localStep 386 , while globalStep is 385

2021-08-18:16:54:00,89 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:00,103 INFO     [learner.py:606] ====Pushing takes 0.012533903121948242 s
2021-08-18:16:54:00,118 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:00,123 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:00,124 INFO     [param_server.py:381] ====After aggregation in epoch: 385, virtual_clock: 17608.07444735651, top_1: : 68.2156 % (2114.0), top_5: : 100.0 % (3099.0), test loss: 3.0771662835721614, test len: 3099.0
2021-08-18:16:54:00,129 INFO     [param_server.py:410] Lock worker 2 with localStep 386 , while globalStep is 386

2021-08-18:16:54:00,130 INFO     [param_server.py:441] ====Epoch 387 completes 14 clients with loss 3.42701554393667, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:00,130 INFO     [param_server.py:450] ====Start to sample for epoch 387, global virtualClock: 17608.07444735651, round_duration: 77.10954834859407
2021-08-18:16:54:00,131 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:00,451 INFO     [param_server.py:553] For epoch: 387, median_reward: 351.99668632882475, dev: 351.99668632882475
2021-08-18:16:54:01,71 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4239, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:54:01,72 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5104.572, eval_time 0.5952, test_loss 3.4239, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:54:01,81 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0215, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:54:01,82 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5104.5829, eval_time 0.6084, test_loss 4.0215, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:54:01,141 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:01,151 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:01,153 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:01,158 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.9821, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:54:01,159 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5104.6572, eval_time 0.6844, test_loss 5.9821, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:54:01,161 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:01,232 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:01,251 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:02,56 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:02,69 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:03,15 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:03,33 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:03,374 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:03,384 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:04,860 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:04,870 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:05,596 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:05,617 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:06,40 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:06,50 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:06,93 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:06,107 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:06,915 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:06,943 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:07,734 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:07,756 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:07,859 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:07,877 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:07,959 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:07,973 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:08,438 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:08,459 INFO     [learner.py:606] ====Pushing takes 0.020107030868530273 s
2021-08-18:16:54:08,493 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:08,502 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:08,503 INFO     [param_server.py:410] Lock worker 1 with localStep 387 , while globalStep is 386

2021-08-18:16:54:09,28 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:09,51 INFO     [learner.py:606] ====Pushing takes 0.021277189254760742 s
2021-08-18:16:54:09,74 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:09,80 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:09,81 INFO     [param_server.py:410] Lock worker 3 with localStep 387 , while globalStep is 386

2021-08-18:16:54:10,373 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:10,392 INFO     [learner.py:606] ====Pushing takes 0.014747381210327148 s
2021-08-18:16:54:10,411 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:10,417 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:10,417 INFO     [param_server.py:381] ====After aggregation in epoch: 386, virtual_clock: 17685.183995705105, top_1: : 64.0207 % (1984.0), top_5: : 100.0 % (3099.0), test loss: 4.475817918777466, test len: 3099.0
2021-08-18:16:54:10,420 INFO     [param_server.py:410] Lock worker 2 with localStep 387 , while globalStep is 387

2021-08-18:16:54:10,420 INFO     [param_server.py:441] ====Epoch 388 completes 14 clients with loss 5.954547703372178, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:10,421 INFO     [param_server.py:450] ====Start to sample for epoch 388, global virtualClock: 17685.183995705105, round_duration: 77.10954834859407
2021-08-18:16:54:10,421 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:10,691 INFO     [param_server.py:553] For epoch: 388, median_reward: 344.73213126823316, dev: 344.73213126823316
2021-08-18:16:54:11,265 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1742, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:54:11,267 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5114.7669, eval_time 0.5632, test_loss 3.1742, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:54:11,268 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8321, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:54:11,269 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5114.7694, eval_time 0.5655, test_loss 2.8321, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:54:11,271 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6574, Top-1 Accuracy: 716.0/1033 (0.6931), Top-5 Accuracy: 1.0
2021-08-18:16:54:11,272 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5114.7708, eval_time 0.5704, test_loss 3.6574, test_accuracy 0.6931, test_5_accuracy 1.0 

2021-08-18:16:54:11,339 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:11,344 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:11,348 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:11,352 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:11,373 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:11,382 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:12,57 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:12,68 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:13,35 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:13,44 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:13,455 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:13,468 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:14,663 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:14,703 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:15,349 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:15,362 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:15,877 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:15,887 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:16,119 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:16,128 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:16,603 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:16,630 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:17,463 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:17,496 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:17,772 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:17,795 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:17,905 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:17,932 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:18,101 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:18,125 INFO     [learner.py:606] ====Pushing takes 0.02302694320678711 s
2021-08-18:16:54:18,155 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:18,167 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:18,168 INFO     [param_server.py:410] Lock worker 1 with localStep 388 , while globalStep is 387

2021-08-18:16:54:18,968 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:18,989 INFO     [learner.py:606] ====Pushing takes 0.019553422927856445 s
2021-08-18:16:54:19,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:19,18 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:19,18 INFO     [param_server.py:410] Lock worker 3 with localStep 388 , while globalStep is 387

2021-08-18:16:54:20,12 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:20,33 INFO     [learner.py:606] ====Pushing takes 0.01869940757751465 s
2021-08-18:16:54:20,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:20,54 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:20,54 INFO     [param_server.py:381] ====After aggregation in epoch: 387, virtual_clock: 17762.2935440537, top_1: : 67.1184 % (2080.0), top_5: : 100.0 % (3099.0), test loss: 3.221229169103834, test len: 3099.0
2021-08-18:16:54:20,57 INFO     [param_server.py:410] Lock worker 2 with localStep 388 , while globalStep is 388

2021-08-18:16:54:20,58 INFO     [param_server.py:441] ====Epoch 389 completes 14 clients with loss 4.8012968201422215, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:20,58 INFO     [param_server.py:450] ====Start to sample for epoch 389, global virtualClock: 17762.2935440537, round_duration: 77.10954834859407
2021-08-18:16:54:20,59 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:20,400 INFO     [param_server.py:553] For epoch: 389, median_reward: 353.00625593521846, dev: 353.00625593521846
2021-08-18:16:54:21,149 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6686, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:54:21,150 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5124.6484, eval_time 0.7274, test_loss 3.6686, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:54:21,154 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5431, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:54:21,154 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5124.6549, eval_time 0.7293, test_loss 3.5431, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:54:21,169 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7226, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:54:21,170 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5124.6706, eval_time 0.7453, test_loss 3.7226, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:54:21,219 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:54:21,223 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:54:21,228 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:21,231 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:21,253 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:54:21,261 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:21,901 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:21,911 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:22,777 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:22,787 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:23,404 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:23,414 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:24,512 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:24,521 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:25,181 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:25,201 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:25,793 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:25,802 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:26,62 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:26,76 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:26,392 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:26,413 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:27,208 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:27,228 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:27,587 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:27,607 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:27,700 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:27,710 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:27,802 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:27,830 INFO     [learner.py:606] ====Pushing takes 0.025888681411743164 s
2021-08-18:16:54:27,868 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:27,878 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:27,879 INFO     [param_server.py:410] Lock worker 1 with localStep 389 , while globalStep is 388

2021-08-18:16:54:28,898 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:28,925 INFO     [learner.py:606] ====Pushing takes 0.02313065528869629 s
2021-08-18:16:54:28,957 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:28,964 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:28,965 INFO     [param_server.py:410] Lock worker 3 with localStep 389 , while globalStep is 388

2021-08-18:16:54:29,996 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:30,17 INFO     [learner.py:606] ====Pushing takes 0.016315460205078125 s
2021-08-18:16:54:30,35 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:30,40 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:30,41 INFO     [param_server.py:381] ====After aggregation in epoch: 388, virtual_clock: 17839.403092402295, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 3.644755381124991, test len: 3099.0
2021-08-18:16:54:30,44 INFO     [param_server.py:410] Lock worker 2 with localStep 389 , while globalStep is 389

2021-08-18:16:54:30,44 INFO     [param_server.py:441] ====Epoch 390 completes 14 clients with loss 6.3796923434111825, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:30,45 INFO     [param_server.py:450] ====Start to sample for epoch 390, global virtualClock: 17839.403092402295, round_duration: 77.10954834859407
2021-08-18:16:54:30,46 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:30,378 INFO     [param_server.py:553] For epoch: 390, median_reward: 343.1765588953788, dev: 343.1765588953788
2021-08-18:16:54:31,50 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9868, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:54:31,62 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5134.5621, eval_time 0.6595, test_loss 2.9868, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:54:31,70 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0224, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:54:31,71 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5134.5712, eval_time 0.6711, test_loss 3.0224, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:54:31,95 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4619, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:54:31,96 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5134.5947, eval_time 0.6963, test_loss 3.4619, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:54:31,127 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:54:31,137 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:31,158 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:54:31,158 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:54:31,169 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:31,171 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:31,928 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:31,938 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:32,969 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:32,978 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:33,486 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:33,496 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:34,635 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:34,647 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:35,268 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:35,282 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:35,782 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:35,791 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:36,152 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:36,161 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:36,373 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:36,393 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:37,196 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:37,217 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:37,480 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:37,493 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:37,860 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:37,872 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:37,884 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:37,892 INFO     [learner.py:606] ====Pushing takes 0.030294179916381836 s
2021-08-18:16:54:37,942 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:37,953 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:37,954 INFO     [param_server.py:410] Lock worker 1 with localStep 390 , while globalStep is 389

2021-08-18:16:54:38,553 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:38,588 INFO     [learner.py:606] ====Pushing takes 0.03277182579040527 s
2021-08-18:16:54:38,614 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:38,623 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:38,624 INFO     [param_server.py:410] Lock worker 3 with localStep 390 , while globalStep is 389

2021-08-18:16:54:40,212 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:40,228 INFO     [learner.py:606] ====Pushing takes 0.013860225677490234 s
2021-08-18:16:54:40,246 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:40,252 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:40,254 INFO     [param_server.py:381] ====After aggregation in epoch: 389, virtual_clock: 17916.51264075089, top_1: : 66.8603 % (2072.0), top_5: : 100.0 % (3099.0), test loss: 3.1570136811998157, test len: 3099.0
2021-08-18:16:54:40,257 INFO     [param_server.py:410] Lock worker 2 with localStep 390 , while globalStep is 390

2021-08-18:16:54:40,257 INFO     [param_server.py:441] ====Epoch 391 completes 14 clients with loss 5.457666689893243, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:40,258 INFO     [param_server.py:450] ====Start to sample for epoch 391, global virtualClock: 17916.51264075089, round_duration: 77.10954834859407
2021-08-18:16:54:40,259 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:40,559 INFO     [param_server.py:553] For epoch: 391, median_reward: 346.93325201204533, dev: 346.93325201204533
2021-08-18:16:54:41,284 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.098, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:54:41,285 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5144.7855, eval_time 0.691, test_loss 3.098, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:54:41,293 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1827, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:54:41,295 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5144.7952, eval_time 0.7004, test_loss 3.1827, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:54:41,354 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:54:41,358 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2401, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:16:54:41,359 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5144.8577, eval_time 0.7667, test_loss 3.2401, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:16:54:41,369 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:41,400 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:54:41,410 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:41,454 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:54:41,474 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:42,170 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:42,179 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:43,183 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:43,201 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:43,602 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:43,611 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:44,722 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:44,781 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:45,522 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:45,540 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:45,962 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:45,971 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:46,294 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:46,304 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:46,751 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:46,771 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:47,551 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:47,578 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:47,779 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:47,793 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:47,895 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:47,906 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:48,188 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:48,224 INFO     [learner.py:606] ====Pushing takes 0.03050088882446289 s
2021-08-18:16:54:48,266 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:48,278 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:48,279 INFO     [param_server.py:410] Lock worker 1 with localStep 391 , while globalStep is 390

2021-08-18:16:54:49,8 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:49,38 INFO     [learner.py:606] ====Pushing takes 0.028377771377563477 s
2021-08-18:16:54:49,64 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:49,71 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:49,72 INFO     [param_server.py:410] Lock worker 3 with localStep 391 , while globalStep is 390

2021-08-18:16:54:50,283 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:50,308 INFO     [learner.py:606] ====Pushing takes 0.020209312438964844 s
2021-08-18:16:54:50,324 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:50,331 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:50,332 INFO     [param_server.py:381] ====After aggregation in epoch: 390, virtual_clock: 17993.622189099486, top_1: : 67.1184 % (2080.0), top_5: : 100.0 % (3099.0), test loss: 3.173580809875771, test len: 3099.0
2021-08-18:16:54:50,335 INFO     [param_server.py:410] Lock worker 2 with localStep 391 , while globalStep is 391

2021-08-18:16:54:50,335 INFO     [param_server.py:441] ====Epoch 392 completes 14 clients with loss 5.109799569651732, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:50,336 INFO     [param_server.py:450] ====Start to sample for epoch 392, global virtualClock: 17993.622189099486, round_duration: 77.10954834859407
2021-08-18:16:54:50,337 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:50,645 INFO     [param_server.py:553] For epoch: 392, median_reward: 358.6986108481102, dev: 358.6986108481102
2021-08-18:16:54:51,227 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.074, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:54:51,228 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5154.7288, eval_time 0.5496, test_loss 3.074, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:54:51,296 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:54:51,303 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1334, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:54:51,305 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:51,305 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5154.8031, eval_time 0.6259, test_loss 3.1334, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:54:51,351 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8074, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:54:51,352 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5154.8528, eval_time 0.6734, test_loss 2.8074, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:54:51,405 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:54:51,430 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:54:51,438 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:51,422 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:52,255 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:52,266 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:53,220 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:53,239 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:53,502 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:53,511 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:55,77 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:55,90 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:55,676 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:55,694 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:55,994 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:56,5 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:56,192 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:56,203 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:56,825 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:56,845 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:57,579 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:57,588 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:57,703 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:57,730 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:57,826 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:57,840 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:58,449 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:58,483 INFO     [learner.py:606] ====Pushing takes 0.027730941772460938 s
2021-08-18:16:54:58,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:58,533 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:58,534 INFO     [param_server.py:410] Lock worker 1 with localStep 392 , while globalStep is 391

2021-08-18:16:54:58,979 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:59,2 INFO     [learner.py:606] ====Pushing takes 0.021627426147460938 s
2021-08-18:16:54:59,24 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:59,35 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:54:59,35 INFO     [param_server.py:410] Lock worker 3 with localStep 392 , while globalStep is 391

2021-08-18:16:54:59,823 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:59,842 INFO     [learner.py:606] ====Pushing takes 0.017395973205566406 s
2021-08-18:16:54:59,860 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:59,868 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:54:59,869 INFO     [param_server.py:381] ====After aggregation in epoch: 391, virtual_clock: 18070.73173744808, top_1: : 66.4408 % (2059.0), top_5: : 100.0 % (3099.0), test loss: 3.004938293386388, test len: 3099.0
2021-08-18:16:54:59,881 INFO     [param_server.py:410] Lock worker 2 with localStep 392 , while globalStep is 392

2021-08-18:16:54:59,882 INFO     [param_server.py:441] ====Epoch 393 completes 14 clients with loss 4.161303874793426, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:59,882 INFO     [param_server.py:450] ====Start to sample for epoch 393, global virtualClock: 18070.73173744808, round_duration: 77.10954834859407
2021-08-18:16:54:59,883 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:00,179 INFO     [param_server.py:553] For epoch: 393, median_reward: 348.51772687806965, dev: 348.51772687806965
2021-08-18:16:55:00,809 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3055, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:55:00,810 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5164.3104, eval_time 0.5966, test_loss 3.3055, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:55:00,859 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9658, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:55:00,860 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5164.3605, eval_time 0.6466, test_loss 2.9658, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:55:00,877 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:00,886 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:00,889 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0531, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:55:00,890 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5164.3887, eval_time 0.6774, test_loss 3.0531, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:55:00,942 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:00,955 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:00,973 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:00,995 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:01,712 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:01,724 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:02,861 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:02,870 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:02,878 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:02,896 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:04,240 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:04,254 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:05,81 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:05,99 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:05,319 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:05,330 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:05,492 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:05,503 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:06,272 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:06,290 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:07,43 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:07,54 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:07,114 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:07,134 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:07,183 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:07,197 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:07,754 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:07,785 INFO     [learner.py:606] ====Pushing takes 0.029634714126586914 s
2021-08-18:16:55:07,810 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:07,819 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:07,820 INFO     [param_server.py:410] Lock worker 1 with localStep 393 , while globalStep is 392

2021-08-18:16:55:08,291 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:08,316 INFO     [learner.py:606] ====Pushing takes 0.023807525634765625 s
2021-08-18:16:55:08,342 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:08,347 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:08,348 INFO     [param_server.py:410] Lock worker 3 with localStep 393 , while globalStep is 392

2021-08-18:16:55:09,356 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:09,381 INFO     [learner.py:606] ====Pushing takes 0.020386695861816406 s
2021-08-18:16:55:09,398 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:09,403 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:09,404 INFO     [param_server.py:381] ====After aggregation in epoch: 392, virtual_clock: 18147.841285796676, top_1: : 66.344 % (2056.0), top_5: : 100.0 % (3099.0), test loss: 3.108144878237336, test len: 3099.0
2021-08-18:16:55:09,407 INFO     [param_server.py:410] Lock worker 2 with localStep 393 , while globalStep is 393

2021-08-18:16:55:09,408 INFO     [param_server.py:441] ====Epoch 394 completes 14 clients with loss 5.609490579045351, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:09,408 INFO     [param_server.py:450] ====Start to sample for epoch 394, global virtualClock: 18147.841285796676, round_duration: 77.10954834859407
2021-08-18:16:55:09,410 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:09,708 INFO     [param_server.py:553] For epoch: 394, median_reward: 331.31008724115566, dev: 331.31008724115566
2021-08-18:16:55:10,326 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.002, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:55:10,327 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5173.827, eval_time 0.5825, test_loss 3.002, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:55:10,344 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9486, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:55:10,345 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5173.8458, eval_time 0.5968, test_loss 2.9486, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:55:10,382 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3336, Top-1 Accuracy: 722.0/1033 (0.6989), Top-5 Accuracy: 1.0
2021-08-18:16:55:10,383 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5173.8813, eval_time 0.6405, test_loss 3.3336, test_accuracy 0.6989, test_5_accuracy 1.0 

2021-08-18:16:55:10,387 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:10,396 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:10,415 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:10,430 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:10,478 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:10,498 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:11,139 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:11,152 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:12,280 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:12,298 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:12,502 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:12,512 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:13,790 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:13,802 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:14,772 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:14,790 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:14,854 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:14,863 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:15,246 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:15,258 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:15,895 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:15,914 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:16,528 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:16,536 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:16,678 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:16,699 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:16,975 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:16,984 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:17,237 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:17,261 INFO     [learner.py:606] ====Pushing takes 0.02297043800354004 s
2021-08-18:16:55:17,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:17,308 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:17,309 INFO     [param_server.py:410] Lock worker 1 with localStep 394 , while globalStep is 393

2021-08-18:16:55:17,541 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:17,575 INFO     [learner.py:606] ====Pushing takes 0.032048702239990234 s
2021-08-18:16:55:17,601 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:17,623 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:17,624 INFO     [param_server.py:410] Lock worker 3 with localStep 394 , while globalStep is 393

2021-08-18:16:55:19,166 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:19,180 INFO     [learner.py:606] ====Pushing takes 0.01169276237487793 s
2021-08-18:16:55:19,198 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:19,205 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:19,206 INFO     [param_server.py:381] ====After aggregation in epoch: 393, virtual_clock: 18224.95083414527, top_1: : 67.8283 % (2102.0), top_5: : 100.0 % (3099.0), test loss: 3.094749609629313, test len: 3099.0
2021-08-18:16:55:19,208 INFO     [param_server.py:410] Lock worker 2 with localStep 394 , while globalStep is 394

2021-08-18:16:55:19,209 INFO     [param_server.py:441] ====Epoch 395 completes 14 clients with loss 3.3842839865168455, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:19,210 INFO     [param_server.py:450] ====Start to sample for epoch 395, global virtualClock: 18224.95083414527, round_duration: 77.10954834859407
2021-08-18:16:55:19,211 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:19,474 INFO     [param_server.py:553] For epoch: 395, median_reward: 342.0950784111195, dev: 342.0950784111195
2021-08-18:16:55:20,53 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1087, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:55:20,54 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5183.5545, eval_time 0.5381, test_loss 3.1087, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:55:20,105 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3461, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:55:20,107 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5183.6071, eval_time 0.5864, test_loss 3.3461, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:55:20,123 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:55:20,130 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:20,140 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0188, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:55:20,141 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5183.6396, eval_time 0.6269, test_loss 3.0188, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:55:20,171 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:55:20,187 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:20,241 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:55:20,258 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:20,921 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:20,935 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:21,967 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:21,980 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:22,346 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:22,355 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:23,505 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:23,519 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:24,358 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:24,372 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:24,624 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:24,633 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:24,997 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:25,6 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:25,481 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:25,495 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:26,122 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:26,131 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:26,256 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:26,276 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:26,532 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:26,543 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:26,875 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:26,895 INFO     [learner.py:606] ====Pushing takes 0.018540620803833008 s
2021-08-18:16:55:26,922 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:26,930 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:26,931 INFO     [param_server.py:410] Lock worker 1 with localStep 395 , while globalStep is 394

2021-08-18:16:55:27,50 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:27,69 INFO     [learner.py:606] ====Pushing takes 0.017783164978027344 s
2021-08-18:16:55:27,93 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:27,100 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:27,101 INFO     [param_server.py:410] Lock worker 3 with localStep 395 , while globalStep is 394

2021-08-18:16:55:28,757 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:28,778 INFO     [learner.py:606] ====Pushing takes 0.017483949661254883 s
2021-08-18:16:55:28,795 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:28,800 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:28,800 INFO     [param_server.py:381] ====After aggregation in epoch: 394, virtual_clock: 18302.060382493866, top_1: : 66.1181 % (2049.0), top_5: : 100.0 % (3099.0), test loss: 3.1578745356312505, test len: 3099.0
2021-08-18:16:55:28,803 INFO     [param_server.py:410] Lock worker 2 with localStep 395 , while globalStep is 395

2021-08-18:16:55:28,803 INFO     [param_server.py:441] ====Epoch 396 completes 14 clients with loss 3.394546473001646, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:28,804 INFO     [param_server.py:450] ====Start to sample for epoch 396, global virtualClock: 18302.060382493866, round_duration: 77.10954834859407
2021-08-18:16:55:28,804 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:29,44 INFO     [param_server.py:553] For epoch: 396, median_reward: 334.5101667415515, dev: 334.5101667415515
2021-08-18:16:55:29,735 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2185, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:55:29,736 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5193.2368, eval_time 0.6583, test_loss 3.2185, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:55:29,778 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6971, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:55:29,779 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5193.2795, eval_time 0.7009, test_loss 2.6971, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:55:29,806 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1246, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:55:29,807 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5193.3058, eval_time 0.7291, test_loss 3.1246, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:55:29,809 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:55:29,818 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:29,849 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:55:29,864 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:29,890 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:55:29,912 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:30,672 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:30,682 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:31,714 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:31,729 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:31,979 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:31,988 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:33,278 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:33,292 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:34,146 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:34,164 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:34,531 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:34,541 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:34,571 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:34,582 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:35,185 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:35,203 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:35,798 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:35,818 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:36,17 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:36,26 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:36,96 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:36,110 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:36,494 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:36,513 INFO     [learner.py:606] ====Pushing takes 0.0169219970703125 s
2021-08-18:16:55:36,542 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:36,547 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:36,548 INFO     [param_server.py:410] Lock worker 1 with localStep 396 , while globalStep is 395

2021-08-18:16:55:37,152 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:37,176 INFO     [learner.py:606] ====Pushing takes 0.022535085678100586 s
2021-08-18:16:55:37,202 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:37,207 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:37,208 INFO     [param_server.py:410] Lock worker 3 with localStep 396 , while globalStep is 395

2021-08-18:16:55:38,257 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:38,270 INFO     [learner.py:606] ====Pushing takes 0.011480331420898438 s
2021-08-18:16:55:38,285 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:38,289 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:38,290 INFO     [param_server.py:381] ====After aggregation in epoch: 395, virtual_clock: 18379.16993084246, top_1: : 67.5379 % (2093.0), top_5: : 100.0 % (3099.0), test loss: 3.0133867056833377, test len: 3099.0
2021-08-18:16:55:38,292 INFO     [param_server.py:410] Lock worker 2 with localStep 396 , while globalStep is 396

2021-08-18:16:55:38,292 INFO     [param_server.py:441] ====Epoch 397 completes 14 clients with loss 4.238759497215754, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:38,293 INFO     [param_server.py:450] ====Start to sample for epoch 397, global virtualClock: 18379.16993084246, round_duration: 77.10954834859407
2021-08-18:16:55:38,294 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:38,539 INFO     [param_server.py:553] For epoch: 397, median_reward: 334.24550035170984, dev: 334.24550035170984
2021-08-18:16:55:39,120 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2939, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:55:39,121 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5202.6218, eval_time 0.5488, test_loss 3.2939, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:55:39,161 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9072, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:55:39,162 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5202.6622, eval_time 0.5884, test_loss 2.9072, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:55:39,193 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.393, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:55:39,193 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5202.6921, eval_time 0.6209, test_loss 3.393, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:55:39,187 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:55:39,248 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:39,258 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:55:39,259 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:55:39,272 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:39,276 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:40,11 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:40,29 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:41,41 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:41,55 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:41,354 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:41,364 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:42,819 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:42,828 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:43,494 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:43,507 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:44,62 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:44,72 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:44,245 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:44,258 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:44,838 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:44,852 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:45,600 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:45,621 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:45,808 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:45,817 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:45,859 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:45,869 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:46,228 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:46,251 INFO     [learner.py:606] ====Pushing takes 0.022034645080566406 s
2021-08-18:16:55:46,285 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:46,296 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:46,297 INFO     [param_server.py:410] Lock worker 1 with localStep 397 , while globalStep is 396

2021-08-18:16:55:46,928 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:46,952 INFO     [learner.py:606] ====Pushing takes 0.02289867401123047 s
2021-08-18:16:55:46,977 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:46,983 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:46,984 INFO     [param_server.py:410] Lock worker 3 with localStep 397 , while globalStep is 396

2021-08-18:16:55:48,194 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:48,211 INFO     [learner.py:606] ====Pushing takes 0.015952110290527344 s
2021-08-18:16:55:48,227 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:48,234 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:48,235 INFO     [param_server.py:381] ====After aggregation in epoch: 396, virtual_clock: 18456.279479191056, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.1979947244679487, test len: 3099.0
2021-08-18:16:55:48,238 INFO     [param_server.py:410] Lock worker 2 with localStep 397 , while globalStep is 397

2021-08-18:16:55:48,239 INFO     [param_server.py:441] ====Epoch 398 completes 14 clients with loss 3.5529733232497027, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:48,239 INFO     [param_server.py:450] ====Start to sample for epoch 398, global virtualClock: 18456.279479191056, round_duration: 77.10954834859407
2021-08-18:16:55:48,240 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:48,539 INFO     [param_server.py:553] For epoch: 398, median_reward: 343.844886359594, dev: 343.844886359594
2021-08-18:16:55:49,45 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1259, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:55:49,46 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5212.5465, eval_time 0.4719, test_loss 3.1259, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:55:49,113 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:55:49,116 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7317, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:55:49,119 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5212.6194, eval_time 0.5446, test_loss 2.7317, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:55:49,122 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:49,125 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7184, Top-1 Accuracy: 722.0/1033 (0.6989), Top-5 Accuracy: 1.0
2021-08-18:16:55:49,126 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5212.625, eval_time 0.5533, test_loss 3.7184, test_accuracy 0.6989, test_5_accuracy 1.0 

2021-08-18:16:55:49,188 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:55:49,200 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:49,223 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:55:49,243 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:49,941 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:49,955 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:50,957 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:50,971 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:51,223 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:51,232 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:52,702 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:52,716 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:53,343 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:53,361 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:53,882 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:53,885 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:53,891 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:53,894 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:54,423 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:54,442 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:55,36 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:55,56 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:55,382 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:55,393 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:55,426 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:55,436 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:55,554 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:55,578 INFO     [learner.py:606] ====Pushing takes 0.02173757553100586 s
2021-08-18:16:55:55,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:55,606 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:55,607 INFO     [param_server.py:410] Lock worker 1 with localStep 398 , while globalStep is 397

2021-08-18:16:55:56,471 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:56,498 INFO     [learner.py:606] ====Pushing takes 0.02462482452392578 s
2021-08-18:16:55:56,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:56,528 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:56,529 INFO     [param_server.py:410] Lock worker 3 with localStep 398 , while globalStep is 397

2021-08-18:16:55:57,671 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:57,690 INFO     [learner.py:606] ====Pushing takes 0.01750922203063965 s
2021-08-18:16:55:57,713 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:57,720 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:57,721 INFO     [param_server.py:381] ====After aggregation in epoch: 397, virtual_clock: 18533.38902753965, top_1: : 68.0865 % (2110.0), top_5: : 100.0 % (3099.0), test loss: 3.1919790925803007, test len: 3099.0
2021-08-18:16:55:57,725 INFO     [param_server.py:410] Lock worker 2 with localStep 398 , while globalStep is 398

2021-08-18:16:55:57,725 INFO     [param_server.py:441] ====Epoch 399 completes 14 clients with loss 3.2611240447443026, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:57,726 INFO     [param_server.py:450] ====Start to sample for epoch 399, global virtualClock: 18533.38902753965, round_duration: 77.10954834859407
2021-08-18:16:55:57,727 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:58,16 INFO     [param_server.py:553] For epoch: 399, median_reward: 343.1488825309123, dev: 343.1488825309123
2021-08-18:16:55:58,571 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3181, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:55:58,574 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5222.0749, eval_time 0.5238, test_loss 3.3181, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:55:58,587 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3265, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:55:58,588 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5222.0879, eval_time 0.5369, test_loss 3.3265, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:55:58,605 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1226, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:55:58,606 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5222.1044, eval_time 0.5572, test_loss 3.1226, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:55:58,644 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:55:58,656 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:58,657 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:55:58,665 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:58,684 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:55:58,707 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:59,396 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:59,410 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:00,565 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:00,578 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:00,688 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:00,697 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:02,166 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:02,175 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:02,681 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:02,695 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:03,116 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:03,130 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:03,234 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:03,245 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:03,741 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:03,755 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:04,350 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:04,370 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:04,680 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:04,689 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:04,767 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:04,776 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:04,900 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:04,921 INFO     [learner.py:606] ====Pushing takes 0.01930975914001465 s
2021-08-18:16:56:04,943 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:04,952 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:04,952 INFO     [param_server.py:410] Lock worker 1 with localStep 399 , while globalStep is 398

2021-08-18:16:56:05,799 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:05,825 INFO     [learner.py:606] ====Pushing takes 0.02413487434387207 s
2021-08-18:16:56:05,856 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:05,865 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:05,866 INFO     [param_server.py:410] Lock worker 3 with localStep 399 , while globalStep is 398

2021-08-18:16:56:06,868 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:06,886 INFO     [learner.py:606] ====Pushing takes 0.017255783081054688 s
2021-08-18:16:56:06,902 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:06,911 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:06,912 INFO     [param_server.py:381] ====After aggregation in epoch: 398, virtual_clock: 18610.498575888247, top_1: : 64.3433 % (1994.0), top_5: : 100.0 % (3099.0), test loss: 3.2556998915970325, test len: 3099.0
2021-08-18:16:56:06,916 INFO     [param_server.py:410] Lock worker 2 with localStep 399 , while globalStep is 399

2021-08-18:16:56:06,916 INFO     [param_server.py:441] ====Epoch 400 completes 14 clients with loss 4.737689176585987, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:06,917 INFO     [param_server.py:450] ====Start to sample for epoch 400, global virtualClock: 18610.498575888247, round_duration: 77.10954834859407
2021-08-18:16:56:06,918 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:07,210 INFO     [param_server.py:553] For epoch: 400, median_reward: 346.37310703360777, dev: 346.37310703360777
2021-08-18:16:56:07,834 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0735, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:56:07,835 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5231.3352, eval_time 0.592, test_loss 3.0735, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:56:07,838 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9385, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:56:07,838 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5231.3388, eval_time 0.5954, test_loss 2.9385, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:56:07,903 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1003, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:56:07,904 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5231.4026, eval_time 0.6611, test_loss 3.1003, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:56:07,904 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:07,917 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:07,924 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:07,932 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:07,996 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:08,19 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:08,755 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:08,773 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:09,804 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:09,822 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:10,153 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:10,162 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:11,449 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:11,459 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:12,144 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:12,162 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:12,676 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:12,687 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:12,937 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:12,949 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:13,387 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:13,406 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:14,138 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:14,159 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:14,362 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:14,371 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:14,603 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:14,612 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:14,732 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:14,756 INFO     [learner.py:606] ====Pushing takes 0.023102521896362305 s
2021-08-18:16:56:14,783 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:14,791 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:14,792 INFO     [param_server.py:410] Lock worker 1 with localStep 400 , while globalStep is 399

2021-08-18:16:56:15,502 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:15,526 INFO     [learner.py:606] ====Pushing takes 0.022783756256103516 s
2021-08-18:16:56:15,560 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:15,569 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:15,570 INFO     [param_server.py:410] Lock worker 3 with localStep 400 , while globalStep is 399

2021-08-18:16:56:16,822 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:16,839 INFO     [learner.py:606] ====Pushing takes 0.015662670135498047 s
2021-08-18:16:56:16,857 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:16,863 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:16,864 INFO     [param_server.py:381] ====After aggregation in epoch: 399, virtual_clock: 18687.608124236842, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 3.0374529140966913, test len: 3099.0
2021-08-18:16:56:16,867 INFO     [param_server.py:410] Lock worker 2 with localStep 400 , while globalStep is 400

2021-08-18:16:56:16,868 INFO     [param_server.py:441] ====Epoch 401 completes 14 clients with loss 3.6193849204455737, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:16,868 INFO     [param_server.py:450] ====Start to sample for epoch 401, global virtualClock: 18687.608124236842, round_duration: 77.10954834859407
2021-08-18:16:56:16,869 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:17,152 INFO     [param_server.py:541] Handle Wight 0.024202823638916016 | Send 0.2839052677154541
2021-08-18:16:56:17,153 INFO     [param_server.py:553] For epoch: 401, median_reward: 334.81502225601986, dev: 334.81502225601986
2021-08-18:16:56:17,785 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.008, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:56:17,786 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5241.2867, eval_time 0.5985, test_loss 3.008, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:56:17,799 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7581, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:56:17,800 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5241.3006, eval_time 0.6122, test_loss 2.7581, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:56:17,850 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:17,859 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:17,867 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:17,872 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1446, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:56:17,873 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5241.372, eval_time 0.6871, test_loss 3.1446, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:56:17,880 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:17,944 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:17,965 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:18,769 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:18,783 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:19,839 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:19,852 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:19,942 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:19,954 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:21,423 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:21,433 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:22,125 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:22,139 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:22,634 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:22,646 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:22,693 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:22,702 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:23,242 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:23,269 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:23,877 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:23,899 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:24,206 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:24,217 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:24,217 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:24,228 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:24,468 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:24,489 INFO     [learner.py:606] ====Pushing takes 0.019486188888549805 s
2021-08-18:16:56:24,513 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:24,523 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:24,524 INFO     [param_server.py:410] Lock worker 1 with localStep 401 , while globalStep is 400

2021-08-18:16:56:25,178 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:25,199 INFO     [learner.py:606] ====Pushing takes 0.020330190658569336 s
2021-08-18:16:56:25,226 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:25,233 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:25,234 INFO     [param_server.py:410] Lock worker 3 with localStep 401 , while globalStep is 400

2021-08-18:16:56:26,391 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:26,411 INFO     [learner.py:606] ====Pushing takes 0.0182192325592041 s
2021-08-18:16:56:26,429 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:26,434 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:26,435 INFO     [param_server.py:381] ====After aggregation in epoch: 400, virtual_clock: 18764.717672585437, top_1: : 67.2798 % (2085.0), top_5: : 100.0 % (3099.0), test loss: 2.9702369416201555, test len: 3099.0
2021-08-18:16:56:26,438 INFO     [param_server.py:410] Lock worker 2 with localStep 401 , while globalStep is 401

2021-08-18:16:56:26,438 INFO     [param_server.py:441] ====Epoch 402 completes 14 clients with loss 3.3225639323136567, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:26,439 INFO     [param_server.py:450] ====Start to sample for epoch 402, global virtualClock: 18764.717672585437, round_duration: 77.10954834859407
2021-08-18:16:56:26,439 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:26,731 INFO     [param_server.py:553] For epoch: 402, median_reward: 332.58556117815345, dev: 332.58556117815345
2021-08-18:16:56:27,340 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5187, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:56:27,341 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5250.8412, eval_time 0.5534, test_loss 3.5187, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:56:27,363 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9905, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:56:27,364 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5250.8648, eval_time 0.5839, test_loss 2.9905, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:56:27,414 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:56:27,421 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:27,425 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2745, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:56:27,426 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5250.9244, eval_time 0.6355, test_loss 3.2745, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:56:27,437 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:56:27,453 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:27,520 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:56:27,538 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:28,355 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:28,374 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:29,417 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:29,435 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:29,556 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:29,565 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:30,990 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:30,999 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:31,622 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:31,635 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:32,19 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:32,28 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:32,105 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:32,115 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:32,645 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:32,659 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:33,306 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:33,320 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:33,541 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:33,553 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:33,741 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:33,750 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:33,903 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:33,927 INFO     [learner.py:606] ====Pushing takes 0.022375822067260742 s
2021-08-18:16:56:33,960 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:33,970 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:33,971 INFO     [param_server.py:410] Lock worker 1 with localStep 402 , while globalStep is 401

2021-08-18:16:56:34,729 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:34,753 INFO     [learner.py:606] ====Pushing takes 0.022518396377563477 s
2021-08-18:16:56:34,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:34,784 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:34,785 INFO     [param_server.py:410] Lock worker 3 with localStep 402 , while globalStep is 401

2021-08-18:16:56:35,766 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:35,783 INFO     [learner.py:606] ====Pushing takes 0.015414953231811523 s
2021-08-18:16:56:35,801 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:35,807 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:35,807 INFO     [param_server.py:381] ====After aggregation in epoch: 401, virtual_clock: 18841.827220934032, top_1: : 64.7628 % (2007.0), top_5: : 100.0 % (3099.0), test loss: 3.2611917787128024, test len: 3099.0
2021-08-18:16:56:35,810 INFO     [param_server.py:410] Lock worker 2 with localStep 402 , while globalStep is 402

2021-08-18:16:56:35,811 INFO     [param_server.py:441] ====Epoch 403 completes 14 clients with loss 4.322950575144522, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:35,811 INFO     [param_server.py:450] ====Start to sample for epoch 403, global virtualClock: 18841.827220934032, round_duration: 77.10954834859407
2021-08-18:16:56:35,812 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:36,106 INFO     [param_server.py:553] For epoch: 403, median_reward: 329.2872065534293, dev: 329.2872065534293
2021-08-18:16:56:36,715 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7761, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:56:36,716 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5260.2169, eval_time 0.576, test_loss 2.7761, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:56:36,725 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8026, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:56:36,727 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5260.2271, eval_time 0.5855, test_loss 2.8026, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:56:36,801 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:56:36,802 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8738, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:56:36,803 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5260.302, eval_time 0.6639, test_loss 2.8738, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:56:36,810 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:36,812 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:56:36,827 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:36,881 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:56:36,903 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:37,612 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:37,625 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:38,648 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:38,662 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:39,27 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:39,38 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:40,262 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:40,272 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:40,871 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:40,884 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:41,401 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:41,410 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:41,686 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:41,696 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:41,943 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:41,956 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:42,576 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:42,590 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:42,988 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:42,997 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:43,141 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:43,163 INFO     [learner.py:606] ====Pushing takes 0.01808452606201172 s
2021-08-18:16:56:43,185 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:43,195 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:43,196 INFO     [param_server.py:410] Lock worker 1 with localStep 403 , while globalStep is 402

2021-08-18:16:56:43,317 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:43,328 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:43,989 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:44,18 INFO     [learner.py:606] ====Pushing takes 0.02457141876220703 s
2021-08-18:16:56:44,47 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:44,54 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:44,55 INFO     [param_server.py:410] Lock worker 3 with localStep 403 , while globalStep is 402

2021-08-18:16:56:45,645 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:45,660 INFO     [learner.py:606] ====Pushing takes 0.014066934585571289 s
2021-08-18:16:56:45,677 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:45,687 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:45,688 INFO     [param_server.py:381] ====After aggregation in epoch: 402, virtual_clock: 18918.936769282627, top_1: : 67.0539 % (2078.0), top_5: : 100.0 % (3099.0), test loss: 2.817504321259481, test len: 3099.0
2021-08-18:16:56:45,690 INFO     [param_server.py:410] Lock worker 2 with localStep 403 , while globalStep is 403

2021-08-18:16:56:45,691 INFO     [param_server.py:441] ====Epoch 404 completes 14 clients with loss 4.782439007057143, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:45,691 INFO     [param_server.py:450] ====Start to sample for epoch 404, global virtualClock: 18918.936769282627, round_duration: 77.10954834859407
2021-08-18:16:56:45,692 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:46,0 INFO     [param_server.py:553] For epoch: 404, median_reward: 336.2668469258869, dev: 336.2668469258869
2021-08-18:16:56:46,562 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0607, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:56:46,563 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5270.0634, eval_time 0.5273, test_loss 3.0607, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:56:46,619 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7347, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:56:46,620 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5270.1207, eval_time 0.5845, test_loss 2.7347, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:56:46,630 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:56:46,638 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:46,645 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7643, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:56:46,645 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5270.144, eval_time 0.6121, test_loss 2.7643, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:56:46,687 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:56:46,702 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:46,715 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:56:46,737 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:47,425 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:47,438 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:48,392 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:48,410 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:48,819 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:48,831 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:50,72 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:50,81 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:50,647 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:50,661 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:51,373 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:51,382 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:51,471 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:51,481 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:51,793 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:51,807 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:52,522 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:52,536 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:52,978 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:52,989 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:53,40 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:53,61 INFO     [learner.py:606] ====Pushing takes 0.019487619400024414 s
2021-08-18:16:56:53,69 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:53,83 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:53,94 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:53,100 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:53,101 INFO     [param_server.py:410] Lock worker 1 with localStep 404 , while globalStep is 403

2021-08-18:16:56:54,99 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:54,132 INFO     [learner.py:606] ====Pushing takes 0.031568288803100586 s
2021-08-18:16:56:54,159 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:54,166 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:54,167 INFO     [param_server.py:410] Lock worker 3 with localStep 404 , while globalStep is 403

2021-08-18:16:56:55,140 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:55,157 INFO     [learner.py:606] ====Pushing takes 0.015278339385986328 s
2021-08-18:16:56:55,176 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:55,182 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:55,183 INFO     [param_server.py:381] ====After aggregation in epoch: 403, virtual_clock: 18996.046317631222, top_1: : 67.4734 % (2091.0), top_5: : 100.0 % (3099.0), test loss: 2.8532136766998857, test len: 3099.0
2021-08-18:16:56:55,186 INFO     [param_server.py:410] Lock worker 2 with localStep 404 , while globalStep is 404

2021-08-18:16:56:55,186 INFO     [param_server.py:441] ====Epoch 405 completes 14 clients with loss 4.169365109358608, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:55,187 INFO     [param_server.py:450] ====Start to sample for epoch 405, global virtualClock: 18996.046317631222, round_duration: 77.10954834859407
2021-08-18:16:56:55,187 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:55,439 INFO     [param_server.py:553] For epoch: 405, median_reward: 353.06596630964185, dev: 353.06596630964185
2021-08-18:16:56:56,55 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2317, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:56:56,56 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5279.5563, eval_time 0.5816, test_loss 3.2317, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:56:56,85 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1326, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:56:56,86 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5279.5867, eval_time 0.6076, test_loss 3.1326, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:56:56,123 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0692, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:56:56,125 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5279.6233, eval_time 0.6516, test_loss 3.0692, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:56:56,130 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:56:56,137 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:56,153 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:56:56,166 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:56,198 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:56:56,216 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:57,30 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:57,42 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:57,945 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:57,959 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:58,328 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:58,341 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:59,632 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:59,642 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:00,322 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:00,336 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:00,836 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:00,845 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:00,937 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:00,946 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:01,432 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:01,450 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:02,79 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:02,99 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:02,425 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:02,428 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:02,438 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:02,438 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:02,638 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:02,657 INFO     [learner.py:606] ====Pushing takes 0.018304824829101562 s
2021-08-18:16:57:02,681 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:02,689 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:02,690 INFO     [param_server.py:410] Lock worker 1 with localStep 405 , while globalStep is 404

2021-08-18:16:57:03,417 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:03,439 INFO     [learner.py:606] ====Pushing takes 0.01996326446533203 s
2021-08-18:16:57:03,465 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:03,470 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:03,471 INFO     [param_server.py:410] Lock worker 3 with localStep 405 , while globalStep is 404

2021-08-18:16:57:04,569 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:04,591 INFO     [learner.py:606] ====Pushing takes 0.020526885986328125 s
2021-08-18:16:57:04,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:04,614 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:04,615 INFO     [param_server.py:381] ====After aggregation in epoch: 404, virtual_clock: 19073.155865979817, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 3.14452169780378, test len: 3099.0
2021-08-18:16:57:04,618 INFO     [param_server.py:410] Lock worker 2 with localStep 405 , while globalStep is 405

2021-08-18:16:57:04,618 INFO     [param_server.py:441] ====Epoch 406 completes 14 clients with loss 3.695427377920177, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:04,618 INFO     [param_server.py:450] ====Start to sample for epoch 406, global virtualClock: 19073.155865979817, round_duration: 77.10954834859407
2021-08-18:16:57:04,619 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:04,864 INFO     [param_server.py:553] For epoch: 406, median_reward: 355.86309885113553, dev: 355.86309885113553
2021-08-18:16:57:05,538 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2739, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:57:05,539 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5289.0393, eval_time 0.6408, test_loss 3.2739, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:57:05,569 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2809, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:57:05,573 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5289.0736, eval_time 0.6733, test_loss 3.2809, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:57:05,610 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1376, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:57:05,613 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5289.1119, eval_time 0.7156, test_loss 3.1376, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:57:05,625 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:05,632 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:05,640 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:05,653 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:05,693 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:05,713 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:06,488 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:06,500 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:07,426 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:07,440 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:07,858 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:07,867 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:09,107 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:09,116 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:09,784 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:09,798 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:10,337 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:10,346 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:10,471 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:10,481 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:10,904 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:10,918 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:11,557 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:11,571 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:12,89 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:12,94 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:12,104 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:12,110 INFO     [learner.py:606] ====Pushing takes 0.01945781707763672 s
2021-08-18:16:57:12,135 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:12,140 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:12,141 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:12,142 INFO     [param_server.py:410] Lock worker 1 with localStep 406 , while globalStep is 405

2021-08-18:16:57:12,149 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:13,231 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:13,256 INFO     [learner.py:606] ====Pushing takes 0.020612239837646484 s
2021-08-18:16:57:13,282 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:13,291 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:13,292 INFO     [param_server.py:410] Lock worker 3 with localStep 406 , while globalStep is 405

2021-08-18:16:57:14,423 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:14,443 INFO     [learner.py:606] ====Pushing takes 0.01484823226928711 s
2021-08-18:16:57:14,463 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:14,471 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:14,472 INFO     [param_server.py:381] ====After aggregation in epoch: 405, virtual_clock: 19150.265414328413, top_1: : 65.7631 % (2038.0), top_5: : 100.0 % (3099.0), test loss: 3.2308019708704063, test len: 3099.0
2021-08-18:16:57:14,475 INFO     [param_server.py:410] Lock worker 2 with localStep 406 , while globalStep is 406

2021-08-18:16:57:14,475 INFO     [param_server.py:441] ====Epoch 407 completes 14 clients with loss 4.949319785668743, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:14,476 INFO     [param_server.py:450] ====Start to sample for epoch 407, global virtualClock: 19150.265414328413, round_duration: 77.10954834859407
2021-08-18:16:57:14,477 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:14,772 INFO     [param_server.py:553] For epoch: 407, median_reward: 338.84964984832607, dev: 338.84964984832607
2021-08-18:16:57:15,454 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1035, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:57:15,455 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5298.9555, eval_time 0.6483, test_loss 3.1035, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:57:15,495 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1077, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:57:15,496 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5298.9963, eval_time 0.6889, test_loss 3.1077, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:57:15,536 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2222, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:57:15,537 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5299.0357, eval_time 0.7314, test_loss 3.2222, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:57:15,542 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:15,551 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:15,568 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:15,583 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:15,621 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:15,641 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:16,305 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:16,314 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:17,473 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:17,487 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:17,697 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:17,708 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:18,873 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:18,883 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:19,652 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:19,666 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:20,254 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:20,264 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:20,359 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:20,369 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:20,831 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:20,845 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:21,521 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:21,541 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:21,894 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:21,903 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:21,970 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:22,10 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:22,31 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:22,55 INFO     [learner.py:606] ====Pushing takes 0.02233099937438965 s
2021-08-18:16:57:22,79 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:22,87 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:22,88 INFO     [param_server.py:410] Lock worker 1 with localStep 407 , while globalStep is 406

2021-08-18:16:57:22,944 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:22,969 INFO     [learner.py:606] ====Pushing takes 0.02339458465576172 s
2021-08-18:16:57:22,992 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:22,999 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:23,0 INFO     [param_server.py:410] Lock worker 3 with localStep 407 , while globalStep is 406

2021-08-18:16:57:24,420 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:24,435 INFO     [learner.py:606] ====Pushing takes 0.013508796691894531 s
2021-08-18:16:57:24,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:24,459 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:24,460 INFO     [param_server.py:381] ====After aggregation in epoch: 406, virtual_clock: 19227.374962677008, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 3.1444679697354636, test len: 3099.0
2021-08-18:16:57:24,463 INFO     [param_server.py:410] Lock worker 2 with localStep 407 , while globalStep is 407

2021-08-18:16:57:24,463 INFO     [param_server.py:441] ====Epoch 408 completes 14 clients with loss 4.268144983518484, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:24,464 INFO     [param_server.py:450] ====Start to sample for epoch 408, global virtualClock: 19227.374962677008, round_duration: 77.10954834859407
2021-08-18:16:57:24,465 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:24,731 INFO     [param_server.py:553] For epoch: 408, median_reward: 347.90385490071276, dev: 347.90385490071276
2021-08-18:16:57:25,254 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4156, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:57:25,257 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5308.7578, eval_time 0.4903, test_loss 3.4156, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:57:25,306 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1378, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:57:25,309 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5308.8097, eval_time 0.5398, test_loss 3.1378, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:57:25,328 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:57:25,337 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:25,336 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.8489, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:57:25,339 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5308.8374, eval_time 0.574, test_loss 4.8489, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:57:25,383 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:57:25,395 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:25,412 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:57:25,430 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:26,173 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:26,182 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:27,202 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:27,216 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:27,365 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:27,374 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:28,851 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:28,869 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:29,676 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:29,697 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:29,916 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:29,930 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:30,263 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:30,275 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:30,830 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:30,844 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:31,508 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:31,527 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:31,538 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:31,550 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:32,1 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:32,10 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:32,29 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:32,49 INFO     [learner.py:606] ====Pushing takes 0.018051624298095703 s
2021-08-18:16:57:32,73 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:32,79 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:32,80 INFO     [param_server.py:410] Lock worker 1 with localStep 408 , while globalStep is 407

2021-08-18:16:57:32,994 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:33,16 INFO     [learner.py:606] ====Pushing takes 0.02103877067565918 s
2021-08-18:16:57:33,45 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:33,56 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:33,56 INFO     [param_server.py:410] Lock worker 3 with localStep 408 , while globalStep is 407

2021-08-18:16:57:33,635 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:33,654 INFO     [learner.py:606] ====Pushing takes 0.014090776443481445 s
2021-08-18:16:57:33,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:33,675 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:33,676 INFO     [param_server.py:381] ====After aggregation in epoch: 407, virtual_clock: 19304.484511025603, top_1: : 66.4408 % (2059.0), top_5: : 100.0 % (3099.0), test loss: 3.8007939524120755, test len: 3099.0
2021-08-18:16:57:33,679 INFO     [param_server.py:410] Lock worker 2 with localStep 408 , while globalStep is 408

2021-08-18:16:57:33,680 INFO     [param_server.py:441] ====Epoch 409 completes 14 clients with loss 3.7806805834710957, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:33,680 INFO     [param_server.py:450] ====Start to sample for epoch 409, global virtualClock: 19304.484511025603, round_duration: 77.10954834859407
2021-08-18:16:57:33,681 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:33,970 INFO     [param_server.py:553] For epoch: 409, median_reward: 328.91669812585, dev: 328.91669812585
2021-08-18:16:57:34,682 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5711, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:57:34,683 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5318.1836, eval_time 0.6561, test_loss 3.5711, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:57:34,705 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2671, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:57:34,706 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5318.2068, eval_time 0.6791, test_loss 3.2671, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:57:34,764 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.972, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:57:34,766 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5318.2641, eval_time 0.7405, test_loss 2.972, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:57:34,779 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:57:34,784 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:57:34,787 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:34,799 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:34,851 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:57:34,879 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:35,674 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:35,687 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:36,625 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:36,639 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:36,913 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:36,923 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:38,560 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:38,578 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:39,64 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:39,77 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:39,667 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:39,680 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:39,897 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:39,910 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:40,252 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:40,266 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:40,968 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:40,988 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:41,352 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:41,371 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:41,550 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:41,571 INFO     [learner.py:606] ====Pushing takes 0.019395828247070312 s
2021-08-18:16:57:41,595 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:41,607 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:41,608 INFO     [param_server.py:410] Lock worker 1 with localStep 409 , while globalStep is 408

2021-08-18:16:57:41,784 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:41,798 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:42,779 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:42,801 INFO     [learner.py:606] ====Pushing takes 0.02015233039855957 s
2021-08-18:16:57:42,827 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:42,833 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:42,834 INFO     [param_server.py:410] Lock worker 3 with localStep 409 , while globalStep is 408

2021-08-18:16:57:43,574 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:43,592 INFO     [learner.py:606] ====Pushing takes 0.015924930572509766 s
2021-08-18:16:57:43,607 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:43,612 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:43,621 INFO     [param_server.py:381] ====After aggregation in epoch: 408, virtual_clock: 19381.594059374198, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 3.2700814074940148, test len: 3099.0
2021-08-18:16:57:43,624 INFO     [param_server.py:410] Lock worker 2 with localStep 409 , while globalStep is 409

2021-08-18:16:57:43,625 INFO     [param_server.py:441] ====Epoch 410 completes 14 clients with loss 4.206790380092445, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:43,625 INFO     [param_server.py:450] ====Start to sample for epoch 410, global virtualClock: 19381.594059374198, round_duration: 77.10954834859407
2021-08-18:16:57:43,626 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:43,903 INFO     [param_server.py:553] For epoch: 410, median_reward: 345.15894849652034, dev: 345.15894849652034
2021-08-18:16:57:44,569 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2896, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:57:44,569 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5328.0698, eval_time 0.6227, test_loss 3.2896, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:57:44,590 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5704, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:57:44,594 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5328.0944, eval_time 0.6441, test_loss 3.5704, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:57:44,620 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1856, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:57:44,622 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5328.121, eval_time 0.6757, test_loss 3.1856, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:57:44,665 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:57:44,670 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:57:44,682 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:44,683 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:44,696 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:57:44,714 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:45,701 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:45,728 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:46,671 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:46,692 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:47,77 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:47,91 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:48,857 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:48,869 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:49,135 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:49,149 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:49,813 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:49,825 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:50,4 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:50,13 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:50,311 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:50,325 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:51,20 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:51,34 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:51,453 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:51,464 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:51,614 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:51,635 INFO     [learner.py:606] ====Pushing takes 0.01939868927001953 s
2021-08-18:16:57:51,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:51,667 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:51,668 INFO     [param_server.py:410] Lock worker 1 with localStep 410 , while globalStep is 409

2021-08-18:16:57:51,797 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:51,811 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:53,29 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:53,50 INFO     [learner.py:606] ====Pushing takes 0.020203828811645508 s
2021-08-18:16:57:53,74 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:53,79 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:53,80 INFO     [param_server.py:410] Lock worker 3 with localStep 410 , while globalStep is 409

2021-08-18:16:57:53,675 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:53,690 INFO     [learner.py:606] ====Pushing takes 0.013070344924926758 s
2021-08-18:16:57:53,707 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:53,713 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:53,714 INFO     [param_server.py:381] ====After aggregation in epoch: 409, virtual_clock: 19458.703607722793, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 3.348514505006649, test len: 3099.0
2021-08-18:16:57:53,716 INFO     [param_server.py:410] Lock worker 2 with localStep 410 , while globalStep is 410

2021-08-18:16:57:53,717 INFO     [param_server.py:441] ====Epoch 411 completes 14 clients with loss 3.826790837642811, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:53,717 INFO     [param_server.py:450] ====Start to sample for epoch 411, global virtualClock: 19458.703607722793, round_duration: 77.10954834859407
2021-08-18:16:57:53,718 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:53,997 INFO     [param_server.py:553] For epoch: 411, median_reward: 332.8003090605763, dev: 332.8003090605763
2021-08-18:16:57:54,754 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0887, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:57:54,755 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5338.2558, eval_time 0.6924, test_loss 3.0887, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:57:54,793 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1629, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:57:54,794 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5338.2944, eval_time 0.7224, test_loss 3.1629, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:57:54,860 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:57:54,855 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3679, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:16:57:54,867 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5338.3655, eval_time 0.8039, test_loss 3.3679, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:16:57:54,868 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:57:54,876 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:54,887 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:54,940 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:57:54,961 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:55,808 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:55,818 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:56,838 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:56,853 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:57,244 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:57,254 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:58,593 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:58,612 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:59,598 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:59,625 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:59,998 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:00,12 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:00,24 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:00,38 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:00,723 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:00,744 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:01,577 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:01,598 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:01,959 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:01,978 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:02,157 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:02,185 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:02,190 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:02,209 INFO     [learner.py:606] ====Pushing takes 0.018176794052124023 s
2021-08-18:16:58:02,239 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:02,247 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:02,248 INFO     [param_server.py:410] Lock worker 1 with localStep 411 , while globalStep is 410

2021-08-18:16:58:03,361 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:03,386 INFO     [learner.py:606] ====Pushing takes 0.020153284072875977 s
2021-08-18:16:58:03,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:03,415 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:03,416 INFO     [param_server.py:410] Lock worker 3 with localStep 411 , while globalStep is 410

2021-08-18:16:58:04,423 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:04,441 INFO     [learner.py:606] ====Pushing takes 0.016346454620361328 s
2021-08-18:16:58:04,456 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:04,462 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:04,463 INFO     [param_server.py:381] ====After aggregation in epoch: 410, virtual_clock: 19535.81315607139, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 3.2065192339596926, test len: 3099.0
2021-08-18:16:58:04,467 INFO     [param_server.py:410] Lock worker 2 with localStep 411 , while globalStep is 411

2021-08-18:16:58:04,468 INFO     [param_server.py:441] ====Epoch 412 completes 14 clients with loss 4.206019050305858, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:04,468 INFO     [param_server.py:450] ====Start to sample for epoch 412, global virtualClock: 19535.81315607139, round_duration: 77.10954834859407
2021-08-18:16:58:04,469 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:04,772 INFO     [param_server.py:553] For epoch: 412, median_reward: 339.8661130525389, dev: 339.8661130525389
2021-08-18:16:58:05,460 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5938, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:58:05,462 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5348.9626, eval_time 0.6447, test_loss 3.5938, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:58:05,521 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8414, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:58:05,522 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5349.0226, eval_time 0.703, test_loss 2.8414, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:58:05,535 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:05,548 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:05,562 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0045, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:58:05,565 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5349.0641, eval_time 0.7479, test_loss 3.0045, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:58:05,594 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:05,614 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:05,635 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:05,662 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:06,570 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:06,590 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:07,558 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:07,579 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:07,621 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:07,631 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:09,633 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:09,651 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:10,220 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:10,240 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:10,378 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:10,392 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:11,112 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:11,131 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:11,425 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:11,439 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:12,123 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:12,142 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:12,225 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:12,234 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:12,648 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:12,670 INFO     [learner.py:606] ====Pushing takes 0.02058267593383789 s
2021-08-18:16:58:12,698 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:12,705 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:12,706 INFO     [param_server.py:410] Lock worker 1 with localStep 412 , while globalStep is 411

2021-08-18:16:58:13,79 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:13,93 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:14,341 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:14,364 INFO     [learner.py:606] ====Pushing takes 0.02100992202758789 s
2021-08-18:16:58:14,388 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:14,394 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:14,394 INFO     [param_server.py:410] Lock worker 3 with localStep 412 , while globalStep is 411

2021-08-18:16:58:14,470 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:14,485 INFO     [learner.py:606] ====Pushing takes 0.01404261589050293 s
2021-08-18:16:58:14,502 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:14,507 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:14,507 INFO     [param_server.py:381] ====After aggregation in epoch: 411, virtual_clock: 19612.922704419983, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 3.1465541654162936, test len: 3099.0
2021-08-18:16:58:14,510 INFO     [param_server.py:410] Lock worker 2 with localStep 412 , while globalStep is 412

2021-08-18:16:58:14,510 INFO     [param_server.py:441] ====Epoch 413 completes 14 clients with loss 3.364488735967464, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:14,510 INFO     [param_server.py:450] ====Start to sample for epoch 413, global virtualClock: 19612.922704419983, round_duration: 77.10954834859407
2021-08-18:16:58:14,523 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:14,782 INFO     [param_server.py:553] For epoch: 413, median_reward: 347.3456147135333, dev: 347.3456147135333
2021-08-18:16:58:15,454 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5928, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:58:15,455 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5358.955, eval_time 0.5947, test_loss 3.5928, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:58:15,547 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:15,560 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2055, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:58:15,560 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5359.0605, eval_time 0.6963, test_loss 3.2055, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:58:15,570 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:15,628 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5421, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:58:15,628 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:15,628 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5359.1267, eval_time 0.7696, test_loss 3.5421, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:58:15,653 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:15,693 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:15,731 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:16,580 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:16,595 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:17,674 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:17,685 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:17,756 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:17,770 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:19,548 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:19,566 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:20,334 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:20,361 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:20,418 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:20,427 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:20,982 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:21,3 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:21,683 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:21,716 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:22,143 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:22,157 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:22,668 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:22,689 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:23,104 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:23,118 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:23,248 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:23,269 INFO     [learner.py:606] ====Pushing takes 0.017958641052246094 s
2021-08-18:16:58:23,302 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:23,310 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:23,311 INFO     [param_server.py:410] Lock worker 1 with localStep 413 , while globalStep is 412

2021-08-18:16:58:24,221 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:24,222 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:24,238 INFO     [learner.py:606] ====Pushing takes 0.014358997344970703 s
2021-08-18:16:58:24,269 INFO     [learner.py:606] ====Pushing takes 0.04638314247131348 s
2021-08-18:16:58:24,282 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:24,286 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 9 clients
2021-08-18:16:58:24,287 INFO     [param_server.py:410] Lock worker 2 with localStep 413 , while globalStep is 412

2021-08-18:16:58:24,305 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:24,310 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:24,311 INFO     [param_server.py:381] ====After aggregation in epoch: 412, virtual_clock: 19690.03225276858, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 3.4467968852431685, test len: 3099.0
2021-08-18:16:58:24,313 INFO     [param_server.py:410] Lock worker 3 with localStep 413 , while globalStep is 413

2021-08-18:16:58:24,314 INFO     [param_server.py:441] ====Epoch 414 completes 14 clients with loss 4.077209863395487, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:24,314 INFO     [param_server.py:450] ====Start to sample for epoch 414, global virtualClock: 19690.03225276858, round_duration: 77.10954834859407
2021-08-18:16:58:24,315 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:24,594 INFO     [param_server.py:553] For epoch: 414, median_reward: 339.36962987734336, dev: 339.36962987734336
2021-08-18:16:58:25,307 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.135, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:58:25,309 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5368.8094, eval_time 0.6586, test_loss 3.135, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:58:25,384 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:58:25,401 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:25,427 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7387, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:58:25,427 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4658, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:58:25,428 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5368.9283, eval_time 0.7724, test_loss 2.7387, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:58:25,428 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5368.9267, eval_time 0.7779, test_loss 3.4658, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:58:25,496 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:58:25,496 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:58:25,524 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:25,525 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:26,429 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:26,443 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:27,492 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:27,504 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:27,565 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:27,579 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:29,161 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:29,175 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:29,925 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:29,946 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:30,151 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:30,166 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:30,589 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:30,603 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:31,222 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:31,255 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:31,962 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:31,973 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:32,131 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:32,159 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:32,616 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:32,636 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:32,728 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:32,747 INFO     [learner.py:606] ====Pushing takes 0.018250226974487305 s
2021-08-18:16:58:32,783 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:32,789 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:32,790 INFO     [param_server.py:410] Lock worker 1 with localStep 414 , while globalStep is 413

2021-08-18:16:58:33,678 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:33,702 INFO     [learner.py:606] ====Pushing takes 0.022007465362548828 s
2021-08-18:16:58:33,726 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:33,732 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:33,733 INFO     [param_server.py:410] Lock worker 3 with localStep 414 , while globalStep is 413

2021-08-18:16:58:34,158 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:34,177 INFO     [learner.py:606] ====Pushing takes 0.01702284812927246 s
2021-08-18:16:58:34,193 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:34,198 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:34,198 INFO     [param_server.py:381] ====After aggregation in epoch: 413, virtual_clock: 19767.141801117174, top_1: : 66.7635 % (2069.0), top_5: : 100.0 % (3099.0), test loss: 3.1131439849182407, test len: 3099.0
2021-08-18:16:58:34,201 INFO     [param_server.py:410] Lock worker 2 with localStep 414 , while globalStep is 414

2021-08-18:16:58:34,201 INFO     [param_server.py:441] ====Epoch 415 completes 14 clients with loss 3.6398952830851092, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:34,202 INFO     [param_server.py:450] ====Start to sample for epoch 415, global virtualClock: 19767.141801117174, round_duration: 77.10954834859407
2021-08-18:16:58:34,202 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:34,481 INFO     [param_server.py:553] For epoch: 415, median_reward: 332.857908251475, dev: 332.857908251475
2021-08-18:16:58:35,103 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2063, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:58:35,105 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5378.605, eval_time 0.5668, test_loss 3.2063, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:58:35,174 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:58:35,179 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3139, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:58:35,181 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5378.6812, eval_time 0.6428, test_loss 4.3139, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:58:35,181 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:35,250 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:58:35,265 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5162, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:58:35,266 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5378.7648, eval_time 0.7291, test_loss 3.5162, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:58:35,270 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:35,323 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:58:35,357 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:36,184 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:36,198 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:37,324 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:37,351 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:37,455 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:37,465 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:39,422 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:39,436 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:39,905 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:39,926 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:40,35 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:40,46 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:40,766 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:40,785 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:41,171 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:41,258 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:41,617 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:41,629 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:42,4 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:42,24 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:42,617 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:42,638 INFO     [learner.py:606] ====Pushing takes 0.018918275833129883 s
2021-08-18:16:58:42,674 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:42,682 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:42,683 INFO     [param_server.py:410] Lock worker 1 with localStep 415 , while globalStep is 414

2021-08-18:16:58:43,46 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:43,73 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:43,807 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:43,827 INFO     [learner.py:606] ====Pushing takes 0.018054723739624023 s
2021-08-18:16:58:43,855 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:43,860 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 9 clients
2021-08-18:16:58:43,861 INFO     [param_server.py:410] Lock worker 2 with localStep 415 , while globalStep is 414

2021-08-18:16:58:44,324 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:44,347 INFO     [learner.py:606] ====Pushing takes 0.021271705627441406 s
2021-08-18:16:58:44,371 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:44,376 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:44,377 INFO     [param_server.py:381] ====After aggregation in epoch: 414, virtual_clock: 19844.25134946577, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 3.6787993643018937, test len: 3099.0
2021-08-18:16:58:44,380 INFO     [param_server.py:410] Lock worker 3 with localStep 415 , while globalStep is 415

2021-08-18:16:58:44,380 INFO     [param_server.py:441] ====Epoch 416 completes 14 clients with loss 3.9247450090178844, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:44,381 INFO     [param_server.py:450] ====Start to sample for epoch 416, global virtualClock: 19844.25134946577, round_duration: 77.10954834859407
2021-08-18:16:58:44,382 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:44,668 INFO     [param_server.py:553] For epoch: 416, median_reward: 334.01308556391706, dev: 334.01308556391706
2021-08-18:16:58:45,226 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8405, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:58:45,226 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5388.7266, eval_time 0.5107, test_loss 3.8405, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:58:45,239 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1381, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:58:45,240 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5388.7404, eval_time 0.5243, test_loss 3.1381, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:58:45,293 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:58:45,300 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:45,309 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:58:45,324 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:45,359 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9969, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:58:45,360 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5388.8585, eval_time 0.6466, test_loss 2.9969, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:58:45,429 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:58:45,454 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:46,365 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:46,379 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:47,471 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:47,485 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:47,554 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:47,564 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:49,264 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:49,291 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:50,190 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:50,200 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:50,217 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:50,228 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:50,743 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:50,752 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:51,296 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:51,310 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:51,784 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:51,793 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:51,954 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:51,968 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:52,513 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:52,529 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:52,533 INFO     [learner.py:606] ====Pushing takes 0.01765751838684082 s
2021-08-18:16:58:52,539 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:52,563 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:52,569 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:52,570 INFO     [param_server.py:410] Lock worker 1 with localStep 416 , while globalStep is 415

2021-08-18:16:58:53,523 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:53,545 INFO     [learner.py:606] ====Pushing takes 0.021030902862548828 s
2021-08-18:16:58:53,573 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:53,579 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:53,580 INFO     [param_server.py:410] Lock worker 3 with localStep 416 , while globalStep is 415

2021-08-18:16:58:54,75 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:54,90 INFO     [learner.py:606] ====Pushing takes 0.013008832931518555 s
2021-08-18:16:58:54,104 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:54,109 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:54,110 INFO     [param_server.py:381] ====After aggregation in epoch: 415, virtual_clock: 19921.360897814364, top_1: : 66.8925 % (2073.0), top_5: : 100.0 % (3099.0), test loss: 3.325161403114045, test len: 3099.0
2021-08-18:16:58:54,113 INFO     [param_server.py:410] Lock worker 2 with localStep 416 , while globalStep is 416

2021-08-18:16:58:54,113 INFO     [param_server.py:441] ====Epoch 417 completes 14 clients with loss 4.477180502887251, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:54,114 INFO     [param_server.py:450] ====Start to sample for epoch 417, global virtualClock: 19921.360897814364, round_duration: 77.10954834859407
2021-08-18:16:58:54,114 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:54,385 INFO     [param_server.py:553] For epoch: 417, median_reward: 349.4489185155328, dev: 349.4489185155328
2021-08-18:16:58:55,8 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9002, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:58:55,9 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5398.5091, eval_time 0.5798, test_loss 3.9002, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:58:55,76 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:58:55,88 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:55,95 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4505, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:58:55,96 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5398.5966, eval_time 0.6555, test_loss 3.4505, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:58:55,160 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.001, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:58:55,161 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5398.6595, eval_time 0.7319, test_loss 4.001, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:58:55,166 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:58:55,185 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:55,218 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:58:55,251 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:56,363 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:56,389 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:57,374 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:57,388 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:57,482 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:57,492 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:59,248 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:59,266 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:59,968 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:00,1 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:00,89 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:00,100 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:00,659 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:00,677 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:01,336 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:01,357 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:01,876 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:01,887 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:02,106 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:02,127 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:02,580 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:02,593 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:02,712 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:02,733 INFO     [learner.py:606] ====Pushing takes 0.020259380340576172 s
2021-08-18:16:59:02,764 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:02,773 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:02,774 INFO     [param_server.py:410] Lock worker 1 with localStep 417 , while globalStep is 416

2021-08-18:16:59:03,751 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:03,776 INFO     [learner.py:606] ====Pushing takes 0.02344202995300293 s
2021-08-18:16:59:03,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:03,804 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:03,805 INFO     [param_server.py:410] Lock worker 3 with localStep 417 , while globalStep is 416

2021-08-18:16:59:04,330 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:04,346 INFO     [learner.py:606] ====Pushing takes 0.014242410659790039 s
2021-08-18:16:59:04,361 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:04,365 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:04,366 INFO     [param_server.py:381] ====After aggregation in epoch: 416, virtual_clock: 19998.47044616296, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 3.783915899418018, test len: 3099.0
2021-08-18:16:59:04,369 INFO     [param_server.py:410] Lock worker 2 with localStep 417 , while globalStep is 417

2021-08-18:16:59:04,370 INFO     [param_server.py:441] ====Epoch 418 completes 14 clients with loss 3.7898438187166064, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:04,370 INFO     [param_server.py:450] ====Start to sample for epoch 418, global virtualClock: 19998.47044616296, round_duration: 77.10954834859407
2021-08-18:16:59:04,371 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:04,638 INFO     [param_server.py:553] For epoch: 418, median_reward: 336.6822323526285, dev: 336.6822323526285
2021-08-18:16:59:05,327 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9051, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:59:05,328 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5408.8285, eval_time 0.655, test_loss 2.9051, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:59:05,397 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:05,411 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:05,439 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8077, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:59:05,440 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5408.9403, eval_time 0.7597, test_loss 2.8077, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:59:05,496 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0577, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:59:05,497 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5408.996, eval_time 0.8251, test_loss 3.0577, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:59:05,514 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:05,529 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:05,592 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:05,627 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:06,514 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:06,536 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:07,652 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:07,662 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:07,741 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:07,761 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:09,204 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:09,222 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:10,354 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:10,375 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:10,502 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:10,521 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:10,712 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:10,726 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:11,549 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:11,577 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:12,203 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:12,215 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:12,449 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:12,476 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:12,620 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:12,641 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:13,154 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:13,173 INFO     [learner.py:606] ====Pushing takes 0.017772674560546875 s
2021-08-18:16:59:13,204 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:13,210 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:13,211 INFO     [param_server.py:410] Lock worker 1 with localStep 418 , while globalStep is 417

2021-08-18:16:59:13,810 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:13,833 INFO     [learner.py:606] ====Pushing takes 0.021183013916015625 s
2021-08-18:16:59:13,854 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:13,861 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:13,861 INFO     [param_server.py:410] Lock worker 3 with localStep 418 , while globalStep is 417

2021-08-18:16:59:14,700 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:14,716 INFO     [learner.py:606] ====Pushing takes 0.014353752136230469 s
2021-08-18:16:59:14,731 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:14,736 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:14,736 INFO     [param_server.py:381] ====After aggregation in epoch: 417, virtual_clock: 20075.579994511554, top_1: : 66.8603 % (2072.0), top_5: : 100.0 % (3099.0), test loss: 2.92349393230311, test len: 3099.0
2021-08-18:16:59:14,739 INFO     [param_server.py:410] Lock worker 2 with localStep 418 , while globalStep is 418

2021-08-18:16:59:14,739 INFO     [param_server.py:441] ====Epoch 419 completes 14 clients with loss 2.556704438435543, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:14,739 INFO     [param_server.py:450] ====Start to sample for epoch 419, global virtualClock: 20075.579994511554, round_duration: 77.10954834859407
2021-08-18:16:59:14,740 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:15,23 INFO     [param_server.py:553] For epoch: 419, median_reward: 321.9793236460918, dev: 321.9793236460918
2021-08-18:16:59:15,672 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5714, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:59:15,674 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5419.1743, eval_time 0.6155, test_loss 3.5714, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:59:15,717 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.079, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:59:15,718 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5419.2181, eval_time 0.6592, test_loss 3.079, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:59:15,743 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:15,751 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:15,784 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:15,800 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:15,837 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3427, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:59:15,838 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5419.3367, eval_time 0.7801, test_loss 3.3427, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:59:15,903 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:15,931 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:16,654 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:16,675 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:17,990 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:18,2 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:18,101 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:18,122 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:19,484 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:19,499 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:20,598 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:20,609 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:20,708 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:20,735 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:21,52 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:21,80 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:22,24 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:22,39 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:22,298 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:22,310 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:22,876 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:22,896 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:22,978 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:22,992 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:23,506 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:23,526 INFO     [learner.py:606] ====Pushing takes 0.017982006072998047 s
2021-08-18:16:59:23,554 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:23,563 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:23,564 INFO     [param_server.py:410] Lock worker 1 with localStep 419 , while globalStep is 418

2021-08-18:16:59:24,101 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:24,125 INFO     [learner.py:606] ====Pushing takes 0.02287435531616211 s
2021-08-18:16:59:24,147 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:24,152 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:24,153 INFO     [param_server.py:410] Lock worker 3 with localStep 419 , while globalStep is 418

2021-08-18:16:59:24,587 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:24,604 INFO     [learner.py:606] ====Pushing takes 0.01579904556274414 s
2021-08-18:16:59:24,620 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:24,626 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:24,627 INFO     [param_server.py:381] ====After aggregation in epoch: 418, virtual_clock: 20152.68954286015, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 3.3310268830370027, test len: 3099.0
2021-08-18:16:59:24,630 INFO     [param_server.py:410] Lock worker 2 with localStep 419 , while globalStep is 419

2021-08-18:16:59:24,630 INFO     [param_server.py:441] ====Epoch 420 completes 14 clients with loss 6.557910191239516, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:24,631 INFO     [param_server.py:450] ====Start to sample for epoch 420, global virtualClock: 20152.68954286015, round_duration: 77.10954834859407
2021-08-18:16:59:24,632 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:24,918 INFO     [param_server.py:553] For epoch: 420, median_reward: 347.29349528625545, dev: 347.29349528625545
2021-08-18:16:59:25,534 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5059, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:59:25,534 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5429.0347, eval_time 0.5811, test_loss 3.5059, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:59:25,564 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2508, Top-1 Accuracy: 726.0/1033 (0.7028), Top-5 Accuracy: 1.0
2021-08-18:16:59:25,565 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5429.0639, eval_time 0.6138, test_loss 3.2508, test_accuracy 0.7028, test_5_accuracy 1.0 

2021-08-18:16:59:25,573 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9802, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:59:25,574 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5429.0743, eval_time 0.6197, test_loss 2.9802, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:59:25,603 INFO     [learner.py:526] ====Start train round 420
2021-08-18:16:59:25,612 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:25,624 INFO     [learner.py:526] ====Start train round 420
2021-08-18:16:59:25,646 INFO     [learner.py:526] ====Start train round 420
2021-08-18:16:59:25,660 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:25,662 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:26,817 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:26,845 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:27,801 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:27,814 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:28,89 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:28,117 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:29,925 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:29,934 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:30,514 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:30,529 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:30,609 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:30,623 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:31,376 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:31,394 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:32,54 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:32,81 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:32,246 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:32,264 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:32,887 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:32,907 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:33,368 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:33,382 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:33,535 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:33,557 INFO     [learner.py:606] ====Pushing takes 0.018228530883789062 s
2021-08-18:16:59:33,584 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:33,590 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:33,590 INFO     [param_server.py:410] Lock worker 1 with localStep 420 , while globalStep is 419

2021-08-18:16:59:34,522 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:34,523 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:34,536 INFO     [learner.py:606] ====Pushing takes 0.0128631591796875 s
2021-08-18:16:59:34,550 INFO     [learner.py:606] ====Pushing takes 0.026378393173217773 s
2021-08-18:16:59:34,554 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:34,559 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 9 clients
2021-08-18:16:59:34,560 INFO     [param_server.py:410] Lock worker 2 with localStep 420 , while globalStep is 419

2021-08-18:16:59:34,577 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:34,583 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:34,584 INFO     [param_server.py:381] ====After aggregation in epoch: 419, virtual_clock: 20229.799091208744, top_1: : 67.8283 % (2102.0), top_5: : 100.0 % (3099.0), test loss: 3.245664287496496, test len: 3099.0
2021-08-18:16:59:34,587 INFO     [param_server.py:410] Lock worker 3 with localStep 420 , while globalStep is 420

2021-08-18:16:59:34,587 INFO     [param_server.py:441] ====Epoch 421 completes 14 clients with loss 5.16755370998271, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:34,588 INFO     [param_server.py:450] ====Start to sample for epoch 421, global virtualClock: 20229.799091208744, round_duration: 77.10954834859407
2021-08-18:16:59:34,588 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:34,858 INFO     [param_server.py:541] Handle Wight 0.026823043823242188 | Send 0.2708752155303955
2021-08-18:16:59:34,859 INFO     [param_server.py:553] For epoch: 421, median_reward: 346.12736585212895, dev: 346.12736585212895
2021-08-18:16:59:35,470 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4411, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:59:35,471 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5438.9695, eval_time 0.5774, test_loss 3.4411, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:59:35,484 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7521, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:59:35,486 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5438.986, eval_time 0.5907, test_loss 3.7521, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:59:35,487 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.4825, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:59:35,488 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5438.9885, eval_time 0.5896, test_loss 4.4825, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:59:35,532 INFO     [learner.py:526] ====Start train round 421
2021-08-18:16:59:35,548 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:35,549 INFO     [learner.py:526] ====Start train round 421
2021-08-18:16:59:35,558 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:35,559 INFO     [learner.py:526] ====Start train round 421
2021-08-18:16:59:35,568 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:36,251 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:36,265 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:37,693 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:37,702 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:37,893 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:37,933 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:39,404 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:39,423 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:40,421 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:40,430 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:40,627 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:40,653 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:41,19 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:41,39 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:42,63 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:42,78 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:42,106 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:42,118 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:42,762 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:42,775 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:42,892 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:42,913 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:43,551 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:43,572 INFO     [learner.py:606] ====Pushing takes 0.017570972442626953 s
2021-08-18:16:59:43,599 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:43,607 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:43,608 INFO     [param_server.py:410] Lock worker 1 with localStep 421 , while globalStep is 420

2021-08-18:16:59:43,753 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:43,776 INFO     [learner.py:606] ====Pushing takes 0.021855831146240234 s
2021-08-18:16:59:43,799 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:43,805 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:43,806 INFO     [param_server.py:410] Lock worker 3 with localStep 421 , while globalStep is 420

2021-08-18:16:59:44,292 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:44,309 INFO     [learner.py:606] ====Pushing takes 0.015001535415649414 s
2021-08-18:16:59:44,323 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:44,328 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:44,329 INFO     [param_server.py:381] ====After aggregation in epoch: 420, virtual_clock: 20306.90863955734, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 3.8918894087826765, test len: 3099.0
2021-08-18:16:59:44,331 INFO     [param_server.py:410] Lock worker 2 with localStep 421 , while globalStep is 421

2021-08-18:16:59:44,332 INFO     [param_server.py:441] ====Epoch 422 completes 14 clients with loss 3.2372365005570405, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:44,332 INFO     [param_server.py:450] ====Start to sample for epoch 422, global virtualClock: 20306.90863955734, round_duration: 77.10954834859407
2021-08-18:16:59:44,332 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:16:59:44,608 INFO     [param_server.py:553] For epoch: 422, median_reward: 347.02866171290106, dev: 347.02866171290106
2021-08-18:16:59:45,294 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.6412, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:59:45,294 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5448.7947, eval_time 0.6525, test_loss 4.6412, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:59:45,305 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5838, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:59:45,306 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5448.8061, eval_time 0.6636, test_loss 3.5838, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:59:45,355 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5476, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:16:59:45,356 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5448.8548, eval_time 0.715, test_loss 3.5476, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:16:59:45,362 INFO     [learner.py:526] ====Start train round 422
2021-08-18:16:59:45,370 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:45,375 INFO     [learner.py:526] ====Start train round 422
2021-08-18:16:59:45,388 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:45,427 INFO     [learner.py:526] ====Start train round 422
2021-08-18:16:59:45,455 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:46,756 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:46,783 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:47,548 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:47,559 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:47,569 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:47,615 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:49,803 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:49,813 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:50,72 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:50,91 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:50,157 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:50,172 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:50,799 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:50,814 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:51,141 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:51,152 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:51,486 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:51,503 INFO     [learner.py:606] ====Pushing takes 0.015920400619506836 s
2021-08-18:16:59:51,521 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:51,526 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:16:59:51,526 INFO     [param_server.py:410] Lock worker 1 with localStep 422 , while globalStep is 421

2021-08-18:16:59:51,736 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:51,749 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:53,231 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:53,251 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:54,73 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:54,88 INFO     [learner.py:606] ====Pushing takes 0.012829065322875977 s
2021-08-18:16:59:54,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:54,107 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:16:59:54,108 INFO     [param_server.py:410] Lock worker 2 with localStep 422 , while globalStep is 421

2021-08-18:16:59:54,451 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:54,472 INFO     [learner.py:606] ====Pushing takes 0.019422531127929688 s
2021-08-18:16:59:54,498 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:54,504 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:16:59:54,504 INFO     [param_server.py:381] ====After aggregation in epoch: 421, virtual_clock: 20387.262081312394, top_1: : 66.6344 % (2065.0), top_5: : 100.0 % (3099.0), test loss: 3.9241871922104448, test len: 3099.0
2021-08-18:16:59:54,506 INFO     [param_server.py:410] Lock worker 3 with localStep 422 , while globalStep is 422

2021-08-18:16:59:54,507 INFO     [param_server.py:441] ====Epoch 423 completes 13 clients with loss 5.493027998846961, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:54,507 INFO     [param_server.py:450] ====Start to sample for epoch 423, global virtualClock: 20387.262081312394, round_duration: 80.35344175505469
2021-08-18:16:59:54,508 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:16:59:54,782 INFO     [param_server.py:553] For epoch: 423, median_reward: 344.1786649596622, dev: 344.1786649596622
2021-08-18:16:59:55,419 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2814, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:59:55,423 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5458.9234, eval_time 0.606, test_loss 3.2814, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:59:55,465 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6179, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:59:55,466 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5458.9665, eval_time 0.6445, test_loss 3.6179, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:59:55,500 INFO     [learner.py:526] ====Start train round 423
2021-08-18:16:59:55,501 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6388, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:59:55,502 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5459.0005, eval_time 0.6865, test_loss 3.6388, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:59:55,508 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:55,536 INFO     [learner.py:526] ====Start train round 423
2021-08-18:16:59:55,552 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:55,572 INFO     [learner.py:526] ====Start train round 423
2021-08-18:16:59:55,593 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:56,807 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:56,821 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:57,579 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:57,598 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:57,784 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:57,824 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:59,880 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:59,899 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:00,313 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:00,323 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:00,395 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:00,415 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:01,216 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:01,237 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:01,241 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:01,262 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:01,861 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:01,879 INFO     [learner.py:606] ====Pushing takes 0.01679849624633789 s
2021-08-18:17:00:01,901 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:01,909 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:00:01,909 INFO     [param_server.py:410] Lock worker 1 with localStep 423 , while globalStep is 422

2021-08-18:17:00:02,75 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:02,88 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:03,232 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:03,252 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:04,388 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:04,405 INFO     [learner.py:606] ====Pushing takes 0.014978647232055664 s
2021-08-18:17:00:04,424 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:04,428 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:04,429 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:00:04,430 INFO     [param_server.py:410] Lock worker 2 with localStep 423 , while globalStep is 422

2021-08-18:17:00:04,451 INFO     [learner.py:606] ====Pushing takes 0.021215200424194336 s
2021-08-18:17:00:04,476 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:04,482 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:00:04,482 INFO     [param_server.py:381] ====After aggregation in epoch: 422, virtual_clock: 20467.61552306745, top_1: : 63.0849 % (1955.0), top_5: : 100.0 % (3099.0), test loss: 3.5126729806264243, test len: 3099.0
2021-08-18:17:00:04,487 INFO     [param_server.py:410] Lock worker 3 with localStep 423 , while globalStep is 423

2021-08-18:17:00:04,488 INFO     [param_server.py:441] ====Epoch 424 completes 13 clients with loss 5.000805126622674, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:04,488 INFO     [param_server.py:450] ====Start to sample for epoch 424, global virtualClock: 20467.61552306745, round_duration: 80.35344175505469
2021-08-18:17:00:04,489 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:04,790 INFO     [param_server.py:553] For epoch: 424, median_reward: 336.07220114941816, dev: 336.07220114941816
2021-08-18:17:00:05,392 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1635, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:00:05,393 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5468.893, eval_time 0.559, test_loss 4.1635, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:00:05,462 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:05,476 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:05,482 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0043, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:00:05,483 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5468.983, eval_time 0.6489, test_loss 4.0043, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:00:05,511 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4942, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:17:00:05,512 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5469.0106, eval_time 0.6784, test_loss 3.4942, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:17:00:05,553 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:05,571 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:05,583 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:05,606 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:06,729 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:06,739 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:07,649 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:07,676 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:07,689 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:07,699 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:09,823 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:09,837 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:10,435 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:10,448 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:10,483 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:10,510 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:11,88 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:11,108 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:11,302 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:11,409 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:11,973 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:11,988 INFO     [learner.py:606] ====Pushing takes 0.014552116394042969 s
2021-08-18:17:00:12,10 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:12,15 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:00:12,16 INFO     [param_server.py:410] Lock worker 1 with localStep 424 , while globalStep is 423

2021-08-18:17:00:12,25 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:12,37 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:13,120 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:13,133 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:14,267 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:14,290 INFO     [learner.py:606] ====Pushing takes 0.021423816680908203 s
2021-08-18:17:00:14,316 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:14,322 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:14,328 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:00:14,328 INFO     [param_server.py:410] Lock worker 3 with localStep 424 , while globalStep is 423

2021-08-18:17:00:14,333 INFO     [learner.py:606] ====Pushing takes 0.015902042388916016 s
2021-08-18:17:00:14,349 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:14,353 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:00:14,354 INFO     [param_server.py:381] ====After aggregation in epoch: 423, virtual_clock: 20547.968964822503, top_1: : 66.7957 % (2070.0), top_5: : 100.0 % (3099.0), test loss: 3.8873416229530613, test len: 3099.0
2021-08-18:17:00:14,357 INFO     [param_server.py:410] Lock worker 2 with localStep 424 , while globalStep is 424

2021-08-18:17:00:14,357 INFO     [param_server.py:441] ====Epoch 425 completes 13 clients with loss 4.877039305922309, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:14,357 INFO     [param_server.py:450] ====Start to sample for epoch 425, global virtualClock: 20547.968964822503, round_duration: 80.35344175505469
2021-08-18:17:00:14,358 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:14,650 INFO     [param_server.py:553] For epoch: 425, median_reward: 333.87010757306183, dev: 333.87010757306183
2021-08-18:17:00:15,396 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5707, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:00:15,397 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5478.8973, eval_time 0.7092, test_loss 3.5707, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:00:15,398 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6656, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:17:00:15,398 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5478.8986, eval_time 0.7106, test_loss 3.6656, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:17:00:15,409 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5621, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:00:15,410 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5478.9085, eval_time 0.725, test_loss 3.5621, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:00:15,471 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:15,471 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:15,479 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:15,480 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:15,483 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:15,495 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:16,698 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:16,707 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:17,689 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:17,729 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:17,764 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:17,779 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:19,685 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:19,714 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:20,392 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:20,408 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:20,420 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:20,426 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:21,257 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:21,271 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:21,318 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:21,372 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:21,989 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:22,6 INFO     [learner.py:606] ====Pushing takes 0.015787363052368164 s
2021-08-18:17:00:22,27 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:22,34 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:00:22,34 INFO     [param_server.py:410] Lock worker 1 with localStep 425 , while globalStep is 424

2021-08-18:17:00:22,201 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:22,211 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:23,267 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:23,281 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:24,408 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:24,431 INFO     [learner.py:606] ====Pushing takes 0.02159905433654785 s
2021-08-18:17:00:24,438 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:24,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:24,457 INFO     [learner.py:606] ====Pushing takes 0.017140626907348633 s
2021-08-18:17:00:24,461 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:00:24,462 INFO     [param_server.py:410] Lock worker 3 with localStep 425 , while globalStep is 424

2021-08-18:17:00:24,473 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:24,478 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:00:24,479 INFO     [param_server.py:381] ====After aggregation in epoch: 424, virtual_clock: 20628.322406577558, top_1: : 63.2462 % (1960.0), top_5: : 100.0 % (3099.0), test loss: 3.599496006965637, test len: 3099.0
2021-08-18:17:00:24,482 INFO     [param_server.py:410] Lock worker 2 with localStep 425 , while globalStep is 425

2021-08-18:17:00:24,482 INFO     [param_server.py:441] ====Epoch 426 completes 13 clients with loss 4.0686259870181285, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:24,483 INFO     [param_server.py:450] ====Start to sample for epoch 426, global virtualClock: 20628.322406577558, round_duration: 80.35344175505469
2021-08-18:17:00:24,483 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:24,752 INFO     [param_server.py:553] For epoch: 426, median_reward: 326.08776046142975, dev: 326.08776046142975
2021-08-18:17:00:25,406 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6189, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:00:25,407 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5488.9075, eval_time 0.6191, test_loss 3.6189, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:00:25,459 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1824, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:00:25,460 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5488.9606, eval_time 0.6707, test_loss 3.1824, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:00:25,497 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:00:25,506 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:25,529 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1553, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:00:25,530 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5489.029, eval_time 0.7442, test_loss 3.1553, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:00:25,532 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:00:25,546 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:25,602 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:00:25,627 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:26,699 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:26,709 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:27,721 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:27,732 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:27,780 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:27,820 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:29,718 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:29,738 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:30,391 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:30,405 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:30,638 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:30,659 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:31,59 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:31,77 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:31,387 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:31,422 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:31,920 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:31,932 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:32,60 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:32,78 INFO     [learner.py:606] ====Pushing takes 0.01676464080810547 s
2021-08-18:17:00:32,99 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:32,104 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:00:32,104 INFO     [param_server.py:410] Lock worker 1 with localStep 426 , while globalStep is 425

2021-08-18:17:00:32,926 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:32,937 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:34,12 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:34,35 INFO     [learner.py:606] ====Pushing takes 0.021669864654541016 s
2021-08-18:17:00:34,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:34,66 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:00:34,128 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:34,146 INFO     [learner.py:606] ====Pushing takes 0.016088247299194336 s
2021-08-18:17:00:34,67 INFO     [param_server.py:410] Lock worker 3 with localStep 426 , while globalStep is 425

2021-08-18:17:00:34,391 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:34,397 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:00:34,397 INFO     [param_server.py:381] ====After aggregation in epoch: 425, virtual_clock: 20708.675848332612, top_1: : 64.7628 % (2007.0), top_5: : 100.0 % (3099.0), test loss: 3.318863307988202, test len: 3099.0
2021-08-18:17:00:34,400 INFO     [param_server.py:410] Lock worker 2 with localStep 426 , while globalStep is 426

2021-08-18:17:00:34,400 INFO     [param_server.py:441] ====Epoch 427 completes 13 clients with loss 3.2529804814663086, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:34,400 INFO     [param_server.py:450] ====Start to sample for epoch 427, global virtualClock: 20708.675848332612, round_duration: 80.35344175505469
2021-08-18:17:00:34,401 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:34,678 INFO     [param_server.py:553] For epoch: 427, median_reward: 338.9575806056421, dev: 338.9575806056421
2021-08-18:17:00:35,366 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8297, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:00:35,367 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5498.8677, eval_time 0.6448, test_loss 3.8297, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:00:35,452 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3931, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:00:35,453 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5498.9535, eval_time 0.724, test_loss 3.3931, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:00:35,467 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:00:35,475 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:35,498 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5628, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:00:35,499 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5498.9979, eval_time 0.7776, test_loss 3.5628, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:00:35,521 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:00:35,543 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:35,569 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:00:35,590 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:37,16 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:37,37 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:37,562 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:37,573 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:37,873 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:37,907 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:39,961 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:39,998 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:40,321 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:40,330 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:40,397 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:40,424 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:41,269 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:41,296 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:41,382 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:41,400 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:41,813 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:41,830 INFO     [learner.py:606] ====Pushing takes 0.01531076431274414 s
2021-08-18:17:00:41,849 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:41,855 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:00:41,856 INFO     [param_server.py:410] Lock worker 1 with localStep 427 , while globalStep is 426

2021-08-18:17:00:42,119 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:42,128 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:43,595 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:43,622 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:44,468 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:44,485 INFO     [learner.py:606] ====Pushing takes 0.015151739120483398 s
2021-08-18:17:00:44,500 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:44,505 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:00:44,506 INFO     [param_server.py:410] Lock worker 2 with localStep 427 , while globalStep is 426

2021-08-18:17:00:44,862 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:44,884 INFO     [learner.py:606] ====Pushing takes 0.020874977111816406 s
2021-08-18:17:00:44,907 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:44,912 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:00:44,913 INFO     [param_server.py:381] ====After aggregation in epoch: 426, virtual_clock: 20789.029290087667, top_1: : 64.6338 % (2003.0), top_5: : 100.0 % (3099.0), test loss: 3.5952126891524703, test len: 3099.0
2021-08-18:17:00:44,915 INFO     [param_server.py:410] Lock worker 3 with localStep 427 , while globalStep is 427

2021-08-18:17:00:44,915 INFO     [param_server.py:441] ====Epoch 428 completes 13 clients with loss 8.745879426958266, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:44,916 INFO     [param_server.py:450] ====Start to sample for epoch 428, global virtualClock: 20789.029290087667, round_duration: 80.35344175505469
2021-08-18:17:00:44,916 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:45,189 INFO     [param_server.py:553] For epoch: 428, median_reward: 368.8651022452255, dev: 368.8651022452255
2021-08-18:17:00:45,857 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2595, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:00:45,858 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5509.3584, eval_time 0.6443, test_loss 3.2595, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:00:45,864 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1655, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:00:45,865 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5509.3653, eval_time 0.6505, test_loss 3.1655, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:00:45,937 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1945, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:17:00:45,938 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5509.4364, eval_time 0.7259, test_loss 3.1945, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:17:00:45,943 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:00:45,951 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:45,956 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:00:45,966 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:46,6 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:00:46,28 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:47,26 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:47,40 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:48,0 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:48,13 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:48,295 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:48,335 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:50,415 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:50,442 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:50,537 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:50,556 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:51,276 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:51,296 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:51,901 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:51,914 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:52,12 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:52,33 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:52,228 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:52,239 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:52,674 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:52,689 INFO     [learner.py:606] ====Pushing takes 0.013245820999145508 s
2021-08-18:17:00:52,707 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:52,711 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:00:52,712 INFO     [param_server.py:410] Lock worker 1 with localStep 428 , while globalStep is 427

2021-08-18:17:00:53,679 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:53,688 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:54,561 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:54,576 INFO     [learner.py:606] ====Pushing takes 0.01277303695678711 s
2021-08-18:17:00:54,590 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:54,595 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:00:54,596 INFO     [param_server.py:410] Lock worker 2 with localStep 428 , while globalStep is 427

2021-08-18:17:00:54,723 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:54,745 INFO     [learner.py:606] ====Pushing takes 0.019900083541870117 s
2021-08-18:17:00:54,768 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:54,774 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:00:54,775 INFO     [param_server.py:381] ====After aggregation in epoch: 427, virtual_clock: 20869.38273184272, top_1: : 64.4079 % (1996.0), top_5: : 100.0 % (3099.0), test loss: 3.2065056562423706, test len: 3099.0
2021-08-18:17:00:54,777 INFO     [param_server.py:410] Lock worker 3 with localStep 428 , while globalStep is 428

2021-08-18:17:00:54,778 INFO     [param_server.py:441] ====Epoch 429 completes 13 clients with loss 4.702733789995122, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:54,778 INFO     [param_server.py:450] ====Start to sample for epoch 429, global virtualClock: 20869.38273184272, round_duration: 80.35344175505469
2021-08-18:17:00:54,779 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:00:55,43 INFO     [param_server.py:553] For epoch: 429, median_reward: 353.1814368926571, dev: 353.1814368926571
2021-08-18:17:00:55,671 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3386, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:00:55,672 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5519.1722, eval_time 0.5817, test_loss 3.3386, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:00:55,719 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5012, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:00:55,720 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5519.2205, eval_time 0.6272, test_loss 3.5012, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:00:55,758 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:00:55,767 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:55,798 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:00:55,800 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3597, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:00:55,801 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5519.3001, eval_time 0.7135, test_loss 3.3597, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:00:55,811 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:55,870 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:00:55,901 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:57,173 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:57,188 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:57,923 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:57,934 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:58,259 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:58,293 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:00,209 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:00,227 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:00,563 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:00,573 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:01,21 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:01,49 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:01,744 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:01,758 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:01,918 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:01,944 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:02,181 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:02,197 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:02,518 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:02,535 INFO     [learner.py:606] ====Pushing takes 0.01528310775756836 s
2021-08-18:17:01:02,551 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:02,557 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:02,558 INFO     [param_server.py:410] Lock worker 1 with localStep 429 , while globalStep is 428

2021-08-18:17:01:03,521 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:03,536 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:04,380 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:04,394 INFO     [learner.py:606] ====Pushing takes 0.012773513793945312 s
2021-08-18:17:01:04,410 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:04,414 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:04,415 INFO     [param_server.py:410] Lock worker 2 with localStep 429 , while globalStep is 428

2021-08-18:17:01:04,712 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:04,732 INFO     [learner.py:606] ====Pushing takes 0.01875758171081543 s
2021-08-18:17:01:04,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:04,760 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:04,761 INFO     [param_server.py:381] ====After aggregation in epoch: 428, virtual_clock: 20949.736173597776, top_1: : 66.8603 % (2072.0), top_5: : 100.0 % (3099.0), test loss: 3.3998478783501516, test len: 3099.0
2021-08-18:17:01:04,763 INFO     [param_server.py:410] Lock worker 3 with localStep 429 , while globalStep is 429

2021-08-18:17:01:04,764 INFO     [param_server.py:441] ====Epoch 430 completes 13 clients with loss 5.093868779216011, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:04,764 INFO     [param_server.py:450] ====Start to sample for epoch 430, global virtualClock: 20949.736173597776, round_duration: 80.35344175505469
2021-08-18:17:01:04,765 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:05,33 INFO     [param_server.py:553] For epoch: 430, median_reward: 340.92539145910195, dev: 340.92539145910195
2021-08-18:17:01:05,754 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4543, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:01:05,755 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5529.2555, eval_time 0.6877, test_loss 3.4543, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:01:05,800 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0888, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:17:01:05,801 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5529.3012, eval_time 0.7322, test_loss 3.0888, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:17:01:05,826 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:05,834 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:05,872 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:05,872 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3597, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:01:05,875 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5529.3732, eval_time 0.808, test_loss 3.3597, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:01:05,887 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:05,944 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:05,979 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:07,218 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:07,239 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:08,53 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:08,65 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:08,544 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:08,564 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:10,208 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:10,222 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:10,658 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:10,677 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:11,10 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:11,30 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:11,583 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:11,593 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:12,117 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:12,144 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:12,400 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:12,410 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:12,786 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:12,808 INFO     [learner.py:606] ====Pushing takes 0.021042346954345703 s
2021-08-18:17:01:12,829 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:12,834 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:12,835 INFO     [param_server.py:410] Lock worker 1 with localStep 430 , while globalStep is 429

2021-08-18:17:01:13,558 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:13,577 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:14,690 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:14,706 INFO     [learner.py:606] ====Pushing takes 0.013998746871948242 s
2021-08-18:17:01:14,721 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:14,726 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:14,726 INFO     [param_server.py:410] Lock worker 2 with localStep 430 , while globalStep is 429

2021-08-18:17:01:14,728 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:14,751 INFO     [learner.py:606] ====Pushing takes 0.021188735961914062 s
2021-08-18:17:01:14,773 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:14,779 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:14,779 INFO     [param_server.py:381] ====After aggregation in epoch: 429, virtual_clock: 21030.08961535283, top_1: : 64.7628 % (2007.0), top_5: : 100.0 % (3099.0), test loss: 3.300926053965533, test len: 3099.0
2021-08-18:17:01:14,781 INFO     [param_server.py:410] Lock worker 3 with localStep 430 , while globalStep is 430

2021-08-18:17:01:14,782 INFO     [param_server.py:441] ====Epoch 431 completes 13 clients with loss 5.66197625334651, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:14,782 INFO     [param_server.py:450] ====Start to sample for epoch 431, global virtualClock: 21030.08961535283, round_duration: 80.35344175505469
2021-08-18:17:01:14,783 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:15,51 INFO     [param_server.py:553] For epoch: 431, median_reward: 355.5513061784246, dev: 355.5513061784246
2021-08-18:17:01:15,805 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3443, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:01:15,805 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5539.3057, eval_time 0.7204, test_loss 3.3443, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:01:15,850 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1788, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:01:15,851 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5539.3515, eval_time 0.7637, test_loss 3.1788, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:01:15,877 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:01:15,884 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:15,895 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7013, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:01:15,896 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5539.3944, eval_time 0.8109, test_loss 3.7013, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:01:15,923 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:01:15,939 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:15,968 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:01:15,991 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:17,238 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:17,265 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:17,996 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:18,10 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:18,399 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:18,439 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:20,401 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:20,420 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:20,702 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:20,711 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:21,118 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:21,145 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:21,926 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:21,942 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:21,994 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:22,15 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:22,398 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:22,408 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:22,622 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:22,639 INFO     [learner.py:606] ====Pushing takes 0.015298604965209961 s
2021-08-18:17:01:22,659 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:22,667 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:22,667 INFO     [param_server.py:410] Lock worker 1 with localStep 431 , while globalStep is 430

2021-08-18:17:01:23,940 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:23,961 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:24,746 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:24,765 INFO     [learner.py:606] ====Pushing takes 0.01689291000366211 s
2021-08-18:17:01:24,782 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:24,786 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:24,787 INFO     [param_server.py:410] Lock worker 2 with localStep 431 , while globalStep is 430

2021-08-18:17:01:25,93 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:25,116 INFO     [learner.py:606] ====Pushing takes 0.021645784378051758 s
2021-08-18:17:01:25,138 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:25,145 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:25,146 INFO     [param_server.py:381] ====After aggregation in epoch: 430, virtual_clock: 21110.443057107885, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.4081095084547997, test len: 3099.0
2021-08-18:17:01:25,148 INFO     [param_server.py:410] Lock worker 3 with localStep 431 , while globalStep is 431

2021-08-18:17:01:25,149 INFO     [param_server.py:441] ====Epoch 432 completes 13 clients with loss 4.5359102294951965, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:25,149 INFO     [param_server.py:450] ====Start to sample for epoch 432, global virtualClock: 21110.443057107885, round_duration: 80.35344175505469
2021-08-18:17:01:25,150 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:25,419 INFO     [param_server.py:553] For epoch: 432, median_reward: 333.918135426265, dev: 333.918135426265
2021-08-18:17:01:26,71 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.9375, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:01:26,72 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5549.5722, eval_time 0.6034, test_loss 4.9375, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:01:26,74 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5744, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:01:26,75 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5549.5752, eval_time 0.6065, test_loss 3.5744, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:01:26,142 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:01:26,151 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:26,155 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:01:26,159 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3269, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:17:01:26,161 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5549.6601, eval_time 0.694, test_loss 3.3269, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:17:01:26,163 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:26,233 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:01:26,259 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:27,404 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:27,418 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:28,347 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:28,374 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:28,420 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:28,456 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:30,266 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:30,286 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:31,98 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:31,109 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:31,251 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:31,284 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:31,825 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:31,845 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:32,88 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:32,116 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:32,669 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:32,684 INFO     [learner.py:606] ====Pushing takes 0.013453245162963867 s
2021-08-18:17:01:32,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:32,705 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:32,706 INFO     [param_server.py:410] Lock worker 1 with localStep 432 , while globalStep is 431

2021-08-18:17:01:32,788 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:32,799 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:33,713 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:33,727 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:34,878 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:34,901 INFO     [learner.py:606] ====Pushing takes 0.021401166915893555 s
2021-08-18:17:01:34,929 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:34,935 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:34,936 INFO     [param_server.py:410] Lock worker 3 with localStep 432 , while globalStep is 431

2021-08-18:17:01:35,92 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:35,107 INFO     [learner.py:606] ====Pushing takes 0.01341104507446289 s
2021-08-18:17:01:35,122 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:35,127 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:35,127 INFO     [param_server.py:381] ====After aggregation in epoch: 431, virtual_clock: 21190.79649886294, top_1: : 65.2469 % (2022.0), top_5: : 100.0 % (3099.0), test loss: 3.946247303927386, test len: 3099.0
2021-08-18:17:01:35,130 INFO     [param_server.py:410] Lock worker 2 with localStep 432 , while globalStep is 432

2021-08-18:17:01:35,131 INFO     [param_server.py:441] ====Epoch 433 completes 13 clients with loss 3.2271113112313534, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:35,132 INFO     [param_server.py:450] ====Start to sample for epoch 433, global virtualClock: 21190.79649886294, round_duration: 80.35344175505469
2021-08-18:17:01:35,132 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:35,402 INFO     [param_server.py:553] For epoch: 433, median_reward: 358.7285474503205, dev: 358.7285474503205
2021-08-18:17:01:36,42 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3447, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:01:36,43 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5559.5432, eval_time 0.596, test_loss 3.3447, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:01:36,93 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1758, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:01:36,94 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5559.5944, eval_time 0.6449, test_loss 3.1758, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:01:36,113 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:01:36,121 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:36,167 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:01:36,171 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4523, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:01:36,172 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5559.671, eval_time 0.7255, test_loss 3.4523, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:01:36,177 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:36,245 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:01:36,286 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:37,542 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:37,562 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:38,402 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:38,411 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:38,796 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:38,830 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:40,570 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:40,589 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:41,182 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:41,191 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:41,528 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:41,549 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:41,910 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:41,921 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:42,519 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:42,546 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:42,755 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:42,767 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:43,197 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:43,219 INFO     [learner.py:606] ====Pushing takes 0.015547513961791992 s
2021-08-18:17:01:43,241 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:43,247 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:43,248 INFO     [param_server.py:410] Lock worker 1 with localStep 433 , while globalStep is 432

2021-08-18:17:01:43,964 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:43,982 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:45,156 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:45,175 INFO     [learner.py:606] ====Pushing takes 0.01566767692565918 s
2021-08-18:17:01:45,199 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:45,203 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:45,204 INFO     [param_server.py:410] Lock worker 2 with localStep 433 , while globalStep is 432

2021-08-18:17:01:45,256 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:45,280 INFO     [learner.py:606] ====Pushing takes 0.023154497146606445 s
2021-08-18:17:01:45,310 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:45,315 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:45,316 INFO     [param_server.py:381] ====After aggregation in epoch: 432, virtual_clock: 21271.149940617994, top_1: : 66.1826 % (2051.0), top_5: : 100.0 % (3099.0), test loss: 3.3242381237171315, test len: 3099.0
2021-08-18:17:01:45,318 INFO     [param_server.py:410] Lock worker 3 with localStep 433 , while globalStep is 433

2021-08-18:17:01:45,319 INFO     [param_server.py:441] ====Epoch 434 completes 13 clients with loss 5.803530099148773, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:45,319 INFO     [param_server.py:450] ====Start to sample for epoch 434, global virtualClock: 21271.149940617994, round_duration: 80.35344175505469
2021-08-18:17:01:45,320 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:45,592 INFO     [param_server.py:553] For epoch: 434, median_reward: 339.67995243730564, dev: 339.67995243730564
2021-08-18:17:01:46,235 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5309, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:17:01:46,236 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5569.7366, eval_time 0.5985, test_loss 3.5309, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:17:01:46,306 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:01:46,316 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:46,322 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2176, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:17:01:46,323 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5569.8234, eval_time 0.6852, test_loss 3.2176, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:17:01:46,362 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2636, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:17:01:46,363 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5569.862, eval_time 0.7257, test_loss 4.2636, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:17:01:46,391 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:01:46,410 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:46,430 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:01:46,462 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:47,755 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:47,764 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:48,678 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:48,687 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:48,820 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:48,853 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:50,716 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:50,729 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:51,372 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:51,381 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:51,748 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:51,776 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:52,323 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:52,341 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:52,676 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:52,703 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:53,109 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:53,120 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:53,276 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:53,292 INFO     [learner.py:606] ====Pushing takes 0.014276266098022461 s
2021-08-18:17:01:53,313 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:53,318 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:53,319 INFO     [param_server.py:410] Lock worker 1 with localStep 434 , while globalStep is 433

2021-08-18:17:01:54,361 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:54,374 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:55,502 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:55,516 INFO     [learner.py:606] ====Pushing takes 0.013170003890991211 s
2021-08-18:17:01:55,518 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:55,537 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:55,540 INFO     [learner.py:606] ====Pushing takes 0.020709991455078125 s
2021-08-18:17:01:55,542 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:55,543 INFO     [param_server.py:410] Lock worker 2 with localStep 434 , while globalStep is 433

2021-08-18:17:01:55,564 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:55,569 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:55,570 INFO     [param_server.py:381] ====After aggregation in epoch: 433, virtual_clock: 21351.50338237305, top_1: : 66.1181 % (2049.0), top_5: : 100.0 % (3099.0), test loss: 3.6707080735100646, test len: 3099.0
2021-08-18:17:01:55,572 INFO     [param_server.py:410] Lock worker 3 with localStep 434 , while globalStep is 434

2021-08-18:17:01:55,573 INFO     [param_server.py:441] ====Epoch 435 completes 13 clients with loss 4.536128604742329, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:55,573 INFO     [param_server.py:450] ====Start to sample for epoch 435, global virtualClock: 21351.50338237305, round_duration: 80.35344175505469
2021-08-18:17:01:55,574 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:55,875 INFO     [param_server.py:553] For epoch: 435, median_reward: 336.63371373769655, dev: 336.63371373769655
2021-08-18:17:01:56,577 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8124, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:17:01:56,578 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5580.078, eval_time 0.6678, test_loss 3.8124, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:17:01:56,601 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5878, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:01:56,602 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5580.1022, eval_time 0.6921, test_loss 3.5878, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:01:56,644 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:01:56,655 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:56,682 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1698, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:01:56,683 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5580.1812, eval_time 0.7735, test_loss 4.1698, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:01:56,700 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:01:56,716 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:56,751 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:01:56,777 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:57,898 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:57,907 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:58,867 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:58,877 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:59,194 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:59,234 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:00,916 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:00,936 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:01,619 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:01,629 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:01,695 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:01,716 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:02,330 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:02,344 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:02,477 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:02,505 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:03,85 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:03,102 INFO     [learner.py:606] ====Pushing takes 0.015476703643798828 s
2021-08-18:17:02:03,124 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:03,131 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:03,131 INFO     [param_server.py:410] Lock worker 1 with localStep 435 , while globalStep is 434

2021-08-18:17:02:03,282 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:03,300 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:04,200 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:04,214 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:05,327 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:05,350 INFO     [learner.py:606] ====Pushing takes 0.021771907806396484 s
2021-08-18:17:02:05,380 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:05,386 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:05,387 INFO     [param_server.py:410] Lock worker 3 with localStep 435 , while globalStep is 434

2021-08-18:17:02:05,722 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:05,738 INFO     [learner.py:606] ====Pushing takes 0.014244318008422852 s
2021-08-18:17:02:05,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:05,761 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:05,761 INFO     [param_server.py:381] ====After aggregation in epoch: 434, virtual_clock: 21431.856824128103, top_1: : 63.2139 % (1959.0), top_5: : 100.0 % (3099.0), test loss: 3.8566826979319253, test len: 3099.0
2021-08-18:17:02:05,763 INFO     [param_server.py:410] Lock worker 2 with localStep 435 , while globalStep is 435

2021-08-18:17:02:05,764 INFO     [param_server.py:441] ====Epoch 436 completes 13 clients with loss 5.5755408105605735, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:05,764 INFO     [param_server.py:450] ====Start to sample for epoch 436, global virtualClock: 21431.856824128103, round_duration: 80.35344175505469
2021-08-18:17:02:05,765 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:06,53 INFO     [param_server.py:553] For epoch: 436, median_reward: 342.6568548895297, dev: 342.6568548895297
2021-08-18:17:02:06,709 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3651, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:02:06,710 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5590.2104, eval_time 0.6077, test_loss 3.3651, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:02:06,756 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1482, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:02:06,757 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5590.2573, eval_time 0.6501, test_loss 3.1482, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:02:06,777 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:06,785 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:06,838 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2268, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:17:02:06,839 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5590.3372, eval_time 0.7401, test_loss 3.2268, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:17:02:06,840 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:06,852 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:06,908 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:06,930 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:08,116 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:08,134 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:08,999 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:09,9 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:09,177 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:09,217 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:10,989 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:11,4 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:11,856 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:11,868 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:11,925 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:11,952 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:12,542 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:12,563 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:12,849 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:12,883 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:13,464 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:13,479 INFO     [learner.py:606] ====Pushing takes 0.013796567916870117 s
2021-08-18:17:02:13,500 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:13,505 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:13,505 INFO     [param_server.py:410] Lock worker 1 with localStep 436 , while globalStep is 435

2021-08-18:17:02:13,558 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:13,569 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:14,418 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:14,438 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:15,653 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:15,675 INFO     [learner.py:606] ====Pushing takes 0.020987510681152344 s
2021-08-18:17:02:15,704 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:15,709 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:15,710 INFO     [param_server.py:410] Lock worker 3 with localStep 436 , while globalStep is 435

2021-08-18:17:02:15,898 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:15,912 INFO     [learner.py:606] ====Pushing takes 0.012940645217895508 s
2021-08-18:17:02:15,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:15,932 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:15,932 INFO     [param_server.py:381] ====After aggregation in epoch: 435, virtual_clock: 21512.210265883157, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.24670100653613, test len: 3099.0
2021-08-18:17:02:15,934 INFO     [param_server.py:410] Lock worker 2 with localStep 436 , while globalStep is 436

2021-08-18:17:02:15,935 INFO     [param_server.py:441] ====Epoch 437 completes 13 clients with loss 5.788585551635544, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:15,935 INFO     [param_server.py:450] ====Start to sample for epoch 437, global virtualClock: 21512.210265883157, round_duration: 80.35344175505469
2021-08-18:17:02:15,936 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:16,210 INFO     [param_server.py:553] For epoch: 437, median_reward: 340.92711061422386, dev: 340.92711061422386
2021-08-18:17:02:16,963 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.694, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:02:16,964 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5600.4643, eval_time 0.7064, test_loss 3.694, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:02:16,969 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2991, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:02:17,3 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5600.504, eval_time 0.7452, test_loss 3.2991, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:02:17,35 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:02:17,45 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:17,53 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6211, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:02:17,53 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5600.5519, eval_time 0.7985, test_loss 3.6211, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:02:17,86 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:02:17,94 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:17,144 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:02:17,173 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:18,190 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:18,213 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:19,245 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:19,263 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:19,566 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:19,606 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:21,328 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:21,350 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:22,79 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:22,89 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:22,428 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:22,455 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:22,832 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:22,841 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:23,292 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:23,313 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:23,799 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:23,811 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:23,925 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:23,942 INFO     [learner.py:606] ====Pushing takes 0.015816450119018555 s
2021-08-18:17:02:23,963 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:23,971 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:23,972 INFO     [param_server.py:410] Lock worker 1 with localStep 437 , while globalStep is 436

2021-08-18:17:02:24,559 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:24,573 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:25,753 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:25,776 INFO     [learner.py:606] ====Pushing takes 0.021442174911499023 s
2021-08-18:17:02:25,799 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:25,805 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:25,806 INFO     [param_server.py:410] Lock worker 3 with localStep 437 , while globalStep is 436

2021-08-18:17:02:26,159 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:26,177 INFO     [learner.py:606] ====Pushing takes 0.016262054443359375 s
2021-08-18:17:02:26,192 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:26,196 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:26,197 INFO     [param_server.py:381] ====After aggregation in epoch: 436, virtual_clock: 21592.56370763821, top_1: : 64.8919 % (2011.0), top_5: : 100.0 % (3099.0), test loss: 3.538061058079755, test len: 3099.0
2021-08-18:17:02:26,199 INFO     [param_server.py:410] Lock worker 2 with localStep 437 , while globalStep is 437

2021-08-18:17:02:26,200 INFO     [param_server.py:441] ====Epoch 438 completes 13 clients with loss 2.323846374492578, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:26,200 INFO     [param_server.py:450] ====Start to sample for epoch 438, global virtualClock: 21592.56370763821, round_duration: 80.35344175505469
2021-08-18:17:02:26,201 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:26,477 INFO     [param_server.py:553] For epoch: 438, median_reward: 335.8478559629114, dev: 335.8478559629114
2021-08-18:17:02:27,80 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5611, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:17:02:27,80 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5610.5808, eval_time 0.559, test_loss 3.5611, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:17:02:27,146 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:02:27,153 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:27,200 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6319, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:02:27,201 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5610.6997, eval_time 0.6797, test_loss 3.6319, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:02:27,235 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6949, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:17:02:27,235 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5610.736, eval_time 0.714, test_loss 3.6949, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:17:02:27,280 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:02:27,305 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:02:27,312 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:27,323 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:28,574 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:28,589 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:29,352 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:29,362 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:29,643 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:29,676 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:31,511 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:31,522 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:31,964 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:31,975 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:32,341 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:32,368 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:32,819 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:32,834 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:33,223 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:33,250 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:33,689 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:33,700 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:33,903 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:33,918 INFO     [learner.py:606] ====Pushing takes 0.013458013534545898 s
2021-08-18:17:02:33,940 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:33,945 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:33,946 INFO     [param_server.py:410] Lock worker 1 with localStep 438 , while globalStep is 437

2021-08-18:17:02:34,808 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:34,826 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:36,118 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:36,140 INFO     [learner.py:606] ====Pushing takes 0.020955801010131836 s
2021-08-18:17:02:36,142 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:36,164 INFO     [learner.py:606] ====Pushing takes 0.020224809646606445 s
2021-08-18:17:02:36,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:36,171 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:36,172 INFO     [param_server.py:410] Lock worker 3 with localStep 438 , while globalStep is 437

2021-08-18:17:02:36,184 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:36,190 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:36,190 INFO     [param_server.py:381] ====After aggregation in epoch: 437, virtual_clock: 21672.917149393266, top_1: : 62.7944 % (1946.0), top_5: : 100.0 % (3099.0), test loss: 3.629319583928144, test len: 3099.0
2021-08-18:17:02:36,193 INFO     [param_server.py:410] Lock worker 2 with localStep 438 , while globalStep is 438

2021-08-18:17:02:36,193 INFO     [param_server.py:441] ====Epoch 439 completes 13 clients with loss 3.1971829626368664, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:36,194 INFO     [param_server.py:450] ====Start to sample for epoch 439, global virtualClock: 21672.917149393266, round_duration: 80.35344175505469
2021-08-18:17:02:36,194 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:36,463 INFO     [param_server.py:553] For epoch: 439, median_reward: 335.9092037559478, dev: 335.9092037559478
2021-08-18:17:02:37,88 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6285, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:02:37,89 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5620.5897, eval_time 0.5911, test_loss 3.6285, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:02:37,136 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3446, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:02:37,137 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5620.6379, eval_time 0.6392, test_loss 3.3446, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:02:37,159 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:02:37,174 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7295, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:02:37,174 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5620.6729, eval_time 0.6775, test_loss 3.7295, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:02:37,176 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:37,205 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:02:37,219 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:37,245 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:02:37,280 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:38,348 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:38,357 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:39,441 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:39,455 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:39,534 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:39,574 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:41,509 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:41,523 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:42,168 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:42,186 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:42,502 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:42,522 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:42,899 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:42,912 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:43,251 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:43,272 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:43,709 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:43,720 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:43,893 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:43,911 INFO     [learner.py:606] ====Pushing takes 0.016434669494628906 s
2021-08-18:17:02:43,932 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:43,939 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:43,940 INFO     [param_server.py:410] Lock worker 1 with localStep 439 , while globalStep is 438

2021-08-18:17:02:44,637 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:44,646 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:45,708 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:45,730 INFO     [learner.py:606] ====Pushing takes 0.021050214767456055 s
2021-08-18:17:02:45,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:45,761 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:45,761 INFO     [param_server.py:410] Lock worker 3 with localStep 439 , while globalStep is 438

2021-08-18:17:02:45,906 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:45,924 INFO     [learner.py:606] ====Pushing takes 0.015996932983398438 s
2021-08-18:17:02:45,938 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:45,943 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:45,944 INFO     [param_server.py:381] ====After aggregation in epoch: 438, virtual_clock: 21753.27059114832, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.567557855888649, test len: 3099.0
2021-08-18:17:02:45,946 INFO     [param_server.py:410] Lock worker 2 with localStep 439 , while globalStep is 439

2021-08-18:17:02:45,946 INFO     [param_server.py:441] ====Epoch 440 completes 13 clients with loss 5.145927953628815, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:45,948 INFO     [param_server.py:450] ====Start to sample for epoch 440, global virtualClock: 21753.27059114832, round_duration: 80.35344175505469
2021-08-18:17:02:45,949 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:46,219 INFO     [param_server.py:553] For epoch: 440, median_reward: 335.7380997837008, dev: 335.7380997837008
2021-08-18:17:02:46,865 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1916, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:17:02:46,880 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5630.3799, eval_time 0.6054, test_loss 4.1916, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:17:02:46,951 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:02:46,955 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6728, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:02:46,956 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5630.4565, eval_time 0.6771, test_loss 3.6728, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:02:46,959 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:47,19 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9074, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:02:47,19 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5630.518, eval_time 0.7453, test_loss 3.9074, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:02:47,23 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:02:47,44 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:47,89 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:02:47,119 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:48,375 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:48,402 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:49,135 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:49,146 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:49,477 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:49,510 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:51,419 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:51,428 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:51,868 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:51,879 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:52,280 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:52,307 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:52,927 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:52,941 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:53,240 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:53,274 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:53,550 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:53,564 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:53,964 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:53,980 INFO     [learner.py:606] ====Pushing takes 0.013624191284179688 s
2021-08-18:17:02:53,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:54,0 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:54,1 INFO     [param_server.py:410] Lock worker 1 with localStep 440 , while globalStep is 439

2021-08-18:17:02:54,703 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:54,724 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:55,784 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:55,799 INFO     [learner.py:606] ====Pushing takes 0.013204097747802734 s
2021-08-18:17:02:55,815 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:55,820 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:02:55,821 INFO     [param_server.py:410] Lock worker 2 with localStep 440 , while globalStep is 439

2021-08-18:17:02:55,892 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:55,913 INFO     [learner.py:606] ====Pushing takes 0.01957392692565918 s
2021-08-18:17:02:55,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:55,942 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:55,942 INFO     [param_server.py:381] ====After aggregation in epoch: 439, virtual_clock: 21833.624032903375, top_1: : 63.0203 % (1953.0), top_5: : 100.0 % (3099.0), test loss: 3.9239169668268272, test len: 3099.0
2021-08-18:17:02:55,945 INFO     [param_server.py:410] Lock worker 3 with localStep 440 , while globalStep is 440

2021-08-18:17:02:55,946 INFO     [param_server.py:441] ====Epoch 441 completes 13 clients with loss 5.335363762436881, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:55,946 INFO     [param_server.py:450] ====Start to sample for epoch 441, global virtualClock: 21833.624032903375, round_duration: 80.35344175505469
2021-08-18:17:02:55,947 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:56,220 INFO     [param_server.py:541] Handle Wight 0.026004314422607422 | Send 0.2742805480957031
2021-08-18:17:02:56,221 INFO     [param_server.py:553] For epoch: 441, median_reward: 357.15995411479855, dev: 357.15995411479855
2021-08-18:17:02:56,946 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4489, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:02:56,947 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5640.4474, eval_time 0.7018, test_loss 3.4489, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:02:56,950 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0856, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:02:56,951 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5640.4518, eval_time 0.7052, test_loss 3.0856, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:02:56,996 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1526, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:02:56,996 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5640.4951, eval_time 0.7535, test_loss 4.1526, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:02:57,17 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:02:57,22 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:02:57,26 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:57,31 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:57,68 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:02:57,91 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:58,156 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:58,165 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:59,177 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:59,196 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:59,500 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:59,540 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:01,301 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:01,312 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:02,22 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:02,32 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:02,219 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:02,240 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:02,700 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:02,709 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:03,5 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:03,26 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:03,604 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:03,625 INFO     [learner.py:606] ====Pushing takes 0.01720285415649414 s
2021-08-18:17:03:03,644 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:03,651 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:03,652 INFO     [param_server.py:410] Lock worker 1 with localStep 441 , while globalStep is 440

2021-08-18:17:03:03,729 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:03,741 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:04,467 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:04,476 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:05,675 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:05,698 INFO     [learner.py:606] ====Pushing takes 0.02060389518737793 s
2021-08-18:17:03:05,720 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:05,727 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:05,728 INFO     [param_server.py:410] Lock worker 3 with localStep 441 , while globalStep is 440

2021-08-18:17:03:05,972 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:05,988 INFO     [learner.py:606] ====Pushing takes 0.01437830924987793 s
2021-08-18:17:03:06,2 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:06,7 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:06,8 INFO     [param_server.py:381] ====After aggregation in epoch: 440, virtual_clock: 21913.97747465843, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 3.562370211989791, test len: 3099.0
2021-08-18:17:03:06,10 INFO     [param_server.py:410] Lock worker 2 with localStep 441 , while globalStep is 441

2021-08-18:17:03:06,11 INFO     [param_server.py:441] ====Epoch 442 completes 13 clients with loss 3.9162749969461346, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:06,11 INFO     [param_server.py:450] ====Start to sample for epoch 442, global virtualClock: 21913.97747465843, round_duration: 80.35344175505469
2021-08-18:17:03:06,12 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:06,280 INFO     [param_server.py:553] For epoch: 442, median_reward: 363.55281081798887, dev: 363.55281081798887
2021-08-18:17:03:07,16 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1042, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:17:03:07,17 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5650.5175, eval_time 0.6904, test_loss 4.1042, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:17:03:07,47 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7683, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:17:03:07,48 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5650.5486, eval_time 0.72, test_loss 3.7683, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:17:03:07,76 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2283, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:03:07,77 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5650.5754, eval_time 0.7502, test_loss 4.2283, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:03:07,87 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:07,95 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:07,120 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:07,134 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:07,149 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:07,169 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:08,468 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:08,479 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:09,297 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:09,331 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:09,363 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:09,375 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:11,465 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:11,479 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:12,121 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:12,133 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:12,304 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:12,331 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:13,93 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:13,102 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:13,292 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:13,312 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:13,799 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:13,810 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:13,841 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:13,856 INFO     [learner.py:606] ====Pushing takes 0.013644218444824219 s
2021-08-18:17:03:13,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:13,877 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:13,878 INFO     [param_server.py:410] Lock worker 1 with localStep 442 , while globalStep is 441

2021-08-18:17:03:14,854 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:14,864 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:15,954 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:15,976 INFO     [learner.py:606] ====Pushing takes 0.02031254768371582 s
2021-08-18:17:03:16,0 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:16,6 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:16,7 INFO     [param_server.py:410] Lock worker 3 with localStep 442 , while globalStep is 441

2021-08-18:17:03:16,115 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:16,129 INFO     [learner.py:606] ====Pushing takes 0.013004302978515625 s
2021-08-18:17:03:16,143 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:16,148 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:16,148 INFO     [param_server.py:381] ====After aggregation in epoch: 441, virtual_clock: 21994.330916413484, top_1: : 61.6973 % (1912.0), top_5: : 100.0 % (3099.0), test loss: 4.033606379120439, test len: 3099.0
2021-08-18:17:03:16,151 INFO     [param_server.py:410] Lock worker 2 with localStep 442 , while globalStep is 442

2021-08-18:17:03:16,151 INFO     [param_server.py:441] ====Epoch 443 completes 13 clients with loss 5.1744139414722525, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:16,152 INFO     [param_server.py:450] ====Start to sample for epoch 443, global virtualClock: 21994.330916413484, round_duration: 80.35344175505469
2021-08-18:17:03:16,152 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:16,429 INFO     [param_server.py:553] For epoch: 443, median_reward: 345.34199220191755, dev: 345.34199220191755
2021-08-18:17:03:17,131 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9211, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:17:03:17,132 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5660.6325, eval_time 0.6564, test_loss 3.9211, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:17:03:17,141 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3322, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:17:03:17,141 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5660.642, eval_time 0.6656, test_loss 3.3322, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:17:03:17,203 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:03:17,208 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:03:17,214 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:17,224 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:17,264 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7464, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:03:17,265 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5660.7637, eval_time 0.7915, test_loss 3.7464, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:03:17,336 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:03:17,362 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:18,446 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:18,457 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:19,434 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:19,437 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:19,456 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:19,475 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:21,397 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:21,408 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:22,316 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:22,317 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:22,325 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:22,344 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:22,784 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:22,805 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:23,344 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:23,370 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:23,889 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:23,905 INFO     [learner.py:606] ====Pushing takes 0.015331029891967773 s
2021-08-18:17:03:23,926 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:23,933 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:23,934 INFO     [param_server.py:410] Lock worker 1 with localStep 443 , while globalStep is 442

2021-08-18:17:03:24,192 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:24,212 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:24,705 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:24,719 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:25,910 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:25,933 INFO     [learner.py:606] ====Pushing takes 0.02126002311706543 s
2021-08-18:17:03:25,958 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:25,966 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:25,967 INFO     [param_server.py:410] Lock worker 3 with localStep 443 , while globalStep is 442

2021-08-18:17:03:26,590 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:26,606 INFO     [learner.py:606] ====Pushing takes 0.014596223831176758 s
2021-08-18:17:03:26,620 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:26,625 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:26,625 INFO     [param_server.py:381] ====After aggregation in epoch: 442, virtual_clock: 22074.68435816854, top_1: : 61.9232 % (1919.0), top_5: : 100.0 % (3099.0), test loss: 3.666574972647208, test len: 3099.0
2021-08-18:17:03:26,628 INFO     [param_server.py:410] Lock worker 2 with localStep 443 , while globalStep is 443

2021-08-18:17:03:26,629 INFO     [param_server.py:441] ====Epoch 444 completes 13 clients with loss 2.8057787946526953, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:26,629 INFO     [param_server.py:450] ====Start to sample for epoch 444, global virtualClock: 22074.68435816854, round_duration: 80.35344175505469
2021-08-18:17:03:26,630 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:26,906 INFO     [param_server.py:553] For epoch: 444, median_reward: 341.6041961213454, dev: 341.6041961213454
2021-08-18:17:03:27,524 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4002, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:17:03:27,525 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5671.025, eval_time 0.5722, test_loss 3.4002, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:17:03:27,528 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3309, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:03:27,528 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5671.029, eval_time 0.576, test_loss 3.3309, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:03:27,600 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:03:27,608 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:27,610 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:03:27,620 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:27,642 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5225, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:03:27,643 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5671.1416, eval_time 0.6926, test_loss 3.5225, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:03:27,710 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:03:27,739 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:28,896 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:28,916 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:29,859 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:29,873 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:30,82 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:30,119 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:31,849 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:31,860 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:32,645 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:32,654 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:32,768 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:32,789 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:33,231 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:33,242 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:33,579 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:33,613 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:34,221 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:34,223 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:34,234 INFO     [learner.py:606] ====Pushing takes 0.011485815048217773 s
2021-08-18:17:03:34,234 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:34,251 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:34,256 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:34,257 INFO     [param_server.py:410] Lock worker 1 with localStep 444 , while globalStep is 443

2021-08-18:17:03:34,945 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:34,966 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:36,156 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:36,177 INFO     [learner.py:606] ====Pushing takes 0.019731521606445312 s
2021-08-18:17:03:36,203 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:36,209 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:36,210 INFO     [param_server.py:410] Lock worker 3 with localStep 444 , while globalStep is 443

2021-08-18:17:03:36,447 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:36,462 INFO     [learner.py:606] ====Pushing takes 0.013306856155395508 s
2021-08-18:17:03:36,481 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:36,487 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:36,488 INFO     [param_server.py:381] ====After aggregation in epoch: 443, virtual_clock: 22155.037799923593, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 3.417880064083471, test len: 3099.0
2021-08-18:17:03:36,490 INFO     [param_server.py:410] Lock worker 2 with localStep 444 , while globalStep is 444

2021-08-18:17:03:36,490 INFO     [param_server.py:441] ====Epoch 445 completes 13 clients with loss 6.206819307092093, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:36,491 INFO     [param_server.py:450] ====Start to sample for epoch 445, global virtualClock: 22155.037799923593, round_duration: 80.35344175505469
2021-08-18:17:03:36,492 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:36,766 INFO     [param_server.py:553] For epoch: 445, median_reward: 339.88532367409505, dev: 339.88532367409505
2021-08-18:17:03:37,365 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.801, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:17:03:37,366 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5680.8662, eval_time 0.5638, test_loss 3.801, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:17:03:37,411 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3033, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:17:03:37,411 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5680.9119, eval_time 0.6093, test_loss 3.3033, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:17:03:37,444 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:03:37,448 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7175, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:03:37,449 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5680.9472, eval_time 0.6482, test_loss 3.7175, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:03:37,458 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:37,483 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:03:37,497 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:37,514 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:03:37,537 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:38,748 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:38,758 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:39,403 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:39,417 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:39,763 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:39,804 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:41,945 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:41,959 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:42,197 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:42,216 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:42,738 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:42,759 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:43,340 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:43,350 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:43,634 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:43,648 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:44,27 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:44,38 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:44,215 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:44,232 INFO     [learner.py:606] ====Pushing takes 0.015493392944335938 s
2021-08-18:17:03:44,247 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:44,255 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:44,255 INFO     [param_server.py:410] Lock worker 1 with localStep 445 , while globalStep is 444

2021-08-18:17:03:45,161 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:45,171 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:46,243 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:46,266 INFO     [learner.py:606] ====Pushing takes 0.021050453186035156 s
2021-08-18:17:03:46,290 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:46,296 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:46,296 INFO     [param_server.py:410] Lock worker 3 with localStep 445 , while globalStep is 444

2021-08-18:17:03:46,329 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:46,345 INFO     [learner.py:606] ====Pushing takes 0.014084100723266602 s
2021-08-18:17:03:46,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:46,365 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:46,366 INFO     [param_server.py:381] ====After aggregation in epoch: 444, virtual_clock: 22235.391241678648, top_1: : 61.8909 % (1918.0), top_5: : 100.0 % (3099.0), test loss: 3.607291668653488, test len: 3099.0
2021-08-18:17:03:46,368 INFO     [param_server.py:410] Lock worker 2 with localStep 445 , while globalStep is 445

2021-08-18:17:03:46,369 INFO     [param_server.py:441] ====Epoch 446 completes 13 clients with loss 3.4564939503353274, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:46,369 INFO     [param_server.py:450] ====Start to sample for epoch 446, global virtualClock: 22235.391241678648, round_duration: 80.35344175505469
2021-08-18:17:03:46,370 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:46,665 INFO     [param_server.py:553] For epoch: 446, median_reward: 321.42175276523415, dev: 321.42175276523415
2021-08-18:17:03:47,414 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3662, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:17:03:47,415 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5690.9152, eval_time 0.6945, test_loss 4.3662, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:17:03:47,450 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.5103, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:17:03:47,451 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5690.9518, eval_time 0.7301, test_loss 4.5103, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:17:03:47,487 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:03:47,495 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:47,523 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:03:47,542 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:47,585 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7368, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:03:47,586 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5691.0845, eval_time 0.8657, test_loss 3.7368, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:03:47,674 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:03:47,701 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:48,659 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:48,682 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:49,723 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:49,739 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:49,750 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:49,750 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:51,486 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:51,498 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:52,389 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:52,400 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:52,721 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:52,755 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:52,784 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:52,797 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:53,748 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:53,775 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:54,101 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:54,119 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:54,332 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:54,347 INFO     [learner.py:606] ====Pushing takes 0.013688087463378906 s
2021-08-18:17:03:54,363 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:54,369 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:54,370 INFO     [param_server.py:410] Lock worker 1 with localStep 446 , while globalStep is 445

2021-08-18:17:03:54,767 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:54,776 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:55,918 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:55,941 INFO     [learner.py:606] ====Pushing takes 0.021703481674194336 s
2021-08-18:17:03:55,969 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:55,975 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:55,975 INFO     [param_server.py:410] Lock worker 3 with localStep 446 , while globalStep is 445

2021-08-18:17:03:56,511 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:56,527 INFO     [learner.py:606] ====Pushing takes 0.014270305633544922 s
2021-08-18:17:03:56,541 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:56,546 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:56,547 INFO     [param_server.py:381] ====After aggregation in epoch: 445, virtual_clock: 22315.744683433702, top_1: : 60.7938 % (1884.0), top_5: : 100.0 % (3099.0), test loss: 4.204410583884628, test len: 3099.0
2021-08-18:17:03:56,550 INFO     [param_server.py:410] Lock worker 2 with localStep 446 , while globalStep is 446

2021-08-18:17:03:56,550 INFO     [param_server.py:441] ====Epoch 447 completes 13 clients with loss 6.1515340098793905, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:56,551 INFO     [param_server.py:450] ====Start to sample for epoch 447, global virtualClock: 22315.744683433702, round_duration: 80.35344175505469
2021-08-18:17:03:56,552 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:56,837 INFO     [param_server.py:553] For epoch: 447, median_reward: 354.31394428686457, dev: 354.31394428686457
2021-08-18:17:03:57,570 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6288, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:03:57,571 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3824, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:03:57,571 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5701.0718, eval_time 0.698, test_loss 3.3824, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:03:57,571 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5701.0716, eval_time 0.697, test_loss 3.6288, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:03:57,639 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:03:57,639 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:03:57,647 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:57,648 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:57,690 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6644, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:03:57,691 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5701.1895, eval_time 0.8176, test_loss 3.6644, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:03:57,771 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:03:57,799 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:58,877 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:58,897 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:59,817 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:59,828 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:00,224 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:00,251 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:01,868 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:01,877 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:02,464 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:02,476 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:02,751 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:02,786 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:03,123 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:03,132 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:03,846 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:03,879 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:03,998 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:04,9 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:04,594 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:04,611 INFO     [learner.py:606] ====Pushing takes 0.015136003494262695 s
2021-08-18:17:04:04,632 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:04,640 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:04,641 INFO     [param_server.py:410] Lock worker 1 with localStep 447 , while globalStep is 446

2021-08-18:17:04:04,845 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:04,863 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:05,897 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:05,926 INFO     [learner.py:606] ====Pushing takes 0.027063369750976562 s
2021-08-18:17:04:05,956 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:05,962 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:05,962 INFO     [param_server.py:410] Lock worker 3 with localStep 447 , while globalStep is 446

2021-08-18:17:04:06,530 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:06,547 INFO     [learner.py:606] ====Pushing takes 0.014934539794921875 s
2021-08-18:17:04:06,561 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:06,566 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:06,567 INFO     [param_server.py:381] ====After aggregation in epoch: 446, virtual_clock: 22396.098125188757, top_1: : 63.2139 % (1959.0), top_5: : 100.0 % (3099.0), test loss: 3.5585285496932486, test len: 3099.0
2021-08-18:17:04:06,570 INFO     [param_server.py:410] Lock worker 2 with localStep 447 , while globalStep is 447

2021-08-18:17:04:06,571 INFO     [param_server.py:441] ====Epoch 448 completes 13 clients with loss 4.925378590157448, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:06,571 INFO     [param_server.py:450] ====Start to sample for epoch 448, global virtualClock: 22396.098125188757, round_duration: 80.35344175505469
2021-08-18:17:04:06,572 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:06,862 INFO     [param_server.py:553] For epoch: 448, median_reward: 357.93159197085265, dev: 357.93159197085265
2021-08-18:17:04:07,541 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8788, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:17:04:07,542 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5711.0428, eval_time 0.6579, test_loss 3.8788, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:17:04:07,543 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7591, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:17:04:07,544 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5711.0443, eval_time 0.6592, test_loss 3.7591, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:17:04:07,577 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.6005, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:04:07,579 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5711.0773, eval_time 0.6942, test_loss 4.6005, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:04:07,613 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:07,614 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:07,621 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:07,623 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:07,670 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:07,692 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:08,828 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:08,837 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:09,869 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:09,878 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:10,186 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:10,233 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:11,924 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:11,937 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:12,580 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:12,591 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:13,8 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:13,22 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:13,389 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:13,401 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:13,779 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:13,827 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:14,382 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:14,392 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:14,600 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:14,615 INFO     [learner.py:606] ====Pushing takes 0.014100790023803711 s
2021-08-18:17:04:14,637 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:14,642 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:14,643 INFO     [param_server.py:410] Lock worker 1 with localStep 448 , while globalStep is 447

2021-08-18:17:04:15,194 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:15,203 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:16,295 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:16,317 INFO     [learner.py:606] ====Pushing takes 0.02068328857421875 s
2021-08-18:17:04:16,346 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:16,352 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:16,353 INFO     [param_server.py:410] Lock worker 3 with localStep 448 , while globalStep is 447

2021-08-18:17:04:16,762 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:16,777 INFO     [learner.py:606] ====Pushing takes 0.013650894165039062 s
2021-08-18:17:04:16,791 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:16,796 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:16,797 INFO     [param_server.py:381] ====After aggregation in epoch: 447, virtual_clock: 22476.45156694381, top_1: : 61.0197 % (1891.0), top_5: : 100.0 % (3099.0), test loss: 4.079470153208132, test len: 3099.0
2021-08-18:17:04:16,799 INFO     [param_server.py:410] Lock worker 2 with localStep 448 , while globalStep is 448

2021-08-18:17:04:16,800 INFO     [param_server.py:441] ====Epoch 449 completes 13 clients with loss 5.550061571415801, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:16,801 INFO     [param_server.py:450] ====Start to sample for epoch 449, global virtualClock: 22476.45156694381, round_duration: 80.35344175505469
2021-08-18:17:04:16,802 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:17,66 INFO     [param_server.py:553] For epoch: 449, median_reward: 344.5470864435531, dev: 344.5470864435531
2021-08-18:17:04:17,722 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4393, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:04:17,723 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5721.2238, eval_time 0.6017, test_loss 3.4393, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:04:17,732 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5807, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:04:17,733 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5721.2337, eval_time 0.6052, test_loss 3.5807, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:04:17,760 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9781, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:17:04:17,761 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5721.2596, eval_time 0.6396, test_loss 3.9781, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:17:04:17,794 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:04:17,802 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:17,802 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:04:17,810 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:17,833 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:04:17,845 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:18,927 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:18,938 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:19,805 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:19,833 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:19,938 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:19,950 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:21,714 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:21,725 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:22,680 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:22,694 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:23,67 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:23,101 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:23,130 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:23,153 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:23,809 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:23,823 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:24,439 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:24,457 INFO     [learner.py:606] ====Pushing takes 0.01644301414489746 s
2021-08-18:17:04:24,478 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:24,486 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:24,487 INFO     [param_server.py:410] Lock worker 1 with localStep 449 , while globalStep is 448

2021-08-18:17:04:24,509 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:24,520 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:24,882 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:24,891 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:26,9 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:26,34 INFO     [learner.py:606] ====Pushing takes 0.023476600646972656 s
2021-08-18:17:04:26,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:26,67 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:26,67 INFO     [param_server.py:410] Lock worker 3 with localStep 449 , while globalStep is 448

2021-08-18:17:04:26,853 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:26,869 INFO     [learner.py:606] ====Pushing takes 0.014415502548217773 s
2021-08-18:17:04:26,883 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:26,888 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:26,889 INFO     [param_server.py:381] ====After aggregation in epoch: 448, virtual_clock: 22556.805008698866, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 3.6660306564083807, test len: 3099.0
2021-08-18:17:04:26,892 INFO     [param_server.py:410] Lock worker 2 with localStep 449 , while globalStep is 449

2021-08-18:17:04:26,893 INFO     [param_server.py:441] ====Epoch 450 completes 13 clients with loss 5.9445909313417165, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:26,894 INFO     [param_server.py:450] ====Start to sample for epoch 450, global virtualClock: 22556.805008698866, round_duration: 80.35344175505469
2021-08-18:17:04:26,894 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:27,171 INFO     [param_server.py:553] For epoch: 450, median_reward: 368.4204983860084, dev: 368.4204983860084
2021-08-18:17:04:27,851 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7773, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:17:04:27,852 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5731.3525, eval_time 0.6255, test_loss 3.7773, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:17:04:27,855 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6653, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:04:27,855 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5731.3558, eval_time 0.6284, test_loss 3.6653, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:04:27,928 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:04:27,936 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:27,944 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:04:27,958 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:28,24 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3692, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:04:28,24 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5731.5229, eval_time 0.7978, test_loss 3.3692, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:04:28,96 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:04:28,128 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:29,347 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:29,360 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:30,204 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:30,214 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:30,321 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:30,348 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:32,58 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:32,67 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:32,927 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:32,938 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:33,291 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:33,326 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:33,385 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:33,396 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:34,226 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:34,261 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:34,561 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:34,579 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:34,916 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:34,932 INFO     [learner.py:606] ====Pushing takes 0.013807058334350586 s
2021-08-18:17:04:34,955 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:34,960 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:34,961 INFO     [param_server.py:410] Lock worker 1 with localStep 450 , while globalStep is 449

2021-08-18:17:04:35,316 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:35,330 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:36,382 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:36,402 INFO     [learner.py:606] ====Pushing takes 0.01851058006286621 s
2021-08-18:17:04:36,426 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:36,432 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:36,433 INFO     [param_server.py:410] Lock worker 3 with localStep 450 , while globalStep is 449

2021-08-18:17:04:36,783 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:36,798 INFO     [learner.py:606] ====Pushing takes 0.01358938217163086 s
2021-08-18:17:04:36,812 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:36,817 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:36,817 INFO     [param_server.py:381] ====After aggregation in epoch: 449, virtual_clock: 22637.15845045392, top_1: : 64.4724 % (1998.0), top_5: : 100.0 % (3099.0), test loss: 3.6039438600893376, test len: 3099.0
2021-08-18:17:04:36,820 INFO     [param_server.py:410] Lock worker 2 with localStep 450 , while globalStep is 450

2021-08-18:17:04:36,820 INFO     [param_server.py:441] ====Epoch 451 completes 13 clients with loss 5.213392008725418, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:36,821 INFO     [param_server.py:450] ====Start to sample for epoch 451, global virtualClock: 22637.15845045392, round_duration: 80.35344175505469
2021-08-18:17:04:36,821 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:04:37,90 INFO     [param_server.py:553] For epoch: 451, median_reward: 353.4762788031816, dev: 353.4762788031816
2021-08-18:17:04:37,761 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4077, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:17:04:37,762 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5741.2627, eval_time 0.6494, test_loss 3.4077, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:17:04:37,765 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2864, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:04:37,766 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5741.2661, eval_time 0.6512, test_loss 4.2864, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:04:37,832 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:04:37,832 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:04:37,838 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6839, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:17:04:37,839 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5741.3375, eval_time 0.7261, test_loss 3.6839, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:17:04:37,841 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:37,842 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:37,911 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:04:37,930 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:39,7 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:39,21 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:40,74 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:40,92 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:40,384 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:40,430 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:42,121 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:42,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:42,885 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:42,895 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:43,169 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:43,183 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:43,431 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:43,441 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:44,7 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:44,34 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:44,760 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:44,761 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:44,773 INFO     [learner.py:606] ====Pushing takes 0.010650396347045898 s
2021-08-18:17:04:44,782 INFO     [learner.py:606] ====Pushing takes 0.019675493240356445 s
2021-08-18:17:04:44,793 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:44,799 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:04:44,800 INFO     [param_server.py:410] Lock worker 2 with localStep 451 , while globalStep is 450

2021-08-18:17:04:44,812 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:44,816 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:04:44,816 INFO     [param_server.py:410] Lock worker 1 with localStep 451 , while globalStep is 450

2021-08-18:17:04:45,255 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:45,265 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:46,396 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:46,420 INFO     [learner.py:606] ====Pushing takes 0.021759748458862305 s
2021-08-18:17:04:46,446 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:46,452 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:04:46,453 INFO     [param_server.py:381] ====After aggregation in epoch: 450, virtual_clock: 22720.755785615434, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 3.7926547085797346, test len: 3099.0
2021-08-18:17:04:46,455 INFO     [param_server.py:410] Lock worker 3 with localStep 451 , while globalStep is 451

2021-08-18:17:04:46,456 INFO     [param_server.py:441] ====Epoch 452 completes 12 clients with loss 5.4625004373885515, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:46,456 INFO     [param_server.py:450] ====Start to sample for epoch 452, global virtualClock: 22720.755785615434, round_duration: 83.5973351615153
2021-08-18:17:04:46,457 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:04:46,730 INFO     [param_server.py:553] For epoch: 452, median_reward: 346.8681428185335, dev: 346.8681428185335
2021-08-18:17:04:47,482 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.068, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:04:47,482 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5750.9828, eval_time 0.715, test_loss 4.068, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:04:47,520 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6322, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:17:04:47,521 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5751.0216, eval_time 0.7474, test_loss 3.6322, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:17:04:47,553 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:04:47,557 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5834, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:17:04:47,558 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5751.0564, eval_time 0.7904, test_loss 3.5834, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:17:04:47,561 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:47,592 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:04:47,606 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:47,616 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:04:47,636 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:48,657 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:48,666 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:49,340 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:49,367 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:49,604 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:49,614 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:51,321 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:51,345 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:52,338 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:52,358 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:52,810 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:52,837 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:53,223 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:53,241 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:53,661 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:53,681 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:54,33 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:54,45 INFO     [learner.py:606] ====Pushing takes 0.010112524032592773 s
2021-08-18:17:04:54,59 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:54,63 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:04:54,64 INFO     [param_server.py:410] Lock worker 2 with localStep 452 , while globalStep is 451

2021-08-18:17:04:54,341 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:54,356 INFO     [learner.py:606] ====Pushing takes 0.013401508331298828 s
2021-08-18:17:04:54,375 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:54,380 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:04:54,381 INFO     [param_server.py:410] Lock worker 1 with localStep 452 , while globalStep is 451

2021-08-18:17:04:54,975 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:54,984 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:56,86 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:56,109 INFO     [learner.py:606] ====Pushing takes 0.020938634872436523 s
2021-08-18:17:04:56,133 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:56,139 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:04:56,140 INFO     [param_server.py:381] ====After aggregation in epoch: 451, virtual_clock: 22804.35312077695, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 3.7612066313072483, test len: 3099.0
2021-08-18:17:04:56,142 INFO     [param_server.py:410] Lock worker 3 with localStep 452 , while globalStep is 452

2021-08-18:17:04:56,143 INFO     [param_server.py:441] ====Epoch 453 completes 12 clients with loss 4.3071464338475876, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:56,143 INFO     [param_server.py:450] ====Start to sample for epoch 453, global virtualClock: 22804.35312077695, round_duration: 83.5973351615153
2021-08-18:17:04:56,144 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:04:56,427 INFO     [param_server.py:553] For epoch: 453, median_reward: 353.8073772375138, dev: 353.8073772375138
2021-08-18:17:04:57,52 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7217, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:17:04:57,53 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5760.5537, eval_time 0.5798, test_loss 3.7217, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:17:04:57,54 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4894, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:04:57,54 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5760.5549, eval_time 0.5808, test_loss 3.4894, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:04:57,122 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:04:57,122 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:04:57,130 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:57,131 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:57,216 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9679, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:17:04:57,218 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5760.7161, eval_time 0.7461, test_loss 3.9679, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:17:04:57,304 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:04:57,338 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:58,490 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:58,504 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:59,516 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:59,517 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:59,528 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:59,536 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:01,201 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:01,211 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:02,73 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:02,82 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:02,471 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:02,511 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:02,573 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:02,589 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:03,523 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:03,557 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:03,900 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:03,913 INFO     [learner.py:606] ====Pushing takes 0.010631799697875977 s
2021-08-18:17:05:03,930 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:03,939 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:05:03,939 INFO     [param_server.py:410] Lock worker 2 with localStep 453 , while globalStep is 452

2021-08-18:17:05:04,189 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:04,205 INFO     [learner.py:606] ====Pushing takes 0.015307903289794922 s
2021-08-18:17:05:04,222 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:04,231 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:05:04,232 INFO     [param_server.py:410] Lock worker 1 with localStep 453 , while globalStep is 452

2021-08-18:17:05:04,549 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:04,562 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:05,819 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:05,842 INFO     [learner.py:606] ====Pushing takes 0.021709442138671875 s
2021-08-18:17:05:05,869 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:05,874 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:05:05,875 INFO     [param_server.py:381] ====After aggregation in epoch: 452, virtual_clock: 22887.950455938462, top_1: : 64.0207 % (1984.0), top_5: : 100.0 % (3099.0), test loss: 3.7263244876155146, test len: 3099.0
2021-08-18:17:05:05,878 INFO     [param_server.py:410] Lock worker 3 with localStep 453 , while globalStep is 453

2021-08-18:17:05:05,878 INFO     [param_server.py:441] ====Epoch 454 completes 12 clients with loss 5.8257889429179075, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:05,879 INFO     [param_server.py:450] ====Start to sample for epoch 454, global virtualClock: 22887.950455938462, round_duration: 83.5973351615153
2021-08-18:17:05:05,879 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:05:06,152 INFO     [param_server.py:553] For epoch: 454, median_reward: 328.1030621705664, dev: 328.1030621705664
2021-08-18:17:05:06,826 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3953, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:05:06,827 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5770.3254, eval_time 0.6518, test_loss 3.3953, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:05:06,861 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.242, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:17:05:06,863 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5770.363, eval_time 0.6852, test_loss 3.242, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:17:05:06,861 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5426, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:17:05:06,864 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5770.3639, eval_time 0.6864, test_loss 3.5426, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:17:05:06,906 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:06,928 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:06,934 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:06,943 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:06,971 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:06,980 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:08,127 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:08,137 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:09,102 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:09,111 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:09,160 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:09,193 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:11,188 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:11,202 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:11,741 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:11,756 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:12,244 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:12,272 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:12,807 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:12,826 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:13,296 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:13,324 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:13,523 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:13,535 INFO     [learner.py:606] ====Pushing takes 0.01043391227722168 s
2021-08-18:17:05:13,549 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:13,552 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:05:13,553 INFO     [param_server.py:410] Lock worker 2 with localStep 454 , while globalStep is 453

2021-08-18:17:05:13,973 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:13,989 INFO     [learner.py:606] ====Pushing takes 0.013614654541015625 s
2021-08-18:17:05:14,3 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:14,8 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:05:14,9 INFO     [param_server.py:410] Lock worker 1 with localStep 454 , while globalStep is 453

2021-08-18:17:05:14,738 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:14,750 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:16,77 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:16,98 INFO     [learner.py:606] ====Pushing takes 0.019730806350708008 s
2021-08-18:17:05:16,121 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:16,127 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:05:16,128 INFO     [param_server.py:381] ====After aggregation in epoch: 453, virtual_clock: 22971.547791099976, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 3.3933047541865595, test len: 3099.0
2021-08-18:17:05:16,130 INFO     [param_server.py:410] Lock worker 3 with localStep 454 , while globalStep is 454

2021-08-18:17:05:16,131 INFO     [param_server.py:441] ====Epoch 455 completes 12 clients with loss 3.9314138011621877, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:16,131 INFO     [param_server.py:450] ====Start to sample for epoch 455, global virtualClock: 22971.547791099976, round_duration: 83.5973351615153
2021-08-18:17:05:16,132 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:05:16,404 INFO     [param_server.py:553] For epoch: 455, median_reward: 360.81890627749203, dev: 360.81890627749203
2021-08-18:17:05:17,68 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5148, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:05:17,68 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5780.5689, eval_time 0.6288, test_loss 3.5148, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:05:17,120 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.193, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:05:17,121 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5780.6211, eval_time 0.6801, test_loss 3.193, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:05:17,138 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:05:17,151 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:17,155 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6532, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:05:17,156 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5780.6545, eval_time 0.7166, test_loss 3.6532, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:05:17,188 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:05:17,202 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:17,228 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:05:17,246 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:18,352 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:18,361 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:19,257 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:19,284 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:19,454 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:19,466 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:21,13 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:21,28 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:22,171 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:22,181 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:22,423 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:22,432 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:22,452 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:22,456 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:23,394 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:23,415 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:23,954 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:23,959 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:23,966 INFO     [learner.py:606] ====Pushing takes 0.010252714157104492 s
2021-08-18:17:05:23,981 INFO     [learner.py:606] ====Pushing takes 0.020521879196166992 s
2021-08-18:17:05:23,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:23,990 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:05:23,990 INFO     [param_server.py:410] Lock worker 2 with localStep 455 , while globalStep is 454

2021-08-18:17:05:24,6 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:24,10 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:05:24,10 INFO     [param_server.py:410] Lock worker 1 with localStep 455 , while globalStep is 454

2021-08-18:17:05:24,517 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:24,533 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:25,676 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:25,701 INFO     [learner.py:606] ====Pushing takes 0.022034406661987305 s
2021-08-18:17:05:25,727 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:25,732 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:05:25,733 INFO     [param_server.py:381] ====After aggregation in epoch: 454, virtual_clock: 23055.14512626149, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 3.4536688217410334, test len: 3099.0
2021-08-18:17:05:25,735 INFO     [param_server.py:410] Lock worker 3 with localStep 455 , while globalStep is 455

2021-08-18:17:05:25,735 INFO     [param_server.py:441] ====Epoch 456 completes 12 clients with loss 3.7446734227133924, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:25,736 INFO     [param_server.py:450] ====Start to sample for epoch 456, global virtualClock: 23055.14512626149, round_duration: 83.5973351615153
2021-08-18:17:05:25,736 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:05:26,18 INFO     [param_server.py:553] For epoch: 456, median_reward: 350.2107166809464, dev: 350.2107166809464
2021-08-18:17:05:26,734 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9343, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:05:26,735 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5790.2352, eval_time 0.6589, test_loss 3.9343, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:05:26,760 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7025, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:05:26,761 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5790.2616, eval_time 0.6876, test_loss 3.7025, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:05:26,803 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:05:26,812 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:26,832 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:05:26,840 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0073, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:05:26,841 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5790.3397, eval_time 0.7674, test_loss 4.0073, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:05:26,847 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:26,911 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:05:26,939 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:28,108 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:28,118 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:28,894 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:28,913 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:29,78 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:29,88 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:30,938 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:30,947 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:31,600 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:31,640 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:31,717 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:31,731 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:32,362 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:32,382 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:32,746 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:32,786 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:33,419 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:33,437 INFO     [learner.py:606] ====Pushing takes 0.01618027687072754 s
2021-08-18:17:05:33,455 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:33,461 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:05:33,462 INFO     [param_server.py:410] Lock worker 1 with localStep 456 , while globalStep is 455

2021-08-18:17:05:33,676 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:33,691 INFO     [learner.py:606] ====Pushing takes 0.013183116912841797 s
2021-08-18:17:05:33,704 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:33,708 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:05:33,708 INFO     [param_server.py:410] Lock worker 2 with localStep 456 , while globalStep is 455

2021-08-18:17:05:34,315 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:34,333 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:35,456 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:35,479 INFO     [learner.py:606] ====Pushing takes 0.021195411682128906 s
2021-08-18:17:05:35,502 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:35,508 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:05:35,509 INFO     [param_server.py:381] ====After aggregation in epoch: 455, virtual_clock: 23138.742461423004, top_1: : 63.7625 % (1976.0), top_5: : 100.0 % (3099.0), test loss: 3.881323821014828, test len: 3099.0
2021-08-18:17:05:35,511 INFO     [param_server.py:410] Lock worker 3 with localStep 456 , while globalStep is 456

2021-08-18:17:05:35,512 INFO     [param_server.py:441] ====Epoch 457 completes 12 clients with loss 4.251656723738626, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:35,512 INFO     [param_server.py:450] ====Start to sample for epoch 457, global virtualClock: 23138.742461423004, round_duration: 83.5973351615153
2021-08-18:17:05:35,513 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:05:35,790 INFO     [param_server.py:553] For epoch: 457, median_reward: 349.8017599746567, dev: 349.8017599746567
2021-08-18:17:05:36,545 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5903, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:17:05:36,546 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5800.0464, eval_time 0.7203, test_loss 3.5903, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:17:05:36,546 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3451, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:05:36,547 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5800.0473, eval_time 0.721, test_loss 3.3451, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:05:36,617 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:05:36,617 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:05:36,619 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.4282, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:05:36,620 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5800.119, eval_time 0.7946, test_loss 4.4282, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:05:36,624 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:36,626 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:36,692 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:05:36,719 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:37,699 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:37,708 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:38,894 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:38,921 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:38,941 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:38,961 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:40,517 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:40,527 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:41,465 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:41,492 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:41,627 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:41,640 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:41,778 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:41,787 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:42,371 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:42,399 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:43,149 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:43,164 INFO     [learner.py:606] ====Pushing takes 0.013259410858154297 s
2021-08-18:17:05:43,184 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:43,192 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:05:43,192 INFO     [param_server.py:410] Lock worker 1 with localStep 457 , while globalStep is 456

2021-08-18:17:05:43,309 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:43,321 INFO     [learner.py:606] ====Pushing takes 0.010693788528442383 s
2021-08-18:17:05:43,333 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:43,337 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:05:43,337 INFO     [param_server.py:410] Lock worker 2 with localStep 457 , while globalStep is 456

2021-08-18:17:05:43,829 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:43,850 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:45,175 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:45,199 INFO     [learner.py:606] ====Pushing takes 0.022305727005004883 s
2021-08-18:17:05:45,223 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:45,229 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:05:45,229 INFO     [param_server.py:381] ====After aggregation in epoch: 456, virtual_clock: 23222.339796584518, top_1: : 63.8593 % (1979.0), top_5: : 100.0 % (3099.0), test loss: 3.7878579000631967, test len: 3099.0
2021-08-18:17:05:45,231 INFO     [param_server.py:410] Lock worker 3 with localStep 457 , while globalStep is 457

2021-08-18:17:05:45,232 INFO     [param_server.py:441] ====Epoch 458 completes 12 clients with loss 3.7805112403735817, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:45,232 INFO     [param_server.py:450] ====Start to sample for epoch 458, global virtualClock: 23222.339796584518, round_duration: 83.5973351615153
2021-08-18:17:05:45,233 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:05:45,543 INFO     [param_server.py:553] For epoch: 458, median_reward: 339.4503898484914, dev: 339.4503898484914
2021-08-18:17:05:46,220 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0426, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:05:46,220 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5809.7207, eval_time 0.6424, test_loss 4.0426, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:05:46,221 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1855, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:05:46,221 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5809.7218, eval_time 0.6401, test_loss 3.1855, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:05:46,259 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6291, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:17:05:46,259 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5809.7581, eval_time 0.683, test_loss 3.6291, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:17:05:46,290 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:05:46,295 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:05:46,298 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:46,304 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:46,316 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:05:46,329 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:47,475 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:47,484 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:48,448 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:48,483 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:48,526 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:48,540 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:50,220 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:50,234 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:51,286 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:51,300 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:51,313 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:51,324 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:51,542 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:51,551 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:52,251 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:52,279 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:52,777 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:52,792 INFO     [learner.py:606] ====Pushing takes 0.013731241226196289 s
2021-08-18:17:05:52,814 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:52,818 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:05:52,819 INFO     [param_server.py:410] Lock worker 1 with localStep 458 , while globalStep is 457

2021-08-18:17:05:53,129 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:53,140 INFO     [learner.py:606] ====Pushing takes 0.009312868118286133 s
2021-08-18:17:05:53,153 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:53,157 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:05:53,158 INFO     [param_server.py:410] Lock worker 2 with localStep 458 , while globalStep is 457

2021-08-18:17:05:53,282 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:53,301 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:54,591 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:54,613 INFO     [learner.py:606] ====Pushing takes 0.02068328857421875 s
2021-08-18:17:05:54,638 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:54,644 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:05:54,644 INFO     [param_server.py:381] ====After aggregation in epoch: 457, virtual_clock: 23305.93713174603, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 3.6190347828798823, test len: 3099.0
2021-08-18:17:05:54,647 INFO     [param_server.py:410] Lock worker 3 with localStep 458 , while globalStep is 458

2021-08-18:17:05:54,647 INFO     [param_server.py:441] ====Epoch 459 completes 12 clients with loss 6.172943070912331, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:54,648 INFO     [param_server.py:450] ====Start to sample for epoch 459, global virtualClock: 23305.93713174603, round_duration: 83.5973351615153
2021-08-18:17:05:54,648 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:05:54,942 INFO     [param_server.py:553] For epoch: 459, median_reward: 333.47920326954085, dev: 333.47920326954085
2021-08-18:17:05:55,664 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3865, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:17:05:55,665 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5819.1657, eval_time 0.6673, test_loss 3.3865, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:17:05:55,694 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6165, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:05:55,694 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5819.195, eval_time 0.6957, test_loss 3.6165, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:05:55,732 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:05:55,742 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:55,762 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:05:55,765 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6437, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:05:55,766 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5819.2643, eval_time 0.7679, test_loss 3.6437, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:05:55,774 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:55,856 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:05:55,880 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:56,972 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:56,984 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:57,986 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:58,2 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:58,7 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:58,12 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:59,722 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:59,739 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:00,632 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:00,650 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:00,774 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:00,801 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:01,141 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:01,151 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:01,631 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:01,652 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:02,278 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:02,295 INFO     [learner.py:606] ====Pushing takes 0.014671802520751953 s
2021-08-18:17:06:02,315 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:02,322 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:02,323 INFO     [param_server.py:410] Lock worker 1 with localStep 459 , while globalStep is 458

2021-08-18:17:06:02,375 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:02,388 INFO     [learner.py:606] ====Pushing takes 0.01145625114440918 s
2021-08-18:17:06:02,400 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:02,404 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:02,404 INFO     [param_server.py:410] Lock worker 2 with localStep 459 , while globalStep is 458

2021-08-18:17:06:02,901 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:02,911 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:03,951 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:03,975 INFO     [learner.py:606] ====Pushing takes 0.020945310592651367 s
2021-08-18:17:06:04,0 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:04,6 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:04,6 INFO     [param_server.py:381] ====After aggregation in epoch: 458, virtual_clock: 23389.534466907546, top_1: : 64.4724 % (1998.0), top_5: : 100.0 % (3099.0), test loss: 3.548895683553484, test len: 3099.0
2021-08-18:17:06:04,9 INFO     [param_server.py:410] Lock worker 3 with localStep 459 , while globalStep is 459

2021-08-18:17:06:04,9 INFO     [param_server.py:441] ====Epoch 460 completes 12 clients with loss 5.85754609469169, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:04,10 INFO     [param_server.py:450] ====Start to sample for epoch 460, global virtualClock: 23389.534466907546, round_duration: 83.5973351615153
2021-08-18:17:06:04,10 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:04,358 INFO     [param_server.py:553] For epoch: 460, median_reward: 347.50101940093975, dev: 347.50101940093975
2021-08-18:17:06:05,96 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3536, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:06:05,97 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5828.5979, eval_time 0.6724, test_loss 3.3536, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:06:05,167 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:05,170 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7864, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:17:06:05,171 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5828.671, eval_time 0.7457, test_loss 3.7864, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:17:06:05,180 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:05,234 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6856, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:17:06:05,235 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5828.7341, eval_time 0.8105, test_loss 3.6856, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:17:06:05,240 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:05,261 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:05,291 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:05,312 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:06,421 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:06,431 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:07,394 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:07,407 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:07,415 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:07,417 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:09,149 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:09,161 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:10,189 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:10,203 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:10,304 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:10,331 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:10,402 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:10,413 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:11,119 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:11,140 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:11,779 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:11,792 INFO     [learner.py:606] ====Pushing takes 0.01183319091796875 s
2021-08-18:17:06:11,810 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:11,816 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:11,817 INFO     [param_server.py:410] Lock worker 1 with localStep 460 , while globalStep is 459

2021-08-18:17:06:11,867 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:11,879 INFO     [learner.py:606] ====Pushing takes 0.009982585906982422 s
2021-08-18:17:06:11,890 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:11,894 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:11,895 INFO     [param_server.py:410] Lock worker 2 with localStep 460 , while globalStep is 459

2021-08-18:17:06:12,248 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:12,260 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:13,387 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:13,409 INFO     [learner.py:606] ====Pushing takes 0.020138025283813477 s
2021-08-18:17:06:13,434 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:13,442 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:13,453 INFO     [param_server.py:381] ====After aggregation in epoch: 459, virtual_clock: 23473.13180206906, top_1: : 63.7302 % (1975.0), top_5: : 100.0 % (3099.0), test loss: 3.6085187084282992, test len: 3099.0
2021-08-18:17:06:13,456 INFO     [param_server.py:410] Lock worker 3 with localStep 460 , while globalStep is 460

2021-08-18:17:06:13,456 INFO     [param_server.py:441] ====Epoch 461 completes 12 clients with loss 4.216121796809912, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:13,457 INFO     [param_server.py:450] ====Start to sample for epoch 461, global virtualClock: 23473.13180206906, round_duration: 83.5973351615153
2021-08-18:17:06:13,458 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:13,796 INFO     [param_server.py:541] Handle Wight 0.041370391845703125 | Send 0.33939361572265625
2021-08-18:17:06:13,797 INFO     [param_server.py:553] For epoch: 461, median_reward: 356.92115984149535, dev: 356.92115984149535
2021-08-18:17:06:14,476 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0546, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:06:14,477 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5837.9773, eval_time 0.6193, test_loss 4.0546, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:06:14,478 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7683, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:17:06:14,479 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5837.9796, eval_time 0.6219, test_loss 3.7683, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:17:06:14,543 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:06:14,546 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:06:14,555 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:14,561 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:14,579 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.655, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:06:14,580 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5838.0782, eval_time 0.7271, test_loss 3.655, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:06:14,636 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:06:14,671 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:16,92 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:16,112 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:17,17 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:17,44 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:17,97 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:17,111 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:18,995 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:19,4 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:19,830 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:19,846 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:19,849 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:19,874 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:20,309 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:20,318 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:20,840 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:20,866 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:21,509 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:21,525 INFO     [learner.py:606] ====Pushing takes 0.015455245971679688 s
2021-08-18:17:06:21,548 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:21,556 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:21,557 INFO     [param_server.py:410] Lock worker 1 with localStep 461 , while globalStep is 460

2021-08-18:17:06:21,583 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:21,594 INFO     [learner.py:606] ====Pushing takes 0.009723424911499023 s
2021-08-18:17:06:21,606 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:21,610 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:21,610 INFO     [param_server.py:410] Lock worker 2 with localStep 461 , while globalStep is 460

2021-08-18:17:06:22,273 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:22,291 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:23,469 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:23,495 INFO     [learner.py:606] ====Pushing takes 0.021634578704833984 s
2021-08-18:17:06:23,518 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:23,523 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:23,524 INFO     [param_server.py:381] ====After aggregation in epoch: 460, virtual_clock: 23556.729137230574, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 3.8259689940346617, test len: 3099.0
2021-08-18:17:06:23,527 INFO     [param_server.py:410] Lock worker 3 with localStep 461 , while globalStep is 461

2021-08-18:17:06:23,527 INFO     [param_server.py:441] ====Epoch 462 completes 12 clients with loss 6.244939479358745, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:23,527 INFO     [param_server.py:450] ====Start to sample for epoch 462, global virtualClock: 23556.729137230574, round_duration: 83.5973351615153
2021-08-18:17:06:23,528 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:23,857 INFO     [param_server.py:553] For epoch: 462, median_reward: 343.20956878915973, dev: 343.20956878915973
2021-08-18:17:06:24,531 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3655, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:06:24,532 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5848.0329, eval_time 0.6174, test_loss 3.3655, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:06:24,579 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4803, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:17:06:24,580 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5848.0807, eval_time 0.6667, test_loss 3.4803, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:17:06:24,601 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:06:24,616 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:24,647 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:06:24,662 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:24,698 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5854, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:17:06:24,700 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5848.1981, eval_time 0.7863, test_loss 3.5854, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:17:06:24,771 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:06:24,799 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:25,976 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:25,990 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:26,954 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:27,25 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:27,40 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:27,54 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:28,622 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:28,637 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:29,672 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:29,693 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:29,797 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:29,807 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:29,906 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:29,916 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:30,456 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:30,483 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:31,58 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:31,73 INFO     [learner.py:606] ====Pushing takes 0.013744354248046875 s
2021-08-18:17:06:31,92 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:31,97 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:31,98 INFO     [param_server.py:410] Lock worker 1 with localStep 462 , while globalStep is 461

2021-08-18:17:06:31,499 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:31,512 INFO     [learner.py:606] ====Pushing takes 0.011090517044067383 s
2021-08-18:17:06:31,525 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:31,530 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:31,531 INFO     [param_server.py:410] Lock worker 2 with localStep 462 , while globalStep is 461

2021-08-18:17:06:31,648 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:31,662 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:32,806 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:32,827 INFO     [learner.py:606] ====Pushing takes 0.01973867416381836 s
2021-08-18:17:06:32,850 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:32,857 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:32,858 INFO     [param_server.py:381] ====After aggregation in epoch: 461, virtual_clock: 23640.326472392087, top_1: : 64.5369 % (2000.0), top_5: : 100.0 % (3099.0), test loss: 3.4770763737184027, test len: 3099.0
2021-08-18:17:06:32,861 INFO     [param_server.py:410] Lock worker 3 with localStep 462 , while globalStep is 462

2021-08-18:17:06:32,862 INFO     [param_server.py:441] ====Epoch 463 completes 12 clients with loss 5.459533523969102, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:32,862 INFO     [param_server.py:450] ====Start to sample for epoch 463, global virtualClock: 23640.326472392087, round_duration: 83.5973351615153
2021-08-18:17:06:32,863 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:33,211 INFO     [param_server.py:553] For epoch: 463, median_reward: 343.7444123843257, dev: 343.7444123843257
2021-08-18:17:06:33,844 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3174, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:06:33,845 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5857.3453, eval_time 0.5835, test_loss 3.3174, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:06:33,904 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8307, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:17:06:33,905 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5857.4055, eval_time 0.6447, test_loss 3.8307, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:17:06:33,911 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:06:33,920 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:33,930 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5767, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:17:06:33,932 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5857.4302, eval_time 0.6752, test_loss 3.5767, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:17:06:33,973 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:06:33,985 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:33,988 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:06:34,16 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:34,996 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:35,5 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:36,149 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:36,177 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:36,404 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:36,413 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:37,884 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:37,895 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:38,971 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:38,994 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:39,245 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:39,255 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:39,293 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:39,307 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:39,784 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:39,798 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:40,460 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:40,475 INFO     [learner.py:606] ====Pushing takes 0.013689994812011719 s
2021-08-18:17:06:40,495 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:40,503 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:40,504 INFO     [param_server.py:410] Lock worker 1 with localStep 463 , while globalStep is 462

2021-08-18:17:06:40,986 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:40,999 INFO     [learner.py:606] ====Pushing takes 0.01040339469909668 s
2021-08-18:17:06:41,10 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:41,14 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:41,15 INFO     [param_server.py:410] Lock worker 2 with localStep 463 , while globalStep is 462

2021-08-18:17:06:41,38 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:41,47 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:42,144 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:42,167 INFO     [learner.py:606] ====Pushing takes 0.020743608474731445 s
2021-08-18:17:06:42,191 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:42,198 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:42,199 INFO     [param_server.py:381] ====After aggregation in epoch: 462, virtual_clock: 23723.9238075536, top_1: : 64.7628 % (2007.0), top_5: : 100.0 % (3099.0), test loss: 3.574952705038919, test len: 3099.0
2021-08-18:17:06:42,201 INFO     [param_server.py:410] Lock worker 3 with localStep 463 , while globalStep is 463

2021-08-18:17:06:42,202 INFO     [param_server.py:441] ====Epoch 464 completes 12 clients with loss 3.571116450308264, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:42,202 INFO     [param_server.py:450] ====Start to sample for epoch 464, global virtualClock: 23723.9238075536, round_duration: 83.5973351615153
2021-08-18:17:06:42,203 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:42,508 INFO     [param_server.py:553] For epoch: 464, median_reward: 326.3405564415712, dev: 326.3405564415712
2021-08-18:17:06:43,227 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4364, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:06:43,231 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5866.7316, eval_time 0.6574, test_loss 3.4364, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:06:43,297 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:06:43,309 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:43,359 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7437, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:06:43,362 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5866.8621, eval_time 0.7881, test_loss 3.7437, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:06:43,408 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4575, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:06:43,409 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5866.9075, eval_time 0.8352, test_loss 3.4575, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:06:43,433 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:06:43,457 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:43,480 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:06:43,515 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:44,524 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:44,533 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:45,492 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:45,506 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:45,853 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:45,862 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:47,232 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:47,241 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:48,448 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:48,482 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:48,533 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:48,546 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:48,817 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:48,837 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:49,310 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:49,324 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:49,948 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:49,963 INFO     [learner.py:606] ====Pushing takes 0.013478517532348633 s
2021-08-18:17:06:49,982 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:49,987 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:49,988 INFO     [param_server.py:410] Lock worker 1 with localStep 464 , while globalStep is 463

2021-08-18:17:06:50,388 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:50,404 INFO     [learner.py:606] ====Pushing takes 0.014364004135131836 s
2021-08-18:17:06:50,416 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:50,420 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:50,420 INFO     [param_server.py:410] Lock worker 2 with localStep 464 , while globalStep is 463

2021-08-18:17:06:50,511 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:50,520 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:51,561 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:51,583 INFO     [learner.py:606] ====Pushing takes 0.02020716667175293 s
2021-08-18:17:06:51,605 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:51,611 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:51,611 INFO     [param_server.py:381] ====After aggregation in epoch: 463, virtual_clock: 23807.521142715115, top_1: : 63.7948 % (1977.0), top_5: : 100.0 % (3099.0), test loss: 3.54587631755405, test len: 3099.0
2021-08-18:17:06:51,614 INFO     [param_server.py:410] Lock worker 3 with localStep 464 , while globalStep is 464

2021-08-18:17:06:51,615 INFO     [param_server.py:441] ====Epoch 465 completes 12 clients with loss 3.135197865587594, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:51,615 INFO     [param_server.py:450] ====Start to sample for epoch 465, global virtualClock: 23807.521142715115, round_duration: 83.5973351615153
2021-08-18:17:06:51,616 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:51,901 INFO     [param_server.py:553] For epoch: 465, median_reward: 330.1182421685902, dev: 330.1182421685902
2021-08-18:17:06:52,649 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3892, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:06:52,650 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5876.1503, eval_time 0.6931, test_loss 3.3892, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:06:52,682 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7735, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:06:52,683 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5876.1829, eval_time 0.7259, test_loss 3.7735, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:06:52,717 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:06:52,727 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:52,756 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:06:52,774 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:52,811 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4722, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:06:52,812 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5876.3106, eval_time 0.8564, test_loss 3.4722, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:06:52,882 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:06:52,921 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:53,921 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:53,939 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:55,189 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:55,199 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:55,210 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:55,228 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:56,730 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:56,741 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:57,638 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:57,672 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:57,758 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:57,767 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:57,977 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:57,989 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:58,687 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:58,720 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:59,333 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:59,348 INFO     [learner.py:606] ====Pushing takes 0.013602733612060547 s
2021-08-18:17:06:59,363 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:59,370 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:59,371 INFO     [param_server.py:410] Lock worker 1 with localStep 465 , while globalStep is 464

2021-08-18:17:06:59,563 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:59,576 INFO     [learner.py:606] ====Pushing takes 0.009183645248413086 s
2021-08-18:17:06:59,588 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:59,592 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:59,593 INFO     [param_server.py:410] Lock worker 2 with localStep 465 , while globalStep is 464

2021-08-18:17:06:59,628 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:59,640 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:00,705 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:00,726 INFO     [learner.py:606] ====Pushing takes 0.019562959671020508 s
2021-08-18:17:07:00,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:00,759 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:00,759 INFO     [param_server.py:381] ====After aggregation in epoch: 464, virtual_clock: 23891.11847787663, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 3.544962966883624, test len: 3099.0
2021-08-18:17:07:00,762 INFO     [param_server.py:410] Lock worker 3 with localStep 465 , while globalStep is 465

2021-08-18:17:07:00,762 INFO     [param_server.py:441] ====Epoch 466 completes 12 clients with loss 6.450115066720652, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:00,763 INFO     [param_server.py:450] ====Start to sample for epoch 466, global virtualClock: 23891.11847787663, round_duration: 83.5973351615153
2021-08-18:17:07:00,763 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:01,57 INFO     [param_server.py:553] For epoch: 466, median_reward: 348.31825529414243, dev: 348.31825529414243
2021-08-18:17:07:01,617 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.6142, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:07:01,618 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5885.119, eval_time 0.5366, test_loss 4.6142, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:07:01,647 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3435, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:07:01,648 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5885.1483, eval_time 0.5662, test_loss 3.3435, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:07:01,689 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:01,692 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5327, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:07:01,693 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5885.1918, eval_time 0.6136, test_loss 3.5327, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:07:01,699 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:01,719 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:01,732 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:01,769 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:01,793 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:02,845 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:02,859 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:03,998 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:04,32 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:04,188 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:04,202 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:05,751 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:05,765 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:06,855 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:06,869 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:07,167 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:07,177 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:07,244 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:07,254 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:07,608 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:07,629 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:08,224 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:08,240 INFO     [learner.py:606] ====Pushing takes 0.014143228530883789 s
2021-08-18:17:07:08,261 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:08,266 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:08,267 INFO     [param_server.py:410] Lock worker 1 with localStep 466 , while globalStep is 465

2021-08-18:17:07:08,890 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:08,904 INFO     [learner.py:606] ====Pushing takes 0.012089729309082031 s
2021-08-18:17:07:08,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:08,919 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:08,920 INFO     [param_server.py:410] Lock worker 2 with localStep 466 , while globalStep is 465

2021-08-18:17:07:09,36 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:09,45 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:10,238 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:10,261 INFO     [learner.py:606] ====Pushing takes 0.021093368530273438 s
2021-08-18:17:07:10,284 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:10,294 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:10,295 INFO     [param_server.py:381] ====After aggregation in epoch: 465, virtual_clock: 23974.715813038143, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 3.8301238393480026, test len: 3099.0
2021-08-18:17:07:10,298 INFO     [param_server.py:410] Lock worker 3 with localStep 466 , while globalStep is 466

2021-08-18:17:07:10,299 INFO     [param_server.py:441] ====Epoch 467 completes 12 clients with loss 5.692181084882878, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:10,300 INFO     [param_server.py:450] ====Start to sample for epoch 467, global virtualClock: 23974.715813038143, round_duration: 83.5973351615153
2021-08-18:17:07:10,301 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:10,672 INFO     [param_server.py:553] For epoch: 467, median_reward: 340.06863886597534, dev: 340.06863886597534
2021-08-18:17:07:11,473 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4884, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:07:11,474 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5894.975, eval_time 0.7468, test_loss 3.4884, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:07:11,505 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8045, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:07:11,506 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5895.0068, eval_time 0.7789, test_loss 3.8045, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:07:11,544 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:07:11,554 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:11,575 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:07:11,594 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:11,601 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8035, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:17:07:11,602 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5895.1005, eval_time 0.8746, test_loss 3.8035, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:17:07:11,683 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:07:11,715 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:12,686 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:12,701 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:13,850 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:13,877 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:14,56 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:14,66 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:15,419 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:15,428 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:16,588 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:16,615 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:16,764 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:16,778 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:16,948 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:16,995 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:17,421 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:17,442 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:18,89 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:18,106 INFO     [learner.py:606] ====Pushing takes 0.015311956405639648 s
2021-08-18:17:07:18,126 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:18,130 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:18,131 INFO     [param_server.py:410] Lock worker 1 with localStep 467 , while globalStep is 466

2021-08-18:17:07:18,616 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:18,629 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:18,669 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:18,683 INFO     [learner.py:606] ====Pushing takes 0.00993490219116211 s
2021-08-18:17:07:18,695 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:18,701 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:18,701 INFO     [param_server.py:410] Lock worker 2 with localStep 467 , while globalStep is 466

2021-08-18:17:07:19,883 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:19,909 INFO     [learner.py:606] ====Pushing takes 0.021456480026245117 s
2021-08-18:17:07:19,931 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:19,936 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:19,937 INFO     [param_server.py:381] ====After aggregation in epoch: 466, virtual_clock: 24058.313148199657, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.6987998397262007, test len: 3099.0
2021-08-18:17:07:19,939 INFO     [param_server.py:410] Lock worker 3 with localStep 467 , while globalStep is 467

2021-08-18:17:07:19,940 INFO     [param_server.py:441] ====Epoch 468 completes 12 clients with loss 3.9117193611063223, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:19,940 INFO     [param_server.py:450] ====Start to sample for epoch 468, global virtualClock: 24058.313148199657, round_duration: 83.5973351615153
2021-08-18:17:07:19,941 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:20,211 INFO     [param_server.py:553] For epoch: 468, median_reward: 353.5388173491993, dev: 353.5388173491993
2021-08-18:17:07:20,894 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6094, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:07:20,896 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5904.3964, eval_time 0.621, test_loss 3.6094, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:07:20,929 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7321, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:07:20,930 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5904.4302, eval_time 0.6587, test_loss 3.7321, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:07:20,963 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:07:20,971 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:20,998 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:07:21,0 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9928, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:07:21,0 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5904.499, eval_time 0.7338, test_loss 3.9928, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:07:21,22 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:21,95 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:07:21,125 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:22,128 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:22,149 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:23,418 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:23,427 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:23,443 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:23,464 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:25,51 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:25,63 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:26,198 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:26,207 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:26,300 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:26,320 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:26,439 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:26,448 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:27,147 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:27,168 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:27,746 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:27,761 INFO     [learner.py:606] ====Pushing takes 0.013519287109375 s
2021-08-18:17:07:27,779 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:27,785 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:27,785 INFO     [param_server.py:410] Lock worker 1 with localStep 468 , while globalStep is 467

2021-08-18:17:07:28,121 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:28,132 INFO     [learner.py:606] ====Pushing takes 0.009791374206542969 s
2021-08-18:17:07:28,144 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:28,148 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:28,149 INFO     [param_server.py:410] Lock worker 2 with localStep 468 , while globalStep is 467

2021-08-18:17:07:28,204 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:28,213 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:29,559 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:29,581 INFO     [learner.py:606] ====Pushing takes 0.019925594329833984 s
2021-08-18:17:07:29,605 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:29,610 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:29,611 INFO     [param_server.py:381] ====After aggregation in epoch: 467, virtual_clock: 24141.91048336117, top_1: : 65.3114 % (2024.0), top_5: : 100.0 % (3099.0), test loss: 3.7781229372377747, test len: 3099.0
2021-08-18:17:07:29,613 INFO     [param_server.py:410] Lock worker 3 with localStep 468 , while globalStep is 468

2021-08-18:17:07:29,614 INFO     [param_server.py:441] ====Epoch 469 completes 12 clients with loss 6.084638237891833, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:29,614 INFO     [param_server.py:450] ====Start to sample for epoch 469, global virtualClock: 24141.91048336117, round_duration: 83.5973351615153
2021-08-18:17:07:29,615 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:29,885 INFO     [param_server.py:553] For epoch: 469, median_reward: 336.8842917501286, dev: 336.8842917501286
2021-08-18:17:07:30,532 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.822, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:07:30,534 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5914.034, eval_time 0.5934, test_loss 3.822, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:07:30,618 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:07:30,631 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:30,656 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7385, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:17:07:30,657 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5914.1578, eval_time 0.7175, test_loss 3.7385, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:17:07:30,696 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9395, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:07:30,697 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5914.1955, eval_time 0.7569, test_loss 3.9395, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:07:30,728 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:07:30,750 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:30,777 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:07:30,810 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:31,819 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:31,828 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:32,911 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:32,932 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:33,130 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:33,148 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:34,732 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:34,745 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:35,785 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:35,803 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:35,806 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:35,827 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:36,148 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:36,160 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:36,704 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:36,724 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:37,325 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:37,341 INFO     [learner.py:606] ====Pushing takes 0.014320850372314453 s
2021-08-18:17:07:37,357 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:37,365 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:37,366 INFO     [param_server.py:410] Lock worker 1 with localStep 469 , while globalStep is 468

2021-08-18:17:07:37,592 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:37,603 INFO     [learner.py:606] ====Pushing takes 0.008923053741455078 s
2021-08-18:17:07:37,615 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:37,619 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:37,620 INFO     [param_server.py:410] Lock worker 2 with localStep 469 , while globalStep is 468

2021-08-18:17:07:37,886 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:37,895 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:39,116 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:39,136 INFO     [learner.py:606] ====Pushing takes 0.01885986328125 s
2021-08-18:17:07:39,157 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:39,162 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:39,163 INFO     [param_server.py:381] ====After aggregation in epoch: 468, virtual_clock: 24225.507818522685, top_1: : 64.0207 % (1984.0), top_5: : 100.0 % (3099.0), test loss: 3.833361343101219, test len: 3099.0
2021-08-18:17:07:39,165 INFO     [param_server.py:410] Lock worker 3 with localStep 469 , while globalStep is 469

2021-08-18:17:07:39,166 INFO     [param_server.py:441] ====Epoch 470 completes 12 clients with loss 4.105949754019444, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:39,166 INFO     [param_server.py:450] ====Start to sample for epoch 470, global virtualClock: 24225.507818522685, round_duration: 83.5973351615153
2021-08-18:17:07:39,167 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:39,476 INFO     [param_server.py:553] For epoch: 470, median_reward: 340.32526276490677, dev: 340.32526276490677
2021-08-18:17:07:40,90 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4453, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:17:07:40,91 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5923.5913, eval_time 0.5571, test_loss 3.4453, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:17:07:40,132 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5271, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:07:40,133 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5923.6335, eval_time 0.6, test_loss 3.5271, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:07:40,168 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:07:40,175 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:40,223 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:07:40,238 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:40,290 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.851, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:17:07:40,291 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5923.7894, eval_time 0.7584, test_loss 3.851, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:17:07:40,363 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:07:40,404 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:41,436 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:41,456 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:42,467 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:42,469 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:42,477 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:42,490 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:43,910 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:43,919 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:45,45 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:45,73 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:45,113 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:45,124 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:45,296 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:45,305 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:45,946 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:45,974 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:46,572 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:46,588 INFO     [learner.py:606] ====Pushing takes 0.014227151870727539 s
2021-08-18:17:07:46,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:46,615 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:46,615 INFO     [param_server.py:410] Lock worker 1 with localStep 470 , while globalStep is 469

2021-08-18:17:07:47,25 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:47,38 INFO     [learner.py:606] ====Pushing takes 0.010824441909790039 s
2021-08-18:17:07:47,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:47,53 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:47,53 INFO     [param_server.py:410] Lock worker 2 with localStep 470 , while globalStep is 469

2021-08-18:17:07:47,212 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:47,225 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:48,388 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:48,415 INFO     [learner.py:606] ====Pushing takes 0.022070884704589844 s
2021-08-18:17:07:48,437 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:48,443 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:48,444 INFO     [param_server.py:381] ====After aggregation in epoch: 469, virtual_clock: 24309.1051536842, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.607822387306778, test len: 3099.0
2021-08-18:17:07:48,447 INFO     [param_server.py:410] Lock worker 3 with localStep 470 , while globalStep is 470

2021-08-18:17:07:48,447 INFO     [param_server.py:441] ====Epoch 471 completes 12 clients with loss 6.726520238094606, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:48,448 INFO     [param_server.py:450] ====Start to sample for epoch 471, global virtualClock: 24309.1051536842, round_duration: 83.5973351615153
2021-08-18:17:07:48,448 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:48,741 INFO     [param_server.py:553] For epoch: 471, median_reward: 333.8231407206542, dev: 333.8231407206542
2021-08-18:17:07:49,404 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5581, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:07:49,404 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5932.9049, eval_time 0.6192, test_loss 3.5581, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:07:49,473 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:07:49,489 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:49,488 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5616, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:07:49,491 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5932.9909, eval_time 0.7055, test_loss 3.5616, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:07:49,549 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5165, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:07:49,549 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5933.048, eval_time 0.7643, test_loss 3.5165, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:07:49,568 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:07:49,592 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:49,619 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:07:49,651 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:50,549 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:50,567 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:51,912 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:51,933 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:52,72 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:52,107 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:53,433 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:53,446 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:54,587 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:54,608 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:54,694 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:54,703 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:54,946 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:54,965 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:55,349 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:55,370 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:55,951 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:55,967 INFO     [learner.py:606] ====Pushing takes 0.015088319778442383 s
2021-08-18:17:07:55,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:55,995 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:55,996 INFO     [param_server.py:410] Lock worker 1 with localStep 471 , while globalStep is 470

2021-08-18:17:07:56,526 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:56,535 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:56,657 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:56,669 INFO     [learner.py:606] ====Pushing takes 0.010189533233642578 s
2021-08-18:17:07:56,685 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:56,690 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:56,690 INFO     [param_server.py:410] Lock worker 2 with localStep 471 , while globalStep is 470

2021-08-18:17:07:57,732 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:57,756 INFO     [learner.py:606] ====Pushing takes 0.021393537521362305 s
2021-08-18:17:07:57,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:57,784 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:57,785 INFO     [param_server.py:381] ====After aggregation in epoch: 470, virtual_clock: 24392.702488845713, top_1: : 64.7306 % (2006.0), top_5: : 100.0 % (3099.0), test loss: 3.545391199765382, test len: 3099.0
2021-08-18:17:07:57,787 INFO     [param_server.py:410] Lock worker 3 with localStep 471 , while globalStep is 471

2021-08-18:17:07:57,788 INFO     [param_server.py:441] ====Epoch 472 completes 12 clients with loss 4.289984287596834, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:57,788 INFO     [param_server.py:450] ====Start to sample for epoch 472, global virtualClock: 24392.702488845713, round_duration: 83.5973351615153
2021-08-18:17:07:57,789 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:58,55 INFO     [param_server.py:553] For epoch: 472, median_reward: 347.8663223953635, dev: 347.8663223953635
2021-08-18:17:07:58,666 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.797, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:07:58,667 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5942.1678, eval_time 0.5665, test_loss 3.797, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:07:58,673 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9427, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:17:07:58,674 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5942.174, eval_time 0.5722, test_loss 3.9427, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:17:07:58,744 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:07:58,746 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:07:58,761 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:58,768 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:58,829 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0143, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:07:58,830 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5942.3289, eval_time 0.7314, test_loss 4.0143, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:07:58,918 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:07:58,956 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:59,920 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:59,941 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:01,207 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:01,216 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:01,228 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:01,234 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:02,718 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:02,727 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:03,723 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:03,751 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:03,831 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:03,841 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:04,34 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:04,46 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:04,683 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:04,709 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:05,362 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:05,379 INFO     [learner.py:606] ====Pushing takes 0.01538705825805664 s
2021-08-18:17:08:05,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:05,402 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:05,403 INFO     [param_server.py:410] Lock worker 1 with localStep 472 , while globalStep is 471

2021-08-18:17:08:05,660 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:05,672 INFO     [learner.py:606] ====Pushing takes 0.010728597640991211 s
2021-08-18:17:08:05,684 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:05,688 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:05,689 INFO     [param_server.py:410] Lock worker 2 with localStep 472 , while globalStep is 471

2021-08-18:17:08:05,836 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:05,845 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:06,964 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:06,985 INFO     [learner.py:606] ====Pushing takes 0.019518136978149414 s
2021-08-18:17:08:07,10 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:07,16 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:07,17 INFO     [param_server.py:381] ====After aggregation in epoch: 471, virtual_clock: 24476.299824007227, top_1: : 63.827 % (1978.0), top_5: : 100.0 % (3099.0), test loss: 3.9179935764383393, test len: 3099.0
2021-08-18:17:08:07,20 INFO     [param_server.py:410] Lock worker 3 with localStep 472 , while globalStep is 472

2021-08-18:17:08:07,20 INFO     [param_server.py:441] ====Epoch 473 completes 12 clients with loss 3.93698716968599, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:07,21 INFO     [param_server.py:450] ====Start to sample for epoch 473, global virtualClock: 24476.299824007227, round_duration: 83.5973351615153
2021-08-18:17:08:07,22 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:07,297 INFO     [param_server.py:553] For epoch: 473, median_reward: 345.3075897087386, dev: 345.3075897087386
2021-08-18:17:08:08,16 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4902, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:08:08,17 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5951.5178, eval_time 0.6858, test_loss 3.4902, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:08:08,17 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.9295, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:08:08,18 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5951.5185, eval_time 0.6844, test_loss 4.9295, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:08:08,87 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:08,96 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:08,108 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:08,125 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:08,184 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5116, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:08:08,185 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5951.6836, eval_time 0.8534, test_loss 3.5116, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:08:08,256 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:08,282 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:09,454 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:09,466 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:10,678 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:10,707 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:10,753 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:10,762 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:12,124 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:12,134 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:13,405 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:13,425 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:13,544 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:13,553 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:13,612 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:13,626 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:14,256 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:14,276 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:14,812 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:14,829 INFO     [learner.py:606] ====Pushing takes 0.01566004753112793 s
2021-08-18:17:08:14,847 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:14,854 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:14,855 INFO     [param_server.py:410] Lock worker 1 with localStep 473 , while globalStep is 472

2021-08-18:17:08:15,265 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:15,278 INFO     [learner.py:606] ====Pushing takes 0.011129140853881836 s
2021-08-18:17:08:15,289 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:15,293 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:15,293 INFO     [param_server.py:410] Lock worker 2 with localStep 473 , while globalStep is 472

2021-08-18:17:08:15,315 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:15,325 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:16,460 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:16,485 INFO     [learner.py:606] ====Pushing takes 0.023849010467529297 s
2021-08-18:17:08:16,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:16,513 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:16,513 INFO     [param_server.py:381] ====After aggregation in epoch: 472, virtual_clock: 24559.89715916874, top_1: : 65.2469 % (2022.0), top_5: : 100.0 % (3099.0), test loss: 3.977087513164238, test len: 3099.0
2021-08-18:17:08:16,515 INFO     [param_server.py:410] Lock worker 3 with localStep 473 , while globalStep is 473

2021-08-18:17:08:16,516 INFO     [param_server.py:441] ====Epoch 474 completes 12 clients with loss 5.186061987615652, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:16,516 INFO     [param_server.py:450] ====Start to sample for epoch 474, global virtualClock: 24559.89715916874, round_duration: 83.5973351615153
2021-08-18:17:08:16,517 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:16,804 INFO     [param_server.py:553] For epoch: 474, median_reward: 339.94571054611043, dev: 339.94571054611043
2021-08-18:17:08:17,540 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9555, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:08:17,541 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5961.0412, eval_time 0.6908, test_loss 3.9555, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:08:17,575 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8289, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:17:08:17,576 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5961.0766, eval_time 0.7264, test_loss 3.8289, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:17:08:17,609 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:08:17,617 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:17,656 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:08:17,683 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:17,738 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.901, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:08:17,739 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5961.2377, eval_time 0.8893, test_loss 3.901, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:08:17,809 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:08:17,841 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:18,766 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:18,785 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:19,923 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:19,943 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:20,107 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:20,117 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:21,591 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:21,605 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:22,634 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:22,653 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:22,661 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:22,667 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:22,893 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:22,902 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:23,527 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:23,548 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:24,118 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:24,133 INFO     [learner.py:606] ====Pushing takes 0.013633966445922852 s
2021-08-18:17:08:24,152 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:24,157 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:24,158 INFO     [param_server.py:410] Lock worker 1 with localStep 474 , while globalStep is 473

2021-08-18:17:08:24,649 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:24,652 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:24,661 INFO     [learner.py:606] ====Pushing takes 0.009814023971557617 s
2021-08-18:17:08:24,667 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:24,672 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:24,676 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:24,677 INFO     [param_server.py:410] Lock worker 2 with localStep 474 , while globalStep is 473

2021-08-18:17:08:25,997 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:26,18 INFO     [learner.py:606] ====Pushing takes 0.0197293758392334 s
2021-08-18:17:08:26,42 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:26,48 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:26,49 INFO     [param_server.py:381] ====After aggregation in epoch: 473, virtual_clock: 24643.494494330254, top_1: : 62.8913 % (1949.0), top_5: : 100.0 % (3099.0), test loss: 3.8951565821965537, test len: 3099.0
2021-08-18:17:08:26,51 INFO     [param_server.py:410] Lock worker 3 with localStep 474 , while globalStep is 474

2021-08-18:17:08:26,52 INFO     [param_server.py:441] ====Epoch 475 completes 12 clients with loss 2.8011226004479286, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:26,52 INFO     [param_server.py:450] ====Start to sample for epoch 475, global virtualClock: 24643.494494330254, round_duration: 83.5973351615153
2021-08-18:17:08:26,53 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:26,325 INFO     [param_server.py:553] For epoch: 475, median_reward: 370.61980307305083, dev: 370.61980307305083
2021-08-18:17:08:26,952 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3507, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:17:08:26,953 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5970.4535, eval_time 0.5798, test_loss 4.3507, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:17:08:27,22 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:08:27,36 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:27,46 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6043, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:08:27,47 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5970.5471, eval_time 0.6707, test_loss 3.6043, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:08:27,114 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:08:27,130 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:27,141 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7963, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:08:27,142 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5970.6408, eval_time 0.7688, test_loss 3.7963, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:08:27,213 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:08:27,246 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:28,439 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:28,458 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:29,471 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:29,492 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:29,522 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:29,535 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:31,287 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:31,296 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:32,153 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:32,180 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:32,302 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:32,314 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:32,719 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:32,734 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:32,987 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:33,14 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:33,672 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:33,688 INFO     [learner.py:606] ====Pushing takes 0.015063047409057617 s
2021-08-18:17:08:33,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:33,713 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:33,714 INFO     [param_server.py:410] Lock worker 1 with localStep 475 , while globalStep is 474

2021-08-18:17:08:34,15 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:34,26 INFO     [learner.py:606] ====Pushing takes 0.010089874267578125 s
2021-08-18:17:08:34,39 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:34,43 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:34,43 INFO     [param_server.py:410] Lock worker 2 with localStep 475 , while globalStep is 474

2021-08-18:17:08:34,615 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:34,629 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:35,849 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:35,871 INFO     [learner.py:606] ====Pushing takes 0.020673751831054688 s
2021-08-18:17:08:35,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:35,905 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:35,905 INFO     [param_server.py:381] ====After aggregation in epoch: 474, virtual_clock: 24727.09182949177, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 3.917130326783216, test len: 3099.0
2021-08-18:17:08:35,908 INFO     [param_server.py:410] Lock worker 3 with localStep 475 , while globalStep is 475

2021-08-18:17:08:35,908 INFO     [param_server.py:441] ====Epoch 476 completes 12 clients with loss 5.2001162670714605, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:35,909 INFO     [param_server.py:450] ====Start to sample for epoch 476, global virtualClock: 24727.09182949177, round_duration: 83.5973351615153
2021-08-18:17:08:35,909 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:36,221 INFO     [param_server.py:553] For epoch: 476, median_reward: 353.0018871930746, dev: 353.0018871930746
2021-08-18:17:08:36,934 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9028, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:17:08:36,935 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 5980.4358, eval_time 0.6678, test_loss 3.9028, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:17:08:36,970 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.047, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:17:08:36,971 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 5980.471, eval_time 0.7055, test_loss 4.047, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:17:08:37,6 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:08:37,14 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:37,45 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:08:37,52 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.121, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:17:08:37,53 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 5980.5518, eval_time 0.7881, test_loss 4.121, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:17:08:37,61 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:37,127 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:08:37,157 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:38,169 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:38,178 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:39,317 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:39,326 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:39,399 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:39,427 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:40,992 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:41,2 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:41,969 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:41,976 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:41,989 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:41,990 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:42,357 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:42,366 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:42,751 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:42,779 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:43,449 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:43,465 INFO     [learner.py:606] ====Pushing takes 0.014050722122192383 s
2021-08-18:17:08:43,482 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:43,487 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:43,488 INFO     [param_server.py:410] Lock worker 1 with localStep 476 , while globalStep is 475

2021-08-18:17:08:43,686 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:43,699 INFO     [learner.py:606] ====Pushing takes 0.01102304458618164 s
2021-08-18:17:08:43,710 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:43,714 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:43,715 INFO     [param_server.py:410] Lock worker 2 with localStep 476 , while globalStep is 475

2021-08-18:17:08:44,106 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:44,117 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:45,312 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:45,333 INFO     [learner.py:606] ====Pushing takes 0.020340919494628906 s
2021-08-18:17:08:45,357 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:45,363 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:45,364 INFO     [param_server.py:381] ====After aggregation in epoch: 475, virtual_clock: 24810.689164653282, top_1: : 62.375 % (1933.0), top_5: : 100.0 % (3099.0), test loss: 4.023590864958586, test len: 3099.0
2021-08-18:17:08:45,366 INFO     [param_server.py:410] Lock worker 3 with localStep 476 , while globalStep is 476

2021-08-18:17:08:45,366 INFO     [param_server.py:441] ====Epoch 477 completes 12 clients with loss 6.793168571299236, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:45,367 INFO     [param_server.py:450] ====Start to sample for epoch 477, global virtualClock: 24810.689164653282, round_duration: 83.5973351615153
2021-08-18:17:08:45,367 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:45,671 INFO     [param_server.py:553] For epoch: 477, median_reward: 346.58390793914435, dev: 346.58390793914435
2021-08-18:17:08:46,351 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9036, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:08:46,352 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 5989.8525, eval_time 0.6219, test_loss 3.9036, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:08:46,396 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6428, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:08:46,397 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 5989.8973, eval_time 0.6674, test_loss 3.6428, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:08:46,425 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:08:46,433 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:46,475 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2375, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:08:46,475 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 5989.974, eval_time 0.7525, test_loss 4.2375, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:08:46,475 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:08:46,494 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:46,545 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:08:46,596 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:47,502 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:47,513 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:48,650 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:48,677 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:48,846 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:48,860 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:50,324 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:50,334 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:51,528 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:51,549 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:51,618 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:51,628 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:51,784 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:51,793 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:52,318 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:52,339 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:52,961 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:52,976 INFO     [learner.py:606] ====Pushing takes 0.014194250106811523 s
2021-08-18:17:08:52,995 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:53,1 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:53,2 INFO     [param_server.py:410] Lock worker 1 with localStep 477 , while globalStep is 476

2021-08-18:17:08:53,373 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:53,387 INFO     [learner.py:606] ====Pushing takes 0.009702205657958984 s
2021-08-18:17:08:53,400 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:53,406 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:53,407 INFO     [param_server.py:410] Lock worker 2 with localStep 477 , while globalStep is 476

2021-08-18:17:08:53,541 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:53,550 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:54,671 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:54,691 INFO     [learner.py:606] ====Pushing takes 0.018398523330688477 s
2021-08-18:17:08:54,715 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:54,722 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:54,723 INFO     [param_server.py:381] ====After aggregation in epoch: 476, virtual_clock: 24894.286499814796, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 3.927989794148339, test len: 3099.0
2021-08-18:17:08:54,731 INFO     [param_server.py:410] Lock worker 3 with localStep 477 , while globalStep is 477

2021-08-18:17:08:54,732 INFO     [param_server.py:441] ====Epoch 478 completes 12 clients with loss 4.613626176317363, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:54,733 INFO     [param_server.py:450] ====Start to sample for epoch 478, global virtualClock: 24894.286499814796, round_duration: 83.5973351615153
2021-08-18:17:08:54,734 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:55,77 INFO     [param_server.py:553] For epoch: 478, median_reward: 330.4699832376115, dev: 330.4699832376115
2021-08-18:17:08:55,739 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8537, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:08:55,740 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 5999.2402, eval_time 0.6065, test_loss 3.8537, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:08:55,777 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5524, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:08:55,779 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 5999.2791, eval_time 0.6456, test_loss 3.5524, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:08:55,827 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:08:55,836 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:55,850 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:08:55,878 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:55,938 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6003, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:08:55,939 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 5999.4373, eval_time 0.8056, test_loss 3.6003, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:08:56,20 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:08:56,59 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:57,89 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:57,145 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:58,116 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:58,133 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:58,137 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:58,143 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:59,910 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:59,919 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:00,970 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:00,983 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:00,991 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:00,992 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:01,381 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:01,391 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:01,834 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:01,861 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:02,417 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:02,434 INFO     [learner.py:606] ====Pushing takes 0.014460325241088867 s
2021-08-18:17:09:02,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:02,460 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:02,461 INFO     [param_server.py:410] Lock worker 1 with localStep 478 , while globalStep is 477

2021-08-18:17:09:02,766 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:02,778 INFO     [learner.py:606] ====Pushing takes 0.009983062744140625 s
2021-08-18:17:09:02,789 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:02,797 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:02,798 INFO     [param_server.py:410] Lock worker 2 with localStep 478 , while globalStep is 477

2021-08-18:17:09:03,390 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:03,403 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:04,616 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:04,639 INFO     [learner.py:606] ====Pushing takes 0.02155327796936035 s
2021-08-18:17:09:04,664 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:04,670 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:04,670 INFO     [param_server.py:381] ====After aggregation in epoch: 477, virtual_clock: 24977.88383497631, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 3.6687807396606167, test len: 3099.0
2021-08-18:17:09:04,673 INFO     [param_server.py:410] Lock worker 3 with localStep 478 , while globalStep is 478

2021-08-18:17:09:04,674 INFO     [param_server.py:441] ====Epoch 479 completes 12 clients with loss 4.970321309686041, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:04,674 INFO     [param_server.py:450] ====Start to sample for epoch 479, global virtualClock: 24977.88383497631, round_duration: 83.5973351615153
2021-08-18:17:09:04,675 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:05,8 INFO     [param_server.py:553] For epoch: 479, median_reward: 335.7168264515556, dev: 335.7168264515556
2021-08-18:17:09:05,631 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9419, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:09:05,632 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6009.1329, eval_time 0.5675, test_loss 3.9419, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:09:05,708 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:05,711 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1346, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:17:09:05,712 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6009.2129, eval_time 0.6489, test_loss 4.1346, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:17:09:05,716 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:05,802 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:05,825 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:05,835 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5109, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:17:09:05,838 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6009.337, eval_time 0.7752, test_loss 4.5109, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:17:09:05,909 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:05,939 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:06,987 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:06,998 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:08,142 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:08,169 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:08,417 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:08,435 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:09,849 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:09,861 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:10,861 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:10,882 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:11,80 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:11,93 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:11,220 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:11,232 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:11,775 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:11,803 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:12,484 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:12,500 INFO     [learner.py:606] ====Pushing takes 0.014627695083618164 s
2021-08-18:17:09:12,518 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:12,526 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:12,527 INFO     [param_server.py:410] Lock worker 1 with localStep 479 , while globalStep is 478

2021-08-18:17:09:12,736 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:12,749 INFO     [learner.py:606] ====Pushing takes 0.01103067398071289 s
2021-08-18:17:09:12,760 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:12,764 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:12,764 INFO     [param_server.py:410] Lock worker 2 with localStep 479 , while globalStep is 478

2021-08-18:17:09:13,183 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:13,197 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:14,502 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:14,523 INFO     [learner.py:606] ====Pushing takes 0.019709110260009766 s
2021-08-18:17:09:14,547 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:14,553 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:14,554 INFO     [param_server.py:381] ====After aggregation in epoch: 478, virtual_clock: 25061.481170137824, top_1: : 62.7299 % (1944.0), top_5: : 100.0 % (3099.0), test loss: 4.195774360939309, test len: 3099.0
2021-08-18:17:09:14,556 INFO     [param_server.py:410] Lock worker 3 with localStep 479 , while globalStep is 479

2021-08-18:17:09:14,557 INFO     [param_server.py:441] ====Epoch 480 completes 12 clients with loss 4.6856869151532425, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:14,557 INFO     [param_server.py:450] ====Start to sample for epoch 480, global virtualClock: 25061.481170137824, round_duration: 83.5973351615153
2021-08-18:17:09:14,558 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:14,882 INFO     [param_server.py:553] For epoch: 480, median_reward: 347.50493816056456, dev: 347.50493816056456
2021-08-18:17:09:15,564 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.491, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:17:09:15,565 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6019.0655, eval_time 0.647, test_loss 3.491, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:17:09:15,633 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:09:15,647 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:15,652 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8561, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:09:15,653 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6019.1537, eval_time 0.7354, test_loss 3.8561, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:09:15,736 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:09:15,737 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8453, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:17:09:15,738 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6019.2369, eval_time 0.8227, test_loss 3.8453, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:17:09:15,758 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:15,809 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:09:15,845 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:16,831 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:16,844 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:17,883 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:17,910 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:18,37 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:18,51 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:19,865 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:19,892 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:20,737 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:20,758 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:20,958 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:20,969 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:21,356 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:21,366 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:21,559 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:21,580 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:22,238 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:22,254 INFO     [learner.py:606] ====Pushing takes 0.014064550399780273 s
2021-08-18:17:09:22,275 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:22,280 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:22,281 INFO     [param_server.py:410] Lock worker 1 with localStep 480 , while globalStep is 479

2021-08-18:17:09:22,700 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:22,713 INFO     [learner.py:606] ====Pushing takes 0.011629581451416016 s
2021-08-18:17:09:22,728 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:22,735 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:22,736 INFO     [param_server.py:410] Lock worker 2 with localStep 480 , while globalStep is 479

2021-08-18:17:09:23,78 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:23,88 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:24,329 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:24,354 INFO     [learner.py:606] ====Pushing takes 0.021219968795776367 s
2021-08-18:17:09:24,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:24,384 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:24,385 INFO     [param_server.py:381] ====After aggregation in epoch: 479, virtual_clock: 25145.078505299338, top_1: : 64.9242 % (2012.0), top_5: : 100.0 % (3099.0), test loss: 3.7307955777203596, test len: 3099.0
2021-08-18:17:09:24,387 INFO     [param_server.py:410] Lock worker 3 with localStep 480 , while globalStep is 480

2021-08-18:17:09:24,388 INFO     [param_server.py:441] ====Epoch 481 completes 12 clients with loss 4.388686786401763, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:24,388 INFO     [param_server.py:450] ====Start to sample for epoch 481, global virtualClock: 25145.078505299338, round_duration: 83.5973351615153
2021-08-18:17:09:24,389 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:24,709 INFO     [param_server.py:541] Handle Wight 0.02652716636657715 | Send 0.32114171981811523
2021-08-18:17:09:24,710 INFO     [param_server.py:553] For epoch: 481, median_reward: 338.0560731039363, dev: 338.0560731039363
2021-08-18:17:09:25,443 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3981, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:09:25,444 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6028.9447, eval_time 0.6628, test_loss 4.3981, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:09:25,467 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2719, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:17:09:25,470 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6028.9706, eval_time 0.6889, test_loss 4.2719, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:17:09:25,511 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:09:25,529 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:25,539 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1448, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:17:09:25,542 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6029.0403, eval_time 0.766, test_loss 4.1448, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:17:09:25,559 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:09:25,581 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:25,607 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:09:25,638 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:26,710 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:26,720 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:27,669 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:27,690 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:27,815 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:27,827 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:29,559 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:29,573 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:30,569 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:30,596 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:30,653 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:30,672 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:30,909 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:30,923 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:31,525 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:31,548 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:32,122 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:32,139 INFO     [learner.py:606] ====Pushing takes 0.015743017196655273 s
2021-08-18:17:09:32,157 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:32,164 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:32,165 INFO     [param_server.py:410] Lock worker 1 with localStep 481 , while globalStep is 480

2021-08-18:17:09:32,477 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:32,490 INFO     [learner.py:606] ====Pushing takes 0.011511564254760742 s
2021-08-18:17:09:32,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:32,505 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:32,506 INFO     [param_server.py:410] Lock worker 2 with localStep 481 , while globalStep is 480

2021-08-18:17:09:32,709 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:32,719 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:33,740 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:33,762 INFO     [learner.py:606] ====Pushing takes 0.019804716110229492 s
2021-08-18:17:09:33,786 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:33,791 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:33,792 INFO     [param_server.py:381] ====After aggregation in epoch: 480, virtual_clock: 25228.67584046085, top_1: : 63.0849 % (1955.0), top_5: : 100.0 % (3099.0), test loss: 4.271624291384661, test len: 3099.0
2021-08-18:17:09:33,794 INFO     [param_server.py:410] Lock worker 3 with localStep 481 , while globalStep is 481

2021-08-18:17:09:33,794 INFO     [param_server.py:441] ====Epoch 482 completes 12 clients with loss 4.590329048342917, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:33,795 INFO     [param_server.py:450] ====Start to sample for epoch 482, global virtualClock: 25228.67584046085, round_duration: 83.5973351615153
2021-08-18:17:09:33,795 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:34,57 INFO     [param_server.py:553] For epoch: 482, median_reward: 342.2615122800201, dev: 342.2615122800201
2021-08-18:17:09:34,648 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0757, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:09:34,648 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6038.149, eval_time 0.5427, test_loss 4.0757, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:09:34,715 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:09:34,729 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:34,738 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2558, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:09:34,739 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6038.2394, eval_time 0.6339, test_loss 4.2558, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:09:34,825 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:09:34,843 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:34,856 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.4065, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:17:09:34,857 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6038.3558, eval_time 0.754, test_loss 4.4065, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:17:09:34,929 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:09:34,958 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:36,75 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:36,85 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:37,41 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:37,68 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:37,330 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:37,342 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:38,987 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:38,999 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:39,753 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:39,781 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:40,86 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:40,97 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:40,352 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:40,361 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:40,612 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:40,640 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:41,266 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:41,281 INFO     [learner.py:606] ====Pushing takes 0.01346898078918457 s
2021-08-18:17:09:41,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:41,302 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:41,303 INFO     [param_server.py:410] Lock worker 1 with localStep 482 , while globalStep is 481

2021-08-18:17:09:41,737 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:41,749 INFO     [learner.py:606] ====Pushing takes 0.010401487350463867 s
2021-08-18:17:09:41,760 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:41,764 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:41,765 INFO     [param_server.py:410] Lock worker 2 with localStep 482 , while globalStep is 481

2021-08-18:17:09:42,227 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:42,241 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:43,448 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:43,472 INFO     [learner.py:606] ====Pushing takes 0.019847631454467773 s
2021-08-18:17:09:43,496 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:43,502 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:43,503 INFO     [param_server.py:381] ====After aggregation in epoch: 481, virtual_clock: 25312.273175622366, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 4.2460004665233475, test len: 3099.0
2021-08-18:17:09:43,505 INFO     [param_server.py:410] Lock worker 3 with localStep 482 , while globalStep is 482

2021-08-18:17:09:43,506 INFO     [param_server.py:441] ====Epoch 483 completes 12 clients with loss 5.183588770306219, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:43,506 INFO     [param_server.py:450] ====Start to sample for epoch 483, global virtualClock: 25312.273175622366, round_duration: 83.5973351615153
2021-08-18:17:09:43,507 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:43,776 INFO     [param_server.py:553] For epoch: 483, median_reward: 345.5241103859914, dev: 345.5241103859914
2021-08-18:17:09:44,419 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6568, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:09:44,420 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6047.9208, eval_time 0.5998, test_loss 3.6568, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:09:44,466 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0307, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:17:09:44,470 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6047.9703, eval_time 0.6495, test_loss 4.0307, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:17:09:44,491 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:09:44,501 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:44,501 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.1925, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:09:44,504 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6048.0026, eval_time 0.6835, test_loss 5.1925, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:09:44,561 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:09:44,574 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:44,577 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:09:44,600 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:45,652 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:45,661 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:46,645 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:46,673 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:46,771 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:46,780 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:48,552 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:48,566 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:49,466 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:49,479 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:49,637 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:49,649 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:49,980 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:49,989 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:50,230 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:50,251 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:50,774 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:50,791 INFO     [learner.py:606] ====Pushing takes 0.015552282333374023 s
2021-08-18:17:09:50,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:50,822 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:50,823 INFO     [param_server.py:410] Lock worker 1 with localStep 483 , while globalStep is 482

2021-08-18:17:09:51,215 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:51,226 INFO     [learner.py:606] ====Pushing takes 0.009975671768188477 s
2021-08-18:17:09:51,238 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:51,241 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:51,242 INFO     [param_server.py:410] Lock worker 2 with localStep 483 , while globalStep is 482

2021-08-18:17:09:51,712 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:51,723 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:52,939 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:52,961 INFO     [learner.py:606] ====Pushing takes 0.020629167556762695 s
2021-08-18:17:09:52,986 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:52,991 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:52,992 INFO     [param_server.py:381] ====After aggregation in epoch: 482, virtual_clock: 25395.87051078388, top_1: : 64.2143 % (1990.0), top_5: : 100.0 % (3099.0), test loss: 4.293320713219819, test len: 3099.0
2021-08-18:17:09:52,995 INFO     [param_server.py:410] Lock worker 3 with localStep 483 , while globalStep is 483

2021-08-18:17:09:52,995 INFO     [param_server.py:441] ====Epoch 484 completes 12 clients with loss 5.742083550211524, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:52,996 INFO     [param_server.py:450] ====Start to sample for epoch 484, global virtualClock: 25395.87051078388, round_duration: 83.5973351615153
2021-08-18:17:09:52,997 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:53,340 INFO     [param_server.py:553] For epoch: 484, median_reward: 340.61339858485104, dev: 340.61339858485104
2021-08-18:17:09:54,30 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0079, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:09:54,32 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6057.5325, eval_time 0.6265, test_loss 4.0079, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:09:54,44 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7385, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:17:09:54,45 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6057.5455, eval_time 0.6393, test_loss 3.7385, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:17:09:54,109 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:09:54,124 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:54,136 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:09:54,146 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9316, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:09:54,147 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6057.6459, eval_time 0.7416, test_loss 3.9316, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:09:54,154 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:54,228 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:09:54,259 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:55,443 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:55,454 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:56,315 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:56,362 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:56,518 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:56,528 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:58,201 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:58,215 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:59,189 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:59,199 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:59,246 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:59,272 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:59,668 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:59,688 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:00,82 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:00,103 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:00,616 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:00,630 INFO     [learner.py:606] ====Pushing takes 0.01193857192993164 s
2021-08-18:17:10:00,645 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:00,650 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:00,651 INFO     [param_server.py:410] Lock worker 1 with localStep 484 , while globalStep is 483

2021-08-18:17:10:00,750 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:00,761 INFO     [learner.py:606] ====Pushing takes 0.010118961334228516 s
2021-08-18:17:10:00,773 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:00,777 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:00,778 INFO     [param_server.py:410] Lock worker 2 with localStep 484 , while globalStep is 483

2021-08-18:17:10:01,547 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:01,556 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:02,633 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:02,656 INFO     [learner.py:606] ====Pushing takes 0.021471023559570312 s
2021-08-18:17:10:02,680 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:02,685 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:02,686 INFO     [param_server.py:381] ====After aggregation in epoch: 483, virtual_clock: 25479.467845945393, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.8926995065477157, test len: 3099.0
2021-08-18:17:10:02,688 INFO     [param_server.py:410] Lock worker 3 with localStep 484 , while globalStep is 484

2021-08-18:17:10:02,688 INFO     [param_server.py:441] ====Epoch 485 completes 12 clients with loss 5.19445585530042, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:02,688 INFO     [param_server.py:450] ====Start to sample for epoch 485, global virtualClock: 25479.467845945393, round_duration: 83.5973351615153
2021-08-18:17:10:02,689 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:02,966 INFO     [param_server.py:553] For epoch: 485, median_reward: 351.364796225676, dev: 351.364796225676
2021-08-18:17:10:03,612 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9828, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:10:03,613 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6067.1139, eval_time 0.5818, test_loss 3.9828, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:10:03,647 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6651, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:10:03,651 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6067.151, eval_time 0.619, test_loss 3.6651, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:10:03,694 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:03,702 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:03,721 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:03,734 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:03,740 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.7654, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:10:03,745 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6067.2432, eval_time 0.713, test_loss 4.7654, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:10:03,802 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:03,831 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:04,914 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:04,931 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:06,98 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:06,119 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:06,128 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:06,142 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:07,610 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:07,619 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:08,776 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:08,786 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:08,812 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:08,841 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:08,947 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:08,956 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:09,847 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:09,874 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:10,421 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:10,437 INFO     [learner.py:606] ====Pushing takes 0.01502847671508789 s
2021-08-18:17:10:10,457 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:10,465 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:10,465 INFO     [param_server.py:410] Lock worker 1 with localStep 485 , while globalStep is 484

2021-08-18:17:10:10,599 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:10,611 INFO     [learner.py:606] ====Pushing takes 0.00955510139465332 s
2021-08-18:17:10:10,623 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:10,630 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:10,631 INFO     [param_server.py:410] Lock worker 2 with localStep 485 , while globalStep is 484

2021-08-18:17:10:10,877 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:10,890 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:11,962 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:11,985 INFO     [learner.py:606] ====Pushing takes 0.021984338760375977 s
2021-08-18:17:10:12,11 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:12,17 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:12,18 INFO     [param_server.py:381] ====After aggregation in epoch: 484, virtual_clock: 25563.065181106907, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 4.137725913966143, test len: 3099.0
2021-08-18:17:10:12,20 INFO     [param_server.py:410] Lock worker 3 with localStep 485 , while globalStep is 485

2021-08-18:17:10:12,21 INFO     [param_server.py:441] ====Epoch 486 completes 12 clients with loss 5.341228636300628, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:12,21 INFO     [param_server.py:450] ====Start to sample for epoch 486, global virtualClock: 25563.065181106907, round_duration: 83.5973351615153
2021-08-18:17:10:12,22 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:12,297 INFO     [param_server.py:553] For epoch: 486, median_reward: 347.4202285329303, dev: 347.4202285329303
2021-08-18:17:10:12,976 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.4761, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:10:12,980 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6076.48, eval_time 0.637, test_loss 4.4761, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:10:13,54 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:10:13,58 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1345, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:10:13,59 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6076.5593, eval_time 0.7171, test_loss 4.1345, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:10:13,66 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:13,93 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0959, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:10:13,94 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6076.5922, eval_time 0.7518, test_loss 4.0959, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:10:13,127 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:10:13,144 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:13,162 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:10:13,190 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:14,171 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:14,186 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:15,367 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:15,377 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:15,453 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:15,480 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:16,882 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:16,896 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:17,965 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:17,974 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:18,115 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:18,130 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:18,318 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:18,328 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:18,821 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:18,841 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:19,575 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:19,588 INFO     [learner.py:606] ====Pushing takes 0.011347532272338867 s
2021-08-18:17:10:19,606 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:19,611 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:19,612 INFO     [param_server.py:410] Lock worker 1 with localStep 486 , while globalStep is 485

2021-08-18:17:10:19,699 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:19,712 INFO     [learner.py:606] ====Pushing takes 0.009745359420776367 s
2021-08-18:17:10:19,724 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:19,728 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:19,728 INFO     [param_server.py:410] Lock worker 2 with localStep 486 , while globalStep is 485

2021-08-18:17:10:20,158 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:20,167 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:21,437 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:21,460 INFO     [learner.py:606] ====Pushing takes 0.02111077308654785 s
2021-08-18:17:10:21,484 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:21,489 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:21,489 INFO     [param_server.py:381] ====After aggregation in epoch: 485, virtual_clock: 25646.66251626842, top_1: : 64.1497 % (1988.0), top_5: : 100.0 % (3099.0), test loss: 4.235473800588537, test len: 3099.0
2021-08-18:17:10:21,492 INFO     [param_server.py:410] Lock worker 3 with localStep 486 , while globalStep is 486

2021-08-18:17:10:21,492 INFO     [param_server.py:441] ====Epoch 487 completes 12 clients with loss 4.882143935865728, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:21,492 INFO     [param_server.py:450] ====Start to sample for epoch 487, global virtualClock: 25646.66251626842, round_duration: 83.5973351615153
2021-08-18:17:10:21,493 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:21,805 INFO     [param_server.py:553] For epoch: 487, median_reward: 346.3327872991189, dev: 346.3327872991189
2021-08-18:17:10:22,558 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.6526, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:10:22,559 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6086.0591, eval_time 0.6875, test_loss 4.6526, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:10:22,563 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7206, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:10:22,564 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6086.0641, eval_time 0.6899, test_loss 3.7206, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:10:22,613 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:10:22,636 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:22,637 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:10:22,663 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:22,686 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6953, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:10:22,687 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6086.1856, eval_time 0.8223, test_loss 3.6953, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:10:22,757 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:10:22,789 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:24,42 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:24,56 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:24,782 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:24,803 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:25,95 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:25,104 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:26,712 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:26,723 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:27,712 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:27,732 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:27,776 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:27,787 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:28,116 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:28,130 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:28,619 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:28,641 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:29,226 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:29,243 INFO     [learner.py:606] ====Pushing takes 0.015275716781616211 s
2021-08-18:17:10:29,262 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:29,275 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:29,276 INFO     [param_server.py:410] Lock worker 1 with localStep 487 , while globalStep is 486

2021-08-18:17:10:29,494 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:29,506 INFO     [learner.py:606] ====Pushing takes 0.010334253311157227 s
2021-08-18:17:10:29,517 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:29,521 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:29,521 INFO     [param_server.py:410] Lock worker 2 with localStep 487 , while globalStep is 486

2021-08-18:17:10:30,119 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:30,128 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:31,244 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:31,270 INFO     [learner.py:606] ====Pushing takes 0.02450418472290039 s
2021-08-18:17:10:31,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:31,300 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:31,301 INFO     [param_server.py:381] ====After aggregation in epoch: 486, virtual_clock: 25730.259851429935, top_1: : 64.6338 % (2003.0), top_5: : 100.0 % (3099.0), test loss: 4.022838641096045, test len: 3099.0
2021-08-18:17:10:31,304 INFO     [param_server.py:410] Lock worker 3 with localStep 487 , while globalStep is 487

2021-08-18:17:10:31,304 INFO     [param_server.py:441] ====Epoch 488 completes 12 clients with loss 7.5901644062624625, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:31,305 INFO     [param_server.py:450] ====Start to sample for epoch 488, global virtualClock: 25730.259851429935, round_duration: 83.5973351615153
2021-08-18:17:10:31,305 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:31,592 INFO     [param_server.py:553] For epoch: 488, median_reward: 341.4437637657523, dev: 341.4437637657523
2021-08-18:17:10:32,308 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7489, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:10:32,310 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6095.8101, eval_time 0.6606, test_loss 3.7489, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:10:32,347 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 6.2619, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:10:32,348 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6095.8482, eval_time 0.6989, test_loss 6.2619, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:10:32,377 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:10:32,390 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:32,417 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:10:32,432 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:32,459 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7634, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:10:32,469 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6095.9673, eval_time 0.822, test_loss 3.7634, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:10:32,554 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:10:32,584 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:33,630 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:33,654 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:34,725 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:34,747 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:34,750 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:34,759 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:36,400 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:36,412 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:37,389 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:37,416 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:37,421 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:37,432 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:37,749 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:37,759 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:38,229 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:38,300 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:38,844 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:38,859 INFO     [learner.py:606] ====Pushing takes 0.013581514358520508 s
2021-08-18:17:10:38,876 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:38,885 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:38,886 INFO     [param_server.py:410] Lock worker 1 with localStep 488 , while globalStep is 487

2021-08-18:17:10:39,132 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:39,146 INFO     [learner.py:606] ====Pushing takes 0.00997161865234375 s
2021-08-18:17:10:39,158 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:39,162 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:39,163 INFO     [param_server.py:410] Lock worker 2 with localStep 488 , while globalStep is 487

2021-08-18:17:10:39,569 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:39,583 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:40,950 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:40,973 INFO     [learner.py:606] ====Pushing takes 0.02071213722229004 s
2021-08-18:17:10:40,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:41,3 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:41,3 INFO     [param_server.py:381] ====After aggregation in epoch: 487, virtual_clock: 25813.85718659145, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 4.591360759955865, test len: 3099.0
2021-08-18:17:10:41,5 INFO     [param_server.py:410] Lock worker 3 with localStep 488 , while globalStep is 488

2021-08-18:17:10:41,6 INFO     [param_server.py:441] ====Epoch 489 completes 12 clients with loss 5.03446211510895, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:41,7 INFO     [param_server.py:450] ====Start to sample for epoch 489, global virtualClock: 25813.85718659145, round_duration: 83.5973351615153
2021-08-18:17:10:41,7 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:41,286 INFO     [param_server.py:553] For epoch: 489, median_reward: 358.40079724970985, dev: 358.40079724970985
2021-08-18:17:10:41,993 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8598, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:17:10:41,994 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6105.4944, eval_time 0.6358, test_loss 3.8598, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:17:10:42,61 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8884, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:17:10:42,62 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:10:42,62 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6105.5627, eval_time 0.7043, test_loss 3.8884, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:17:10:42,78 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:42,130 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6744, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:17:10:42,130 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6105.629, eval_time 0.7789, test_loss 3.6744, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:17:10:42,151 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:10:42,164 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:42,247 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:10:42,275 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:43,188 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:43,198 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:44,429 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:44,450 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:44,512 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:44,521 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:46,146 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:46,160 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:47,73 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:47,82 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:47,181 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:47,202 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:47,552 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:47,563 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:47,978 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:47,998 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:48,638 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:48,653 INFO     [learner.py:606] ====Pushing takes 0.010085344314575195 s
2021-08-18:17:10:48,668 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:48,675 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:10:48,676 INFO     [param_server.py:410] Lock worker 2 with localStep 489 , while globalStep is 488

2021-08-18:17:10:48,722 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:48,739 INFO     [learner.py:606] ====Pushing takes 0.015647411346435547 s
2021-08-18:17:10:48,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:48,760 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:48,760 INFO     [param_server.py:410] Lock worker 1 with localStep 489 , while globalStep is 488

2021-08-18:17:10:49,380 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:49,394 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:50,645 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:50,667 INFO     [learner.py:606] ====Pushing takes 0.020409345626831055 s
2021-08-18:17:10:50,690 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:50,696 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:50,696 INFO     [param_server.py:381] ====After aggregation in epoch: 488, virtual_clock: 25897.454521752963, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 3.807553162177404, test len: 3099.0
2021-08-18:17:10:50,699 INFO     [param_server.py:410] Lock worker 3 with localStep 489 , while globalStep is 489

2021-08-18:17:10:50,699 INFO     [param_server.py:441] ====Epoch 490 completes 12 clients with loss 8.788314640468617, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:50,700 INFO     [param_server.py:450] ====Start to sample for epoch 490, global virtualClock: 25897.454521752963, round_duration: 83.5973351615153
2021-08-18:17:10:50,700 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:50,966 INFO     [param_server.py:553] For epoch: 490, median_reward: 342.1963147609141, dev: 342.1963147609141
2021-08-18:17:10:51,644 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.3397, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:17:10:51,645 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6115.1454, eval_time 0.6075, test_loss 5.3397, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:17:10:51,656 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5674, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:10:51,657 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6115.1571, eval_time 0.619, test_loss 3.5674, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:10:51,713 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0827, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:10:51,713 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6115.2119, eval_time 0.6815, test_loss 4.0827, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:10:51,715 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:10:51,724 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:10:51,728 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:51,736 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:51,795 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:10:51,822 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:52,978 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:52,990 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:54,59 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:54,86 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:54,125 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:54,139 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:55,750 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:55,760 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:56,755 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:56,782 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:56,794 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:56,806 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:57,202 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:57,223 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:57,655 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:57,683 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:58,373 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:58,387 INFO     [learner.py:606] ====Pushing takes 0.009715080261230469 s
2021-08-18:17:10:58,400 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:58,404 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:10:58,405 INFO     [param_server.py:410] Lock worker 2 with localStep 490 , while globalStep is 489

2021-08-18:17:10:58,470 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:58,485 INFO     [learner.py:606] ====Pushing takes 0.01345515251159668 s
2021-08-18:17:10:58,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:58,507 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:58,507 INFO     [param_server.py:410] Lock worker 1 with localStep 490 , while globalStep is 489

2021-08-18:17:10:59,75 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:59,84 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:00,444 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:00,470 INFO     [learner.py:606] ====Pushing takes 0.023865699768066406 s
2021-08-18:17:11:00,494 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:00,500 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:00,501 INFO     [param_server.py:381] ====After aggregation in epoch: 489, virtual_clock: 25981.051856914477, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 4.329943899755125, test len: 3099.0
2021-08-18:17:11:00,533 INFO     [param_server.py:410] Lock worker 3 with localStep 490 , while globalStep is 490

2021-08-18:17:11:00,533 INFO     [param_server.py:441] ====Epoch 491 completes 12 clients with loss 4.770680753793712, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:00,534 INFO     [param_server.py:450] ====Start to sample for epoch 491, global virtualClock: 25981.051856914477, round_duration: 83.5973351615153
2021-08-18:17:11:00,534 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:00,816 INFO     [param_server.py:553] For epoch: 491, median_reward: 339.71512537569976, dev: 339.71512537569976
2021-08-18:17:11:01,464 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8541, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:17:11:01,465 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6124.9657, eval_time 0.5851, test_loss 3.8541, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:17:11:01,506 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8535, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:17:11:01,507 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6125.0078, eval_time 0.6302, test_loss 3.8535, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:17:11:01,537 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:01,544 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:01,580 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:01,586 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7014, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:11:01,587 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6125.0858, eval_time 0.7163, test_loss 3.7014, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:11:01,593 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:01,683 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:01,704 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:02,629 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:02,643 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:03,816 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:03,828 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:03,829 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:03,856 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:05,574 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:05,589 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:06,397 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:06,417 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:06,514 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:06,524 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:06,889 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:06,900 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:07,84 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:07,106 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:07,777 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:07,794 INFO     [learner.py:606] ====Pushing takes 0.015482187271118164 s
2021-08-18:17:11:07,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:07,820 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:07,820 INFO     [param_server.py:410] Lock worker 1 with localStep 491 , while globalStep is 490

2021-08-18:17:11:08,246 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:08,258 INFO     [learner.py:606] ====Pushing takes 0.011188983917236328 s
2021-08-18:17:11:08,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:08,274 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:08,275 INFO     [param_server.py:410] Lock worker 2 with localStep 491 , while globalStep is 490

2021-08-18:17:11:08,778 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:08,789 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:09,947 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:09,970 INFO     [learner.py:606] ====Pushing takes 0.020921945571899414 s
2021-08-18:17:11:09,997 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:10,4 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:10,4 INFO     [param_server.py:381] ====After aggregation in epoch: 490, virtual_clock: 26064.64919207599, top_1: : 62.9235 % (1950.0), top_5: : 100.0 % (3099.0), test loss: 3.803003267005638, test len: 3099.0
2021-08-18:17:11:10,7 INFO     [param_server.py:410] Lock worker 3 with localStep 491 , while globalStep is 491

2021-08-18:17:11:10,8 INFO     [param_server.py:441] ====Epoch 492 completes 12 clients with loss 4.412591096341574, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:10,8 INFO     [param_server.py:450] ====Start to sample for epoch 492, global virtualClock: 26064.64919207599, round_duration: 83.5973351615153
2021-08-18:17:11:10,9 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:10,281 INFO     [param_server.py:553] For epoch: 492, median_reward: 333.73413748935377, dev: 333.73413748935377
2021-08-18:17:11:11,0 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.9482, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:11:11,2 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6134.5009, eval_time 0.666, test_loss 4.9482, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:11:11,36 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.872, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:11:11,38 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6134.5382, eval_time 0.6976, test_loss 3.872, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:11:11,67 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3561, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:17:11:11,68 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6134.5684, eval_time 0.7316, test_loss 4.3561, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:17:11:11,108 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:11:11,109 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:11:11,116 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:11,126 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:11,138 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:11:11,154 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:12,228 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:12,238 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:13,194 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:13,222 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:13,412 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:13,423 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:15,139 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:15,153 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:16,247 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:16,274 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:16,329 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:16,347 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:16,975 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:16,984 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:17,95 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:17,109 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:17,718 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:17,733 INFO     [learner.py:606] ====Pushing takes 0.014077186584472656 s
2021-08-18:17:11:17,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:17,754 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:17,755 INFO     [param_server.py:410] Lock worker 1 with localStep 492 , while globalStep is 491

2021-08-18:17:11:18,69 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:18,84 INFO     [learner.py:606] ====Pushing takes 0.013625860214233398 s
2021-08-18:17:11:18,99 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:18,104 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:18,104 INFO     [param_server.py:410] Lock worker 2 with localStep 492 , while globalStep is 491

2021-08-18:17:11:18,923 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:18,937 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:20,141 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:20,164 INFO     [learner.py:606] ====Pushing takes 0.02205944061279297 s
2021-08-18:17:11:20,189 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:20,195 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:20,196 INFO     [param_server.py:381] ====After aggregation in epoch: 491, virtual_clock: 26148.246527237505, top_1: : 63.4076 % (1965.0), top_5: : 100.0 % (3099.0), test loss: 4.392101857397292, test len: 3099.0
2021-08-18:17:11:20,198 INFO     [param_server.py:410] Lock worker 3 with localStep 492 , while globalStep is 492

2021-08-18:17:11:20,199 INFO     [param_server.py:441] ====Epoch 493 completes 12 clients with loss 6.71695997118892, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:20,199 INFO     [param_server.py:450] ====Start to sample for epoch 493, global virtualClock: 26148.246527237505, round_duration: 83.5973351615153
2021-08-18:17:11:20,200 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:20,498 INFO     [param_server.py:553] For epoch: 493, median_reward: 351.12298642157486, dev: 351.12298642157486
2021-08-18:17:11:21,172 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7103, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:11:21,173 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6144.6736, eval_time 0.62, test_loss 3.7103, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:11:21,181 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2862, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:11:21,182 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6144.6826, eval_time 0.6284, test_loss 4.2862, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:11:21,250 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:11:21,250 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:11:21,266 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:21,270 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:21,304 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8034, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:11:21,306 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6144.8045, eval_time 0.7528, test_loss 3.8034, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:11:21,388 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:11:21,418 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:22,699 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:22,711 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:23,473 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:23,492 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:23,575 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:23,584 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:25,646 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:25,664 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:26,178 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:26,206 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:26,302 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:26,311 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:26,997 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:27,18 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:27,63 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:27,96 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:27,662 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:27,678 INFO     [learner.py:606] ====Pushing takes 0.014920949935913086 s
2021-08-18:17:11:27,693 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:27,700 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:27,701 INFO     [param_server.py:410] Lock worker 1 with localStep 493 , while globalStep is 492

2021-08-18:17:11:27,979 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:27,991 INFO     [learner.py:606] ====Pushing takes 0.010937929153442383 s
2021-08-18:17:11:28,3 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:28,7 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:28,8 INFO     [param_server.py:410] Lock worker 2 with localStep 493 , while globalStep is 492

2021-08-18:17:11:28,904 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:28,915 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:30,173 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:30,193 INFO     [learner.py:606] ====Pushing takes 0.018741846084594727 s
2021-08-18:17:11:30,214 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:30,219 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:30,220 INFO     [param_server.py:381] ====After aggregation in epoch: 492, virtual_clock: 26231.84386239902, top_1: : 64.4724 % (1998.0), top_5: : 100.0 % (3099.0), test loss: 3.9332844548755226, test len: 3099.0
2021-08-18:17:11:30,222 INFO     [param_server.py:410] Lock worker 3 with localStep 493 , while globalStep is 493

2021-08-18:17:11:30,223 INFO     [param_server.py:441] ====Epoch 494 completes 12 clients with loss 5.491703518894903, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:30,226 INFO     [param_server.py:450] ====Start to sample for epoch 494, global virtualClock: 26231.84386239902, round_duration: 83.5973351615153
2021-08-18:17:11:30,226 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:30,512 INFO     [param_server.py:553] For epoch: 494, median_reward: 334.46222340259914, dev: 334.46222340259914
2021-08-18:17:11:31,148 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1265, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:11:31,151 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6154.6518, eval_time 0.5924, test_loss 4.1265, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:11:31,194 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7323, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:11:31,195 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6154.6951, eval_time 0.6355, test_loss 3.7323, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:11:31,219 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:11:31,227 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8074, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:11:31,230 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6154.7283, eval_time 0.6727, test_loss 3.8074, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:11:31,241 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:31,265 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:11:31,277 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:31,300 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:11:31,327 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:32,426 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:32,446 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:33,466 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:33,473 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:33,480 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:33,494 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:35,278 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:35,288 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:36,70 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:36,90 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:36,185 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:36,194 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:36,629 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:36,644 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:37,16 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:37,50 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:37,774 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:37,790 INFO     [learner.py:606] ====Pushing takes 0.015280723571777344 s
2021-08-18:17:11:37,810 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:37,815 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:37,816 INFO     [param_server.py:410] Lock worker 1 with localStep 494 , while globalStep is 493

2021-08-18:17:11:37,952 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:37,964 INFO     [learner.py:606] ====Pushing takes 0.009955883026123047 s
2021-08-18:17:11:37,975 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:37,979 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:37,980 INFO     [param_server.py:410] Lock worker 2 with localStep 494 , while globalStep is 493

2021-08-18:17:11:38,621 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:38,648 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:39,907 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:39,931 INFO     [learner.py:606] ====Pushing takes 0.021686792373657227 s
2021-08-18:17:11:39,956 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:39,961 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:39,962 INFO     [param_server.py:381] ====After aggregation in epoch: 493, virtual_clock: 26315.441197560533, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 3.888748076226976, test len: 3099.0
2021-08-18:17:11:39,964 INFO     [param_server.py:410] Lock worker 3 with localStep 494 , while globalStep is 494

2021-08-18:17:11:39,971 INFO     [param_server.py:441] ====Epoch 495 completes 12 clients with loss 4.354575660633284, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:39,971 INFO     [param_server.py:450] ====Start to sample for epoch 495, global virtualClock: 26315.441197560533, round_duration: 83.5973351615153
2021-08-18:17:11:39,972 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:40,239 INFO     [param_server.py:553] For epoch: 495, median_reward: 363.99090982051337, dev: 363.99090982051337
2021-08-18:17:11:40,767 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7408, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:11:40,768 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6164.2689, eval_time 0.4963, test_loss 3.7408, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:11:40,795 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8514, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:17:11:40,796 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6164.2963, eval_time 0.5241, test_loss 3.8514, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:17:11:40,839 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:11:40,846 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.6506, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:11:40,849 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:40,865 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:11:40,847 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6164.346, eval_time 0.5756, test_loss 4.6506, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:11:40,878 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:40,948 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:11:40,967 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:42,12 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:42,26 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:43,170 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:43,180 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:43,193 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:43,220 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:44,890 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:44,899 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:45,759 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:45,773 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:45,829 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:45,839 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:46,349 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:46,358 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:46,451 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:46,471 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:47,97 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:47,113 INFO     [learner.py:606] ====Pushing takes 0.014913797378540039 s
2021-08-18:17:11:47,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:47,137 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:47,137 INFO     [param_server.py:410] Lock worker 1 with localStep 495 , while globalStep is 494

2021-08-18:17:11:47,511 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:47,522 INFO     [learner.py:606] ====Pushing takes 0.009540796279907227 s
2021-08-18:17:11:47,533 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:47,537 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:47,538 INFO     [param_server.py:410] Lock worker 2 with localStep 495 , while globalStep is 494

2021-08-18:17:11:48,328 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:48,348 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:49,590 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:49,611 INFO     [learner.py:606] ====Pushing takes 0.019446849822998047 s
2021-08-18:17:11:49,634 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:49,640 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:49,641 INFO     [param_server.py:381] ====After aggregation in epoch: 494, virtual_clock: 26399.038532722047, top_1: : 63.5689 % (1970.0), top_5: : 100.0 % (3099.0), test loss: 4.080947019435741, test len: 3099.0
2021-08-18:17:11:49,643 INFO     [param_server.py:410] Lock worker 3 with localStep 495 , while globalStep is 495

2021-08-18:17:11:49,644 INFO     [param_server.py:441] ====Epoch 496 completes 12 clients with loss 5.623987798512042, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:49,644 INFO     [param_server.py:450] ====Start to sample for epoch 496, global virtualClock: 26399.038532722047, round_duration: 83.5973351615153
2021-08-18:17:11:49,645 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:49,916 INFO     [param_server.py:553] For epoch: 496, median_reward: 343.8927850814524, dev: 343.8927850814524
2021-08-18:17:11:50,615 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.644, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:17:11:50,615 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6174.1159, eval_time 0.6639, test_loss 3.644, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:17:11:50,623 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8956, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:11:50,626 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6174.1264, eval_time 0.6769, test_loss 3.8956, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:11:50,687 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:11:50,690 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9952, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:17:11:50,694 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6174.1922, eval_time 0.7444, test_loss 3.9952, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:17:11:50,696 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:50,713 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:11:50,729 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:50,789 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:11:50,808 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:51,963 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:51,973 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:52,774 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:52,795 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:52,947 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:52,957 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:55,114 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:55,133 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:55,558 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:55,569 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:55,664 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:55,679 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:56,425 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:56,439 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:56,587 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:56,597 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:57,33 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:57,49 INFO     [learner.py:606] ====Pushing takes 0.013983726501464844 s
2021-08-18:17:11:57,68 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:57,73 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:57,74 INFO     [param_server.py:410] Lock worker 1 with localStep 496 , while globalStep is 495

2021-08-18:17:11:57,266 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:57,279 INFO     [learner.py:606] ====Pushing takes 0.011579275131225586 s
2021-08-18:17:11:57,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:57,296 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:57,296 INFO     [param_server.py:410] Lock worker 2 with localStep 496 , while globalStep is 495

2021-08-18:17:11:58,334 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:58,343 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:59,513 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:59,536 INFO     [learner.py:606] ====Pushing takes 0.022231101989746094 s
2021-08-18:17:11:59,564 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:59,571 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:59,572 INFO     [param_server.py:381] ====After aggregation in epoch: 495, virtual_clock: 26482.63586788356, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 3.844915871266966, test len: 3099.0
2021-08-18:17:11:59,575 INFO     [param_server.py:410] Lock worker 3 with localStep 496 , while globalStep is 496

2021-08-18:17:11:59,575 INFO     [param_server.py:441] ====Epoch 497 completes 12 clients with loss 6.011641719089745, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:59,576 INFO     [param_server.py:450] ====Start to sample for epoch 497, global virtualClock: 26482.63586788356, round_duration: 83.5973351615153
2021-08-18:17:11:59,577 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:59,875 INFO     [param_server.py:553] For epoch: 497, median_reward: 337.9449940110395, dev: 337.9449940110395
2021-08-18:17:12:00,641 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.8814, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:12:00,641 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7216, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:12:00,642 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6184.1422, eval_time 0.7093, test_loss 4.8814, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:12:00,642 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6184.1425, eval_time 0.7093, test_loss 3.7216, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:12:00,673 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.6372, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:17:12:00,674 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6184.1731, eval_time 0.7442, test_loss 4.6372, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:17:12:00,717 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:00,726 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:00,727 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:00,735 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:00,763 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:00,780 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:01,820 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:01,831 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:02,665 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:02,679 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:02,871 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:02,881 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:04,733 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:04,751 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:05,535 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:05,561 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:05,629 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:05,642 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:06,306 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:06,327 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:06,395 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:06,406 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:06,940 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:06,957 INFO     [learner.py:606] ====Pushing takes 0.015597820281982422 s
2021-08-18:17:12:06,975 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:06,983 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:06,984 INFO     [param_server.py:410] Lock worker 1 with localStep 497 , while globalStep is 496

2021-08-18:17:12:07,498 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:07,510 INFO     [learner.py:606] ====Pushing takes 0.00968313217163086 s
2021-08-18:17:12:07,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:07,526 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:07,527 INFO     [param_server.py:410] Lock worker 2 with localStep 497 , while globalStep is 496

2021-08-18:17:12:08,391 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:08,410 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:09,636 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:09,658 INFO     [learner.py:606] ====Pushing takes 0.020991086959838867 s
2021-08-18:17:12:09,689 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:09,695 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:09,695 INFO     [param_server.py:381] ====After aggregation in epoch: 496, virtual_clock: 26566.233203045074, top_1: : 64.0529 % (1985.0), top_5: : 100.0 % (3099.0), test loss: 4.4134077363544035, test len: 3099.0
2021-08-18:17:12:09,698 INFO     [param_server.py:410] Lock worker 3 with localStep 497 , while globalStep is 497

2021-08-18:17:12:09,698 INFO     [param_server.py:441] ====Epoch 498 completes 12 clients with loss 5.1380742614100035, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:09,699 INFO     [param_server.py:450] ====Start to sample for epoch 498, global virtualClock: 26566.233203045074, round_duration: 83.5973351615153
2021-08-18:17:12:09,699 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:09,974 INFO     [param_server.py:553] For epoch: 498, median_reward: 326.5921733417288, dev: 326.5921733417288
2021-08-18:17:12:10,643 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9682, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:12:10,646 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6194.1464, eval_time 0.6126, test_loss 3.9682, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:12:10,715 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:10,723 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:10,729 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6778, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:12:10,730 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6194.2303, eval_time 0.6919, test_loss 3.6778, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:12:10,762 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.0169, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:12:10,765 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6194.264, eval_time 0.7357, test_loss 5.0169, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:12:10,798 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:10,818 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:10,833 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:10,857 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:12,241 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:12,250 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:12,895 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:12,909 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:13,60 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:13,70 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:15,151 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:15,166 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:15,474 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:15,494 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:15,712 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:15,721 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:16,407 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:16,441 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:16,712 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:16,733 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:17,83 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:17,101 INFO     [learner.py:606] ====Pushing takes 0.016367435455322266 s
2021-08-18:17:12:17,115 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:17,120 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:17,121 INFO     [param_server.py:410] Lock worker 1 with localStep 498 , while globalStep is 497

2021-08-18:17:12:17,525 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:17,541 INFO     [learner.py:606] ====Pushing takes 0.014612913131713867 s
2021-08-18:17:12:17,553 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:17,557 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:17,557 INFO     [param_server.py:410] Lock worker 2 with localStep 498 , while globalStep is 497

2021-08-18:17:12:18,757 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:18,771 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:19,935 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:19,957 INFO     [learner.py:606] ====Pushing takes 0.020264387130737305 s
2021-08-18:17:12:19,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:19,991 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:19,991 INFO     [param_server.py:381] ====After aggregation in epoch: 497, virtual_clock: 26649.83053820659, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 4.220978922314114, test len: 3099.0
2021-08-18:17:12:19,994 INFO     [param_server.py:410] Lock worker 3 with localStep 498 , while globalStep is 498

2021-08-18:17:12:19,994 INFO     [param_server.py:441] ====Epoch 499 completes 12 clients with loss 6.564690740599997, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:19,995 INFO     [param_server.py:450] ====Start to sample for epoch 499, global virtualClock: 26649.83053820659, round_duration: 83.5973351615153
2021-08-18:17:12:19,996 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:20,297 INFO     [param_server.py:553] For epoch: 499, median_reward: 350.2635003174795, dev: 350.2635003174795
2021-08-18:17:12:20,969 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.554, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:17:12:20,970 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6204.4705, eval_time 0.6366, test_loss 4.554, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:17:12:20,970 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2573, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:17:12:20,971 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6204.4712, eval_time 0.6372, test_loss 4.2573, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:17:12:21,38 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2866, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:12:21,39 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6204.5377, eval_time 0.7056, test_loss 4.2866, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:12:21,44 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:12:21,48 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:12:21,56 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:21,57 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:21,110 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:12:21,131 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:22,212 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:22,233 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:23,139 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:23,148 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:23,218 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:23,238 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:24,991 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:25,10 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:25,706 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:25,720 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:25,886 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:25,896 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:26,321 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:26,330 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:26,587 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:26,615 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:27,256 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:27,270 INFO     [learner.py:606] ====Pushing takes 0.01256418228149414 s
2021-08-18:17:12:27,285 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:27,292 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:27,293 INFO     [param_server.py:410] Lock worker 1 with localStep 499 , while globalStep is 498

2021-08-18:17:12:27,672 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:27,684 INFO     [learner.py:606] ====Pushing takes 0.010539531707763672 s
2021-08-18:17:12:27,696 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:27,700 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:27,700 INFO     [param_server.py:410] Lock worker 2 with localStep 499 , while globalStep is 498

2021-08-18:17:12:28,222 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:28,236 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:29,445 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:29,465 INFO     [learner.py:606] ====Pushing takes 0.019169092178344727 s
2021-08-18:17:12:29,489 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:29,500 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:29,501 INFO     [param_server.py:381] ====After aggregation in epoch: 498, virtual_clock: 26733.427873368102, top_1: : 61.8264 % (1916.0), top_5: : 100.0 % (3099.0), test loss: 4.365982762089481, test len: 3099.0
2021-08-18:17:12:29,503 INFO     [param_server.py:410] Lock worker 3 with localStep 499 , while globalStep is 499

2021-08-18:17:12:29,504 INFO     [param_server.py:441] ====Epoch 500 completes 12 clients with loss 3.8862051540732114, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:29,504 INFO     [param_server.py:450] ====Start to sample for epoch 500, global virtualClock: 26733.427873368102, round_duration: 83.5973351615153
2021-08-18:17:12:29,505 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:29,779 INFO     [param_server.py:553] For epoch: 500, median_reward: 337.02225634986, dev: 337.02225634986
2021-08-18:17:12:29,941 INFO     [param_server.py:560] Epoch is done: 500
====Error: argument of type 'NoneType' is not iterable

2021-08-18:17:12:31,181 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0046, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:12:31,184 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6214.6828, eval_time 1.3603, test_loss 4.0046, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:12:31,246 INFO     [learner.py:667] ====Dump model successfully
2021-08-18:17:12:31,279 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:12:31,293 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:32,276 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0163, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:17:12:32,280 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6215.78, eval_time 2.4557, test_loss 4.0163, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:17:12:32,283 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3428, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:12:32,284 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6215.7842, eval_time 2.457, test_loss 4.3428, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:12:32,354 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:12:32,354 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:12:32,363 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:32,370 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:34,789 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:34,817 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:35,550 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:35,570 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:39,652 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:39,665 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:42,90 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:42,100 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:42,190 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:42,205 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:44,545 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:44,559 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:44,970 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:44,984 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:45,792 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:45,802 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
2021-08-18:17:12:47,136 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:47,155 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:47,917 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:47,957 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:48,823 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:48,837 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
2021-08-18:17:12:50,979 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:50,990 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
